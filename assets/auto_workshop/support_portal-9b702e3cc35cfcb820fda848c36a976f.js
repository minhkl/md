/*!
 * jQuery JavaScript Library v1.10.0
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-05-24T18:39Z
 */
!function(window,undefined){function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);return jQuery.isWindow(obj)?!1:1===obj.nodeType&&length?!0:"array"===type||"function"!==type&&(0===length||"number"==typeof length&&length>0&&length-1 in obj)}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(core_rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function internalData(elem,name,data,pvt){if(jQuery.acceptData(elem)){var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if(id&&cache[id]&&(pvt||cache[id].data)||data!==undefined||"string"!=typeof name)return id||(id=isNode?elem[internalKey]=core_deletedIds.pop()||jQuery.guid++:internalKey),cache[id]||(cache[id]=isNode?{}:{toJSON:jQuery.noop}),("object"==typeof name||"function"==typeof name)&&(pvt?cache[id]=jQuery.extend(cache[id],name):cache[id].data=jQuery.extend(cache[id].data,name)),thisCache=cache[id],pvt||(thisCache.data||(thisCache.data={}),thisCache=thisCache.data),data!==undefined&&(thisCache[jQuery.camelCase(name)]=data),"string"==typeof name?(ret=thisCache[name],null==ret&&(ret=thisCache[jQuery.camelCase(name)])):ret=thisCache,ret}}function internalRemoveData(elem,name,pvt){if(jQuery.acceptData(elem)){var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(cache[id]){if(name&&(thisCache=pvt?cache[id]:cache[id].data)){jQuery.isArray(name)?name=name.concat(jQuery.map(name,jQuery.camelCase)):name in thisCache?name=[name]:(name=jQuery.camelCase(name),name=name in thisCache?[name]:name.split(" ")),i=name.length;for(;i--;)delete thisCache[name[i]];if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache))return}(pvt||(delete cache[id].data,isEmptyDataObject(cache[id])))&&(isNode?jQuery.cleanData([elem],!0):jQuery.support.deleteExpando||cache!=cache.window?delete cache[id]:cache[id]=null)}}}function dataAttr(elem,key,data){if(data===undefined&&1===elem.nodeType){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();if(data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else data=undefined}return data}function isEmptyDataObject(obj){var name;for(name in obj)if(("data"!==name||!jQuery.isEmptyObject(obj[name]))&&"toJSON"!==name)return!1;return!0}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function sibling(cur,dir){do cur=cur[dir];while(cur&&1!==cur.nodeType);return cur}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(isSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return jQuery.inArray(elem,qualifier)>=0!==not})}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement)for(;list.length;)safeFrag.createElement(list.pop());return safeFrag}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(1===content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==jQuery.find.attr(elem,"type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var elem,i=0;null!=(elem=elems[i]);i++)jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){if(1===dest.nodeType&&jQuery.hasData(src)){var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle,curData.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}curData.data&&(curData.data=jQuery.extend({},curData.data))}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(1===dest.nodeType){if(nodeName=dest.nodeName.toLowerCase(),!jQuery.support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events)jQuery.removeEvent(dest,e,data.handle);dest.removeAttribute(jQuery.expando)}"script"===nodeName&&dest.text!==src.text?(disableScript(dest).text=src.text,restoreScript(dest)):"object"===nodeName?(dest.parentNode&&(dest.outerHTML=src.outerHTML),jQuery.support.html5Clone&&src.innerHTML&&!jQuery.trim(dest.innerHTML)&&(dest.innerHTML=src.innerHTML)):"input"===nodeName&&manipulation_rcheckableType.test(src.type)?(dest.defaultChecked=dest.checked=src.checked,dest.value!==src.value&&(dest.value=src.value)):"option"===nodeName?dest.defaultSelected=dest.selected=src.defaultSelected:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}}function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==core_strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==core_strundefined?context.querySelectorAll(tag||"*"):undefined;if(!found)for(found=[],elems=context.childNodes||context;null!=(elem=elems[i]);i++)!tag||jQuery.nodeName(elem,tag)?found.push(elem):jQuery.merge(found,getAll(elem,tag));return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}function fixDefaultChecked(elem){manipulation_rcheckableType.test(elem.type)&&(elem.defaultChecked=elem.checked)}function vendorPropName(style,name){if(name in style)return name;for(var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function isHidden(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(values[index]=jQuery._data(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=jQuery._data(elem,"olddisplay",css_defaultDisplay(elem.nodeName)))):values[index]||(hidden=isHidden(elem),(display&&"none"!==display||!hidden)&&jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;length>index;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(0>=val||null==val){if(val=curCSS(elem,name,styles),(0>val||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(jQuery.support.boxSizingReliable||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function css_defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(doc.documentElement),doc=(iframe[0].contentWindow||iframe[0].contentDocument).document,doc.write("<!doctype html><html><body>"),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=jQuery.css(elem[0],"display");return elem.remove(),display}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(core_rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)src[key]!==undefined&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),ct===undefined&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function createFxNow(){return setTimeout(function(){fxNow=undefined}),fxNow=jQuery.now()}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],"inline"===jQuery.css(elem,"display")&&"none"===jQuery.css(elem,"float")&&(jQuery.support.inlineBlockNeedsLayout&&"inline"!==css_defaultDisplay(elem.nodeName)?style.zoom=1:style.display="inline-block")),opts.overflow&&(style.overflow="hidden",jQuery.support.shrinkWrapBlocks||anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show"))continue;orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if(!jQuery.isEmptyObject(orig)){dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=jQuery._data(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function genFx(type,includeWidth){var which,attrs={height:type},i=0;for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType?elem.defaultView||elem.parentWindow:!1}var readyList,rootjQuery,core_strundefined=typeof undefined,location=window.location,document=window.document,docElem=document.documentElement,_jQuery=window.jQuery,_$=window.$,class2type={},core_deletedIds=[],core_version="1.10.0",core_concat=core_deletedIds.concat,core_push=core_deletedIds.push,core_slice=core_deletedIds.slice,core_indexOf=core_deletedIds.indexOf,core_toString=class2type.toString,core_hasOwn=class2type.hasOwnProperty,core_trim=core_version.trim,jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,core_rnotwhite=/\S+/g,rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rvalidchars=/^[\],:{}\s]*$/,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rvalidescape=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,rvalidtokens=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()},completed=function(event){(document.addEventListener||"load"===event.type||"complete"===document.readyState)&&(detach(),jQuery.ready())},detach=function(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1)):(document.detachEvent("onreadystatechange",completed),window.detachEvent("onload",completed))};jQuery.fn=jQuery.prototype={jquery:core_version,constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}if(elem=document.getElementById(match[2]),elem&&elem.parentNode){if(elem.id!==match[2])return rootjQuery.find(selector);this.length=1,this[0]=elem}return this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?rootjQuery.ready(selector):(selector.selector!==undefined&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))},selector:"",length:0,toArray:function(){return core_slice.call(this)},get:function(num){return null==num?this.toArray():0>num?this[this.length+num]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){return jQuery.ready.promise().done(fn),this},slice:function(){return this.pushStack(core_slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:core_push,sort:[].sort,splice:[].splice},jQuery.fn.init.prototype=jQuery.fn,jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[1]||{},i=2),"object"==typeof target||jQuery.isFunction(target)||(target={}),length===i&&(target=this,--i);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):copy!==undefined&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(core_version+Math.random()).replace(/\D/g,""),noConflict:function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){if(wait===!0?!--jQuery.readyWait:!jQuery.isReady){if(!document.body)return setTimeout(jQuery.ready);jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.trigger&&jQuery(document).trigger("ready").off("ready"))}},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray||function(obj){return"array"===jQuery.type(obj)},isWindow:function(obj){return null!=obj&&obj==obj.window},isNumeric:function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj)},type:function(obj){return null==obj?String(obj):"object"==typeof obj||"function"==typeof obj?class2type[core_toString.call(obj)]||"object":typeof obj},isPlainObject:function(obj){var key;if(!obj||"object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;try{if(obj.constructor&&!core_hasOwn.call(obj,"constructor")&&!core_hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(jQuery.support.ownLast)for(key in obj)return core_hasOwn.call(obj,key);for(key in obj);return key===undefined||core_hasOwn.call(obj,key)},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},error:function(msg){throw new Error(msg)},parseHTML:function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))},parseJSON:function(data){return window.JSON&&window.JSON.parse?window.JSON.parse(data):null===data?data:"string"==typeof data&&(data=jQuery.trim(data),data&&rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,"")))?new Function("return "+data)():(jQuery.error("Invalid JSON: "+data),void 0)},parseXML:function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{window.DOMParser?(tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")):(xml=new ActiveXObject("Microsoft.XMLDOM"),xml.async="false",xml.loadXML(data))}catch(e){xml=undefined}return xml&&xml.documentElement&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml},noop:function(){},globalEval:function(data){data&&jQuery.trim(data)&&(window.execScript||function(data){window.eval.call(window,data)})(data)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;length>i&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:core_trim&&!core_trim.call("﻿ ")?function(text){return null==text?"":core_trim.call(text)}:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):core_push.call(ret,arr)),ret},inArray:function(elem,arr,i){var len;if(arr){if(core_indexOf)return core_indexOf.call(arr,elem,i);for(len=arr.length,i=i?0>i?Math.max(0,len+i):i:0;len>i;i++)if(i in arr&&arr[i]===elem)return i}return-1},merge:function(first,second){var l=second.length,i=first.length,j=0;if("number"==typeof l)for(;l>j;j++)first[i++]=second[j];else for(;second[j]!==undefined;)first[i++]=second[j++];return first.length=i,first},grep:function(elems,callback,inv){var retVal,ret=[],i=0,length=elems.length;for(inv=!!inv;length>i;i++)retVal=!!callback(elems[i],i),inv!==retVal&&ret.push(elems[i]);return ret},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;length>i;i++)value=callback(elems[i],i,arg),null!=value&&(ret[ret.length]=value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&(ret[ret.length]=value);return core_concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=core_slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(core_slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):undefined},access:function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(value!==undefined&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;length>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},now:function(){return(new Date).getTime()},swap:function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret}}),jQuery.ready.promise=function(obj){if(!readyList)if(readyList=jQuery.Deferred(),"complete"===document.readyState)setTimeout(jQuery.ready);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1);else{document.attachEvent("onreadystatechange",completed),window.attachEvent("onload",completed);var top=!1;try{top=null==window.frameElement&&document.documentElement}catch(e){}top&&top.doScroll&&function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}detach(),jQuery.ready()}}()}return readyList.promise(obj)},jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()}),rootjQuery=jQuery(document),/*!
 * Sizzle CSS Selector Engine v1.9.4-pre
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-05-15
 */
function(window,undefined){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=context.nodeType)&&9!==nodeType)return[];if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&context.parentNode||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function isNative(fn){return rnative.test(fn+"")}function createCache(){function cache(key,value){return keys.push(key+=" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler,test){attrs=attrs.split("|");for(var current,i=attrs.length,setHandle=test?null:handler;i--;)(current=Expr.attrHandle[attrs[i]])&&current!==handler||(Expr.attrHandle[attrs[i]]=setHandle)}function boolHandler(elem,name){var val=elem.getAttributeNode(name);return val&&val.specified?val.value:elem[name]===!0?name.toLowerCase():null}function interpolationHandler(elem,name){return elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}function valueHandler(elem){return"input"===elem.nodeName.toLowerCase()?elem.defaultValue:void 0}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var data,cache,outerCache,dirkey=dirruns+" "+doneName;if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(outerCache=elem[expando]||(elem[expando]={}),(cache=outerCache[dir])&&cache[0]===dirkey){if((data=cache[1])===!0||data===cachedruns)return data===!0}else if(cache=outerCache[dir]=[dirkey],cache[1]=matcher(elem,context,xml)||cachedruns,cache[1]===!0)return!0}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var matcherCachedRuns=0,bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,expandContext){var elem,j,matcher,setMatched=[],matchedCount=0,i="0",unmatched=seed&&[],outermost=null!=expandContext,contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",expandContext&&context.parentNode||context),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1;for(outermost&&(outermostContext=context!==document&&context,cachedruns=matcherCachedRuns);null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique,cachedruns=++matcherCachedRuns)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);if(!seed&&1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&context.parentNode||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return compile(selector,match)(seed,context,!documentIsHTML,results,rsibling.test(selector)),results}function setFilters(){}var i,support,cachedruns,Expr,getText,isXML,compile,outermostContext,sortInput,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),hasDuplicate=!1,sortOrder=function(){return 0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){for(var i=0,len=this.length;len>i;i++)if(this[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rsibling=new RegExp(whitespace+"*[+~]"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(55296|high>>10,56320|1023&high)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},support=Sizzle.support={},setDocument=Sizzle.setDocument=function(node){var doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,documentIsHTML=!isXML(doc),support.attributes=assert(function(div){return div.innerHTML="<a href='#'></a>",addHandle("type|href|height|width",interpolationHandler,"#"===div.firstChild.getAttribute("href")),addHandle(booleans,boolHandler,null==div.getAttribute("disabled")),div.className="i",!div.getAttribute("className")}),support.input=assert(function(div){return div.innerHTML="<input>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")}),addHandle("value",valueHandler,support.attributes&&support.input),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=assert(function(div){return div.innerHTML="<div class='a'></div><div class='a i'></div>",div.firstChild.className="i",2===div.getElementsByClassName("i").length}),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return typeof context.getElementsByClassName!==strundefined&&documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=isNative(doc.querySelectorAll))&&(assert(function(div){div.innerHTML="<select><option selected=''></option></select>",div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("t",""),div.querySelectorAll("[t^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=isNative(matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),contains=isNative(docElem.contains)||docElem.compareDocumentPosition?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(doc.createElement("div"))}),sortOrder=docElem.compareDocumentPosition?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b);return compare?1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||contains(preferredDoc,a)?-1:b===doc||contains(preferredDoc,b)?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0:4&compare?-1:1:a.compareDocumentPosition?-1:1}:function(a,b){var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(a===b)return hasDuplicate=!0,0;if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),!(!support.matchesSelector||!documentIsHTML||rbuggyMatches&&rbuggyMatches.test(expr)||rbuggyQSA&&rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val===undefined?support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null:val},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i];i++)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]&&match[4]!==undefined?match[2]=match[4]:unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||0===diff%first&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf.call(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeName>"@"||3===elem.nodeType||4===elem.nodeType)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||attr.toLowerCase()===elem.type)},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}};for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(group||(group=tokenize(selector)),i=group.length;i--;)cached=matcherFromTokens(group[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))}return cached},Expr.pseudos.nth=Expr.pseudos.eq,setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,support.sortStable=expando.split("").sort(sortOrder).join("")===expando,setDocument(),[0,0].sort(sortOrder),support.detectDuplicates=hasDuplicate,jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains}(window);var optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingLength>firingIndex;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(firingLength>=index&&firingLength--,firingIndex>=index&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=undefined,this},disabled:function(){return!list},lock:function(){return stack=undefined,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return args=args||[],args=[context,args.slice?args.slice():args],!list||fired&&!stack||(firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var action=tuple[0],fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[action+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=core_slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?core_slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;
return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}}),jQuery.support=function(support){var all,a,input,select,fragment,opt,eventName,isSupported,i,div=document.createElement("div");if(div.setAttribute("className","t"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",all=div.getElementsByTagName("*")||[],a=div.getElementsByTagName("a")[0],!a||!a.style||!all.length)return support;select=document.createElement("select"),opt=select.appendChild(document.createElement("option")),input=div.getElementsByTagName("input")[0],a.style.cssText="top:1px;float:left;opacity:.5",support.getSetAttribute="t"!==div.className,support.leadingWhitespace=3===div.firstChild.nodeType,support.tbody=!div.getElementsByTagName("tbody").length,support.htmlSerialize=!!div.getElementsByTagName("link").length,support.style=/top/.test(a.getAttribute("style")),support.hrefNormalized="/a"===a.getAttribute("href"),support.opacity=/^0.5/.test(a.style.opacity),support.cssFloat=!!a.style.cssFloat,support.checkOn=!!input.value,support.optSelected=opt.selected,support.enctype=!!document.createElement("form").enctype,support.html5Clone="<:nav></:nav>"!==document.createElement("nav").cloneNode(!0).outerHTML,support.inlineBlockNeedsLayout=!1,support.shrinkWrapBlocks=!1,support.pixelPosition=!1,support.deleteExpando=!0,support.noCloneEvent=!0,support.reliableMarginRight=!0,support.boxSizingReliable=!0,input.checked=!0,support.noCloneChecked=input.cloneNode(!0).checked,select.disabled=!0,support.optDisabled=!opt.disabled;try{delete div.test}catch(e){support.deleteExpando=!1}input=document.createElement("input"),input.setAttribute("value",""),support.input=""===input.getAttribute("value"),input.value="t",input.setAttribute("type","radio"),support.radioValue="t"===input.value,input.setAttribute("checked","t"),input.setAttribute("name","t"),fragment=document.createDocumentFragment(),fragment.appendChild(input),support.appendChecked=input.checked,support.checkClone=fragment.cloneNode(!0).cloneNode(!0).lastChild.checked,div.attachEvent&&(div.attachEvent("onclick",function(){support.noCloneEvent=!1}),div.cloneNode(!0).click());for(i in{submit:!0,change:!0,focusin:!0})div.setAttribute(eventName="on"+i,"t"),support[i+"Bubbles"]=eventName in window||div.attributes[eventName].expando===!1;div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip;for(i in jQuery(support))break;return support.ownLast="0"!==i,jQuery(function(){var container,marginDiv,tds,divReset="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",body=document.getElementsByTagName("body")[0];body&&(container=document.createElement("div"),container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",body.appendChild(container).appendChild(div),div.innerHTML="<table><tr><td></td><td>t</td></tr></table>",tds=div.getElementsByTagName("td"),tds[0].style.cssText="padding:0;margin:0;border:0;display:none",isSupported=0===tds[0].offsetHeight,tds[0].style.display="",tds[1].style.display="none",support.reliableHiddenOffsets=isSupported&&0===tds[0].offsetHeight,div.innerHTML="",div.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",jQuery.swap(body,null!=body.style.zoom?{zoom:1}:{},function(){support.boxSizing=4===div.offsetWidth}),window.getComputedStyle&&(support.pixelPosition="1%"!==(window.getComputedStyle(div,null)||{}).top,support.boxSizingReliable="4px"===(window.getComputedStyle(div,null)||{width:"4px"}).width,marginDiv=div.appendChild(document.createElement("div")),marginDiv.style.cssText=div.style.cssText=divReset,marginDiv.style.marginRight=marginDiv.style.width="0",div.style.width="1px",support.reliableMarginRight=!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight)),typeof div.style.zoom!==core_strundefined&&(div.innerHTML="",div.style.cssText=divReset+"width:1px;padding:1px;display:inline;zoom:1",support.inlineBlockNeedsLayout=3===div.offsetWidth,div.style.display="block",div.innerHTML="<div></div>",div.firstChild.style.width="5px",support.shrinkWrapBlocks=3!==div.offsetWidth,support.inlineBlockNeedsLayout&&(body.style.zoom=1)),body.removeChild(container),container=div=tds=marginDiv=null)}),all=select=fragment=opt=a=input=null,support}({});var rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){return elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando],!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,!0)},_removeData:function(elem,name){return internalRemoveData(elem,name,!0)},acceptData:function(elem){if(elem.nodeType&&1!==elem.nodeType&&9!==elem.nodeType)return!1;var noData=elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()];return!noData||noData!==!0&&elem.getAttribute("classid")===noData}}),jQuery.fn.extend({data:function(key,value){var attrs,name,data=null,i=0,elem=this[0];if(key===undefined){if(this.length&&(data=jQuery.data(elem),1===elem.nodeType&&!jQuery._data(elem,"parsedAttrs"))){for(attrs=elem.attributes;i<attrs.length;i++)name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name]));jQuery._data(elem,"parsedAttrs",!0)}return data}return"object"==typeof key?this.each(function(){jQuery.data(this,key)}):arguments.length>1?this.each(function(){jQuery.data(this,key,value)}):elem?dataAttr(elem,key,jQuery.data(elem,key)):null},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=jQuery._data(elem,type),data&&(!queue||jQuery.isArray(data)?queue=jQuery._data(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),hooks.cur=fn,fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue"),jQuery._removeData(elem,key)})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=undefined),type=type||"fx";i--;)tmp=jQuery._data(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var nodeHook,boolHook,rclass=/[\t\r\n\f]/g,rreturn=/\r/g,rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=jQuery.support.getSetAttribute,getSetInput=jQuery.support.input;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,value){return jQuery.access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return name=jQuery.propFix[name]||name,this.each(function(){try{this[name]=undefined,delete this[name]}catch(e){}})},addClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed="string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(core_rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");elem.className=jQuery.trim(cur)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed=0===arguments.length||"string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(core_rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");elem.className=value?jQuery.trim(cur):""}return this},toggleClass:function(value,stateVal){var type=typeof value,isBool="boolean"==typeof stateVal;return jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}):this.each(function(){if("string"===type)for(var className,i=0,self=jQuery(this),state=stateVal,classNames=value.match(core_rnotwhite)||[];className=classNames[i++];)state=isBool?state:!self.hasClass(className),self[state?"addClass":"removeClass"](className);else(type===core_strundefined||"boolean"===type)&&(this.className&&jQuery._data(this,"__className__",this.className),this.className=this.className||value===!1?"":jQuery._data(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;l>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1},val:function(value){var ret,hooks,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&hooks.set(this,val,"value")!==undefined||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:elem.text}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],!(!option.selected&&i!==index||(jQuery.support.optDisabled?option.disabled:null!==option.getAttribute("disabled"))||option.parentNode.disabled&&jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(jQuery(option).val(),values)>=0)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}},attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===core_strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),value===undefined?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?undefined:ret):null!==value?hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem.setAttribute(name,value+""),value):(jQuery.removeAttr(elem,name),void 0))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(core_rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)?getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem[propName]=!1:elem[jQuery.camelCase("default-"+name)]=elem[propName]=!1:jQuery.attr(elem,name,""),elem.removeAttribute(getSetAttribute?name:propName)},attrHooks:{type:{set:function(elem,value){if(!jQuery.support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),value!==undefined?hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name):elem[jQuery.camelCase("default-"+name)]=elem[name]=!0,name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=jQuery.expr.attrHandle[name]||jQuery.find.attr;jQuery.expr.attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var fn=jQuery.expr.attrHandle[name],ret=isXML?undefined:(jQuery.expr.attrHandle[name]=undefined)!=getter(elem,name,isXML)?name.toLowerCase():null;return jQuery.expr.attrHandle[name]=fn,ret}:function(elem,name,isXML){return isXML?undefined:elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null}}),getSetInput&&getSetAttribute||(jQuery.attrHooks.value={set:function(elem,value,name){return jQuery.nodeName(elem,"input")?(elem.defaultValue=value,void 0):nodeHook&&nodeHook.set(elem,value,name)}}),getSetAttribute||(nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);return ret||elem.setAttributeNode(ret=elem.ownerDocument.createAttribute(name)),ret.value=value+="","value"===name||value===elem.getAttribute(name)?value:undefined}},jQuery.expr.attrHandle.id=jQuery.expr.attrHandle.name=jQuery.expr.attrHandle.coords=function(elem,name,isXML){var ret;return isXML?undefined:(ret=elem.getAttributeNode(name))&&""!==ret.value?ret.value:null},jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);return ret&&ret.specified?ret.value:undefined},set:nodeHook.set},jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,""===value?!1:value,name)}},jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){return""===value?(elem.setAttribute(name,"auto"),value):void 0}}})),jQuery.support.hrefNormalized||jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}}),jQuery.support.style||(jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined},set:function(elem,value){return elem.style.cssText=value+""}}),jQuery.support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex),null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.support.enctype||(jQuery.propFix.enctype="encoding"),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0:void 0}},jQuery.support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(elemData){for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery===core_strundefined||e&&jQuery.event.triggered===e.type?undefined:jQuery.event.dispatch.apply(eventHandle.elem,arguments)},eventHandle.elem=elem),types=(types||"").match(core_rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||(elem.addEventListener?elem.addEventListener(type,eventHandle,!1):elem.attachEvent&&elem.attachEvent("on"+type,eventHandle))),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0);elem=null}},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(core_rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,jQuery._removeData(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=core_hasOwn.call(event,"type")?event.type:event,namespaces=core_hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=undefined,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&jQuery.acceptData(cur)&&handle.apply&&handle.apply(cur,data)===!1&&event.preventDefault();if(event.type=type,!onlyHandlers&&!event.isDefaultPrevented()&&(!special._default||special._default.apply(eventPath.pop(),data)===!1)&&jQuery.acceptData(elem)&&ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type;try{elem[type]()}catch(e){}jQuery.event.triggered=undefined,tmp&&(elem[ontype]=tmp)}return event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=core_slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)(!event.namespace_re||event.namespace_re.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),ret!==undefined&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!=this;cur=cur.parentNode||this)if(1===cur.nodeType&&(cur.disabled!==!0||"click"!==event.type)){for(matches=[],i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",matches[sel]===undefined&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=originalEvent.srcElement||document),3===event.target.nodeType&&(event.target=event.target.parentNode),event.metaKey=!!event.metaKey,fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),!event.relatedTarget&&fromElement&&(event.relatedTarget=fromElement===event.target?original.toElement:fromElement),event.which||button===undefined||(event.which=1&button?1:2&button?3:4&button?2:0),event}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return jQuery.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){event.result!==undefined&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)}:function(elem,type,handle){var name="on"+type;elem.detachEvent&&(typeof elem[name]===core_strundefined&&(elem[name]=null),elem.detachEvent(name,handle))},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||src.returnValue===!1||src.getPreventDefault&&src.getPreventDefault()?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),this[jQuery.expando]=!0,void 0):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return(!related||related!==target&&!jQuery.contains(target,related))&&(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.support.submitBubbles||(jQuery.event.special.submit={setup:function(){return jQuery.nodeName(this,"form")?!1:(jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;form&&!jQuery._data(form,"submitBubbles")&&(jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=!0}),jQuery._data(form,"submitBubbles",!0))}),void 0)},postDispatch:function(event){event._submit_bubble&&(delete event._submit_bubble,this.parentNode&&!event.isTrigger&&jQuery.event.simulate("submit",this.parentNode,event,!0))},teardown:function(){return jQuery.nodeName(this,"form")?!1:(jQuery.event.remove(this,"._submit"),void 0)}}),jQuery.support.changeBubbles||(jQuery.event.special.change={setup:function(){return rformElems.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(jQuery.event.add(this,"propertychange._change",function(event){"checked"===event.originalEvent.propertyName&&(this._just_changed=!0)}),jQuery.event.add(this,"click._change",function(event){this._just_changed&&!event.isTrigger&&(this._just_changed=!1),jQuery.event.simulate("change",this,event,!0)})),!1):(jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")&&(jQuery.event.add(elem,"change._change",function(event){!this.parentNode||event.isSimulated||event.isTrigger||jQuery.event.simulate("change",this.parentNode,event,!0)}),jQuery._data(elem,"changeBubbles",!0))}),void 0)},handle:function(event){var elem=event.target;return this!==elem||event.isSimulated||event.isTrigger||"radio"!==elem.type&&"checkbox"!==elem.type?event.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return jQuery.event.remove(this,"._change"),!rformElems.test(this.nodeName)}}),jQuery.support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0,handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){0===attaches++&&document.addEventListener(orig,handler,!0)},teardown:function(){0===--attaches&&document.removeEventListener(orig,handler,!0)}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=undefined);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=undefined):null==fn&&("string"==typeof selector?(fn=data,data=undefined):(fn=data,data=selector,selector=undefined)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return(selector===!1||"function"==typeof selector)&&(fn=selector,selector=undefined),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}});var isSimple=/^.[^:#\[\.,]*$/,rparentsprev=/^(?:parents|prev(?:Until|All))/,rneedsContext=jQuery.expr.match.needsContext,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0
}));for(i=0;len>i;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;len>i;i++)if(jQuery.contains(this,targets[i]))return!0})},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length},closest:function(selectors,context){for(var cur,i=0,l=this.length,ret=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){cur=ret.push(cur);break}return this.pushStack(ret.length>1?jQuery.unique(ret):ret)},index:function(elem){return elem?"string"==typeof elem?jQuery.inArray(this[0],jQuery(elem)):jQuery.inArray(elem.jquery?elem[0]:elem,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){var set="string"==typeof selector?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(jQuery.unique(all))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(ret=jQuery.filter(selector,ret)),this.length>1&&(guaranteedUnique[name]||(ret=jQuery.unique(ret)),rparentsprev.test(name)&&(ret=ret.reverse())),this.pushStack(ret)}}),jQuery.extend({filter:function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},dir:function(elem,dir,until){for(var matched=[],cur=elem[dir];cur&&9!==cur.nodeType&&(until===undefined||1!==cur.nodeType||!jQuery(cur).is(until));)1===cur.nodeType&&matched.push(cur),cur=cur[dir];return matched},sibling:function(n,elem){for(var r=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&r.push(n);return r}});var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,manipulation_rcheckableType=/^(?:checkbox|radio)$/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.fn.extend({text:function(value){return jQuery.access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++){for(1===elem.nodeType&&jQuery.cleanData(getAll(elem,!1));elem.firstChild;)elem.removeChild(elem.firstChild);elem.options&&jQuery.nodeName(elem,"select")&&(elem.options.length=0)}return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return jQuery.access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined)return 1===elem.nodeType?elem.innerHTML.replace(rinlinejQuery,""):undefined;if(!("string"!=typeof value||rnoInnerhtml.test(value)||!jQuery.support.htmlSerialize&&rnoshimcache.test(value)||!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(value)||wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()])){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var args=jQuery.map(this,function(elem){return[elem.nextSibling,elem.parentNode]}),i=0;return this.domManip(arguments,function(elem){var next=args[i++],parent=args[i++];parent&&(next&&next.parentNode!==parent&&(next=this.nextSibling),jQuery(this).remove(),parent.insertBefore(elem,next))},!0),i?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback,allowIntersection){args=core_concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||!(1>=l||"string"!=typeof value||jQuery.support.checkClone)&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback,allowIntersection)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,!allowIntersection&&this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl(node.src):jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,"")));fragment=first=null}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),core_push.apply(ret,elems.get());return this.pushStack(ret)}}),jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(jQuery.support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")?clone=elem.cloneNode(!0):(fragmentDiv.innerHTML=elem.outerHTML,fragmentDiv.removeChild(clone=fragmentDiv.firstChild)),!(jQuery.support.noCloneEvent&&jQuery.support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0;null!=(node=srcElements[i]);++i)destElements[i]&&fixCloneNodeIssues(node,destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0;null!=(node=srcElements[i]);i++)cloneCopyEvent(node,destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),destElements=srcElements=node=null,clone},buildFragment:function(elems,context,scripts,selection){for(var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||safe.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)&&nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0])),!jQuery.support.tbody)for(elem="table"!==tag||rtbody.test(elem)?"<table>"!==wrap[1]||rtbody.test(elem)?0:tmp:tmp.firstChild,j=elem&&elem.childNodes.length;j--;)jQuery.nodeName(tbody=elem.childNodes[j],"tbody")&&!tbody.childNodes.length&&elem.removeChild(tbody);for(jQuery.merge(nodes,tmp.childNodes),tmp.textContent="";tmp.firstChild;)tmp.removeChild(tmp.firstChild);tmp=safe.lastChild}else nodes.push(context.createTextNode(elem));for(tmp&&safe.removeChild(tmp),jQuery.support.appendChecked||jQuery.grep(getAll(nodes,"input"),fixDefaultChecked),i=0;elem=nodes[i++];)if((!selection||-1===jQuery.inArray(elem,selection))&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(safe.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return tmp=null,safe},cleanData:function(elems,acceptData){for(var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=jQuery.support.deleteExpando,special=jQuery.event.special;null!=(elem=elems[i]);i++)if((acceptData||jQuery.acceptData(elem))&&(id=elem[internalKey],data=id&&cache[id])){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);cache[id]&&(delete cache[id],deleteExpando?delete elem[internalKey]:typeof elem.removeAttribute!==core_strundefined?elem.removeAttribute(internalKey):elem[internalKey]=null,core_deletedIds.push(id))}},_evalUrl:function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstChild&&1===elem.firstChild.nodeType;)elem=elem.firstChild;return elem}).append(this)}return this},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}});var iframe,getStyles,curCSS,ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rposition=/^(top|right|bottom|left)$/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rmargin=/^margin/,rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rrelNum=new RegExp("^([+-])=("+core_pnum+")","i"),elemdisplay={BODY:"block"},cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssExpand=["Top","Right","Bottom","Left"],cssPrefixes=["Webkit","O","Moz","ms"];jQuery.fn.extend({css:function(name,value){return jQuery.access(this,function(elem,name,value){var len,styles,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){var bool="boolean"==typeof state;return this.each(function(){(bool?state:isHidden(this))?jQuery(this).show():jQuery(this).hide()})}}),jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;if(name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],value===undefined)return hooks&&"get"in hooks&&(ret=hooks.get(elem,!1,extra))!==undefined?ret:style[name];if(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),!(null==value||"number"===type&&isNaN(value)||("number"!==type||jQuery.cssNumber[origName]||(value+="px"),jQuery.support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&(value=hooks.set(elem,value,extra))===undefined)))try{style[name]=value}catch(e){}}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),val===undefined&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),window.getComputedStyle?(getStyles=function(elem){return window.getComputedStyle(elem,null)},curCSS=function(elem,name,_computed){var width,minWidth,maxWidth,computed=_computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:undefined,style=elem.style;return computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),ret}):document.documentElement.currentStyle&&(getStyles=function(elem){return elem.currentStyle},curCSS=function(elem,name,_computed){var left,rs,rsLeft,computed=_computed||getStyles(elem),ret=computed?computed[name]:undefined,style=elem.style;return null==ret&&style&&style[name]&&(ret=style[name]),rnumnonpx.test(ret)&&!rposition.test(name)&&(left=style.left,rs=elem.runtimeStyle,rsLeft=rs&&rs.left,rsLeft&&(rs.left=elem.currentStyle.left),style.left="fontSize"===name?"1em":ret,ret=style.pixelLeft+"px",style.left=left,rsLeft&&(rs.left=rsLeft)),""===ret?"auto":ret}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?0===elem.offsetWidth&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),jQuery.support.opacity||(jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+100*value+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1,(value>=1||""===value)&&""===jQuery.trim(filter.replace(ralpha,""))&&style.removeAttribute&&(style.removeAttribute("filter"),""===value||currentStyle&&!currentStyle.filter)||(style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity)}}),jQuery(function(){jQuery.support.reliableMarginRight||(jQuery.cssHooks.marginRight={get:function(elem,computed){return computed?jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0}}),!jQuery.support.pixelPosition&&jQuery.fn.position&&jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]={get:function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0}}})}),jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||!jQuery.support.reliableHiddenOffsets&&"none"===(elem.style&&elem.style.display||jQuery.css(elem,"display"))},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!manipulation_rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var ajaxLocParts,ajaxLocation,ajax_nonce=jQuery.now(),ajax_rquery=/\?/,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_load=jQuery.fn.load,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,response,type,self=this,off=url.indexOf(" ");return off>=0&&(selector=url.slice(off,url.length),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=undefined):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=undefined,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=undefined,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=undefined),options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(core_rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(ajax_rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+ajax_nonce++):cacheURL+(ajax_rquery.test(cacheURL)?"&":"?")+"_="+ajax_nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=undefined),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){s.cache===undefined&&(s.cache=!1),s.crossDomain&&(s.type="GET",s.global=!1)}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script"),script.async=!0,s.scriptCharset&&(script.charset=s.scriptCharset),script.src=s.url,script.onload=script.onreadystatechange=function(_,isAbort){(isAbort||!script.readyState||/loaded|complete/.test(script.readyState))&&(script.onload=script.onreadystatechange=null,script.parentNode&&script.parentNode.removeChild(script),script=null,isAbort||callback(200,"success"))},head.insertBefore(script,head.firstChild)},abort:function(){script&&script.onload(undefined,!0)}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+ajax_nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(ajax_rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=undefined}),"script"):void 0});var xhrCallbacks,xhrSupported,xhrId=0,xhrOnUnloadAbort=window.ActiveXObject&&function(){var key;for(key in xhrCallbacks)xhrCallbacks[key](undefined,!0)};jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return!this.isLocal&&createStandardXHR()||createActiveXHR()
}:createStandardXHR,xhrSupported=jQuery.ajaxSettings.xhr(),jQuery.support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,xhrSupported=jQuery.support.ajax=!!xhrSupported,xhrSupported&&jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var handle,i,xhr=s.xhr();if(s.username?xhr.open(s.type,s.url,s.async,s.username,s.password):xhr.open(s.type,s.url,s.async),s.xhrFields)for(i in s.xhrFields)xhr[i]=s.xhrFields[i];s.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(s.mimeType),s.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");try{for(i in headers)xhr.setRequestHeader(i,headers[i])}catch(err){}xhr.send(s.hasContent&&s.data||null),callback=function(_,isAbort){var status,responseHeaders,statusText,responses;try{if(callback&&(isAbort||4===xhr.readyState))if(callback=undefined,handle&&(xhr.onreadystatechange=jQuery.noop,xhrOnUnloadAbort&&delete xhrCallbacks[handle]),isAbort)4!==xhr.readyState&&xhr.abort();else{responses={},status=xhr.status,responseHeaders=xhr.getAllResponseHeaders(),"string"==typeof xhr.responseText&&(responses.text=xhr.responseText);try{statusText=xhr.statusText}catch(e){statusText=""}status||!s.isLocal||s.crossDomain?1223===status&&(status=204):status=responses.text?200:404}}catch(firefoxAccessException){isAbort||complete(-1,firefoxAccessException)}responses&&complete(status,statusText,responses,responseHeaders)},s.async?4===xhr.readyState?setTimeout(callback):(handle=++xhrId,xhrOnUnloadAbort&&(xhrCallbacks||(xhrCallbacks={},jQuery(window).unload(xhrOnUnloadAbort)),xhrCallbacks[handle]=callback),xhr.onreadystatechange=callback):callback()},abort:function(){callback&&callback(undefined,!0)}}}});var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+core_pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(tween.unit=unit,tween.start=+start||+target||0,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.pos=eased=this.options.duration?jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);doAnimation.finish=function(){anim.stop(!0)},(empty||jQuery._data(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=undefined),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.cur&&hooks.cur.finish&&hooks.cur.finish.call(this),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,(null==opt.queue||opt.queue===!0)&&(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.timers=[],jQuery.fx=Tween.prototype.init,jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=undefined},jQuery.fx.timer=function(timer){timer()&&jQuery.timers.push(timer)&&jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fx.step={},jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length}),jQuery.fn.offset=function(options){if(arguments.length)return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==core_strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}):box},jQuery.offset={setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");"static"===position&&(elem.style.position="relative");var curTop,curLeft,curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={};calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({position:function(){if(this[0]){var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return jQuery.access(this,function(elem,method,val){var win=getWindow(elem);return val===undefined?win?prop in win?win[prop]:win.document.documentElement[method]:elem[method]:(win?win.scrollTo(top?jQuery(win).scrollLeft():val,top?val:jQuery(win).scrollTop()):elem[method]=val,void 0)},method,val,arguments.length,null)}}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return jQuery.access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"object"==typeof module&&"object"==typeof module.exports?module.exports=jQuery:(window.jQuery=window.$=jQuery,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery}))}(window),function($,undefined){$.rails!==undefined&&$.error("jquery-ujs has already been loaded!");var rails;$.rails=rails={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(xhr){var token=$('meta[name="csrf-token"]').attr("content");token&&xhr.setRequestHeader("X-CSRF-Token",token)},fire:function(obj,name,data){var event=$.Event(name);return obj.trigger(event,data),event.result!==!1},confirm:function(message){return confirm(message)},ajax:function(options){return $.ajax(options)},href:function(element){return element.attr("href")},handleRemote:function(element){var method,url,data,elCrossDomain,crossDomain,withCredentials,dataType,options;if(rails.fire(element,"ajax:before")){if(elCrossDomain=element.data("cross-domain"),crossDomain=elCrossDomain===undefined?null:elCrossDomain,withCredentials=element.data("with-credentials")||null,dataType=element.data("type")||$.ajaxSettings&&$.ajaxSettings.dataType,element.is("form")){method=element.attr("method"),url=element.attr("action"),data=element.serializeArray();var button=element.data("ujs:submit-button");button&&(data.push(button),element.data("ujs:submit-button",null))}else element.is(rails.inputChangeSelector)?(method=element.data("method"),url=element.data("url"),data=element.serialize(),element.data("params")&&(data=data+"&"+element.data("params"))):element.is(rails.buttonClickSelector)?(method=element.data("method")||"get",url=element.data("url"),data=element.serialize(),element.data("params")&&(data=data+"&"+element.data("params"))):(method=element.data("method"),url=rails.href(element),data=element.data("params")||null);options={type:method||"GET",data:data,dataType:dataType,beforeSend:function(xhr,settings){return settings.dataType===undefined&&xhr.setRequestHeader("accept","*/*;q=0.5, "+settings.accepts.script),rails.fire(element,"ajax:beforeSend",[xhr,settings])},success:function(data,status,xhr){element.trigger("ajax:success",[data,status,xhr])},complete:function(xhr,status){element.trigger("ajax:complete",[xhr,status])},error:function(xhr,status,error){element.trigger("ajax:error",[xhr,status,error])},crossDomain:crossDomain},withCredentials&&(options.xhrFields={withCredentials:withCredentials}),url&&(options.url=url);var jqxhr=rails.ajax(options);return element.trigger("ajax:send",jqxhr),jqxhr}return!1},handleMethod:function(link){var href=rails.href(link),method=link.data("method"),target=link.attr("target"),csrf_token=$("meta[name=csrf-token]").attr("content"),csrf_param=$("meta[name=csrf-param]").attr("content"),form=$('<form method="post" action="'+href+'"></form>'),metadata_input='<input name="_method" value="'+method+'" type="hidden" />';csrf_param!==undefined&&csrf_token!==undefined&&(metadata_input+='<input name="'+csrf_param+'" value="'+csrf_token+'" type="hidden" />'),target&&form.attr("target",target),form.hide().append(metadata_input).appendTo("body"),form.submit()},disableFormElements:function(form){form.find(rails.disableSelector).each(function(){var element=$(this),method=element.is("button")?"html":"val";element.data("ujs:enable-with",element[method]()),element[method](element.data("disable-with")),element.prop("disabled",!0)})},enableFormElements:function(form){form.find(rails.enableSelector).each(function(){var element=$(this),method=element.is("button")?"html":"val";element.data("ujs:enable-with")&&element[method](element.data("ujs:enable-with")),element.prop("disabled",!1)})},allowAction:function(element){var callback,message=element.data("confirm"),answer=!1;return message?(rails.fire(element,"confirm")&&(answer=rails.confirm(message),callback=rails.fire(element,"confirm:complete",[answer])),answer&&callback):!0},blankInputs:function(form,specifiedSelector,nonBlank){var input,valueToCheck,inputs=$(),selector=specifiedSelector||"input,textarea",allInputs=form.find(selector);return allInputs.each(function(){if(input=$(this),valueToCheck=input.is("input[type=checkbox],input[type=radio]")?input.is(":checked"):input.val(),!valueToCheck==!nonBlank){if(input.is("input[type=radio]")&&allInputs.filter('input[type=radio]:checked[name="'+input.attr("name")+'"]').length)return!0;inputs=inputs.add(input)}}),inputs.length?inputs:!1},nonBlankInputs:function(form,specifiedSelector){return rails.blankInputs(form,specifiedSelector,!0)},stopEverything:function(e){return $(e.target).trigger("ujs:everythingStopped"),e.stopImmediatePropagation(),!1},disableElement:function(element){element.data("ujs:enable-with",element.html()),element.html(element.data("disable-with")),element.bind("click.railsDisable",function(e){return rails.stopEverything(e)})},enableElement:function(element){element.data("ujs:enable-with")!==undefined&&(element.html(element.data("ujs:enable-with")),element.removeData("ujs:enable-with")),element.unbind("click.railsDisable")}},rails.fire($(document),"rails:attachBindings")&&($.ajaxPrefilter(function(options,originalOptions,xhr){options.crossDomain||rails.CSRFProtection(xhr)}),$(document).delegate(rails.linkDisableSelector,"ajax:complete",function(){rails.enableElement($(this))}),$(document).delegate(rails.linkClickSelector,"click.rails",function(e){var link=$(this),method=link.data("method"),data=link.data("params");if(!rails.allowAction(link))return rails.stopEverything(e);if(link.is(rails.linkDisableSelector)&&rails.disableElement(link),link.data("remote")!==undefined){if(!(!e.metaKey&&!e.ctrlKey||method&&"GET"!==method||data))return!0;var handleRemote=rails.handleRemote(link);return handleRemote===!1?rails.enableElement(link):handleRemote.error(function(){rails.enableElement(link)}),!1}return link.data("method")?(rails.handleMethod(link),!1):void 0}),$(document).delegate(rails.buttonClickSelector,"click.rails",function(e){var button=$(this);return rails.allowAction(button)?(rails.handleRemote(button),!1):rails.stopEverything(e)}),$(document).delegate(rails.inputChangeSelector,"change.rails",function(e){var link=$(this);return rails.allowAction(link)?(rails.handleRemote(link),!1):rails.stopEverything(e)}),$(document).delegate(rails.formSubmitSelector,"submit.rails",function(e){var form=$(this),remote=form.data("remote")!==undefined,blankRequiredInputs=rails.blankInputs(form,rails.requiredInputSelector),nonBlankFileInputs=rails.nonBlankInputs(form,rails.fileInputSelector);if(!rails.allowAction(form))return rails.stopEverything(e);if(blankRequiredInputs&&form.attr("novalidate")==undefined&&rails.fire(form,"ajax:aborted:required",[blankRequiredInputs]))return rails.stopEverything(e);if(remote){if(nonBlankFileInputs){setTimeout(function(){rails.disableFormElements(form)},13);var aborted=rails.fire(form,"ajax:aborted:file",[nonBlankFileInputs]);return aborted||setTimeout(function(){rails.enableFormElements(form)},13),aborted}return rails.handleRemote(form),!1}setTimeout(function(){rails.disableFormElements(form)},13)}),$(document).delegate(rails.formInputClickSelector,"click.rails",function(event){var button=$(this);if(!rails.allowAction(button))return rails.stopEverything(event);var name=button.attr("name"),data=name?{name:name,value:button.val()}:null;button.closest("form").data("ujs:submit-button",data)}),$(document).delegate(rails.formSubmitSelector,"ajax:beforeSend.rails",function(event){this==event.target&&rails.disableFormElements($(this))}),$(document).delegate(rails.formSubmitSelector,"ajax:complete.rails",function(event){this==event.target&&rails.enableFormElements($(this))}),$(function(){var csrf_token=$("meta[name=csrf-token]").attr("content"),csrf_param=$("meta[name=csrf-param]").attr("content");$('form input[name="'+csrf_param+'"]').val(csrf_token)}))}(jQuery),/*!
 * jQuery UI Core 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
function($,undefined){function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();return"area"===nodeName?(map=element.parentNode,mapName=map.name,element.href&&mapName&&"map"===map.nodeName.toLowerCase()?(img=$("img[usemap=#"+mapName+"]")[0],!!img&&visible(img)):!1):(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length}var uuid=0,runiqueId=/^ui-id-\d+$/;$.ui=$.ui||{},$.extend($.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),$.fn.extend({focus:function(orig){return function(delay,fn){return"number"==typeof delay?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus(),fn&&fn.call(elem)},delay)}):orig.apply(this,arguments)}}($.fn.focus),scrollParent:function(){var scrollParent;return scrollParent=$.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test($.css(this,"position"))&&/(auto|scroll)/.test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!scrollParent.length?$(document):scrollParent},zIndex:function(zIndex){if(zIndex!==undefined)return this.css("zIndex",zIndex);if(this.length)for(var position,value,elem=$(this[0]);elem.length&&elem[0]!==document;){if(position=elem.css("position"),("absolute"===position||"relative"===position||"fixed"===position)&&(value=parseInt(elem.css("zIndex"),10),!isNaN(value)&&0!==value))return value;elem=elem.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++uuid)})},removeUniqueId:function(){return this.each(function(){runiqueId.test(this.id)&&$(this).removeAttr("id")})}}),$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)}}),$("<a>").outerWidth(1).jquery||$.each(["Width","Height"],function(i,name){function reduce(elem,size,border,margin){return $.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0,border&&(size-=parseFloat($.css(elem,"border"+this+"Width"))||0),margin&&(size-=parseFloat($.css(elem,"margin"+this))||0)}),size}var side="Width"===name?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};$.fn["inner"+name]=function(size){return size===undefined?orig["inner"+name].call(this):this.each(function(){$(this).css(type,reduce(this,size)+"px")})},$.fn["outer"+name]=function(size,margin){return"number"!=typeof size?orig["outer"+name].call(this,size):this.each(function(){$(this).css(type,reduce(this,size,!0,margin)+"px")})}}),$.fn.addBack||($.fn.addBack=function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}),$("<a>").data("a-b","a").removeData("a-b").data("a-b")&&($.fn.removeData=function(removeData){return function(key){return arguments.length?removeData.call(this,$.camelCase(key)):removeData.call(this)}}($.fn.removeData)),$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),$.support.selectstart="onselectstart"in document.createElement("div"),$.fn.extend({disableSelection:function(){return this.bind(($.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(event){event.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),$.extend($.ui,{plugin:{add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set)proto.plugins[i]=proto.plugins[i]||[],proto.plugins[i].push([option,set[i]])},call:function(instance,name,args){var i,set=instance.plugins[name];if(set&&instance.element[0].parentNode&&11!==instance.element[0].parentNode.nodeType)for(i=0;i<set.length;i++)instance.options[set[i][0]]&&set[i][1].apply(instance.element,args)}},hasScroll:function(el,a){if("hidden"===$(el).css("overflow"))return!1;var scroll=a&&"left"===a?"scrollLeft":"scrollTop",has=!1;return el[scroll]>0?!0:(el[scroll]=1,has=el[scroll]>0,el[scroll]=0,has)}})}(jQuery),/*!
 * jQuery UI Widget 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
function($,undefined){var uuid=0,slice=Array.prototype.slice,_cleanData=$.cleanData;$.cleanData=function(elems){for(var elem,i=0;null!=(elem=elems[i]);i++)try{$(elem).triggerHandler("remove")}catch(e){}_cleanData(elems)},$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1],fullName=namespace+"-"+name,prototype||(prototype=base,base=$.Widget),$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)},$[namespace]=$[namespace]||{},existingConstructor=$[namespace][name],constructor=$[namespace][name]=function(options,element){return this._createWidget?(arguments.length&&this._createWidget(options,element),void 0):new constructor(options,element)},$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]}),basePrototype=new base,basePrototype.options=$.widget.extend({},basePrototype.options),$.each(prototype,function(prop,value){return $.isFunction(value)?(proxiedPrototype[prop]=function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var returnValue,__super=this._super,__superApply=this._superApply;return this._super=_super,this._superApply=_superApply,returnValue=value.apply(this,arguments),this._super=__super,this._superApply=__superApply,returnValue}}(),void 0):(proxiedPrototype[prop]=value,void 0)}),constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName}),existingConstructor?($.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)}),delete existingConstructor._childConstructors):base._childConstructors.push(constructor),$.widget.bridge(name,constructor)},$.widget.extend=function(target){for(var key,value,input=slice.call(arguments,1),inputIndex=0,inputLength=input.length;inputLength>inputIndex;inputIndex++)for(key in input[inputIndex])value=input[inputIndex][key],input[inputIndex].hasOwnProperty(key)&&value!==undefined&&(target[key]=$.isPlainObject(value)?$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value):value);return target},$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall="string"==typeof options,args=slice.call(arguments,1),returnValue=this;return options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options,isMethodCall?this.each(function(){var methodValue,instance=$.data(this,fullName);return instance?$.isFunction(instance[options])&&"_"!==options.charAt(0)?(methodValue=instance[options].apply(instance,args),methodValue!==instance&&methodValue!==undefined?(returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue,!1):void 0):$.error("no such method '"+options+"' for "+name+" widget instance"):$.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'")}):this.each(function(){var instance=$.data(this,fullName);instance?instance.option(options||{})._init():$.data(this,fullName,new object(options,this))}),returnValue}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0],this.element=$(element),this.uuid=uuid++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=$.widget.extend({},this.options,this._getCreateOptions(),options),this.bindings=$(),this.hoverable=$(),this.focusable=$(),element!==this&&($.data(element,this.widgetFullName,this),this._on(!0,this.element,{remove:function(event){event.target===element&&this.destroy()}}),this.document=$(element.style?element.ownerDocument:element.document||element),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var parts,curOption,i,options=key;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof key)if(options={},parts=key.split("."),key=parts.shift(),parts.length){for(curOption=options[key]=$.widget.extend({},this.options[key]),i=0;i<parts.length-1;i++)curOption[parts[i]]=curOption[parts[i]]||{},curOption=curOption[parts[i]];if(key=parts.pop(),value===undefined)return curOption[key]===undefined?null:curOption[key];curOption[key]=value}else{if(value===undefined)return this.options[key]===undefined?null:this.options[key];options[key]=value}return this._setOptions(options),this},_setOptions:function(options){var key;for(key in options)this._setOption(key,options[key]);return this},_setOption:function(key,value){return this.options[key]=value,"disabled"===key&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!value).attr("aria-disabled",value),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;"boolean"!=typeof suppressDisabledCheck&&(handlers=element,element=suppressDisabledCheck,suppressDisabledCheck=!1),handlers?(element=delegateElement=$(element),this.bindings=this.bindings.add(element)):(handlers=element,element=this.element,delegateElement=this.widget()),$.each(handlers,function(event,handler){function handlerProxy(){return suppressDisabledCheck||instance.options.disabled!==!0&&!$(this).hasClass("ui-state-disabled")?("string"==typeof handler?instance[handler]:handler).apply(instance,arguments):void 0}"string"!=typeof handler&&(handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++);var match=event.match(/^(\w+)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];selector?delegateElement.delegate(selector,eventName,handlerProxy):element.bind(eventName,handlerProxy)})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,element.unbind(eventName).undelegate(eventName)},_delay:function(handler,delay){function handlerProxy(){return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element),this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover")},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element),this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus")},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];if(data=data||{},event=$.Event(event),event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase(),event.target=this.element[0],orig=event.originalEvent)for(prop in orig)prop in event||(event[prop]=orig[prop]);return this.element.trigger(event,data),!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===!1||event.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){"string"==typeof options&&(options={effect:options});var hasOptions,effectName=options?options===!0||"number"==typeof options?defaultEffect:options.effect||defaultEffect:method;options=options||{},"number"==typeof options&&(options={duration:options}),hasOptions=!$.isEmptyObject(options),options.complete=callback,options.delay&&element.delay(options.delay),hasOptions&&$.effects&&$.effects.effect[effectName]?element[method](options):effectName!==method&&element[effectName]?element[effectName](options.duration,options.easing,callback):element.queue(function(next){$(this)[method](),callback&&callback.call(element[0]),next()})}})}(jQuery),/*!
 * jQuery UI Mouse 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/mouse/
 *
 * Depends:
 *	jquery.ui.widget.js
 */
function($){var mouseHandled=!1;$(document).mouseup(function(){mouseHandled=!1}),$.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event){return that._mouseDown(event)}).bind("click."+this.widgetName,function(event){return!0===$.data(event.target,that.widgetName+".preventClickEvent")?($.removeData(event.target,that.widgetName+".preventClickEvent"),event.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(event){if(!mouseHandled){this._mouseStarted&&this._mouseUp(event),this._mouseDownEvent=event;var that=this,btnIsLeft=1===event.which,elIsCancel="string"==typeof this.options.cancel&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:!1;return btnIsLeft&&!elIsCancel&&this._mouseCapture(event)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=this._mouseStart(event)!==!1,!this._mouseStarted)?(event.preventDefault(),!0):(!0===$.data(event.target,this.widgetName+".preventClickEvent")&&$.removeData(event.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(event){return that._mouseMove(event)},this._mouseUpDelegate=function(event){return that._mouseUp(event)},$(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),event.preventDefault(),mouseHandled=!0,!0)):!0}},_mouseMove:function(event){return $.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button?this._mouseUp(event):this._mouseStarted?(this._mouseDrag(event),event.preventDefault()):(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,event)!==!1,this._mouseStarted?this._mouseDrag(event):this._mouseUp(event)),!this._mouseStarted)},_mouseUp:function(event){return $(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,event.target===this._mouseDownEvent.target&&$.data(event.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(event)),!1},_mouseDistanceMet:function(event){return Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),/*!
 * jQuery UI Draggable 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
function($){$.widget("ui.draggable",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(event){var o=this.options;return this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(event),this.handle?($(o.iframeFix===!0?"iframe":o.iframeFix).each(function(){$("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css($(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(event){var o=this.options;return this.helper=this._createHelper(event),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(event),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this._setContainment(),this._trigger("start",event)===!1?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this._mouseDrag(event,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,event),!0)},_mouseDrag:function(event,noPropagation){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(event),this.positionAbs=this._convertPositionTo("absolute"),!noPropagation){var ui=this._uiHash();if(this._trigger("drag",event,ui)===!1)return this._mouseUp({}),!1;this.position=ui.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),!1},_mouseStop:function(event){var that=this,dropped=!1;return $.ui.ddmanager&&!this.options.dropBehaviour&&(dropped=$.ui.ddmanager.drop(this,event)),this.dropped&&(dropped=this.dropped,this.dropped=!1),"original"!==this.options.helper||$.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!dropped||"valid"===this.options.revert&&dropped||this.options.revert===!0||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){that._trigger("stop",event)!==!1&&that._clear()}):this._trigger("stop",event)!==!1&&this._clear(),!1):!1},_mouseUp:function(event){return $("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,event),$.ui.mouse.prototype._mouseUp.call(this,event)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(event){return this.options.handle?!!$(event.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event])):"clone"===o.helper?this.element.clone().removeAttr("id"):this.element;return helper.parents("body").length||helper.appendTo("parent"===o.appendTo?this.element[0].parentNode:o.appendTo),helper[0]===this.element[0]||/(fixed|absolute)/.test(helper.css("position"))||helper.css("position","absolute"),helper},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_getParentOffset:function(){var po=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.ui.ie)&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var p=this.element.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var over,c,ce,o=this.options;return o.containment?"window"===o.containment?(this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===o.containment?(this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):o.containment.constructor===Array?(this.containment=o.containment,void 0):("parent"===o.containment&&(o.containment=this.helper[0].parentNode),c=$(o.containment),ce=c[0],ce&&(over="hidden"!==c.css("overflow"),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c),void 0):(this.containment=null,void 0)},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:scroll.scrollTop(),left:scroll.scrollLeft()}),{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*mod}},_generatePosition:function(event){var containment,co,top,left,o=this.options,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,pageX=event.pageX,pageY=event.pageY;return this.offset.scroll||(this.offset.scroll={top:scroll.scrollTop(),left:scroll.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(co=this.relative_container.offset(),containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top]):containment=this.containment,event.pageX-this.offset.click.left<containment[0]&&(pageX=containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<containment[1]&&(pageY=containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>containment[2]&&(pageX=containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>containment[3]&&(pageY=containment[3]+this.offset.click.top)),o.grid&&(top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,pageY=containment?top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3]?top:top-this.offset.click.top>=containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,pageX=containment?left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2]?left:left-this.offset.click.left>=containment[0]?left-o.grid[0]:left+o.grid[0]:left)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(type,event,ui){return ui=ui||this._uiHash(),$.ui.plugin.call(this,type,[event,ui]),"drag"===type&&(this.positionAbs=this._convertPositionTo("absolute")),$.Widget.prototype._trigger.call(this,type,event,ui)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui){var inst=$(this).data("ui-draggable"),o=inst.options,uiSortable=$.extend({},ui,{item:inst.element});inst.sortables=[],$(o.connectToSortable).each(function(){var sortable=$.data(this,"ui-sortable");sortable&&!sortable.options.disabled&&(inst.sortables.push({instance:sortable,shouldRevert:sortable.options.revert}),sortable.refreshPositions(),sortable._trigger("activate",event,uiSortable))})},stop:function(event,ui){var inst=$(this).data("ui-draggable"),uiSortable=$.extend({},ui,{item:inst.element});$.each(inst.sortables,function(){this.instance.isOver?(this.instance.isOver=0,inst.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(event),this.instance.options.helper=this.instance.options._helper,"original"===inst.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",event,uiSortable))})},drag:function(event,ui){var inst=$(this).data("ui-draggable"),that=this;$.each(inst.sortables,function(){var innermostIntersecting=!1,thisSortable=this;this.instance.positionAbs=inst.positionAbs,this.instance.helperProportions=inst.helperProportions,this.instance.offset.click=inst.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(innermostIntersecting=!0,$.each(inst.sortables,function(){return this.instance.positionAbs=inst.positionAbs,this.instance.helperProportions=inst.helperProportions,this.instance.offset.click=inst.offset.click,this!==thisSortable&&this.instance._intersectsWith(this.instance.containerCache)&&$.contains(thisSortable.instance.element[0],this.instance.element[0])&&(innermostIntersecting=!1),innermostIntersecting})),innermostIntersecting?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=$(that).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return ui.helper[0]},event.target=this.instance.currentItem[0],this.instance._mouseCapture(event,!0),this.instance._mouseStart(event,!0,!0),this.instance.offset.click.top=inst.offset.click.top,this.instance.offset.click.left=inst.offset.click.left,this.instance.offset.parent.left-=inst.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=inst.offset.parent.top-this.instance.offset.parent.top,inst._trigger("toSortable",event),inst.dropped=this.instance.element,inst.currentItem=inst.element,this.instance.fromOutside=inst),this.instance.currentItem&&this.instance._mouseDrag(event)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",event,this.instance._uiHash(this.instance)),this.instance._mouseStop(event,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),inst._trigger("fromSortable",event),inst.dropped=!1)})}}),$.ui.plugin.add("draggable","cursor",{start:function(){var t=$("body"),o=$(this).data("ui-draggable").options;t.css("cursor")&&(o._cursor=t.css("cursor")),t.css("cursor",o.cursor)},stop:function(){var o=$(this).data("ui-draggable").options;o._cursor&&$("body").css("cursor",o._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(event,ui){var t=$(ui.helper),o=$(this).data("ui-draggable").options;t.css("opacity")&&(o._opacity=t.css("opacity")),t.css("opacity",o.opacity)},stop:function(event,ui){var o=$(this).data("ui-draggable").options;o._opacity&&$(ui.helper).css("opacity",o._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(){var i=$(this).data("ui-draggable");i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName&&(i.overflowOffset=i.scrollParent.offset())},drag:function(event){var i=$(this).data("ui-draggable"),o=i.options,scrolled=!1;i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName?(o.axis&&"x"===o.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-event.pageY<o.scrollSensitivity?i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop+o.scrollSpeed:event.pageY-i.overflowOffset.top<o.scrollSensitivity&&(i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-event.pageX<o.scrollSensitivity?i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft+o.scrollSpeed:event.pageX-i.overflowOffset.left<o.scrollSensitivity&&(i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(event.pageY-$(document).scrollTop()<o.scrollSensitivity?scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity&&(scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(event.pageX-$(document).scrollLeft()<o.scrollSensitivity?scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)))),scrolled!==!1&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(i,event)}}),$.ui.plugin.add("draggable","snap",{start:function(){var i=$(this).data("ui-draggable"),o=i.options;i.snapElements=[],$(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var $t=$(this),$o=$t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left})})},drag:function(event,ui){var ts,bs,ls,rs,l,r,t,b,i,first,inst=$(this).data("ui-draggable"),o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--)l=inst.snapElements[i].left,r=l+inst.snapElements[i].width,t=inst.snapElements[i].top,b=t+inst.snapElements[i].height,l-d>x2||x1>r+d||t-d>y2||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)?(inst.snapElements[i].snapping&&inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=!1):("inner"!==o.snapMode&&(ts=Math.abs(t-y2)<=d,bs=Math.abs(b-y1)<=d,ls=Math.abs(l-x2)<=d,rs=Math.abs(r-x1)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top-inst.margins.top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top-inst.margins.top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left-inst.margins.left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left-inst.margins.left)),first=ts||bs||ls||rs,"outer"!==o.snapMode&&(ts=Math.abs(t-y1)<=d,bs=Math.abs(b-y2)<=d,ls=Math.abs(l-x1)<=d,rs=Math.abs(r-x2)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top-inst.margins.top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top-inst.margins.top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left-inst.margins.left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left-inst.margins.left)),!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)&&inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=ts||bs||ls||rs||first)}}),$.ui.plugin.add("draggable","stack",{start:function(){var min,o=this.data("ui-draggable").options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});group.length&&(min=parseInt($(group[0]).css("zIndex"),10)||0,$(group).each(function(i){$(this).css("zIndex",min+i)}),this.css("zIndex",min+group.length))}}),$.ui.plugin.add("draggable","zIndex",{start:function(event,ui){var t=$(ui.helper),o=$(this).data("ui-draggable").options;t.css("zIndex")&&(o._zIndex=t.css("zIndex")),t.css("zIndex",o.zIndex)},stop:function(event,ui){var o=$(this).data("ui-draggable").options;o._zIndex&&$(ui.helper).css("zIndex",o._zIndex)}})}(jQuery),/*!
 * jQuery UI Droppable 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/droppable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 */
function($){function isOverAxis(x,reference,size){return x>reference&&reference+size>x}$.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var o=this.options,accept=o.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},$.ui.ddmanager.droppables[o.scope]=$.ui.ddmanager.droppables[o.scope]||[],$.ui.ddmanager.droppables[o.scope].push(this),o.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var i=0,drop=$.ui.ddmanager.droppables[this.options.scope];i<drop.length;i++)drop[i]===this&&drop.splice(i,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(key,value){"accept"===key&&(this.accept=$.isFunction(value)?value:function(d){return d.is(value)}),$.Widget.prototype._setOption.apply(this,arguments)},_activate:function(event){var draggable=$.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),draggable&&this._trigger("activate",event,this.ui(draggable))},_deactivate:function(event){var draggable=$.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),draggable&&this._trigger("deactivate",event,this.ui(draggable))},_over:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",event,this.ui(draggable)))},_out:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",event,this.ui(draggable)))},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=!1;return draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$.data(this,"ui-droppable");return inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],draggable.currentItem||draggable.element)&&$.ui.intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance)?(childrenIntersection=!0,!1):void 0}),childrenIntersection?!1:this.accept.call(this.element[0],draggable.currentItem||draggable.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",event,this.ui(draggable)),this.element):!1):!1},ui:function(c){return{draggable:c.currentItem||c.element,helper:c.helper,position:c.position,offset:c.positionAbs}}}),$.ui.intersect=function(draggable,droppable,toleranceMode){if(!droppable.offset)return!1;var draggableLeft,draggableTop,x1=(draggable.positionAbs||draggable.position.absolute).left,x2=x1+draggable.helperProportions.width,y1=(draggable.positionAbs||draggable.position.absolute).top,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,r=l+droppable.proportions.width,t=droppable.offset.top,b=t+droppable.proportions.height;switch(toleranceMode){case"fit":return x1>=l&&r>=x2&&y1>=t&&b>=y2;case"intersect":return l<x1+draggable.helperProportions.width/2&&x2-draggable.helperProportions.width/2<r&&t<y1+draggable.helperProportions.height/2&&y2-draggable.helperProportions.height/2<b;case"pointer":return draggableLeft=(draggable.positionAbs||draggable.position.absolute).left+(draggable.clickOffset||draggable.offset.click).left,draggableTop=(draggable.positionAbs||draggable.position.absolute).top+(draggable.clickOffset||draggable.offset.click).top,isOverAxis(draggableTop,t,droppable.proportions.height)&&isOverAxis(draggableLeft,l,droppable.proportions.width);case"touch":return(y1>=t&&b>=y1||y2>=t&&b>=y2||t>y1&&y2>b)&&(x1>=l&&r>=x1||x2>=l&&r>=x2||l>x1&&x2>r);default:return!1}},$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++)if(!(m[i].options.disabled||t&&!m[i].accept.call(m[i].element[0],t.currentItem||t.element))){for(j=0;j<list.length;j++)if(list[j]===m[i].element[0]){m[i].proportions.height=0;continue droppablesLoop}m[i].visible="none"!==m[i].element.css("display"),m[i].visible&&("mousedown"===type&&m[i]._activate.call(m[i],event),m[i].offset=m[i].element.offset(),m[i].proportions={width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight})}},drop:function(draggable,event){var dropped=!1;return $.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&$.ui.intersect(draggable,this,this.options.tolerance)&&(dropped=this._drop.call(this,event)||dropped),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,event)))}),dropped},dragStart:function(draggable,event){draggable.element.parentsUntil("body").bind("scroll.droppable",function(){draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)})},drag:function(draggable,event){draggable.options.refreshPositions&&$.ui.ddmanager.prepareOffsets(draggable,event),$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var parentInstance,scope,parent,intersects=$.ui.intersect(draggable,this,this.options.tolerance),c=!intersects&&this.isover?"isout":intersects&&!this.isover?"isover":null;c&&(this.options.greedy&&(scope=this.options.scope,parent=this.element.parents(":data(ui-droppable)").filter(function(){return $.data(this,"ui-droppable").options.scope===scope}),parent.length&&(parentInstance=$.data(parent[0],"ui-droppable"),parentInstance.greedyChild="isover"===c)),parentInstance&&"isover"===c&&(parentInstance.isover=!1,parentInstance.isout=!0,parentInstance._out.call(parentInstance,event)),this[c]=!0,this["isout"===c?"isover":"isout"]=!1,this["isover"===c?"_over":"_out"].call(this,event),parentInstance&&"isout"===c&&(parentInstance.isout=!1,parentInstance.isover=!0,parentInstance._over.call(parentInstance,event)))}})},dragStop:function(draggable,event){draggable.element.parentsUntil("body").unbind("scroll.droppable"),draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)}}}(jQuery),/*!
 * jQuery UI Sortable 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/sortable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
function($){function isOverAxis(x,reference,size){return x>reference&&reference+size>x}function isFloating(item){return/left|right/.test(item.css("float"))||/inline|table-cell/.test(item.css("display"))}$.widget("ui.sortable",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var o=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===o.axis||isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--)this.items[i].item.removeData(this.widgetName+"-item");return this},_setOption:function(key,value){"disabled"===key?(this.options[key]=value,this.widget().toggleClass("ui-sortable-disabled",!!value)):$.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=!1,that=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(event),$(event.target).parents().each(function(){return $.data(this,that.widgetName+"-item")===that?(currentItem=$(this),!1):void 0}),$.data(event.target,that.widgetName+"-item")===that&&(currentItem=$(event.target)),currentItem?!this.options.handle||overrideHandle||($(this.options.handle,currentItem).find("*").addBack().each(function(){this===event.target&&(validHandle=!0)}),validHandle)?(this.currentItem=currentItem,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(event,overrideHandle,noActivation){var i,body,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(event),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(event),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(body=this.document.find("body"),this.storedCursor=body.css("cursor"),body.css("cursor",o.cursor),this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",event,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!noActivation)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",event,this._uiHash(this));return $.ui.ddmanager&&($.ui.ddmanager.current=this),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(event),!0},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=!1;for(this.position=this._generatePosition(event),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-event.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed:event.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-event.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed:event.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(event.pageY-$(document).scrollTop()<o.scrollSensitivity?scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity&&(scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed)),event.pageX-$(document).scrollLeft()<o.scrollSensitivity?scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed))),scrolled!==!1&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(item=this.items[i],itemElement=item.item[0],intersection=this._intersectsWithPointer(item),intersection&&item.instance===this.currentContainer&&itemElement!==this.currentItem[0]&&this.placeholder[1===intersection?"next":"prev"]()[0]!==itemElement&&!$.contains(this.placeholder[0],itemElement)&&("semi-dynamic"===this.options.type?!$.contains(this.element[0],itemElement):!0)){if(this.direction=1===intersection?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(item))break;this._rearrange(event,item),this._trigger("change",event,this._uiHash());break}return this._contactContainers(event),$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),this._trigger("sort",event,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(event,noPropagation){if(event){if($.ui.ddmanager&&!this.options.dropBehaviour&&$.ui.ddmanager.drop(this,event),this.options.revert){var that=this,cur=this.placeholder.offset(),axis=this.options.axis,animation={};axis&&"x"!==axis||(animation.left=cur.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),axis&&"y"!==axis||(animation.top=cur.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){that._clear(event)})}else this._clear(event,noPropagation);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("deactivate",null,this._uiHash(this)),this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",null,this._uiHash(this)),this.containers[i].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),$.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?$(this.domPosition.prev).after(this.currentItem):$(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];return o=o||{},$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||/(.+)[\-=_](.+)/);res&&str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]))}),!str.length&&o.key&&str.push(o.key+"="),str.join("&")},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];return o=o||{},items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"")}),ret},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElementHeight="x"===this.options.axis||y1+dyClick>t&&b>y1+dyClick,isOverElementWidth="y"===this.options.axis||x1+dxClick>l&&r>x1+dxClick,isOverElement=isOverElementHeight&&isOverElementWidth;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"]?isOverElement:l<x1+this.helperProportions.width/2&&x2-this.helperProportions.width/2<r&&t<y1+this.helperProportions.height/2&&y2-this.helperProportions.height/2<b},_intersectsWithPointer:function(item){var isOverElementHeight="x"===this.options.axis||isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth="y"===this.options.axis||isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),isOverElement=isOverElementHeight&&isOverElementWidth,verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();return isOverElement?this.floating?horizontalDirection&&"right"===horizontalDirection||"down"===verticalDirection?2:1:verticalDirection&&("down"===verticalDirection?2:1):!1},_intersectsWithSides:function(item){var isOverBottomHalf=isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+item.height/2,item.height),isOverRightHalf=isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+item.width/2,item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();return this.floating&&horizontalDirection?"right"===horizontalDirection&&isOverRightHalf||"left"===horizontalDirection&&!isOverRightHalf:verticalDirection&&("down"===verticalDirection&&isOverBottomHalf||"up"===verticalDirection&&!isOverBottomHalf)},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return 0!==delta&&(delta>0?"down":"up")},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return 0!==delta&&(delta>0?"right":"left")},refresh:function(event){return this._refreshItems(event),this.refreshPositions(),this},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith},_getItemsAsjQuery:function(connected){var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected)for(i=connectWith.length-1;i>=0;i--)for(cur=$(connectWith[i]),j=cur.length-1;j>=0;j--)inst=$.data(cur[j],this.widgetFullName),inst&&inst!==this&&!inst.options.disabled&&queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);for(queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=queries.length-1;i>=0;i--)queries[i][0].each(function(){items.push(this)});return $(items)},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++)if(list[j]===item.item[0])return!1;return!0})},_refreshItems:function(event){this.items=[],this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready)for(i=connectWith.length-1;i>=0;i--)for(cur=$(connectWith[i]),j=cur.length-1;j>=0;j--)inst=$.data(cur[j],this.widgetFullName),inst&&inst!==this&&!inst.options.disabled&&(queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]),this.containers.push(inst));for(i=queries.length-1;i>=0;i--)for(targetData=queries[i][1],_queries=queries[i][0],j=0,queriesLength=_queries.length;queriesLength>j;j++)item=$(_queries[j]),item.data(this.widgetName+"-item",targetData),items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0})},refreshPositions:function(fast){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,item,t,p;for(i=this.items.length-1;i>=0;i--)item=this.items[i],item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]||(t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item,fast||(item.width=t.outerWidth(),item.height=t.outerHeight()),p=t.offset(),item.left=p.left,item.top=p.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)p=this.containers[i].element.offset(),this.containers[i].containerCache.left=p.left,this.containers[i].containerCache.top=p.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(that){that=that||this;var className,o=that.options;o.placeholder&&o.placeholder.constructor!==String||(className=o.placeholder,o.placeholder={element:function(){var nodeName=that.currentItem[0].nodeName.toLowerCase(),element=$("<"+nodeName+">",that.document[0]).addClass(className||that.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===nodeName?that.currentItem.children().each(function(){$("<td>&#160;</td>",that.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(element)}):"img"===nodeName&&element.attr("src",that.currentItem.attr("src")),className||element.css("visibility","hidden"),element},update:function(container,p){(!className||o.forcePlaceholderSize)&&(p.height()||p.height(that.currentItem.innerHeight()-parseInt(that.currentItem.css("paddingTop")||0,10)-parseInt(that.currentItem.css("paddingBottom")||0,10)),p.width()||p.width(that.currentItem.innerWidth()-parseInt(that.currentItem.css("paddingLeft")||0,10)-parseInt(that.currentItem.css("paddingRight")||0,10)))}}),that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem)),that.currentItem.after(that.placeholder),o.placeholder.update(that,that.placeholder)},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,base,cur,nearBottom,floating,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--)if(!$.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0]))continue;innermostContainer=this.containers[i],innermostIndex=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",event,this._uiHash(this)),this.containers[i].containerCache.over=0);if(innermostContainer)if(1===this.containers.length)this.containers[innermostIndex].containerCache.over||(this.containers[innermostIndex]._trigger("over",event,this._uiHash(this)),this.containers[innermostIndex].containerCache.over=1);else{for(dist=1e4,itemWithLeastDistance=null,floating=innermostContainer.floating||isFloating(this.currentItem),posProperty=floating?"left":"top",sizeProperty=floating?"width":"height",base=this.positionAbs[posProperty]+this.offset.click[posProperty],j=this.items.length-1;j>=0;j--)$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])&&this.items[j].item[0]!==this.currentItem[0]&&(!floating||isOverAxis(this.positionAbs.top+this.offset.click.top,this.items[j].top,this.items[j].height))&&(cur=this.items[j].item.offset()[posProperty],nearBottom=!1,Math.abs(cur-base)>Math.abs(cur+this.items[j][sizeProperty]-base)&&(nearBottom=!0,cur+=this.items[j][sizeProperty]),Math.abs(cur-base)<dist&&(dist=Math.abs(cur-base),itemWithLeastDistance=this.items[j],this.direction=nearBottom?"up":"down"));if(!itemWithLeastDistance&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[innermostIndex])return;itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,!0):this._rearrange(event,null,this.containers[innermostIndex].element,!0),this._trigger("change",event,this._uiHash()),this.containers[innermostIndex]._trigger("change",event,this._uiHash(this)),this.currentContainer=this.containers[innermostIndex],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[innermostIndex]._trigger("over",event,this._uiHash(this)),this.containers[innermostIndex].containerCache.over=1}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):"clone"===o.helper?this.currentItem.clone():this.currentItem;return helper.parents("body").length||$("parent"!==o.appendTo?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]),helper[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!helper[0].style.width||o.forceHelperSize)&&helper.width(this.currentItem.width()),(!helper[0].style.height||o.forceHelperSize)&&helper.height(this.currentItem.height()),helper},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.ui.ie)&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var ce,co,over,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),("document"===o.containment||"window"===o.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$("document"===o.containment?document:window).width()-this.helperProportions.width-this.margins.left,($("document"===o.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(ce=$(o.containment)[0],co=$(o.containment).offset(),over="hidden"!==$(ce).css("overflow"),this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop())*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod}},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(event.pageX-this.offset.click.left<this.containment[0]&&(pageX=this.containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<this.containment[1]&&(pageY=this.containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>this.containment[2]&&(pageX=this.containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>this.containment[3]&&(pageY=this.containment[3]+this.offset.click.top)),o.grid&&(top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1],pageY=this.containment?top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3]?top:top-this.offset.click.top>=this.containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0],pageX=this.containment?left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2]?left:left-this.offset.click.left>=this.containment[0]?left-o.grid[0]:left+o.grid[0]:left)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop()),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())}},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?i.item[0]:i.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){counter===this.counter&&this.refreshPositions(!hardRefresh)})},_clear:function(event,noPropagation){this.reverting=!1;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)("auto"===this._storedCSS[i]||"static"===this._storedCSS[i])&&(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!noPropagation&&delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||noPropagation||delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash())}),this!==this.currentContainer&&(noPropagation||(delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash())}),delayedTriggers.push(function(c){return function(event){c._trigger("receive",event,this._uiHash(this))}}.call(this,this.currentContainer)),delayedTriggers.push(function(c){return function(event){c._trigger("update",event,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)noPropagation||delayedTriggers.push(function(c){return function(event){c._trigger("deactivate",event,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(delayedTriggers.push(function(c){return function(event){c._trigger("out",event,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!noPropagation){for(this._trigger("beforeStop",event,this._uiHash()),i=0;i<delayedTriggers.length;i++)delayedTriggers[i].call(this,event);this._trigger("stop",event,this._uiHash())}return this.fromOutside=!1,!1}if(noPropagation||this._trigger("beforeStop",event,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!noPropagation){for(i=0;i<delayedTriggers.length;i++)delayedTriggers[i].call(this,event);this._trigger("stop",event,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){$.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null}}})}(jQuery),/*!
 * jQuery UI Resizable 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/resizable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
function($){function num(v){return parseInt(v,10)||0}function isNumber(value){return!isNaN(parseInt(value,10))}$.widget("ui.resizable",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var n,i,handle,axis,hname,that=this,o=this.options;if(this.element.addClass("ui-resizable"),$.extend(this,{_aspectRatio:!!o.aspectRatio,aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap($("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=o.handles||($(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),n=this.handles.split(","),this.handles={},i=0;i<n.length;i++)handle=$.trim(n[i]),hname="ui-resizable-"+handle,axis=$("<div class='ui-resizable-handle "+hname+"'></div>"),axis.css({zIndex:o.zIndex}),"se"===handle&&axis.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[handle]=".ui-resizable-"+handle,this.element.append(axis);this._renderAxis=function(target){var i,axis,padPos,padWrapper;target=target||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=$(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(axis=$(this.handles[i],this.element),padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth(),padPos=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),target.css(padPos,padWrapper),this._proportionallyResize()),$(this.handles[i]).length},this._renderAxis(this.element),this._handles=$(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){that.resizing||(this.className&&(axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),that.axis=axis&&axis[1]?axis[1]:"se")}),o.autoHide&&(this._handles.hide(),$(this.element).addClass("ui-resizable-autohide").mouseenter(function(){o.disabled||($(this).removeClass("ui-resizable-autohide"),that._handles.show())}).mouseleave(function(){o.disabled||that.resizing||($(this).addClass("ui-resizable-autohide"),that._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var wrapper,_destroy=function(exp){$(exp).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(_destroy(this.element),wrapper=this.element,this.originalElement.css({position:wrapper.css("position"),width:wrapper.outerWidth(),height:wrapper.outerHeight(),top:wrapper.css("top"),left:wrapper.css("left")}).insertAfter(wrapper),wrapper.remove()),this.originalElement.css("resize",this.originalResizeStyle),_destroy(this.originalElement),this},_mouseCapture:function(event){var i,handle,capture=!1;for(i in this.handles)handle=$(this.handles[i])[0],(handle===event.target||$.contains(handle,event.target))&&(capture=!0);return!this.options.disabled&&capture},_mouseStart:function(event){var curleft,curtop,cursor,o=this.options,iniPos=this.element.position(),el=this.element;return this.resizing=!0,/absolute/.test(el.css("position"))?el.css({position:"absolute",top:el.css("top"),left:el.css("left")}):el.is(".ui-draggable")&&el.css({position:"absolute",top:iniPos.top,left:iniPos.left}),this._renderProxy(),curleft=num(this.helper.css("left")),curtop=num(this.helper.css("top")),o.containment&&(curleft+=$(o.containment).scrollLeft()||0,curtop+=$(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:curleft,top:curtop},this.size=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()},this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()},this.originalPosition={left:curleft,top:curtop},this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()},this.originalMousePosition={left:event.pageX,top:event.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,cursor=$(".ui-resizable-"+this.axis).css("cursor"),$("body").css("cursor","auto"===cursor?this.axis+"-resize":cursor),el.addClass("ui-resizable-resizing"),this._propagate("start",event),!0},_mouseDrag:function(event){var data,el=this.helper,props={},smp=this.originalMousePosition,a=this.axis,prevTop=this.position.top,prevLeft=this.position.left,prevWidth=this.size.width,prevHeight=this.size.height,dx=event.pageX-smp.left||0,dy=event.pageY-smp.top||0,trigger=this._change[a];return trigger?(data=trigger.apply(this,[event,dx,dy]),this._updateVirtualBoundaries(event.shiftKey),(this._aspectRatio||event.shiftKey)&&(data=this._updateRatio(data,event)),data=this._respectSize(data,event),this._updateCache(data),this._propagate("resize",event),this.position.top!==prevTop&&(props.top=this.position.top+"px"),this.position.left!==prevLeft&&(props.left=this.position.left+"px"),this.size.width!==prevWidth&&(props.width=this.size.width+"px"),this.size.height!==prevHeight&&(props.height=this.size.height+"px"),el.css(props),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),$.isEmptyObject(props)||this._trigger("resize",event,this.ui()),!1):!1},_mouseStop:function(event){this.resizing=!1;var pr,ista,soffseth,soffsetw,s,left,top,o=this.options,that=this;return this._helper&&(pr=this._proportionallyResizeElements,ista=pr.length&&/textarea/i.test(pr[0].nodeName),soffseth=ista&&$.ui.hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,s={width:that.helper.width()-soffsetw,height:that.helper.height()-soffseth},left=parseInt(that.element.css("left"),10)+(that.position.left-that.originalPosition.left)||null,top=parseInt(that.element.css("top"),10)+(that.position.top-that.originalPosition.top)||null,o.animate||this.element.css($.extend(s,{top:top,left:left})),that.helper.height(that.size.height),that.helper.width(that.size.width),this._helper&&!o.animate&&this._proportionallyResize()),$("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",event),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(forceAspectRatio){var pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b,o=this.options;b={minWidth:isNumber(o.minWidth)?o.minWidth:0,maxWidth:isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:isNumber(o.minHeight)?o.minHeight:0,maxHeight:isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||forceAspectRatio)&&(pMinWidth=b.minHeight*this.aspectRatio,pMinHeight=b.minWidth/this.aspectRatio,pMaxWidth=b.maxHeight*this.aspectRatio,pMaxHeight=b.maxWidth/this.aspectRatio,pMinWidth>b.minWidth&&(b.minWidth=pMinWidth),pMinHeight>b.minHeight&&(b.minHeight=pMinHeight),pMaxWidth<b.maxWidth&&(b.maxWidth=pMaxWidth),pMaxHeight<b.maxHeight&&(b.maxHeight=pMaxHeight)),this._vBoundaries=b},_updateCache:function(data){this.offset=this.helper.offset(),isNumber(data.left)&&(this.position.left=data.left),isNumber(data.top)&&(this.position.top=data.top),isNumber(data.height)&&(this.size.height=data.height),isNumber(data.width)&&(this.size.width=data.width)},_updateRatio:function(data){var cpos=this.position,csize=this.size,a=this.axis;return isNumber(data.height)?data.width=data.height*this.aspectRatio:isNumber(data.width)&&(data.height=data.width/this.aspectRatio),"sw"===a&&(data.left=cpos.left+(csize.width-data.width),data.top=null),"nw"===a&&(data.top=cpos.top+(csize.height-data.height),data.left=cpos.left+(csize.width-data.width)),data},_respectSize:function(data){var o=this._vBoundaries,a=this.axis,ismaxw=isNumber(data.width)&&o.maxWidth&&o.maxWidth<data.width,ismaxh=isNumber(data.height)&&o.maxHeight&&o.maxHeight<data.height,isminw=isNumber(data.width)&&o.minWidth&&o.minWidth>data.width,isminh=isNumber(data.height)&&o.minHeight&&o.minHeight>data.height,dw=this.originalPosition.left+this.originalSize.width,dh=this.position.top+this.size.height,cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);return isminw&&(data.width=o.minWidth),isminh&&(data.height=o.minHeight),ismaxw&&(data.width=o.maxWidth),ismaxh&&(data.height=o.maxHeight),isminw&&cw&&(data.left=dw-o.minWidth),ismaxw&&cw&&(data.left=dw-o.maxWidth),isminh&&ch&&(data.top=dh-o.minHeight),ismaxh&&ch&&(data.top=dh-o.maxHeight),data.width||data.height||data.left||!data.top?data.width||data.height||data.top||!data.left||(data.left=null):data.top=null,data},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var i,j,borders,paddings,prel,element=this.helper||this.element;for(i=0;i<this._proportionallyResizeElements.length;i++){if(prel=this._proportionallyResizeElements[i],!this.borderDif)for(this.borderDif=[],borders=[prel.css("borderTopWidth"),prel.css("borderRightWidth"),prel.css("borderBottomWidth"),prel.css("borderLeftWidth")],paddings=[prel.css("paddingTop"),prel.css("paddingRight"),prel.css("paddingBottom"),prel.css("paddingLeft")],j=0;j<borders.length;j++)this.borderDif[j]=(parseInt(borders[j],10)||0)+(parseInt(paddings[j],10)||0);prel.css({height:element.height()-this.borderDif[0]-this.borderDif[2]||0,width:element.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var el=this.element,o=this.options;this.elementOffset=el.offset(),this._helper?(this.helper=this.helper||$("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(event,dx){return{width:this.originalSize.width+dx}},w:function(event,dx){var cs=this.originalSize,sp=this.originalPosition;return{left:sp.left+dx,width:cs.width-dx}},n:function(event,dx,dy){var cs=this.originalSize,sp=this.originalPosition;return{top:sp.top+dy,height:cs.height-dy}},s:function(event,dx,dy){return{height:this.originalSize.height+dy}},se:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},sw:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))},ne:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},nw:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))}},_propagate:function(n,event){$.ui.plugin.call(this,n,[event,this.ui()]),"resize"!==n&&this._trigger(n,event,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),$.ui.plugin.add("resizable","animate",{stop:function(event){var that=$(this).data("ui-resizable"),o=that.options,pr=that._proportionallyResizeElements,ista=pr.length&&/textarea/i.test(pr[0].nodeName),soffseth=ista&&$.ui.hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,style={width:that.size.width-soffsetw,height:that.size.height-soffseth},left=parseInt(that.element.css("left"),10)+(that.position.left-that.originalPosition.left)||null,top=parseInt(that.element.css("top"),10)+(that.position.top-that.originalPosition.top)||null;that.element.animate($.extend(style,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){var data={width:parseInt(that.element.css("width"),10),height:parseInt(that.element.css("height"),10),top:parseInt(that.element.css("top"),10),left:parseInt(that.element.css("left"),10)};pr&&pr.length&&$(pr[0]).css({width:data.width,height:data.height}),that._updateCache(data),that._propagate("resize",event)}})}}),$.ui.plugin.add("resizable","containment",{start:function(){var element,p,co,ch,cw,width,height,that=$(this).data("ui-resizable"),o=that.options,el=that.element,oc=o.containment,ce=oc instanceof $?oc.get(0):/parent/.test(oc)?el.parent().get(0):oc;ce&&(that.containerElement=$(ce),/document/.test(oc)||oc===document?(that.containerOffset={left:0,top:0},that.containerPosition={left:0,top:0},that.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}):(element=$(ce),p=[],$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=num(element.css("padding"+name))}),that.containerOffset=element.offset(),that.containerPosition=element.position(),that.containerSize={height:element.innerHeight()-p[3],width:element.innerWidth()-p[1]},co=that.containerOffset,ch=that.containerSize.height,cw=that.containerSize.width,width=$.ui.hasScroll(ce,"left")?ce.scrollWidth:cw,height=$.ui.hasScroll(ce)?ce.scrollHeight:ch,that.parentData={element:ce,left:co.left,top:co.top,width:width,height:height}))},resize:function(event){var woset,hoset,isParent,isOffsetRelative,that=$(this).data("ui-resizable"),o=that.options,co=that.containerOffset,cp=that.position,pRatio=that._aspectRatio||event.shiftKey,cop={top:0,left:0},ce=that.containerElement;ce[0]!==document&&/static/.test(ce.css("position"))&&(cop=co),cp.left<(that._helper?co.left:0)&&(that.size.width=that.size.width+(that._helper?that.position.left-co.left:that.position.left-cop.left),pRatio&&(that.size.height=that.size.width/that.aspectRatio),that.position.left=o.helper?co.left:0),cp.top<(that._helper?co.top:0)&&(that.size.height=that.size.height+(that._helper?that.position.top-co.top:that.position.top),pRatio&&(that.size.width=that.size.height*that.aspectRatio),that.position.top=that._helper?co.top:0),that.offset.left=that.parentData.left+that.position.left,that.offset.top=that.parentData.top+that.position.top,woset=Math.abs((that._helper?that.offset.left-cop.left:that.offset.left-cop.left)+that.sizeDiff.width),hoset=Math.abs((that._helper?that.offset.top-cop.top:that.offset.top-co.top)+that.sizeDiff.height),isParent=that.containerElement.get(0)===that.element.parent().get(0),isOffsetRelative=/relative|absolute/.test(that.containerElement.css("position")),isParent&&isOffsetRelative&&(woset-=that.parentData.left),woset+that.size.width>=that.parentData.width&&(that.size.width=that.parentData.width-woset,pRatio&&(that.size.height=that.size.width/that.aspectRatio)),hoset+that.size.height>=that.parentData.height&&(that.size.height=that.parentData.height-hoset,pRatio&&(that.size.width=that.size.height*that.aspectRatio))},stop:function(){var that=$(this).data("ui-resizable"),o=that.options,co=that.containerOffset,cop=that.containerPosition,ce=that.containerElement,helper=$(that.helper),ho=helper.offset(),w=helper.outerWidth()-that.sizeDiff.width,h=helper.outerHeight()-that.sizeDiff.height;that._helper&&!o.animate&&/relative/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h}),that._helper&&!o.animate&&/static/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h})}}),$.ui.plugin.add("resizable","alsoResize",{start:function(){var that=$(this).data("ui-resizable"),o=that.options,_store=function(exp){$(exp).each(function(){var el=$(this);el.data("ui-resizable-alsoresize",{width:parseInt(el.width(),10),height:parseInt(el.height(),10),left:parseInt(el.css("left"),10),top:parseInt(el.css("top"),10)})})};"object"!=typeof o.alsoResize||o.alsoResize.parentNode?_store(o.alsoResize):o.alsoResize.length?(o.alsoResize=o.alsoResize[0],_store(o.alsoResize)):$.each(o.alsoResize,function(exp){_store(exp)})},resize:function(event,ui){var that=$(this).data("ui-resizable"),o=that.options,os=that.originalSize,op=that.originalPosition,delta={height:that.size.height-os.height||0,width:that.size.width-os.width||0,top:that.position.top-op.top||0,left:that.position.left-op.left||0},_alsoResize=function(exp,c){$(exp).each(function(){var el=$(this),start=$(this).data("ui-resizable-alsoresize"),style={},css=c&&c.length?c:el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(css,function(i,prop){var sum=(start[prop]||0)+(delta[prop]||0);sum&&sum>=0&&(style[prop]=sum||null)}),el.css(style)})};"object"!=typeof o.alsoResize||o.alsoResize.nodeType?_alsoResize(o.alsoResize):$.each(o.alsoResize,function(exp,c){_alsoResize(exp,c)})},stop:function(){$(this).removeData("resizable-alsoresize")}}),$.ui.plugin.add("resizable","ghost",{start:function(){var that=$(this).data("ui-resizable"),o=that.options,cs=that.size;that.ghost=that.originalElement.clone(),that.ghost.css({opacity:.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof o.ghost?o.ghost:""),that.ghost.appendTo(that.helper)},resize:function(){var that=$(this).data("ui-resizable");that.ghost&&that.ghost.css({position:"relative",height:that.size.height,width:that.size.width})},stop:function(){var that=$(this).data("ui-resizable");that.ghost&&that.helper&&that.helper.get(0).removeChild(that.ghost.get(0))}}),$.ui.plugin.add("resizable","grid",{resize:function(){var that=$(this).data("ui-resizable"),o=that.options,cs=that.size,os=that.originalSize,op=that.originalPosition,a=that.axis,grid="number"==typeof o.grid?[o.grid,o.grid]:o.grid,gridX=grid[0]||1,gridY=grid[1]||1,ox=Math.round((cs.width-os.width)/gridX)*gridX,oy=Math.round((cs.height-os.height)/gridY)*gridY,newWidth=os.width+ox,newHeight=os.height+oy,isMaxWidth=o.maxWidth&&o.maxWidth<newWidth,isMaxHeight=o.maxHeight&&o.maxHeight<newHeight,isMinWidth=o.minWidth&&o.minWidth>newWidth,isMinHeight=o.minHeight&&o.minHeight>newHeight;o.grid=grid,isMinWidth&&(newWidth+=gridX),isMinHeight&&(newHeight+=gridY),isMaxWidth&&(newWidth-=gridX),isMaxHeight&&(newHeight-=gridY),/^(se|s|e)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight):/^(ne)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight,that.position.top=op.top-oy):/^(sw)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight,that.position.left=op.left-ox):(that.size.width=newWidth,that.size.height=newHeight,that.position.top=op.top-oy,that.position.left=op.left-ox)}})}(jQuery),/*!
 * jQuery UI Selectable 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/selectable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
function($){$.widget("ui.selectable",$.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var selectees,that=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){selectees=$(that.options.filter,that.element[0]),selectees.addClass("ui-selectee"),selectees.each(function(){var $this=$(this),pos=$this.offset();$.data(this,"selectable-item",{element:this,$element:$this,left:pos.left,top:pos.top,right:pos.left+$this.outerWidth(),bottom:pos.top+$this.outerHeight(),startselected:!1,selected:$this.hasClass("ui-selected"),selecting:$this.hasClass("ui-selecting"),unselecting:$this.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=selectees.addClass("ui-selectee"),this._mouseInit(),this.helper=$("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(event){var that=this,options=this.options;this.opos=[event.pageX,event.pageY],this.options.disabled||(this.selectees=$(options.filter,this.element[0]),this._trigger("start",event),$(options.appendTo).append(this.helper),this.helper.css({left:event.pageX,top:event.pageY,width:0,height:0}),options.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var selectee=$.data(this,"selectable-item");selectee.startselected=!0,event.metaKey||event.ctrlKey||(selectee.$element.removeClass("ui-selected"),selectee.selected=!1,selectee.$element.addClass("ui-unselecting"),selectee.unselecting=!0,that._trigger("unselecting",event,{unselecting:selectee.element}))}),$(event.target).parents().addBack().each(function(){var doSelect,selectee=$.data(this,"selectable-item");return selectee?(doSelect=!event.metaKey&&!event.ctrlKey||!selectee.$element.hasClass("ui-selected"),selectee.$element.removeClass(doSelect?"ui-unselecting":"ui-selected").addClass(doSelect?"ui-selecting":"ui-unselecting"),selectee.unselecting=!doSelect,selectee.selecting=doSelect,selectee.selected=doSelect,doSelect?that._trigger("selecting",event,{selecting:selectee.element}):that._trigger("unselecting",event,{unselecting:selectee.element}),!1):void 0}))},_mouseDrag:function(event){if(this.dragged=!0,!this.options.disabled){var tmp,that=this,options=this.options,x1=this.opos[0],y1=this.opos[1],x2=event.pageX,y2=event.pageY;return x1>x2&&(tmp=x2,x2=x1,x1=tmp),y1>y2&&(tmp=y2,y2=y1,y1=tmp),this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1}),this.selectees.each(function(){var selectee=$.data(this,"selectable-item"),hit=!1;selectee&&selectee.element!==that.element[0]&&("touch"===options.tolerance?hit=!(selectee.left>x2||selectee.right<x1||selectee.top>y2||selectee.bottom<y1):"fit"===options.tolerance&&(hit=selectee.left>x1&&selectee.right<x2&&selectee.top>y1&&selectee.bottom<y2),hit?(selectee.selected&&(selectee.$element.removeClass("ui-selected"),selectee.selected=!1),selectee.unselecting&&(selectee.$element.removeClass("ui-unselecting"),selectee.unselecting=!1),selectee.selecting||(selectee.$element.addClass("ui-selecting"),selectee.selecting=!0,that._trigger("selecting",event,{selecting:selectee.element}))):(selectee.selecting&&((event.metaKey||event.ctrlKey)&&selectee.startselected?(selectee.$element.removeClass("ui-selecting"),selectee.selecting=!1,selectee.$element.addClass("ui-selected"),selectee.selected=!0):(selectee.$element.removeClass("ui-selecting"),selectee.selecting=!1,selectee.startselected&&(selectee.$element.addClass("ui-unselecting"),selectee.unselecting=!0),that._trigger("unselecting",event,{unselecting:selectee.element}))),selectee.selected&&(event.metaKey||event.ctrlKey||selectee.startselected||(selectee.$element.removeClass("ui-selected"),selectee.selected=!1,selectee.$element.addClass("ui-unselecting"),selectee.unselecting=!0,that._trigger("unselecting",event,{unselecting:selectee.element})))))}),!1}},_mouseStop:function(event){var that=this;return this.dragged=!1,$(".ui-unselecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-unselecting"),selectee.unselecting=!1,selectee.startselected=!1,that._trigger("unselected",event,{unselected:selectee.element})}),$(".ui-selecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-selecting").addClass("ui-selected"),selectee.selecting=!1,selectee.selected=!0,selectee.startselected=!0,that._trigger("selected",event,{selected:selectee.element})}),this._trigger("stop",event),this.helper.remove(),!1}})}(jQuery),/*!
 * jQuery UI Touch Punch 0.2.3 (forked, see below)
 *
 * Copyright 2011–2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 *
 * This version is forked from: https://github.com/dukex/jquery-ui-touch-punch
 * And available at: https://github.com/nobitagit/jquery-ui-touch-punch
 *
 */
function($){function simulateMouseEvent(event,simulatedType){if(!(event.originalEvent.touches.length>1)){var touch=event.originalEvent.changedTouches[0],simulatedEvent=document.createEvent("MouseEvents");$(touch.target).is("input")||$(touch.target).is("textarea")?event.stopPropagation():event.preventDefault(),simulatedEvent.initMouseEvent(simulatedType,!0,!0,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,!1,!1,!1,!1,0,null),event.target.dispatchEvent(simulatedEvent)}}if($.support.touch="ontouchend"in document,$.support.touch){var touchHandled,mouseProto=$.ui.mouse.prototype,_mouseInit=mouseProto._mouseInit,_mouseDestroy=mouseProto._mouseDestroy;mouseProto._touchStart=function(event){var self=this;!touchHandled&&self._mouseCapture(event.originalEvent.changedTouches[0])&&(touchHandled=!0,self._touchMoved=!1,this._startedMove=event.timeStamp,simulateMouseEvent(event,"mouseover"),simulateMouseEvent(event,"mousemove"),simulateMouseEvent(event,"mousedown"))},mouseProto._touchMove=function(event){touchHandled&&(this._touchMoved=!0,simulateMouseEvent(event,"mousemove"))},mouseProto._touchEnd=function(event){if(touchHandled){simulateMouseEvent(event,"mouseup"),simulateMouseEvent(event,"mouseout");var timeMoving=event.timeStamp-this._startedMove;(!this._touchMoved||500>timeMoving)&&simulateMouseEvent(event,"click"),touchHandled=!1}},mouseProto._mouseInit=function(){var self=this;self.element.bind({touchstart:$.proxy(self,"_touchStart"),touchmove:$.proxy(self,"_touchMove"),touchend:$.proxy(self,"_touchEnd")}),_mouseInit.call(self)},mouseProto._mouseDestroy=function(){var self=this;self.element.unbind({touchstart:$.proxy(self,"_touchStart"),touchmove:$.proxy(self,"_touchMove"),touchend:$.proxy(self,"_touchEnd")}),_mouseDestroy.call(self)}}}(jQuery),/* 
 * The MIT License
 *
 * Copyright (c) 2012 James Allardice
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), 
 * to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, 
 * and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
function(global){"use strict";function addEventListener(elem,event,fn){return elem.addEventListener?elem.addEventListener(event,fn,!1):elem.attachEvent?elem.attachEvent("on"+event,fn):void 0}function inArray(arr,item){var i,len;for(i=0,len=arr.length;len>i;i++)if(arr[i]===item)return!0;return!1}function moveCaret(elem,index){var range;elem.createTextRange?(range=elem.createTextRange(),range.move("character",index),range.select()):elem.selectionStart&&(elem.focus(),elem.setSelectionRange(index,index))}function changeType(elem,type){try{return elem.type=type,!0}catch(e){return!1}}global.Placeholders={Utils:{addEventListener:addEventListener,inArray:inArray,moveCaret:moveCaret,changeType:changeType}}}(this),function(global){"use strict";function noop(){}function safeActiveElement(){try{return document.activeElement}catch(err){}}function hidePlaceholder(elem,keydownValue){var type,maxLength,valueChanged=!!keydownValue&&elem.value!==keydownValue,isPlaceholderValue=elem.value===elem.getAttribute(ATTR_CURRENT_VAL);return(valueChanged||isPlaceholderValue)&&"true"===elem.getAttribute(ATTR_ACTIVE)?(elem.removeAttribute(ATTR_ACTIVE),elem.value=elem.value.replace(elem.getAttribute(ATTR_CURRENT_VAL),""),elem.className=elem.className.replace(classNameRegExp,""),maxLength=elem.getAttribute(ATTR_MAXLENGTH),parseInt(maxLength,10)>=0&&(elem.setAttribute("maxLength",maxLength),elem.removeAttribute(ATTR_MAXLENGTH)),type=elem.getAttribute(ATTR_INPUT_TYPE),type&&(elem.type=type),!0):!1}function showPlaceholder(elem){var type,maxLength,val=elem.getAttribute(ATTR_CURRENT_VAL);return""===elem.value&&val?(elem.setAttribute(ATTR_ACTIVE,"true"),elem.value=val,elem.className+=" "+placeholderClassName,maxLength=elem.getAttribute(ATTR_MAXLENGTH),maxLength||(elem.setAttribute(ATTR_MAXLENGTH,elem.maxLength),elem.removeAttribute("maxLength")),type=elem.getAttribute(ATTR_INPUT_TYPE),type?elem.type="text":"password"===elem.type&&Utils.changeType(elem,"text")&&elem.setAttribute(ATTR_INPUT_TYPE,"password"),!0):!1}function handleElem(node,callback){var handleInputsLength,handleTextareasLength,handleInputs,handleTextareas,elem,len,i;if(node&&node.getAttribute(ATTR_CURRENT_VAL))callback(node);else for(handleInputs=node?node.getElementsByTagName("input"):inputs,handleTextareas=node?node.getElementsByTagName("textarea"):textareas,handleInputsLength=handleInputs?handleInputs.length:0,handleTextareasLength=handleTextareas?handleTextareas.length:0,i=0,len=handleInputsLength+handleTextareasLength;len>i;i++)elem=handleInputsLength>i?handleInputs[i]:handleTextareas[i-handleInputsLength],callback(elem)}function disablePlaceholders(node){handleElem(node,hidePlaceholder)}function enablePlaceholders(node){handleElem(node,showPlaceholder)}function makeFocusHandler(elem){return function(){hideOnInput&&elem.value===elem.getAttribute(ATTR_CURRENT_VAL)&&"true"===elem.getAttribute(ATTR_ACTIVE)?Utils.moveCaret(elem,0):hidePlaceholder(elem)}}function makeBlurHandler(elem){return function(){showPlaceholder(elem)}}function makeKeydownHandler(elem){return function(e){return keydownVal=elem.value,"true"===elem.getAttribute(ATTR_ACTIVE)&&keydownVal===elem.getAttribute(ATTR_CURRENT_VAL)&&Utils.inArray(badKeys,e.keyCode)?(e.preventDefault&&e.preventDefault(),!1):void 0}}function makeKeyupHandler(elem){return function(){hidePlaceholder(elem,keydownVal),""===elem.value&&(elem.blur(),Utils.moveCaret(elem,0))}}function makeClickHandler(elem){return function(){elem===safeActiveElement()&&elem.value===elem.getAttribute(ATTR_CURRENT_VAL)&&"true"===elem.getAttribute(ATTR_ACTIVE)&&Utils.moveCaret(elem,0)}}function makeSubmitHandler(form){return function(){disablePlaceholders(form)}}function newElement(elem){elem.form&&(form=elem.form,"string"==typeof form&&(form=document.getElementById(form)),form.getAttribute(ATTR_FORM_HANDLED)||(Utils.addEventListener(form,"submit",makeSubmitHandler(form)),form.setAttribute(ATTR_FORM_HANDLED,"true"))),Utils.addEventListener(elem,"focus",makeFocusHandler(elem)),Utils.addEventListener(elem,"blur",makeBlurHandler(elem)),hideOnInput&&(Utils.addEventListener(elem,"keydown",makeKeydownHandler(elem)),Utils.addEventListener(elem,"keyup",makeKeyupHandler(elem)),Utils.addEventListener(elem,"click",makeClickHandler(elem))),elem.setAttribute(ATTR_EVENTS_BOUND,"true"),elem.setAttribute(ATTR_CURRENT_VAL,placeholder),(hideOnInput||elem!==safeActiveElement())&&showPlaceholder(elem)}var inputs,textareas,hideOnInput,liveUpdates,keydownVal,styleElem,styleRules,placeholder,timer,form,elem,len,i,validTypes=["text","search","url","tel","email","password","number","textarea"],badKeys=[27,33,34,35,36,37,38,39,40,8,46],placeholderStyleColor="#ccc",placeholderClassName="placeholdersjs",classNameRegExp=new RegExp("(?:^|\\s)"+placeholderClassName+"(?!\\S)"),ATTR_CURRENT_VAL="data-placeholder-value",ATTR_ACTIVE="data-placeholder-active",ATTR_INPUT_TYPE="data-placeholder-type",ATTR_FORM_HANDLED="data-placeholder-submit",ATTR_EVENTS_BOUND="data-placeholder-bound",ATTR_OPTION_FOCUS="data-placeholder-focus",ATTR_OPTION_LIVE="data-placeholder-live",ATTR_MAXLENGTH="data-placeholder-maxlength",test=document.createElement("input"),head=document.getElementsByTagName("head")[0],root=document.documentElement,Placeholders=global.Placeholders,Utils=Placeholders.Utils;if(Placeholders.nativeSupport=void 0!==test.placeholder,!Placeholders.nativeSupport){for(inputs=document.getElementsByTagName("input"),textareas=document.getElementsByTagName("textarea"),hideOnInput="false"===root.getAttribute(ATTR_OPTION_FOCUS),liveUpdates="false"!==root.getAttribute(ATTR_OPTION_LIVE),styleElem=document.createElement("style"),styleElem.type="text/css",styleRules=document.createTextNode("."+placeholderClassName+" { color:"+placeholderStyleColor+"; }"),styleElem.styleSheet?styleElem.styleSheet.cssText=styleRules.nodeValue:styleElem.appendChild(styleRules),head.insertBefore(styleElem,head.firstChild),i=0,len=inputs.length+textareas.length;len>i;i++)elem=i<inputs.length?inputs[i]:textareas[i-inputs.length],placeholder=elem.attributes.placeholder,placeholder&&(placeholder=placeholder.nodeValue,placeholder&&Utils.inArray(validTypes,elem.type)&&newElement(elem));timer=setInterval(function(){for(i=0,len=inputs.length+textareas.length;len>i;i++)elem=i<inputs.length?inputs[i]:textareas[i-inputs.length],placeholder=elem.attributes.placeholder,placeholder?(placeholder=placeholder.nodeValue,placeholder&&Utils.inArray(validTypes,elem.type)&&(elem.getAttribute(ATTR_EVENTS_BOUND)||newElement(elem),(placeholder!==elem.getAttribute(ATTR_CURRENT_VAL)||"password"===elem.type&&!elem.getAttribute(ATTR_INPUT_TYPE))&&("password"===elem.type&&!elem.getAttribute(ATTR_INPUT_TYPE)&&Utils.changeType(elem,"text")&&elem.setAttribute(ATTR_INPUT_TYPE,"password"),elem.value===elem.getAttribute(ATTR_CURRENT_VAL)&&(elem.value=placeholder),elem.setAttribute(ATTR_CURRENT_VAL,placeholder)))):elem.getAttribute(ATTR_ACTIVE)&&(hidePlaceholder(elem),elem.removeAttribute(ATTR_CURRENT_VAL));liveUpdates||clearInterval(timer)},100)}Utils.addEventListener(global,"beforeunload",function(){Placeholders.disable()}),Placeholders.disable=Placeholders.nativeSupport?noop:disablePlaceholders,Placeholders.enable=Placeholders.nativeSupport?noop:enablePlaceholders}(this),/*
Copyright 2012 Igor Vaynberg

Version: 3.4.1 Timestamp: Thu Jun 27 18:02:10 PDT 2013

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL Licesnse is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.
*/
function($){"undefined"==typeof $.fn.each2&&$.fn.extend({each2:function(c){for(var j=$([0]),i=-1,l=this.length;++i<l&&(j.context=j[0]=this[i])&&c.call(j[0],i,j)!==!1;);return this}})}(jQuery),function($,undefined){"use strict";function indexOf(value,array){for(var i=0,l=array.length;l>i;i+=1)if(equal(value,array[i]))return i;return-1}function measureScrollbar(){var $template=$(MEASURE_SCROLLBAR_TEMPLATE);$template.appendTo("body");var dim={width:$template.width()-$template[0].clientWidth,height:$template.height()-$template[0].clientHeight};return $template.remove(),dim}function equal(a,b){return a===b?!0:a===undefined||b===undefined?!1:null===a||null===b?!1:a.constructor===String?a+""==b+"":b.constructor===String?b+""==a+"":!1}function splitVal(string,separator){var val,i,l;if(null===string||string.length<1)return[];for(val=string.split(separator),i=0,l=val.length;l>i;i+=1)val[i]=$.trim(val[i]);return val}function getSideBorderPadding(element){return element.outerWidth(!1)-element.width()}function installKeyUpChangeEvent(element){var key="keyup-change-value";element.on("keydown",function(){$.data(element,key)===undefined&&$.data(element,key,element.val())}),element.on("keyup",function(){var val=$.data(element,key);val!==undefined&&element.val()!==val&&($.removeData(element,key),element.trigger("keyup-change"))})}function installFilteredMouseMove(element){element.on("mousemove",function(e){var lastpos=lastMousePosition;(lastpos===undefined||lastpos.x!==e.pageX||lastpos.y!==e.pageY)&&$(e.target).trigger("mousemove-filtered",e)})}function debounce(quietMillis,fn,ctx){ctx=ctx||undefined;var timeout;return function(){var args=arguments;window.clearTimeout(timeout),timeout=window.setTimeout(function(){fn.apply(ctx,args)},quietMillis)}}function thunk(formula){var value,evaluated=!1;return function(){return evaluated===!1&&(value=formula(),evaluated=!0),value}}function installDebouncedScroll(threshold,element){var notify=debounce(threshold,function(e){element.trigger("scroll-debounced",e)});element.on("scroll",function(e){indexOf(e.target,element.get())>=0&&notify(e)})}function focus($el){$el[0]!==document.activeElement&&window.setTimeout(function(){var range,el=$el[0],pos=$el.val().length;$el.focus(),$el.is(":visible")&&el===document.activeElement&&(el.setSelectionRange?el.setSelectionRange(pos,pos):el.createTextRange&&(range=el.createTextRange(),range.collapse(!1),range.select()))},0)}function getCursorInfo(el){el=$(el)[0];var offset=0,length=0;if("selectionStart"in el)offset=el.selectionStart,length=el.selectionEnd-offset;else if("selection"in document){el.focus();var sel=document.selection.createRange();length=document.selection.createRange().text.length,sel.moveStart("character",-el.value.length),offset=sel.text.length-length}return{offset:offset,length:length}}function killEvent(event){event.preventDefault(),event.stopPropagation()}function killEventImmediately(event){event.preventDefault(),event.stopImmediatePropagation()}function measureTextWidth(e){if(!sizer){var style=e[0].currentStyle||window.getComputedStyle(e[0],null);sizer=$(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:style.fontSize,fontFamily:style.fontFamily,fontStyle:style.fontStyle,fontWeight:style.fontWeight,letterSpacing:style.letterSpacing,textTransform:style.textTransform,whiteSpace:"nowrap"}),sizer.attr("class","select2-sizer"),$("body").append(sizer)}return sizer.text(e.val()),sizer.width()}function syncCssClasses(dest,src,adapter){var classes,adapted,replacements=[];classes=dest.attr("class"),classes&&(classes=""+classes,$(classes.split(" ")).each2(function(){0===this.indexOf("select2-")&&replacements.push(this)})),classes=src.attr("class"),classes&&(classes=""+classes,$(classes.split(" ")).each2(function(){0!==this.indexOf("select2-")&&(adapted=adapter(this),adapted&&replacements.push(this))})),dest.attr("class",replacements.join(" "))}function markMatch(text,term,markup,escapeMarkup){var match=text.toUpperCase().indexOf(term.toUpperCase()),tl=term.length;return 0>match?(markup.push(escapeMarkup(text)),void 0):(markup.push(escapeMarkup(text.substring(0,match))),markup.push("<span class='select2-match'>"),markup.push(escapeMarkup(text.substring(match,match+tl))),markup.push("</span>"),markup.push(escapeMarkup(text.substring(match+tl,text.length))),void 0)}function defaultEscapeMarkup(markup){var replace_map={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(markup).replace(/[&<>"'\/\\]/g,function(match){return replace_map[match]})}function ajax(options){var timeout,requestSequence=0,handler=null,quietMillis=options.quietMillis||100,ajaxUrl=options.url,self=this;return function(query){window.clearTimeout(timeout),timeout=window.setTimeout(function(){requestSequence+=1;var requestNumber=requestSequence,data=options.data,url=ajaxUrl,transport=options.transport||$.fn.select2.ajaxDefaults.transport,deprecated={type:options.type||"GET",cache:options.cache||!1,jsonpCallback:options.jsonpCallback||undefined,dataType:options.dataType||"json"},params=$.extend({},$.fn.select2.ajaxDefaults.params,deprecated);data=data?data.call(self,query.term,query.page,query.context):null,url="function"==typeof url?url.call(self,query.term,query.page,query.context):url,handler&&handler.abort(),options.params&&($.isFunction(options.params)?$.extend(params,options.params.call(self)):$.extend(params,options.params)),$.extend(params,{url:url,dataType:options.dataType,data:data,success:function(data){if(!(requestSequence>requestNumber)){var results=options.results(data,query.page);query.callback(results)}}}),handler=transport.call(self,params)},quietMillis)}}function local(options){var dataText,tmp,data=options,text=function(item){return""+item.text};$.isArray(data)&&(tmp=data,data={results:tmp}),$.isFunction(data)===!1&&(tmp=data,data=function(){return tmp});var dataItem=data();return dataItem.text&&(text=dataItem.text,$.isFunction(text)||(dataText=dataItem.text,text=function(item){return item[dataText]})),function(query){var process,t=query.term,filtered={results:[]};return""===t?(query.callback(data()),void 0):(process=function(datum,collection){var group,attr;if(datum=datum[0],datum.children){group={};for(attr in datum)datum.hasOwnProperty(attr)&&(group[attr]=datum[attr]);group.children=[],$(datum.children).each2(function(i,childDatum){process(childDatum,group.children)}),(group.children.length||query.matcher(t,text(group),datum))&&collection.push(group)}else query.matcher(t,text(datum),datum)&&collection.push(datum)},$(data().results).each2(function(i,datum){process(datum,filtered.results)}),query.callback(filtered),void 0)}}function tags(data){var isFunc=$.isFunction(data);return function(query){var t=query.term,filtered={results:[]};$(isFunc?data():data).each(function(){var isObject=this.text!==undefined,text=isObject?this.text:this;(""===t||query.matcher(t,text))&&filtered.results.push(isObject?this:{id:this,text:this})}),query.callback(filtered)}}function checkFormatter(formatter,formatterName){if($.isFunction(formatter))return!0;if(!formatter)return!1;throw new Error(formatterName+" must be a function or a falsy value")}function evaluate(val){return $.isFunction(val)?val():val}function countResults(results){var count=0;return $.each(results,function(i,item){item.children?count+=countResults(item.children):count++}),count}function defaultTokenizer(input,selection,selectCallback,opts){var token,index,i,l,separator,original=input,dupe=!1;if(!opts.createSearchChoice||!opts.tokenSeparators||opts.tokenSeparators.length<1)return undefined;for(;;){for(index=-1,i=0,l=opts.tokenSeparators.length;l>i&&(separator=opts.tokenSeparators[i],index=input.indexOf(separator),!(index>=0));i++);if(0>index)break;if(token=input.substring(0,index),input=input.substring(index+separator.length),token.length>0&&(token=opts.createSearchChoice.call(this,token,selection),token!==undefined&&null!==token&&opts.id(token)!==undefined&&null!==opts.id(token))){for(dupe=!1,i=0,l=selection.length;l>i;i++)if(equal(opts.id(token),opts.id(selection[i]))){dupe=!0;break}dupe||selectCallback(token)}}return original!==input?input:void 0}function clazz(SuperClass,methods){var constructor=function(){};return constructor.prototype=new SuperClass,constructor.prototype.constructor=constructor,constructor.prototype.parent=SuperClass.prototype,constructor.prototype=$.extend(constructor.prototype,methods),constructor}if(window.Select2===undefined){var KEY,AbstractSelect2,SingleSelect2,MultiSelect2,nextUid,sizer,$document,scrollBarDimensions,lastMousePosition={x:0,y:0},KEY={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(k){switch(k=k.which?k.which:k){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:return!0}return!1},isControl:function(e){var k=e.which;switch(k){case KEY.SHIFT:case KEY.CTRL:case KEY.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(k){return k=k.which?k.which:k,k>=112&&123>=k}},MEASURE_SCROLLBAR_TEMPLATE="<div class='select2-measure-scrollbar'></div>";$document=$(document),nextUid=function(){var counter=1;return function(){return counter++}}(),$document.on("mousemove",function(e){lastMousePosition.x=e.pageX,lastMousePosition.y=e.pageY}),AbstractSelect2=clazz(Object,{bind:function(func){var self=this;return function(){func.apply(self,arguments)}},init:function(opts){var results,search,disabled,readonly,resultsSelector=".select2-results";this.opts=opts=this.prepareOpts(opts),this.id=opts.id,opts.element.data("select2")!==undefined&&null!==opts.element.data("select2")&&opts.element.data("select2").destroy(),this.container=this.createContainer(),this.containerId="s2id_"+(opts.element.attr("id")||"autogen"+nextUid()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=thunk(function(){return opts.element.closest("body")}),syncCssClasses(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.css(evaluate(opts.containerCss)),this.container.addClass(evaluate(opts.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(evaluate(opts.dropdownCssClass)),this.dropdown.data("select2",this),this.results=results=this.container.find(resultsSelector),this.search=search=this.container.find("input.select2-input"),this.resultsPage=0,this.context=null,this.initContainer(),installFilteredMouseMove(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",resultsSelector,this.bind(this.highlightUnderEvent)),installDebouncedScroll(80,this.results),this.dropdown.on("scroll-debounced",resultsSelector,this.bind(this.loadMoreIfNeeded)),$(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),$(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),$.fn.mousewheel&&results.mousewheel(function(e,delta,deltaX,deltaY){var top=results.scrollTop();deltaY>0&&0>=top-deltaY?(results.scrollTop(0),killEvent(e)):0>deltaY&&results.get(0).scrollHeight-results.scrollTop()+deltaY<=results.height()&&(results.scrollTop(results.get(0).scrollHeight-results.height()),killEvent(e))}),installKeyUpChangeEvent(search),search.on("keyup-change input paste",this.bind(this.updateResults)),search.on("focus",function(){search.addClass("select2-focused")}),search.on("blur",function(){search.removeClass("select2-focused")}),this.dropdown.on("mouseup",resultsSelector,this.bind(function(e){$(e.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(e),this.selectHighlighted(e))})),this.dropdown.on("click mouseup mousedown",function(e){e.stopPropagation()}),$.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==opts.maximumInputLength&&this.search.attr("maxlength",opts.maximumInputLength);var disabled=opts.element.prop("disabled");disabled===undefined&&(disabled=!1),this.enable(!disabled);var readonly=opts.element.prop("readonly");readonly===undefined&&(readonly=!1),this.readonly(readonly),scrollBarDimensions=scrollBarDimensions||measureScrollbar(),this.autofocus=opts.element.prop("autofocus"),opts.element.prop("autofocus",!1),this.autofocus&&this.focus()},destroy:function(){var element=this.opts.element,select2=element.data("select2");this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),select2!==undefined&&(select2.container.remove(),select2.dropdown.remove(),element.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?element.attr({tabindex:this.elementTabIndex}):element.removeAttr("tabindex"),element.show())},optionToData:function(element){return element.is("option")?{id:element.prop("value"),text:element.text(),element:element.get(),css:element.attr("class"),disabled:element.prop("disabled"),locked:equal(element.attr("locked"),"locked")||equal(element.data("locked"),!0)}:element.is("optgroup")?{text:element.attr("label"),children:[],element:element.get(),css:element.attr("class")}:void 0},prepareOpts:function(opts){var element,select,idKey,ajaxUrl,self=this;if(element=opts.element,"select"===element.get(0).tagName.toLowerCase()&&(this.select=select=opts.element),select&&$.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in opts)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),opts=$.extend({},{populateResults:function(container,results,query){var populate,id=this.opts.id;populate=function(results,container,depth){var i,l,result,selectable,disabled,compound,node,label,innerContainer,formatted;for(results=opts.sortResults(results,container,query),i=0,l=results.length;l>i;i+=1)result=results[i],disabled=result.disabled===!0,selectable=!disabled&&id(result)!==undefined,compound=result.children&&result.children.length>0,node=$("<li></li>"),node.addClass("select2-results-dept-"+depth),node.addClass("select2-result"),node.addClass(selectable?"select2-result-selectable":"select2-result-unselectable"),disabled&&node.addClass("select2-disabled"),compound&&node.addClass("select2-result-with-children"),node.addClass(self.opts.formatResultCssClass(result)),label=$(document.createElement("div")),label.addClass("select2-result-label"),formatted=opts.formatResult(result,label,query,self.opts.escapeMarkup),formatted!==undefined&&label.html(formatted),node.append(label),compound&&(innerContainer=$("<ul></ul>"),innerContainer.addClass("select2-result-sub"),populate(result.children,innerContainer,depth+1),node.append(innerContainer)),node.data("select2-data",result),container.append(node)},populate(results,container,0)}},$.fn.select2.defaults,opts),"function"!=typeof opts.id&&(idKey=opts.id,opts.id=function(e){return e[idKey]}),$.isArray(opts.element.data("select2Tags"))){if("tags"in opts)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+opts.element.attr("id");opts.tags=opts.element.data("select2Tags")}if(select?(opts.query=this.bind(function(query){var children,placeholderOption,process,data={results:[],more:!1},term=query.term;process=function(element,collection){var group;element.is("option")?query.matcher(term,element.text(),element)&&collection.push(self.optionToData(element)):element.is("optgroup")&&(group=self.optionToData(element),element.children().each2(function(i,elm){process(elm,group.children)}),group.children.length>0&&collection.push(group))},children=element.children(),this.getPlaceholder()!==undefined&&children.length>0&&(placeholderOption=this.getPlaceholderOption(),placeholderOption&&(children=children.not(placeholderOption))),children.each2(function(i,elm){process(elm,data.results)}),query.callback(data)}),opts.id=function(e){return e.id},opts.formatResultCssClass=function(data){return data.css}):"query"in opts||("ajax"in opts?(ajaxUrl=opts.element.data("ajax-url"),ajaxUrl&&ajaxUrl.length>0&&(opts.ajax.url=ajaxUrl),opts.query=ajax.call(opts.element,opts.ajax)):"data"in opts?opts.query=local(opts.data):"tags"in opts&&(opts.query=tags(opts.tags),opts.createSearchChoice===undefined&&(opts.createSearchChoice=function(term){return{id:term,text:term}}),opts.initSelection===undefined&&(opts.initSelection=function(element,callback){var data=[];$(splitVal(element.val(),opts.separator)).each(function(){var id=this,text=this,tags=opts.tags;$.isFunction(tags)&&(tags=tags()),$(tags).each(function(){return equal(this.id,id)?(text=this.text,!1):void 0}),data.push({id:id,text:text})}),callback(data)}))),"function"!=typeof opts.query)throw"query function not defined for Select2 "+opts.element.attr("id");return opts},monitorSource:function(){var sync,el=this.opts.element;el.on("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),sync=this.bind(function(){var readonly,disabled=el.prop("disabled");disabled===undefined&&(disabled=!1),this.enable(!disabled);var readonly=el.prop("readonly");readonly===undefined&&(readonly=!1),this.readonly(readonly),syncCssClasses(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(evaluate(this.opts.containerCssClass)),syncCssClasses(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(evaluate(this.opts.dropdownCssClass))}),el.on("propertychange.select2 DOMAttrModified.select2",sync),this.mutationCallback===undefined&&(this.mutationCallback=function(mutations){mutations.forEach(sync)}),"undefined"!=typeof WebKitMutationObserver&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new WebKitMutationObserver(this.mutationCallback),this.propertyObserver.observe(el.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(data){var evt=$.Event("select2-selecting",{val:this.id(data),object:data});return this.opts.element.trigger(evt),!evt.isDefaultPrevented()},triggerChange:function(details){details=details||{},details=$.extend({},details,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(details),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var enabled=this._enabled&&!this._readonly,disabled=!enabled;return enabled===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",disabled),this.close(),this.enabledInterface=enabled,!0)},enable:function(enabled){return enabled===undefined&&(enabled=!0),this._enabled===enabled?!1:(this._enabled=enabled,this.opts.element.prop("disabled",!enabled),this.enableInterface(),!0)},readonly:function(enabled){return enabled===undefined&&(enabled=!1),this._readonly===enabled?!1:(this._readonly=enabled,this.opts.element.prop("readonly",enabled),this.enableInterface(),!0)},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var bodyOffset,above,css,resultsListNode,$dropdown=this.dropdown,offset=this.container.offset(),height=this.container.outerHeight(!1),width=this.container.outerWidth(!1),dropHeight=$dropdown.outerHeight(!1),viewPortRight=$(window).scrollLeft()+$(window).width(),viewportBottom=$(window).scrollTop()+$(window).height(),dropTop=offset.top+height,dropLeft=offset.left,enoughRoomBelow=viewportBottom>=dropTop+dropHeight,enoughRoomAbove=offset.top-dropHeight>=this.body().scrollTop(),dropWidth=$dropdown.outerWidth(!1),enoughRoomOnRight=viewPortRight>=dropLeft+dropWidth,aboveNow=$dropdown.hasClass("select2-drop-above");this.opts.dropdownAutoWidth?(resultsListNode=$(".select2-results",$dropdown)[0],$dropdown.addClass("select2-drop-auto-width"),$dropdown.css("width",""),dropWidth=$dropdown.outerWidth(!1)+(resultsListNode.scrollHeight===resultsListNode.clientHeight?0:scrollBarDimensions.width),dropWidth>width?width=dropWidth:dropWidth=width,enoughRoomOnRight=viewPortRight>=dropLeft+dropWidth):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body().css("position")&&(bodyOffset=this.body().offset(),dropTop-=bodyOffset.top,dropLeft-=bodyOffset.left),aboveNow?(above=!0,!enoughRoomAbove&&enoughRoomBelow&&(above=!1)):(above=!1,!enoughRoomBelow&&enoughRoomAbove&&(above=!0)),enoughRoomOnRight||(dropLeft=offset.left+width-dropWidth),above?(dropTop=offset.top-dropHeight,this.container.addClass("select2-drop-above"),$dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),$dropdown.removeClass("select2-drop-above")),css=$.extend({top:dropTop,left:dropLeft,width:width},evaluate(this.opts.dropdownCss)),$dropdown.css(css)},shouldOpen:function(){var event;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(event=$.Event("select2-opening"),this.opts.element.trigger(event),!event.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),!0):!1},opening:function(){function _makeMaskCss(){return{width:Math.max(document.documentElement.scrollWidth,$(window).width()),height:Math.max(document.documentElement.scrollHeight,$(window).height())}}var mask,maskCss,cid=this.containerId,scroll="scroll."+cid,resize="resize."+cid,orient="orientationchange."+cid;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),mask=$("#select2-drop-mask"),0==mask.length&&(mask=$(document.createElement("div")),mask.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),mask.hide(),mask.appendTo(this.body()),mask.on("mousedown touchstart click",function(e){var self,dropdown=$("#select2-drop");dropdown.length>0&&(self=dropdown.data("select2"),self.opts.selectOnBlur&&self.selectHighlighted({noFocus:!0}),self.close(),e.preventDefault(),e.stopPropagation())})),this.dropdown.prev()[0]!==mask[0]&&this.dropdown.before(mask),$("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),maskCss=_makeMaskCss(),mask.css(maskCss).show(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var that=this;this.container.parents().add(window).each(function(){$(this).on(resize+" "+scroll+" "+orient,function(){var maskCss=_makeMaskCss();$("#select2-drop-mask").css(maskCss),that.positionDropdown()})})},close:function(){if(this.opened()){var cid=this.containerId,scroll="scroll."+cid,resize="resize."+cid,orient="orientationchange."+cid;this.container.parents().add(window).each(function(){$(this).off(scroll).off(resize).off(orient)}),this.clearDropdownAlignmentPreference(),$("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger($.Event("select2-close"))}},externalSearch:function(term){this.open(),this.search.val(term),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return evaluate(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var children,index,child,hb,rb,y,more,results=this.results;if(index=this.highlight(),!(0>index)){if(0==index)return results.scrollTop(0),void 0;children=this.findHighlightableChoices().find(".select2-result-label"),child=$(children[index]),hb=child.offset().top+child.outerHeight(!0),index===children.length-1&&(more=results.find("li.select2-more-results"),more.length>0&&(hb=more.offset().top+more.outerHeight(!0))),rb=results.offset().top+results.outerHeight(!0),hb>rb&&results.scrollTop(results.scrollTop()+(hb-rb)),y=child.offset().top-results.offset().top,0>y&&"none"!=child.css("display")&&results.scrollTop(results.scrollTop()+y)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(delta){for(var choices=this.findHighlightableChoices(),index=this.highlight();index>-1&&index<choices.length;){index+=delta;var choice=$(choices[index]);if(choice.hasClass("select2-result-selectable")&&!choice.hasClass("select2-disabled")&&!choice.hasClass("select2-selected")){this.highlight(index);break}}},highlight:function(index){var choice,data,choices=this.findHighlightableChoices();return 0===arguments.length?indexOf(choices.filter(".select2-highlighted")[0],choices.get()):(index>=choices.length&&(index=choices.length-1),0>index&&(index=0),this.results.find(".select2-highlighted").removeClass("select2-highlighted"),choice=$(choices[index]),choice.addClass("select2-highlighted"),this.ensureHighlightVisible(),data=choice.data("select2-data"),data&&this.opts.element.trigger({type:"select2-highlight",val:this.id(data),choice:data}),void 0)},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(event){var el=$(event.target).closest(".select2-result-selectable");if(el.length>0&&!el.is(".select2-highlighted")){var choices=this.findHighlightableChoices();this.highlight(choices.index(el))}else 0==el.length&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var below,results=this.results,more=results.find("li.select2-more-results"),page=this.resultsPage+1,self=this,term=this.search.val(),context=this.context;0!==more.length&&(below=more.offset().top-results.offset().top-results.height(),below<=this.opts.loadMorePadding&&(more.addClass("select2-active"),this.opts.query({element:this.opts.element,term:term,page:page,context:context,matcher:this.opts.matcher,callback:this.bind(function(data){self.opened()&&(self.opts.populateResults.call(this,results,data.results,{term:term,page:page,context:context}),self.postprocessResults(data,!1,!1),data.more===!0?(more.detach().appendTo(results).text(self.opts.formatLoadMore(page+1)),window.setTimeout(function(){self.loadMoreIfNeeded()},10)):more.remove(),self.positionDropdown(),self.resultsPage=page,self.context=data.context)})})))},tokenize:function(){},updateResults:function(initial){function postRender(){search.removeClass("select2-active"),self.positionDropdown()}function render(html){results.html(html),postRender()}var data,input,search=this.search,results=this.results,opts=this.opts,self=this,term=search.val(),lastTerm=$.data(this.container,"select2-last-term");if((initial===!0||!lastTerm||!equal(term,lastTerm))&&($.data(this.container,"select2-last-term",term),initial===!0||this.showSearchInput!==!1&&this.opened())){var maxSelSize=this.getMaximumSelectionSize();if(maxSelSize>=1&&(data=this.data(),$.isArray(data)&&data.length>=maxSelSize&&checkFormatter(opts.formatSelectionTooBig,"formatSelectionTooBig")))return render("<li class='select2-selection-limit'>"+opts.formatSelectionTooBig(maxSelSize)+"</li>"),void 0;if(search.val().length<opts.minimumInputLength)return checkFormatter(opts.formatInputTooShort,"formatInputTooShort")?render("<li class='select2-no-results'>"+opts.formatInputTooShort(search.val(),opts.minimumInputLength)+"</li>"):render(""),initial&&this.showSearch&&this.showSearch(!0),void 0;if(opts.maximumInputLength&&search.val().length>opts.maximumInputLength)return checkFormatter(opts.formatInputTooLong,"formatInputTooLong")?render("<li class='select2-no-results'>"+opts.formatInputTooLong(search.val(),opts.maximumInputLength)+"</li>"):render(""),void 0;opts.formatSearching&&0===this.findHighlightableChoices().length&&render("<li class='select2-searching'>"+opts.formatSearching()+"</li>"),search.addClass("select2-active"),input=this.tokenize(),input!=undefined&&null!=input&&search.val(input),this.resultsPage=1,opts.query({element:opts.element,term:search.val(),page:this.resultsPage,context:null,matcher:opts.matcher,callback:this.bind(function(data){var def;return this.opened()?(this.context=data.context===undefined?null:data.context,this.opts.createSearchChoice&&""!==search.val()&&(def=this.opts.createSearchChoice.call(self,search.val(),data.results),def!==undefined&&null!==def&&self.id(def)!==undefined&&null!==self.id(def)&&0===$(data.results).filter(function(){return equal(self.id(this),self.id(def))}).length&&data.results.unshift(def)),0===data.results.length&&checkFormatter(opts.formatNoMatches,"formatNoMatches")?(render("<li class='select2-no-results'>"+opts.formatNoMatches(search.val())+"</li>"),void 0):(results.empty(),self.opts.populateResults.call(this,results,data.results,{term:search.val(),page:this.resultsPage,context:null}),data.more===!0&&checkFormatter(opts.formatLoadMore,"formatLoadMore")&&(results.append("<li class='select2-more-results'>"+self.opts.escapeMarkup(opts.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){self.loadMoreIfNeeded()},10)),this.postprocessResults(data,initial),postRender(),this.opts.element.trigger({type:"select2-loaded",items:data}),void 0)):(this.search.removeClass("select2-active"),void 0)})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){focus(this.search)},selectHighlighted:function(options){var index=this.highlight(),highlighted=this.results.find(".select2-highlighted"),data=highlighted.closest(".select2-result").data("select2-data");data?(this.highlight(index),this.onSelect(data,options)):options&&options.noFocus&&this.close()},getPlaceholder:function(){var placeholderOption;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((placeholderOption=this.getPlaceholderOption())!==undefined?placeholderOption.text():undefined)},getPlaceholderOption:function(){if(this.select){var firstOption=this.select.children().first();if(this.opts.placeholderOption!==undefined)return"first"===this.opts.placeholderOption&&firstOption||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===firstOption.text()&&""===firstOption.val())return firstOption}},initContainerWidth:function(){function resolveContainerWidth(){var style,attrs,matches,i,l;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(style=this.opts.element.attr("style"),style!==undefined)for(attrs=style.split(";"),i=0,l=attrs.length;l>i;i+=1)if(matches=attrs[i].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==matches&&matches.length>=1)return matches[1];return"resolve"===this.opts.width?(style=this.opts.element.css("width"),style.indexOf("%")>0?style:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return $.isFunction(this.opts.width)?this.opts.width():this.opts.width}var width=resolveContainerWidth.call(this);null!==width&&this.container.css("width",width)}}),SingleSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow'><b></b></span>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return container},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var el,range,len;
this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.search.focus(),el=this.search.get(0),el.createTextRange?(range=el.createTextRange(),range.collapse(!1),range.select()):el.setSelectionRange&&(len=this.search.val().length,el.setSelectionRange(len,len)),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger($.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},initContainer:function(){var selection,container=this.container,dropdown=this.dropdown;this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=selection=container.find(".select2-choice"),this.focusser=container.find(".select2-focusser"),this.focusser.attr("id","s2id_autogen"+nextUid()),$("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id")),this.focusser.attr("tabindex",this.elementTabIndex),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){if(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN)return killEvent(e),void 0;switch(e.which){case KEY.UP:case KEY.DOWN:return this.moveHighlight(e.which===KEY.UP?-1:1),killEvent(e),void 0;case KEY.ENTER:return this.selectHighlighted(),killEvent(e),void 0;case KEY.TAB:return this.selectHighlighted({noFocus:!0}),void 0;case KEY.ESC:return this.cancel(e),killEvent(e),void 0}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==KEY.TAB&&!KEY.isControl(e)&&!KEY.isFunctionKey(e)&&e.which!==KEY.ESC){if(this.opts.openOnEnter===!1&&e.which===KEY.ENTER)return killEvent(e),void 0;if(e.which==KEY.DOWN||e.which==KEY.UP||e.which==KEY.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),killEvent(e),void 0}return e.which==KEY.DELETE||e.which==KEY.BACKSPACE?(this.opts.allowClear&&this.clear(),killEvent(e),void 0):void 0}})),installKeyUpChangeEvent(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),selection.on("mousedown","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),killEventImmediately(e),this.close(),this.selection.focus())})),selection.on("mousedown",this.bind(function(e){this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),killEvent(e)})),dropdown.on("mousedown",this.bind(function(){this.search.focus()})),selection.on("focus",this.bind(function(e){killEvent(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger($.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(triggerChange){var data=this.selection.data("select2-data");if(data){var placeholderOption=this.getPlaceholderOption();this.opts.element.val(placeholderOption?placeholderOption.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),triggerChange!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(data),choice:data}),this.triggerChange({removed:data}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection([]),this.close(),this.setPlaceholder();else{var self=this;this.opts.initSelection.call(null,this.opts.element,function(selected){selected!==undefined&&null!==selected&&(self.updateSelection(selected),self.close(),self.setPlaceholder())})}},isPlaceholderOptionSelected:function(){var placeholderOption;return(placeholderOption=this.getPlaceholderOption())!==undefined&&placeholderOption.is(":selected")||""===this.opts.element.val()||this.opts.element.val()===undefined||null===this.opts.element.val()},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments),self=this;return"select"===opts.element.get(0).tagName.toLowerCase()?opts.initSelection=function(element,callback){var selected=element.find(":selected");callback(self.optionToData(selected))}:"data"in opts&&(opts.initSelection=opts.initSelection||function(element,callback){var id=element.val(),match=null;opts.query({matcher:function(term,text,el){var is_match=equal(id,opts.id(el));return is_match&&(match=el),is_match},callback:$.isFunction(callback)?function(){callback(match)}:$.noop})}),opts},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===undefined?undefined:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var placeholder=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&placeholder!==undefined){if(this.select&&this.getPlaceholderOption()===undefined)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(placeholder)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(data,initial,noHighlightUpdate){var selected=0,self=this;if(this.findHighlightableChoices().each2(function(i,elm){return equal(self.id(elm.data("select2-data")),self.opts.element.val())?(selected=i,!1):void 0}),noHighlightUpdate!==!1&&(initial===!0&&selected>=0?this.highlight(selected):this.highlight(0)),initial===!0){var min=this.opts.minimumResultsForSearch;min>=0&&this.showSearch(countResults(data.results)>=min)}},showSearch:function(showSearchInput){this.showSearchInput!==showSearchInput&&(this.showSearchInput=showSearchInput,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!showSearchInput),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!showSearchInput),$(this.dropdown,this.container).toggleClass("select2-with-searchbox",showSearchInput))},onSelect:function(data,options){if(this.triggerSelect(data)){var old=this.opts.element.val(),oldData=this.data();this.opts.element.val(this.id(data)),this.updateSelection(data),this.opts.element.trigger({type:"select2-selected",val:this.id(data),choice:data}),this.close(),options&&options.noFocus||this.selection.focus(),equal(old,this.id(data))||this.triggerChange({added:data,removed:oldData})}},updateSelection:function(data){var formatted,cssClass,container=this.selection.find(".select2-chosen");this.selection.data("select2-data",data),container.empty(),formatted=this.opts.formatSelection(data,container,this.opts.escapeMarkup),formatted!==undefined&&container.append(formatted),cssClass=this.opts.formatSelectionCssClass(data,container),cssClass!==undefined&&container.addClass(cssClass),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==undefined&&this.container.addClass("select2-allowclear")},val:function(){var val,triggerChange=!1,data=null,self=this,oldData=this.data();if(0===arguments.length)return this.opts.element.val();if(val=arguments[0],arguments.length>1&&(triggerChange=arguments[1]),this.select)this.select.val(val).find(":selected").each2(function(i,elm){return data=self.optionToData(elm),!1}),this.updateSelection(data),this.setPlaceholder(),triggerChange&&this.triggerChange({added:data,removed:oldData});else{if(!val&&0!==val)return this.clear(triggerChange),void 0;if(this.opts.initSelection===undefined)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(val),this.opts.initSelection(this.opts.element,function(data){self.opts.element.val(data?self.id(data):""),self.updateSelection(data),self.setPlaceholder(),triggerChange&&self.triggerChange({added:data,removed:oldData})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(value,triggerChange){var data;return 0===arguments.length?(data=this.selection.data("select2-data"),data==undefined&&(data=null),data):(value&&""!==value?(data=this.data(),this.opts.element.val(value?this.id(value):""),this.updateSelection(value),triggerChange&&this.triggerChange({added:value,removed:data})):this.clear(triggerChange),void 0)}}),MultiSelect2=clazz(AbstractSelect2,{createContainer:function(){var container=$(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitilize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return container},prepareOpts:function(){var opts=this.parent.prepareOpts.apply(this,arguments),self=this;return"select"===opts.element.get(0).tagName.toLowerCase()?opts.initSelection=function(element,callback){var data=[];element.find(":selected").each2(function(i,elm){data.push(self.optionToData(elm))}),callback(data)}:"data"in opts&&(opts.initSelection=opts.initSelection||function(element,callback){var ids=splitVal(element.val(),opts.separator),matches=[];opts.query({matcher:function(term,text,el){var is_match=$.grep(ids,function(id){return equal(id,opts.id(el))}).length;return is_match&&matches.push(el),is_match},callback:$.isFunction(callback)?function(){for(var ordered=[],i=0;i<ids.length;i++)for(var id=ids[i],j=0;j<matches.length;j++){var match=matches[j];if(equal(id,opts.id(match))){ordered.push(match),matches.splice(j,1);break}}callback(ordered)}:$.noop})}),opts},selectChoice:function(choice){var selected=this.container.find(".select2-search-choice-focus");selected.length&&choice&&choice[0]==selected[0]||(selected.length&&this.opts.element.trigger("choice-deselected",selected),selected.removeClass("select2-search-choice-focus"),choice&&choice.length&&(this.close(),choice.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",choice)))},initContainer:function(){var selection,selector=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=selection=this.container.find(selector);var _this=this;this.selection.on("mousedown",".select2-search-choice",function(){_this.search[0].focus(),_this.selectChoice($(this))}),this.search.attr("id","s2id_autogen"+nextUid()),$("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var selected=selection.find(".select2-search-choice-focus"),prev=selected.prev(".select2-search-choice:not(.select2-locked)"),next=selected.next(".select2-search-choice:not(.select2-locked)"),pos=getCursorInfo(this.search);if(selected.length&&(e.which==KEY.LEFT||e.which==KEY.RIGHT||e.which==KEY.BACKSPACE||e.which==KEY.DELETE||e.which==KEY.ENTER)){var selectedChoice=selected;return e.which==KEY.LEFT&&prev.length?selectedChoice=prev:e.which==KEY.RIGHT?selectedChoice=next.length?next:null:e.which===KEY.BACKSPACE?(this.unselect(selected.first()),this.search.width(10),selectedChoice=prev.length?prev:next):e.which==KEY.DELETE?(this.unselect(selected.first()),this.search.width(10),selectedChoice=next.length?next:null):e.which==KEY.ENTER&&(selectedChoice=null),this.selectChoice(selectedChoice),killEvent(e),selectedChoice&&selectedChoice.length||this.open(),void 0}if((e.which===KEY.BACKSPACE&&1==this.keydowns||e.which==KEY.LEFT)&&0==pos.offset&&!pos.length)return this.selectChoice(selection.find(".select2-search-choice:not(.select2-locked)").last()),killEvent(e),void 0;if(this.selectChoice(null),this.opened())switch(e.which){case KEY.UP:case KEY.DOWN:return this.moveHighlight(e.which===KEY.UP?-1:1),killEvent(e),void 0;case KEY.ENTER:return this.selectHighlighted(),killEvent(e),void 0;case KEY.TAB:return this.selectHighlighted({noFocus:!0}),this.close(),void 0;case KEY.ESC:return this.cancel(e),killEvent(e),void 0}if(e.which!==KEY.TAB&&!KEY.isControl(e)&&!KEY.isFunctionKey(e)&&e.which!==KEY.BACKSPACE&&e.which!==KEY.ESC){if(e.which===KEY.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===KEY.PAGE_UP||e.which===KEY.PAGE_DOWN)&&killEvent(e),e.which===KEY.ENTER&&killEvent(e)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),e.stopImmediatePropagation(),this.opts.element.trigger($.Event("select2-blur"))})),this.container.on("click",selector,this.bind(function(e){this.isInterfaceEnabled()&&($(e.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.open(),this.focusSearch(),e.preventDefault()))})),this.container.on("focus",selector,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger($.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var self=this;this.opts.initSelection.call(null,this.opts.element,function(data){data!==undefined&&null!==data&&(self.updateSelection(data),self.close(),self.clearSearch())})}},clearSearch:function(){var placeholder=this.getPlaceholder(),maxWidth=this.getMaxSearchWidth();placeholder!==undefined&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(placeholder).addClass("select2-default"),this.search.width(maxWidth>0?maxWidth:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.updateResults(!0),this.search.focus(),this.opts.element.trigger($.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(data){var ids=[],filtered=[],self=this;$(data).each(function(){indexOf(self.id(this),ids)<0&&(ids.push(self.id(this)),filtered.push(this))}),data=filtered,this.selection.find(".select2-search-choice").remove(),$(data).each(function(){self.addSelectedChoice(this)}),self.postprocessResults()},tokenize:function(){var input=this.search.val();input=this.opts.tokenizer.call(this,input,this.data(),this.bind(this.onSelect),this.opts),null!=input&&input!=undefined&&(this.search.val(input),input.length>0&&this.open())},onSelect:function(data,options){this.triggerSelect(data)&&(this.addSelectedChoice(data),this.opts.element.trigger({type:"selected",val:this.id(data),choice:data}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:data}),options&&options.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(data){var formatted,cssClass,enableChoice=!data.locked,enabledItem=$("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),disabledItem=$("<li class='select2-search-choice select2-locked'><div></div></li>"),choice=enableChoice?enabledItem:disabledItem,id=this.id(data),val=this.getVal();formatted=this.opts.formatSelection(data,choice.find("div"),this.opts.escapeMarkup),formatted!=undefined&&choice.find("div").replaceWith("<div>"+formatted+"</div>"),cssClass=this.opts.formatSelectionCssClass(data,choice.find("div")),cssClass!=undefined&&choice.addClass(cssClass),enableChoice&&choice.find(".select2-search-choice-close").on("mousedown",killEvent).on("click dblclick",this.bind(function(e){this.isInterfaceEnabled()&&($(e.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect($(e.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),killEvent(e))})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),choice.data("select2-data",data),choice.insertBefore(this.searchContainer),val.push(id),this.setVal(val)},unselect:function(selected){var data,index,val=this.getVal();if(selected=selected.closest(".select2-search-choice"),0===selected.length)throw"Invalid argument: "+selected+". Must be .select2-search-choice";data=selected.data("select2-data"),data&&(index=indexOf(this.id(data),val),index>=0&&(val.splice(index,1),this.setVal(val),this.select&&this.postprocessResults()),selected.remove(),this.opts.element.trigger({type:"removed",val:this.id(data),choice:data}),this.triggerChange({removed:data}))},postprocessResults:function(data,initial,noHighlightUpdate){var val=this.getVal(),choices=this.results.find(".select2-result"),compound=this.results.find(".select2-result-with-children"),self=this;choices.each2(function(i,choice){var id=self.id(choice.data("select2-data"));indexOf(id,val)>=0&&(choice.addClass("select2-selected"),choice.find(".select2-result-selectable").addClass("select2-selected"))}),compound.each2(function(i,choice){choice.is(".select2-result-selectable")||0!==choice.find(".select2-result-selectable:not(.select2-selected)").length||choice.addClass("select2-selected")}),-1==this.highlight()&&noHighlightUpdate!==!1&&self.highlight(0),!this.opts.createSearchChoice&&!choices.filter(".select2-result:not(.select2-selected)").length>0&&(!data||data&&!data.more&&0===this.results.find(".select2-no-results").length)&&checkFormatter(self.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+self.opts.formatNoMatches(self.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-getSideBorderPadding(this.search)},resizeSearch:function(){var minimumWidth,left,maxWidth,containerLeft,searchWidth,sideBorderPadding=getSideBorderPadding(this.search);minimumWidth=measureTextWidth(this.search)+10,left=this.search.offset().left,maxWidth=this.selection.width(),containerLeft=this.selection.offset().left,searchWidth=maxWidth-(left-containerLeft)-sideBorderPadding,minimumWidth>searchWidth&&(searchWidth=maxWidth-sideBorderPadding),40>searchWidth&&(searchWidth=maxWidth-sideBorderPadding),0>=searchWidth&&(searchWidth=minimumWidth),this.search.width(searchWidth)},getVal:function(){var val;return this.select?(val=this.select.val(),null===val?[]:val):(val=this.opts.element.val(),splitVal(val,this.opts.separator))},setVal:function(val){var unique;this.select?this.select.val(val):(unique=[],$(val).each(function(){indexOf(this,unique)<0&&unique.push(this)}),this.opts.element.val(0===unique.length?"":unique.join(this.opts.separator)))},buildChangeDetails:function(old,current){for(var current=current.slice(0),old=old.slice(0),i=0;i<current.length;i++)for(var j=0;j<old.length;j++)equal(this.opts.id(current[i]),this.opts.id(old[j]))&&(current.splice(i,1),i--,old.splice(j,1),j--);return{added:current,removed:old}},val:function(val,triggerChange){var oldData,self=this;if(0===arguments.length)return this.getVal();if(oldData=this.data(),oldData.length||(oldData=[]),!val&&0!==val)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),triggerChange&&this.triggerChange({added:this.data(),removed:oldData}),void 0;if(this.setVal(val),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),triggerChange&&this.triggerChange(this.buildChangeDetails(oldData,this.data()));else{if(this.opts.initSelection===undefined)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(data){var ids=$.map(data,self.id);self.setVal(ids),self.updateSelection(data),self.clearSearch(),triggerChange&&self.triggerChange(this.buildChangeDetails(oldData,this.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var val=[],self=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){val.push(self.opts.id($(this).data("select2-data")))}),this.setVal(val),this.triggerChange()},data:function(values,triggerChange){var ids,old,self=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){return $(this).data("select2-data")}).get():(old=this.data(),values||(values=[]),ids=$.map(values,function(e){return self.opts.id(e)}),this.setVal(ids),this.updateSelection(values),this.clearSearch(),triggerChange&&this.triggerChange(this.buildChangeDetails(old,this.data())),void 0)}}),$.fn.select2=function(){var opts,select2,method,value,multiple,args=Array.prototype.slice.call(arguments,0),allowedMethods=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","readonly","positionDropdown","data","search"],valueMethods=["val","opened","isFocused","container","data"],methodsMap={search:"externalSearch"};return this.each(function(){if(0===args.length||"object"==typeof args[0])opts=0===args.length?{}:$.extend({},args[0]),opts.element=$(this),"select"===opts.element.get(0).tagName.toLowerCase()?multiple=opts.element.prop("multiple"):(multiple=opts.multiple||!1,"tags"in opts&&(opts.multiple=multiple=!0)),select2=multiple?new MultiSelect2:new SingleSelect2,select2.init(opts);else{if("string"!=typeof args[0])throw"Invalid arguments to select2 plugin: "+args;if(indexOf(args[0],allowedMethods)<0)throw"Unknown method: "+args[0];if(value=undefined,select2=$(this).data("select2"),select2===undefined)return;if(method=args[0],"container"===method?value=select2.container:"dropdown"===method?value=select2.dropdown:(methodsMap[method]&&(method=methodsMap[method]),value=select2[method].apply(select2,args.slice(1))),indexOf(args[0],valueMethods)>=0)return!1}}),value===undefined?this:value},$.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(result,container,query,escapeMarkup){var markup=[];return markMatch(result.text,query.term,markup,escapeMarkup),markup.join("")},formatSelection:function(data,container,escapeMarkup){return data?escapeMarkup(data.text):undefined},sortResults:function(results){return results},formatResultCssClass:function(){return undefined},formatSelectionCssClass:function(){return undefined},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(input,min){var n=min-input.length;return"Please enter "+n+" more character"+(1==n?"":"s")},formatInputTooLong:function(input,max){var n=input.length-max;return"Please delete "+n+" character"+(1==n?"":"s")},formatSelectionTooBig:function(limit){return"You can only select "+limit+" item"+(1==limit?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(term,text){return(""+text).toUpperCase().indexOf((""+term).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:defaultTokenizer,escapeMarkup:defaultEscapeMarkup,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(c){return c},adaptDropdownCssClass:function(){return null}},$.fn.select2.ajaxDefaults={transport:$.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:ajax,local:local,tags:tags},util:{debounce:debounce,markMatch:markMatch,escapeMarkup:defaultEscapeMarkup},"class":{"abstract":AbstractSelect2,single:SingleSelect2,multi:MultiSelect2}}}}(jQuery),/**
 * sifter.js
 * Copyright (c) 2013 Brian Reavis & contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
 * file except in compliance with the License. You may obtain a copy of the License at:
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
 * ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 *
 * @author Brian Reavis <brian@thirdroute.com>
 */
function(root,factory){"function"==typeof define&&define.amd?define("sifter",factory):"object"==typeof exports?module.exports=factory():root.Sifter=factory()}(this,function(){var Sifter=function(items,settings){this.items=items,this.settings=settings||{diacritics:!0}};Sifter.prototype.tokenize=function(query){if(query=trim(String(query||"").toLowerCase()),!query||!query.length)return[];var i,n,regex,letter,tokens=[],words=query.split(/ +/);for(i=0,n=words.length;n>i;i++){if(regex=escape_regex(words[i]),this.settings.diacritics)for(letter in DIACRITICS)DIACRITICS.hasOwnProperty(letter)&&(regex=regex.replace(new RegExp(letter,"g"),DIACRITICS[letter]));tokens.push({string:words[i],regex:new RegExp(regex,"i")})}return tokens},Sifter.prototype.iterator=function(object,callback){var iterator;iterator=is_array(object)?Array.prototype.forEach||function(callback){for(var i=0,n=this.length;n>i;i++)callback(this[i],i,this)}:function(callback){for(var key in this)this.hasOwnProperty(key)&&callback(this[key],key,this)},iterator.apply(object,[callback])},Sifter.prototype.getScoreFunction=function(search,options){var self,fields,tokens,token_count,nesting;self=this,search=self.prepareSearch(search,options),tokens=search.tokens,fields=search.options.fields,token_count=tokens.length,nesting=search.options.nesting;var scoreValue=function(value,token){var score,pos;return value?(value=String(value||""),pos=value.search(token.regex),-1===pos?0:(score=token.string.length/value.length,0===pos&&(score+=.5),score)):0},scoreObject=function(){var field_count=fields.length;return field_count?1===field_count?function(token,data){return scoreValue(getattr(data,fields[0],nesting),token)}:function(token,data){for(var i=0,sum=0;field_count>i;i++)sum+=scoreValue(getattr(data,fields[i],nesting),token);return sum/field_count}:function(){return 0}}();return token_count?1===token_count?function(data){return scoreObject(tokens[0],data)}:"and"===search.options.conjunction?function(data){for(var score,i=0,sum=0;token_count>i;i++){if(score=scoreObject(tokens[i],data),0>=score)return 0;sum+=score}return sum/token_count}:function(data){for(var i=0,sum=0;token_count>i;i++)sum+=scoreObject(tokens[i],data);return sum/token_count}:function(){return 0}},Sifter.prototype.getSortFunction=function(search,options){var i,n,self,field,fields,fields_count,multiplier,multipliers,get_field,implicit_score,sort;if(self=this,search=self.prepareSearch(search,options),sort=!search.query&&options.sort_empty||options.sort,get_field=function(name,result){return"$score"===name?result.score:getattr(self.items[result.id],name,options.nesting)},fields=[],sort)for(i=0,n=sort.length;n>i;i++)(search.query||"$score"!==sort[i].field)&&fields.push(sort[i]);if(search.query){for(implicit_score=!0,i=0,n=fields.length;n>i;i++)if("$score"===fields[i].field){implicit_score=!1;break}implicit_score&&fields.unshift({field:"$score",direction:"desc"})}else for(i=0,n=fields.length;n>i;i++)if("$score"===fields[i].field){fields.splice(i,1);break}for(multipliers=[],i=0,n=fields.length;n>i;i++)multipliers.push("desc"===fields[i].direction?-1:1);return fields_count=fields.length,fields_count?1===fields_count?(field=fields[0].field,multiplier=multipliers[0],function(a,b){return multiplier*cmp(get_field(field,a),get_field(field,b))}):function(a,b){var i,result,field;for(i=0;fields_count>i;i++)if(field=fields[i].field,result=multipliers[i]*cmp(get_field(field,a),get_field(field,b)))return result;return 0}:null},Sifter.prototype.prepareSearch=function(query,options){if("object"==typeof query)return query;options=extend({},options);var option_fields=options.fields,option_sort=options.sort,option_sort_empty=options.sort_empty;return option_fields&&!is_array(option_fields)&&(options.fields=[option_fields]),option_sort&&!is_array(option_sort)&&(options.sort=[option_sort]),option_sort_empty&&!is_array(option_sort_empty)&&(options.sort_empty=[option_sort_empty]),{options:options,query:String(query||"").toLowerCase(),tokens:this.tokenize(query),total:0,items:[]}},Sifter.prototype.search=function(query,options){var score,search,fn_sort,fn_score,self=this;return search=this.prepareSearch(query,options),options=search.options,query=search.query,fn_score=options.score||self.getScoreFunction(search),query.length?self.iterator(self.items,function(item,id){score=fn_score(item),(options.filter===!1||score>0)&&search.items.push({score:score,id:id})}):self.iterator(self.items,function(item,id){search.items.push({score:1,id:id})}),fn_sort=self.getSortFunction(search,options),fn_sort&&search.items.sort(fn_sort),search.total=search.items.length,"number"==typeof options.limit&&(search.items=search.items.slice(0,options.limit)),search};var cmp=function(a,b){return"number"==typeof a&&"number"==typeof b?a>b?1:b>a?-1:0:(a=asciifold(String(a||"")),b=asciifold(String(b||"")),a>b?1:b>a?-1:0)},extend=function(a){var i,n,k,object;for(i=1,n=arguments.length;n>i;i++)if(object=arguments[i])for(k in object)object.hasOwnProperty(k)&&(a[k]=object[k]);return a},getattr=function(obj,name,nesting){if(obj&&name){if(!nesting)return obj[name];for(var names=name.split(".");names.length&&(obj=obj[names.shift()]););return obj}},trim=function(str){return(str+"").replace(/^\s+|\s+$|/g,"")},escape_regex=function(str){return(str+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},is_array=Array.isArray||"undefined"!=typeof $&&$.isArray||function(object){return"[object Array]"===Object.prototype.toString.call(object)},DIACRITICS={a:"[aḀḁĂăÂâǍǎȺⱥȦȧẠạÄäÀàÁáĀāÃãÅåąĄÃąĄ]",b:"[b␢βΒB฿𐌁ᛒ]",c:"[cĆćĈĉČčĊċC̄c̄ÇçḈḉȻȼƇƈɕᴄＣｃ]",d:"[dĎďḊḋḐḑḌḍḒḓḎḏĐđD̦d̦ƉɖƊɗƋƌᵭᶁᶑȡᴅＤｄð]",e:"[eÉéÈèÊêḘḙĚěĔĕẼẽḚḛẺẻĖėËëĒēȨȩĘęᶒɆɇȄȅẾếỀềỄễỂểḜḝḖḗḔḕȆȇẸẹỆệⱸᴇＥｅɘǝƏƐε]",f:"[fƑƒḞḟ]",g:"[gɢ₲ǤǥĜĝĞğĢģƓɠĠġ]",h:"[hĤĥĦħḨḩẖẖḤḥḢḣɦʰǶƕ]",i:"[iÍíÌìĬĭÎîǏǐÏïḮḯĨĩĮįĪīỈỉȈȉȊȋỊịḬḭƗɨɨ̆ᵻᶖİiIıɪＩｉ]",j:"[jȷĴĵɈɉʝɟʲ]",k:"[kƘƙꝀꝁḰḱǨǩḲḳḴḵκϰ₭]",l:"[lŁłĽľĻļĹĺḶḷḸḹḼḽḺḻĿŀȽƚⱠⱡⱢɫɬᶅɭȴʟＬｌ]",n:"[nŃńǸǹŇňÑñṄṅŅņṆṇṊṋṈṉN̈n̈ƝɲȠƞᵰᶇɳȵɴＮｎŊŋ]",o:"[oØøÖöÓóÒòÔôǑǒŐőŎŏȮȯỌọƟɵƠơỎỏŌōÕõǪǫȌȍՕօ]",p:"[pṔṕṖṗⱣᵽƤƥᵱ]",q:"[qꝖꝗʠɊɋꝘꝙq̃]",r:"[rŔŕɌɍŘřŖŗṘṙȐȑȒȓṚṛⱤɽ]",s:"[sŚśṠṡṢṣꞨꞩŜŝŠšŞşȘșS̈s̈]",t:"[tŤťṪṫŢţṬṭƮʈȚțṰṱṮṯƬƭ]",u:"[uŬŭɄʉỤụÜüÚúÙùÛûǓǔŰűŬŭƯưỦủŪūŨũŲųȔȕ∪]",v:"[vṼṽṾṿƲʋꝞꝟⱱʋ]",w:"[wẂẃẀẁŴŵẄẅẆẇẈẉ]",x:"[xẌẍẊẋχ]",y:"[yÝýỲỳŶŷŸÿỸỹẎẏỴỵɎɏƳƴ]",z:"[zŹźẐẑŽžŻżẒẓẔẕƵƶ]"},asciifold=function(){var i,n,k,chunk,foreignletters="",lookup={};for(k in DIACRITICS)if(DIACRITICS.hasOwnProperty(k))for(chunk=DIACRITICS[k].substring(2,DIACRITICS[k].length-1),foreignletters+=chunk,i=0,n=chunk.length;n>i;i++)lookup[chunk.charAt(i)]=k;var regexp=new RegExp("["+foreignletters+"]","g");return function(str){return str.replace(regexp,function(foreignletter){return lookup[foreignletter]}).toLowerCase()}}();return Sifter}),/**
 * microplugin.js
 * Copyright (c) 2013 Brian Reavis & contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
 * file except in compliance with the License. You may obtain a copy of the License at:
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
 * ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 *
 * @author Brian Reavis <brian@thirdroute.com>
 */
function(root,factory){"function"==typeof define&&define.amd?define("microplugin",factory):"object"==typeof exports?module.exports=factory():root.MicroPlugin=factory()}(this,function(){var MicroPlugin={};MicroPlugin.mixin=function(Interface){Interface.plugins={},Interface.prototype.initializePlugins=function(plugins){var i,n,key,self=this,queue=[];if(self.plugins={names:[],settings:{},requested:{},loaded:{}},utils.isArray(plugins))for(i=0,n=plugins.length;n>i;i++)"string"==typeof plugins[i]?queue.push(plugins[i]):(self.plugins.settings[plugins[i].name]=plugins[i].options,queue.push(plugins[i].name));else if(plugins)for(key in plugins)plugins.hasOwnProperty(key)&&(self.plugins.settings[key]=plugins[key],queue.push(key));for(;queue.length;)self.require(queue.shift())},Interface.prototype.loadPlugin=function(name){var self=this,plugins=self.plugins,plugin=Interface.plugins[name];if(!Interface.plugins.hasOwnProperty(name))throw new Error('Unable to find "'+name+'" plugin');plugins.requested[name]=!0,plugins.loaded[name]=plugin.fn.apply(self,[self.plugins.settings[name]||{}]),plugins.names.push(name)},Interface.prototype.require=function(name){var self=this,plugins=self.plugins;if(!self.plugins.loaded.hasOwnProperty(name)){if(plugins.requested[name])throw new Error('Plugin has circular dependency ("'+name+'")');self.loadPlugin(name)}return plugins.loaded[name]},Interface.define=function(name,fn){Interface.plugins[name]={name:name,fn:fn}}};var utils={isArray:Array.isArray||function(vArg){return"[object Array]"===Object.prototype.toString.call(vArg)}};return MicroPlugin}),/**
 * selectize.js (v0.12.4)
 * Copyright (c) 2013–2015 Brian Reavis & contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
 * file except in compliance with the License. You may obtain a copy of the License at:
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF
 * ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 *
 * @author Brian Reavis <brian@thirdroute.com>
 */
function(root,factory){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],factory):"object"==typeof exports?module.exports=factory(require("jquery"),require("sifter"),require("microplugin")):root.Selectize=factory(root.jQuery,root.Sifter,root.MicroPlugin)}(this,function($,Sifter,MicroPlugin){"use strict";var highlight=function($element,pattern){if("string"!=typeof pattern||pattern.length){var regex="string"==typeof pattern?new RegExp(pattern,"i"):pattern,highlight=function(node){var skip=0;if(3===node.nodeType){var pos=node.data.search(regex);if(pos>=0&&node.data.length>0){var match=node.data.match(regex),spannode=document.createElement("span");spannode.className="highlight";var middlebit=node.splitText(pos);middlebit.splitText(match[0].length);var middleclone=middlebit.cloneNode(!0);spannode.appendChild(middleclone),middlebit.parentNode.replaceChild(spannode,middlebit),skip=1}}else if(1===node.nodeType&&node.childNodes&&!/(script|style)/i.test(node.tagName))for(var i=0;i<node.childNodes.length;++i)i+=highlight(node.childNodes[i]);return skip};return $element.each(function(){highlight(this)})}};$.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var parent=this.parentNode;parent.replaceChild(this.firstChild,this),parent.normalize()}).end()};var MicroEvent=function(){};MicroEvent.prototype={on:function(event,fct){this._events=this._events||{},this._events[event]=this._events[event]||[],this._events[event].push(fct)},off:function(event,fct){var n=arguments.length;return 0===n?delete this._events:1===n?delete this._events[event]:(this._events=this._events||{},event in this._events!=!1&&this._events[event].splice(this._events[event].indexOf(fct),1),void 0)},trigger:function(event){if(this._events=this._events||{},event in this._events!=!1)for(var i=0;i<this._events[event].length;i++)this._events[event][i].apply(this,Array.prototype.slice.call(arguments,1))}},MicroEvent.mixin=function(destObject){for(var props=["on","off","trigger"],i=0;i<props.length;i++)destObject.prototype[props[i]]=MicroEvent.prototype[props[i]]};var IS_MAC=/Mac/.test(navigator.userAgent),KEY_A=65,KEY_RETURN=13,KEY_ESC=27,KEY_LEFT=37,KEY_UP=38,KEY_P=80,KEY_RIGHT=39,KEY_DOWN=40,KEY_N=78,KEY_BACKSPACE=8,KEY_DELETE=46,KEY_SHIFT=16,KEY_CMD=IS_MAC?91:17,KEY_CTRL=IS_MAC?18:17,KEY_TAB=9,TAG_SELECT=1,TAG_INPUT=2,SUPPORTS_VALIDITY_API=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,isset=function(object){return"undefined"!=typeof object},hash_key=function(value){return"undefined"==typeof value||null===value?null:"boolean"==typeof value?value?"1":"0":value+""},escape_html=function(str){return(str+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},hook={};hook.before=function(self,method,fn){var original=self[method];self[method]=function(){return fn.apply(self,arguments),original.apply(self,arguments)}},hook.after=function(self,method,fn){var original=self[method];self[method]=function(){var result=original.apply(self,arguments);return fn.apply(self,arguments),result}};var once=function(fn){var called=!1;return function(){called||(called=!0,fn.apply(this,arguments))}},debounce=function(fn,delay){var timeout;return function(){var self=this,args=arguments;window.clearTimeout(timeout),timeout=window.setTimeout(function(){fn.apply(self,args)},delay)}},debounce_events=function(self,types,fn){var type,trigger=self.trigger,event_args={};self.trigger=function(){var type=arguments[0];return-1===types.indexOf(type)?trigger.apply(self,arguments):(event_args[type]=arguments,void 0)},fn.apply(self,[]),self.trigger=trigger;for(type in event_args)event_args.hasOwnProperty(type)&&trigger.apply(self,event_args[type])},watchChildEvent=function($parent,event,selector,fn){$parent.on(event,selector,function(e){for(var child=e.target;child&&child.parentNode!==$parent[0];)child=child.parentNode;return e.currentTarget=child,fn.apply(this,[e])})},getSelection=function(input){var result={};if("selectionStart"in input)result.start=input.selectionStart,result.length=input.selectionEnd-result.start;else if(document.selection){input.focus();var sel=document.selection.createRange(),selLen=document.selection.createRange().text.length;sel.moveStart("character",-input.value.length),result.start=sel.text.length-selLen,result.length=selLen}return result},transferStyles=function($from,$to,properties){var i,n,styles={};if(properties)for(i=0,n=properties.length;n>i;i++)styles[properties[i]]=$from.css(properties[i]);else styles=$from.css();$to.css(styles)},measureString=function(str,$parent){if(!str)return 0;var $test=$("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(str).appendTo("body");transferStyles($parent,$test,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var width=$test.width();return $test.remove(),width},autoGrow=function($input){var currentWidth=null,update=function(e,options){var value,keyCode,printable,placeholder,width,shift,character,selection;e=e||window.event||{},options=options||{},e.metaKey||e.altKey||(options.force||$input.data("grow")!==!1)&&(value=$input.val(),e.type&&"keydown"===e.type.toLowerCase()&&(keyCode=e.keyCode,printable=keyCode>=97&&122>=keyCode||keyCode>=65&&90>=keyCode||keyCode>=48&&57>=keyCode||32===keyCode,keyCode===KEY_DELETE||keyCode===KEY_BACKSPACE?(selection=getSelection($input[0]),selection.length?value=value.substring(0,selection.start)+value.substring(selection.start+selection.length):keyCode===KEY_BACKSPACE&&selection.start?value=value.substring(0,selection.start-1)+value.substring(selection.start+1):keyCode===KEY_DELETE&&"undefined"!=typeof selection.start&&(value=value.substring(0,selection.start)+value.substring(selection.start+1))):printable&&(shift=e.shiftKey,character=String.fromCharCode(e.keyCode),character=shift?character.toUpperCase():character.toLowerCase(),value+=character)),placeholder=$input.attr("placeholder"),!value&&placeholder&&(value=placeholder),width=measureString(value,$input)+4,width!==currentWidth&&(currentWidth=width,$input.width(width),$input.triggerHandler("resize")))};$input.on("keydown keyup update blur",update),update()},domToString=function(d){var tmp=document.createElement("div");return tmp.appendChild(d.cloneNode(!0)),tmp.innerHTML},logError=function(message,options){options||(options={});var component="Selectize";console.error(component+": "+message),options.explanation&&(console.group&&console.group(),console.error(options.explanation),console.group&&console.groupEnd())},Selectize=function($input,settings){var i,n,dir,input,self=this;input=$input[0],input.selectize=self;var computedStyle=window.getComputedStyle&&window.getComputedStyle(input,null);if(dir=computedStyle?computedStyle.getPropertyValue("direction"):input.currentStyle&&input.currentStyle.direction,dir=dir||$input.parents("[dir]:first").attr("dir")||"",$.extend(self,{order:0,settings:settings,$input:$input,tabIndex:$input.attr("tabindex")||"",tagType:"select"===input.tagName.toLowerCase()?TAG_SELECT:TAG_INPUT,rtl:/rtl/i.test(dir),eventNS:".selectize"+ ++Selectize.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:$input.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===settings.loadThrottle?self.onSearchChange:debounce(self.onSearchChange,settings.loadThrottle)}),self.sifter=new Sifter(this.options,{diacritics:settings.diacritics}),self.settings.options){for(i=0,n=self.settings.options.length;n>i;i++)self.registerOption(self.settings.options[i]);delete self.settings.options}if(self.settings.optgroups){for(i=0,n=self.settings.optgroups.length;n>i;i++)self.registerOptionGroup(self.settings.optgroups[i]);delete self.settings.optgroups}self.settings.mode=self.settings.mode||(1===self.settings.maxItems?"single":"multi"),"boolean"!=typeof self.settings.hideSelected&&(self.settings.hideSelected="multi"===self.settings.mode),self.initializePlugins(self.settings.plugins),self.setupCallbacks(),self.setupTemplates(),self.setup()};return MicroEvent.mixin(Selectize),"undefined"!=typeof MicroPlugin?MicroPlugin.mixin(Selectize):logError("Dependency MicroPlugin is missing",{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}),$.extend(Selectize.prototype,{setup:function(){var $wrapper,$control,$control_input,$dropdown,$dropdown_content,$dropdown_parent,inputMode,classes,classes_plugins,inputId,self=this,settings=self.settings,eventNS=self.eventNS,$window=$(window),$document=$(document),$input=self.$input;if(inputMode=self.settings.mode,classes=$input.attr("class")||"",$wrapper=$("<div>").addClass(settings.wrapperClass).addClass(classes).addClass(inputMode),$control=$("<div>").addClass(settings.inputClass).addClass("items").appendTo($wrapper),$control_input=$('<input type="text" autocomplete="off" />').appendTo($control).attr("tabindex",$input.is(":disabled")?"-1":self.tabIndex),$dropdown_parent=$(settings.dropdownParent||$wrapper),$dropdown=$("<div>").addClass(settings.dropdownClass).addClass(inputMode).hide().appendTo($dropdown_parent),$dropdown_content=$("<div>").addClass(settings.dropdownContentClass).appendTo($dropdown),(inputId=$input.attr("id"))&&($control_input.attr("id",inputId+"-selectized"),$("label[for='"+inputId+"']").attr("for",inputId+"-selectized")),self.settings.copyClassesToDropdown&&$dropdown.addClass(classes),$wrapper.css({width:$input[0].style.width}),self.plugins.names.length&&(classes_plugins="plugin-"+self.plugins.names.join(" plugin-"),$wrapper.addClass(classes_plugins),$dropdown.addClass(classes_plugins)),(null===settings.maxItems||settings.maxItems>1)&&self.tagType===TAG_SELECT&&$input.attr("multiple","multiple"),self.settings.placeholder&&$control_input.attr("placeholder",settings.placeholder),!self.settings.splitOn&&self.settings.delimiter){var delimiterEscaped=self.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");self.settings.splitOn=new RegExp("\\s*"+delimiterEscaped+"+\\s*")}$input.attr("autocorrect")&&$control_input.attr("autocorrect",$input.attr("autocorrect")),$input.attr("autocapitalize")&&$control_input.attr("autocapitalize",$input.attr("autocapitalize")),self.$wrapper=$wrapper,self.$control=$control,self.$control_input=$control_input,self.$dropdown=$dropdown,self.$dropdown_content=$dropdown_content,$dropdown.on("mouseenter","[data-selectable]",function(){return self.onOptionHover.apply(self,arguments)}),$dropdown.on("mousedown click","[data-selectable]",function(){return self.onOptionSelect.apply(self,arguments)}),watchChildEvent($control,"mousedown","*:not(input)",function(){return self.onItemSelect.apply(self,arguments)}),autoGrow($control_input),$control.on({mousedown:function(){return self.onMouseDown.apply(self,arguments)},click:function(){return self.onClick.apply(self,arguments)}}),$control_input.on({mousedown:function(e){e.stopPropagation()},keydown:function(){return self.onKeyDown.apply(self,arguments)},keyup:function(){return self.onKeyUp.apply(self,arguments)},keypress:function(){return self.onKeyPress.apply(self,arguments)},resize:function(){self.positionDropdown.apply(self,[])},blur:function(){return self.onBlur.apply(self,arguments)},focus:function(){return self.ignoreBlur=!1,self.onFocus.apply(self,arguments)},paste:function(){return self.onPaste.apply(self,arguments)}}),$document.on("keydown"+eventNS,function(e){self.isCmdDown=e[IS_MAC?"metaKey":"ctrlKey"],self.isCtrlDown=e[IS_MAC?"altKey":"ctrlKey"],self.isShiftDown=e.shiftKey}),$document.on("keyup"+eventNS,function(e){e.keyCode===KEY_CTRL&&(self.isCtrlDown=!1),e.keyCode===KEY_SHIFT&&(self.isShiftDown=!1),e.keyCode===KEY_CMD&&(self.isCmdDown=!1)}),$document.on("mousedown"+eventNS,function(e){if(self.isFocused){if(e.target===self.$dropdown[0]||e.target.parentNode===self.$dropdown[0])return!1;self.$control.has(e.target).length||e.target===self.$control[0]||self.blur(e.target)}}),$window.on(["scroll"+eventNS,"resize"+eventNS].join(" "),function(){self.isOpen&&self.positionDropdown.apply(self,arguments)}),$window.on("mousemove"+eventNS,function(){self.ignoreHover=!1}),this.revertSettings={$children:$input.children().detach(),tabindex:$input.attr("tabindex")},$input.attr("tabindex",-1).hide().after(self.$wrapper),$.isArray(settings.items)&&(self.setValue(settings.items),delete settings.items),SUPPORTS_VALIDITY_API&&$input.on("invalid"+eventNS,function(e){e.preventDefault(),self.isInvalid=!0,self.refreshState()}),self.updateOriginalInput(),self.refreshItems(),self.refreshState(),self.updatePlaceholder(),self.isSetup=!0,$input.is(":disabled")&&self.disable(),self.on("change",this.onChange),$input.data("selectize",self),$input.addClass("selectized"),self.trigger("initialize"),settings.preload===!0&&self.onSearchChange("")},setupTemplates:function(){var self=this,field_label=self.settings.labelField,field_optgroup=self.settings.optgroupLabelField,templates={optgroup:function(data){return'<div class="optgroup">'+data.html+"</div>"},optgroup_header:function(data,escape){return'<div class="optgroup-header">'+escape(data[field_optgroup])+"</div>"},option:function(data,escape){return'<div class="option">'+escape(data[field_label])+"</div>"},item:function(data,escape){return'<div class="item">'+escape(data[field_label])+"</div>"},option_create:function(data,escape){return'<div class="create">Add <strong>'+escape(data.input)+"</strong>&hellip;</div>"}};self.settings.render=$.extend({},templates,self.settings.render)},setupCallbacks:function(){var key,fn,callbacks={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(key in callbacks)callbacks.hasOwnProperty(key)&&(fn=this.settings[callbacks[key]],fn&&this.on(key,fn))},onClick:function(e){var self=this;self.focus(),e.preventDefault()},onMouseDown:function(e){var self=this,defaultPrevented=e.isDefaultPrevented();if($(e.target),self.isFocused){if(e.target!==self.$control_input[0])return"single"===self.settings.mode?self.isOpen?self.close():self.open():defaultPrevented||self.setActiveItem(null),!1}else defaultPrevented||window.setTimeout(function(){self.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(e){var self=this;return self.isFull()||self.isInputHidden||self.isLocked?(e.preventDefault(),void 0):(self.settings.splitOn&&setTimeout(function(){var pastedText=self.$control_input.val();if(pastedText.match(self.settings.splitOn))for(var splitInput=$.trim(pastedText).split(self.settings.splitOn),i=0,n=splitInput.length;n>i;i++)self.createItem(splitInput[i])},0),void 0)},onKeyPress:function(e){if(this.isLocked)return e&&e.preventDefault();var character=String.fromCharCode(e.keyCode||e.which);return this.settings.create&&"multi"===this.settings.mode&&character===this.settings.delimiter?(this.createItem(),e.preventDefault(),!1):void 0},onKeyDown:function(e){e.target===this.$control_input[0];var self=this;if(self.isLocked)return e.keyCode!==KEY_TAB&&e.preventDefault(),void 0;switch(e.keyCode){case KEY_A:if(self.isCmdDown)return self.selectAll(),void 0;break;case KEY_ESC:return self.isOpen&&(e.preventDefault(),e.stopPropagation(),self.close()),void 0;case KEY_N:if(!e.ctrlKey||e.altKey)break;case KEY_DOWN:if(!self.isOpen&&self.hasOptions)self.open();else if(self.$activeOption){self.ignoreHover=!0;var $next=self.getAdjacentOption(self.$activeOption,1);$next.length&&self.setActiveOption($next,!0,!0)}return e.preventDefault(),void 0;case KEY_P:if(!e.ctrlKey||e.altKey)break;case KEY_UP:if(self.$activeOption){self.ignoreHover=!0;var $prev=self.getAdjacentOption(self.$activeOption,-1);$prev.length&&self.setActiveOption($prev,!0,!0)}return e.preventDefault(),void 0;case KEY_RETURN:return self.isOpen&&self.$activeOption&&(self.onOptionSelect({currentTarget:self.$activeOption}),e.preventDefault()),void 0;case KEY_LEFT:return self.advanceSelection(-1,e),void 0;case KEY_RIGHT:return self.advanceSelection(1,e),void 0;case KEY_TAB:return self.settings.selectOnTab&&self.isOpen&&self.$activeOption&&(self.onOptionSelect({currentTarget:self.$activeOption}),self.isFull()||e.preventDefault()),self.settings.create&&self.createItem()&&e.preventDefault(),void 0;case KEY_BACKSPACE:case KEY_DELETE:return self.deleteSelection(e),void 0}return!self.isFull()&&!self.isInputHidden||(IS_MAC?e.metaKey:e.ctrlKey)?void 0:(e.preventDefault(),void 0)},onKeyUp:function(e){var self=this;if(self.isLocked)return e&&e.preventDefault();var value=self.$control_input.val()||"";self.lastValue!==value&&(self.lastValue=value,self.onSearchChange(value),self.refreshOptions(),self.trigger("type",value))},onSearchChange:function(value){var self=this,fn=self.settings.load;fn&&(self.loadedSearches.hasOwnProperty(value)||(self.loadedSearches[value]=!0,self.load(function(callback){fn.apply(self,[value,callback])})))},onFocus:function(e){var self=this,wasFocused=self.isFocused;return self.isDisabled?(self.blur(),e&&e.preventDefault(),!1):(self.ignoreFocus||(self.isFocused=!0,"focus"===self.settings.preload&&self.onSearchChange(""),wasFocused||self.trigger("focus"),self.$activeItems.length||(self.showInput(),self.setActiveItem(null),self.refreshOptions(!!self.settings.openOnFocus)),self.refreshState()),void 0)},onBlur:function(e,dest){var self=this;if(self.isFocused&&(self.isFocused=!1,!self.ignoreFocus)){if(!self.ignoreBlur&&document.activeElement===self.$dropdown_content[0])return self.ignoreBlur=!0,self.onFocus(e),void 0;var deactivate=function(){self.close(),self.setTextboxValue(""),self.setActiveItem(null),self.setActiveOption(null),self.setCaret(self.items.length),self.refreshState(),dest&&dest.focus&&dest.focus(),self.ignoreFocus=!1,self.trigger("blur")};self.ignoreFocus=!0,self.settings.create&&self.settings.createOnBlur?self.createItem(null,!1,deactivate):deactivate()}},onOptionHover:function(e){this.ignoreHover||this.setActiveOption(e.currentTarget,!1)},onOptionSelect:function(e){var value,$target,self=this;e.preventDefault&&(e.preventDefault(),e.stopPropagation()),$target=$(e.currentTarget),$target.hasClass("create")?self.createItem(null,function(){self.settings.closeAfterSelect&&self.close()}):(value=$target.attr("data-value"),"undefined"!=typeof value&&(self.lastQuery=null,self.setTextboxValue(""),self.addItem(value),self.settings.closeAfterSelect?self.close():!self.settings.hideSelected&&e.type&&/mouse/.test(e.type)&&self.setActiveOption(self.getOption(value))))},onItemSelect:function(e){var self=this;self.isLocked||"multi"===self.settings.mode&&(e.preventDefault(),self.setActiveItem(e.currentTarget,e))},load:function(fn){var self=this,$wrapper=self.$wrapper.addClass(self.settings.loadingClass);self.loading++,fn.apply(self,[function(results){self.loading=Math.max(self.loading-1,0),results&&results.length&&(self.addOption(results),self.refreshOptions(self.isFocused&&!self.isInputHidden)),self.loading||$wrapper.removeClass(self.settings.loadingClass),self.trigger("load",results)}])},setTextboxValue:function(value){var $input=this.$control_input,changed=$input.val()!==value;changed&&($input.val(value).triggerHandler("update"),this.lastValue=value)},getValue:function(){return this.tagType===TAG_SELECT&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(value,silent){var events=silent?[]:["change"];debounce_events(this,events,function(){this.clear(silent),this.addItems(value,silent)})},setActiveItem:function($item,e){var eventName,i,idx,begin,end,item,swap,$last,self=this;if("single"!==self.settings.mode){if($item=$($item),!$item.length)return $(self.$activeItems).removeClass("active"),self.$activeItems=[],self.isFocused&&self.showInput(),void 0;if(eventName=e&&e.type.toLowerCase(),"mousedown"===eventName&&self.isShiftDown&&self.$activeItems.length){for($last=self.$control.children(".active:last"),begin=Array.prototype.indexOf.apply(self.$control[0].childNodes,[$last[0]]),end=Array.prototype.indexOf.apply(self.$control[0].childNodes,[$item[0]]),begin>end&&(swap=begin,begin=end,end=swap),i=begin;end>=i;i++)item=self.$control[0].childNodes[i],-1===self.$activeItems.indexOf(item)&&($(item).addClass("active"),self.$activeItems.push(item));e.preventDefault()}else"mousedown"===eventName&&self.isCtrlDown||"keydown"===eventName&&this.isShiftDown?$item.hasClass("active")?(idx=self.$activeItems.indexOf($item[0]),self.$activeItems.splice(idx,1),$item.removeClass("active")):self.$activeItems.push($item.addClass("active")[0]):($(self.$activeItems).removeClass("active"),self.$activeItems=[$item.addClass("active")[0]]);self.hideInput(),this.isFocused||self.focus()}},setActiveOption:function($option,scroll,animate){var height_menu,height_item,y,scroll_top,scroll_bottom,self=this;self.$activeOption&&self.$activeOption.removeClass("active"),self.$activeOption=null,$option=$($option),$option.length&&(self.$activeOption=$option.addClass("active"),(scroll||!isset(scroll))&&(height_menu=self.$dropdown_content.height(),height_item=self.$activeOption.outerHeight(!0),scroll=self.$dropdown_content.scrollTop()||0,y=self.$activeOption.offset().top-self.$dropdown_content.offset().top+scroll,scroll_top=y,scroll_bottom=y-height_menu+height_item,y+height_item>height_menu+scroll?self.$dropdown_content.stop().animate({scrollTop:scroll_bottom},animate?self.settings.scrollDuration:0):scroll>y&&self.$dropdown_content.stop().animate({scrollTop:scroll_top},animate?self.settings.scrollDuration:0)))},selectAll:function(){var self=this;"single"!==self.settings.mode&&(self.$activeItems=Array.prototype.slice.apply(self.$control.children(":not(input)").addClass("active")),self.$activeItems.length&&(self.hideInput(),self.close()),self.focus())},hideInput:function(){var self=this;self.setTextboxValue(""),self.$control_input.css({opacity:0,position:"absolute",left:self.rtl?1e4:-1e4}),self.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var self=this;self.isDisabled||(self.ignoreFocus=!0,self.$control_input[0].focus(),window.setTimeout(function(){self.ignoreFocus=!1,self.onFocus()},0))},blur:function(dest){this.$control_input[0].blur(),this.onBlur(null,dest)},getScoreFunction:function(query){return this.sifter.getScoreFunction(query,this.getSearchOptions())},getSearchOptions:function(){var settings=this.settings,sort=settings.sortField;return"string"==typeof sort&&(sort=[{field:sort}]),{fields:settings.searchField,conjunction:settings.searchConjunction,sort:sort}},search:function(query){var i,result,calculateScore,self=this,settings=self.settings,options=this.getSearchOptions();if(settings.score&&(calculateScore=self.settings.score.apply(this,[query]),"function"!=typeof calculateScore))throw new Error('Selectize "score" setting must be a function that returns a function');if(query!==self.lastQuery?(self.lastQuery=query,result=self.sifter.search(query,$.extend(options,{score:calculateScore})),self.currentResults=result):result=$.extend(!0,{},self.currentResults),settings.hideSelected)for(i=result.items.length-1;i>=0;i--)-1!==self.items.indexOf(hash_key(result.items[i].id))&&result.items.splice(i,1);return result},refreshOptions:function(triggerDropdown){var i,j,k,n,groups,groups_order,option,option_html,optgroup,optgroups,html,html_children,has_create_option,$active,$active_before,$create;"undefined"==typeof triggerDropdown&&(triggerDropdown=!0);var self=this,query=$.trim(self.$control_input.val()),results=self.search(query),$dropdown_content=self.$dropdown_content,active_before=self.$activeOption&&hash_key(self.$activeOption.attr("data-value"));for(n=results.items.length,"number"==typeof self.settings.maxOptions&&(n=Math.min(n,self.settings.maxOptions)),groups={},groups_order=[],i=0;n>i;i++)for(option=self.options[results.items[i].id],option_html=self.render("option",option),optgroup=option[self.settings.optgroupField]||"",optgroups=$.isArray(optgroup)?optgroup:[optgroup],j=0,k=optgroups&&optgroups.length;k>j;j++)optgroup=optgroups[j],self.optgroups.hasOwnProperty(optgroup)||(optgroup=""),groups.hasOwnProperty(optgroup)||(groups[optgroup]=document.createDocumentFragment(),groups_order.push(optgroup)),groups[optgroup].appendChild(option_html);for(this.settings.lockOptgroupOrder&&groups_order.sort(function(a,b){var a_order=self.optgroups[a].$order||0,b_order=self.optgroups[b].$order||0;return a_order-b_order}),html=document.createDocumentFragment(),i=0,n=groups_order.length;n>i;i++)optgroup=groups_order[i],self.optgroups.hasOwnProperty(optgroup)&&groups[optgroup].childNodes.length?(html_children=document.createDocumentFragment(),html_children.appendChild(self.render("optgroup_header",self.optgroups[optgroup])),html_children.appendChild(groups[optgroup]),html.appendChild(self.render("optgroup",$.extend({},self.optgroups[optgroup],{html:domToString(html_children),dom:html_children})))):html.appendChild(groups[optgroup]);if($dropdown_content.html(html),self.settings.highlight&&results.query.length&&results.tokens.length)for($dropdown_content.removeHighlight(),i=0,n=results.tokens.length;n>i;i++)highlight($dropdown_content,results.tokens[i].regex);if(!self.settings.hideSelected)for(i=0,n=self.items.length;n>i;i++)self.getOption(self.items[i]).addClass("selected");has_create_option=self.canCreate(query),has_create_option&&($dropdown_content.prepend(self.render("option_create",{input:query})),$create=$($dropdown_content[0].childNodes[0])),self.hasOptions=results.items.length>0||has_create_option,self.hasOptions?(results.items.length>0?($active_before=active_before&&self.getOption(active_before),$active_before&&$active_before.length?$active=$active_before:"single"===self.settings.mode&&self.items.length&&($active=self.getOption(self.items[0])),$active&&$active.length||($active=$create&&!self.settings.addPrecedence?self.getAdjacentOption($create,1):$dropdown_content.find("[data-selectable]:first"))):$active=$create,self.setActiveOption($active),triggerDropdown&&!self.isOpen&&self.open()):(self.setActiveOption(null),triggerDropdown&&self.isOpen&&self.close())},addOption:function(data){var i,n,value,self=this;if($.isArray(data))for(i=0,n=data.length;n>i;i++)self.addOption(data[i]);else(value=self.registerOption(data))&&(self.userOptions[value]=!0,self.lastQuery=null,self.trigger("option_add",value,data))},registerOption:function(data){var key=hash_key(data[this.settings.valueField]);return"undefined"==typeof key||null===key||this.options.hasOwnProperty(key)?!1:(data.$order=data.$order||++this.order,this.options[key]=data,key)},registerOptionGroup:function(data){var key=hash_key(data[this.settings.optgroupValueField]);return key?(data.$order=data.$order||++this.order,this.optgroups[key]=data,key):!1},addOptionGroup:function(id,data){data[this.settings.optgroupValueField]=id,(id=this.registerOptionGroup(data))&&this.trigger("optgroup_add",id,data)},removeOptionGroup:function(id){this.optgroups.hasOwnProperty(id)&&(delete this.optgroups[id],this.renderCache={},this.trigger("optgroup_remove",id))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(value,data){var $item,$item_new,value_new,index_item,cache_items,cache_options,order_old,self=this;if(value=hash_key(value),value_new=hash_key(data[self.settings.valueField]),null!==value&&self.options.hasOwnProperty(value)){if("string"!=typeof value_new)throw new Error("Value must be set in option data");order_old=self.options[value].$order,value_new!==value&&(delete self.options[value],index_item=self.items.indexOf(value),-1!==index_item&&self.items.splice(index_item,1,value_new)),data.$order=data.$order||order_old,self.options[value_new]=data,cache_items=self.renderCache.item,cache_options=self.renderCache.option,cache_items&&(delete cache_items[value],delete cache_items[value_new]),cache_options&&(delete cache_options[value],delete cache_options[value_new]),-1!==self.items.indexOf(value_new)&&($item=self.getItem(value),$item_new=$(self.render("item",data)),$item.hasClass("active")&&$item_new.addClass("active"),$item.replaceWith($item_new)),self.lastQuery=null,self.isOpen&&self.refreshOptions(!1)}},removeOption:function(value,silent){var self=this;value=hash_key(value);var cache_items=self.renderCache.item,cache_options=self.renderCache.option;cache_items&&delete cache_items[value],cache_options&&delete cache_options[value],delete self.userOptions[value],delete self.options[value],self.lastQuery=null,self.trigger("option_remove",value),self.removeItem(value,silent)},clearOptions:function(){var self=this;self.loadedSearches={},self.userOptions={},self.renderCache={},self.options=self.sifter.items={},self.lastQuery=null,self.trigger("option_clear"),self.clear()},getOption:function(value){return this.getElementWithValue(value,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function($option,direction){var $options=this.$dropdown.find("[data-selectable]"),index=$options.index($option)+direction;return index>=0&&index<$options.length?$options.eq(index):$()},getElementWithValue:function(value,$els){if(value=hash_key(value),"undefined"!=typeof value&&null!==value)for(var i=0,n=$els.length;n>i;i++)if($els[i].getAttribute("data-value")===value)return $($els[i]);return $()},getItem:function(value){return this.getElementWithValue(value,this.$control.children())},addItems:function(values,silent){for(var items=$.isArray(values)?values:[values],i=0,n=items.length;n>i;i++)this.isPending=n-1>i,this.addItem(items[i],silent)},addItem:function(value,silent){var events=silent?[]:["change"];debounce_events(this,events,function(){var $item,$option,$options,value_next,wasFull,self=this,inputMode=self.settings.mode;return value=hash_key(value),-1!==self.items.indexOf(value)?("single"===inputMode&&self.close(),void 0):(self.options.hasOwnProperty(value)&&("single"===inputMode&&self.clear(silent),"multi"===inputMode&&self.isFull()||($item=$(self.render("item",self.options[value])),wasFull=self.isFull(),self.items.splice(self.caretPos,0,value),self.insertAtCaret($item),(!self.isPending||!wasFull&&self.isFull())&&self.refreshState(),self.isSetup&&($options=self.$dropdown_content.find("[data-selectable]"),self.isPending||($option=self.getOption(value),value_next=self.getAdjacentOption($option,1).attr("data-value"),self.refreshOptions(self.isFocused&&"single"!==inputMode),value_next&&self.setActiveOption(self.getOption(value_next))),!$options.length||self.isFull()?self.close():self.positionDropdown(),self.updatePlaceholder(),self.trigger("item_add",value,$item),self.updateOriginalInput({silent:silent})))),void 0)})},removeItem:function(value,silent){var $item,i,idx,self=this;$item=value instanceof $?value:self.getItem(value),value=hash_key($item.attr("data-value")),i=self.items.indexOf(value),-1!==i&&($item.remove(),$item.hasClass("active")&&(idx=self.$activeItems.indexOf($item[0]),self.$activeItems.splice(idx,1)),self.items.splice(i,1),self.lastQuery=null,!self.settings.persist&&self.userOptions.hasOwnProperty(value)&&self.removeOption(value,silent),i<self.caretPos&&self.setCaret(self.caretPos-1),self.refreshState(),self.updatePlaceholder(),self.updateOriginalInput({silent:silent}),self.positionDropdown(),self.trigger("item_remove",value,$item))},createItem:function(input,triggerDropdown){var self=this,caret=self.caretPos;input=input||$.trim(self.$control_input.val()||"");var callback=arguments[arguments.length-1];if("function"!=typeof callback&&(callback=function(){}),"boolean"!=typeof triggerDropdown&&(triggerDropdown=!0),!self.canCreate(input))return callback(),!1;self.lock();var setup="function"==typeof self.settings.create?this.settings.create:function(input){var data={};return data[self.settings.labelField]=input,data[self.settings.valueField]=input,data},create=once(function(data){if(self.unlock(),!data||"object"!=typeof data)return callback();var value=hash_key(data[self.settings.valueField]);return"string"!=typeof value?callback():(self.setTextboxValue(""),self.addOption(data),self.setCaret(caret),self.addItem(value),self.refreshOptions(triggerDropdown&&"single"!==self.settings.mode),callback(data),void 0)
}),output=setup.apply(this,[input,create]);return"undefined"!=typeof output&&create(output),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var invalid=!this.items.length;this.isInvalid=invalid,this.$control_input.prop("required",invalid),this.$input.prop("required",!invalid)},refreshClasses:function(){var self=this,isFull=self.isFull(),isLocked=self.isLocked;self.$wrapper.toggleClass("rtl",self.rtl),self.$control.toggleClass("focus",self.isFocused).toggleClass("disabled",self.isDisabled).toggleClass("required",self.isRequired).toggleClass("invalid",self.isInvalid).toggleClass("locked",isLocked).toggleClass("full",isFull).toggleClass("not-full",!isFull).toggleClass("input-active",self.isFocused&&!self.isInputHidden).toggleClass("dropdown-active",self.isOpen).toggleClass("has-options",!$.isEmptyObject(self.options)).toggleClass("has-items",self.items.length>0),self.$control_input.data("grow",!isFull&&!isLocked)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(opts){var i,n,options,label,self=this;if(opts=opts||{},self.tagType===TAG_SELECT){for(options=[],i=0,n=self.items.length;n>i;i++)label=self.options[self.items[i]][self.settings.labelField]||"",options.push('<option value="'+escape_html(self.items[i])+'" selected="selected">'+escape_html(label)+"</option>");options.length||this.$input.attr("multiple")||options.push('<option value="" selected="selected"></option>'),self.$input.html(options.join(""))}else self.$input.val(self.getValue()),self.$input.attr("value",self.$input.val());self.isSetup&&(opts.silent||self.trigger("change",self.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var $input=this.$control_input;this.items.length?$input.removeAttr("placeholder"):$input.attr("placeholder",this.settings.placeholder),$input.triggerHandler("update",{force:!0})}},open:function(){var self=this;self.isLocked||self.isOpen||"multi"===self.settings.mode&&self.isFull()||(self.focus(),self.isOpen=!0,self.refreshState(),self.$dropdown.css({visibility:"hidden",display:"block"}),self.positionDropdown(),self.$dropdown.css({visibility:"visible"}),self.trigger("dropdown_open",self.$dropdown))},close:function(){var self=this,trigger=self.isOpen;"single"===self.settings.mode&&self.items.length&&(self.hideInput(),self.$control_input.blur()),self.isOpen=!1,self.$dropdown.hide(),self.setActiveOption(null),self.refreshState(),trigger&&self.trigger("dropdown_close",self.$dropdown)},positionDropdown:function(){var $control=this.$control,offset="body"===this.settings.dropdownParent?$control.offset():$control.position();offset.top+=$control.outerHeight(!0),this.$dropdown.css({width:$control.outerWidth(),top:offset.top,left:offset.left})},clear:function(silent){var self=this;self.items.length&&(self.$control.children(":not(input)").remove(),self.items=[],self.lastQuery=null,self.setCaret(0),self.setActiveItem(null),self.updatePlaceholder(),self.updateOriginalInput({silent:silent}),self.refreshState(),self.showInput(),self.trigger("clear"))},insertAtCaret:function($el){var caret=Math.min(this.caretPos,this.items.length);0===caret?this.$control.prepend($el):$(this.$control[0].childNodes[caret]).before($el),this.setCaret(caret+1)},deleteSelection:function(e){var i,n,direction,selection,values,caret,option_select,$option_select,$tail,self=this;if(direction=e&&e.keyCode===KEY_BACKSPACE?-1:1,selection=getSelection(self.$control_input[0]),self.$activeOption&&!self.settings.hideSelected&&(option_select=self.getAdjacentOption(self.$activeOption,-1).attr("data-value")),values=[],self.$activeItems.length){for($tail=self.$control.children(".active:"+(direction>0?"last":"first")),caret=self.$control.children(":not(input)").index($tail),direction>0&&caret++,i=0,n=self.$activeItems.length;n>i;i++)values.push($(self.$activeItems[i]).attr("data-value"));e&&(e.preventDefault(),e.stopPropagation())}else(self.isFocused||"single"===self.settings.mode)&&self.items.length&&(0>direction&&0===selection.start&&0===selection.length?values.push(self.items[self.caretPos-1]):direction>0&&selection.start===self.$control_input.val().length&&values.push(self.items[self.caretPos]));if(!values.length||"function"==typeof self.settings.onDelete&&self.settings.onDelete.apply(self,[values])===!1)return!1;for("undefined"!=typeof caret&&self.setCaret(caret);values.length;)self.removeItem(values.pop());return self.showInput(),self.positionDropdown(),self.refreshOptions(!0),option_select&&($option_select=self.getOption(option_select),$option_select.length&&self.setActiveOption($option_select)),!0},advanceSelection:function(direction,e){var tail,selection,idx,valueLength,cursorAtEdge,$tail,self=this;0!==direction&&(self.rtl&&(direction*=-1),tail=direction>0?"last":"first",selection=getSelection(self.$control_input[0]),self.isFocused&&!self.isInputHidden?(valueLength=self.$control_input.val().length,cursorAtEdge=0>direction?0===selection.start&&0===selection.length:selection.start===valueLength,cursorAtEdge&&!valueLength&&self.advanceCaret(direction,e)):($tail=self.$control.children(".active:"+tail),$tail.length&&(idx=self.$control.children(":not(input)").index($tail),self.setActiveItem(null),self.setCaret(direction>0?idx+1:idx))))},advanceCaret:function(direction,e){var fn,$adj,self=this;0!==direction&&(fn=direction>0?"next":"prev",self.isShiftDown?($adj=self.$control_input[fn](),$adj.length&&(self.hideInput(),self.setActiveItem($adj),e&&e.preventDefault())):self.setCaret(self.caretPos+direction))},setCaret:function(i){var self=this;if(i="single"===self.settings.mode?self.items.length:Math.max(0,Math.min(self.items.length,i)),!self.isPending){var j,n,$children,$child;for($children=self.$control.children(":not(input)"),j=0,n=$children.length;n>j;j++)$child=$($children[j]).detach(),i>j?self.$control_input.before($child):self.$control.append($child)}self.caretPos=i},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var self=this;self.$input.prop("disabled",!0),self.$control_input.prop("disabled",!0).prop("tabindex",-1),self.isDisabled=!0,self.lock()},enable:function(){var self=this;self.$input.prop("disabled",!1),self.$control_input.prop("disabled",!1).prop("tabindex",self.tabIndex),self.isDisabled=!1,self.unlock()},destroy:function(){var self=this,eventNS=self.eventNS,revertSettings=self.revertSettings;self.trigger("destroy"),self.off(),self.$wrapper.remove(),self.$dropdown.remove(),self.$input.html("").append(revertSettings.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:revertSettings.tabindex}).show(),self.$control_input.removeData("grow"),self.$input.removeData("selectize"),$(window).off(eventNS),$(document).off(eventNS),$(document.body).off(eventNS),delete self.$input[0].selectize},render:function(templateName,data){var value,id,html="",cache=!1,self=this;return("option"===templateName||"item"===templateName)&&(value=hash_key(data[self.settings.valueField]),cache=!!value),cache&&(isset(self.renderCache[templateName])||(self.renderCache[templateName]={}),self.renderCache[templateName].hasOwnProperty(value))?self.renderCache[templateName][value]:(html=$(self.settings.render[templateName].apply(this,[data,escape_html])),"option"===templateName||"option_create"===templateName?html.attr("data-selectable",""):"optgroup"===templateName&&(id=data[self.settings.optgroupValueField]||"",html.attr("data-group",id)),("option"===templateName||"item"===templateName)&&html.attr("data-value",value||""),cache&&(self.renderCache[templateName][value]=html[0]),html[0])},clearCache:function(templateName){var self=this;"undefined"==typeof templateName?self.renderCache={}:delete self.renderCache[templateName]},canCreate:function(input){var self=this;if(!self.settings.create)return!1;var filter=self.settings.createFilter;return!(!input.length||"function"==typeof filter&&!filter.apply(self,[input])||"string"==typeof filter&&!new RegExp(filter).test(input)||filter instanceof RegExp&&!filter.test(input))}}),Selectize.count=0,Selectize.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},$.fn.selectize=function(settings_user){var defaults=$.fn.selectize.defaults,settings=$.extend({},defaults,settings_user),attr_data=settings.dataAttr,field_label=settings.labelField,field_value=settings.valueField,field_optgroup=settings.optgroupField,field_optgroup_label=settings.optgroupLabelField,field_optgroup_value=settings.optgroupValueField,init_textbox=function($input,settings_element){var i,n,values,option,data_raw=$input.attr(attr_data);if(data_raw)for(settings_element.options=JSON.parse(data_raw),i=0,n=settings_element.options.length;n>i;i++)settings_element.items.push(settings_element.options[i][field_value]);else{var value=$.trim($input.val()||"");if(!settings.allowEmptyOption&&!value.length)return;for(values=value.split(settings.delimiter),i=0,n=values.length;n>i;i++)option={},option[field_label]=values[i],option[field_value]=values[i],settings_element.options.push(option);settings_element.items=values}},init_select=function($input,settings_element){var i,n,tagName,$children,options=settings_element.options,optionsMap={},readData=function($el){var data=attr_data&&$el.attr(attr_data);return"string"==typeof data&&data.length?JSON.parse(data):null},addOption=function($option,group){$option=$($option);var value=hash_key($option.val());if(value||settings.allowEmptyOption)if(optionsMap.hasOwnProperty(value)){if(group){var arr=optionsMap[value][field_optgroup];arr?$.isArray(arr)?arr.push(group):optionsMap[value][field_optgroup]=[arr,group]:optionsMap[value][field_optgroup]=group}}else{var option=readData($option)||{};option[field_label]=option[field_label]||$option.text(),option[field_value]=option[field_value]||value,option[field_optgroup]=option[field_optgroup]||group,optionsMap[value]=option,options.push(option),$option.is(":selected")&&settings_element.items.push(value)}},addGroup=function($optgroup){var i,n,id,optgroup,$options;for($optgroup=$($optgroup),id=$optgroup.attr("label"),id&&(optgroup=readData($optgroup)||{},optgroup[field_optgroup_label]=id,optgroup[field_optgroup_value]=id,settings_element.optgroups.push(optgroup)),$options=$("option",$optgroup),i=0,n=$options.length;n>i;i++)addOption($options[i],id)};for(settings_element.maxItems=$input.attr("multiple")?null:1,$children=$input.children(),i=0,n=$children.length;n>i;i++)tagName=$children[i].tagName.toLowerCase(),"optgroup"===tagName?addGroup($children[i]):"option"===tagName&&addOption($children[i])};return this.each(function(){if(!this.selectize){var instance,$input=$(this),tag_name=this.tagName.toLowerCase(),placeholder=$input.attr("placeholder")||$input.attr("data-placeholder");placeholder||settings.allowEmptyOption||(placeholder=$input.children('option[value=""]').text());var settings_element={placeholder:placeholder,options:[],optgroups:[],items:[]};"select"===tag_name?init_select($input,settings_element):init_textbox($input,settings_element),instance=new Selectize($input,$.extend(!0,{},defaults,settings_element,settings_user))}})},$.fn.selectize.defaults=Selectize.defaults,$.fn.selectize.support={validity:SUPPORTS_VALIDITY_API},Selectize.define("drag_drop",function(){if(!$.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var self=this;self.lock=function(){var original=self.lock;return function(){var sortable=self.$control.data("sortable");return sortable&&sortable.disable(),original.apply(self,arguments)}}(),self.unlock=function(){var original=self.unlock;return function(){var sortable=self.$control.data("sortable");return sortable&&sortable.enable(),original.apply(self,arguments)}}(),self.setup=function(){var original=self.setup;return function(){original.apply(this,arguments);var $control=self.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:self.isLocked,start:function(e,ui){ui.placeholder.css("width",ui.helper.css("width")),$control.css({overflow:"visible"})},stop:function(){$control.css({overflow:"hidden"});var active=self.$activeItems?self.$activeItems.slice():null,values=[];$control.children("[data-value]").each(function(){values.push($(this).attr("data-value"))}),self.setValue(values),self.setActiveItem(active)}})}}()}}),Selectize.define("dropdown_header",function(options){var self=this;options=$.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(data){return'<div class="'+data.headerClass+'">'+'<div class="'+data.titleRowClass+'">'+'<span class="'+data.labelClass+'">'+data.title+"</span>"+'<a href="javascript:void(0)" class="'+data.closeClass+'">&times;</a>'+"</div>"+"</div>"}},options),self.setup=function(){var original=self.setup;return function(){original.apply(self,arguments),self.$dropdown_header=$(options.html(options)),self.$dropdown.prepend(self.$dropdown_header)}}()}),Selectize.define("optgroup_columns",function(options){var self=this;options=$.extend({equalizeWidth:!0,equalizeHeight:!0},options),this.getAdjacentOption=function($option,direction){var $options=$option.closest("[data-group]").find("[data-selectable]"),index=$options.index($option)+direction;return index>=0&&index<$options.length?$options.eq(index):$()},this.onKeyDown=function(){var original=self.onKeyDown;return function(e){var index,$option,$options,$optgroup;return!this.isOpen||e.keyCode!==KEY_LEFT&&e.keyCode!==KEY_RIGHT?original.apply(this,arguments):(self.ignoreHover=!0,$optgroup=this.$activeOption.closest("[data-group]"),index=$optgroup.find("[data-selectable]").index(this.$activeOption),$optgroup=e.keyCode===KEY_LEFT?$optgroup.prev("[data-group]"):$optgroup.next("[data-group]"),$options=$optgroup.find("[data-selectable]"),$option=$options.eq(Math.min($options.length-1,index)),$option.length&&this.setActiveOption($option),void 0)}}();var getScrollbarWidth=function(){var div,width=getScrollbarWidth.width,doc=document;return"undefined"==typeof width&&(div=doc.createElement("div"),div.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',div=div.firstChild,doc.body.appendChild(div),width=getScrollbarWidth.width=div.offsetWidth-div.clientWidth,doc.body.removeChild(div)),width},equalizeSizes=function(){var i,n,height_max,width,width_last,width_parent,$optgroups;if($optgroups=$("[data-group]",self.$dropdown_content),n=$optgroups.length,n&&self.$dropdown_content.width()){if(options.equalizeHeight){for(height_max=0,i=0;n>i;i++)height_max=Math.max(height_max,$optgroups.eq(i).height());$optgroups.css({height:height_max})}options.equalizeWidth&&(width_parent=self.$dropdown_content.innerWidth()-getScrollbarWidth(),width=Math.round(width_parent/n),$optgroups.css({width:width}),n>1&&(width_last=width_parent-width*(n-1),$optgroups.eq(n-1).css({width:width_last})))}};(options.equalizeHeight||options.equalizeWidth)&&(hook.after(this,"positionDropdown",equalizeSizes),hook.after(this,"refreshOptions",equalizeSizes))}),Selectize.define("remove_button",function(options){options=$.extend({label:"&times;",title:"Remove",className:"remove",append:!0},options);var singleClose=function(thisRef,options){options.className="remove-single";var self=thisRef,html='<a href="javascript:void(0)" class="'+options.className+'" tabindex="-1" title="'+escape_html(options.title)+'">'+options.label+"</a>",append=function(html_container,html_element){return html_container+html_element};thisRef.setup=function(){var original=self.setup;return function(){if(options.append){var id=$(self.$input.context).attr("id");$("#"+id);var render_item=self.settings.render.item;self.settings.render.item=function(){return append(render_item.apply(thisRef,arguments),html)}}original.apply(thisRef,arguments),thisRef.$control.on("click","."+options.className,function(e){e.preventDefault(),self.isLocked||self.clear()})}}()},multiClose=function(thisRef,options){var self=thisRef,html='<a href="javascript:void(0)" class="'+options.className+'" tabindex="-1" title="'+escape_html(options.title)+'">'+options.label+"</a>",append=function(html_container,html_element){var pos=html_container.search(/(<\/[^>]+>\s*)$/);return html_container.substring(0,pos)+html_element+html_container.substring(pos)};thisRef.setup=function(){var original=self.setup;return function(){if(options.append){var render_item=self.settings.render.item;self.settings.render.item=function(){return append(render_item.apply(thisRef,arguments),html)}}original.apply(thisRef,arguments),thisRef.$control.on("click","."+options.className,function(e){if(e.preventDefault(),!self.isLocked){var $item=$(e.currentTarget).parent();self.setActiveItem($item),self.deleteSelection()&&self.setCaret(self.items.length)}})}}()};return"single"===this.settings.mode?(singleClose(this,options),void 0):(multiClose(this,options),void 0)}),Selectize.define("restore_on_backspace",function(options){var self=this;options.text=options.text||function(option){return option[this.settings.labelField]},this.onKeyDown=function(){var original=self.onKeyDown;return function(e){var index,option;return e.keyCode===KEY_BACKSPACE&&""===this.$control_input.val()&&!this.$activeItems.length&&(index=this.caretPos-1,index>=0&&index<this.items.length)?(option=this.options[this.items[index]],this.deleteSelection(e)&&(this.setTextboxValue(options.text.apply(this,[option])),this.refreshOptions(!0)),e.preventDefault(),void 0):original.apply(this,arguments)}}()}),Selectize}),/*
 *  Sugar Library vedge
 *
 *  Freely distributable and licensed under the MIT-style license.
 *  Copyright (c) 2013 Andrew Plummer
 *  http://sugarjs.com/
 *
 * ---------------------------- */
function(){function aa(a){return function(){return a}}function fa(a){var b,c;return/String|Number|Boolean/.test(a)&&(b=a.toLowerCase()),c="Array"===a&&q.isArray||function(d){return b&&typeof d===b?k:ba.call(d)==="[object "+a+"]"},da[a]=c}function ja(a){a.SugarMethods||(ka(a,"SugarMethods",{}),D(a,n,n,{extend:function(b,c,d){D(a,d!==n,c,b)},sugarRestore:function(){return la(a,arguments,function(b,c,d){ka(b,c,d.method)})},sugarRevert:function(){return la(a,arguments,function(b,c,d){d.qa?ka(b,c,d.Ba):delete b[c]})}}))}function D(a,b,c,d){var e=b?a.prototype:a;ja(a),E(d,function(f,h){var i=e[f],j=F(e,f);"function"==typeof c&&(h=ma(e[f],h,c)),c===n&&e[f]||ka(e,f,h),a.SugarMethods[f]={xa:b,method:h,Ba:i,qa:j}})}function G(a,b,c,d,e){var f={};d=B(d)?d.split(","):d,d.forEach(function(h,i){e(f,h,i)}),D(a,b,c,f)}function la(a,b,c){var d=0===b.length,e=H(b),f=n;return E(a.SugarMethods,function(h,i){(d||e.indexOf(h)>-1)&&(f=k,c(i.xa?a.prototype:a,h,i))}),f}function ma(a,b,c){return function(){return(!a||c!==k&&c.apply(this,arguments)?b:a).apply(this,arguments)}}function ka(a,b,c){ea?p.defineProperty(a,b,{value:c,configurable:k,enumerable:n,writable:k}):a[b]=c}function H(a,b){var d,e,c=[];for(d=0,e=a.length;e>d;d++)c.push(a[d]),b&&b.call(a,a[d],d);return c}function na(a,b,c){H(q.prototype.concat.apply([],q.prototype.slice.call(a,c||0)),b)}function oa(a){if(!a||!a.call)throw new TypeError("Callback is not callable")}function I(a){return void 0!==a}function K(a){return void 0===a}function pa(a){return a&&"object"==typeof a}function L(a){return!!a&&"[object Object]"===ba.call(a)&&"hasOwnProperty"in a}function F(a,b){return p.hasOwnProperty.call(a,b)}function E(a,b){for(var c in a)if(F(a,c)&&b.call(a,c,a[c],a)===n)break}function qa(a,b){return E(b,function(c){a[c]=b[c]}),a}function ra(a){qa(this,a)}function sa(a,b,c,d){var e=[];a=parseInt(a);for(var f=0>d;!f&&b>=a||f&&a>=b;)e.push(a),c&&c.call(this,a),a+=d||1;return e}function N(a,b,c){c=v[c||"round"];var d=v.pow(10,v.abs(b||0));return 0>b&&(d=1/d),c(a*d)/d}function O(a,b){return N(a,b,"floor")}function P(a,b,c,d){return d=v.abs(a).toString(d||10),d=ta(b-d.replace(/\.\d+/,"").length,"0")+d,(c||0>a)&&(d=(0>a?"-":"+")+d),d}function ua(a){if(a>=11&&13>=a)return"th";switch(a%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}function va(){return"	\n\f\r   ᠎             \u2028\u2029　﻿"}function ta(a,b){return q(v.max(0,I(a)?a:1)+1).join(b||"")}function wa(a,b){var c=a.toString().match(/[^\/]*$/)[0];return b&&(c=(c+b).split("").sort().join("").replace(/([gimy])\1+/g,"$1")),c}function R(a){return B(a)||(a=t(a)),a.replace(/([\\\/'*+?|()\[\]{}.^$])/g,"\\$1")}function xa(a,b){var d,e,f,h,i,j,g,c=typeof a;if("string"===c)return a;if(f=ba.call(a),d=L(a),e="[object Array]"===f,a!=l&&d||e){if(b||(b=[]),b.length>1)for(j=b.length;j--;)if(b[j]===a)return"CYC";for(b.push(a),d=t(a.constructor),h=e?a:p.keys(a).sort(),j=0,g=h.length;g>j;j++)i=e?j:h[j],d+=i+xa(a[i],b);b.pop()}else d=1/a===-1/0?"-0":t(a&&a.valueOf?a.valueOf():a);return c+f+d}function ya(a){return/^\[object Date|Array|String|Number|RegExp|Boolean|Arguments\]$/.test(ba.call(a))||L(a)}function za(a,b,c){var h,d=[],e=a.length,f=b[b.length-1]!==n;return H(b,function(i){return ha(i)?n:(f&&(i%=e,0>i&&(i=e+i)),h=c?a.charAt(i)||"":a[i],d.push(h),void 0)}),d.length<2?d[0]:d}function Aa(a,b){G(b,k,n,a,function(c,d){c[d+("equal"===d?"s":"")]=function(){return p[d].apply(l,[this].concat(H(arguments)))}})}function Ba(a,b,c,d){var e=a.length,f=-1==d,h=f?e-1:0;for(c=isNaN(c)?h:parseInt(c>>0),0>c&&(c=e+c),(!f&&0>c||f&&c>=e)&&(c=h);f&&c>=0||!f&&e>c;){if(a[c]===b)return c;c+=d}return-1}function Ca(a,b,c,d){var e=a.length,f=0,h=I(c);if(oa(b),0==e&&!h)throw new TypeError("Reduce called on empty array with no initial value");for(h?c=c:(c=a[d?e-1:f],f++);e>f;)h=d?e-f-1:f,h in a&&(c=b(c,a[h],h,a)),f++;return c}function Da(a){if(0===a.length)throw new TypeError("First argument must be defined")}function Ea(a,b,c,d){var e=k;return a===b?k:C(b)&&B(a)?r(b).test(a):y(b)?b.apply(c,d):L(b)&&pa(a)?(E(b,function(f){Ea(a[f],b[f],c,[a[f],a])||(e=n)}),e):ya(a)&&ya(b)?xa(a)===xa(b):a===b}function S(a,b,c,d){return K(b)?a:y(b)?b.apply(c,d||[]):y(a[b])?a[b].call(a):a[b]}function T(a,b,c,d){var e,f;for(0>c&&(c=a.length+c),f=isNaN(c)?0:c,c=d===k?a.length+f:a.length;c>f;){if(e=f%a.length,!(e in a))return Ga(a,b,f,d);if(b.call(a,a[e],e,a)===n)break;f++}}function Ga(a,b,c){var e,d=[];for(e in a)e in a&&e>>>0==e&&4294967295!=e&&e>=c&&d.push(parseInt(e));return d.sort().each(function(f){return b.call(a,a[f],f,a)}),a}function Ha(a,b,c,d,e){var f,h;return T(a,function(i,j,g){return Ea(i,b,g,[i,j,g])?(f=i,h=j,n):void 0},c,d),e?h:f}function Ia(a,b){var e,c=[],d={};return T(a,function(f,h){e=b?S(f,b,a,[f,h,a]):f,Ja(d,e)||c.push(f)}),c}function Ka(a,b,c){var d=[],e={};return b.each(function(f){Ja(e,f)}),a.each(function(f){var h=xa(f),i=!ya(f);if(La(e,h,f,i)!=c){var j=0;if(i)for(h=e[h];j<h.length;)h[j]===f?h.splice(j,1):j+=1;else delete e[h];d.push(f)}}),d}function Ma(a,b,c){b=b||1/0,c=c||0;var d=[];return T(a,function(e){ga(e)&&b>c?d=d.concat(Ma(e,b,c+1)):d.push(e)}),d}function Na(a){var b=[];return H(a,function(c){b=b.concat(c)}),b}function La(a,b,c,d){var e=b in a;return d&&(a[b]||(a[b]=[]),e=-1!==a[b].indexOf(c)),e}function Ja(a,b){var c=xa(b),d=!ya(b),e=La(a,c,b,d);return d?a[c].push(b):a[c]=b,e}function Oa(a,b,c,d){var e,f=[],h="max"===c,i="min"===c,j=Array.isArray(a);return E(a,function(g){var m=a[g];if(g=S(m,b,a,j?[m,parseInt(g),a]:[]),K(g))throw new TypeError("Cannot compare with undefined");g===e?f.push(m):(K(e)||h&&g>e||i&&e>g)&&(f=[m],e=g)}),j||(f=Ma(f,1)),d?f:f[0]}function Pa(a){return q[Qa]&&(a=a.toLowerCase()),a.replace(q[Ra],"")}function Sa(a,b){var c=a.charAt(b);return(q[Ta]||{})[c]||c}function Ua(a){var b=q[Va];return a?b.indexOf(a):l}function Wa(a){return a&&a.valueOf&&(a=a.valueOf()),p.keys(a)}function Xa(a,b){G(p,n,n,a,function(c,d){c[d]=function(e,f,h){var i=Wa(e);return h=q.prototype[d].call(i,function(j){return b?S(e[j],f,e,[j,e[j],e]):Ea(e[j],f,e,[j,e[j],e])},h),ga(h)&&(h=h.reduce(function(j,g){return j[g]=e[g],j},{})),h}}),Aa(a,ra)}function mb(a){qa(this,a),this.ga=ib.concat()}function sb(a,b){var c;if(B(a)||(a=""),c=lb[a]||lb[a.slice(0,2)],b===n&&!c)throw Error("Invalid locale.");return c||bb}function tb(a,b){function c(g){var m=i[g];B(m)?i[g]=m.split(","):m||(i[g]=[])}function d(g,m){return g=g.split("+").map(function(o){return o.replace(/(.+):(.+)$/,function(w,z,J){return J.split("|").map(function(M){return z+M}).join("|")})}).join("|"),g.split("|").forEach(m)}function e(g,m,o){var w=[];i[g].forEach(function(z,J){m&&(z+="+"+z.slice(0,3)),d(z,function(M,Q){w[Q*o+J]=M.toLowerCase()})}),i[g]=w}function f(g,m,o){return g="\\d{"+g+","+m+"}",o&&(g+="|(?:"+pb(i.numbers)+")+"),g}function h(g,m){i[g]=i[g]||m}var i,j;return i=new mb(b),c("modifiers"),"months,weekdays,units,numbers,articles,tokens,timeMarker,ampm,timeSuffixes,dateParse,timeParse".split(",").forEach(c),j=!i.monthSuffix,e("months",j,12),e("weekdays",j,7),e("units",n,8),e("numbers",n,10),h("code",a),h("date",f(1,2,i.digitDate)),h("year","'\\d{2}|"+f(4,4)),h("num",function(){var g=["\\d+"].concat(i.articles);return i.numbers&&(g=g.concat(i.numbers)),pb(g)}()),function(){var g=[];i.ha={},i.modifiers.push({name:"day",src:"yesterday",value:-1}),i.modifiers.push({name:"day",src:"today",value:0}),i.modifiers.push({name:"day",src:"tomorrow",value:1}),i.modifiers.forEach(function(m){var o=m.name;d(m.src,function(w){var z=i[o];i.ha[w]=m,g.push({name:o,src:w,value:m.value}),i[o]=z?z+"|"+w:w})}),i.day+="|"+pb(i.weekdays),i.modifiers=g}(),i.monthSuffix&&(i.month=f(1,2),i.months=sa(1,12).map(function(g){return g+i.monthSuffix})),i.full_month=f(1,2)+"|"+pb(i.months),i.timeSuffixes.length>0&&i.addFormat(qb(db,i),n,cb),i.addFormat("{day}",k),i.addFormat("{month}"+(i.monthSuffix||"")),i.addFormat("{year}"+(i.yearSuffix||"")),i.timeParse.forEach(function(g){i.addFormat(g,k)}),i.dateParse.forEach(function(g){i.addFormat(g)}),lb[a]=i}function rb(a,b,c,d){a.ga.unshift({Da:d,ya:a,Ca:r("^"+b+"$","i"),to:c})}function ob(a){return a.slice(0,1).toUpperCase()+a.slice(1)}function pb(a){return a.filter(function(b){return!!b}).join("|")}function ub(a,b){var c;return L(a[0])?a:A(a[0])&&!A(a[1])?[a[0]]:B(a[0])&&b?[vb(a[0]),a[1]]:(c={},gb.forEach(function(d,e){c[d.$]=a[e]}),[c])}function vb(a,b){var c={};return(match=a.match(/^(\d+)?\s?(\w+?)s?$/i))&&(K(b)&&(b=parseInt(match[1])||1),c[match[2].toLowerCase()]=b),c}function wb(a,b){var d,e,c={};return b.forEach(function(f,h){d=a[h+1],K(d)||""===d||("year"===f&&(c.Ea=d.replace(/'/,"")),e=parseFloat(d.replace(/'/,"").replace(/,/,".")),c[f]=isNaN(e)?d.toLowerCase():e)}),c}function xb(a){return a=a.trim().replace(/^just (?=now)|\.+$/i,""),yb(a)}function yb(a){return a.replace(fb,function(b,c,d){var h,i,e=0,f=1;return c?b:(d.split("").reverse().forEach(function(j){j=eb[j];var g=j>9;g?(h&&(e+=f),f*=j/(i||1),i=j):(h===n&&(f*=10),e+=f*j),h=g}),h&&(e+=f),e)})}function zb(a,b,c,d){var h,i,j,g,m,o,w,z,J,e=new s,f=n;return e.utc(d),ia(a)?e.utc(a.isUTC()).setTime(a.getTime()):A(a)?e.setTime(a):L(a)?(e.set(a,k),g=a):B(a)&&(h=sb(b),a=xb(a),h&&E(h.ta(),function(M,Q){var Fa=a.match(Q.Ca);return Fa?(j=Q,i=j.ya,g=wb(Fa,j.to,i),g.utc&&e.utc(),i.ma=j,g.timestamp?(g=g.timestamp,n):(j.Da&&!B(g.month)&&(B(g.date)||h.wa(b))&&(z=g.month,g.month=g.date,g.date=z),g.year&&2===g.Ea.length&&(g.year=100*N(V(new s,"FullYear")/100)-100*N(g.year/100)+g.year),g.month&&(g.month=i.getMonth(g.month),g.shift&&!g.unit&&(g.unit=i.units[7])),g.weekday&&g.date?delete g.weekday:g.weekday&&(g.weekday=i.getWeekday(g.weekday),g.shift&&!g.unit&&(g.unit=i.units[5])),g.day&&(z=i.ha[g.day])?(g.day=z.value,e.reset(),f=k):g.day&&(o=i.getWeekday(g.day))>-1&&(delete g.day,g.num&&g.month?(J=function(){var W=e.getWeekday();e.setWeekday(7*(g.num-1)+(W>o?o+7:o))},g.day=1):g.weekday=o),g.date&&!A(g.date)&&(g.date=i.ua(g.date)),i.Aa(g.ampm)&&g.hour<12?g.hour+=12:i.za(g.ampm)&&12===g.hour&&(g.hour=0),("offset_hours"in g||"offset_minutes"in g)&&(e.utc(),g.offset_minutes=g.offset_minutes||0,g.offset_minutes+=60*g.offset_hours,"-"===g.offset_sign&&(g.offset_minutes*=-1),g.minute-=g.offset_minutes),g.unit&&(f=k,w=i.oa(g.num),m=i.sa(g.unit),(g.shift||g.edge)&&(w*=(z=i.ha[g.shift])?z.value:0,"month"===m&&I(g.date)&&(e.set({day:g.date},k),delete g.date),"year"===m&&I(g.month)&&(e.set({month:g.month,day:g.date},k),delete g.month,delete g.date)),g.sign&&(z=i.ha[g.sign])&&(w*=z.value),I(g.weekday)&&(e.set({weekday:g.weekday},k),delete g.weekday),g[m]=(g[m]||0)+w),"-"===g.year_sign&&(g.year*=-1),hb.slice(1,4).forEach(function(W,fc){var Gb=g[W.$],Hb=Gb%1;Hb&&(g[hb[fc].$]=N(Hb*("second"===W.$?1e3:60)),g[W.$]=O(Gb))}),n)):void 0}),j?f?e.advance(g):(e._utc&&e.reset(),Ab(e,g,k,n,c)):("now"!==a&&(e=new s(a)),d&&e.addMinutes(-e.getTimezoneOffset())),g&&g.edge&&(z=i.ha[g.edge],E(hb.slice(4),function(M,Q){return I(g[Q.$])?(m=Q.$,n):void 0}),"year"===m?g.fa="month":("month"===m||"week"===m)&&(g.fa="day"),e[(z.value<0?"endOf":"beginningOf")+ob(m)](),-2===z.value&&e.reset()),J&&J(),e.utc(n)),{ea:e,set:g}}function nb(a){var b,c=v.abs(a),d=c,e=0;return hb.slice(1).forEach(function(f,h){b=O(N(10*(c/f.da()))/10),b>=1&&(d=b,e=h+1)}),[d,e,a]}function Bb(a){var b=nb(a.millisecondsFromNow());return 6===b[1]&&(b[0]=v.abs(a.monthsFromNow())),b}function Cb(a,b,c,d){var e,f=sb(d),h=r(/^[A-Z]/);return a.isValid()?(Date[b]?b=Date[b]:y(b)&&(e=Bb(a),b=b.apply(a,e.concat(f))),!b&&c?(e=e||Bb(a),0===e[1]&&(e[1]=1,e[0]=1),f.va(e)):(b=b||"long",b=f[b]||b,jb.forEach(function(i){b=b.replace(r("\\{("+i.ba+")(\\d)?\\}",i.la?"i":""),function(j,g,m){j=i.format(a,f,m||1,g),m=g.length;var o=g.match(/^(.)\1+$/);return i.la?(3===m&&(j=j.slice(0,3)),(o||g.match(h))&&(j=ob(j))):o&&!i.text&&(j=(A(j)?P(j,m):j.toString()).slice(-m)),j})}),b)):"Invalid Date"}function Db(a,b,c,d){var e,f,h,i=0,j=0,g=0;return e=zb(b,l,l,d),c>0&&(j=g=c,f=k),e.ea.isValid()?(e.set&&e.set.fa&&(kb.forEach(function(m){m.$===e.set.fa&&(i=m.da(e.ea,a-e.ea)-1)}),b=ob(e.set.fa),(e.set.edge||e.set.shift)&&e.ea["beginningOf"+b](),"month"===e.set.fa&&(h=e.ea.clone()["endOf"+b]().getTime()),!f&&e.set.sign&&"millisecond"!=e.set.fa&&(j=50,g=-50)),f=a.getTime(),b=e.ea.getTime(),h=h||b+i,h=Eb(a,b,h),f>=b-j&&h+g>=f):n}function Eb(a,b,c){return b=new Date(b),a=new Date(c).utc(a.isUTC()),23!==V(a,"Hours")&&(b=b.getTimezoneOffset(),a=a.getTimezoneOffset(),b!==a&&(c+=(a-b).minutes())),c}function Ab(a,b,c,d,e){function f(g){return I(b[g])?b[g]:b[g+"s"]}function h(g){return I(f(g))}var i,j;if(A(b)&&d)b={milliseconds:b};else if(A(b))return a.setTime(b),a;return I(b.date)&&(b.day=b.date),E(hb,function(g,m){var o="day"===m.$;return h(m.$)||o&&h("weekday")?(b.fa=m.$,j=+g,n):(!c||"week"===m.$||o&&h("week")||Fb(a,m.method,o?1:0),void 0)}),kb.forEach(function(g){var m=g.$;g=g.method;var o;o=f(m),K(o)||(d?("week"===m&&(o=(b.day||0)+7*o,g="Date"),o=o*d+V(a,g)):"month"===m&&h("day")&&Fb(a,"Date",15),Fb(a,g,o),d&&"month"===m&&(m=o,0>m&&(m=m%12+12),m%12!=V(a,"Month")&&Fb(a,"Date",0)))}),d||h("day")||!h("weekday")||(i=f("weekday"),a.setWeekday(i)),function(){var g=new s;return-1===e&&a>g||1===e&&g>a}()&&E(hb.slice(j+1),function(g,m){return!(m.ja||"week"===m.$&&h("weekday"))||h(m.$)||"day"===m.$&&h("weekday")?void 0:(a[m.ia](e),n)}),a}function V(a,b){return a["get"+(a._utc?"UTC":"")+b]()}function Fb(a,b,c){return a["set"+(a._utc&&"ISOWeek"!=b?"UTC":"")+b](c)}function qb(a,b,c){var e,d={h:0,m:1,s:2};return b=b||U,a.replace(/{([a-z])}/g,function(f,h){var i=[],j="h"===h,g=j&&!c;return"t"===h?b.ampm.join("|"):(j&&i.push(":"),(e=b.timeSuffixes[d[h]])&&i.push(e+"\\s*"),0===i.length?"":"(?:"+i.join("|")+")"+(g?"":"?"))})}function X(a,b,c){var d,e;return A(a[1])?d=ub(a)[0]:(d=a[0],e=a[1]),zb(d,e,b,c).ea}function Ib(a,b){function c(){return N(this*b)}function d(){return X(arguments)[a.ia](this)}function e(){return X(arguments)[a.ia](-this)}var f=a.$,h={};h[f]=c,h[f+"s"]=c,h[f+"Before"]=e,h[f+"sBefore"]=e,h[f+"Ago"]=e,h[f+"sAgo"]=e,h[f+"After"]=d,h[f+"sAfter"]=d,h[f+"FromNow"]=d,h[f+"sFromNow"]=d,u.extend(h)}function Jb(a,b,c,d,e){var f;1/0!==b&&(a.timers||(a.timers=[]),A(b)||(b=0),a.timers.push(setTimeout(function(){a.timers.splice(f,1),c.apply(d,e||[])},b)),f=a.timers.length)}function Kb(a,b,c,d,e,f){var h=a.toFixed(20),i=h.search(/\./);return h=h.search(/[1-9]/),i-=h,i>0&&(i-=1),e=v.max(v.min((i/3).floor(),e===n?c.length:e),-d),d=c.charAt(e+d-1),-9>i&&(e=-3,b=i.abs()-9,d=c.slice(0,1)),(a/(f?2..pow(10*e):10..pow(3*e))).round(b||0).format()+d.trim()}function Nb(a,b,c,d){var f,h,i,e=/^(.+?)(\[.*\])$/;d!==n&&(h=b.match(e))?(i=h[1],b=h[2].replace(/^\[|\]$/g,"").split("]["),b.forEach(function(j){f=!j||j.match(/^\d+$/),!i&&ga(a)&&(i=a.length),F(a,i)||(a[i]=f?[]:{}),a=a[i],i=j}),!i&&f&&(i=a.length.toString()),Nb(a,i,c)):a[b]=c.match(/^[+-]?\d+(\.\d+)?$/)?parseFloat(c):"true"===c?k:"false"===c?n:c}function Ob(a,b){var c;return ga(b)||L(b)&&b.toString===ba?(c=[],E(b,function(d,e){a&&(d=a+"["+d+"]"),c.push(Ob(d,e))}),c.join("&")):a?Pb(a)+"="+(ia(b)?b.getTime():Pb(b)):""}function Pb(a){return a||a===n||0===a?encodeURIComponent(a).replace(/%20/g,"+"):""}function Qb(a,b,c){var e,d={};return E(a,function(f,h){e=n,na(b,function(i){(C(i)?i.test(f):pa(i)?F(i,f):f===t(i))&&(e=k)},1),e===c&&(d[f]=h)}),d}var k=!0,l=null,n=!1,p=Object,q=Array,r=RegExp,s=Date,t=String,u=Number,v=Math,ba=p.prototype.toString,ca="undefined"!=typeof global?global:this,da={},ea=p.defineProperty&&p.defineProperties,x="Array,Boolean,Date,Function,Number,String,RegExp".split(","),ga=fa(x[0]),ha=fa(x[1]),ia=fa(x[2]),y=fa(x[3]),A=fa(x[4]),B=fa(x[5]),C=fa(x[6]);ra.prototype.constructor=p,ja(p),E(x,function(a,b){ja(ca[b])}),D(p,n,n,{keys:function(a){var b=[];if(!pa(a)&&!C(a)&&!y(a))throw new TypeError("Object required");return E(a,function(c){b.push(c)}),b}}),D(q,n,n,{isArray:function(a){return ga(a)}}),D(q,k,n,{every:function(a,b){var c=this.length,d=0;for(Da(arguments);c>d;){if(d in this&&!a.call(b,this[d],d,this))return n;d++}return k},some:function(a,b){var c=this.length,d=0;for(Da(arguments);c>d;){if(d in this&&a.call(b,this[d],d,this))return k;d++}return n},map:function(a,b){var c=this.length,d=0,e=Array(c);for(Da(arguments);c>d;)d in this&&(e[d]=a.call(b,this[d],d,this)),d++;return e},filter:function(a,b){var c=this.length,d=0,e=[];for(Da(arguments);c>d;)d in this&&a.call(b,this[d],d,this)&&e.push(this[d]),d++;return e},indexOf:function(a,b){return B(this)?this.indexOf(a,b):Ba(this,a,b,1)},lastIndexOf:function(a,b){return B(this)?this.lastIndexOf(a,b):Ba(this,a,b,-1)},forEach:function(a,b){var c=this.length,d=0;for(oa(a);c>d;)d in this&&a.call(b,this[d],d,this),d++},reduce:function(a,b){return Ca(this,a,b)},reduceRight:function(a,b){return Ca(this,a,b,k)}}),D(Function,k,n,{bind:function(a){var d,b=this,c=H(arguments).slice(1);if(!y(this))throw new TypeError("Function.prototype.bind called on a non-function");return d=function(){return b.apply(b.prototype&&this instanceof b?this:a,c.concat(H(arguments)))},d.prototype=this.prototype,d}}),D(s,n,n,{now:function(){return(new s).getTime()}}),function(){var a=va().match(/^\s+$/);try{t.prototype.trim.call([1])}catch(b){a=n}D(t,k,!a,{trim:function(){return this.toString().trimLeft().trimRight()},trimLeft:function(){return this.replace(r("^["+va()+"]+"),"")},trimRight:function(){return this.replace(r("["+va()+"]+$"),"")}})}(),function(){var a=new s(s.UTC(1999,11,31));a=a.toISOString&&"1999-12-31T00:00:00.000Z"===a.toISOString(),G(s,k,!a,"toISOString,toJSON",function(b,c){b[c]=function(){return P(this.getUTCFullYear(),4)+"-"+P(this.getUTCMonth()+1,2)+"-"+P(this.getUTCDate(),2)+"T"+P(this.getUTCHours(),2)+":"+P(this.getUTCMinutes(),2)+":"+P(this.getUTCSeconds(),2)+"."+P(this.getUTCMilliseconds(),3)+"Z"}})}();var Va="AlphanumericSortOrder",Ra="AlphanumericSortIgnore",Qa="AlphanumericSortIgnoreCase",Ta="AlphanumericSortEquivalents";D(q,n,n,{create:function(){var b,a=[];return H(arguments,function(c){if(pa(c))try{b=q.prototype.slice.call(c,0),b.length>0&&(c=b)}catch(d){}a=a.concat(c)}),a}}),D(q,k,n,{find:function(a,b,c){return Ha(this,a,b,c)},findAll:function(a,b,c){var d=[];return T(this,function(e,f,h){Ea(e,a,h,[e,f,h])&&d.push(e)},b,c),d},findIndex:function(a,b,c){return a=Ha(this,a,b,c,k),K(a)?-1:a},count:function(a){return K(a)?this.length:this.findAll(a).length},removeAt:function(a,b){var c,d;if(K(a))return this;for(K(b)&&(b=a),c=0,d=b-a;d>=c;c++)this.splice(a,1);return this},include:function(a,b){return this.clone().add(a,b)},exclude:function(){return q.prototype.remove.apply(this.clone(),arguments)},clone:function(){return qa([],this)},unique:function(a){return Ia(this,a)},flatten:function(a){return Ma(this,a)},union:function(){return Ia(this.concat(Na(arguments)))},intersect:function(){return Ka(this,Na(arguments),n)},subtract:function(){return Ka(this,Na(arguments),k)},at:function(){return za(this,arguments)},first:function(a){return K(a)?this[0]:(0>a&&(a=0),this.slice(0,a))},last:function(a){return K(a)?this[this.length-1]:this.slice(this.length-a<0?0:this.length-a)},from:function(a){return this.slice(a)},to:function(a){return K(a)&&(a=this.length),this.slice(0,a)},min:function(a,b){return Oa(this,a,"min",b)},max:function(a,b){return Oa(this,a,"max",b)},least:function(a,b){return Oa(this.groupBy.apply(this,[a]),"length","min",b)},most:function(a,b){return Oa(this.groupBy.apply(this,[a]),"length","max",b)},sum:function(a){return a=a?this.map(a):this,a.length>0?a.reduce(function(b,c){return b+c}):0},average:function(a){return a=a?this.map(a):this,a.length>0?a.sum()/a.length:0},inGroups:function(a,b){var c=arguments.length>1,d=this,e=[],f=N(this.length/a,void 0,"ceil");return sa(0,a-1,function(h){h*=f;var i=d.slice(h,h+f);c&&i.length<f&&sa(1,f-i.length,function(){i=i.add(b)}),e.push(i)}),e},inGroupsOf:function(a,b){var f,c=[],d=this.length,e=this;return 0===d||0===a?e:(K(a)&&(a=1),K(b)&&(b=l),sa(0,N(d/a,void 0,"ceil")-1,function(h){for(f=e.slice(a*h,a*h+a);f.length<a;)f.push(b);c.push(f)}),c)},isEmpty:function(){return 0==this.compact().length},sortBy:function(a,b){var c=this.clone();return c.sort(function(d,e){var f,h;if(f=S(d,a,c,[d]),h=S(e,a,c,[e]),B(f)&&B(h)){f=f,h=h;var i,j,g,m,o=0,w=0;f=Pa(f),h=Pa(h);do g=Sa(f,o),m=Sa(h,o),i=Ua(g),j=Ua(m),(-1===i||-1===j)&&(i=f.charCodeAt(o)||l,j=h.charCodeAt(o)||l),g=g!==f.charAt(o),m=m!==h.charAt(o),g!==m&&0===w&&(w=g-m),o+=1;while(i!=l&&j!=l&&i===j);f=i===j?w:j>i?-1:1}else f=h>f?-1:f>h?1:0;return f*(b?-1:1)}),c},randomize:function(){for(var c,d,a=this.concat(),b=a.length;b;)c=0|v.random()*b,d=a[--b],a[b]=a[c],a[c]=d;return a},zip:function(){var a=H(arguments);return this.map(function(b,c){return[b].concat(a.map(function(d){return c in d?d[c]:l}))})},sample:function(a){var b=this.randomize();return arguments.length>0?b.slice(0,a):b[0]},each:function(a,b,c){return T(this,a,b,c),this},add:function(a,b){return(!A(u(b))||isNaN(b))&&(b=this.length),q.prototype.splice.apply(this,[b,0].concat(a)),this},remove:function(){var a,b=this;return H(arguments,function(c){for(a=0;a<b.length;)Ea(b[a],c,b,[b[a],a,b])?b.splice(a,1):a++}),b},compact:function(a){var b=[];return T(this,function(c){ga(c)?b.push(c.compact()):a&&c?b.push(c):!a&&c!=l&&c.valueOf()===c.valueOf()&&b.push(c)}),b},groupBy:function(a,b){var e,c=this,d={};return T(c,function(f,h){e=S(f,a,c,[f,h,c]),d[e]||(d[e]=[]),d[e].push(f)}),b&&E(d,b),d},none:function(){return!this.any.apply(this,arguments)}}),D(q,k,n,{all:q.prototype.every,any:q.prototype.some,insert:q.prototype.add}),D(p,n,n,{map:function(a,b){return Wa(a).reduce(function(c,d){return c[d]=S(a[d],b,a,[d,a[d],a]),c},{})},reduce:function(a){var b=Wa(a).map(function(c){return a[c]});return b.reduce.apply(b,H(arguments).slice(1))},each:function(a,b){return oa(b),E(a,b),a},size:function(a){return Wa(a).length}});var Ya="any,all,none,count,find,findAll,isEmpty".split(","),Za="sum,average,min,max,least,most".split(","),$a="map,reduce,size".split(","),ab=Ya.concat(Za).concat($a);!function(){G(q,k,function(){var a=arguments;return a.length>0&&!y(a[0])},"map,every,all,some,any,none,filter",function(a,b){a[b]=function(c){return this[b](function(d,e){return"map"===b?S(d,c,this,[d,e,this]):Ea(d,c,this,[d,e,this])})}})}(),function(){q[Va]="AÁÀÂÃĄBCĆČÇDĎÐEÉÈĚÊËĘFGĞHıIÍÌİÎÏJKLŁMNŃŇÑOÓÒÔPQRŘSŚŠŞTŤUÚÙŮÛÜVWXYÝZŹŻŽÞÆŒØÕÅÄÖ".split("").map(function(b){return b+b.toLowerCase()}).join("");var a={};T("AÁÀÂÃÄ,CÇ,EÉÈÊË,IÍÌİÎÏ,OÓÒÔÕÖ,Sß,UÚÙÛÜ".split(","),function(b){var c=b.charAt(0);T(b.slice(1).split(""),function(d){a[d]=c,a[d.toLowerCase()]=c.toLowerCase()})}),q[Qa]=k,q[Ta]=a}(),Xa(Ya),Xa(Za,k),Aa($a,ra);var U,bb,fb,gb,hb,cb=["ampm","hour","minute","second","ampm","utc","offset_sign","offset_hours","offset_minutes","ampm"],db="({t})?\\s*(\\d{1,2}(?:[,.]\\d+)?)(?:{h}([0-5]\\d(?:[,.]\\d+)?)?{m}(?::?([0-5]\\d(?:[,.]\\d+)?){s})?\\s*(?:({t})|(Z)|(?:([+-])(\\d{2,2})(?::?(\\d{2,2}))?)?)?|\\s*({t}))",eb={},ib=[],jb=[{ba:"f{1,4}|ms|milliseconds",format:function(a){return V(a,"Milliseconds")}},{ba:"ss?|seconds",format:function(a){return V(a,"Seconds")}},{ba:"mm?|minutes",format:function(a){return V(a,"Minutes")}},{ba:"hh?|hours|12hr",format:function(a){return a=V(a,"Hours"),0===a?12:a-12*O(a/13)}},{ba:"HH?|24hr",format:function(a){return V(a,"Hours")}},{ba:"dd?|date|day",format:function(a){return V(a,"Date")}},{ba:"dow|weekday",la:k,format:function(a,b,c){return a=V(a,"Day"),b.weekdays[a+7*(c-1)]}},{ba:"MM?",format:function(a){return V(a,"Month")+1}},{ba:"mon|month",la:k,format:function(a,b,c){return a=V(a,"Month"),b.months[a+12*(c-1)]}},{ba:"y{2,4}|year",format:function(a){return V(a,"FullYear")}},{ba:"[Tt]{1,2}",format:function(a,b,c,d){return 0==b.ampm.length?"":(a=V(a,"Hours"),b=b.ampm[O(a/12)],1===d.length&&(b=b.slice(0,1)),"T"===d.slice(0,1)&&(b=b.toUpperCase()),b)}},{ba:"z{1,4}|tz|timezone",text:k,format:function(a,b,c,d){return a=a.getUTCOffset(),("z"==d||"zz"==d)&&(a=a.replace(/(\d{2})(\d{2})/,function(e,f){return P(f,d.length)})),a}},{ba:"iso(tz|timezone)",format:function(a){return a.getUTCOffset(k)}},{ba:"ord",format:function(a){return a=V(a,"Date"),a+ua(a)}}],kb=[{$:"year",method:"FullYear",ja:k,da:function(a){return 1e3*60*60*24*(365+(a?a.isLeapYear()?1:0:.25))}},{$:"month",method:"Month",ja:k,da:function(a,b){var d,c=30.4375;return a&&(d=a.daysInMonth(),b<=d.days()&&(c=d)),1e3*60*60*24*c},error:.919},{$:"week",method:"ISOWeek",da:aa(6048e5)},{$:"day",method:"Date",ja:k,da:aa(864e5)},{$:"hour",method:"Hours",da:aa(36e5)},{$:"minute",method:"Minutes",da:aa(6e4)},{$:"second",method:"Seconds",da:aa(1e3)},{$:"millisecond",method:"Milliseconds",da:aa(1)}],lb={};mb.prototype={getMonth:function(a){return A(a)?a-1:this.months.indexOf(a)%12},getWeekday:function(a){return this.weekdays.indexOf(a)%7},oa:function(a){var b;return A(a)?a:a&&-1!==(b=this.numbers.indexOf(a))?(b+1)%10:1},ua:function(a){var b=this;return a.replace(r(this.num,"g"),function(c){return b.oa(c)||""})},sa:function(a){return U.units[this.units.indexOf(a)%8]},va:function(a){return this.na(a,a[2]>0?"future":"past")},ra:function(a){return this.na(nb(a),"duration")},wa:function(a){return a=a||this.code,"en"===a||"en-US"===a?k:this.variant},za:function(a){return a===this.ampm[0]},Aa:function(a){return a&&a===this.ampm[1]},na:function(a,b){var c,d,e=a[0],f=a[1],h=a[2],i=this[b]||this.relative;return y(i)?i.call(this,e,f,h,b):(d=this.units[8*(this.plural&&e>1?1:0)+f]||this.units[f],this.capitalizeUnit&&(d=ob(d)),c=this.modifiers.filter(function(j){return"sign"==j.name&&j.value==(h>0?1:-1)})[0],i.replace(/\{(.*?)\}/g,function(j,g){switch(g){case"num":return e;case"unit":return d;case"sign":return c.src}}))},ta:function(){return this.ma?[this.ma].concat(this.ga):this.ga},addFormat:function(a,b,c,d,e){var i,f=c||[],h=this;a=a.replace(/\s+/g,"[-,. ]*"),a=a.replace(/\{([^,]+?)\}/g,function(j,g){var m,o,w,z=g.match(/\?$/);w=g.match(/^(\d+)\??$/);var J=g.match(/(\d)(?:-(\d))?/),M=g.replace(/[^a-z]+$/,"");return w?m=h.tokens[w[1]]:h[M]?m=h[M]:h[M+"s"]&&(m=h[M+"s"],J&&(o=[],m.forEach(function(Q,Fa){var W=Fa%(h.units?8:m.length);W>=J[1]&&W<=(J[2]||J[1])&&o.push(Q)}),m=o),m=pb(m)),w?w="(?:"+m+")":(c||f.push(M),w="("+m+")"),z&&(w+="?"),w}),b?(b=qb(db,h,e),e=["t","[\\s\\u3000]"].concat(h.timeMarker),i=a.match(/\\d\{\d,\d\}\)+\??$/),rb(h,"(?:"+b+")[,\\s\\u3000]+?"+a,cb.concat(f),d),rb(h,a+"(?:[,\\s]*(?:"+e.join("|")+(i?"+":"*")+")"+b+")?",f.concat(cb),d)):rb(h,a,f,d)}},s.extend({create:function(){return X(arguments)},past:function(){return X(arguments,-1)},future:function(){return X(arguments,1)},addLocale:function(a,b){return tb(a,b)},setLocale:function(a){var b=sb(a,n);return bb=b,a&&a!=b.code&&(b.code=a),b},getLocale:function(a){return a?sb(a,n):bb},addFormat:function(a,b,c){rb(sb(c),a,b)}},n,n),s.extend({set:function(){var a=ub(arguments);return Ab(this,a[0],a[1])},setWeekday:function(a){return K(a)?void 0:Fb(this,"Date",V(this,"Date")+a-V(this,"Day"))},setISOWeek:function(a){var b=V(this,"Day")||7;return K(a)?void 0:(this.set({month:0,date:4}),this.set({weekday:1}),a>1&&this.addWeeks(a-1),1!==b&&this.advance({days:b-1}),this.getTime())},getISOWeek:function(){var a=this;a=a.clone();var b=V(a,"Day")||7;return a.addDays(4-b).reset(),1+O(a.daysSince(a.clone().beginningOfYear())/7)},getUTCOffset:function(a){var b=this._utc?0:this.getTimezoneOffset(),c=a===k?":":"";return!b&&a?"Z":P(O(-b/60),2,k)+c+P(v.abs(b%60),2)},utc:function(a){return ka(this,"_utc",a===k||0===arguments.length),this},isUTC:function(){return!!this._utc||0===this.getTimezoneOffset()},advance:function(){var a=ub(arguments,k);return Ab(this,a[0],a[1],1)},rewind:function(){var a=ub(arguments,k);return Ab(this,a[0],a[1],-1)},isValid:function(){return!isNaN(this.getTime())},isAfter:function(a,b){return this.getTime()>s.create(a).getTime()-(b||0)},isBefore:function(a,b){return this.getTime()<s.create(a).getTime()+(b||0)},isBetween:function(a,b,c){var d=this.getTime();a=s.create(a).getTime();var e=s.create(b).getTime();return b=v.min(a,e),a=v.max(a,e),c=c||0,d>b-c&&a+c>d},isLeapYear:function(){var a=V(this,"FullYear");return 0===a%4&&0!==a%100||0===a%400},daysInMonth:function(){return 32-V(new s(V(this,"FullYear"),V(this,"Month"),32),"Date")},format:function(a,b){return Cb(this,a,n,b)},relative:function(a,b){return B(a)&&(b=a,a=l),Cb(this,a,k,b)},is:function(a,b,c){var d,e;if(this.isValid()){if(B(a))switch(a=a.trim().toLowerCase(),e=this.clone().utc(c),k){case"future"===a:return this.getTime()>(new s).getTime();case"past"===a:return this.getTime()<(new s).getTime();case"weekday"===a:return V(e,"Day")>0&&V(e,"Day")<6;case"weekend"===a:return 0===V(e,"Day")||6===V(e,"Day");case(d=U.weekdays.indexOf(a)%7)>-1:return V(e,"Day")===d;case(d=U.months.indexOf(a)%12)>-1:return V(e,"Month")===d}return Db(this,a,b,c)}},reset:function(a){var c,b={};return a=a||"hours","date"===a&&(a="days"),c=kb.some(function(d){return a===d.$||a===d.$+"s"}),b[a]=a.match(/^days?/)?1:0,c?this.set(b,k):this},clone:function(){var a=new s(this.getTime());return a.utc(!!this._utc),a}}),s.extend({iso:function(){return this.toISOString()},getWeekday:s.prototype.getDay,getUTCWeekday:s.prototype.getUTCDay}),u.extend({duration:function(a){return sb(a).ra(this)}}),U=bb=s.addLocale("en",{plural:k,timeMarker:"at",ampm:"am,pm",months:"January,February,March,April,May,June,July,August,September,October,November,December",weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",units:"millisecond:|s,second:|s,minute:|s,hour:|s,day:|s,week:|s,month:|s,year:|s",numbers:"one,two,three,four,five,six,seven,eight,nine,ten",articles:"a,an,the",tokens:"the,st|nd|rd|th,of","short":"{Month} {d}, {yyyy}","long":"{Month} {d}, {yyyy} {h}:{mm}{tt}",full:"{Weekday} {Month} {d}, {yyyy} {h}:{mm}:{ss}{tt}",past:"{num} {unit} {sign}",future:"{num} {unit} {sign}",duration:"{num} {unit}",modifiers:[{name:"sign",src:"ago|before",value:-1},{name:"sign",src:"from now|after|from|in|later",value:1},{name:"edge",src:"last day",value:-2},{name:"edge",src:"end",value:-1},{name:"edge",src:"first day|beginning",value:1},{name:"shift",src:"last",value:-1},{name:"shift",src:"the|this",value:0},{name:"shift",src:"next",value:1}],dateParse:["{num} {unit} {sign}","{sign} {num} {unit}","{month} {year}","{shift} {unit=5-7}","{0?} {date}{1}","{0?} {edge} of {shift?} {unit=4-7?}{month?}{year?}"],timeParse:["{0} {num}{1} {day} of {month} {year?}","{weekday?} {month} {date}{1?} {year?}","{date} {month} {year}","{date} {month}","{shift} {weekday}","{shift} week {weekday}","{weekday} {2?} {shift} week","{num} {unit=4-5} {sign} {day}","{0?} {date}{1} of {month}","{0?}{month?} {date?}{1?} of {shift} {unit=6-7}"]}),hb=kb.concat().reverse(),gb=kb.concat(),gb.splice(2,1),G(s,k,n,kb,function(a,b,c){function d(g){g/=h;var m=g%1,o=b.error||.999;return m&&v.abs(m%1)>o&&(g=N(g)),parseInt(g)}var i,j,e=b.$,f=ob(e),h=b.da();b.ia="add"+f+"s",i=function(g,m){return d(this.getTime()-s.create(g,m).getTime())},j=function(g,m){return d(s.create(g,m).getTime()-this.getTime())},a[e+"sAgo"]=j,a[e+"sUntil"]=j,a[e+"sSince"]=i,a[e+"sFromNow"]=i,a[b.ia]=function(g,m){var o={};return o[e]=g,this.advance(o,m)},Ib(b,h),3>c&&["Last","This","Next"].forEach(function(g){a["is"+g+f]=function(){return this.is(g+" "+e)}}),4>c&&(a["beginningOf"+f]=function(){var g={};switch(e){case"year":g.year=V(this,"FullYear");break;case"month":g.month=V(this,"Month");break;case"day":g.day=V(this,"Date");break;case"week":g.weekday=0}return this.set(g,k)},a["endOf"+f]=function(){var g={hours:23,minutes:59,seconds:59,milliseconds:999};switch(e){case"year":g.month=11,g.day=31;break;case"month":g.day=this.daysInMonth();break;case"week":g.weekday=6}return this.set(g,k)})}),U.addFormat("([+-])?(\\d{4,4})[-.]?{full_month}[-.]?(\\d{1,2})?",k,["year_sign","year","month","date"],n,k),U.addFormat("(\\d{1,2})[-.\\/]{full_month}(?:[-.\\/](\\d{2,4}))?",k,["date","month","year"],k),U.addFormat("{full_month}[-.](\\d{4,4})",n,["month","year"]),U.addFormat("\\/Date\\((\\d+(?:\\+\\d{4,4})?)\\)\\/",n,["timestamp"]),U.addFormat(qb(db,U),n,cb),ib=U.ga.slice(0,7).reverse(),U.ga=U.ga.slice(7).concat(ib),G(s,k,n,"short,long,full",function(a,b){a[b]=function(c){return Cb(this,b,n,c)}}),"〇一二三四五六七八九十百千万".split("").forEach(function(a,b){b>9&&(b=v.pow(10,b-9)),eb[a]=b}),"０１２３４５６７８９".split("").forEach(function(a,b){eb[a]=b}),fb=r("([期週周])?([〇一二三四五六七八九十百千万０１２３４５６７８９]+)(?!昨)","g"),function(){var a="today,yesterday,tomorrow,weekday,weekend,future,past".split(","),b=U.weekdays.slice(0,7),c=U.months.slice(0,12);G(s,k,n,a.concat(b).concat(c),function(d,e){d["is"+ob(e)]=function(f){return this.is(e,0,f)}})}(),function(){s.extend({utc:{create:function(){return X(arguments,0,k)},past:function(){return X(arguments,-1,k)},future:function(){return X(arguments,1,k)}}},n,n)}(),s.extend({RFC1123:"{Dow}, {dd} {Mon} {yyyy} {HH}:{mm}:{ss} {tz}",RFC1036:"{Weekday}, {dd}-{Mon}-{yy} {HH}:{mm}:{ss} {tz}",ISO8601_DATE:"{yyyy}-{MM}-{dd}",ISO8601_DATETIME:"{yyyy}-{MM}-{dd}T{HH}:{mm}:{ss}.{fff}{isotz}"},n,n),DateRange=function(a,b){this.start=s.create(a),this.end=s.create(b)
},DateRange.prototype.toString=function(){return this.isValid()?this.start.full()+".."+this.end.full():"Invalid DateRange"},D(DateRange,k,n,{isValid:function(){return this.start<this.end},duration:function(){return this.isValid()?this.end.getTime()-this.start.getTime():0/0},contains:function(a){var b=this;return(a.start&&a.end?[a.start,a.end]:[a]).every(function(c){return c>=b.start&&c<=b.end})},every:function(a,b){var f,h,c=this.start.clone(),d=[],e=0;for(B(a)?(c.advance(vb(a,0),k),f=vb(a),h="day"===a.toLowerCase()):f={milliseconds:a};c<=this.end;)d.push(c),b&&b(c,e),h&&23===V(c,"Hours")?(c=c.clone(),Fb(c,"Hours",48)):c=c.clone().advance(f,k),e++;return d},union:function(a){return new DateRange(this.start<a.start?this.start:a.start,this.end>a.end?this.end:a.end)},intersect:function(a){return new DateRange(this.start>a.start?this.start:a.start,this.end<a.end?this.end:a.end)},clone:function(){return new DateRange(this.start,this.end)}}),G(DateRange,k,n,"Millisecond,Second,Minute,Hour,Day,Week,Month,Year",function(a,b){a["each"+b]=function(c){return this.every(b,c)}}),D(s,n,n,{range:function(a,b){return new DateRange(a,b)}}),D(Function,k,n,{lazy:function(a,b){function c(){return(!f||e.length<b-1)&&(e.push([this,arguments]),h()),g}var h,i,j,g,d=this,e=[],f=n;return a=a||1,b=b||1/0,i=N(a,void 0,"ceil"),j=N(i/a)||1,h=function(){if(!f&&0!=e.length){for(var m=v.max(e.length-j,0);e.length>m;)g=Function.prototype.apply.apply(d,e.shift());Jb(c,i,function(){f=n,h()}),f=k}},c},delay:function(a){var b=H(arguments).slice(1);return Jb(this,a,this,this,b),this},throttle:function(a){return this.lazy(a,1)},debounce:function(a){function b(){b.cancel(),Jb(b,a,c,this,arguments)}var c=this;return b},cancel:function(){if(ga(this.timers))for(;this.timers.length>0;)clearTimeout(this.timers.shift());return this},after:function(a){var b=this,c=0,d=[];if(A(a)){if(0===a)return b.call(),b}else a=1;return function(){var e;return d.push(H(arguments)),c++,c==a?(e=b.call(this,d),c=0,d=[],e):void 0}},once:function(){return this.throttle(1/0)},fill:function(){var a=this,b=H(arguments);return function(){var c=H(arguments);return b.forEach(function(d,e){(d!=l||e>=c.length)&&c.splice(e,0,d)}),a.apply(this,c)}}}),D(u,n,n,{random:function(a,b){var c,d;return 1==arguments.length&&(b=a,a=0),c=v.min(a||0,K(b)?1:b),d=v.max(a||0,K(b)?1:b)+1,O(v.random()*(d-c)+c)}}),D(u,k,n,{log:function(a){return v.log(this)/(a?v.log(a):1)},abbr:function(a){return Kb(this,a,"kmbt",0,4)},metric:function(a,b){return Kb(this,a,"nμm kMGTPE",4,K(b)?1:b)},bytes:function(a,b){return Kb(this,a,"kMGTPE",0,K(b)?4:b,k)+"B"},isInteger:function(){return 0==this%1},isOdd:function(){return!isNaN(this)&&!this.isMultipleOf(2)},isEven:function(){return this.isMultipleOf(2)},isMultipleOf:function(a){return 0===this%a},format:function(a,b,c){var d,e,f,h="";for(K(b)&&(b=","),K(c)&&(c="."),d=(A(a)?N(this,a||0).toFixed(v.max(a,0)):this.toString()).replace(/^-/,"").split("."),e=d[0],f=d[1],d=e.length;d>0;d-=3)d<e.length&&(h=b+h),h=e.slice(v.max(0,d-3),d)+h;return f&&(h+=c+ta((a||0)-f.length,"0")+f),(0>this?"-":"")+h},hex:function(a){return this.pad(a||1,n,16)},upto:function(a,b,c){return sa(this,a,b,c||1)},downto:function(a,b,c){return sa(this,a,b,-(c||1))},times:function(a){if(a)for(var b=0;this>b;b++)a.call(this,b);return this.toNumber()},chr:function(){return t.fromCharCode(this)},pad:function(a,b,c){return P(this,a,b,c)},ordinalize:function(){var a=this.abs();return a=parseInt(a.toString().slice(-2)),this+ua(a)},toNumber:function(){return parseFloat(this,10)}}),G(u,k,n,"round,floor,ceil",function(a,b){a[b]=function(c){return N(this,c,b)}}),G(u,k,n,"abs,pow,sin,asin,cos,acos,tan,atan,exp,pow,sqrt",function(a,b){a[b]=function(c,d){return v[b](this,c,d)}});var Lb="isObject,isNaN".split(","),Mb="keys,values,select,reject,each,merge,clone,equal,watch,tap,has,toQueryString".split(",");D(p,n,k,{watch:function(a,b,c){if(ea){var d=a[b];p.defineProperty(a,b,{enumerable:k,configurable:k,get:function(){return d},set:function(e){d=c.call(a,b,d,e)}})}}}),D(p,n,function(a,b){return y(b)},{keys:function(a,b){var c=p.keys(a);return c.forEach(function(d){b.call(a,d,a[d])}),c}}),D(p,n,n,{isObject:function(a){return L(a)},isNaN:function(a){return A(a)&&a.valueOf()!==a.valueOf()},equal:function(a,b){return ya(a)&&ya(b)?xa(a)===xa(b):a===b},extended:function(a){return new ra(a)},merge:function(a,b,c,d){var e,f;if(a&&"string"!=typeof b)for(e in b)if(F(b,e)&&a){if(f=b[e],I(a[e])){if(d===n)continue;y(d)&&(f=d.call(b,e,a[e],b[e]))}if(c===k&&f&&pa(f))if(ia(f))f=new s(f.getTime());else{if(!C(f)){a[e]||(a[e]=q.isArray(f)?[]:{}),p.merge(a[e],b[e],c,d);continue}f=new r(f.source,wa(f))}a[e]=f}return a},values:function(a,b){var c=[];return E(a,function(d,e){c.push(e),b&&b.call(a,e)}),c},clone:function(a,b){var c;return ia(a)&&a.clone?a.clone():pa(a)?(c=a instanceof ra?new ra:new a.constructor,p.merge(c,a,b)):a},fromQueryString:function(a,b){var c=p.extended();return a=a&&a.toString?a.toString():"",a.replace(/^.*?\?/,"").split("&").forEach(function(d){d=d.split("="),2===d.length&&Nb(c,d[0],decodeURIComponent(d[1]),b)}),c},toQueryString:function(a,b){return Ob(b,a)},tap:function(a,b){var c=b;return y(b)||(c=function(){b&&a[b]()}),c.call(a,a),a},has:function(a,b){return F(a,b)},select:function(a){return Qb(a,arguments,k)},reject:function(a){return Qb(a,arguments,n)}}),G(p,n,n,x,function(a,b){var c="is"+b;Lb.push(c),a[c]=da[b]}),function(){D(p,n,function(){return 0===arguments.length},{extend:function(){var a=Lb.concat(Mb);"undefined"!=typeof ab&&(a=a.concat(ab)),Aa(a,p)}})}(),Aa(Mb,ra),D(r,n,n,{escape:function(a){return R(a)}}),D(r,k,n,{getFlags:function(){return wa(this)},setFlags:function(a){return r(this.source,a)},addFlag:function(a){return this.setFlags(wa(this,a))},removeFlag:function(a){return this.setFlags(wa(this).replace(a,""))}});var Rb,Sb;D(t,k,function(a){return C(a)||arguments.length>2},{startsWith:function(a,b,c){var d=this;return b&&(d=d.slice(b)),K(c)&&(c=k),a=C(a)?a.source.replace("^",""):R(a),r("^"+a,c?"":"i").test(d)},endsWith:function(a,b,c){var d=this;return I(b)&&(d=d.slice(0,b)),K(c)&&(c=k),a=C(a)?a.source.replace("$",""):R(a),r(a+"$",c?"":"i").test(d)}}),D(t,k,n,{escapeRegExp:function(){return R(this)},escapeURL:function(a){return a?encodeURIComponent(this):encodeURI(this)},unescapeURL:function(a){return a?decodeURI(this):decodeURIComponent(this)},escapeHTML:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\//g,"&#x2f;")},unescapeHTML:function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&#x2f;/g,"/").replace(/&amp;/g,"&")},encodeBase64:function(){return Rb(this)},decodeBase64:function(){return Sb(this)},each:function(a,b){var c,d,e;if(y(a)?(b=a,a=/[\s\S]/g):a?B(a)?a=r(R(a),"gi"):C(a)&&(a=r(a.source,wa(a,"g"))):a=/[\s\S]/g,c=this.match(a)||[],b)for(d=0,e=c.length;e>d;d++)c[d]=b.call(this,c[d],d,c)||c[d];return c},shift:function(a){var b="";return a=a||0,this.codes(function(c){b+=t.fromCharCode(c+a)}),b},codes:function(a){var c,d,b=[];for(c=0,d=this.length;d>c;c++){var e=this.charCodeAt(c);b.push(e),a&&a.call(this,e,c)}return b},chars:function(a){return this.each(a)},words:function(a){return this.trim().each(/\S+/g,a)},lines:function(a){return this.trim().each(/^.*$/gm,a)},paragraphs:function(a){var b=this.trim().split(/[\r\n]{2,}/);return b=b.map(function(c){if(a)var d=a.call(c);return d?d:c})},isBlank:function(){return 0===this.trim().length},has:function(a){return-1!==this.search(C(a)?a:R(a))},add:function(a,b){return b=K(b)?this.length:b,this.slice(0,b)+a+this.slice(b)},remove:function(a){return this.replace(a,"")},reverse:function(){return this.split("").reverse().join("")},compact:function(){return this.trim().replace(/([\r\n\s\u3000])+/g,function(a,b){return"　"===b?b:" "})},at:function(){return za(this,arguments,k)},from:function(a){return this.slice(a)},to:function(a){return K(a)&&(a=this.length),this.slice(0,a)},dasherize:function(){return this.underscore().replace(/_/g,"-")},underscore:function(){return this.replace(/[-\s]+/g,"_").replace(t.Inflector&&t.Inflector.acronymRegExp,function(a,b){return(b>0?"_":"")+a.toLowerCase()}).replace(/([A-Z\d]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").toLowerCase()},camelize:function(a){return this.underscore().replace(/(^|_)([^_]+)/g,function(b,c,d,e){return b=d,b=(c=t.Inflector)&&c.acronyms[b],b=B(b)?b:void 0,e=a!==n||e>0,b?e?b:b.toLowerCase():e?d.capitalize():d})},spacify:function(){return this.underscore().replace(/_/g," ")},stripTags:function(){var a=this;return na(arguments.length>0?arguments:[""],function(b){a=a.replace(r("</?"+R(b)+"[^<>]*>","gi"),"")}),a},removeTags:function(){var a=this;return na(arguments.length>0?arguments:["\\S+"],function(b){b=r("<("+b+")[^<>]*(?:\\/>|>.*?<\\/\\1>)","gi"),a=a.replace(b,"")}),a},truncate:function(a,b,c,d){var e="",f="",h=this.toString(),i="["+va()+"]+",j="[^"+va()+"]*",g=r(i+j+"$");if(d=K(d)?"...":t(d),h.length<=a)return h;switch(c){case"left":a=h.length-a,e=d,h=h.slice(a),g=r("^"+j+i);break;case"middle":a=O(a/2),f=d+h.slice(h.length-a).trimLeft(),h=h.slice(0,a);break;default:a=a,f=d,h=h.slice(0,a)}return b===n&&this.slice(a,a+1).match(/\S/)&&(h=h.remove(g)),e+h+f},pad:function(a,b){return ta(b,a)+this+ta(b,a)},padLeft:function(a,b){return ta(b,a)+this},padRight:function(a,b){return this+ta(b,a)},first:function(a){return K(a)&&(a=1),this.substr(0,a)},last:function(a){return K(a)&&(a=1),this.substr(this.length-a<0?0:this.length-a)},repeat:function(a){var b="",c=this;if(!A(a)||1>a)return"";for(;a;)1&a&&(b+=c),(a>>=1)&&(c+=c);return b},toNumber:function(a){var b=this.replace(/,/g,"");return b.match(/\./)?parseFloat(b):parseInt(b,a||10)},capitalize:function(a){var b;return this.toLowerCase().replace(a?/[\s\S]/g:/^\S/,function(c){var e,d=c.toUpperCase();return e=b?c:d,b=d!==c,e})},assign:function(){var a={};return H(arguments,function(b,c){L(b)?qa(a,b):a[c+1]=b}),this.replace(/\{([^{]+?)\}/g,function(b,c){return F(a,c)?a[c]:b})}}),D(t,k,n,{insert:t.prototype.add}),function(a){if(this.btoa)Rb=this.btoa,Sb=this.atob;else{var b=/[^A-Za-z0-9\+\/\=]/g;Rb=function(c){var e,f,h,i,j,g,d="",m=0;do e=c.charCodeAt(m++),f=c.charCodeAt(m++),h=c.charCodeAt(m++),i=e>>2,e=(3&e)<<4|f>>4,j=(15&f)<<2|h>>6,g=63&h,isNaN(f)?j=g=64:isNaN(h)&&(g=64),d=d+a.charAt(i)+a.charAt(e)+a.charAt(j)+a.charAt(g);while(m<c.length);return d},Sb=function(c){var e,f,h,i,j,d="",g=0;if(c.match(b))throw Error("String contains invalid base64 characters");c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");do e=a.indexOf(c.charAt(g++)),f=a.indexOf(c.charAt(g++)),i=a.indexOf(c.charAt(g++)),j=a.indexOf(c.charAt(g++)),e=e<<2|f>>4,f=(15&f)<<4|i>>2,h=(3&i)<<6|j,d+=t.fromCharCode(e),64!=i&&(d+=t.fromCharCode(f)),64!=j&&(d+=t.fromCharCode(h));while(g<c.length);return d}}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=")}(),function(){Array.prototype.remove=function(e){var t,_ref;return(t=this.indexOf(e))>-1?([].splice.apply(this,[t,t-t+1].concat(_ref=[])),_ref):void 0},Array.prototype.clear=function(){return this.slice(0,+this.length+1||9e9)}}.call(this),function(undefined){function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.lang().ordinal(func.call(this,a),period)}}function Language(){}function Moment(config){extend(this,config)}function Duration(duration){var years=duration.years||duration.year||duration.y||0,months=duration.months||duration.month||duration.M||0,weeks=duration.weeks||duration.week||duration.w||0,days=duration.days||duration.day||duration.d||0,hours=duration.hours||duration.hour||duration.h||0,minutes=duration.minutes||duration.minute||duration.m||0,seconds=duration.seconds||duration.second||duration.s||0,milliseconds=duration.milliseconds||duration.millisecond||duration.ms||0;this._input=duration,this._milliseconds=milliseconds+1e3*seconds+6e4*minutes+36e5*hours,this._days=days+7*weeks,this._months=months+12*years,this._data={},this._bubble()}function extend(a,b){for(var i in b)b.hasOwnProperty(i)&&(a[i]=b[i]);return a}function absRound(number){return 0>number?Math.ceil(number):Math.floor(number)}function leftZeroFill(number,targetLength){for(var output=number+"";output.length<targetLength;)output="0"+output;return output}function addOrSubtractDurationFromMoment(mom,duration,isAdding,ignoreUpdateOffset){var minutes,hours,milliseconds=duration._milliseconds,days=duration._days,months=duration._months;milliseconds&&mom._d.setTime(+mom._d+milliseconds*isAdding),(days||months)&&(minutes=mom.minute(),hours=mom.hour()),days&&mom.date(mom.date()+days*isAdding),months&&mom.month(mom.month()+months*isAdding),milliseconds&&!ignoreUpdateOffset&&moment.updateOffset(mom),(days||months)&&(mom.minute(minutes),mom.hour(hours))}function isArray(input){return"[object Array]"===Object.prototype.toString.call(input)}function compareArrays(array1,array2){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;len>i;i++)~~array1[i]!==~~array2[i]&&diffs++;return diffs+lengthDiff}function normalizeUnits(units){return units?unitAliases[units]||units.toLowerCase().replace(/(.)s$/,"$1"):units}function loadLang(key,values){return values.abbr=key,languages[key]||(languages[key]=new Language),languages[key].set(values),languages[key]}function getLangDefinition(key){if(!key)return moment.fn._lang;if(!languages[key]&&hasModule)try{require("./lang/"+key)}catch(e){return moment.fn._lang}return languages[key]}function removeFormattingTokens(input){return input.match(/\[.*\]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var i,length,array=format.match(formattingTokens);for(i=0,length=array.length;length>i;i++)array[i]=formatTokenFunctions[array[i]]?formatTokenFunctions[array[i]]:removeFormattingTokens(array[i]);return function(mom){var output="";for(i=0;length>i;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){function replaceLongDateFormatTokens(input){return m.lang().longDateFormat(input)||input}for(var i=5;i--&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);return formatFunctions[format]||(formatFunctions[format]=makeFormatFunction(format)),formatFunctions[format](m)}function getParseRegexForToken(token,config){switch(token){case"DDDD":return parseTokenThreeDigits;case"YYYY":return parseTokenFourDigits;case"YYYYY":return parseTokenSixDigits;case"S":case"SS":case"SSS":case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return getLangDefinition(config._l)._meridiemParse;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return parseTokenOneOrTwoDigits;default:return new RegExp(token.replace("\\",""))}}function timezoneMinutesFromString(string){var tzchunk=(parseTokenTimezone.exec(string)||[])[0],parts=(tzchunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(60*parts[1])+~~parts[2];return"+"===parts[0]?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"M":case"MM":datePartArray[1]=null==input?0:~~input-1;break;case"MMM":case"MMMM":a=getLangDefinition(config._l).monthsParse(input),null!=a?datePartArray[1]=a:config._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=input&&(datePartArray[2]=~~input);break;case"YY":datePartArray[0]=~~input+(~~input>68?1900:2e3);break;case"YYYY":case"YYYYY":datePartArray[0]=~~input;break;case"a":case"A":config._isPm=getLangDefinition(config._l).isPM(input);break;case"H":case"HH":case"h":case"hh":datePartArray[3]=~~input;break;case"m":case"mm":datePartArray[4]=~~input;break;case"s":case"ss":datePartArray[5]=~~input;break;case"S":case"SS":case"SSS":datePartArray[6]=~~(1e3*("0."+input));break;case"X":config._d=new Date(1e3*parseFloat(input));break;case"Z":case"ZZ":config._useUTC=!0,config._tzm=timezoneMinutesFromString(input)}null==input&&(config._isValid=!1)}function dateFromArray(config){var i,date,input=[];if(!config._d){for(i=0;7>i;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];input[3]+=~~((config._tzm||0)/60),input[4]+=~~((config._tzm||0)%60),date=new Date(0),config._useUTC?(date.setUTCFullYear(input[0],input[1],input[2]),date.setUTCHours(input[3],input[4],input[5],input[6])):(date.setFullYear(input[0],input[1],input[2]),date.setHours(input[3],input[4],input[5],input[6])),config._d=date}}function makeDateFromStringAndFormat(config){var i,parsedInput,tokens=config._f.match(formattingTokens),string=config._i;for(config._a=[],i=0;i<tokens.length;i++)parsedInput=(getParseRegexForToken(tokens[i],config).exec(string)||[])[0],parsedInput&&(string=string.slice(string.indexOf(parsedInput)+parsedInput.length)),formatTokenFunctions[tokens[i]]&&addTimeToArrayFromToken(tokens[i],parsedInput,config);string&&(config._il=string),config._isPm&&config._a[3]<12&&(config._a[3]+=12),config._isPm===!1&&12===config._a[3]&&(config._a[3]=0),dateFromArray(config)}function makeDateFromStringAndArray(config){var tempConfig,tempMoment,bestMoment,i,currentScore,scoreToBeat=99;for(i=0;i<config._f.length;i++)tempConfig=extend({},config),tempConfig._f=config._f[i],makeDateFromStringAndFormat(tempConfig),tempMoment=new Moment(tempConfig),currentScore=compareArrays(tempConfig._a,tempMoment.toArray()),tempMoment._il&&(currentScore+=tempMoment._il.length),scoreToBeat>currentScore&&(scoreToBeat=currentScore,bestMoment=tempMoment);extend(config,bestMoment)}function makeDateFromString(config){var i,string=config._i,match=isoRegex.exec(string);if(match){for(config._f="YYYY-MM-DD"+(match[2]||" "),i=0;4>i;i++)if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}parseTokenTimezone.exec(string)&&(config._f+=" Z"),makeDateFromStringAndFormat(config)}else config._d=new Date(string)}function makeDateFromInput(config){var input=config._i,matched=aspNetJsonRegex.exec(input);input===undefined?config._d=new Date:matched?config._d=new Date(+matched[1]):"string"==typeof input?makeDateFromString(config):isArray(input)?(config._a=input.slice(0),dateFromArray(config)):config._d=input instanceof Date?new Date(+input):new Date(input)}function substituteTimeAgo(string,number,withoutSuffix,isFuture,lang){return lang.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(milliseconds,withoutSuffix,lang){var seconds=round(Math.abs(milliseconds)/1e3),minutes=round(seconds/60),hours=round(minutes/60),days=round(hours/24),years=round(days/365),args=45>seconds&&["s",seconds]||1===minutes&&["m"]||45>minutes&&["mm",minutes]||1===hours&&["h"]||22>hours&&["hh",hours]||1===days&&["d"]||25>=days&&["dd",days]||45>=days&&["M"]||345>days&&["MM",round(days/30)]||1===years&&["y"]||["yy",years];return args[2]=withoutSuffix,args[3]=milliseconds>0,args[4]=lang,substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var adjustedMoment,end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day();return daysToDayOfWeek>end&&(daysToDayOfWeek-=7),end-7>daysToDayOfWeek&&(daysToDayOfWeek+=7),adjustedMoment=moment(mom).add("d",daysToDayOfWeek),{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function makeMoment(config){var input=config._i,format=config._f;return null===input||""===input?null:("string"==typeof input&&(config._i=input=getLangDefinition().preparse(input)),moment.isMoment(input)?(config=extend({},input),config._d=new Date(+input._d)):format?isArray(format)?makeDateFromStringAndArray(config):makeDateFromStringAndFormat(config):makeDateFromInput(config),new Moment(config))}function makeGetterAndSetter(name,key){moment.fn[name]=moment.fn[name+"s"]=function(input){var utc=this._isUTC?"UTC":"";return null!=input?(this._d["set"+utc+key](input),moment.updateOffset(this),this):this._d["get"+utc+key]()}}function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeDurationAsGetter(name,factor){moment.duration.fn["as"+name]=function(){return+this/factor}}for(var moment,i,VERSION="2.1.0",round=Math.round,languages={},hasModule="undefined"!=typeof module&&module.exports,aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{1,4}/,parseTokenSixDigits=/[+\-]?\d{1,6}/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/i,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,isoRegex=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoTimes=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,proxyGettersAndSetters="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),unitMillisecondFactors={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",y:"year"},formatFunctions={},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.lang().monthsShort(this,format)},MMMM:function(format){return this.lang().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.lang().weekdaysMin(this,format)},ddd:function(format){return this.lang().weekdaysShort(this,format)},dddd:function(format){return this.lang().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return leftZeroFill(~~(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(~~(a/60),2)+":"+leftZeroFill(~~a%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(~~(10*a/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};ordinalizeTokens.length;)i=ordinalizeTokens.pop(),formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i);for(;paddedTokens.length;)i=paddedTokens.pop(),formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);for(formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3),Language.prototype={set:function(config){var prop,i;for(i in config)prop=config[i],"function"==typeof prop?this[i]=prop:this["_"+i]=prop},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName){var i,mom,regex;for(this._monthsParse||(this._monthsParse=[]),i=0;12>i;i++)if(this._monthsParse[i]||(mom=moment([2e3,i]),regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),this._monthsParse[i].test(monthName))return i},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;7>i;i++)if(this._weekdaysParse[i]||(mom=moment([2e3,1]).day(i),regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),this._weekdaysParse[i].test(weekdayName))return i},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];return!output&&this._longDateFormat[key.toUpperCase()]&&(output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key]=output),output},isPM:function(input){return"p"===(input+"").toLowerCase()[0]},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom){var output=this._calendar[key];return"function"==typeof output?output.apply(mom):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return"function"==typeof output?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return"function"==typeof format?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}},moment=function(input,format,lang){return makeMoment({_i:input,_f:format,_l:lang,_isUTC:!1})},moment.utc=function(input,format,lang){return makeMoment({_useUTC:!0,_isUTC:!0,_l:lang,_i:input,_f:format})},moment.unix=function(input){return moment(1e3*input)},moment.duration=function(input,key){var sign,ret,isDuration=moment.isDuration(input),isNumber="number"==typeof input,duration=isDuration?input._input:isNumber?{}:input,matched=aspNetTimeSpanJsonRegex.exec(input);return isNumber?key?duration[key]=input:duration.milliseconds=input:matched&&(sign="-"===matched[1]?-1:1,duration={y:0,d:~~matched[2]*sign,h:~~matched[3]*sign,m:~~matched[4]*sign,s:~~matched[5]*sign,ms:~~matched[6]*sign}),ret=new Duration(duration),isDuration&&input.hasOwnProperty("_lang")&&(ret._lang=input._lang),ret},moment.version=VERSION,moment.defaultFormat=isoFormat,moment.updateOffset=function(){},moment.lang=function(key,values){return key?(values?loadLang(key,values):languages[key]||getLangDefinition(key),moment.duration.fn._lang=moment.fn._lang=getLangDefinition(key),void 0):moment.fn._lang._abbr},moment.langData=function(key){return key&&key._lang&&key._lang._abbr&&(key=key._lang._abbr),getLangDefinition(key)},moment.isMoment=function(obj){return obj instanceof Moment},moment.isDuration=function(obj){return obj instanceof Duration},moment.fn=Moment.prototype={clone:function(){return moment(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return formatMoment(moment(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return null==this._isValid&&(this._isValid=this._a?!compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray()):!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.lang().postformat(output)},add:function(input,val){var dur;return dur="string"==typeof input?moment.duration(+val,input):moment.duration(input,val),addOrSubtractDurationFromMoment(this,dur,1),this},subtract:function(input,val){var dur;return dur="string"==typeof input?moment.duration(+val,input):moment.duration(input,val),addOrSubtractDurationFromMoment(this,dur,-1),this},diff:function(input,units,asFloat){var diff,output,that=this._isUTC?moment(input).zone(this._offset||0):moment(input).local(),zoneDiff=6e4*(this.zone()-that.zone());return units=normalizeUnits(units),"year"===units||"month"===units?(diff=432e5*(this.daysInMonth()+that.daysInMonth()),output=12*(this.year()-that.year())+(this.month()-that.month()),output+=(this-moment(this).startOf("month")-(that-moment(that).startOf("month")))/diff,output-=6e4*(this.zone()-moment(this).startOf("month").zone()-(that.zone()-moment(that).startOf("month").zone()))/diff,"year"===units&&(output/=12)):(diff=this-that,output="second"===units?diff/1e3:"minute"===units?diff/6e4:"hour"===units?diff/36e5:"day"===units?(diff-zoneDiff)/864e5:"week"===units?(diff-zoneDiff)/6048e5:diff),asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(){var diff=this.diff(moment().startOf("day"),"days",!0),format=-6>diff?"sameElse":-1>diff?"lastWeek":0>diff?"lastDay":1>diff?"sameDay":2>diff?"nextDay":7>diff?"nextWeek":"sameElse";return this.format(this.lang().calendar(format,this))},isLeapYear:function(){var year=this.year();return 0===year%4&&0!==year%100||0===year%400},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?"string"==typeof input&&(input=this.lang().weekdaysParse(input),"number"!=typeof input)?this:this.add({d:input-day}):day},month:function(input){var dayOfMonth,utc=this._isUTC?"UTC":"";return null!=input?"string"==typeof input&&(input=this.lang().monthsParse(input),"number"!=typeof input)?this:(dayOfMonth=this.date(),this.date(1),this._d["set"+utc+"Month"](input),this.date(Math.min(dayOfMonth,this.daysInMonth())),moment.updateOffset(this),this):this._d["get"+utc+"Month"]()},startOf:function(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units&&this.weekday(0),this},endOf:function(units){return this.startOf(units).add(units,1).subtract("ms",1)},isAfter:function(input,units){return units="undefined"!=typeof units?units:"millisecond",+this.clone().startOf(units)>+moment(input).startOf(units)},isBefore:function(input,units){return units="undefined"!=typeof units?units:"millisecond",+this.clone().startOf(units)<+moment(input).startOf(units)},isBetween:function(from,to,units){return this.isAfter(from,units)&&this.isBefore(to,units)},isSame:function(input,units){return units="undefined"!=typeof units?units:"millisecond",+this.clone().startOf(units)===+moment(input).startOf(units)
},min:function(other){return other=moment.apply(null,arguments),this>other?this:other},max:function(other){return other=moment.apply(null,arguments),other>this?this:other},zone:function(input){var offset=this._offset||0;return null==input?this._isUTC?offset:this._d.getTimezoneOffset():("string"==typeof input&&(input=timezoneMinutesFromString(input)),Math.abs(input)<16&&(input=60*input),this._offset=input,this._isUTC=!0,offset!==input&&addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},daysInMonth:function(){return moment.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add("d",input-dayOfYear)},weekYear:function(input){var year=weekOfYear(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==input?year:this.add("y",input-year)},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return null==input?year:this.add("y",input-year)},week:function(input){var week=this.lang().week(this);return null==input?week:this.add("d",7*(input-week))},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add("d",7*(input-week))},weekday:function(input){var weekday=(this._d.getDay()+7-this.lang()._week.dow)%7;return null==input?weekday:this.add("d",input-weekday)},isoWeekday:function(input){return null==input?this.day()||7:this.day(this.day()%7?input:input-7)},lang:function(key){return key===undefined?this._lang:(this._lang=getLangDefinition(key),this)}},i=0;i<proxyGettersAndSetters.length;i++)makeGetterAndSetter(proxyGettersAndSetters[i].toLowerCase().replace(/s$/,""),proxyGettersAndSetters[i]);makeGetterAndSetter("year","FullYear"),moment.fn.days=moment.fn.day,moment.fn.months=moment.fn.month,moment.fn.weeks=moment.fn.week,moment.fn.isoWeeks=moment.fn.isoWeek,moment.fn.toJSON=moment.fn.toISOString,moment.duration.fn=Duration.prototype={_bubble:function(){var seconds,minutes,hours,years,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data;data.milliseconds=milliseconds%1e3,seconds=absRound(milliseconds/1e3),data.seconds=seconds%60,minutes=absRound(seconds/60),data.minutes=minutes%60,hours=absRound(minutes/60),data.hours=hours%24,days+=absRound(hours/24),data.days=days%30,months+=absRound(days/30),data.months=months%12,years=absRound(months/12),data.years=years},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*~~(this._months/12)},humanize:function(withSuffix){var difference=+this,output=relativeTime(difference,!withSuffix,this.lang());return withSuffix&&(output=this.lang().pastFuture(difference,output)),this.lang().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);return this._milliseconds+=dur._milliseconds,this._days+=dur._days,this._months+=dur._months,this._bubble(),this},subtract:function(input,val){var dur=moment.duration(input,val);return this._milliseconds-=dur._milliseconds,this._days-=dur._days,this._months-=dur._months,this._bubble(),this},get:function(units){return units=normalizeUnits(units),this[units.toLowerCase()+"s"]()},as:function(units){return units=normalizeUnits(units),this["as"+units.charAt(0).toUpperCase()+units.slice(1)+"s"]()},lang:moment.fn.lang};for(i in unitMillisecondFactors)unitMillisecondFactors.hasOwnProperty(i)&&(makeDurationAsGetter(i,unitMillisecondFactors[i]),makeDurationGetter(i.toLowerCase()));makeDurationAsGetter("Weeks",6048e5),moment.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},moment.lang("en",{ordinal:function(number){var b=number%10,output=1===~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}}),hasModule&&(module.exports=moment),"undefined"==typeof ender&&(this.moment=moment),"function"==typeof define&&define.amd&&define("moment",[],function(){return moment})}.call(this),function($,undefined){function setDefaults(d){$.extend(!0,defaults,d)}function Calendar(element,options,eventSources){function render(inc){content?elementVisible()&&(calcSize(),_renderView(inc)):initialRender()}function initialRender(){tm=options.theme?"ui":"fc",element.addClass("fc"),options.isRTL?element.addClass("fc-rtl"):element.addClass("fc-ltr"),options.theme&&element.addClass("ui-widget"),content=$("<div class='fc-content' style='position:relative'/>").prependTo(element),header=new Header(t,options),headerElement=header.render(),headerElement&&element.prepend(headerElement),changeView(options.defaultView),options.handleWindowResize&&$(window).resize(windowResize),bodyVisible()||lateRender()}function lateRender(){setTimeout(function(){!currentView.start&&bodyVisible()&&renderView()},0)}function destroy(){currentView&&(trigger("viewDestroy",currentView,currentView,currentView.element),currentView.triggerEventDestroy()),$(window).unbind("resize",windowResize),header.destroy(),content.remove(),element.removeClass("fc fc-rtl ui-widget")}function elementVisible(){return element.is(":visible")}function bodyVisible(){return $("body").is(":visible")}function changeView(newViewName){currentView&&newViewName==currentView.name||_changeView(newViewName)}function _changeView(newViewName){ignoreWindowResize++,currentView&&(trigger("viewDestroy",currentView,currentView,currentView.element),unselect(),currentView.triggerEventDestroy(),freezeContentHeight(),currentView.element.remove(),header.deactivateButton(currentView.name)),header.activateButton(newViewName),currentView=new fcViews[newViewName]($("<div class='fc-view fc-view-"+newViewName+"' style='position:relative'/>").appendTo(content),t),renderView(),unfreezeContentHeight(),ignoreWindowResize--}function renderView(inc){(!currentView.start||inc||date<currentView.start||date>=currentView.end)&&elementVisible()&&_renderView(inc)}function _renderView(inc){ignoreWindowResize++,currentView.start&&(trigger("viewDestroy",currentView,currentView,currentView.element),unselect(),clearEvents()),freezeContentHeight(),currentView.render(date,inc||0),setSize(),unfreezeContentHeight(),(currentView.afterRender||noop)(),updateTitle(),updateTodayButton(),trigger("viewRender",currentView,currentView,currentView.element),currentView.trigger("viewDisplay",_element),ignoreWindowResize--,getAndRenderEvents()}function updateSize(){elementVisible()&&(unselect(),clearEvents(),calcSize(),setSize(),renderEvents())}function calcSize(){suggestedViewHeight=options.contentHeight?options.contentHeight:options.height?options.height-(headerElement?headerElement.height():0)-vsides(content):Math.round(content.width()/Math.max(options.aspectRatio,.5))}function setSize(){suggestedViewHeight===undefined&&calcSize(),ignoreWindowResize++,currentView.setHeight(suggestedViewHeight),currentView.setWidth(content.width()),ignoreWindowResize--,elementOuterWidth=element.outerWidth()}function windowResize(){if(!ignoreWindowResize)if(currentView.start){var uid=++resizeUID;setTimeout(function(){uid==resizeUID&&!ignoreWindowResize&&elementVisible()&&elementOuterWidth!=(elementOuterWidth=element.outerWidth())&&(ignoreWindowResize++,updateSize(),currentView.trigger("windowResize",_element),ignoreWindowResize--)},200)}else lateRender()}function refetchEvents(){clearEvents(),fetchAndRenderEvents()}function rerenderEvents(modifiedEventID){clearEvents(),renderEvents(modifiedEventID)}function renderEvents(modifiedEventID){elementVisible()&&(currentView.setEventData(events),currentView.renderEvents(events,modifiedEventID),currentView.trigger("eventAfterAllRender"))}function clearEvents(){currentView.triggerEventDestroy(),currentView.clearEvents(),currentView.clearEventData()}function getAndRenderEvents(){!options.lazyFetching||isFetchNeeded(currentView.visStart,currentView.visEnd)?fetchAndRenderEvents():renderEvents()}function fetchAndRenderEvents(){fetchEvents(currentView.visStart,currentView.visEnd)}function reportEvents(_events){events=_events,renderEvents()}function reportEventChange(eventID){rerenderEvents(eventID)}function updateTitle(){header.updateTitle(currentView.title)}function updateTodayButton(){var today=new Date;today>=currentView.start&&today<currentView.end?header.disableButton("today"):header.enableButton("today")}function select(start,end,allDay){currentView.select(start,end,allDay===undefined?!0:allDay)}function unselect(){currentView&&currentView.unselect()}function prev(){renderView(-1)}function next(){renderView(1)}function prevYear(){addYears(date,-1),renderView()}function nextYear(){addYears(date,1),renderView()}function today(){date=new Date,renderView()}function gotoDate(year,month,dateOfMonth){year instanceof Date?date=cloneDate(year):setYMD(date,year,month,dateOfMonth),renderView()}function incrementDate(years,months,days){years!==undefined&&addYears(date,years),months!==undefined&&addMonths(date,months),days!==undefined&&addDays(date,days),renderView()}function getDate(){return cloneDate(date)}function freezeContentHeight(){content.css({width:"100%",height:content.height(),overflow:"hidden"})}function unfreezeContentHeight(){content.css({width:"",height:"",overflow:""})}function getView(){return currentView}function option(name,value){return value===undefined?options[name]:(("height"==name||"contentHeight"==name||"aspectRatio"==name)&&(options[name]=value,updateSize()),void 0)}function trigger(name,thisObj){return options[name]?options[name].apply(thisObj||_element,Array.prototype.slice.call(arguments,2)):void 0}var t=this;t.options=options,t.render=render,t.destroy=destroy,t.refetchEvents=refetchEvents,t.reportEvents=reportEvents,t.reportEventChange=reportEventChange,t.rerenderEvents=rerenderEvents,t.changeView=changeView,t.select=select,t.unselect=unselect,t.prev=prev,t.next=next,t.prevYear=prevYear,t.nextYear=nextYear,t.today=today,t.gotoDate=gotoDate,t.incrementDate=incrementDate,t.formatDate=function(format,date){return formatDate(format,date,options)},t.formatDates=function(format,date1,date2){return formatDates(format,date1,date2,options)},t.getDate=getDate,t.getView=getView,t.option=option,t.trigger=trigger,EventManager.call(t,options,eventSources);var isFetchNeeded=t.isFetchNeeded,fetchEvents=t.fetchEvents;ResourceManager.call(t,options);var header,headerElement,content,tm,currentView,elementOuterWidth,suggestedViewHeight,_dragElement,_element=element[0],resizeUID=0,ignoreWindowResize=0,date=new Date,events=[];setYMD(date,options.year,options.month,options.date),options.droppable&&$(document).bind("dragstart",function(ev,ui){var _e=ev.target,e=$(_e);if(!e.parents(".fc").length){var accept=options.dropAccept;($.isFunction(accept)?accept.call(_e,e):e.is(accept))&&(_dragElement=_e,currentView.dragStart(_dragElement,ev,ui))}}).bind("dragstop",function(ev,ui){_dragElement&&(currentView.dragStop(_dragElement,ev,ui),_dragElement=null)})}function Header(calendar,options){function render(){tm=options.theme?"ui":"fc";var sections=options.header;return sections?element=$("<table class='fc-header' style='width:100%'/>").append($("<tr/>").append(renderSection("left")).append(renderSection("center")).append(renderSection("right"))):void 0}function destroy(){element.remove()}function renderSection(position){var e=$("<td class='fc-header-"+position+"'/>"),buttonStr=options.header[position];return buttonStr&&$.each(buttonStr.split(" "),function(i){i>0&&e.append("<span class='fc-header-space'/>");var prevButton;$.each(this.split(","),function(j,buttonName){if("title"==buttonName)e.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>"),prevButton&&prevButton.addClass(tm+"-corner-right"),prevButton=null;else{var buttonClick;if(calendar[buttonName]?buttonClick=calendar[buttonName]:fcViews[buttonName]&&(buttonClick=function(){button.removeClass(tm+"-state-hover"),calendar.changeView(buttonName)}),buttonClick){var icon=options.theme?smartProperty(options.buttonIcons,buttonName):null,text=smartProperty(options.buttonText,buttonName),button=$("<span class='fc-button fc-button-"+buttonName+" "+tm+"-state-default'>"+(icon?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+icon+"'/>"+"</span>":text)+"</span>").click(function(){button.hasClass(tm+"-state-disabled")||buttonClick()}).mousedown(function(){button.not("."+tm+"-state-active").not("."+tm+"-state-disabled").addClass(tm+"-state-down")}).mouseup(function(){button.removeClass(tm+"-state-down")}).hover(function(){button.not("."+tm+"-state-active").not("."+tm+"-state-disabled").addClass(tm+"-state-hover")},function(){button.removeClass(tm+"-state-hover").removeClass(tm+"-state-active").removeClass(tm+"-state-down")}).appendTo(e);disableTextSelection(button),prevButton||button.addClass(tm+"-corner-left"),prevButton=button}}}),prevButton&&prevButton.addClass(tm+"-corner-right")}),e}function updateTitle(html){element.find("h2").html(html)}function activateButton(buttonName){element.find("span.fc-button-"+buttonName).addClass(tm+"-state-active")}function deactivateButton(buttonName){element.find("span.fc-button-"+buttonName).removeClass(tm+"-state-active")}function disableButton(buttonName){element.find("span.fc-button-"+buttonName).addClass(tm+"-state-disabled")}function enableButton(buttonName){element.find("span.fc-button-"+buttonName).removeClass(tm+"-state-disabled")}var t=this;t.render=render,t.destroy=destroy,t.updateTitle=updateTitle,t.activateButton=activateButton,t.deactivateButton=deactivateButton,t.disableButton=disableButton,t.enableButton=enableButton;var tm,element=$([])}function EventManager(options,_sources){function isFetchNeeded(start,end){return!rangeStart||rangeStart>start||end>rangeEnd}function fetchEvents(start,end){rangeStart=start,rangeEnd=end,cache=[];var fetchID=++currentFetchID,len=sources.length;pendingSourceCnt=len;for(var i=0;len>i;i++)fetchEventSource(sources[i],fetchID)}function fetchEventSource(source,fetchID){_fetchEventSource(source,function(events){if(fetchID==currentFetchID){if(events){options.eventDataTransform&&(events=$.map(events,options.eventDataTransform)),source.eventDataTransform&&(events=$.map(events,source.eventDataTransform));for(var i=0;i<events.length;i++)events[i].source=source,normalizeEvent(events[i]);cache=cache.concat(events)}pendingSourceCnt--,pendingSourceCnt||reportEvents(cache)}})}function _fetchEventSource(source,callback){var i,res,fetchers=fc.sourceFetchers;for(i=0;i<fetchers.length;i++){if(res=fetchers[i](source,rangeStart,rangeEnd,callback),res===!0)return;if("object"==typeof res)return _fetchEventSource(res,callback),void 0}var events=source.events;if(events)$.isFunction(events)?(pushLoading(),events(cloneDate(rangeStart),cloneDate(rangeEnd),function(events){callback(events),popLoading()})):$.isArray(events)?callback(events):callback();else{var url=source.url;if(url){var customData,success=source.success,error=source.error,complete=source.complete;customData=$.isFunction(source.data)?source.data():source.data;var data=$.extend({},customData||{}),startParam=firstDefined(source.startParam,options.startParam),endParam=firstDefined(source.endParam,options.endParam);startParam&&(data[startParam]=Math.round(+rangeStart/1e3)),endParam&&(data[endParam]=Math.round(+rangeEnd/1e3)),pushLoading(),$.ajax($.extend({},ajaxDefaults,source,{data:data,success:function(events){events=events||[];var res=applyAll(success,this,arguments);$.isArray(res)&&(events=res),callback(events)},error:function(){applyAll(error,this,arguments),callback()},complete:function(){applyAll(complete,this,arguments),popLoading()}}))}else callback()}}function addEventSource(source){source=_addEventSource(source),source&&(pendingSourceCnt++,fetchEventSource(source,currentFetchID))}function _addEventSource(source){return $.isFunction(source)||$.isArray(source)?source={events:source}:"string"==typeof source&&(source={url:source}),"object"==typeof source?(normalizeSource(source),sources.push(source),source):void 0}function removeEventSource(source){sources=$.grep(sources,function(src){return!isSourcesEqual(src,source)}),cache=$.grep(cache,function(e){return!isSourcesEqual(e.source,source)}),reportEvents(cache)}function updateEvent(event){var i,e,len=cache.length,defaultEventEnd=getView().defaultEventEnd,startDelta=event.start-event._start,endDelta=event.end?event.end-(event._end||defaultEventEnd(event)):0;for(i=0;len>i;i++)e=cache[i],e._id==event._id&&e!=event&&(e.start=new Date(+e.start+startDelta),e.end=event.end?e.end?new Date(+e.end+endDelta):new Date(+defaultEventEnd(e)+endDelta):null,e.title=event.title,e.url=event.url,e.allDay=event.allDay,e.className=event.className,e.editable=event.editable,e.color=event.color,e.backgroundColor=event.backgroundColor,e.borderColor=event.borderColor,e.textColor=event.textColor,normalizeEvent(e));normalizeEvent(event),reportEvents(cache)}function renderEvent(event,stick){normalizeEvent(event),event.source||(stick&&(stickySource.events.push(event),event.source=stickySource),cache.push(event)),reportEvents(cache)}function removeEvents(filter){if(filter){if(!$.isFunction(filter)){var id=filter+"";filter=function(e){return e._id==id}}cache=$.grep(cache,filter,!0);for(var i=0;i<sources.length;i++)$.isArray(sources[i].events)&&(sources[i].events=$.grep(sources[i].events,filter,!0))}else{cache=[];for(var i=0;i<sources.length;i++)$.isArray(sources[i].events)&&(sources[i].events=[])}reportEvents(cache)}function clientEvents(filter){return $.isFunction(filter)?$.grep(cache,filter):filter?(filter+="",$.grep(cache,function(e){return e._id==filter})):cache}function pushLoading(){loadingLevel++||trigger("loading",null,!0)}function popLoading(){--loadingLevel||trigger("loading",null,!1)}function normalizeEvent(event){var source=event.source||{},ignoreTimezone=firstDefined(source.ignoreTimezone,options.ignoreTimezone);event._id=event._id||(event.id===undefined?"_fc"+eventGUID++:event.id+""),event.date&&(event.start||(event.start=event.date),delete event.date),event._start=cloneDate(event.start=parseDate(event.start,ignoreTimezone)),event.end=parseDate(event.end,ignoreTimezone),event.end&&event.end<=event.start&&(event.end=null),event._end=event.end?cloneDate(event.end):null,event.allDay===undefined&&(event.allDay=firstDefined(source.allDayDefault,options.allDayDefault)),event.className?"string"==typeof event.className&&(event.className=event.className.split(/\s+/)):event.className=[],event.resources?"string"==typeof event.resources&&(event.resources=event.resources.split(/\s+/)):event.resources=[]}function normalizeSource(source){source.className?"string"==typeof source.className&&(source.className=source.className.split(/\s+/)):source.className=[];for(var normalizers=fc.sourceNormalizers,i=0;i<normalizers.length;i++)normalizers[i](source)}function isSourcesEqual(source1,source2){return source1&&source2&&getSourcePrimitive(source1)==getSourcePrimitive(source2)}function getSourcePrimitive(source){return("object"==typeof source?source.events||source.url:"")||source}var t=this;t.isFetchNeeded=isFetchNeeded,t.fetchEvents=fetchEvents,t.addEventSource=addEventSource,t.removeEventSource=removeEventSource,t.updateEvent=updateEvent,t.renderEvent=renderEvent,t.removeEvents=removeEvents,t.clientEvents=clientEvents,t.normalizeEvent=normalizeEvent;for(var rangeStart,rangeEnd,trigger=t.trigger,getView=t.getView,reportEvents=t.reportEvents,stickySource={events:[]},sources=[stickySource],currentFetchID=0,pendingSourceCnt=0,loadingLevel=0,cache=[],i=0;i<_sources.length;i++)_addEventSource(_sources[i])}function ResourceManager(options){function setResources(sources){resourceSources=[];var resource;if($.isFunction(sources))resource={resources:sources},resourceSources.push(resource),cache=undefined;else if("string"==typeof sources)resource={url:sources},resourceSources.push(resource),cache=undefined;else if("object"==typeof sources&&null!=sources){for(var i=0;i<sources.length;i++){var s=sources[i];normalizeSource(s),resource={resources:s},resourceSources.push(resource)}cache=undefined}}function fetchResources(useCache,currentView){if(useCache="undefined"!=typeof useCache?useCache:!0,cache!=undefined&&useCache)return cache;cache=[];for(var len=resourceSources.length,i=0;len>i;i++){var resources=fetchResourceSource(resourceSources[i],currentView);cache=cache.concat(resources)}return cache}function fetchResourceSource(source,currentView){var resources=source.resources;if(resources){if($.isFunction(resources))return resources()}else{var url=source.url;if(url){var data={};if("object"==typeof currentView){var startParam=options.startParam,endParam=options.endParam;startParam&&(data[startParam]=Math.round(+currentView.visStart/1e3)),endParam&&(data[endParam]=Math.round(+currentView.visEnd/1e3))}$.ajax($.extend({},source,{data:data,dataType:"json",cache:!1,success:function(res){res=res||[],resources=res},error:function(){alert("ajax error getting json from "+url)},async:!1}))}}return resources}function normalizeSource(source){source.className?"string"==typeof source.className&&(source.className=source.className.split(/\s+/)):source.className=[];for(var normalizers=fc.sourceNormalizers,i=0;i<normalizers.length;i++)normalizers[i](source)}var t=this;t.fetchResources=fetchResources,t.setResources=setResources;var cache,resourceSources=[];setResources(options.resources)}function addYears(d,n,keepTime){return d.setFullYear(d.getFullYear()+n),keepTime||clearTime(d),d}function addMonths(d,n,keepTime){if(+d){var m=d.getMonth()+n,check=cloneDate(d);for(check.setDate(1),check.setMonth(m),d.setMonth(m),keepTime||clearTime(d);d.getMonth()!=check.getMonth();)d.setDate(d.getDate()+(check>d?1:-1))}return d}function addDays(d,n,keepTime){if(+d){var dd=d.getDate()+n,check=cloneDate(d);check.setHours(9),check.setDate(dd),d.setDate(dd),keepTime||clearTime(d),fixDate(d,check)}return d}function fixDate(d,check){if(+d)for(;d.getDate()!=check.getDate();)d.setTime(+d+(check>d?1:-1)*HOUR_MS)}function addMinutes(d,n){return d.setMinutes(d.getMinutes()+n),d}function clearTime(d){return d.setHours(0),d.setMinutes(0),d.setSeconds(0),d.setMilliseconds(0),d}function cloneDate(d,dontKeepTime){return dontKeepTime?clearTime(new Date(+d)):new Date(+d)}function zeroDate(){var d,i=0;do d=new Date(1970,i++,1);while(d.getHours());return d}function dayDiff(d1,d2){return Math.round((cloneDate(d1,!0)-cloneDate(d2,!0))/DAY_MS)}function setYMD(date,y,m,d){y!==undefined&&y!=date.getFullYear()&&(date.setDate(1),date.setMonth(0),date.setFullYear(y)),m!==undefined&&m!=date.getMonth()&&(date.setDate(1),date.setMonth(m)),d!==undefined&&date.setDate(d)}function parseDate(s,ignoreTimezone){return"object"==typeof s?s:"number"==typeof s?new Date(1e3*s):"string"==typeof s?s.match(/^\d+(\.\d+)?$/)?new Date(1e3*parseFloat(s)):(ignoreTimezone===undefined&&(ignoreTimezone=!0),parseISO8601(s,ignoreTimezone)||(s?new Date(s):null)):null}function parseISO8601(s,ignoreTimezone){var m=s.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!m)return null;var date=new Date(m[1],0,1);if(ignoreTimezone||!m[13]){var check=new Date(m[1],0,1,9,0);m[3]&&(date.setMonth(m[3]-1),check.setMonth(m[3]-1)),m[5]&&(date.setDate(m[5]),check.setDate(m[5])),fixDate(date,check),m[7]&&date.setHours(m[7]),m[8]&&date.setMinutes(m[8]),m[10]&&date.setSeconds(m[10]),m[12]&&date.setMilliseconds(1e3*Number("0."+m[12])),fixDate(date,check)}else if(date.setUTCFullYear(m[1],m[3]?m[3]-1:0,m[5]||1),date.setUTCHours(m[7]||0,m[8]||0,m[10]||0,m[12]?1e3*Number("0."+m[12]):0),m[14]){var offset=60*Number(m[16])+(m[18]?Number(m[18]):0);offset*="-"==m[15]?1:-1,date=new Date(+date+1e3*60*offset)}return date}function parseTime(s){if("number"==typeof s)return 60*s;if("object"==typeof s)return 60*s.getHours()+s.getMinutes();var m=s.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(m){var h=parseInt(m[1],10);return m[3]&&(h%=12,"p"==m[3].toLowerCase().charAt(0)&&(h+=12)),60*h+(m[2]?parseInt(m[2],10):0)}}function formatDate(date,format,options){return formatDates(date,null,format,options)}function formatDates(date1,date2,format,options){options=options||defaults;var i,c,i2,formatter,date=date1,otherDate=date2,len=format.length,res="";for(i=0;len>i;i++)if(c=format.charAt(i),"'"==c){for(i2=i+1;len>i2;i2++)if("'"==format.charAt(i2)){date&&(res+=i2==i+1?"'":format.substring(i+1,i2),i=i2);break}}else if("("==c){for(i2=i+1;len>i2;i2++)if(")"==format.charAt(i2)){var subres=formatDate(date,format.substring(i+1,i2),options);parseInt(subres.replace(/\D/,""),10)&&(res+=subres),i=i2;break}}else if("["==c){for(i2=i+1;len>i2;i2++)if("]"==format.charAt(i2)){var subformat=format.substring(i+1,i2),subres=formatDate(date,subformat,options);subres!=formatDate(otherDate,subformat,options)&&(res+=subres),i=i2;break}}else if("{"==c)date=date2,otherDate=date1;else if("}"==c)date=date1,otherDate=date2;else{for(i2=len;i2>i;i2--)if(formatter=dateFormatters[format.substring(i,i2)]){date&&(res+=formatter(date,options)),i=i2-1;break}i2==i&&date&&(res+=c)}return res}function iso8601Week(date){var time,checkDate=new Date(date.getTime());return checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7)),time=checkDate.getTime(),checkDate.setMonth(0),checkDate.setDate(1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1}function exclEndDay(event){return event.end?_exclEndDay(event.end,event.allDay):addDays(cloneDate(event.start),1)}function _exclEndDay(end,allDay){return end=cloneDate(end),allDay||end.getHours()||end.getMinutes()?addDays(end,1):clearTime(end)}function lazySegBind(container,segs,bindHandlers){container.unbind("mouseover").mouseover(function(ev){for(var e,i,seg,parent=ev.target;parent!=this;)e=parent,parent=parent.parentNode;(i=e._fci)!==undefined&&(e._fci=undefined,seg=segs[i],bindHandlers(seg.event,seg.element,seg),$(ev.target).trigger(ev)),ev.stopPropagation()})}function setOuterWidth(element,width,includeMargins){for(var e,i=0;i<element.length;i++)e=$(element[i]),e.width(Math.max(0,width-hsides(e,includeMargins)))}function setOuterHeight(element,height,includeMargins){for(var e,i=0;i<element.length;i++)e=$(element[i]),e.height(Math.max(0,height-vsides(e,includeMargins)))}function hsides(element,includeMargins){return hpadding(element)+hborders(element)+(includeMargins?hmargins(element):0)}function hpadding(element){return(parseFloat($.css(element[0],"paddingLeft",!0))||0)+(parseFloat($.css(element[0],"paddingRight",!0))||0)}function hmargins(element){return(parseFloat($.css(element[0],"marginLeft",!0))||0)+(parseFloat($.css(element[0],"marginRight",!0))||0)}function hborders(element){return(parseFloat($.css(element[0],"borderLeftWidth",!0))||0)+(parseFloat($.css(element[0],"borderRightWidth",!0))||0)}function vsides(element,includeMargins){return vpadding(element)+vborders(element)+(includeMargins?vmargins(element):0)}function vpadding(element){return(parseFloat($.css(element[0],"paddingTop",!0))||0)+(parseFloat($.css(element[0],"paddingBottom",!0))||0)}function vmargins(element){return(parseFloat($.css(element[0],"marginTop",!0))||0)+(parseFloat($.css(element[0],"marginBottom",!0))||0)}function vborders(element){return(parseFloat($.css(element[0],"borderTopWidth",!0))||0)+(parseFloat($.css(element[0],"borderBottomWidth",!0))||0)}function noop(){}function dateCompare(a,b){return a-b}function arrayMax(a){return Math.max.apply(Math,a)}function zeroPad(n){return(10>n?"0":"")+n}function smartProperty(obj,name){if(obj[name]!==undefined)return obj[name];for(var res,parts=name.split(/(?=[A-Z])/),i=parts.length-1;i>=0;i--)if(res=obj[parts[i].toLowerCase()],res!==undefined)return res;return obj[""]}function htmlEscape(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function disableTextSelection(element){element.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function markFirstLast(e){e.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function getSkinCss(event,opt){var source=event.source||{},eventColor=event.color,sourceColor=source.color,optionColor=opt("eventColor"),backgroundColor=event.backgroundColor||eventColor||source.backgroundColor||sourceColor||opt("eventBackgroundColor")||optionColor,borderColor=event.borderColor||eventColor||source.borderColor||sourceColor||opt("eventBorderColor")||optionColor,textColor=event.textColor||source.textColor||opt("eventTextColor"),statements=[];return backgroundColor&&statements.push("background-color:"+backgroundColor),borderColor&&statements.push("border-color:"+borderColor),textColor&&statements.push("color:"+textColor),statements.join(";")}function applyAll(functions,thisObj,args){if($.isFunction(functions)&&(functions=[functions]),functions){var i,ret;for(i=0;i<functions.length;i++)ret=functions[i].apply(thisObj,args)||ret;return ret}}function firstDefined(){for(var i=0;i<arguments.length;i++)if(arguments[i]!==undefined)return arguments[i]}function MonthView(element,calendar){function render(date,delta){delta&&(addMonths(date,delta),date.setDate(1));var firstDay=opt("firstDay"),start=cloneDate(date,!0);start.setDate(1);var end=addMonths(cloneDate(start),1),visStart=cloneDate(start);addDays(visStart,-((visStart.getDay()-firstDay+7)%7)),skipHiddenDays(visStart);var visEnd=cloneDate(end);addDays(visEnd,(7-visEnd.getDay()+firstDay)%7),skipHiddenDays(visEnd,-1,!0);var colCnt=getCellsPerWeek(),rowCnt=Math.round(dayDiff(visEnd,visStart)/7);"fixed"==opt("weekMode")&&(addDays(visEnd,7*(6-rowCnt)),rowCnt=6),t.title=formatDate(start,opt("titleFormat")),t.start=start,t.end=end,t.visStart=visStart,t.visEnd=visEnd,renderBasic(rowCnt,colCnt,!0)}var t=this;t.render=render,BasicView.call(t,element,calendar,"month");var opt=t.opt,renderBasic=t.renderBasic,skipHiddenDays=t.skipHiddenDays,getCellsPerWeek=t.getCellsPerWeek,formatDate=calendar.formatDate}function BasicWeekView(element,calendar){function render(date,delta){delta&&addDays(date,7*delta);var start=addDays(cloneDate(date),-((date.getDay()-opt("firstDay")+7)%7)),end=addDays(cloneDate(start),7),visStart=cloneDate(start);skipHiddenDays(visStart);var visEnd=cloneDate(end);skipHiddenDays(visEnd,-1,!0);var colCnt=getCellsPerWeek();t.start=start,t.end=end,t.visStart=visStart,t.visEnd=visEnd,t.title=formatDates(visStart,addDays(cloneDate(visEnd),-1),opt("titleFormat")),renderBasic(1,colCnt,!1)}var t=this;t.render=render,BasicView.call(t,element,calendar,"basicWeek");var opt=t.opt,renderBasic=t.renderBasic,skipHiddenDays=t.skipHiddenDays,getCellsPerWeek=t.getCellsPerWeek,formatDates=calendar.formatDates}function ExtendedView(element,calendar){function render(date,delta){delta&&addDays(date,10*delta);var start=addDays(cloneDate(date),-((date.getDay()-opt("firstDay")+7)%7)),end=addDays(cloneDate(start),10),visStart=cloneDate(start);skipHiddenDays(visStart);var visEnd=cloneDate(end);skipHiddenDays(visEnd,-1,!0);var colCnt=10;t.start=start,t.end=end,t.visStart=visStart,t.visEnd=visEnd,t.title=formatDates(visStart,addDays(cloneDate(visEnd),-1),opt("titleFormat")),renderBasic(1,colCnt,!1)}var t=this;t.render=render,BasicView.call(t,element,calendar,"week");var opt=t.opt,renderBasic=t.renderBasic;calendar.formatDate;var skipHiddenDays=t.skipHiddenDays}function BasicDayView(element,calendar){function render(date,delta){delta&&addDays(date,delta),skipHiddenDays(date,0>delta?-1:1);var start=cloneDate(date,!0),end=addDays(cloneDate(start),1);t.title=formatDate(date,opt("titleFormat")),t.start=t.visStart=start,t.end=t.visEnd=end,renderBasic(1,1,!1)}var t=this;t.render=render,BasicView.call(t,element,calendar,"basicDay");var opt=t.opt,renderBasic=t.renderBasic,skipHiddenDays=t.skipHiddenDays,formatDate=calendar.formatDate}function BasicView(element,calendar,viewName){function renderBasic(_rowCnt,_colCnt,_showNumbers){rowCnt=_rowCnt,colCnt=_colCnt,showNumbers=_showNumbers,updateOptions(),body||buildEventContainer(),buildTable()}function updateOptions(){tm=opt("theme")?"ui":"fc",colFormat=opt("columnFormat"),showWeekNumbers=opt("weekNumbers"),weekNumberTitle=opt("weekNumberTitle"),weekNumberFormat="iso"!=opt("weekNumberCalculation")?"w":"W"}function buildEventContainer(){daySegmentContainer=$("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(element)}function buildTable(){var html=buildTableHTML();table&&table.remove(),table=$(html).appendTo(element),head=table.find("thead"),headCells=head.find(".fc-day-header"),body=table.find("tbody"),bodyRows=body.find("tr"),bodyCells=body.find(".fc-day"),bodyFirstCells=bodyRows.find("td:first-child"),firstRowCellInners=bodyRows.eq(0).find(".fc-day > div"),firstRowCellContentInners=bodyRows.eq(0).find(".fc-day-content > div"),markFirstLast(head.add(head.find("tr"))),markFirstLast(bodyRows),bodyRows.eq(0).addClass("fc-first"),bodyRows.filter(":last").addClass("fc-last"),bodyCells.each(function(i,_cell){var date=cellToDate(Math.floor(i/colCnt),i%colCnt);
trigger("dayRender",t,date,$(_cell))}),dayBind(bodyCells)}function buildTableHTML(){var html="<table class='fc-border-separate' style='width:100%' cellspacing='0'>"+buildHeadHTML()+buildBodyHTML()+"</table>";return html}function buildHeadHTML(){var col,date,headerClass=tm+"-widget-header",html="";for(html+="<thead><tr>",showWeekNumbers&&(html+="<th class='fc-week-number "+headerClass+"'>"+htmlEscape(weekNumberTitle)+"</th>"),col=0;colCnt>col;col++)date=cellToDate(0,col),html+="<th class='fc-day-header fc-"+dayIDs[date.getDay()]+" "+headerClass+"'>"+htmlEscape(formatDate(date,colFormat))+"</th>";return html+="</tr></thead>"}function buildBodyHTML(){var row,col,date,contentClass=tm+"-widget-content",html="";for(html+="<tbody>",row=0;rowCnt>row;row++){for(html+="<tr class='fc-week'>",showWeekNumbers&&(date=cellToDate(row,0),html+="<td class='fc-week-number "+contentClass+"'>"+"<div>"+htmlEscape(formatDate(date,weekNumberFormat))+"</div>"+"</td>"),col=0;colCnt>col;col++)date=cellToDate(row,col),html+=buildCellHTML(date);html+="</tr>"}return html+="</tbody>"}function buildCellHTML(date){var contentClass=tm+"-widget-content",month=t.start.getMonth(),today=clearTime(new Date),html="",classNames=["fc-day","fc-"+dayIDs[date.getDay()],contentClass];return date.getMonth()!=month&&classNames.push("fc-other-month"),+date==+today?classNames.push("fc-today",tm+"-state-highlight"):today>date?classNames.push("fc-past"):classNames.push("fc-future"),html+="<td class='"+classNames.join(" ")+"'"+" data-date='"+formatDate(date,"yyyy-MM-dd")+"'"+">"+"<div>",showNumbers&&(html+="<div class='fc-day-number'>"+date.getDate()+"</div>"),html+="<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>"}function setHeight(height){viewHeight=height;var rowHeight,rowHeightLast,cell,bodyHeight=viewHeight-head.height();"variable"==opt("weekMode")?rowHeight=rowHeightLast=Math.floor(bodyHeight/(1==rowCnt?2:6)):(rowHeight=Math.floor(bodyHeight/rowCnt),rowHeightLast=bodyHeight-rowHeight*(rowCnt-1)),bodyFirstCells.each(function(i,_cell){rowCnt>i&&(cell=$(_cell),cell.find("> div").css("min-height",(i==rowCnt-1?rowHeightLast:rowHeight)-vsides(cell)))})}function setWidth(width){viewWidth=width,colPositions.clear(),colContentPositions.clear(),weekNumberWidth=0,showWeekNumbers&&(weekNumberWidth=head.find("th.fc-week-number").outerWidth()),colWidth=Math.floor((viewWidth-weekNumberWidth)/colCnt),setOuterWidth(headCells.slice(0,-1),colWidth)}function dayBind(days){days.click(dayClick).mousedown(daySelectionMousedown)}function dayClick(ev){if(!opt("selectable")){var date=parseISO8601($(this).data("date"));trigger("dayClick",this,date,!0,ev)}}function renderDayOverlay(overlayStart,overlayEnd,refreshCoordinateGrid){refreshCoordinateGrid&&coordinateGrid.build();for(var segments=rangeToSegments(overlayStart,overlayEnd),i=0;i<segments.length;i++){var segment=segments[i];dayBind(renderCellOverlay(segment.row,segment.leftCol,segment.row,segment.rightCol))}}function renderCellOverlay(row0,col0,row1,col1){var rect=coordinateGrid.rect(row0,col0,row1,col1,element);return renderOverlay(rect,element)}function defaultSelectionEnd(startDate){return cloneDate(startDate)}function renderSelection(startDate,endDate){renderDayOverlay(startDate,addDays(cloneDate(endDate),1),!0)}function clearSelection(){clearOverlays()}function reportDayClick(date,allDay,ev){var cell=dateToCell(date),_element=bodyCells[cell.row*colCnt+cell.col];trigger("dayClick",_element,date,allDay,ev)}function dragStart(_dragElement,ev){hoverListener.start(function(cell){clearOverlays(),cell&&renderCellOverlay(cell.row,cell.col,cell.row,cell.col)},ev)}function dragStop(_dragElement,ev,ui){var cell=hoverListener.stop();if(clearOverlays(),cell){var d=cellToDate(cell);trigger("drop",_dragElement,d,!0,ev,ui)}}function defaultEventEnd(event){return cloneDate(event.start)}function colLeft(col){return colPositions.left(col)}function colRight(col){return colPositions.right(col)}function colContentLeft(col){return colContentPositions.left(col)}function colContentRight(col){return colContentPositions.right(col)}function allDayRow(i){return bodyRows.eq(i)}var t=this;t.renderBasic=renderBasic,t.setHeight=setHeight,t.setWidth=setWidth,t.renderDayOverlay=renderDayOverlay,t.defaultSelectionEnd=defaultSelectionEnd,t.renderSelection=renderSelection,t.clearSelection=clearSelection,t.reportDayClick=reportDayClick,t.dragStart=dragStart,t.dragStop=dragStop,t.defaultEventEnd=defaultEventEnd,t.getHoverListener=function(){return hoverListener},t.colLeft=colLeft,t.colRight=colRight,t.colContentLeft=colContentLeft,t.colContentRight=colContentRight,t.getIsCellAllDay=function(){return!0},t.allDayRow=allDayRow,t.getRowCnt=function(){return rowCnt},t.getColCnt=function(){return colCnt},t.getColWidth=function(){return colWidth},t.getDaySegmentContainer=function(){return daySegmentContainer},View.call(t,element,calendar,viewName),OverlayManager.call(t),SelectionManager.call(t),BasicEventRenderer.call(t);var table,head,headCells,body,bodyRows,bodyCells,bodyFirstCells,firstRowCellInners,firstRowCellContentInners,daySegmentContainer,viewWidth,viewHeight,colWidth,weekNumberWidth,rowCnt,colCnt,showNumbers,coordinateGrid,hoverListener,colPositions,colContentPositions,tm,colFormat,showWeekNumbers,weekNumberTitle,weekNumberFormat,opt=t.opt,trigger=t.trigger,renderOverlay=t.renderOverlay,clearOverlays=t.clearOverlays,daySelectionMousedown=t.daySelectionMousedown,cellToDate=t.cellToDate,dateToCell=t.dateToCell,rangeToSegments=t.rangeToSegments,formatDate=calendar.formatDate;disableTextSelection(element.addClass("fc-grid")),coordinateGrid=new CoordinateGrid(function(rows,cols){var e,n,p;headCells.each(function(i,_e){e=$(_e),n=e.offset().left,i&&(p[1]=n),p=[n],cols[i]=p}),p[1]=n+e.outerWidth(),bodyRows.each(function(i,_e){rowCnt>i&&(e=$(_e),n=e.offset().top,i&&(p[1]=n),p=[n],rows[i]=p)}),p[1]=n+e.outerHeight()}),hoverListener=new HoverListener(coordinateGrid),colPositions=new HorizontalPositionCache(function(col){return firstRowCellInners.eq(col)}),colContentPositions=new HorizontalPositionCache(function(col){return firstRowCellContentInners.eq(col)})}function BasicEventRenderer(){function renderEvents(events,modifiedEventId){t.renderDayEvents(events,modifiedEventId)}function clearEvents(){t.getDaySegmentContainer().empty()}var t=this;t.renderEvents=renderEvents,t.clearEvents=clearEvents,DayEventRenderer.call(t)}function AgendaWeekView(element,calendar){function render(date,delta){delta&&addDays(date,7*delta);var start=addDays(cloneDate(date),-((date.getDay()-opt("firstDay")+7)%7)),end=addDays(cloneDate(start),7),visStart=cloneDate(start);skipHiddenDays(visStart);var visEnd=cloneDate(end);skipHiddenDays(visEnd,-1,!0);var colCnt=getCellsPerWeek();t.title=formatDates(visStart,addDays(cloneDate(visEnd),-1),opt("titleFormat")),t.start=start,t.end=end,t.visStart=visStart,t.visEnd=visEnd,renderAgenda(colCnt)}var t=this;t.render=render,AgendaView.call(t,element,calendar,"agendaWeek");var opt=t.opt,renderAgenda=t.renderAgenda,skipHiddenDays=t.skipHiddenDays,getCellsPerWeek=t.getCellsPerWeek,formatDates=calendar.formatDates}function AgendaDayView(element,calendar){function render(date,delta){delta&&addDays(date,delta),skipHiddenDays(date,0>delta?-1:1);var start=cloneDate(date,!0),end=addDays(cloneDate(start),1);t.title=formatDate(date,opt("titleFormat")),t.start=t.visStart=start,t.end=t.visEnd=end,renderAgenda(1)}var t=this;t.render=render,AgendaView.call(t,element,calendar,"agendaDay");var opt=t.opt,renderAgenda=t.renderAgenda,skipHiddenDays=t.skipHiddenDays,formatDate=calendar.formatDate}function AgendaView(element,calendar,viewName){function renderAgenda(c){colCnt=c,updateOptions(),dayTable?buildDayTable():buildSkeleton()}function updateOptions(){tm=opt("theme")?"ui":"fc",rtl=opt("isRTL"),minMinute=parseTime(opt("minTime")),maxMinute=parseTime(opt("maxTime")),colFormat=opt("columnFormat"),showWeekNumbers=opt("weekNumbers"),weekNumberTitle=opt("weekNumberTitle"),weekNumberFormat="iso"!=opt("weekNumberCalculation")?"w":"W",snapMinutes=opt("snapMinutes")||opt("slotMinutes")}function buildSkeleton(){var s,d,i,maxd,minutes,headerClass=tm+"-widget-header",contentClass=tm+"-widget-content",slotNormal=0==opt("slotMinutes")%15;for(buildDayTable(),slotLayer=$("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(element),opt("allDaySlot")?(daySegmentContainer=$("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(slotLayer),s="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+headerClass+" fc-agenda-axis'>"+opt("allDayText")+"</th>"+"<td>"+"<div class='fc-day-content'><div style='position:relative'/></div>"+"</td>"+"<th class='"+headerClass+" fc-agenda-gutter'>&nbsp;</th>"+"</tr>"+"</table>",allDayTable=$(s).appendTo(slotLayer),allDayRow=allDayTable.find("tr"),dayBind(allDayRow.find("td")),slotLayer.append("<div class='fc-agenda-divider "+headerClass+"'>"+"<div class='fc-agenda-divider-inner'/>"+"</div>")):daySegmentContainer=$([]),slotScroller=$("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(slotLayer),slotContainer=$("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(slotScroller),slotSegmentContainer=$("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(slotContainer),s="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",d=zeroDate(),maxd=addMinutes(cloneDate(d),maxMinute),addMinutes(d,minMinute),slotCnt=0,i=0;maxd>d;i++)minutes=d.getMinutes(),s+="<tr class='fc-slot"+i+" "+(minutes?"fc-minor":"")+"'>"+"<th class='fc-agenda-axis "+headerClass+"'>"+(slotNormal&&minutes?"&nbsp;":formatDate(d,opt("axisFormat")))+"</th>"+"<td class='"+contentClass+"'>"+"<div style='position:relative'>&nbsp;</div>"+"</td>"+"</tr>",addMinutes(d,opt("slotMinutes")),slotCnt++;s+="</tbody></table>",slotTable=$(s).appendTo(slotContainer),slotTableFirstInner=slotTable.find("div:first"),slotBind(slotTable.find("td"))}function buildDayTable(){var html=buildDayTableHTML();dayTable&&dayTable.remove(),dayTable=$(html).appendTo(element),dayHead=dayTable.find("thead"),dayHeadCells=dayHead.find("th").slice(1,-1),dayBody=dayTable.find("tbody"),dayBodyCells=dayBody.find("td").slice(0,-1),dayBodyCellInners=dayBodyCells.find("> div"),dayBodyCellContentInners=dayBodyCells.find(".fc-day-content > div"),dayBodyFirstCell=dayBodyCells.eq(0),dayBodyFirstCellStretcher=dayBodyCellInners.eq(0),markFirstLast(dayHead.add(dayHead.find("tr"))),markFirstLast(dayBody.add(dayBody.find("tr")))}function buildDayTableHTML(){var html="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'>"+buildDayTableHeadHTML()+buildDayTableBodyHTML()+"</table>";return html}function buildDayTableHeadHTML(){var date,weekText,col,headerClass=tm+"-widget-header",html="";for(html+="<thead><tr>",showWeekNumbers?(weekText=formatDate(date,weekNumberFormat),rtl?weekText+=weekNumberTitle:weekText=weekNumberTitle+weekText,html+="<th class='fc-agenda-axis fc-week-number "+headerClass+"'>"+htmlEscape(weekText)+"</th>"):html+="<th class='fc-agenda-axis "+headerClass+"'>&nbsp;</th>",col=0;colCnt>col;col++)date=cellToDate(0,col),html+="<th class='fc-"+dayIDs[date.getDay()]+" fc-col"+col+" "+headerClass+"'>"+htmlEscape(formatDate(date,colFormat))+"</th>";return html+="<th class='fc-agenda-gutter "+headerClass+"'>&nbsp;</th>"+"</tr>"+"</thead>"}function buildDayTableBodyHTML(){var date,col,cellsHTML,cellHTML,classNames,headerClass=tm+"-widget-header",contentClass=tm+"-widget-content",today=clearTime(new Date),html="";for(html+="<tbody><tr><th class='fc-agenda-axis "+headerClass+"'>&nbsp;</th>",cellsHTML="",col=0;colCnt>col;col++)date=cellToDate(0,col),classNames=["fc-col"+col,"fc-"+dayIDs[date.getDay()],contentClass],+date==+today?classNames.push(tm+"-state-highlight","fc-today"):today>date?classNames.push("fc-past"):classNames.push("fc-future"),cellHTML="<td class='"+classNames.join(" ")+"'>"+"<div>"+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>",cellsHTML+=cellHTML;return html+=cellsHTML,html+="<td class='fc-agenda-gutter "+contentClass+"'>&nbsp;</td>"+"</tr>"+"</tbody>"}function setHeight(height){height===undefined&&(height=viewHeight),viewHeight=height,slotTopCache={};var headHeight=dayBody.position().top,allDayHeight=slotScroller.position().top,bodyHeight=Math.min(height-headHeight,slotTable.height()+allDayHeight+1);dayBodyFirstCellStretcher.height(bodyHeight-vsides(dayBodyFirstCell)),slotLayer.css("top",headHeight),slotScroller.height(bodyHeight-allDayHeight-1),slotHeight=slotTableFirstInner.height()+1,snapRatio=opt("slotMinutes")/snapMinutes,snapHeight=slotHeight/snapRatio}function setWidth(width){viewWidth=width,colPositions.clear(),colContentPositions.clear();var axisFirstCells=dayHead.find("th:first");allDayTable&&(axisFirstCells=axisFirstCells.add(allDayTable.find("th:first"))),axisFirstCells=axisFirstCells.add(slotTable.find("th:first")),axisWidth=0,setOuterWidth(axisFirstCells.width("").each(function(i,_cell){axisWidth=Math.max(axisWidth,$(_cell).outerWidth())}),axisWidth);var gutterCells=dayTable.find(".fc-agenda-gutter");allDayTable&&(gutterCells=gutterCells.add(allDayTable.find("th.fc-agenda-gutter")));var slotTableWidth=slotScroller[0].clientWidth;gutterWidth=slotScroller.width()-slotTableWidth,gutterWidth?(setOuterWidth(gutterCells,gutterWidth),gutterCells.show().prev().removeClass("fc-last")):gutterCells.hide().prev().addClass("fc-last"),colWidth=Math.floor((slotTableWidth-axisWidth)/colCnt),setOuterWidth(dayHeadCells.slice(0,-1),colWidth)}function resetScroll(){function scroll(){slotScroller.scrollTop(top)}var d0=zeroDate(),scrollDate=cloneDate(d0);scrollDate.setHours(opt("firstHour"));var top=timePosition(d0,scrollDate)+1;scroll(),setTimeout(scroll,0)}function afterRender(){resetScroll()}function dayBind(cells){cells.click(slotClick).mousedown(daySelectionMousedown)}function slotBind(cells){cells.click(slotClick).mousedown(slotSelectionMousedown)}function slotClick(ev){if(!opt("selectable")){var col=Math.min(colCnt-1,Math.floor((ev.pageX-dayTable.offset().left-axisWidth)/colWidth)),date=cellToDate(0,col),rowMatch=this.parentNode.className.match(/fc-slot(\d+)/);if(rowMatch){var mins=parseInt(rowMatch[1])*opt("slotMinutes"),hours=Math.floor(mins/60);date.setHours(hours),date.setMinutes(mins%60+minMinute),trigger("dayClick",dayBodyCells[col],date,!1,ev)}else trigger("dayClick",dayBodyCells[col],date,!0,ev)}}function renderDayOverlay(overlayStart,overlayEnd,refreshCoordinateGrid){refreshCoordinateGrid&&coordinateGrid.build();for(var segments=rangeToSegments(overlayStart,overlayEnd),i=0;i<segments.length;i++){var segment=segments[i];dayBind(renderCellOverlay(segment.row,segment.leftCol,segment.row,segment.rightCol))}}function renderCellOverlay(row0,col0,row1,col1){var rect=coordinateGrid.rect(row0,col0,row1,col1,slotLayer);return renderOverlay(rect,slotLayer)}function renderSlotOverlay(overlayStart,overlayEnd){for(var i=0;colCnt>i;i++){var dayStart=cellToDate(0,i),dayEnd=addDays(cloneDate(dayStart),1),stretchStart=new Date(Math.max(dayStart,overlayStart)),stretchEnd=new Date(Math.min(dayEnd,overlayEnd));if(stretchEnd>stretchStart){var rect=coordinateGrid.rect(0,i,0,i,slotContainer),top=timePosition(dayStart,stretchStart),bottom=timePosition(dayStart,stretchEnd);rect.top=top,rect.height=bottom-top,slotBind(renderOverlay(rect,slotContainer))}}}function colLeft(col){return colPositions.left(col)}function colContentLeft(col){return colContentPositions.left(col)}function colRight(col){return colPositions.right(col)}function colContentRight(col){return colContentPositions.right(col)}function getIsCellAllDay(cell){return opt("allDaySlot")&&!cell.row}function realCellToDate(cell){var d=cellToDate(0,cell.col),slotIndex=cell.row;return opt("allDaySlot")&&slotIndex--,slotIndex>=0&&addMinutes(d,minMinute+slotIndex*snapMinutes),d}function timePosition(day,time){if(day=cloneDate(day,!0),time<addMinutes(cloneDate(day),minMinute))return 0;if(time>=addMinutes(cloneDate(day),maxMinute))return slotTable.height();var slotMinutes=opt("slotMinutes"),minutes=60*time.getHours()+time.getMinutes()-minMinute,slotI=Math.floor(minutes/slotMinutes),slotTop=slotTopCache[slotI];return slotTop===undefined&&(slotTop=slotTopCache[slotI]=slotTable.find("tr").eq(slotI).find("td div")[0].offsetTop),Math.max(0,Math.round(slotTop-1+slotHeight*(minutes%slotMinutes/slotMinutes)))}function getAllDayRow(){return allDayRow}function defaultEventEnd(event){var start=cloneDate(event.start);return event.allDay?start:addMinutes(start,opt("defaultEventMinutes"))}function defaultSelectionEnd(startDate,allDay){return allDay?cloneDate(startDate):addMinutes(cloneDate(startDate),opt("slotMinutes"))}function renderSelection(startDate,endDate,allDay){allDay?opt("allDaySlot")&&renderDayOverlay(startDate,addDays(cloneDate(endDate),1),!0):renderSlotSelection(startDate,endDate)}function renderSlotSelection(startDate,endDate){var helperOption=opt("selectHelper");if(coordinateGrid.build(),helperOption){var col=dateToCell(startDate).col;if(col>=0&&colCnt>col){var rect=coordinateGrid.rect(0,col,0,col,slotContainer),top=timePosition(startDate,startDate),bottom=timePosition(startDate,endDate);if(bottom>top){if(rect.top=top,rect.height=bottom-top,rect.left+=2,rect.width-=5,$.isFunction(helperOption)){var helperRes=helperOption(startDate,endDate);helperRes&&(rect.position="absolute",selectionHelper=$(helperRes).css(rect).appendTo(slotContainer))}else rect.isStart=!0,rect.isEnd=!0,selectionHelper=$(slotSegHtml({title:"",start:startDate,end:endDate,className:["fc-select-helper"],editable:!1},rect)),selectionHelper.css("opacity",opt("dragOpacity"));selectionHelper&&(slotBind(selectionHelper),slotContainer.append(selectionHelper),setOuterWidth(selectionHelper,rect.width,!0),setOuterHeight(selectionHelper,rect.height,!0))}}}else renderSlotOverlay(startDate,endDate)}function clearSelection(){clearOverlays(),selectionHelper&&(selectionHelper.remove(),selectionHelper=null)}function slotSelectionMousedown(ev){if(1==ev.which&&opt("selectable")){unselect(ev);var dates;hoverListener.start(function(cell,origCell){if(clearSelection(),cell&&cell.col==origCell.col&&!getIsCellAllDay(cell)){var d1=realCellToDate(origCell),d2=realCellToDate(cell);dates=[d1,addMinutes(cloneDate(d1),snapMinutes),d2,addMinutes(cloneDate(d2),snapMinutes)].sort(dateCompare),renderSlotSelection(dates[0],dates[3])}else dates=null},ev),$(document).one("mouseup",function(ev){hoverListener.stop(),dates&&(+dates[0]==+dates[1]&&reportDayClick(dates[0],!1,ev),reportSelection(dates[0],dates[3],!1,ev))})}}function reportDayClick(date,allDay,ev){trigger("dayClick",dayBodyCells[dateToCell(date).col],date,allDay,ev)}function dragStart(_dragElement,ev){hoverListener.start(function(cell){if(clearOverlays(),cell)if(getIsCellAllDay(cell))renderCellOverlay(cell.row,cell.col,cell.row,cell.col);else{var d1=realCellToDate(cell),d2=addMinutes(cloneDate(d1),opt("defaultEventMinutes"));renderSlotOverlay(d1,d2)}},ev)}function dragStop(_dragElement,ev,ui){var cell=hoverListener.stop();clearOverlays(),cell&&trigger("drop",_dragElement,realCellToDate(cell),getIsCellAllDay(cell),ev,ui)}var t=this;t.renderAgenda=renderAgenda,t.setWidth=setWidth,t.setHeight=setHeight,t.afterRender=afterRender,t.defaultEventEnd=defaultEventEnd,t.timePosition=timePosition,t.getIsCellAllDay=getIsCellAllDay,t.allDayRow=getAllDayRow,t.getCoordinateGrid=function(){return coordinateGrid},t.getHoverListener=function(){return hoverListener},t.colLeft=colLeft,t.colRight=colRight,t.colContentLeft=colContentLeft,t.colContentRight=colContentRight,t.getDaySegmentContainer=function(){return daySegmentContainer},t.getSlotSegmentContainer=function(){return slotSegmentContainer},t.getMinMinute=function(){return minMinute},t.getMaxMinute=function(){return maxMinute},t.getSlotContainer=function(){return slotContainer},t.getRowCnt=function(){return 1},t.getColCnt=function(){return colCnt},t.getColWidth=function(){return colWidth},t.getSnapHeight=function(){return snapHeight},t.getSnapMinutes=function(){return snapMinutes},t.defaultSelectionEnd=defaultSelectionEnd,t.renderDayOverlay=renderDayOverlay,t.renderSelection=renderSelection,t.clearSelection=clearSelection,t.reportDayClick=reportDayClick,t.dragStart=dragStart,t.dragStop=dragStop,View.call(t,element,calendar,viewName),OverlayManager.call(t),SelectionManager.call(t),AgendaEventRenderer.call(t);var dayTable,dayHead,dayHeadCells,dayBody,dayBodyCells,dayBodyCellInners,dayBodyCellContentInners,dayBodyFirstCell,dayBodyFirstCellStretcher,slotLayer,daySegmentContainer,allDayTable,allDayRow,slotScroller,slotContainer,slotSegmentContainer,slotTable,slotTableFirstInner,selectionHelper,viewWidth,viewHeight,axisWidth,colWidth,gutterWidth,slotHeight,snapMinutes,snapRatio,snapHeight,colCnt,slotCnt,coordinateGrid,hoverListener,colPositions,colContentPositions,tm,rtl,minMinute,maxMinute,colFormat,showWeekNumbers,weekNumberTitle,weekNumberFormat,opt=t.opt,trigger=t.trigger,renderOverlay=t.renderOverlay,clearOverlays=t.clearOverlays,reportSelection=t.reportSelection,unselect=t.unselect,daySelectionMousedown=t.daySelectionMousedown,slotSegHtml=t.slotSegHtml,cellToDate=t.cellToDate,dateToCell=t.dateToCell,rangeToSegments=t.rangeToSegments,formatDate=calendar.formatDate,slotTopCache={};disableTextSelection(element.addClass("fc-agenda")),coordinateGrid=new CoordinateGrid(function(rows,cols){function constrain(n){return Math.max(slotScrollerTop,Math.min(slotScrollerBottom,n))}var e,n,p;dayHeadCells.each(function(i,_e){e=$(_e),n=e.offset().left,i&&(p[1]=n),p=[n],cols[i]=p}),p[1]=n+e.outerWidth(),opt("allDaySlot")&&(e=allDayRow,n=e.offset().top,rows[0]=[n,n+e.outerHeight()]);for(var slotTableTop=slotContainer.offset().top,slotScrollerTop=slotScroller.offset().top,slotScrollerBottom=slotScrollerTop+slotScroller.outerHeight(),i=0;slotCnt*snapRatio>i;i++)rows.push([constrain(slotTableTop+snapHeight*i),constrain(slotTableTop+snapHeight*(i+1))])}),hoverListener=new HoverListener(coordinateGrid),colPositions=new HorizontalPositionCache(function(col){return dayBodyCellInners.eq(col)}),colContentPositions=new HorizontalPositionCache(function(col){return dayBodyCellContentInners.eq(col)})}function AgendaEventRenderer(){function renderEvents(events,modifiedEventId){var i,len=events.length,dayEvents=[],slotEvents=[];for(i=0;len>i;i++)events[i].allDay?dayEvents.push(events[i]):slotEvents.push(events[i]);opt("allDaySlot")&&(renderDayEvents(dayEvents,modifiedEventId),setHeight()),renderSlotSegs(compileSlotSegs(slotEvents),modifiedEventId)}function clearEvents(){getDaySegmentContainer().empty(),getSlotSegmentContainer().empty()}function compileSlotSegs(events){var d,i,col,j,level,k,seg,colCnt=getColCnt(),minMinute=getMinMinute(),maxMinute=getMaxMinute(),visEventEnds=$.map(events,slotEventEnd),segs=[];for(i=0;colCnt>i;i++)for(d=cellToDate(0,i),addMinutes(d,minMinute),col=stackAgendaSegs(sliceSegs(events,visEventEnds,d,addMinutes(cloneDate(d),maxMinute-minMinute))),countForwardSegs(col),j=0;j<col.length;j++)for(level=col[j],k=0;k<level.length;k++)seg=level[k],seg.col=i,seg.level=j,segs.push(seg);return segs}function sliceSegs(events,visEventEnds,start,end){var i,event,eventStart,eventEnd,segStart,segEnd,isStart,isEnd,segs=[],len=events.length;for(i=0;len>i;i++)event=events[i],eventStart=event.start,eventEnd=visEventEnds[i],eventEnd>start&&end>eventStart&&(start>eventStart?(segStart=cloneDate(start),isStart=!1):(segStart=eventStart,isStart=!0),eventEnd>end?(segEnd=cloneDate(end),isEnd=!1):(segEnd=eventEnd,isEnd=!0),segs.push({event:event,start:segStart,end:segEnd,isStart:isStart,isEnd:isEnd,msLength:segEnd-segStart}));return segs.sort(segmentCompare)}function slotEventEnd(event){return event.end?cloneDate(event.end):addMinutes(cloneDate(event.start),opt("defaultEventMinutes"))}function renderSlotSegs(segs,modifiedEventId){var i,seg,event,top,bottom,colI,levelI,forward,leftmost,availWidth,outerWidth,left,eventElements,eventElement,triggerRes,titleElement,height,rtl,dis,segCnt=segs.length,html="",slotSegmentContainer=getSlotSegmentContainer();for(dis=(rtl=opt("isRTL"))?-1:1,i=0;segCnt>i;i++)seg=segs[i],event=seg.event,top=timePosition(seg.start,seg.start),bottom=timePosition(seg.start,seg.end),colI=seg.col,levelI=seg.level,forward=seg.forward||0,leftmost=colContentLeft(colI),availWidth=colContentRight(colI)-leftmost,availWidth=Math.min(availWidth-6,.95*availWidth),outerWidth=levelI?availWidth/(levelI+forward+1):forward?2*(availWidth/(forward+1)-6):availWidth,left=leftmost+availWidth/(levelI+forward+1)*levelI*dis+(rtl?availWidth-outerWidth:0),seg.top=top,seg.left=left,seg.outerWidth=outerWidth,seg.outerHeight=bottom-top,html+=slotSegHtml(event,seg);for(slotSegmentContainer[0].innerHTML=html,eventElements=slotSegmentContainer.children(),i=0;segCnt>i;i++)seg=segs[i],event=seg.event,eventElement=$(eventElements[i]),triggerRes=trigger("eventRender",event,event,eventElement),triggerRes===!1?eventElement.remove():(triggerRes&&triggerRes!==!0&&(eventElement.remove(),eventElement=$(triggerRes).css({position:"absolute",top:seg.top,left:seg.left}).appendTo(slotSegmentContainer)),seg.element=eventElement,event._id===modifiedEventId?bindSlotSeg(event,eventElement,seg):eventElement[0]._fci=i,reportEventElement(event,eventElement));for(lazySegBind(slotSegmentContainer,segs,bindSlotSeg),i=0;segCnt>i;i++)seg=segs[i],(eventElement=seg.element)&&(seg.vsides=vsides(eventElement,!0),seg.hsides=hsides(eventElement,!0),titleElement=eventElement.find(".fc-event-title"),titleElement.length&&(seg.contentTop=titleElement[0].offsetTop));for(i=0;segCnt>i;i++)seg=segs[i],(eventElement=seg.element)&&(eventElement[0].style.width=Math.max(0,seg.outerWidth-seg.hsides)+"px",height=Math.max(0,seg.outerHeight-seg.vsides),eventElement[0].style.height=height+"px",event=seg.event,seg.contentTop!==undefined&&height-seg.contentTop<10&&(eventElement.find("div.fc-event-time").text(formatDate(event.start,opt("timeFormat"))+" - "+event.title),eventElement.find("div.fc-event-title").remove()),trigger("eventAfterRender",event,event,eventElement))}function slotSegHtml(event,seg){var html="<",url=event.url,skinCss=getSkinCss(event,opt),classes=["fc-event","fc-event-vert"];return isEventDraggable(event)&&classes.push("fc-event-draggable"),seg.isStart&&classes.push("fc-event-start"),seg.isEnd&&classes.push("fc-event-end"),classes=classes.concat(event.className),event.source&&(classes=classes.concat(event.source.className||[])),html+=url?"a href='"+htmlEscape(event.url)+"'":"div",html+=" class='"+classes.join(" ")+"'"+" style="+"'"+"position:absolute;"+"top:"+seg.top+"px;"+"left:"+seg.left+"px;"+skinCss+"'"+">"+"<div class='fc-event-inner'>"+"<div class='fc-event-time'>"+htmlEscape(formatDates(event.start,event.end,opt("timeFormat")))+"</div>"+"<div class='fc-event-title'>"+htmlEscape(event.title||"")+"</div>"+"</div>"+"<div class='fc-event-bg'></div>",seg.isEnd&&isEventResizable(event)&&(html+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),html+="</"+(url?"a":"div")+">"}function bindSlotSeg(event,eventElement,seg){var timeElement=eventElement.find("div.fc-event-time");isEventDraggable(event)&&draggableSlotEvent(event,eventElement,timeElement),seg.isEnd&&isEventResizable(event)&&resizableSlotEvent(event,eventElement,timeElement),eventElementHandlers(event,eventElement)}function draggableDayEvent(event,eventElement,seg){function resetElement(){allDay||(eventElement.width(origWidth).height("").draggable("option","grid",null),allDay=!0)}var origWidth,revert,dayDelta,isStart=seg.isStart,allDay=!0,hoverListener=getHoverListener(),colWidth=getColWidth(),snapHeight=getSnapHeight(),snapMinutes=getSnapMinutes(),minMinute=getMinMinute();eventElement.draggable({opacity:opt("dragOpacity","month"),revertDuration:opt("dragRevertDuration"),start:function(ev,ui){trigger("eventDragStart",eventElement,event,ev,ui),hideEvents(event,eventElement),origWidth=eventElement.width(),hoverListener.start(function(cell,origCell){if(clearOverlays(),cell){revert=!1;var origDate=cellToDate(0,origCell.col),date=cellToDate(0,cell.col);dayDelta=dayDiff(date,origDate),cell.row?isStart?allDay&&(eventElement.width(colWidth-10),setOuterHeight(eventElement,snapHeight*Math.round((event.end?(event.end-event.start)/MINUTE_MS:opt("defaultEventMinutes"))/snapMinutes)),eventElement.draggable("option","grid",[colWidth,1]),allDay=!1):revert=!0:(renderDayOverlay(addDays(cloneDate(event.start),dayDelta),addDays(exclEndDay(event),dayDelta)),resetElement()),revert=revert||allDay&&!dayDelta}else resetElement(),revert=!0;eventElement.draggable("option","revert",revert)},ev,"drag")},stop:function(ev,ui){if(hoverListener.stop(),clearOverlays(),trigger("eventDragStop",eventElement,event,ev,ui),revert)resetElement(),eventElement.css("filter",""),showEvents(event,eventElement);else{var minuteDelta=0;allDay||(minuteDelta=Math.round((eventElement.offset().top-getSlotContainer().offset().top)/snapHeight)*snapMinutes+minMinute-(60*event.start.getHours()+event.start.getMinutes())),eventDrop(this,event,dayDelta,minuteDelta,allDay,ev,ui)}}})}function draggableSlotEvent(event,eventElement,timeElement){function updateUI(){clearOverlays(),isInBounds&&(isAllDay?(timeElement.hide(),eventElement.draggable("option","grid",null),renderDayOverlay(addDays(cloneDate(event.start),dayDelta),addDays(exclEndDay(event),dayDelta))):(updateTimeText(minuteDelta),timeElement.css("display",""),eventElement.draggable("option","grid",[colWidth,snapHeight])))}function updateTimeText(minuteDelta){var newEnd,newStart=addMinutes(cloneDate(event.start),minuteDelta);event.end&&(newEnd=addMinutes(cloneDate(event.end),minuteDelta)),timeElement.text(formatDates(newStart,newEnd,opt("timeFormat")))}var origPosition,origCell,isInBounds,prevIsInBounds,isAllDay,prevIsAllDay,colDelta,prevColDelta,dayDelta,minuteDelta,prevMinuteDelta,coordinateGrid=t.getCoordinateGrid(),colCnt=getColCnt(),colWidth=getColWidth(),snapHeight=getSnapHeight(),snapMinutes=getSnapMinutes();eventElement.draggable({scroll:!1,grid:[colWidth,snapHeight],axis:1==colCnt?"y":!1,opacity:opt("dragOpacity"),revertDuration:opt("dragRevertDuration"),start:function(ev,ui){trigger("eventDragStart",eventElement,event,ev,ui),hideEvents(event,eventElement),coordinateGrid.build(),origPosition=eventElement.position(),origCell=coordinateGrid.cell(ev.pageX,ev.pageY),isInBounds=prevIsInBounds=!0,isAllDay=prevIsAllDay=getIsCellAllDay(origCell),colDelta=prevColDelta=0,dayDelta=0,minuteDelta=prevMinuteDelta=0},drag:function(ev,ui){var cell=coordinateGrid.cell(ev.pageX,ev.pageY);if(isInBounds=!!cell){if(isAllDay=getIsCellAllDay(cell),colDelta=Math.round((ui.position.left-origPosition.left)/colWidth),colDelta!=prevColDelta){var origDate=cellToDate(0,origCell.col),col=origCell.col+colDelta;col=Math.max(0,col),col=Math.min(colCnt-1,col);var date=cellToDate(0,col);dayDelta=dayDiff(date,origDate)}isAllDay||(minuteDelta=Math.round((ui.position.top-origPosition.top)/snapHeight)*snapMinutes)}(isInBounds!=prevIsInBounds||isAllDay!=prevIsAllDay||colDelta!=prevColDelta||minuteDelta!=prevMinuteDelta)&&(updateUI(),prevIsInBounds=isInBounds,prevIsAllDay=isAllDay,prevColDelta=colDelta,prevMinuteDelta=minuteDelta),eventElement.draggable("option","revert",!isInBounds)},stop:function(ev,ui){clearOverlays(),trigger("eventDragStop",eventElement,event,ev,ui),isInBounds&&(isAllDay||dayDelta||minuteDelta)?eventDrop(this,event,dayDelta,isAllDay?0:minuteDelta,isAllDay,ev,ui):(isInBounds=!0,isAllDay=!1,colDelta=0,dayDelta=0,minuteDelta=0,updateUI(),eventElement.css("filter",""),eventElement.css(origPosition),showEvents(event,eventElement))}})}function resizableSlotEvent(event,eventElement,timeElement){var snapDelta,prevSnapDelta,snapHeight=getSnapHeight(),snapMinutes=getSnapMinutes();eventElement.resizable({handles:{s:".ui-resizable-handle"},grid:snapHeight,start:function(ev,ui){snapDelta=prevSnapDelta=0,hideEvents(event,eventElement),trigger("eventResizeStart",this,event,ev,ui)},resize:function(ev,ui){snapDelta=Math.round((Math.max(snapHeight,eventElement.height())-ui.originalSize.height)/snapHeight),snapDelta!=prevSnapDelta&&(timeElement.text(formatDates(event.start,snapDelta||event.end?addMinutes(eventEnd(event),snapMinutes*snapDelta):null,opt("timeFormat"))),prevSnapDelta=snapDelta)},stop:function(ev,ui){trigger("eventResizeStop",this,event,ev,ui),snapDelta?eventResize(this,event,0,snapMinutes*snapDelta,ev,ui):showEvents(event,eventElement)}})}var t=this;t.renderEvents=renderEvents,t.clearEvents=clearEvents,t.slotSegHtml=slotSegHtml,DayEventRenderer.call(t);var opt=t.opt,trigger=t.trigger,isEventDraggable=t.isEventDraggable,isEventResizable=t.isEventResizable,eventEnd=t.eventEnd,eventElementHandlers=t.eventElementHandlers,setHeight=t.setHeight,getDaySegmentContainer=t.getDaySegmentContainer,getSlotSegmentContainer=t.getSlotSegmentContainer,getHoverListener=t.getHoverListener,getMaxMinute=t.getMaxMinute,getMinMinute=t.getMinMinute,timePosition=t.timePosition,getIsCellAllDay=t.getIsCellAllDay,colContentLeft=t.colContentLeft,colContentRight=t.colContentRight,cellToDate=t.cellToDate,segmentCompare=t.segmentCompare,getColCnt=t.getColCnt,getColWidth=t.getColWidth,getSnapHeight=t.getSnapHeight,getSnapMinutes=t.getSnapMinutes,getSlotContainer=t.getSlotContainer,reportEventElement=t.reportEventElement,showEvents=t.showEvents,hideEvents=t.hideEvents,eventDrop=t.eventDrop,eventResize=t.eventResize,renderDayOverlay=t.renderDayOverlay,clearOverlays=t.clearOverlays,renderDayEvents=t.renderDayEvents,calendar=t.calendar,formatDate=calendar.formatDate,formatDates=calendar.formatDates;
t.draggableDayEvent=draggableDayEvent}function stackAgendaSegs(segs){var i,seg,j,collide,k,levels=[],len=segs.length;for(i=0;len>i;i++){for(seg=segs[i],j=0;;){if(collide=!1,levels[j])for(k=0;k<levels[j].length;k++)if(agendaSegsCollide(levels[j][k],seg)){collide=!0;break}if(!collide)break;j++}levels[j]?levels[j].push(seg):levels[j]=[seg]}return levels}function countForwardSegs(levels){var i,j,k,level,segForward,segBack;for(i=levels.length-1;i>0;i--)for(level=levels[i],j=0;j<level.length;j++)for(segForward=level[j],k=0;k<levels[i-1].length;k++)segBack=levels[i-1][k],agendaSegsCollide(segForward,segBack)&&(segBack.forward=Math.max(segBack.forward||0,(segForward.forward||0)+1))}function agendaSegsCollide(seg1,seg2){return seg1.end>seg2.start&&seg1.start<seg2.end}function ResourceDayView(element,calendar){function render(date,delta){delta&&addDays(date,delta),skipHiddenDays(date,0>delta?-1:1);var start=cloneDate(date,!0),end=addDays(cloneDate(start),1);t.title=formatDate(date,opt("titleFormat")),t.start=t.visStart=start,t.end=t.visEnd=end,renderResource(getResources().length)}var t=this;t.render=render,ResourceView.call(t,element,calendar,"resourceDay");var opt=t.opt,renderResource=t.renderResource,skipHiddenDays=t.skipHiddenDays,formatDate=calendar.formatDate,getResources=t.getResources}function ResourceView(element,calendar,viewName){function renderResource(c){colCnt=c,updateOptions(),dayTable?buildDayTable():buildSkeleton()}function updateOptions(){tm=opt("theme")?"ui":"fc",rtl=opt("isRTL"),minMinute=parseTime(opt("minTime")),maxMinute=parseTime(opt("maxTime")),colFormat=opt("columnFormat"),showWeekNumbers=opt("weekNumbers"),weekNumberTitle=opt("weekNumberTitle"),weekNumberFormat="iso"!=opt("weekNumberCalculation")?"w":"W",snapMinutes=opt("snapMinutes")||opt("slotMinutes")}function buildSkeleton(){var s,d,i,maxd,minutes,headerClass=tm+"-widget-header",contentClass=tm+"-widget-content",slotNormal=0==opt("slotMinutes")%15;for(buildDayTable(),slotLayer=$("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(element),opt("allDaySlot")?(daySegmentContainer=$("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(slotLayer),s="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+headerClass+" fc-agenda-axis'>"+opt("allDayText")+"</th>"+"<td>"+"<div class='fc-day-content'><div style='position:relative'/></div>"+"</td>"+"<th class='"+headerClass+" fc-agenda-gutter'>&nbsp;</th>"+"</tr>"+"</table>",allDayTable=$(s).appendTo(slotLayer),allDayRow=allDayTable.find("tr"),dayBind(allDayRow.find("td")),slotLayer.append("<div class='fc-agenda-divider "+headerClass+"'>"+"<div class='fc-agenda-divider-inner'/>"+"</div>")):daySegmentContainer=$([]),slotScroller=$("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(slotLayer),slotContainer=$("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(slotScroller),slotSegmentContainer=$("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(slotContainer),s="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",d=zeroDate(),maxd=addMinutes(cloneDate(d),maxMinute),addMinutes(d,minMinute),slotCnt=0,i=0;maxd>d;i++)minutes=d.getMinutes(),s+="<tr class='fc-slot"+i+" "+(minutes?"fc-minor":"")+"'>"+"<th class='fc-agenda-axis "+headerClass+"'>"+(slotNormal&&minutes?"&nbsp;":formatDate(d,opt("axisFormat")))+"</th>"+"<td class='"+contentClass+"'>"+"<div style='position:relative'>&nbsp;</div>"+"</td>"+"</tr>",addMinutes(d,opt("slotMinutes")),slotCnt++;s+="</tbody></table>",slotTable=$(s).appendTo(slotContainer),slotTableFirstInner=slotTable.find("div:first"),slotBind(slotTable.find("td"))}function buildDayTable(){var html=buildDayTableHTML();dayTable&&dayTable.remove(),dayTable=$(html).appendTo(element),dayHead=dayTable.find("thead"),dayHeadCells=dayHead.find("th").slice(1,-1),dayBody=dayTable.find("tbody"),dayBodyCells=dayBody.find("td").slice(0,-1),dayBodyCellInners=dayBodyCells.find("> div"),dayBodyCellContentInners=dayBodyCells.find(".fc-day-content > div"),dayBodyFirstCell=dayBodyCells.eq(0),dayBodyFirstCellStretcher=dayBodyCellInners.eq(0),markFirstLast(dayHead.add(dayHead.find("tr"))),markFirstLast(dayBody.add(dayBody.find("tr")))}function buildDayTableHTML(){var html="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'>"+buildDayTableHeadHTML()+buildDayTableBodyHTML()+"</table>";return html}function buildDayTableHeadHTML(){var date,weekText,col,headerClass=tm+"-widget-header",html="";for(html+="<thead><tr>",showWeekNumbers?(weekText=formatDate(date,weekNumberFormat),rtl?weekText+=weekNumberTitle:weekText=weekNumberTitle+weekText,html+="<th class='fc-agenda-axis fc-week-number "+headerClass+"'>"+htmlEscape(weekText)+"</th>"):html+="<th class='fc-agenda-axis "+headerClass+"'>&nbsp;</th>",col=0;colCnt>col;col++){var classNames=["fc-col"+col,resources()[col].className,headerClass];html+="<th class='"+classNames.join(" ")+"'>"+htmlEscape(resources()[col].name)+"</th>"}return html+="<th class='fc-agenda-gutter "+headerClass+"'>&nbsp;</th>"+"</tr>"+"</thead>"}function buildDayTableBodyHTML(){var date,col,cellsHTML,cellHTML,classNames,headerClass=tm+"-widget-header",contentClass=tm+"-widget-content",today=clearTime(new Date),html="";for(html+="<tbody><tr><th class='fc-agenda-axis "+headerClass+"'>&nbsp;</th>",cellsHTML="",col=0;colCnt>col;col++)date=cloneDate(t.visStart),classNames=["fc-col"+col,resources()[col].className,contentClass],+date==+today?classNames.push(tm+"-state-highlight","fc-today"):today>date?classNames.push("fc-past"):classNames.push("fc-future"),cellHTML="<td class='"+classNames.join(" ")+"'>"+"<div>"+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>",cellsHTML+=cellHTML;return html+=cellsHTML,html+="<td class='fc-agenda-gutter "+contentClass+"'>&nbsp;</td>"+"</tr>"+"</tbody>"}function setHeight(height){height===undefined&&(height=viewHeight),viewHeight=height,slotTopCache={};var headHeight=dayBody.position().top,allDayHeight=slotScroller.position().top,bodyHeight=Math.min(height-headHeight,slotTable.height()+allDayHeight+1);dayBodyFirstCellStretcher.height(bodyHeight-vsides(dayBodyFirstCell)),slotLayer.css("top",headHeight),slotScroller.height(bodyHeight-allDayHeight-1),slotHeight=slotTableFirstInner.height()+1,snapRatio=opt("slotMinutes")/snapMinutes,snapHeight=slotHeight/snapRatio}function setWidth(width){viewWidth=width,colPositions.clear(),colContentPositions.clear();var axisFirstCells=dayHead.find("th:first");allDayTable&&(axisFirstCells=axisFirstCells.add(allDayTable.find("th:first"))),axisFirstCells=axisFirstCells.add(slotTable.find("th:first")),axisWidth=0,setOuterWidth(axisFirstCells.width("").each(function(i,_cell){axisWidth=Math.max(axisWidth,$(_cell).outerWidth())}),axisWidth);var gutterCells=dayTable.find(".fc-agenda-gutter");allDayTable&&(gutterCells=gutterCells.add(allDayTable.find("th.fc-agenda-gutter")));var slotTableWidth=slotScroller[0].clientWidth;gutterWidth=slotScroller.width()-slotTableWidth,gutterWidth?(setOuterWidth(gutterCells,gutterWidth),gutterCells.show().prev().removeClass("fc-last")):gutterCells.hide().prev().addClass("fc-last"),colWidth=Math.floor((slotTableWidth-axisWidth)/colCnt),setOuterWidth(dayHeadCells.slice(0,-1),colWidth)}function resetScroll(){function scroll(){slotScroller.scrollTop(top)}var d0=zeroDate(),scrollDate=cloneDate(d0);scrollDate.setHours(opt("firstHour"));var top=timePosition(d0,scrollDate)+1;scroll(),setTimeout(scroll,0)}function afterRender(){resetScroll()}function dayBind(cells){cells.click(slotClick).mousedown(daySelectionMousedown)}function slotBind(cells){cells.click(slotClick).mousedown(slotSelectionMousedown)}function slotClick(ev){if(!opt("selectable")){var col=Math.min(colCnt-1,Math.floor((ev.pageX-dayTable.offset().left-axisWidth)/colWidth)),date=cellToDate(0,0),rowMatch=this.parentNode.className.match(/fc-slot(\d+)/);if(ev.data=resources()[col],rowMatch){var mins=parseInt(rowMatch[1])*opt("slotMinutes"),hours=Math.floor(mins/60);date.setHours(hours),date.setMinutes(mins%60+minMinute),trigger("dayClick",dayBodyCells[col],date,!1,ev)}else trigger("dayClick",dayBodyCells[col],date,!0,ev)}}function renderDayOverlay(overlayStart,overlayEnd,refreshCoordinateGrid,col){var allDayRow=0;refreshCoordinateGrid&&coordinateGrid.build(),col||(col=0),dayBind(renderCellOverlay(allDayRow,col,allDayRow,col))}function renderCellOverlay(row0,col0,row1,col1){var rect=coordinateGrid.rect(row0,col0,row1,col1,slotLayer);return renderOverlay(rect,slotLayer)}function renderSlotOverlay(overlayStart,overlayEnd,col){var dayStart=cellToDate(0,0),dayEnd=addDays(cloneDate(dayStart),1),stretchStart=new Date(Math.max(dayStart,overlayStart)),stretchEnd=new Date(Math.min(dayEnd,overlayEnd));if(stretchEnd>stretchStart){var rect=coordinateGrid.rect(0,col,0,col,slotContainer),top=timePosition(dayStart,stretchStart),bottom=timePosition(dayStart,stretchEnd);rect.top=top,rect.height=bottom-top,slotBind(renderOverlay(rect,slotContainer))}}function colLeft(col){return colPositions.left(col)}function colContentLeft(col){return colContentPositions.left(col)}function colRight(col){return colPositions.right(col)}function colContentRight(col){return colContentPositions.right(col)}function getIsCellAllDay(cell){return opt("allDaySlot")&&!cell.row}function realCellToDate(cell){var d=cellToDate(0,0),slotIndex=cell.row;return opt("allDaySlot")&&slotIndex--,slotIndex>=0&&addMinutes(d,minMinute+slotIndex*snapMinutes),d}function timePosition(day,time){if(day=cloneDate(day,!0),time<addMinutes(cloneDate(day),minMinute))return 0;if(time>=addMinutes(cloneDate(day),maxMinute))return slotTable.height();var slotMinutes=opt("slotMinutes"),minutes=60*time.getHours()+time.getMinutes()-minMinute,slotI=Math.floor(minutes/slotMinutes),slotTop=slotTopCache[slotI];return slotTop===undefined&&(slotTop=slotTopCache[slotI]=slotTable.find("tr").eq(slotI).find("td div")[0].offsetTop),Math.max(0,Math.round(slotTop-1+slotHeight*(minutes%slotMinutes/slotMinutes)))}function getAllDayRow(){return allDayRow}function defaultEventEnd(event){var start=cloneDate(event.start);return event.allDay?start:addMinutes(start,opt("defaultEventMinutes"))}function defaultSelectionEnd(startDate,allDay){return allDay?cloneDate(startDate):addMinutes(cloneDate(startDate),opt("slotMinutes"))}function renderSelection(startDate,endDate,allDay,col){allDay?opt("allDaySlot")&&renderDayOverlay(startDate,endDate,!0,col):renderSlotSelection(startDate,endDate)}function renderSlotSelection(startDate,endDate,col){var helperOption=opt("selectHelper");if(coordinateGrid.build(),helperOption){if(col=col||dateToCell(startDate).col,col>=0&&colCnt>col){var rect=coordinateGrid.rect(0,col,0,col,slotContainer),top=timePosition(startDate,startDate),bottom=timePosition(startDate,endDate);if(bottom>top){if(rect.top=top,rect.height=bottom-top,rect.left+=2,rect.width-=5,$.isFunction(helperOption)){var helperRes=helperOption(startDate,endDate);helperRes&&(rect.position="absolute",selectionHelper=$(helperRes).css(rect).appendTo(slotContainer))}else rect.isStart=!0,rect.isEnd=!0,selectionHelper=$(slotSegHtml({title:"",start:startDate,end:endDate,className:["fc-select-helper"],editable:!1},rect)),selectionHelper.css("opacity",opt("dragOpacity"));selectionHelper&&(slotBind(selectionHelper),slotContainer.append(selectionHelper),setOuterWidth(selectionHelper,rect.width,!0),setOuterHeight(selectionHelper,rect.height,!0))}}}else renderSlotOverlay(startDate,endDate,col)}function clearSelection(){clearOverlays(),selectionHelper&&(selectionHelper.remove(),selectionHelper=null)}function daySelectionMousedown(ev){t.cellToDate;var col,getIsCellAllDay=t.getIsCellAllDay,hoverListener=t.getHoverListener(),reportDayClick=t.reportDayClick;if(1==ev.which&&opt("selectable")){unselect(ev);var dates;hoverListener.start(function(cell,origCell){clearSelection(),cell&&getIsCellAllDay(cell)?(col=cell.col,dates=[realCellToDate(origCell),realCellToDate(cell)].sort(dateCompare),renderSelection(dates[0],dates[1],!0,col)):dates=null},ev),$(document).one("mouseup",function(ev){hoverListener.stop(),dates&&(+dates[0]==+dates[1]&&reportDayClick(dates[0],!0,ev),ev.data=resources()[col],reportSelection(dates[0],dates[1],!0,ev))})}}function slotSelectionMousedown(ev){if(1==ev.which&&opt("selectable")){unselect(ev);var dates,col;hoverListener.start(function(cell,origCell){if(clearSelection(),cell&&cell.col==origCell.col&&!getIsCellAllDay(cell)){col=cell.col;var d1=realCellToDate(origCell),d2=realCellToDate(cell);dates=[d1,addMinutes(cloneDate(d1),snapMinutes),d2,addMinutes(cloneDate(d2),snapMinutes)].sort(dateCompare),renderSlotSelection(dates[0],dates[3],cell.col)}else dates=null},ev),$(document).one("mouseup",function(ev){hoverListener.stop(),dates&&(+dates[0]==+dates[1]&&reportDayClick(dates[0],!1,ev),ev.data=resources()[col],reportSelection(dates[0],dates[3],!1,ev))})}}function reportDayClick(date,allDay,ev){trigger("dayClick",dayBodyCells[dateToCell(date).col],date,allDay,ev)}function dragStart(_dragElement,ev){hoverListener.start(function(cell){if(clearOverlays(),cell)if(getIsCellAllDay(cell))renderCellOverlay(cell.row,cell.col,cell.row,cell.col);else{var d1=realCellToDate(cell),d2=addMinutes(cloneDate(d1),opt("defaultEventMinutes"));renderSlotOverlay(d1,d2,cell.col)}},ev)}function dragStop(_dragElement,ev,ui){var cell=hoverListener.stop();clearOverlays(),cell&&(ev.data=resources()[cell.col],trigger("drop",_dragElement,realCellToDate(cell),getIsCellAllDay(cell),ev,ui))}var t=this;t.renderResource=renderResource,t.setWidth=setWidth,t.setHeight=setHeight,t.afterRender=afterRender,t.defaultEventEnd=defaultEventEnd,t.timePosition=timePosition,t.getIsCellAllDay=getIsCellAllDay,t.allDayRow=getAllDayRow,t.getCoordinateGrid=function(){return coordinateGrid},t.getHoverListener=function(){return hoverListener},t.colLeft=colLeft,t.colRight=colRight,t.colContentLeft=colContentLeft,t.colContentRight=colContentRight,t.getDaySegmentContainer=function(){return daySegmentContainer},t.getSlotSegmentContainer=function(){return slotSegmentContainer},t.getMinMinute=function(){return minMinute},t.getMaxMinute=function(){return maxMinute},t.getSlotContainer=function(){return slotContainer},t.getRowCnt=function(){return 1},t.getColCnt=function(){return colCnt},t.getColWidth=function(){return colWidth},t.getSnapHeight=function(){return snapHeight},t.getSnapMinutes=function(){return snapMinutes},t.defaultSelectionEnd=defaultSelectionEnd,t.renderDayOverlay=renderDayOverlay,t.renderSelection=renderSelection,t.clearSelection=clearSelection,t.reportDayClick=reportDayClick,t.dragStart=dragStart,t.dragStop=dragStop,t.getResources=calendar.fetchResources,View.call(t,element,calendar,viewName),OverlayManager.call(t),SelectionManager.call(t),ResourceEventRenderer.call(t);var opt=t.opt,trigger=t.trigger,renderOverlay=t.renderOverlay,clearOverlays=t.clearOverlays,reportSelection=t.reportSelection,unselect=t.unselect,slotSegHtml=t.slotSegHtml,cellToDate=t.cellToDate,dateToCell=t.dateToCell;t.rangeToSegments;var dayTable,dayHead,dayHeadCells,dayBody,dayBodyCells,dayBodyCellInners,dayBodyCellContentInners,dayBodyFirstCell,dayBodyFirstCellStretcher,slotLayer,daySegmentContainer,allDayTable,allDayRow,slotScroller,slotContainer,slotSegmentContainer,slotTable,slotTableFirstInner,selectionHelper,viewWidth,viewHeight,axisWidth,colWidth,gutterWidth,slotHeight,snapMinutes,snapRatio,snapHeight,colCnt,slotCnt,coordinateGrid,hoverListener,colPositions,colContentPositions,tm,rtl,minMinute,maxMinute,colFormat,showWeekNumbers,weekNumberTitle,weekNumberFormat,formatDate=calendar.formatDate,slotTopCache={},resources=t.getResources;disableTextSelection(element.addClass("fc-agenda")),coordinateGrid=new CoordinateGrid(function(rows,cols){function constrain(n){return Math.max(slotScrollerTop,Math.min(slotScrollerBottom,n))}var e,n,p;dayHeadCells.each(function(i,_e){e=$(_e),n=e.offset().left,i&&(p[1]=n),p=[n],cols[i]=p}),p[1]=n+e.outerWidth(),opt("allDaySlot")&&(e=allDayRow,n=e.offset().top,rows[0]=[n,n+e.outerHeight()]);for(var slotTableTop=slotContainer.offset().top,slotScrollerTop=slotScroller.offset().top,slotScrollerBottom=slotScrollerTop+slotScroller.outerHeight(),i=0;slotCnt*snapRatio>i;i++)rows.push([constrain(slotTableTop+snapHeight*i),constrain(slotTableTop+snapHeight*(i+1))])}),hoverListener=new HoverListener(coordinateGrid),colPositions=new HorizontalPositionCache(function(col){return dayBodyCellInners.eq(col)}),colContentPositions=new HorizontalPositionCache(function(col){return dayBodyCellContentInners.eq(col)})}function ResourceEventRenderer(){function renderEvents(events,modifiedEventId){var i,len=events.length,dayEvents=[],slotEvents=[];for(i=0;len>i;i++)events[i].allDay?dayEvents.push(events[i]):slotEvents.push(events[i]);opt("allDaySlot")&&(renderDayEvents(dayEvents,modifiedEventId),setHeight()),renderSlotSegs(compileSlotSegs(slotEvents),modifiedEventId)}function clearEvents(){getDaySegmentContainer().empty(),getSlotSegmentContainer().empty()}function compileSlotSegs(events){var d,visEventEnds,i,col,j,level,k,seg,colCnt=getColCnt(),minMinute=getMinMinute(),maxMinute=getMaxMinute(),segs=[];for(i=0;colCnt>i;i++){d=cloneDate(t.visStart),addMinutes(d,minMinute);var resourceEvents=eventsForResource(resources()[i],events);for(visEventEnds=$.map(resourceEvents,slotEventEnd),col=stackAgendaSegs(sliceSegs(resourceEvents,visEventEnds,d,addMinutes(cloneDate(d),maxMinute-minMinute))),countForwardSegs(col),j=0;j<col.length;j++)for(level=col[j],k=0;k<level.length;k++)seg=level[k],seg.col=i,seg.level=j,segs.push(seg)}return segs}function sliceSegs(events,visEventEnds,start,end){var i,event,eventStart,eventEnd,segStart,segEnd,isStart,isEnd,segs=[],len=events.length;for(i=0;len>i;i++)event=events[i],eventStart=event.start,eventEnd=visEventEnds[i],eventEnd>start&&end>eventStart&&(start>eventStart?(segStart=cloneDate(start),isStart=!1):(segStart=eventStart,isStart=!0),eventEnd>end?(segEnd=cloneDate(end),isEnd=!1):(segEnd=eventEnd,isEnd=!0),segs.push({event:event,start:segStart,end:segEnd,isStart:isStart,isEnd:isEnd,msLength:segEnd-segStart}));return segs.sort(segmentCompare)}function eventsForResource(resource,events){for(var resourceEvents=[],i=0;i<events.length;i++)events[i].resources&&$.inArray(resource.id,events[i].resources)>=0&&resourceEvents.push(events[i]);return resourceEvents}function slotEventEnd(event){return event.end?cloneDate(event.end):addMinutes(cloneDate(event.start),opt("defaultEventMinutes"))}function renderSlotSegs(segs,modifiedEventId){var i,seg,event,top,bottom,colI,levelI,forward,leftmost,availWidth,outerWidth,left,eventElements,eventElement,triggerRes,titleElement,height,rtl,dis,segCnt=segs.length,html="",slotSegmentContainer=getSlotSegmentContainer();for(dis=(rtl=opt("isRTL"))?-1:1,i=0;segCnt>i;i++)seg=segs[i],event=seg.event,top=timePosition(seg.start,seg.start),bottom=timePosition(seg.start,seg.end),colI=seg.col,levelI=seg.level,forward=seg.forward||0,leftmost=colContentLeft(colI),availWidth=colContentRight(colI)-leftmost,availWidth=Math.min(availWidth-6,.95*availWidth),outerWidth=levelI?availWidth/(levelI+forward+1):forward?2*(availWidth/(forward+1)-6):availWidth,left=leftmost+availWidth/(levelI+forward+1)*levelI*dis+(rtl?availWidth-outerWidth:0),seg.top=top,seg.left=left,seg.outerWidth=outerWidth,seg.outerHeight=bottom-top,html+=slotSegHtml(event,seg);for(slotSegmentContainer[0].innerHTML=html,eventElements=slotSegmentContainer.children(),i=0;segCnt>i;i++)seg=segs[i],event=seg.event,eventElement=$(eventElements[i]),triggerRes=trigger("eventRender",event,event,eventElement),triggerRes===!1?eventElement.remove():(triggerRes&&triggerRes!==!0&&(eventElement.remove(),eventElement=$(triggerRes).css({position:"absolute",top:seg.top,left:seg.left}).appendTo(slotSegmentContainer)),seg.element=eventElement,event._id===modifiedEventId?bindSlotSeg(event,eventElement,seg):eventElement[0]._fci=i,reportEventElement(event,eventElement));for(lazySegBind(slotSegmentContainer,segs,bindSlotSeg),i=0;segCnt>i;i++)seg=segs[i],(eventElement=seg.element)&&(seg.vsides=vsides(eventElement,!0),seg.hsides=hsides(eventElement,!0),titleElement=eventElement.find(".fc-event-title"),titleElement.length&&(seg.contentTop=titleElement[0].offsetTop));for(i=0;segCnt>i;i++)seg=segs[i],(eventElement=seg.element)&&(eventElement[0].style.width=Math.max(0,seg.outerWidth-seg.hsides)+"px",height=Math.max(0,seg.outerHeight-seg.vsides),eventElement[0].style.height=height+"px",event=seg.event,seg.contentTop!==undefined&&height-seg.contentTop<10&&(eventElement.find("div.fc-event-time").text(formatDate(event.start,opt("timeFormat"))+" - "+event.title),eventElement.find("div.fc-event-title").remove()),trigger("eventAfterRender",event,event,eventElement))}function slotSegHtml(event,seg){var html="<",url=event.url,skinCss=getSkinCss(event,opt),classes=["fc-event","fc-event-vert"];return isEventDraggable(event)&&classes.push("fc-event-draggable"),seg.isStart&&classes.push("fc-event-start"),seg.isEnd&&classes.push("fc-event-end"),classes=classes.concat(event.className),event.source&&(classes=classes.concat(event.source.className||[])),html+=url?"a href='"+htmlEscape(event.url)+"'":"div",html+=" class='"+classes.join(" ")+"'"+" style="+"'"+"position:absolute;"+"top:"+seg.top+"px;"+"left:"+seg.left+"px;"+skinCss+"'"+">"+"<div class='fc-event-inner'>"+"<div class='fc-event-time'>"+htmlEscape(formatDates(event.start,event.end,opt("timeFormat")))+"</div>"+"<div class='fc-event-title'>"+htmlEscape(event.title||"")+"</div>"+"</div>"+"<div class='fc-event-bg'></div>",seg.isEnd&&isEventResizable(event)&&(html+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),html+="</"+(url?"a":"div")+">"}function bindSlotSeg(event,eventElement,seg){var timeElement=eventElement.find("div.fc-event-time");isEventDraggable(event)&&draggableSlotEvent(event,eventElement,timeElement),seg.isEnd&&isEventResizable(event)&&resizableSlotEvent(event,eventElement,timeElement),eventElementHandlers(event,eventElement)}function draggableDayEvent(event,eventElement,seg){function resetElement(){allDay||(eventElement.width(origWidth).height("").draggable("option","grid",null),allDay=!0)}var origWidth,srcCell,revert,dayDelta,isStart=seg.isStart,allDay=!0,hoverListener=getHoverListener(),colWidth=getColWidth(),snapHeight=getSnapHeight(),snapMinutes=getSnapMinutes(),minMinute=getMinMinute();eventElement.draggable({opacity:opt("dragOpacity","month"),revertDuration:opt("dragRevertDuration"),start:function(ev,ui){trigger("eventDragStart",eventElement,event,ev,ui),hideEvents(event,eventElement),origWidth=eventElement.width(),hoverListener.start(function(cell,origCell){if(srcCell=origCell,clearOverlays(),cell){revert=!1;var origDate=cellToDate(0,origCell.col),date=cellToDate(0,cell.col);dayDelta=dayDiff(date,origDate),cell.row?isStart?allDay&&(eventElement.width(colWidth-10),setOuterHeight(eventElement,snapHeight*Math.round((event.end?(event.end-event.start)/MINUTE_MS:opt("defaultEventMinutes"))/snapMinutes)),eventElement.draggable("option","grid",[colWidth,1]),allDay=!1):revert=!0:(renderDayOverlay(addDays(cloneDate(event.start),dayDelta),addDays(exclEndDay(event),dayDelta)),resetElement()),revert=revert||allDay&&!dayDelta}else resetElement(),revert=!0;eventElement.draggable("option","revert",revert)},ev,"drag")},stop:function(ev,ui){if(hoverListener.stop(),clearOverlays(),trigger("eventDragStop",eventElement,event,ev,ui),revert)resetElement(),eventElement.css("filter",""),showEvents(event,eventElement);else{var minuteDelta=0;allDay||(minuteDelta=Math.round((eventElement.offset().top-getSlotContainer().offset().top)/snapHeight)*snapMinutes+minMinute-(60*event.start.getHours()+event.start.getMinutes())),ev.srcCell=srcCell,eventDrop(this,event,dayDelta,minuteDelta,allDay,ev,ui)}}})}function draggableSlotEvent(event,eventElement,timeElement){function updateUI(){clearOverlays(),isInBounds&&(isAllDay?(timeElement.hide(),eventElement.draggable("option","grid",null),renderDayOverlay(addDays(cloneDate(event.start),dayDelta),addDays(exclEndDay(event),dayDelta))):(updateTimeText(minuteDelta),timeElement.css("display",""),eventElement.draggable("option","grid",[colWidth,snapHeight])))}function updateTimeText(minuteDelta){var newEnd,newStart=addMinutes(cloneDate(event.start),minuteDelta);event.end&&(newEnd=addMinutes(cloneDate(event.end),minuteDelta)),timeElement.text(formatDates(newStart,newEnd,opt("timeFormat")))}var origPosition,origCell,isInBounds,prevIsInBounds,isAllDay,prevIsAllDay,colDelta,prevColDelta,dayDelta,resourceDelta,minuteDelta,prevMinuteDelta,coordinateGrid=t.getCoordinateGrid(),colCnt=getColCnt(),colWidth=getColWidth(),snapHeight=getSnapHeight(),snapMinutes=getSnapMinutes();eventElement.draggable({scroll:!1,grid:[colWidth,snapHeight],axis:1==colCnt?"y":!1,opacity:opt("dragOpacity"),revertDuration:opt("dragRevertDuration"),start:function(ev,ui){trigger("eventDragStart",eventElement,event,ev,ui),hideEvents(event,eventElement),coordinateGrid.build(),origPosition=eventElement.position(),origCell=coordinateGrid.cell(ev.pageX,ev.pageY),isInBounds=prevIsInBounds=!0,isAllDay=prevIsAllDay=getIsCellAllDay(origCell),colDelta=prevColDelta=0,dayDelta=0,resourceDelta=0,minuteDelta=prevMinuteDelta=0},drag:function(ev,ui){var cell=coordinateGrid.cell(ev.pageX,ev.pageY);isInBounds=!!cell,isInBounds&&(isAllDay=getIsCellAllDay(cell),colDelta=Math.round((ui.position.left-origPosition.left)/colWidth),colDelta!=prevColDelta&&(resourceDelta=colDelta),isAllDay||(minuteDelta=Math.round((ui.position.top-origPosition.top)/snapHeight)*snapMinutes)),(isInBounds!=prevIsInBounds||isAllDay!=prevIsAllDay||colDelta!=prevColDelta||minuteDelta!=prevMinuteDelta)&&(updateUI(),prevIsInBounds=isInBounds,prevIsAllDay=isAllDay,prevColDelta=colDelta,prevMinuteDelta=minuteDelta),eventElement.draggable("option","revert",!isInBounds)},stop:function(ev,ui){clearOverlays(),trigger("eventDragStop",eventElement,event,ev,ui),isInBounds&&(isAllDay||resourceDelta||minuteDelta)?(event.resources=resources()[origCell.col+resourceDelta].id,eventDrop(this,event,dayDelta,isAllDay?0:minuteDelta,isAllDay,ev,ui)):(isInBounds=!0,isAllDay=!1,colDelta=0,dayDelta=0,minuteDelta=0,updateUI(),eventElement.css("filter",""),eventElement.css(origPosition),showEvents(event,eventElement))}})}function resizableSlotEvent(event,eventElement,timeElement){var snapDelta,prevSnapDelta,snapHeight=getSnapHeight(),snapMinutes=getSnapMinutes();eventElement.resizable({handles:{s:".ui-resizable-handle"},grid:snapHeight,start:function(ev,ui){snapDelta=prevSnapDelta=0,hideEvents(event,eventElement),trigger("eventResizeStart",this,event,ev,ui)},resize:function(ev,ui){snapDelta=Math.round((Math.max(snapHeight,eventElement.height())-ui.originalSize.height)/snapHeight),snapDelta!=prevSnapDelta&&(timeElement.text(formatDates(event.start,snapDelta||event.end?addMinutes(eventEnd(event),snapMinutes*snapDelta):null,opt("timeFormat"))),prevSnapDelta=snapDelta)},stop:function(ev,ui){trigger("eventResizeStop",this,event,ev,ui),snapDelta?eventResize(this,event,0,snapMinutes*snapDelta,ev,ui):showEvents(event,eventElement)}})}var t=this;t.renderEvents=renderEvents,t.clearEvents=clearEvents,t.slotSegHtml=slotSegHtml,DayEventRenderer.call(t);var opt=t.opt,trigger=t.trigger,isEventDraggable=t.isEventDraggable,isEventResizable=t.isEventResizable,eventEnd=t.eventEnd,eventElementHandlers=t.eventElementHandlers,setHeight=t.setHeight,getDaySegmentContainer=t.getDaySegmentContainer,getSlotSegmentContainer=t.getSlotSegmentContainer,getHoverListener=t.getHoverListener,getMaxMinute=t.getMaxMinute,getMinMinute=t.getMinMinute,timePosition=t.timePosition,getIsCellAllDay=t.getIsCellAllDay,colContentLeft=t.colContentLeft,colContentRight=t.colContentRight,cellToDate=t.cellToDate,segmentCompare=t.segmentCompare,getColCnt=t.getColCnt,getColWidth=t.getColWidth,getSnapHeight=t.getSnapHeight,getSnapMinutes=t.getSnapMinutes,getSlotContainer=t.getSlotContainer,reportEventElement=t.reportEventElement,showEvents=t.showEvents,hideEvents=t.hideEvents,eventDrop=t.eventDrop,eventResize=t.eventResize,renderDayOverlay=t.renderDayOverlay,clearOverlays=t.clearOverlays,renderDayEvents=t.renderDayEvents,calendar=t.calendar,formatDate=calendar.formatDate,formatDates=calendar.formatDates,resources=t.getResources;t.draggableDayEvent=draggableDayEvent}function stackAgendaSegs(segs){var i,seg,j,collide,k,levels=[],len=segs.length;for(i=0;len>i;i++){for(seg=segs[i],j=0;;){if(collide=!1,levels[j])for(k=0;k<levels[j].length;k++)if(agendaSegsCollide(levels[j][k],seg)){collide=!0;break}if(!collide)break;j++}levels[j]?levels[j].push(seg):levels[j]=[seg]}return levels}function countForwardSegs(levels){var i,j,k,level,segForward,segBack;for(i=levels.length-1;i>0;i--)for(level=levels[i],j=0;j<level.length;j++)for(segForward=level[j],k=0;k<levels[i-1].length;k++)segBack=levels[i-1][k],agendaSegsCollide(segForward,segBack)&&(segBack.forward=Math.max(segBack.forward||0,(segForward.forward||0)+1))}function agendaSegsCollide(seg1,seg2){return seg1.end>seg2.start&&seg1.start<seg2.end}function View(element,calendar,viewName){function opt(name,viewNameOverride){var v=options[name];return $.isPlainObject(v)?smartProperty(v,viewNameOverride||viewName):v}function trigger(name,thisObj){return calendar.trigger.apply(calendar,[name,thisObj||t].concat(Array.prototype.slice.call(arguments,2),[t]))}function isEventDraggable(event){var source=event.source||{};return firstDefined(event.startEditable,source.startEditable,opt("eventStartEditable"),event.editable,source.editable,opt("editable"))&&!opt("disableDragging")}function isEventResizable(event){var source=event.source||{};return firstDefined(event.durationEditable,source.durationEditable,opt("eventDurationEditable"),event.editable,source.editable,opt("editable"))&&!opt("disableResizing")}function setEventData(events){eventsByID={};var i,event,len=events.length;for(i=0;len>i;i++)event=events[i],eventsByID[event._id]?eventsByID[event._id].push(event):eventsByID[event._id]=[event]}function clearEventData(){eventsByID={},eventElementsByID={},eventElementCouples=[]}function eventEnd(event){return event.end?cloneDate(event.end):defaultEventEnd(event)}function reportEventElement(event,element){eventElementCouples.push({event:event,element:element}),eventElementsByID[event._id]?eventElementsByID[event._id].push(element):eventElementsByID[event._id]=[element]}function triggerEventDestroy(){$.each(eventElementCouples,function(i,couple){t.trigger("eventDestroy",couple.event,couple.event,couple.element)})}function eventElementHandlers(event,eventElement){eventElement.click(function(ev){return eventElement.hasClass("ui-draggable-dragging")||eventElement.hasClass("ui-resizable-resizing")?void 0:trigger("eventClick",this,event,ev)}).hover(function(ev){trigger("eventMouseover",this,event,ev)},function(ev){trigger("eventMouseout",this,event,ev)})}function showEvents(event,exceptElement){eachEventElement(event,exceptElement,"show")}function hideEvents(event,exceptElement){eachEventElement(event,exceptElement,"hide")}function eachEventElement(event,exceptElement,funcName){var i,elements=eventElementsByID[event._id],len=elements.length;for(i=0;len>i;i++)exceptElement&&elements[i][0]==exceptElement[0]||elements[i][funcName]()}function eventDrop(e,event,dayDelta,minuteDelta,allDay,ev,ui){var oldAllDay=event.allDay,eventId=event._id;moveEvents(eventsByID[eventId],dayDelta,minuteDelta,allDay),trigger("eventDrop",e,event,dayDelta,minuteDelta,allDay,function(){moveEvents(eventsByID[eventId],-dayDelta,-minuteDelta,oldAllDay),reportEventChange(eventId)},ev,ui),reportEventChange(eventId)}function eventResize(e,event,dayDelta,minuteDelta,ev,ui){var eventId=event._id;elongateEvents(eventsByID[eventId],dayDelta,minuteDelta),trigger("eventResize",e,event,dayDelta,minuteDelta,function(){elongateEvents(eventsByID[eventId],-dayDelta,-minuteDelta),reportEventChange(eventId)},ev,ui),reportEventChange(eventId)}function moveEvents(events,dayDelta,minuteDelta,allDay){minuteDelta=minuteDelta||0;for(var e,len=events.length,i=0;len>i;i++)e=events[i],allDay!==undefined&&(e.allDay=allDay),addMinutes(addDays(e.start,dayDelta,!0),minuteDelta),e.end&&(e.end=addMinutes(addDays(e.end,dayDelta,!0),minuteDelta)),normalizeEvent(e,options)}function elongateEvents(events,dayDelta,minuteDelta){minuteDelta=minuteDelta||0;for(var e,len=events.length,i=0;len>i;i++)e=events[i],e.end=addMinutes(addDays(eventEnd(e),dayDelta,!0),minuteDelta),normalizeEvent(e,options)}function isHiddenDay(day){return"object"==typeof day&&(day=day.getDay()),isHiddenDayHash[day]}function getCellsPerWeek(){return cellsPerWeek}function skipHiddenDays(date,inc,isExclusive){for(inc=inc||1;isHiddenDayHash[(date.getDay()+(isExclusive?inc:0)+7)%7];)addDays(date,inc)
}function cellToDate(){var cellOffset=cellToCellOffset.apply(null,arguments),dayOffset=cellOffsetToDayOffset(cellOffset),date=dayOffsetToDate(dayOffset);return date}function cellToCellOffset(row,col){var colCnt=t.getColCnt(),dis=isRTL?-1:1,dit=isRTL?colCnt-1:0;"object"==typeof row&&(col=row.col,row=row.row);var cellOffset=row*colCnt+(col*dis+dit);return cellOffset}function cellOffsetToDayOffset(cellOffset){var day0=t.visStart.getDay();return cellOffset+=dayToCellMap[day0],7*Math.floor(cellOffset/cellsPerWeek)+cellToDayMap[(cellOffset%cellsPerWeek+cellsPerWeek)%cellsPerWeek]-day0}function dayOffsetToDate(dayOffset){var date=cloneDate(t.visStart);return addDays(date,dayOffset),date}function dateToCell(date){var dayOffset=dateToDayOffset(date),cellOffset=dayOffsetToCellOffset(dayOffset),cell=cellOffsetToCell(cellOffset);return cell}function dateToDayOffset(date){return dayDiff(date,t.visStart)}function dayOffsetToCellOffset(dayOffset){var day0=t.visStart.getDay();return dayOffset+=day0,Math.floor(dayOffset/7)*cellsPerWeek+dayToCellMap[(dayOffset%7+7)%7]-dayToCellMap[day0]}function cellOffsetToCell(cellOffset){var colCnt=t.getColCnt(),dis=isRTL?-1:1,dit=isRTL?colCnt-1:0,row=Math.floor(cellOffset/colCnt),col=(cellOffset%colCnt+colCnt)%colCnt*dis+dit;return{row:row,col:col}}function rangeToSegments(startDate,endDate){for(var rowCnt=t.getRowCnt(),colCnt="resourceDay"===t.name?1:t.getColCnt(),segments=[],rangeDayOffsetStart=dateToDayOffset(startDate),rangeDayOffsetEnd=dateToDayOffset(endDate),rangeCellOffsetFirst=dayOffsetToCellOffset(rangeDayOffsetStart),rangeCellOffsetLast=dayOffsetToCellOffset(rangeDayOffsetEnd)-1,row=0;rowCnt>row;row++){var rowCellOffsetFirst=row*colCnt,rowCellOffsetLast=rowCellOffsetFirst+colCnt-1,segmentCellOffsetFirst=Math.max(rangeCellOffsetFirst,rowCellOffsetFirst),segmentCellOffsetLast=Math.min(rangeCellOffsetLast,rowCellOffsetLast);if(segmentCellOffsetLast>=segmentCellOffsetFirst){var segmentCellFirst=cellOffsetToCell(segmentCellOffsetFirst),segmentCellLast=cellOffsetToCell(segmentCellOffsetLast),cols=[segmentCellFirst.col,segmentCellLast.col].sort(),isStart=cellOffsetToDayOffset(segmentCellOffsetFirst)==rangeDayOffsetStart,isEnd=cellOffsetToDayOffset(segmentCellOffsetLast)+1==rangeDayOffsetEnd;segments.push({row:row,leftCol:cols[0],rightCol:cols[1],isStart:isStart,isEnd:isEnd})}}return segments}function segmentCompare(a,b){return _priorityCompare(a,b)||_segmentCompare(a,b)||a.event.start-b.event.start||(a.event.title||"").localeCompare(b.event.title)}function _segmentCompare(a,b){return"msLength"in a?b.msLength-a.msLength:b.rightCol-b.leftCol-(a.rightCol-a.leftCol)||b.event.allDay-a.event.allDay}function _priorityCompare(a,b){return a.event.priority-b.event.priority}var t=this;t.element=element,t.calendar=calendar,t.name=viewName,t.opt=opt,t.trigger=trigger,t.isEventDraggable=isEventDraggable,t.isEventResizable=isEventResizable,t.setEventData=setEventData,t.clearEventData=clearEventData,t.eventEnd=eventEnd,t.reportEventElement=reportEventElement,t.triggerEventDestroy=triggerEventDestroy,t.eventElementHandlers=eventElementHandlers,t.showEvents=showEvents,t.hideEvents=hideEvents,t.eventDrop=eventDrop,t.eventResize=eventResize;var defaultEventEnd=t.defaultEventEnd,normalizeEvent=calendar.normalizeEvent,reportEventChange=calendar.reportEventChange,eventsByID={},eventElementsByID={},eventElementCouples=[],options=calendar.options;t.isHiddenDay=isHiddenDay,t.skipHiddenDays=skipHiddenDays,t.getCellsPerWeek=getCellsPerWeek,t.dateToCell=dateToCell,t.dateToDayOffset=dateToDayOffset,t.dayOffsetToCellOffset=dayOffsetToCellOffset,t.cellOffsetToCell=cellOffsetToCell,t.cellToDate=cellToDate,t.cellToCellOffset=cellToCellOffset,t.cellOffsetToDayOffset=cellOffsetToDayOffset,t.dayOffsetToDate=dayOffsetToDate,t.rangeToSegments=rangeToSegments,t.segmentCompare=segmentCompare;var cellsPerWeek,hiddenDays=opt("hiddenDays")||[],isHiddenDayHash=[],dayToCellMap=[],cellToDayMap=[],isRTL=opt("isRTL");!function(){opt("weekends")===!1&&hiddenDays.push(0,6);for(var dayIndex=0,cellIndex=0;7>dayIndex;dayIndex++)dayToCellMap[dayIndex]=cellIndex,isHiddenDayHash[dayIndex]=-1!=$.inArray(dayIndex,hiddenDays),isHiddenDayHash[dayIndex]||(cellToDayMap[cellIndex]=dayIndex,cellIndex++);if(cellsPerWeek=cellIndex,!cellsPerWeek)throw"invalid hiddenDays"}()}function DayEventRenderer(){function renderDayEvents(events,modifiedEventId){var segments=_renderDayEvents(events,!1,!0);segmentElementEach(segments,function(segment,element){reportEventElement(segment.event,element)}),attachHandlers(segments,modifiedEventId),segmentElementEach(segments,function(segment,element){trigger("eventAfterRender",segment.event,segment.event,element)})}function renderTempDayEvent(event,adjustRow,adjustTop){var segments=_renderDayEvents([event],!0,!1),elements=[];return segmentElementEach(segments,function(segment,element){segment.row===adjustRow&&element.css("top",adjustTop),elements.push(element[0])}),elements}function _renderDayEvents(events,doAppend,doRowHeights){var html,elements,finalContainer=getDaySegmentContainer(),renderContainer=doAppend?$("<div/>"):finalContainer,segments=buildSegments(events);return calculateHorizontals(segments),html=buildHTML(segments),renderContainer[0].innerHTML=html,elements=renderContainer.children(),doAppend&&finalContainer.append(elements),resolveElements(segments,elements),segmentElementEach(segments,function(segment,element){segment.hsides=hsides(element,!0)}),segmentElementEach(segments,function(segment,element){element.width(Math.max(0,segment.outerWidth-segment.hsides))}),segmentElementEach(segments,function(segment,element){segment.outerHeight=element.outerHeight(!0)}),setVerticals(segments,doRowHeights),segments}function buildSegments(events){var resources=t.getResources;if("undefined"==typeof resources)return buildSegmentsTEMP(events);for(var segments=[],i=0;i<resources().length;i++)for(var resourceEvents=eventsForResource(resources()[i],events),j=0;j<resourceEvents.length;j++){var eventSegments=buildSegmentsForEvent(resourceEvents[j],i);segments.push.apply(segments,eventSegments)}return segments}function eventsForResource(resource,events){for(var resourceEvents=[],i=0;i<events.length;i++)events[i].resources&&$.inArray(resource.id,events[i].resources)>=0&&resourceEvents.push(events[i]);return resourceEvents}function buildSegmentsTEMP(events){for(var segments=[],i=0;i<events.length;i++){var eventSegments=buildSegmentsForEvent(events[i]);segments.push.apply(segments,eventSegments)}return segments}function buildSegmentsForEvent(event,col){for(var startDate=event.start,endDate=exclEndDay(event),segments=rangeToSegments(startDate,endDate),i=0;i<segments.length;i++)"undefined"!=typeof col&&(segments[i].leftCol=col,segments[i].rightCol=col),segments[i].event=event;return segments}function calculateHorizontals(segments){for(var isRTL=opt("isRTL"),i=0;i<segments.length;i++){var segment=segments[i],leftFunc=(isRTL?segment.isEnd:segment.isStart)?colContentLeft:colLeft,rightFunc=(isRTL?segment.isStart:segment.isEnd)?colContentRight:colRight,left=leftFunc(segment.leftCol),right=rightFunc(segment.rightCol);segment.left=left,segment.outerWidth=right-left}}function buildHTML(segments){for(var html="",i=0;i<segments.length;i++)html+=buildHTMLForSegment(segments[i]);return html}function buildHTMLForSegment(segment){var html="",isRTL=opt("isRTL"),event=segment.event,url=event.url,classNames=["fc-event","fc-event-hori"];isEventDraggable(event)&&classNames.push("fc-event-draggable"),segment.isStart&&classNames.push("fc-event-start"),segment.isEnd&&classNames.push("fc-event-end"),classNames=classNames.concat(event.className),event.source&&(classNames=classNames.concat(event.source.className||[]));var skinCss=getSkinCss(event,opt);return html+=url?"<a href='"+htmlEscape(url)+"'":"<div",html+=" class='"+classNames.join(" ")+"'"+" style="+"'"+"position:absolute;"+"left:"+segment.left+"px;"+skinCss+"'"+">"+"<div class='fc-event-inner'>",!event.allDay&&segment.isStart&&(html+="<span class='fc-event-time'>"+htmlEscape(formatDates(event.start,event.end,opt("timeFormat")))+"</span>"),html+="<span class='fc-event-title'>"+htmlEscape(event.title||"")+"</span>"+"</div>",segment.isEnd&&isEventResizable(event)&&(html+="<div class='ui-resizable-handle ui-resizable-"+(isRTL?"w":"e")+"'>"+"&nbsp;&nbsp;&nbsp;"+"</div>"),html+="</"+(url?"a":"div")+">"}function resolveElements(segments,elements){for(var i=0;i<segments.length;i++){var segment=segments[i],event=segment.event,element=elements.eq(i),triggerRes=trigger("eventRender",event,event,element);triggerRes===!1?element.remove():(triggerRes&&triggerRes!==!0&&(triggerRes=$(triggerRes).css({position:"absolute",left:segment.left}),element.replaceWith(triggerRes),element=triggerRes),segment.element=element)}}function setVerticals(segments,doRowHeights){var rowContentHeights=calculateVerticals(segments),rowContentElements=getRowContentElements(),rowContentTops=[];if(doRowHeights)for(var i=0;i<rowContentElements.length;i++)rowContentElements[i].height(rowContentHeights[i]);for(var i=0;i<rowContentElements.length;i++)rowContentTops.push(rowContentElements[i].position().top);segmentElementEach(segments,function(segment,element){element.css("top",rowContentTops[segment.row]+segment.top)})}function calculateVerticals(segments){for(var rowCnt=getRowCnt(),colCnt=getColCnt(),rowContentHeights=[],segmentRows=buildSegmentRows(segments),rowI=0;rowCnt>rowI;rowI++){for(var segmentRow=segmentRows[rowI],colHeights=[],colI=0;colCnt>colI;colI++)colHeights.push(0);for(var segmentI=0;segmentI<segmentRow.length;segmentI++){var segment=segmentRow[segmentI];segment.top=arrayMax(colHeights.slice(segment.leftCol,segment.rightCol+1));for(var colI=segment.leftCol;colI<=segment.rightCol;colI++)colHeights[colI]=segment.top+segment.outerHeight}rowContentHeights.push(arrayMax(colHeights))}return rowContentHeights}function buildSegmentRows(segments){var segmentI,segment,rowI,rowCnt=getRowCnt(),segmentRows=[];for(segmentI=0;segmentI<segments.length;segmentI++)segment=segments[segmentI],rowI=segment.row,segment.element&&(segmentRows[rowI]?segmentRows[rowI].push(segment):segmentRows[rowI]=[segment]);for(rowI=0;rowCnt>rowI;rowI++)segmentRows[rowI]=sortSegmentRow(segmentRows[rowI]||[]);return segmentRows}function sortSegmentRow(segments){for(var sortedSegments=[],subrows=buildSegmentSubrows(segments),i=0;i<subrows.length;i++)sortedSegments.push.apply(sortedSegments,subrows[i]);return sortedSegments}function buildSegmentSubrows(segments){segments.sort(segmentCompare);for(var subrows=[],i=0;i<segments.length;i++){for(var segment=segments[i],j=0;j<subrows.length&&isDaySegmentCollision(segment,subrows[j]);j++);subrows[j]?subrows[j].push(segment):subrows[j]=[segment]}return subrows}function getRowContentElements(){var i,rowCnt=getRowCnt(),rowDivs=[];for(i=0;rowCnt>i;i++)rowDivs[i]=allDayRow(i).find("div.fc-day-content > div");return rowDivs}function attachHandlers(segments,modifiedEventId){var segmentContainer=getDaySegmentContainer();segmentElementEach(segments,function(segment,element,i){var event=segment.event;event._id===modifiedEventId?bindDaySeg(event,element,segment):element[0]._fci=i}),lazySegBind(segmentContainer,segments,bindDaySeg)}function bindDaySeg(event,eventElement,segment){isEventDraggable(event)&&t.draggableDayEvent(event,eventElement,segment),segment.isEnd&&isEventResizable(event)&&t.resizableDayEvent(event,eventElement,segment),eventElementHandlers(event,eventElement)}function draggableDayEvent(event,eventElement){var dayDelta,hoverListener=getHoverListener();eventElement.draggable({delay:50,opacity:opt("dragOpacity"),revertDuration:opt("dragRevertDuration"),start:function(ev,ui){trigger("eventDragStart",eventElement,event,ev,ui),hideEvents(event,eventElement),hoverListener.start(function(cell,origCell,rowDelta,colDelta){if(eventElement.draggable("option","revert",!cell||!rowDelta&&!colDelta),clearOverlays(),cell){var origDate=cellToDate(origCell),date=cellToDate(cell);dayDelta=dayDiff(date,origDate),renderDayOverlay(addDays(cloneDate(event.start),dayDelta),addDays(exclEndDay(event),dayDelta))}else dayDelta=0},ev,"drag")},stop:function(ev,ui){hoverListener.stop(),clearOverlays(),trigger("eventDragStop",eventElement,event,ev,ui),dayDelta?eventDrop(this,event,dayDelta,0,event.allDay,ev,ui):(eventElement.css("filter",""),showEvents(event,eventElement))}})}function resizableDayEvent(event,element,segment){var isRTL=opt("isRTL"),direction=isRTL?"w":"e",handle=element.find(".ui-resizable-"+direction),isResizing=!1;disableTextSelection(element),element.mousedown(function(ev){ev.preventDefault()}).click(function(ev){isResizing&&(ev.preventDefault(),ev.stopImmediatePropagation())}),handle.mousedown(function(ev){function mouseup(ev){trigger("eventResizeStop",this,event,ev),$("body").css("cursor",""),hoverListener.stop(),clearOverlays(),dayDelta&&eventResize(this,event,dayDelta,0,ev),setTimeout(function(){isResizing=!1},0)}if(1==ev.which){isResizing=!0;var hoverListener=getHoverListener();getRowCnt(),getColCnt();var dayDelta,helpers,elementTop=element.css("top"),eventCopy=$.extend({},event),minCellOffset=dayOffsetToCellOffset(dateToDayOffset(event.start));clearSelection(),$("body").css("cursor",direction+"-resize").one("mouseup",mouseup),trigger("eventResizeStart",this,event,ev),hoverListener.start(function(cell,origCell){if(cell){var origCellOffset=cellToCellOffset(origCell),cellOffset=cellToCellOffset(cell);if(cellOffset=Math.max(cellOffset,minCellOffset),dayDelta=cellOffsetToDayOffset(cellOffset)-cellOffsetToDayOffset(origCellOffset)){eventCopy.end=addDays(eventEnd(event),dayDelta,!0);var oldHelpers=helpers;helpers=renderTempDayEvent(eventCopy,segment.row,elementTop),helpers=$(helpers),helpers.find("*").css("cursor",direction+"-resize"),oldHelpers&&oldHelpers.remove(),hideEvents(event)}else helpers&&(showEvents(event),helpers.remove(),helpers=null);clearOverlays(),renderDayOverlay(event.start,addDays(exclEndDay(event),dayDelta))}},ev)}})}var t=this;t.renderDayEvents=renderDayEvents,t.draggableDayEvent=draggableDayEvent,t.resizableDayEvent=resizableDayEvent;var opt=t.opt,trigger=t.trigger,isEventDraggable=t.isEventDraggable,isEventResizable=t.isEventResizable,eventEnd=t.eventEnd,reportEventElement=t.reportEventElement,eventElementHandlers=t.eventElementHandlers,showEvents=t.showEvents,hideEvents=t.hideEvents,eventDrop=t.eventDrop,eventResize=t.eventResize,getRowCnt=t.getRowCnt,getColCnt=t.getColCnt;t.getColWidth;var allDayRow=t.allDayRow,colLeft=t.colLeft,colRight=t.colRight,colContentLeft=t.colContentLeft,colContentRight=t.colContentRight;t.dateToCell;var getDaySegmentContainer=t.getDaySegmentContainer,formatDates=t.calendar.formatDates,renderDayOverlay=t.renderDayOverlay,clearOverlays=t.clearOverlays,clearSelection=t.clearSelection,getHoverListener=t.getHoverListener,rangeToSegments=t.rangeToSegments,segmentCompare=t.segmentCompare,cellToDate=t.cellToDate,cellToCellOffset=t.cellToCellOffset,cellOffsetToDayOffset=t.cellOffsetToDayOffset,dateToDayOffset=t.dateToDayOffset,dayOffsetToCellOffset=t.dayOffsetToCellOffset}function isDaySegmentCollision(segment,otherSegments){for(var i=0;i<otherSegments.length;i++){var otherSegment=otherSegments[i];if(otherSegment.leftCol<=segment.rightCol&&otherSegment.rightCol>=segment.leftCol)return!0}return!1}function segmentElementEach(segments,callback){for(var i=0;i<segments.length;i++){var segment=segments[i],element=segment.element;element&&callback(segment,element,i)}}function SelectionManager(){function select(startDate,endDate,allDay){unselect(),endDate||(endDate=defaultSelectionEnd(startDate,allDay)),renderSelection(startDate,endDate,allDay),reportSelection(startDate,endDate,allDay)}function unselect(ev){selected&&(selected=!1,clearSelection(),trigger("unselect",null,ev))}function reportSelection(startDate,endDate,allDay,ev){selected=!0,trigger("select",null,startDate,endDate,allDay,ev)}function daySelectionMousedown(ev){var cellToDate=t.cellToDate,getIsCellAllDay=t.getIsCellAllDay,hoverListener=t.getHoverListener(),reportDayClick=t.reportDayClick;if(1==ev.which&&opt("selectable")){unselect(ev);var dates;hoverListener.start(function(cell,origCell){clearSelection(),cell&&getIsCellAllDay(cell)?(dates=[cellToDate(origCell),cellToDate(cell)].sort(dateCompare),renderSelection(dates[0],dates[1],!0)):dates=null},ev),$(document).one("mouseup",function(ev){hoverListener.stop(),dates&&(+dates[0]==+dates[1]&&reportDayClick(dates[0],!0,ev),reportSelection(dates[0],dates[1],!0,ev))})}}var t=this;t.select=select,t.unselect=unselect,t.reportSelection=reportSelection,t.daySelectionMousedown=daySelectionMousedown;var opt=t.opt,trigger=t.trigger,defaultSelectionEnd=t.defaultSelectionEnd,renderSelection=t.renderSelection,clearSelection=t.clearSelection,selected=!1;opt("selectable")&&opt("unselectAuto")&&$(document).mousedown(function(ev){var ignore=opt("unselectCancel");ignore&&$(ev.target).parents(ignore).length||unselect(ev)})}function OverlayManager(){function renderOverlay(rect,parent){var e=unusedOverlays.shift();return e||(e=$("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")),e[0].parentNode!=parent[0]&&e.appendTo(parent),usedOverlays.push(e.css(rect).show()),e}function clearOverlays(){for(var e;e=usedOverlays.shift();)unusedOverlays.push(e.hide().unbind())}var t=this;t.renderOverlay=renderOverlay,t.clearOverlays=clearOverlays;var usedOverlays=[],unusedOverlays=[]}function CoordinateGrid(buildFunc){var rows,cols,t=this;t.build=function(){rows=[],cols=[],buildFunc(rows,cols)},t.cell=function(x,y){var i,rowCnt=rows.length,colCnt=cols.length,r=-1,c=-1;for(i=0;rowCnt>i;i++)if(y>=rows[i][0]&&y<rows[i][1]){r=i;break}for(i=0;colCnt>i;i++)if(x>=cols[i][0]&&x<cols[i][1]){c=i;break}return r>=0&&c>=0?{row:r,col:c}:null},t.rect=function(row0,col0,row1,col1,originElement){var origin=originElement.offset();return{top:rows[row0][0]-origin.top,left:cols[col0][0]-origin.left,width:cols[col1][1]-cols[col0][0],height:rows[row1][1]-rows[row0][0]}}}function HoverListener(coordinateGrid){function mouse(ev){_fixUIEvent(ev);var newCell=coordinateGrid.cell(ev.pageX,ev.pageY);(!newCell!=!cell||newCell&&(newCell.row!=cell.row||newCell.col!=cell.col))&&(newCell?(firstCell||(firstCell=newCell),change(newCell,firstCell,newCell.row-firstCell.row,newCell.col-firstCell.col)):change(newCell,firstCell),cell=newCell)}var bindType,change,firstCell,cell,t=this;t.start=function(_change,ev,_bindType){change=_change,firstCell=cell=null,coordinateGrid.build(),mouse(ev),bindType=_bindType||"mousemove",$(document).bind(bindType,mouse)},t.stop=function(){return $(document).unbind(bindType,mouse),cell}}function _fixUIEvent(event){event.pageX===undefined&&(event.pageX=event.originalEvent.pageX,event.pageY=event.originalEvent.pageY)}function HorizontalPositionCache(getElement){function e(i){return elements[i]=elements[i]||getElement(i)}var t=this,elements={},lefts={},rights={};t.left=function(i){return lefts[i]=lefts[i]===undefined?e(i).position().left:lefts[i]},t.right=function(i){return rights[i]=rights[i]===undefined?t.left(i)+e(i).width():rights[i]},t.clear=function(){elements={},lefts={},rights={}}}var defaults={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"iso",weekNumberTitle:"W",allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"<span class='fc-text-arrow'>&lsaquo;</span>",next:"<span class='fc-text-arrow'>&rsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&laquo;</span>",nextYear:"<span class='fc-text-arrow'>&raquo;</span>",today:"today",month:"month",week:"week",extended:"week (extended)",day:"day"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*",handleWindowResize:!0},rtlDefaults={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"<span class='fc-text-arrow'>&rsaquo;</span>",next:"<span class='fc-text-arrow'>&lsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&raquo;</span>",nextYear:"<span class='fc-text-arrow'>&laquo;</span>"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},fc=$.fullCalendar={version:"1.6.3"},fcViews=fc.views={};$.fn.fullCalendar=function(options){if("string"==typeof options){var res,args=Array.prototype.slice.call(arguments,1);return this.each(function(){var calendar=$.data(this,"fullCalendar");if(calendar&&$.isFunction(calendar[options])){var r=calendar[options].apply(calendar,args);res===undefined&&(res=r),"destroy"==options&&$.removeData(this,"fullCalendar")}}),res!==undefined?res:this}var eventSources=options.eventSources||[];return delete options.eventSources,options.events&&(eventSources.push(options.events),delete options.events),options=$.extend(!0,{},defaults,options.isRTL||options.isRTL===undefined&&defaults.isRTL?rtlDefaults:{},options),this.each(function(i,_element){var element=$(_element),calendar=new Calendar(element,options,eventSources);element.data("fullCalendar",calendar),calendar.render()}),this},fc.sourceNormalizers=[],fc.sourceFetchers=[];var ajaxDefaults={dataType:"json",cache:!1},eventGUID=1;fc.addDays=addDays,fc.cloneDate=cloneDate,fc.parseDate=parseDate,fc.parseISO8601=parseISO8601,fc.parseTime=parseTime,fc.formatDate=formatDate,fc.formatDates=formatDates;var dayIDs=["sun","mon","tue","wed","thu","fri","sat"],DAY_MS=864e5,HOUR_MS=36e5,MINUTE_MS=6e4,dateFormatters={s:function(d){return d.getSeconds()},ss:function(d){return zeroPad(d.getSeconds())},m:function(d){return d.getMinutes()},mm:function(d){return zeroPad(d.getMinutes())},h:function(d){return d.getHours()%12||12},hh:function(d){return zeroPad(d.getHours()%12||12)},H:function(d){return d.getHours()},HH:function(d){return zeroPad(d.getHours())},d:function(d){return d.getDate()},dd:function(d){return zeroPad(d.getDate())},ddd:function(d,o){return o.dayNamesShort[d.getDay()]},dddd:function(d,o){return o.dayNames[d.getDay()]},M:function(d){return d.getMonth()+1},MM:function(d){return zeroPad(d.getMonth()+1)},MMM:function(d,o){return o.monthNamesShort[d.getMonth()]},MMMM:function(d,o){return o.monthNames[d.getMonth()]},yy:function(d){return(d.getFullYear()+"").substring(2)},yyyy:function(d){return d.getFullYear()},t:function(d){return d.getHours()<12?"a":"p"},tt:function(d){return d.getHours()<12?"am":"pm"},T:function(d){return d.getHours()<12?"A":"P"},TT:function(d){return d.getHours()<12?"AM":"PM"},u:function(d){return formatDate(d,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(d){var date=d.getDate();return date>10&&20>date?"th":["st","nd","rd"][date%10-1]||"th"},w:function(d,o){return o.weekNumberCalculation(d)},W:function(d){return iso8601Week(d)}};fc.dateFormatters=dateFormatters,fc.applyAll=applyAll,fcViews.month=MonthView,fcViews.basicWeek=BasicWeekView,fcViews.extended=ExtendedView,fcViews.basicDay=BasicDayView,setDefaults({weekMode:"fixed"}),fcViews.agendaWeek=AgendaWeekView,fcViews.agendaDay=AgendaDayView,setDefaults({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24}),fcViews.resourceDay=ResourceDayView,setDefaults({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24})}(jQuery),/* Javascript plotting library for jQuery, version 0.8.2.

Copyright (c) 2007-2013 IOLA and Ole Laursen.
Licensed under the MIT license.

*/
function($){$.color={},$.color.make=function(r,g,b,a){var o={};return o.r=r||0,o.g=g||0,o.b=b||0,o.a=null!=a?a:1,o.add=function(c,d){for(var i=0;i<c.length;++i)o[c.charAt(i)]+=d;return o.normalize()},o.scale=function(c,f){for(var i=0;i<c.length;++i)o[c.charAt(i)]*=f;return o.normalize()},o.toString=function(){return o.a>=1?"rgb("+[o.r,o.g,o.b].join(",")+")":"rgba("+[o.r,o.g,o.b,o.a].join(",")+")"},o.normalize=function(){function clamp(min,value,max){return min>value?min:value>max?max:value}return o.r=clamp(0,parseInt(o.r),255),o.g=clamp(0,parseInt(o.g),255),o.b=clamp(0,parseInt(o.b),255),o.a=clamp(0,o.a,1),o},o.clone=function(){return $.color.make(o.r,o.b,o.g,o.a)},o.normalize()},$.color.extract=function(elem,css){var c;do{if(c=elem.css(css).toLowerCase(),""!=c&&"transparent"!=c)break;elem=elem.parent()}while(elem.length&&!$.nodeName(elem.get(0),"body"));return"rgba(0, 0, 0, 0)"==c&&(c="transparent"),$.color.parse(c)},$.color.parse=function(str){var res,m=$.color.make;if(res=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(str))return m(parseInt(res[1],10),parseInt(res[2],10),parseInt(res[3],10));if(res=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(str))return m(parseInt(res[1],10),parseInt(res[2],10),parseInt(res[3],10),parseFloat(res[4]));if(res=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(str))return m(2.55*parseFloat(res[1]),2.55*parseFloat(res[2]),2.55*parseFloat(res[3]));if(res=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(str))return m(2.55*parseFloat(res[1]),2.55*parseFloat(res[2]),2.55*parseFloat(res[3]),parseFloat(res[4]));if(res=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(str))return m(parseInt(res[1],16),parseInt(res[2],16),parseInt(res[3],16));if(res=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(str))return m(parseInt(res[1]+res[1],16),parseInt(res[2]+res[2],16),parseInt(res[3]+res[3],16));var name=$.trim(str).toLowerCase();return"transparent"==name?m(255,255,255,0):(res=lookupColors[name]||[0,0,0],m(res[0],res[1],res[2]))};var lookupColors={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function($){function Canvas(cls,container){var element=container.children("."+cls)[0];if(null==element&&(element=document.createElement("canvas"),element.className=cls,$(element).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(container),!element.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");element=window.G_vmlCanvasManager.initElement(element)}this.element=element;var context=this.context=element.getContext("2d"),devicePixelRatio=window.devicePixelRatio||1,backingStoreRatio=context.webkitBackingStorePixelRatio||context.mozBackingStorePixelRatio||context.msBackingStorePixelRatio||context.oBackingStorePixelRatio||context.backingStorePixelRatio||1;this.pixelRatio=devicePixelRatio/backingStoreRatio,this.resize(container.width(),container.height()),this.textContainer=null,this.text={},this._textCache={}}function Plot(placeholder,data_,options_,plugins){function executeHooks(hook,args){args=[plot].concat(args);for(var i=0;i<hook.length;++i)hook[i].apply(this,args)}function initPlugins(){for(var classes={Canvas:Canvas},i=0;i<plugins.length;++i){var p=plugins[i];p.init(plot,classes),p.options&&$.extend(!0,options,p.options)}}function parseOptions(opts){$.extend(!0,options,opts),opts&&opts.colors&&(options.colors=opts.colors),null==options.xaxis.color&&(options.xaxis.color=$.color.parse(options.grid.color).scale("a",.22).toString()),null==options.yaxis.color&&(options.yaxis.color=$.color.parse(options.grid.color).scale("a",.22).toString()),null==options.xaxis.tickColor&&(options.xaxis.tickColor=options.grid.tickColor||options.xaxis.color),null==options.yaxis.tickColor&&(options.yaxis.tickColor=options.grid.tickColor||options.yaxis.color),null==options.grid.borderColor&&(options.grid.borderColor=options.grid.color),null==options.grid.tickColor&&(options.grid.tickColor=$.color.parse(options.grid.color).scale("a",.22).toString());var i,axisOptions,axisCount,fontSize=placeholder.css("font-size"),fontSizeDefault=fontSize?+fontSize.replace("px",""):13,fontDefaults={style:placeholder.css("font-style"),size:Math.round(.8*fontSizeDefault),variant:placeholder.css("font-variant"),weight:placeholder.css("font-weight"),family:placeholder.css("font-family")};for(axisCount=options.xaxes.length||1,i=0;axisCount>i;++i)axisOptions=options.xaxes[i],axisOptions&&!axisOptions.tickColor&&(axisOptions.tickColor=axisOptions.color),axisOptions=$.extend(!0,{},options.xaxis,axisOptions),options.xaxes[i]=axisOptions,axisOptions.font&&(axisOptions.font=$.extend({},fontDefaults,axisOptions.font),axisOptions.font.color||(axisOptions.font.color=axisOptions.color),axisOptions.font.lineHeight||(axisOptions.font.lineHeight=Math.round(1.15*axisOptions.font.size)));for(axisCount=options.yaxes.length||1,i=0;axisCount>i;++i)axisOptions=options.yaxes[i],axisOptions&&!axisOptions.tickColor&&(axisOptions.tickColor=axisOptions.color),axisOptions=$.extend(!0,{},options.yaxis,axisOptions),options.yaxes[i]=axisOptions,axisOptions.font&&(axisOptions.font=$.extend({},fontDefaults,axisOptions.font),axisOptions.font.color||(axisOptions.font.color=axisOptions.color),axisOptions.font.lineHeight||(axisOptions.font.lineHeight=Math.round(1.15*axisOptions.font.size)));for(options.xaxis.noTicks&&null==options.xaxis.ticks&&(options.xaxis.ticks=options.xaxis.noTicks),options.yaxis.noTicks&&null==options.yaxis.ticks&&(options.yaxis.ticks=options.yaxis.noTicks),options.x2axis&&(options.xaxes[1]=$.extend(!0,{},options.xaxis,options.x2axis),options.xaxes[1].position="top"),options.y2axis&&(options.yaxes[1]=$.extend(!0,{},options.yaxis,options.y2axis),options.yaxes[1].position="right"),options.grid.coloredAreas&&(options.grid.markings=options.grid.coloredAreas),options.grid.coloredAreasColor&&(options.grid.markingsColor=options.grid.coloredAreasColor),options.lines&&$.extend(!0,options.series.lines,options.lines),options.points&&$.extend(!0,options.series.points,options.points),options.bars&&$.extend(!0,options.series.bars,options.bars),null!=options.shadowSize&&(options.series.shadowSize=options.shadowSize),null!=options.highlightColor&&(options.series.highlightColor=options.highlightColor),i=0;i<options.xaxes.length;++i)getOrCreateAxis(xaxes,i+1).options=options.xaxes[i];for(i=0;i<options.yaxes.length;++i)getOrCreateAxis(yaxes,i+1).options=options.yaxes[i];for(var n in hooks)options.hooks[n]&&options.hooks[n].length&&(hooks[n]=hooks[n].concat(options.hooks[n]));executeHooks(hooks.processOptions,[options])}function setData(d){series=parseData(d),fillInSeriesOptions(),processData()}function parseData(d){for(var res=[],i=0;i<d.length;++i){var s=$.extend(!0,{},options.series);null!=d[i].data?(s.data=d[i].data,delete d[i].data,$.extend(!0,s,d[i]),d[i].data=s.data):s.data=d[i],res.push(s)}return res}function axisNumber(obj,coord){var a=obj[coord+"axis"];return"object"==typeof a&&(a=a.n),"number"!=typeof a&&(a=1),a}function allAxes(){return $.grep(xaxes.concat(yaxes),function(a){return a})}function canvasToAxisCoords(pos){var i,axis,res={};for(i=0;i<xaxes.length;++i)axis=xaxes[i],axis&&axis.used&&(res["x"+axis.n]=axis.c2p(pos.left));for(i=0;i<yaxes.length;++i)axis=yaxes[i],axis&&axis.used&&(res["y"+axis.n]=axis.c2p(pos.top));return void 0!==res.x1&&(res.x=res.x1),void 0!==res.y1&&(res.y=res.y1),res}function axisToCanvasCoords(pos){var i,axis,key,res={};for(i=0;i<xaxes.length;++i)if(axis=xaxes[i],axis&&axis.used&&(key="x"+axis.n,null==pos[key]&&1==axis.n&&(key="x"),null!=pos[key])){res.left=axis.p2c(pos[key]);break}for(i=0;i<yaxes.length;++i)if(axis=yaxes[i],axis&&axis.used&&(key="y"+axis.n,null==pos[key]&&1==axis.n&&(key="y"),null!=pos[key])){res.top=axis.p2c(pos[key]);break}return res}function getOrCreateAxis(axes,number){return axes[number-1]||(axes[number-1]={n:number,direction:axes==xaxes?"x":"y",options:$.extend(!0,{},axes==xaxes?options.xaxis:options.yaxis)}),axes[number-1]}function fillInSeriesOptions(){var i,neededColors=series.length,maxIndex=-1;for(i=0;i<series.length;++i){var sc=series[i].color;null!=sc&&(neededColors--,"number"==typeof sc&&sc>maxIndex&&(maxIndex=sc))}maxIndex>=neededColors&&(neededColors=maxIndex+1);var c,colors=[],colorPool=options.colors,colorPoolSize=colorPool.length,variation=0;for(i=0;neededColors>i;i++)c=$.color.parse(colorPool[i%colorPoolSize]||"#666"),0==i%colorPoolSize&&i&&(variation=variation>=0?.5>variation?-variation-.2:0:-variation),colors[i]=c.scale("rgb",1+variation);var s,colori=0;for(i=0;i<series.length;++i){if(s=series[i],null==s.color?(s.color=colors[colori].toString(),++colori):"number"==typeof s.color&&(s.color=colors[s.color].toString()),null==s.lines.show){var v,show=!0;for(v in s)if(s[v]&&s[v].show){show=!1;break}show&&(s.lines.show=!0)}null==s.lines.zero&&(s.lines.zero=!!s.lines.fill),s.xaxis=getOrCreateAxis(xaxes,axisNumber(s,"x")),s.yaxis=getOrCreateAxis(yaxes,axisNumber(s,"y"))}}function processData(){function updateAxis(axis,min,max){min<axis.datamin&&min!=-fakeInfinity&&(axis.datamin=min),max>axis.datamax&&max!=fakeInfinity&&(axis.datamax=max)}var i,j,k,m,s,points,ps,val,f,p,data,format,topSentry=Number.POSITIVE_INFINITY,bottomSentry=Number.NEGATIVE_INFINITY,fakeInfinity=Number.MAX_VALUE;for($.each(allAxes(),function(_,axis){axis.datamin=topSentry,axis.datamax=bottomSentry,axis.used=!1}),i=0;i<series.length;++i)s=series[i],s.datapoints={points:[]},executeHooks(hooks.processRawData,[s,s.data,s.datapoints]);for(i=0;i<series.length;++i){if(s=series[i],data=s.data,format=s.datapoints.format,!format){if(format=[],format.push({x:!0,number:!0,required:!0}),format.push({y:!0,number:!0,required:!0}),s.bars.show||s.lines.show&&s.lines.fill){var autoscale=!!(s.bars.show&&s.bars.zero||s.lines.show&&s.lines.zero);format.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:autoscale}),s.bars.horizontal&&(delete format[format.length-1].y,format[format.length-1].x=!0)}s.datapoints.format=format}if(null==s.datapoints.pointsize){s.datapoints.pointsize=format.length,ps=s.datapoints.pointsize,points=s.datapoints.points;var insertSteps=s.lines.show&&s.lines.steps;for(s.xaxis.used=s.yaxis.used=!0,j=k=0;j<data.length;++j,k+=ps){p=data[j];var nullify=null==p;if(!nullify)for(m=0;ps>m;++m)val=p[m],f=format[m],f&&(f.number&&null!=val&&(val=+val,isNaN(val)?val=null:1/0==val?val=fakeInfinity:val==-1/0&&(val=-fakeInfinity)),null==val&&(f.required&&(nullify=!0),null!=f.defaultValue&&(val=f.defaultValue))),points[k+m]=val;if(nullify)for(m=0;ps>m;++m)val=points[k+m],null!=val&&(f=format[m],f.autoscale!==!1&&(f.x&&updateAxis(s.xaxis,val,val),f.y&&updateAxis(s.yaxis,val,val))),points[k+m]=null;else if(insertSteps&&k>0&&null!=points[k-ps]&&points[k-ps]!=points[k]&&points[k-ps+1]!=points[k+1]){for(m=0;ps>m;++m)points[k+ps+m]=points[k+m];points[k+1]=points[k-ps+1],k+=ps}}}}for(i=0;i<series.length;++i)s=series[i],executeHooks(hooks.processDatapoints,[s,s.datapoints]);for(i=0;i<series.length;++i){s=series[i],points=s.datapoints.points,ps=s.datapoints.pointsize,format=s.datapoints.format;var xmin=topSentry,ymin=topSentry,xmax=bottomSentry,ymax=bottomSentry;for(j=0;j<points.length;j+=ps)if(null!=points[j])for(m=0;ps>m;++m)val=points[j+m],f=format[m],f&&f.autoscale!==!1&&val!=fakeInfinity&&val!=-fakeInfinity&&(f.x&&(xmin>val&&(xmin=val),val>xmax&&(xmax=val)),f.y&&(ymin>val&&(ymin=val),val>ymax&&(ymax=val)));if(s.bars.show){var delta;switch(s.bars.align){case"left":delta=0;break;case"right":delta=-s.bars.barWidth;break;default:delta=-s.bars.barWidth/2}s.bars.horizontal?(ymin+=delta,ymax+=delta+s.bars.barWidth):(xmin+=delta,xmax+=delta+s.bars.barWidth)}updateAxis(s.xaxis,xmin,xmax),updateAxis(s.yaxis,ymin,ymax)}$.each(allAxes(),function(_,axis){axis.datamin==topSentry&&(axis.datamin=null),axis.datamax==bottomSentry&&(axis.datamax=null)})}function setupCanvases(){placeholder.css("padding",0).children().filter(function(){return!$(this).hasClass("flot-overlay")&&!$(this).hasClass("flot-base")}).remove(),"static"==placeholder.css("position")&&placeholder.css("position","relative"),surface=new Canvas("flot-base",placeholder),overlay=new Canvas("flot-overlay",placeholder),ctx=surface.context,octx=overlay.context,eventHolder=$(overlay.element).unbind();var existing=placeholder.data("plot");existing&&(existing.shutdown(),overlay.clear()),placeholder.data("plot",plot)}function bindEvents(){options.grid.hoverable&&(eventHolder.mousemove(onMouseMove),eventHolder.bind("mouseleave",onMouseLeave)),options.grid.clickable&&eventHolder.click(onClick),executeHooks(hooks.bindEvents,[eventHolder])}function shutdown(){redrawTimeout&&clearTimeout(redrawTimeout),eventHolder.unbind("mousemove",onMouseMove),eventHolder.unbind("mouseleave",onMouseLeave),eventHolder.unbind("click",onClick),executeHooks(hooks.shutdown,[eventHolder])}function setTransformationHelpers(axis){function identity(x){return x}var s,m,t=axis.options.transform||identity,it=axis.options.inverseTransform;"x"==axis.direction?(s=axis.scale=plotWidth/Math.abs(t(axis.max)-t(axis.min)),m=Math.min(t(axis.max),t(axis.min))):(s=axis.scale=plotHeight/Math.abs(t(axis.max)-t(axis.min)),s=-s,m=Math.max(t(axis.max),t(axis.min))),axis.p2c=t==identity?function(p){return(p-m)*s}:function(p){return(t(p)-m)*s},axis.c2p=it?function(c){return it(m+c/s)}:function(c){return m+c/s}}function measureTickLabels(axis){for(var opts=axis.options,ticks=axis.ticks||[],labelWidth=opts.labelWidth||0,labelHeight=opts.labelHeight||0,maxWidth=labelWidth||("x"==axis.direction?Math.floor(surface.width/(ticks.length||1)):null),legacyStyles=axis.direction+"Axis "+axis.direction+axis.n+"Axis",layer="flot-"+axis.direction+"-axis flot-"+axis.direction+axis.n+"-axis "+legacyStyles,font=opts.font||"flot-tick-label tickLabel",i=0;i<ticks.length;++i){var t=ticks[i];if(t.label){var info=surface.getTextInfo(layer,t.label,font,null,maxWidth);labelWidth=Math.max(labelWidth,info.width),labelHeight=Math.max(labelHeight,info.height)}}axis.labelWidth=opts.labelWidth||labelWidth,axis.labelHeight=opts.labelHeight||labelHeight}function allocateAxisBoxFirstPhase(axis){var lw=axis.labelWidth,lh=axis.labelHeight,pos=axis.options.position,isXAxis="x"===axis.direction,tickLength=axis.options.tickLength,axisMargin=options.grid.axisMargin,padding=options.grid.labelMargin,innermost=!0,outermost=!0,first=!0,found=!1;$.each(isXAxis?xaxes:yaxes,function(i,a){a&&a.reserveSpace&&(a===axis?found=!0:a.options.position===pos&&(found?outermost=!1:innermost=!1),found||(first=!1))}),outermost&&(axisMargin=0),null==tickLength&&(tickLength=first?"full":5),isNaN(+tickLength)||(padding+=+tickLength),isXAxis?(lh+=padding,"bottom"==pos?(plotOffset.bottom+=lh+axisMargin,axis.box={top:surface.height-plotOffset.bottom,height:lh}):(axis.box={top:plotOffset.top+axisMargin,height:lh},plotOffset.top+=lh+axisMargin)):(lw+=padding,"left"==pos?(axis.box={left:plotOffset.left+axisMargin,width:lw},plotOffset.left+=lw+axisMargin):(plotOffset.right+=lw+axisMargin,axis.box={left:surface.width-plotOffset.right,width:lw})),axis.position=pos,axis.tickLength=tickLength,axis.box.padding=padding,axis.innermost=innermost}function allocateAxisBoxSecondPhase(axis){"x"==axis.direction?(axis.box.left=plotOffset.left-axis.labelWidth/2,axis.box.width=surface.width-plotOffset.left-plotOffset.right+axis.labelWidth):(axis.box.top=plotOffset.top-axis.labelHeight/2,axis.box.height=surface.height-plotOffset.bottom-plotOffset.top+axis.labelHeight)}function adjustLayoutForThingsStickingOut(){var i,minMargin=options.grid.minBorderMargin;if(null==minMargin)for(minMargin=0,i=0;i<series.length;++i)minMargin=Math.max(minMargin,2*(series[i].points.radius+series[i].points.lineWidth/2));var margins={left:minMargin,right:minMargin,top:minMargin,bottom:minMargin};$.each(allAxes(),function(_,axis){if(axis.reserveSpace&&axis.ticks&&axis.ticks.length){var lastTick=axis.ticks[axis.ticks.length-1];"x"===axis.direction?(margins.left=Math.max(margins.left,axis.labelWidth/2),lastTick.v<=axis.max&&(margins.right=Math.max(margins.right,axis.labelWidth/2))):(margins.bottom=Math.max(margins.bottom,axis.labelHeight/2),lastTick.v<=axis.max&&(margins.top=Math.max(margins.top,axis.labelHeight/2)))}}),plotOffset.left=Math.ceil(Math.max(margins.left,plotOffset.left)),plotOffset.right=Math.ceil(Math.max(margins.right,plotOffset.right)),plotOffset.top=Math.ceil(Math.max(margins.top,plotOffset.top)),plotOffset.bottom=Math.ceil(Math.max(margins.bottom,plotOffset.bottom))}function setupGrid(){var i,axes=allAxes(),showGrid=options.grid.show;for(var a in plotOffset){var margin=options.grid.margin||0;plotOffset[a]="number"==typeof margin?margin:margin[a]||0}executeHooks(hooks.processOffset,[plotOffset]);for(var a in plotOffset)plotOffset[a]+="object"==typeof options.grid.borderWidth?showGrid?options.grid.borderWidth[a]:0:showGrid?options.grid.borderWidth:0;if($.each(axes,function(_,axis){axis.show=axis.options.show,null==axis.show&&(axis.show=axis.used),axis.reserveSpace=axis.show||axis.options.reserveSpace,setRange(axis)}),showGrid){var allocatedAxes=$.grep(axes,function(axis){return axis.reserveSpace});for($.each(allocatedAxes,function(_,axis){setupTickGeneration(axis),setTicks(axis),snapRangeToTicks(axis,axis.ticks),measureTickLabels(axis)}),i=allocatedAxes.length-1;i>=0;--i)allocateAxisBoxFirstPhase(allocatedAxes[i]);adjustLayoutForThingsStickingOut(),$.each(allocatedAxes,function(_,axis){allocateAxisBoxSecondPhase(axis)})}plotWidth=surface.width-plotOffset.left-plotOffset.right,plotHeight=surface.height-plotOffset.bottom-plotOffset.top,$.each(axes,function(_,axis){setTransformationHelpers(axis)}),showGrid&&drawAxisLabels(),insertLegend()}function setRange(axis){var opts=axis.options,min=+(null!=opts.min?opts.min:axis.datamin),max=+(null!=opts.max?opts.max:axis.datamax),delta=max-min;if(0==delta){var widen=0==max?1:.01;null==opts.min&&(min-=widen),(null==opts.max||null!=opts.min)&&(max+=widen)}else{var margin=opts.autoscaleMargin;null!=margin&&(null==opts.min&&(min-=delta*margin,0>min&&null!=axis.datamin&&axis.datamin>=0&&(min=0)),null==opts.max&&(max+=delta*margin,max>0&&null!=axis.datamax&&axis.datamax<=0&&(max=0)))}axis.min=min,axis.max=max}function setupTickGeneration(axis){var noTicks,opts=axis.options;noTicks="number"==typeof opts.ticks&&opts.ticks>0?opts.ticks:.3*Math.sqrt("x"==axis.direction?surface.width:surface.height);var delta=(axis.max-axis.min)/noTicks,dec=-Math.floor(Math.log(delta)/Math.LN10),maxDec=opts.tickDecimals;null!=maxDec&&dec>maxDec&&(dec=maxDec);var size,magn=Math.pow(10,-dec),norm=delta/magn;if(1.5>norm?size=1:3>norm?(size=2,norm>2.25&&(null==maxDec||maxDec>=dec+1)&&(size=2.5,++dec)):size=7.5>norm?5:10,size*=magn,null!=opts.minTickSize&&size<opts.minTickSize&&(size=opts.minTickSize),axis.delta=delta,axis.tickDecimals=Math.max(0,null!=maxDec?maxDec:dec),axis.tickSize=opts.tickSize||size,"time"==opts.mode&&!axis.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(axis.tickGenerator||(axis.tickGenerator=function(axis){var prev,ticks=[],start=floorInBase(axis.min,axis.tickSize),i=0,v=Number.NaN;do prev=v,v=start+i*axis.tickSize,ticks.push(v),++i;while(v<axis.max&&v!=prev);return ticks},axis.tickFormatter=function(value,axis){var factor=axis.tickDecimals?Math.pow(10,axis.tickDecimals):1,formatted=""+Math.round(value*factor)/factor;if(null!=axis.tickDecimals){var decimal=formatted.indexOf("."),precision=-1==decimal?0:formatted.length-decimal-1;if(precision<axis.tickDecimals)return(precision?formatted:formatted+".")+(""+factor).substr(1,axis.tickDecimals-precision)}return formatted}),$.isFunction(opts.tickFormatter)&&(axis.tickFormatter=function(v,axis){return""+opts.tickFormatter(v,axis)}),null!=opts.alignTicksWithAxis){var otherAxis=("x"==axis.direction?xaxes:yaxes)[opts.alignTicksWithAxis-1];if(otherAxis&&otherAxis.used&&otherAxis!=axis){var niceTicks=axis.tickGenerator(axis);if(niceTicks.length>0&&(null==opts.min&&(axis.min=Math.min(axis.min,niceTicks[0])),null==opts.max&&niceTicks.length>1&&(axis.max=Math.max(axis.max,niceTicks[niceTicks.length-1]))),axis.tickGenerator=function(axis){var v,i,ticks=[];for(i=0;i<otherAxis.ticks.length;++i)v=(otherAxis.ticks[i].v-otherAxis.min)/(otherAxis.max-otherAxis.min),v=axis.min+v*(axis.max-axis.min),ticks.push(v);return ticks},!axis.mode&&null==opts.tickDecimals){var extraDec=Math.max(0,-Math.floor(Math.log(axis.delta)/Math.LN10)+1),ts=axis.tickGenerator(axis);ts.length>1&&/\..*0$/.test((ts[1]-ts[0]).toFixed(extraDec))||(axis.tickDecimals=extraDec)}}}}function setTicks(axis){var oticks=axis.options.ticks,ticks=[];null==oticks||"number"==typeof oticks&&oticks>0?ticks=axis.tickGenerator(axis):oticks&&(ticks=$.isFunction(oticks)?oticks(axis):oticks);var i,v;for(axis.ticks=[],i=0;i<ticks.length;++i){var label=null,t=ticks[i];"object"==typeof t?(v=+t[0],t.length>1&&(label=t[1])):v=+t,null==label&&(label=axis.tickFormatter(v,axis)),isNaN(v)||axis.ticks.push({v:v,label:label})}}function snapRangeToTicks(axis,ticks){axis.options.autoscaleMargin&&ticks.length>0&&(null==axis.options.min&&(axis.min=Math.min(axis.min,ticks[0].v)),null==axis.options.max&&ticks.length>1&&(axis.max=Math.max(axis.max,ticks[ticks.length-1].v)))}function draw(){surface.clear(),executeHooks(hooks.drawBackground,[ctx]);var grid=options.grid;grid.show&&grid.backgroundColor&&drawBackground(),grid.show&&!grid.aboveData&&drawGrid();for(var i=0;i<series.length;++i)executeHooks(hooks.drawSeries,[ctx,series[i]]),drawSeries(series[i]);executeHooks(hooks.draw,[ctx]),grid.show&&grid.aboveData&&drawGrid(),surface.render(),triggerRedrawOverlay()}function extractRange(ranges,coord){for(var axis,from,to,key,axes=allAxes(),i=0;i<axes.length;++i)if(axis=axes[i],axis.direction==coord&&(key=coord+axis.n+"axis",ranges[key]||1!=axis.n||(key=coord+"axis"),ranges[key])){from=ranges[key].from,to=ranges[key].to;break}if(ranges[key]||(axis="x"==coord?xaxes[0]:yaxes[0],from=ranges[coord+"1"],to=ranges[coord+"2"]),null!=from&&null!=to&&from>to){var tmp=from;from=to,to=tmp}return{from:from,to:to,axis:axis}}function drawBackground(){ctx.save(),ctx.translate(plotOffset.left,plotOffset.top),ctx.fillStyle=getColorOrGradient(options.grid.backgroundColor,plotHeight,0,"rgba(255, 255, 255, 0)"),ctx.fillRect(0,0,plotWidth,plotHeight),ctx.restore()}function drawGrid(){var i,axes,bw,bc;ctx.save(),ctx.translate(plotOffset.left,plotOffset.top);var markings=options.grid.markings;if(markings)for($.isFunction(markings)&&(axes=plot.getAxes(),axes.xmin=axes.xaxis.min,axes.xmax=axes.xaxis.max,axes.ymin=axes.yaxis.min,axes.ymax=axes.yaxis.max,markings=markings(axes)),i=0;i<markings.length;++i){var m=markings[i],xrange=extractRange(m,"x"),yrange=extractRange(m,"y");null==xrange.from&&(xrange.from=xrange.axis.min),null==xrange.to&&(xrange.to=xrange.axis.max),null==yrange.from&&(yrange.from=yrange.axis.min),null==yrange.to&&(yrange.to=yrange.axis.max),xrange.to<xrange.axis.min||xrange.from>xrange.axis.max||yrange.to<yrange.axis.min||yrange.from>yrange.axis.max||(xrange.from=Math.max(xrange.from,xrange.axis.min),xrange.to=Math.min(xrange.to,xrange.axis.max),yrange.from=Math.max(yrange.from,yrange.axis.min),yrange.to=Math.min(yrange.to,yrange.axis.max),(xrange.from!=xrange.to||yrange.from!=yrange.to)&&(xrange.from=xrange.axis.p2c(xrange.from),xrange.to=xrange.axis.p2c(xrange.to),yrange.from=yrange.axis.p2c(yrange.from),yrange.to=yrange.axis.p2c(yrange.to),xrange.from==xrange.to||yrange.from==yrange.to?(ctx.beginPath(),ctx.strokeStyle=m.color||options.grid.markingsColor,ctx.lineWidth=m.lineWidth||options.grid.markingsLineWidth,ctx.moveTo(xrange.from,yrange.from),ctx.lineTo(xrange.to,yrange.to),ctx.stroke()):(ctx.fillStyle=m.color||options.grid.markingsColor,ctx.fillRect(xrange.from,yrange.to,xrange.to-xrange.from,yrange.from-yrange.to))))}axes=allAxes(),bw=options.grid.borderWidth;for(var j=0;j<axes.length;++j){var x,y,xoff,yoff,axis=axes[j],box=axis.box,t=axis.tickLength;if(axis.show&&0!=axis.ticks.length){for(ctx.lineWidth=1,"x"==axis.direction?(x=0,y="full"==t?"top"==axis.position?0:plotHeight:box.top-plotOffset.top+("top"==axis.position?box.height:0)):(y=0,x="full"==t?"left"==axis.position?0:plotWidth:box.left-plotOffset.left+("left"==axis.position?box.width:0)),axis.innermost||(ctx.strokeStyle=axis.options.color,ctx.beginPath(),xoff=yoff=0,"x"==axis.direction?xoff=plotWidth+1:yoff=plotHeight+1,1==ctx.lineWidth&&("x"==axis.direction?y=Math.floor(y)+.5:x=Math.floor(x)+.5),ctx.moveTo(x,y),ctx.lineTo(x+xoff,y+yoff),ctx.stroke()),ctx.strokeStyle=axis.options.tickColor,ctx.beginPath(),i=0;i<axis.ticks.length;++i){var v=axis.ticks[i].v;xoff=yoff=0,isNaN(v)||v<axis.min||v>axis.max||"full"==t&&("object"==typeof bw&&bw[axis.position]>0||bw>0)&&(v==axis.min||v==axis.max)||("x"==axis.direction?(x=axis.p2c(v),yoff="full"==t?-plotHeight:t,"top"==axis.position&&(yoff=-yoff)):(y=axis.p2c(v),xoff="full"==t?-plotWidth:t,"left"==axis.position&&(xoff=-xoff)),1==ctx.lineWidth&&("x"==axis.direction?x=Math.floor(x)+.5:y=Math.floor(y)+.5),ctx.moveTo(x,y),ctx.lineTo(x+xoff,y+yoff))}ctx.stroke()}}bw&&(bc=options.grid.borderColor,"object"==typeof bw||"object"==typeof bc?("object"!=typeof bw&&(bw={top:bw,right:bw,bottom:bw,left:bw}),"object"!=typeof bc&&(bc={top:bc,right:bc,bottom:bc,left:bc}),bw.top>0&&(ctx.strokeStyle=bc.top,ctx.lineWidth=bw.top,ctx.beginPath(),ctx.moveTo(0-bw.left,0-bw.top/2),ctx.lineTo(plotWidth,0-bw.top/2),ctx.stroke()),bw.right>0&&(ctx.strokeStyle=bc.right,ctx.lineWidth=bw.right,ctx.beginPath(),ctx.moveTo(plotWidth+bw.right/2,0-bw.top),ctx.lineTo(plotWidth+bw.right/2,plotHeight),ctx.stroke()),bw.bottom>0&&(ctx.strokeStyle=bc.bottom,ctx.lineWidth=bw.bottom,ctx.beginPath(),ctx.moveTo(plotWidth+bw.right,plotHeight+bw.bottom/2),ctx.lineTo(0,plotHeight+bw.bottom/2),ctx.stroke()),bw.left>0&&(ctx.strokeStyle=bc.left,ctx.lineWidth=bw.left,ctx.beginPath(),ctx.moveTo(0-bw.left/2,plotHeight+bw.bottom),ctx.lineTo(0-bw.left/2,0),ctx.stroke())):(ctx.lineWidth=bw,ctx.strokeStyle=options.grid.borderColor,ctx.strokeRect(-bw/2,-bw/2,plotWidth+bw,plotHeight+bw))),ctx.restore()}function drawAxisLabels(){$.each(allAxes(),function(_,axis){var tick,x,y,halign,valign,box=axis.box,legacyStyles=axis.direction+"Axis "+axis.direction+axis.n+"Axis",layer="flot-"+axis.direction+"-axis flot-"+axis.direction+axis.n+"-axis "+legacyStyles,font=axis.options.font||"flot-tick-label tickLabel";if(surface.removeText(layer),axis.show&&0!=axis.ticks.length)for(var i=0;i<axis.ticks.length;++i)tick=axis.ticks[i],!tick.label||tick.v<axis.min||tick.v>axis.max||("x"==axis.direction?(halign="center",x=plotOffset.left+axis.p2c(tick.v),"bottom"==axis.position?y=box.top+box.padding:(y=box.top+box.height-box.padding,valign="bottom")):(valign="middle",y=plotOffset.top+axis.p2c(tick.v),"left"==axis.position?(x=box.left+box.width-box.padding,halign="right"):x=box.left+box.padding),surface.addText(layer,x,y,tick.label,font,null,null,halign,valign))})}function drawSeries(series){series.lines.show&&drawSeriesLines(series),series.bars.show&&drawSeriesBars(series),series.points.show&&drawSeriesPoints(series)}function drawSeriesLines(series){function plotLine(datapoints,xoffset,yoffset,axisx,axisy){var points=datapoints.points,ps=datapoints.pointsize,prevx=null,prevy=null;ctx.beginPath();for(var i=ps;i<points.length;i+=ps){var x1=points[i-ps],y1=points[i-ps+1],x2=points[i],y2=points[i+1];if(null!=x1&&null!=x2){if(y2>=y1&&y1<axisy.min){if(y2<axisy.min)continue;x1=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1,y1=axisy.min}else if(y1>=y2&&y2<axisy.min){if(y1<axisy.min)continue;x2=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1,y2=axisy.min}if(y1>=y2&&y1>axisy.max){if(y2>axisy.max)continue;x1=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1,y1=axisy.max}else if(y2>=y1&&y2>axisy.max){if(y1>axisy.max)continue;x2=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1,y2=axisy.max}if(x2>=x1&&x1<axisx.min){if(x2<axisx.min)continue;y1=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1,x1=axisx.min}else if(x1>=x2&&x2<axisx.min){if(x1<axisx.min)continue;y2=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1,x2=axisx.min}if(x1>=x2&&x1>axisx.max){if(x2>axisx.max)continue;y1=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1,x1=axisx.max}else if(x2>=x1&&x2>axisx.max){if(x1>axisx.max)continue;y2=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1,x2=axisx.max}(x1!=prevx||y1!=prevy)&&ctx.moveTo(axisx.p2c(x1)+xoffset,axisy.p2c(y1)+yoffset),prevx=x2,prevy=y2,ctx.lineTo(axisx.p2c(x2)+xoffset,axisy.p2c(y2)+yoffset)}}ctx.stroke()}function plotLineArea(datapoints,axisx,axisy){for(var points=datapoints.points,ps=datapoints.pointsize,bottom=Math.min(Math.max(0,axisy.min),axisy.max),i=0,areaOpen=!1,ypos=1,segmentStart=0,segmentEnd=0;;){if(ps>0&&i>points.length+ps)break;i+=ps;var x1=points[i-ps],y1=points[i-ps+ypos],x2=points[i],y2=points[i+ypos];if(areaOpen){if(ps>0&&null!=x1&&null==x2){segmentEnd=i,ps=-ps,ypos=2;continue}if(0>ps&&i==segmentStart+ps){ctx.fill(),areaOpen=!1,ps=-ps,ypos=1,i=segmentStart=segmentEnd+ps;continue}}if(null!=x1&&null!=x2){if(x2>=x1&&x1<axisx.min){if(x2<axisx.min)continue;y1=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1,x1=axisx.min}else if(x1>=x2&&x2<axisx.min){if(x1<axisx.min)continue;y2=(axisx.min-x1)/(x2-x1)*(y2-y1)+y1,x2=axisx.min}if(x1>=x2&&x1>axisx.max){if(x2>axisx.max)continue;y1=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1,x1=axisx.max}else if(x2>=x1&&x2>axisx.max){if(x1>axisx.max)continue;y2=(axisx.max-x1)/(x2-x1)*(y2-y1)+y1,x2=axisx.max}if(areaOpen||(ctx.beginPath(),ctx.moveTo(axisx.p2c(x1),axisy.p2c(bottom)),areaOpen=!0),y1>=axisy.max&&y2>=axisy.max)ctx.lineTo(axisx.p2c(x1),axisy.p2c(axisy.max)),ctx.lineTo(axisx.p2c(x2),axisy.p2c(axisy.max));else if(y1<=axisy.min&&y2<=axisy.min)ctx.lineTo(axisx.p2c(x1),axisy.p2c(axisy.min)),ctx.lineTo(axisx.p2c(x2),axisy.p2c(axisy.min));else{var x1old=x1,x2old=x2;y2>=y1&&y1<axisy.min&&y2>=axisy.min?(x1=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1,y1=axisy.min):y1>=y2&&y2<axisy.min&&y1>=axisy.min&&(x2=(axisy.min-y1)/(y2-y1)*(x2-x1)+x1,y2=axisy.min),y1>=y2&&y1>axisy.max&&y2<=axisy.max?(x1=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1,y1=axisy.max):y2>=y1&&y2>axisy.max&&y1<=axisy.max&&(x2=(axisy.max-y1)/(y2-y1)*(x2-x1)+x1,y2=axisy.max),x1!=x1old&&ctx.lineTo(axisx.p2c(x1old),axisy.p2c(y1)),ctx.lineTo(axisx.p2c(x1),axisy.p2c(y1)),ctx.lineTo(axisx.p2c(x2),axisy.p2c(y2)),x2!=x2old&&(ctx.lineTo(axisx.p2c(x2),axisy.p2c(y2)),ctx.lineTo(axisx.p2c(x2old),axisy.p2c(y2)))}}}}ctx.save(),ctx.translate(plotOffset.left,plotOffset.top),ctx.lineJoin="round";var lw=series.lines.lineWidth,sw=series.shadowSize;if(lw>0&&sw>0){ctx.lineWidth=sw,ctx.strokeStyle="rgba(0,0,0,0.1)";var angle=Math.PI/18;plotLine(series.datapoints,Math.sin(angle)*(lw/2+sw/2),Math.cos(angle)*(lw/2+sw/2),series.xaxis,series.yaxis),ctx.lineWidth=sw/2,plotLine(series.datapoints,Math.sin(angle)*(lw/2+sw/4),Math.cos(angle)*(lw/2+sw/4),series.xaxis,series.yaxis)}ctx.lineWidth=lw,ctx.strokeStyle=series.color;var fillStyle=getFillStyle(series.lines,series.color,0,plotHeight);fillStyle&&(ctx.fillStyle=fillStyle,plotLineArea(series.datapoints,series.xaxis,series.yaxis)),lw>0&&plotLine(series.datapoints,0,0,series.xaxis,series.yaxis),ctx.restore()}function drawSeriesPoints(series){function plotPoints(datapoints,radius,fillStyle,offset,shadow,axisx,axisy,symbol){for(var points=datapoints.points,ps=datapoints.pointsize,i=0;i<points.length;i+=ps){var x=points[i],y=points[i+1];null==x||x<axisx.min||x>axisx.max||y<axisy.min||y>axisy.max||(ctx.beginPath(),x=axisx.p2c(x),y=axisy.p2c(y)+offset,"circle"==symbol?ctx.arc(x,y,radius,0,shadow?Math.PI:2*Math.PI,!1):symbol(ctx,x,y,radius,shadow),ctx.closePath(),fillStyle&&(ctx.fillStyle=fillStyle,ctx.fill()),ctx.stroke())}}ctx.save(),ctx.translate(plotOffset.left,plotOffset.top);var lw=series.points.lineWidth,sw=series.shadowSize,radius=series.points.radius,symbol=series.points.symbol;
if(0==lw&&(lw=1e-4),lw>0&&sw>0){var w=sw/2;ctx.lineWidth=w,ctx.strokeStyle="rgba(0,0,0,0.1)",plotPoints(series.datapoints,radius,null,w+w/2,!0,series.xaxis,series.yaxis,symbol),ctx.strokeStyle="rgba(0,0,0,0.2)",plotPoints(series.datapoints,radius,null,w/2,!0,series.xaxis,series.yaxis,symbol)}ctx.lineWidth=lw,ctx.strokeStyle=series.color,plotPoints(series.datapoints,radius,getFillStyle(series.points,series.color),0,!1,series.xaxis,series.yaxis,symbol),ctx.restore()}function drawBar(x,y,b,barLeft,barRight,fillStyleCallback,axisx,axisy,c,horizontal,lineWidth){var left,right,bottom,top,drawLeft,drawRight,drawTop,drawBottom,tmp;horizontal?(drawBottom=drawRight=drawTop=!0,drawLeft=!1,left=b,right=x,top=y+barLeft,bottom=y+barRight,left>right&&(tmp=right,right=left,left=tmp,drawLeft=!0,drawRight=!1)):(drawLeft=drawRight=drawTop=!0,drawBottom=!1,left=x+barLeft,right=x+barRight,bottom=b,top=y,bottom>top&&(tmp=top,top=bottom,bottom=tmp,drawBottom=!0,drawTop=!1)),right<axisx.min||left>axisx.max||top<axisy.min||bottom>axisy.max||(left<axisx.min&&(left=axisx.min,drawLeft=!1),right>axisx.max&&(right=axisx.max,drawRight=!1),bottom<axisy.min&&(bottom=axisy.min,drawBottom=!1),top>axisy.max&&(top=axisy.max,drawTop=!1),left=axisx.p2c(left),bottom=axisy.p2c(bottom),right=axisx.p2c(right),top=axisy.p2c(top),fillStyleCallback&&(c.fillStyle=fillStyleCallback(bottom,top),c.fillRect(left,top,right-left,bottom-top)),lineWidth>0&&(drawLeft||drawRight||drawTop||drawBottom)&&(c.beginPath(),c.moveTo(left,bottom),drawLeft?c.lineTo(left,top):c.moveTo(left,top),drawTop?c.lineTo(right,top):c.moveTo(right,top),drawRight?c.lineTo(right,bottom):c.moveTo(right,bottom),drawBottom?c.lineTo(left,bottom):c.moveTo(left,bottom),c.stroke()))}function drawSeriesBars(series){function plotBars(datapoints,barLeft,barRight,fillStyleCallback,axisx,axisy){for(var points=datapoints.points,ps=datapoints.pointsize,i=0;i<points.length;i+=ps)null!=points[i]&&drawBar(points[i],points[i+1],points[i+2],barLeft,barRight,fillStyleCallback,axisx,axisy,ctx,series.bars.horizontal,series.bars.lineWidth)}ctx.save(),ctx.translate(plotOffset.left,plotOffset.top),ctx.lineWidth=series.bars.lineWidth,ctx.strokeStyle=series.color;var barLeft;switch(series.bars.align){case"left":barLeft=0;break;case"right":barLeft=-series.bars.barWidth;break;default:barLeft=-series.bars.barWidth/2}var fillStyleCallback=series.bars.fill?function(bottom,top){return getFillStyle(series.bars,series.color,bottom,top)}:null;plotBars(series.datapoints,barLeft,barLeft+series.bars.barWidth,fillStyleCallback,series.xaxis,series.yaxis),ctx.restore()}function getFillStyle(filloptions,seriesColor,bottom,top){var fill=filloptions.fill;if(!fill)return null;if(filloptions.fillColor)return getColorOrGradient(filloptions.fillColor,bottom,top,seriesColor);var c=$.color.parse(seriesColor);return c.a="number"==typeof fill?fill:.4,c.normalize(),c.toString()}function insertLegend(){if(null!=options.legend.container?$(options.legend.container).html(""):placeholder.find(".legend").remove(),options.legend.show){for(var s,label,fragments=[],entries=[],rowStarted=!1,lf=options.legend.labelFormatter,i=0;i<series.length;++i)s=series[i],s.label&&(label=lf?lf(s.label,s):s.label,label&&entries.push({label:label,color:s.color}));if(options.legend.sorted)if($.isFunction(options.legend.sorted))entries.sort(options.legend.sorted);else if("reverse"==options.legend.sorted)entries.reverse();else{var ascending="descending"!=options.legend.sorted;entries.sort(function(a,b){return a.label==b.label?0:a.label<b.label!=ascending?1:-1})}for(var i=0;i<entries.length;++i){var entry=entries[i];0==i%options.legend.noColumns&&(rowStarted&&fragments.push("</tr>"),fragments.push("<tr>"),rowStarted=!0),fragments.push('<td class="legendColorBox"><div style="border:1px solid '+options.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+entry.color+';overflow:hidden"></div></div></td>'+'<td class="legendLabel">'+entry.label+"</td>")}if(rowStarted&&fragments.push("</tr>"),0!=fragments.length){var table='<table style="font-size:smaller;color:'+options.grid.color+'">'+fragments.join("")+"</table>";if(null!=options.legend.container)$(options.legend.container).html(table);else{var pos="",p=options.legend.position,m=options.legend.margin;null==m[0]&&(m=[m,m]),"n"==p.charAt(0)?pos+="top:"+(m[1]+plotOffset.top)+"px;":"s"==p.charAt(0)&&(pos+="bottom:"+(m[1]+plotOffset.bottom)+"px;"),"e"==p.charAt(1)?pos+="right:"+(m[0]+plotOffset.right)+"px;":"w"==p.charAt(1)&&(pos+="left:"+(m[0]+plotOffset.left)+"px;");var legend=$('<div class="legend">'+table.replace('style="','style="position:absolute;'+pos+";")+"</div>").appendTo(placeholder);if(0!=options.legend.backgroundOpacity){var c=options.legend.backgroundColor;null==c&&(c=options.grid.backgroundColor,c=c&&"string"==typeof c?$.color.parse(c):$.color.extract(legend,"background-color"),c.a=1,c=c.toString());var div=legend.children();$('<div style="position:absolute;width:'+div.width()+"px;height:"+div.height()+"px;"+pos+"background-color:"+c+';"> </div>').prependTo(legend).css("opacity",options.legend.backgroundOpacity)}}}}}function findNearbyItem(mouseX,mouseY,seriesFilter){var i,j,ps,maxDistance=options.grid.mouseActiveRadius,smallestDistance=maxDistance*maxDistance+1,item=null;for(i=series.length-1;i>=0;--i)if(seriesFilter(series[i])){var s=series[i],axisx=s.xaxis,axisy=s.yaxis,points=s.datapoints.points,mx=axisx.c2p(mouseX),my=axisy.c2p(mouseY),maxx=maxDistance/axisx.scale,maxy=maxDistance/axisy.scale;if(ps=s.datapoints.pointsize,axisx.options.inverseTransform&&(maxx=Number.MAX_VALUE),axisy.options.inverseTransform&&(maxy=Number.MAX_VALUE),s.lines.show||s.points.show)for(j=0;j<points.length;j+=ps){var x=points[j],y=points[j+1];if(null!=x&&!(x-mx>maxx||-maxx>x-mx||y-my>maxy||-maxy>y-my)){var dx=Math.abs(axisx.p2c(x)-mouseX),dy=Math.abs(axisy.p2c(y)-mouseY),dist=dx*dx+dy*dy;smallestDistance>dist&&(smallestDistance=dist,item=[i,j/ps])}}if(s.bars.show&&!item){var barLeft,barRight;switch(s.bars.align){case"left":barLeft=0;break;case"right":barLeft=-s.bars.barWidth;break;default:barLeft=-s.bars.barWidth/2}for(barRight=barLeft+s.bars.barWidth,j=0;j<points.length;j+=ps){var x=points[j],y=points[j+1],b=points[j+2];null!=x&&(series[i].bars.horizontal?mx<=Math.max(b,x)&&mx>=Math.min(b,x)&&my>=y+barLeft&&y+barRight>=my:mx>=x+barLeft&&x+barRight>=mx&&my>=Math.min(b,y)&&my<=Math.max(b,y))&&(item=[i,j/ps])}}}return item?(i=item[0],j=item[1],ps=series[i].datapoints.pointsize,{datapoint:series[i].datapoints.points.slice(j*ps,(j+1)*ps),dataIndex:j,series:series[i],seriesIndex:i}):null}function onMouseMove(e){options.grid.hoverable&&triggerClickHoverEvent("plothover",e,function(s){return 0!=s.hoverable})}function onMouseLeave(e){options.grid.hoverable&&triggerClickHoverEvent("plothover",e,function(){return!1})}function onClick(e){triggerClickHoverEvent("plotclick",e,function(s){return 0!=s.clickable})}function triggerClickHoverEvent(eventname,event,seriesFilter){var offset=eventHolder.offset(),canvasX=event.pageX-offset.left-plotOffset.left,canvasY=event.pageY-offset.top-plotOffset.top,pos=canvasToAxisCoords({left:canvasX,top:canvasY});pos.pageX=event.pageX,pos.pageY=event.pageY;var item=findNearbyItem(canvasX,canvasY,seriesFilter);if(item&&(item.pageX=parseInt(item.series.xaxis.p2c(item.datapoint[0])+offset.left+plotOffset.left,10),item.pageY=parseInt(item.series.yaxis.p2c(item.datapoint[1])+offset.top+plotOffset.top,10)),options.grid.autoHighlight){for(var i=0;i<highlights.length;++i){var h=highlights[i];h.auto!=eventname||item&&h.series==item.series&&h.point[0]==item.datapoint[0]&&h.point[1]==item.datapoint[1]||unhighlight(h.series,h.point)}item&&highlight(item.series,item.datapoint,eventname)}placeholder.trigger(eventname,[pos,item])}function triggerRedrawOverlay(){var t=options.interaction.redrawOverlayInterval;return-1==t?(drawOverlay(),void 0):(redrawTimeout||(redrawTimeout=setTimeout(drawOverlay,t)),void 0)}function drawOverlay(){redrawTimeout=null,octx.save(),overlay.clear(),octx.translate(plotOffset.left,plotOffset.top);var i,hi;for(i=0;i<highlights.length;++i)hi=highlights[i],hi.series.bars.show?drawBarHighlight(hi.series,hi.point):drawPointHighlight(hi.series,hi.point);octx.restore(),executeHooks(hooks.drawOverlay,[octx])}function highlight(s,point,auto){if("number"==typeof s&&(s=series[s]),"number"==typeof point){var ps=s.datapoints.pointsize;point=s.datapoints.points.slice(ps*point,ps*(point+1))}var i=indexOfHighlight(s,point);-1==i?(highlights.push({series:s,point:point,auto:auto}),triggerRedrawOverlay()):auto||(highlights[i].auto=!1)}function unhighlight(s,point){if(null==s&&null==point)return highlights=[],triggerRedrawOverlay(),void 0;if("number"==typeof s&&(s=series[s]),"number"==typeof point){var ps=s.datapoints.pointsize;point=s.datapoints.points.slice(ps*point,ps*(point+1))}var i=indexOfHighlight(s,point);-1!=i&&(highlights.splice(i,1),triggerRedrawOverlay())}function indexOfHighlight(s,p){for(var i=0;i<highlights.length;++i){var h=highlights[i];if(h.series==s&&h.point[0]==p[0]&&h.point[1]==p[1])return i}return-1}function drawPointHighlight(series,point){var x=point[0],y=point[1],axisx=series.xaxis,axisy=series.yaxis,highlightColor="string"==typeof series.highlightColor?series.highlightColor:$.color.parse(series.color).scale("a",.5).toString();if(!(x<axisx.min||x>axisx.max||y<axisy.min||y>axisy.max)){var pointRadius=series.points.radius+series.points.lineWidth/2;octx.lineWidth=pointRadius,octx.strokeStyle=highlightColor;var radius=1.5*pointRadius;x=axisx.p2c(x),y=axisy.p2c(y),octx.beginPath(),"circle"==series.points.symbol?octx.arc(x,y,radius,0,2*Math.PI,!1):series.points.symbol(octx,x,y,radius,!1),octx.closePath(),octx.stroke()}}function drawBarHighlight(series,point){var barLeft,highlightColor="string"==typeof series.highlightColor?series.highlightColor:$.color.parse(series.color).scale("a",.5).toString(),fillStyle=highlightColor;switch(series.bars.align){case"left":barLeft=0;break;case"right":barLeft=-series.bars.barWidth;break;default:barLeft=-series.bars.barWidth/2}octx.lineWidth=series.bars.lineWidth,octx.strokeStyle=highlightColor,drawBar(point[0],point[1],point[2]||0,barLeft,barLeft+series.bars.barWidth,function(){return fillStyle},series.xaxis,series.yaxis,octx,series.bars.horizontal,series.bars.lineWidth)}function getColorOrGradient(spec,bottom,top,defaultColor){if("string"==typeof spec)return spec;for(var gradient=ctx.createLinearGradient(0,top,0,bottom),i=0,l=spec.colors.length;l>i;++i){var c=spec.colors[i];if("string"!=typeof c){var co=$.color.parse(defaultColor);null!=c.brightness&&(co=co.scale("rgb",c.brightness)),null!=c.opacity&&(co.a*=c.opacity),c=co.toString()}gradient.addColorStop(i/(l-1),c)}return gradient}var series=[],options={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},surface=null,overlay=null,eventHolder=null,ctx=null,octx=null,xaxes=[],yaxes=[],plotOffset={left:0,right:0,top:0,bottom:0},plotWidth=0,plotHeight=0,hooks={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},plot=this;plot.setData=setData,plot.setupGrid=setupGrid,plot.draw=draw,plot.getPlaceholder=function(){return placeholder},plot.getCanvas=function(){return surface.element},plot.getPlotOffset=function(){return plotOffset},plot.width=function(){return plotWidth},plot.height=function(){return plotHeight},plot.offset=function(){var o=eventHolder.offset();return o.left+=plotOffset.left,o.top+=plotOffset.top,o},plot.getData=function(){return series},plot.getAxes=function(){var res={};return $.each(xaxes.concat(yaxes),function(_,axis){axis&&(res[axis.direction+(1!=axis.n?axis.n:"")+"axis"]=axis)}),res},plot.getXAxes=function(){return xaxes},plot.getYAxes=function(){return yaxes},plot.c2p=canvasToAxisCoords,plot.p2c=axisToCanvasCoords,plot.getOptions=function(){return options},plot.highlight=highlight,plot.unhighlight=unhighlight,plot.triggerRedrawOverlay=triggerRedrawOverlay,plot.pointOffset=function(point){return{left:parseInt(xaxes[axisNumber(point,"x")-1].p2c(+point.x)+plotOffset.left,10),top:parseInt(yaxes[axisNumber(point,"y")-1].p2c(+point.y)+plotOffset.top,10)}},plot.shutdown=shutdown,plot.destroy=function(){shutdown(),placeholder.removeData("plot").empty(),series=[],options=null,surface=null,overlay=null,eventHolder=null,ctx=null,octx=null,xaxes=[],yaxes=[],hooks=null,highlights=[],plot=null},plot.resize=function(){var width=placeholder.width(),height=placeholder.height();surface.resize(width,height),overlay.resize(width,height)},plot.hooks=hooks,initPlugins(plot),parseOptions(options_),setupCanvases(),setData(data_),setupGrid(),draw(),bindEvents();var highlights=[],redrawTimeout=null}function floorInBase(n,base){return base*Math.floor(n/base)}var hasOwnProperty=Object.prototype.hasOwnProperty;Canvas.prototype.resize=function(width,height){if(0>=width||0>=height)throw new Error("Invalid dimensions for plot, width = "+width+", height = "+height);var element=this.element,context=this.context,pixelRatio=this.pixelRatio;this.width!=width&&(element.width=width*pixelRatio,element.style.width=width+"px",this.width=width),this.height!=height&&(element.height=height*pixelRatio,element.style.height=height+"px",this.height=height),context.restore(),context.save(),context.scale(pixelRatio,pixelRatio)},Canvas.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},Canvas.prototype.render=function(){var cache=this._textCache;for(var layerKey in cache)if(hasOwnProperty.call(cache,layerKey)){var layer=this.getTextLayer(layerKey),layerCache=cache[layerKey];layer.hide();for(var styleKey in layerCache)if(hasOwnProperty.call(layerCache,styleKey)){var styleCache=layerCache[styleKey];for(var key in styleCache)if(hasOwnProperty.call(styleCache,key)){for(var position,positions=styleCache[key].positions,i=0;position=positions[i];i++)position.active?position.rendered||(layer.append(position.element),position.rendered=!0):(positions.splice(i--,1),position.rendered&&position.element.detach());0==positions.length&&delete styleCache[key]}}layer.show()}},Canvas.prototype.getTextLayer=function(classes){var layer=this.text[classes];return null==layer&&(null==this.textContainer&&(this.textContainer=$("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),layer=this.text[classes]=$("<div></div>").addClass(classes).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),layer},Canvas.prototype.getTextInfo=function(layer,text,font,angle,width){var textStyle,layerCache,styleCache,info;if(text=""+text,textStyle="object"==typeof font?font.style+" "+font.variant+" "+font.weight+" "+font.size+"px/"+font.lineHeight+"px "+font.family:font,layerCache=this._textCache[layer],null==layerCache&&(layerCache=this._textCache[layer]={}),styleCache=layerCache[textStyle],null==styleCache&&(styleCache=layerCache[textStyle]={}),info=styleCache[text],null==info){var element=$("<div></div>").html(text).css({position:"absolute","max-width":width,top:-9999}).appendTo(this.getTextLayer(layer));"object"==typeof font?element.css({font:textStyle,color:font.color}):"string"==typeof font&&element.addClass(font),info=styleCache[text]={width:element.outerWidth(!0),height:element.outerHeight(!0),element:element,positions:[]},element.detach()}return info},Canvas.prototype.addText=function(layer,x,y,text,font,angle,width,halign,valign){var info=this.getTextInfo(layer,text,font,angle,width),positions=info.positions;"center"==halign?x-=info.width/2:"right"==halign&&(x-=info.width),"middle"==valign?y-=info.height/2:"bottom"==valign&&(y-=info.height);for(var position,i=0;position=positions[i];i++)if(position.x==x&&position.y==y)return position.active=!0,void 0;position={active:!0,rendered:!1,element:positions.length?info.element.clone():info.element,x:x,y:y},positions.push(position),position.element.css({top:Math.round(y),left:Math.round(x),"text-align":halign})},Canvas.prototype.removeText=function(layer,x,y,text,font,angle){if(null==text){var layerCache=this._textCache[layer];if(null!=layerCache)for(var styleKey in layerCache)if(hasOwnProperty.call(layerCache,styleKey)){var styleCache=layerCache[styleKey];for(var key in styleCache)if(hasOwnProperty.call(styleCache,key))for(var position,positions=styleCache[key].positions,i=0;position=positions[i];i++)position.active=!1}}else for(var position,positions=this.getTextInfo(layer,text,font,angle).positions,i=0;position=positions[i];i++)position.x==x&&position.y==y&&(position.active=!1)},$.plot=function(placeholder,data,options){var plot=new Plot($(placeholder),data,options,$.plot.plugins);return plot},$.plot.version="0.8.2",$.plot.plugins=[],$.fn.plot=function(data,options){return this.each(function(){$.plot(this,data,options)})}}(jQuery),/* Flot plugin for rendering pie charts.

Copyright (c) 2007-2013 IOLA and Ole Laursen.
Licensed under the MIT license.

The plugin assumes that each series has a single data value, and that each
value is a positive integer or zero.  Negative numbers don't make sense for a
pie chart, and have unpredictable results.  The values do NOT need to be
passed in as percentages; the plugin will calculate the total and per-slice
percentages internally.

* Created by Brian Medendorp

* Updated with contributions from btburnett3, Anthony Aragues and Xavi Ivars

The plugin supports these options:

	series: {
		pie: {
			show: true/false
			radius: 0-1 for percentage of fullsize, or a specified pixel length, or 'auto'
			innerRadius: 0-1 for percentage of fullsize or a specified pixel length, for creating a donut effect
			startAngle: 0-2 factor of PI used for starting angle (in radians) i.e 3/2 starts at the top, 0 and 2 have the same result
			tilt: 0-1 for percentage to tilt the pie, where 1 is no tilt, and 0 is completely flat (nothing will show)
			offset: {
				top: integer value to move the pie up or down
				left: integer value to move the pie left or right, or 'auto'
			},
			stroke: {
				color: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#FFF')
				width: integer pixel width of the stroke
			},
			label: {
				show: true/false, or 'auto'
				formatter:  a user-defined function that modifies the text/style of the label text
				radius: 0-1 for percentage of fullsize, or a specified pixel length
				background: {
					color: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#000')
					opacity: 0-1
				},
				threshold: 0-1 for the percentage value at which to hide labels (if they're too small)
			},
			combine: {
				threshold: 0-1 for the percentage value at which to combine slices (if they're too small)
				color: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#CCC'), if null, the plugin will automatically use the color of the first slice to be combined
				label: any text value of what the combined slice should be labeled
			}
			highlight: {
				opacity: 0-1
			}
		}
	}

More detail and specific examples can be found in the included HTML file.

*/
function($){function init(plot){function processDatapoints(plot){processed||(processed=!0,canvas=plot.getCanvas(),target=$(canvas).parent(),options=plot.getOptions(),plot.setData(combine(plot.getData())))}function combine(data){for(var total=0,combined=0,numCombined=0,color=options.series.pie.combine.color,newdata=[],i=0;i<data.length;++i){var value=data[i].data;$.isArray(value)&&1==value.length&&(value=value[0]),$.isArray(value)?value[1]=!isNaN(parseFloat(value[1]))&&isFinite(value[1])?+value[1]:0:value=!isNaN(parseFloat(value))&&isFinite(value)?[1,+value]:[1,0],data[i].data=[value]}for(var i=0;i<data.length;++i)total+=data[i].data[0][1];for(var i=0;i<data.length;++i){var value=data[i].data[0][1];value/total<=options.series.pie.combine.threshold&&(combined+=value,numCombined++,color||(color=data[i].color))}for(var i=0;i<data.length;++i){var value=data[i].data[0][1];(2>numCombined||value/total>options.series.pie.combine.threshold)&&newdata.push({data:[[1,value]],color:data[i].color,label:data[i].label,angle:2*value*Math.PI/total,percent:value/(total/100)})}return numCombined>1&&newdata.push({data:[[1,combined]],color:color,label:options.series.pie.combine.label,angle:2*combined*Math.PI/total,percent:combined/(total/100)}),newdata}function draw(plot,newCtx){function clear(){ctx.clearRect(0,0,canvasWidth,canvasHeight),target.children().filter(".pieLabel, .pieLabelBackground").remove()}function drawShadow(){var shadowLeft=options.series.pie.shadow.left,shadowTop=options.series.pie.shadow.top,edge=10,alpha=options.series.pie.shadow.alpha,radius=options.series.pie.radius>1?options.series.pie.radius:maxRadius*options.series.pie.radius;if(!(radius>=canvasWidth/2-shadowLeft||radius*options.series.pie.tilt>=canvasHeight/2-shadowTop||edge>=radius)){ctx.save(),ctx.translate(shadowLeft,shadowTop),ctx.globalAlpha=alpha,ctx.fillStyle="#000",ctx.translate(centerLeft,centerTop),ctx.scale(1,options.series.pie.tilt);for(var i=1;edge>=i;i++)ctx.beginPath(),ctx.arc(0,0,radius,0,2*Math.PI,!1),ctx.fill(),radius-=i;ctx.restore()}}function drawPie(){function drawSlice(angle,color,fill){0>=angle||isNaN(angle)||(fill?ctx.fillStyle=color:(ctx.strokeStyle=color,ctx.lineJoin="round"),ctx.beginPath(),Math.abs(angle-2*Math.PI)>1e-9&&ctx.moveTo(0,0),ctx.arc(0,0,radius,currentAngle,currentAngle+angle/2,!1),ctx.arc(0,0,radius,currentAngle+angle/2,currentAngle+angle,!1),ctx.closePath(),currentAngle+=angle,fill?ctx.fill():ctx.stroke())}function drawLabels(){function drawLabel(slice,startAngle,index){if(0==slice.data[0][1])return!0;var text,lf=options.legend.labelFormatter,plf=options.series.pie.label.formatter;text=lf?lf(slice.label,slice):slice.label,plf&&(text=plf(text,slice));var halfAngle=(startAngle+slice.angle+startAngle)/2,x=centerLeft+Math.round(Math.cos(halfAngle)*radius),y=centerTop+Math.round(Math.sin(halfAngle)*radius)*options.series.pie.tilt,html="<span class='pieLabel' id='pieLabel"+index+"' style='position:absolute;top:"+y+"px;left:"+x+"px;'>"+text+"</span>";target.append(html);var label=target.children("#pieLabel"+index),labelTop=y-label.height()/2,labelLeft=x-label.width()/2;if(label.css("top",labelTop),label.css("left",labelLeft),0-labelTop>0||0-labelLeft>0||canvasHeight-(labelTop+label.height())<0||canvasWidth-(labelLeft+label.width())<0)return!1;if(0!=options.series.pie.label.background.opacity){var c=options.series.pie.label.background.color;null==c&&(c=slice.color);var pos="top:"+labelTop+"px;left:"+labelLeft+"px;";$("<div class='pieLabelBackground' style='position:absolute;width:"+label.width()+"px;height:"+label.height()+"px;"+pos+"background-color:"+c+";'></div>").css("opacity",options.series.pie.label.background.opacity).insertBefore(label)}return!0}for(var currentAngle=startAngle,radius=options.series.pie.label.radius>1?options.series.pie.label.radius:maxRadius*options.series.pie.label.radius,i=0;i<slices.length;++i){if(slices[i].percent>=100*options.series.pie.label.threshold&&!drawLabel(slices[i],currentAngle,i))return!1;currentAngle+=slices[i].angle}return!0}var startAngle=Math.PI*options.series.pie.startAngle,radius=options.series.pie.radius>1?options.series.pie.radius:maxRadius*options.series.pie.radius;ctx.save(),ctx.translate(centerLeft,centerTop),ctx.scale(1,options.series.pie.tilt),ctx.save();for(var currentAngle=startAngle,i=0;i<slices.length;++i)slices[i].startAngle=currentAngle,drawSlice(slices[i].angle,slices[i].color,!0);if(ctx.restore(),options.series.pie.stroke.width>0){ctx.save(),ctx.lineWidth=options.series.pie.stroke.width,currentAngle=startAngle;for(var i=0;i<slices.length;++i)drawSlice(slices[i].angle,options.series.pie.stroke.color,!1);ctx.restore()}return drawDonutHole(ctx),ctx.restore(),options.series.pie.label.show?drawLabels():!0}if(target){var canvasWidth=plot.getPlaceholder().width(),canvasHeight=plot.getPlaceholder().height(),legendWidth=target.children().filter(".legend").children().width()||0;ctx=newCtx,processed=!1,maxRadius=Math.min(canvasWidth,canvasHeight/options.series.pie.tilt)/2,centerTop=canvasHeight/2+options.series.pie.offset.top,centerLeft=canvasWidth/2,"auto"==options.series.pie.offset.left?(options.legend.position.match("w")?centerLeft+=legendWidth/2:centerLeft-=legendWidth/2,maxRadius>centerLeft?centerLeft=maxRadius:centerLeft>canvasWidth-maxRadius&&(centerLeft=canvasWidth-maxRadius)):centerLeft+=options.series.pie.offset.left;var slices=plot.getData(),attempts=0;do attempts>0&&(maxRadius*=REDRAW_SHRINK),attempts+=1,clear(),options.series.pie.tilt<=.8&&drawShadow();while(!drawPie()&&REDRAW_ATTEMPTS>attempts);attempts>=REDRAW_ATTEMPTS&&(clear(),target.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>")),plot.setSeries&&plot.insertLegend&&(plot.setSeries(slices),plot.insertLegend())}}function drawDonutHole(layer){if(options.series.pie.innerRadius>0){layer.save();var innerRadius=options.series.pie.innerRadius>1?options.series.pie.innerRadius:maxRadius*options.series.pie.innerRadius;layer.globalCompositeOperation="destination-out",layer.beginPath(),layer.fillStyle=options.series.pie.stroke.color,layer.arc(0,0,innerRadius,0,2*Math.PI,!1),layer.fill(),layer.closePath(),layer.restore(),layer.save(),layer.beginPath(),layer.strokeStyle=options.series.pie.stroke.color,layer.arc(0,0,innerRadius,0,2*Math.PI,!1),layer.stroke(),layer.closePath(),layer.restore()}}function isPointInPoly(poly,pt){for(var c=!1,i=-1,l=poly.length,j=l-1;++i<l;j=i)(poly[i][1]<=pt[1]&&pt[1]<poly[j][1]||poly[j][1]<=pt[1]&&pt[1]<poly[i][1])&&pt[0]<(poly[j][0]-poly[i][0])*(pt[1]-poly[i][1])/(poly[j][1]-poly[i][1])+poly[i][0]&&(c=!c);return c}function findNearbySlice(mouseX,mouseY){for(var x,y,slices=plot.getData(),options=plot.getOptions(),radius=options.series.pie.radius>1?options.series.pie.radius:maxRadius*options.series.pie.radius,i=0;i<slices.length;++i){var s=slices[i];if(s.pie.show){if(ctx.save(),ctx.beginPath(),ctx.moveTo(0,0),ctx.arc(0,0,radius,s.startAngle,s.startAngle+s.angle/2,!1),ctx.arc(0,0,radius,s.startAngle+s.angle/2,s.startAngle+s.angle,!1),ctx.closePath(),x=mouseX-centerLeft,y=mouseY-centerTop,ctx.isPointInPath){if(ctx.isPointInPath(mouseX-centerLeft,mouseY-centerTop))return ctx.restore(),{datapoint:[s.percent,s.data],dataIndex:0,series:s,seriesIndex:i}}else{var p1X=radius*Math.cos(s.startAngle),p1Y=radius*Math.sin(s.startAngle),p2X=radius*Math.cos(s.startAngle+s.angle/4),p2Y=radius*Math.sin(s.startAngle+s.angle/4),p3X=radius*Math.cos(s.startAngle+s.angle/2),p3Y=radius*Math.sin(s.startAngle+s.angle/2),p4X=radius*Math.cos(s.startAngle+s.angle/1.5),p4Y=radius*Math.sin(s.startAngle+s.angle/1.5),p5X=radius*Math.cos(s.startAngle+s.angle),p5Y=radius*Math.sin(s.startAngle+s.angle),arrPoly=[[0,0],[p1X,p1Y],[p2X,p2Y],[p3X,p3Y],[p4X,p4Y],[p5X,p5Y]],arrPoint=[x,y];if(isPointInPoly(arrPoly,arrPoint))return ctx.restore(),{datapoint:[s.percent,s.data],dataIndex:0,series:s,seriesIndex:i}}ctx.restore()}}return null}function onMouseMove(e){triggerClickHoverEvent("plothover",e)}function onClick(e){triggerClickHoverEvent("plotclick",e)}function triggerClickHoverEvent(eventname,e){var offset=plot.offset(),canvasX=parseInt(e.pageX-offset.left),canvasY=parseInt(e.pageY-offset.top),item=findNearbySlice(canvasX,canvasY);if(options.grid.autoHighlight)for(var i=0;i<highlights.length;++i){var h=highlights[i];h.auto!=eventname||item&&h.series==item.series||unhighlight(h.series)}item&&highlight(item.series,eventname);var pos={pageX:e.pageX,pageY:e.pageY};target.trigger(eventname,[pos,item])}function highlight(s,auto){var i=indexOfHighlight(s);-1==i?(highlights.push({series:s,auto:auto}),plot.triggerRedrawOverlay()):auto||(highlights[i].auto=!1)}function unhighlight(s){null==s&&(highlights=[],plot.triggerRedrawOverlay());var i=indexOfHighlight(s);-1!=i&&(highlights.splice(i,1),plot.triggerRedrawOverlay())}function indexOfHighlight(s){for(var i=0;i<highlights.length;++i){var h=highlights[i];if(h.series==s)return i}return-1}function drawOverlay(plot,octx){function drawHighlight(series){series.angle<=0||isNaN(series.angle)||(octx.fillStyle="rgba(255, 255, 255, "+options.series.pie.highlight.opacity+")",octx.beginPath(),Math.abs(series.angle-2*Math.PI)>1e-9&&octx.moveTo(0,0),octx.arc(0,0,radius,series.startAngle,series.startAngle+series.angle/2,!1),octx.arc(0,0,radius,series.startAngle+series.angle/2,series.startAngle+series.angle,!1),octx.closePath(),octx.fill())}var options=plot.getOptions(),radius=options.series.pie.radius>1?options.series.pie.radius:maxRadius*options.series.pie.radius;octx.save(),octx.translate(centerLeft,centerTop),octx.scale(1,options.series.pie.tilt);for(var i=0;i<highlights.length;++i)drawHighlight(highlights[i].series);drawDonutHole(octx),octx.restore()}var canvas=null,target=null,options=null,maxRadius=null,centerLeft=null,centerTop=null,processed=!1,ctx=null,highlights=[];plot.hooks.processOptions.push(function(plot,options){options.series.pie.show&&(options.grid.show=!1,"auto"==options.series.pie.label.show&&(options.series.pie.label.show=options.legend.show?!1:!0),"auto"==options.series.pie.radius&&(options.series.pie.radius=options.series.pie.label.show?.75:1),options.series.pie.tilt>1?options.series.pie.tilt=1:options.series.pie.tilt<0&&(options.series.pie.tilt=0))}),plot.hooks.bindEvents.push(function(plot,eventHolder){var options=plot.getOptions();options.series.pie.show&&(options.grid.hoverable&&eventHolder.unbind("mousemove").mousemove(onMouseMove),options.grid.clickable&&eventHolder.unbind("click").click(onClick))}),plot.hooks.processDatapoints.push(function(plot,series,data,datapoints){var options=plot.getOptions();options.series.pie.show&&processDatapoints(plot,series,data,datapoints)}),plot.hooks.drawOverlay.push(function(plot,octx){var options=plot.getOptions();options.series.pie.show&&drawOverlay(plot,octx)}),plot.hooks.draw.push(function(plot,newCtx){var options=plot.getOptions();options.series.pie.show&&draw(plot,newCtx)})}var REDRAW_ATTEMPTS=10,REDRAW_SHRINK=.95,options={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(label,slice){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+slice.color+";'>"+label+"<br/>"+Math.round(slice.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}}}};$.plot.plugins.push({init:init,options:options,name:"pie",version:"1.1"})}(jQuery),function($){function init(plot){plot.hooks.draw.push(function(plot,ctx){$.each(plot.getData(),function(ii,series){if(series.valueLabels.show){var showLastValue=series.valueLabels.showLastValue,showAsHtml=series.valueLabels.showAsHtml,plotAxis=series.valueLabels.plotAxis,labelFormatter=series.valueLabels.labelFormatter,fontcolor=series.valueLabels.fontcolor;series.valueLabels.xoffset,series.valueLabels.yoffset;var align=series.valueLabels.align,font=series.valueLabels.font,hideZero=series.valueLabels.hideZero;series.seriesIndex=ii,showAsHtml&&plot.getPlaceholder().find("#valueLabels"+ii).remove();for(var html='<div id="valueLabels'+series.seriesIndex+'" class="valueLabels">',last_val=null,last_x=-1e3,last_y=-1e3,categories="categories"==series.xaxis.options.mode,i=0;i<series.data.length;++i)if(!(null===series.data[i]||showLastValue&&i!=series.data.length-1)){var x=series.data[i][0],y=series.data[i][1];if(categories&&(x=series.xaxis.categories[x]),!(x<series.xaxis.min||x>series.xaxis.max||y<series.yaxis.min||y>series.yaxis.max)){var val="x"===plotAxis?x:y;if(null==val&&(val=""),(0!==val||!hideZero)&&(series.valueLabels.valueLabelFunc&&(val=series.valueLabels.valueLabelFunc({series:series,seriesIndex:ii,index:i})),val=""+val,val=labelFormatter(val),val!=last_val||i==series.data.length-1)){var xx=series.xaxis.p2c(x)+plot.getPlotOffset().left,yy=series.yaxis.p2c(y)-12+plot.getPlotOffset().top;if(Math.abs(yy-last_y)>20||xx>last_x)if(last_val=val,last_x=xx+8*val.length,last_y=yy,showAsHtml){var head='<div style="left:'+xx+"px;top:"+yy+'px;" class="valueLabel',tail='">'+val+"</div>";html+=head+"Light"+tail+head+tail}else x_pos=xx,y_pos=yy+6,0>=yy&&(y_pos=18),xx>=plot.width()&&(x_pos=plot.width()),font&&(ctx.font=font),"undefined"!=typeof fontcolor&&(ctx.fillStyle=fontcolor),ctx.shadowOffsetX=0,ctx.shadowOffsetY=0,ctx.shadowBlur=1.5,"undefined"!=typeof fontcolor&&(ctx.shadowColor=fontcolor),ctx.textAlign=align,ctx.fillText(val,x_pos,y_pos)}}}showAsHtml&&(html+="</div>",plot.getPlaceholder().append(html))}})})}var options={series:{valueLabels:{show:!1,showAsHtml:!1,showLastValue:!1,labelFormatter:function(v){return v},align:"start",plotAxis:"y",hideZero:!1}}};$.plot.plugins.push({init:init,options:options,name:"valueLabels",version:"1.2"})}(jQuery),/**
 * Copyright (c) 2011-2013 Felix Gnass
 * Licensed under the MIT license
 */
function(root,factory){"object"==typeof exports?module.exports=factory():"function"==typeof define&&define.amd?define(factory):root.Spinner=factory()}(this,function(){"use strict";function createEl(tag,prop){var n,el=document.createElement(tag||"div");for(n in prop)el[n]=prop[n];return el}function ins(parent){for(var i=1,n=arguments.length;n>i;i++)parent.appendChild(arguments[i]);return parent}function addAnimation(alpha,trail,i,lines){var name=["opacity",trail,~~(100*alpha),i,lines].join("-"),start=.01+100*(i/lines),z=Math.max(1-(1-alpha)/trail*(100-start),alpha),prefix=useCssAnimations.substring(0,useCssAnimations.indexOf("Animation")).toLowerCase(),pre=prefix&&"-"+prefix+"-"||"";return animations[name]||(sheet.insertRule("@"+pre+"keyframes "+name+"{"+"0%{opacity:"+z+"}"+start+"%{opacity:"+alpha+"}"+(start+.01)+"%{opacity:1}"+(start+trail)%100+"%{opacity:"+alpha+"}"+"100%{opacity:"+z+"}"+"}",sheet.cssRules.length),animations[name]=1),name}function vendor(el,prop){var pp,i,s=el.style;for(prop=prop.charAt(0).toUpperCase()+prop.slice(1),i=0;i<prefixes.length;i++)if(pp=prefixes[i]+prop,void 0!==s[pp])return pp;return void 0!==s[prop]?prop:void 0}function css(el,prop){for(var n in prop)el.style[vendor(el,n)||n]=prop[n];return el}function merge(obj){for(var i=1;i<arguments.length;i++){var def=arguments[i];for(var n in def)void 0===obj[n]&&(obj[n]=def[n])}return obj}function pos(el){for(var o={x:el.offsetLeft,y:el.offsetTop};el=el.offsetParent;)o.x+=el.offsetLeft,o.y+=el.offsetTop;return o}function getColor(color,idx){return"string"==typeof color?color:color[idx%color.length]}function Spinner(o){return"undefined"==typeof this?new Spinner(o):(this.opts=merge(o||{},Spinner.defaults,defaults),void 0)}function initVML(){function vml(tag,attr){return createEl("<"+tag+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',attr)}sheet.addRule(".spin-vml","behavior:url(#default#VML)"),Spinner.prototype.lines=function(el,o){function grp(){return css(vml("group",{coordsize:s+" "+s,coordorigin:-r+" "+-r}),{width:s,height:s})}function seg(i,dx,filter){ins(g,ins(css(grp(),{rotation:360/o.lines*i+"deg",left:~~dx}),ins(css(vml("roundrect",{arcsize:o.corners}),{width:r,height:o.width,left:o.radius,top:-o.width>>1,filter:filter}),vml("fill",{color:getColor(o.color,i),opacity:o.opacity}),vml("stroke",{opacity:0}))))}var i,r=o.length+o.width,s=2*r,margin=2*-(o.width+o.length)+"px",g=css(grp(),{position:"absolute",top:margin,left:margin});if(o.shadow)for(i=1;i<=o.lines;i++)seg(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=o.lines;i++)seg(i);return ins(el,g)},Spinner.prototype.opacity=function(el,i,val,o){var c=el.firstChild;o=o.shadow&&o.lines||0,c&&i+o<c.childNodes.length&&(c=c.childNodes[i+o],c=c&&c.firstChild,c=c&&c.firstChild,c&&(c.opacity=val))}}var useCssAnimations,prefixes=["webkit","Moz","ms","O"],animations={},sheet=function(){var el=createEl("style",{type:"text/css"});return ins(document.getElementsByTagName("head")[0],el),el.sheet||el.styleSheet}(),defaults={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};Spinner.defaults={},merge(Spinner.prototype,{spin:function(target){this.stop();var ep,tp,self=this,o=self.opts,el=self.el=css(createEl(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex}),mid=o.radius+o.length+o.width;if(target&&(target.insertBefore(el,target.firstChild||null),tp=pos(target),ep=pos(el),css(el,{left:("auto"==o.left?tp.x-ep.x+(target.offsetWidth>>1):parseInt(o.left,10)+mid)+"px",top:("auto"==o.top?tp.y-ep.y+(target.offsetHeight>>1):parseInt(o.top,10)+mid)+"px"})),el.setAttribute("role","progressbar"),self.lines(el,self.opts),!useCssAnimations){var alpha,i=0,start=(o.lines-1)*(1-o.direction)/2,fps=o.fps,f=fps/o.speed,ostep=(1-o.opacity)/(f*o.trail/100),astep=f/o.lines;!function anim(){i++;for(var j=0;j<o.lines;j++)alpha=Math.max(1-(i+(o.lines-j)*astep)%f*ostep,o.opacity),self.opacity(el,j*o.direction+start,alpha,o);self.timeout=self.el&&setTimeout(anim,~~(1e3/fps))}()}return self},stop:function(){var el=this.el;return el&&(clearTimeout(this.timeout),el.parentNode&&el.parentNode.removeChild(el),this.el=void 0),this},lines:function(el,o){function fill(color,shadow){return css(createEl(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:color,boxShadow:shadow,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*i+o.rotate)+"deg) translate("+o.radius+"px"+",0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(var seg,i=0,start=(o.lines-1)*(1-o.direction)/2;i<o.lines;i++)seg=css(createEl(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:useCssAnimations&&addAnimation(o.opacity,o.trail,start+i*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&ins(seg,css(fill("#000","0 0 4px #000"),{top:"2px"})),ins(el,ins(seg,fill(getColor(o.color,i),"0 0 1px rgba(0,0,0,.1)")));return el},opacity:function(el,i,val){i<el.childNodes.length&&(el.childNodes[i].style.opacity=val)}});var probe=css(createEl("group"),{behavior:"url(#default#VML)"});return!vendor(probe,"transform")&&probe.adj?initVML():useCssAnimations=vendor(probe,"animation"),Spinner}),/**
 * Copyright (c) 2011-2013 Felix Gnass
 * Licensed under the MIT license
 */
function(factory){if("object"==typeof exports)factory(require("jquery"),require("spin"));else if("function"==typeof define&&define.amd)define(["jquery","spin"],factory);else{if(!window.Spinner)throw new Error("Spin.js not present");factory(window.jQuery,window.Spinner)}}(function($,Spinner){$.fn.spin=function(opts,color){return this.each(function(){var $this=$(this),data=$this.data();data.spinner&&(data.spinner.stop(),delete data.spinner),opts!==!1&&(opts=$.extend({color:color||$this.css("color")},$.fn.spin.presets[opts]||opts),data.spinner=new Spinner(opts).spin(this))})},$.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}}),function(window,$,undefined){"use strict";function paletteTemplate(p,color,className,opts){for(var html=[],i=0;i<p.length;i++){var current=p[i];if(current){var tiny=tinycolor(current),c=tiny.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(color,current)?" sp-thumb-active":"";var formattedString=tiny.toString(opts.preferredFormat||"rgb"),swatchStyle=rgbaSupport?"background-color:"+tiny.toRgbString():"filter:"+tiny.toFilter();html.push('<span title="'+formattedString+'" data-color="'+tiny.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+swatchStyle+';" /></span>')}else{var cls="sp-clear-display";html.push($("<div />").append($('<span data-color="" style="background-color:transparent;" class="'+cls+'"></span>').attr("title",opts.noColorSelectedText)).html())}}return"<div class='sp-cf "+className+"'>"+html.join("")+"</div>"}function hideAll(){for(var i=0;i<spectrums.length;i++)spectrums[i]&&spectrums[i].hide()}function instanceOptions(o,callbackContext){var opts=$.extend({},defaultOpts,o);return opts.callbacks={move:bind(opts.move,callbackContext),change:bind(opts.change,callbackContext),show:bind(opts.show,callbackContext),hide:bind(opts.hide,callbackContext),beforeShow:bind(opts.beforeShow,callbackContext)},opts}function spectrum(element,o){function applyOptions(){if(opts.showPaletteOnly&&(opts.showPalette=!0),toggleButton.text(opts.showPaletteOnly?opts.togglePaletteMoreText:opts.togglePaletteLessText),opts.palette){palette=opts.palette.slice(0),paletteArray=$.isArray(palette[0])?palette:[palette],paletteLookup={};for(var i=0;i<paletteArray.length;i++)for(var j=0;j<paletteArray[i].length;j++){var rgb=tinycolor(paletteArray[i][j]).toRgbString();paletteLookup[rgb]=!0}}container.toggleClass("sp-flat",flat),container.toggleClass("sp-input-disabled",!opts.showInput),container.toggleClass("sp-alpha-enabled",opts.showAlpha),container.toggleClass("sp-clear-enabled",allowEmpty),container.toggleClass("sp-buttons-disabled",!opts.showButtons),container.toggleClass("sp-palette-buttons-disabled",!opts.togglePaletteOnly),container.toggleClass("sp-palette-disabled",!opts.showPalette),container.toggleClass("sp-palette-only",opts.showPaletteOnly),container.toggleClass("sp-initial-disabled",!opts.showInitial),container.addClass(opts.className).addClass(opts.containerClassName),reflow()}function initialize(){function paletteElementClick(e){return e.data&&e.data.ignore?(set($(e.target).closest(".sp-thumb-el").data("color")),move()):(set($(e.target).closest(".sp-thumb-el").data("color")),move(),updateOriginalInput(!0),opts.hideAfterPaletteSelect&&hide()),!1}if(IE&&container.find("*:not(input)").attr("unselectable","on"),applyOptions(),shouldReplace&&boundElement.after(replacer).hide(),allowEmpty||clearButton.hide(),flat)boundElement.after(container).hide();else{var appendTo="parent"===opts.appendTo?boundElement.parent():$(opts.appendTo);1!==appendTo.length&&(appendTo=$("body")),appendTo.append(container)}updateSelectionPaletteFromStorage(),offsetElement.bind("click.spectrum touchstart.spectrum",function(e){disabled||toggle(),e.stopPropagation(),$(e.target).is("input")||e.preventDefault()}),(boundElement.is(":disabled")||opts.disabled===!0)&&disable(),container.click(stopPropagation),textInput.change(setFromTextInput),textInput.bind("paste",function(){setTimeout(setFromTextInput,1)}),textInput.keydown(function(e){13==e.keyCode&&setFromTextInput()}),cancelButton.text(opts.cancelText),cancelButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),revert(),hide()}),clearButton.attr("title",opts.clearText),clearButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),isEmpty=!0,move(),flat&&updateOriginalInput(!0)}),chooseButton.text(opts.chooseText),chooseButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),isValid()&&(updateOriginalInput(!0),hide())}),toggleButton.text(opts.showPaletteOnly?opts.togglePaletteMoreText:opts.togglePaletteLessText),toggleButton.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),opts.showPaletteOnly=!opts.showPaletteOnly,opts.showPaletteOnly||flat||container.css("left","-="+(pickerContainer.outerWidth(!0)+5)),applyOptions()}),draggable(alphaSlider,function(dragX,dragY,e){currentAlpha=dragX/alphaWidth,isEmpty=!1,e.shiftKey&&(currentAlpha=Math.round(10*currentAlpha)/10),move()},dragStart,dragStop),draggable(slider,function(dragX,dragY){currentHue=parseFloat(dragY/slideHeight),isEmpty=!1,opts.showAlpha||(currentAlpha=1),move()},dragStart,dragStop),draggable(dragger,function(dragX,dragY,e){if(e.shiftKey){if(!shiftMovementDirection){var oldDragX=currentSaturation*dragWidth,oldDragY=dragHeight-currentValue*dragHeight,furtherFromX=Math.abs(dragX-oldDragX)>Math.abs(dragY-oldDragY);shiftMovementDirection=furtherFromX?"x":"y"}}else shiftMovementDirection=null;var setSaturation=!shiftMovementDirection||"x"===shiftMovementDirection,setValue=!shiftMovementDirection||"y"===shiftMovementDirection;setSaturation&&(currentSaturation=parseFloat(dragX/dragWidth)),setValue&&(currentValue=parseFloat((dragHeight-dragY)/dragHeight)),isEmpty=!1,opts.showAlpha||(currentAlpha=1),move()},dragStart,dragStop),initialColor?(set(initialColor),updateUI(),currentPreferredFormat=preferredFormat||tinycolor(initialColor).format,addColorToSelectionPalette(initialColor)):updateUI(),flat&&show();var paletteEvent=IE?"mousedown.spectrum":"click.spectrum touchstart.spectrum";paletteContainer.delegate(".sp-thumb-el",paletteEvent,paletteElementClick),initialColorContainer.delegate(".sp-thumb-el:nth-child(1)",paletteEvent,{ignore:!0},paletteElementClick)}function updateSelectionPaletteFromStorage(){if(localStorageKey&&window.localStorage){try{var oldPalette=window.localStorage[localStorageKey].split(",#");oldPalette.length>1&&(delete window.localStorage[localStorageKey],$.each(oldPalette,function(i,c){addColorToSelectionPalette(c)}))}catch(e){}try{selectionPalette=window.localStorage[localStorageKey].split(";")}catch(e){}}}function addColorToSelectionPalette(color){if(showSelectionPalette){var rgb=tinycolor(color).toRgbString();if(!paletteLookup[rgb]&&-1===$.inArray(rgb,selectionPalette))for(selectionPalette.push(rgb);selectionPalette.length>maxSelectionSize;)selectionPalette.shift();if(localStorageKey&&window.localStorage)try{window.localStorage[localStorageKey]=selectionPalette.join(";")}catch(e){}}}function getUniqueSelectionPalette(){var unique=[];if(opts.showPalette)for(var i=0;i<selectionPalette.length;i++){var rgb=tinycolor(selectionPalette[i]).toRgbString();paletteLookup[rgb]||unique.push(selectionPalette[i])}return unique.reverse().slice(0,opts.maxSelectionSize)}function drawPalette(){var currentColor=get(),html=$.map(paletteArray,function(palette,i){return paletteTemplate(palette,currentColor,"sp-palette-row sp-palette-row-"+i,opts)});updateSelectionPaletteFromStorage(),selectionPalette&&html.push(paletteTemplate(getUniqueSelectionPalette(),currentColor,"sp-palette-row sp-palette-row-selection",opts)),paletteContainer.html(html.join(""))}function drawInitial(){if(opts.showInitial){var initial=colorOnShow,current=get();initialColorContainer.html(paletteTemplate([initial,current],current,"sp-palette-row-initial",opts))}}function dragStart(){(0>=dragHeight||0>=dragWidth||0>=slideHeight)&&reflow(),container.addClass(draggingClass),shiftMovementDirection=null,boundElement.trigger("dragstart.spectrum",[get()])}function dragStop(){container.removeClass(draggingClass),boundElement.trigger("dragstop.spectrum",[get()])}function setFromTextInput(){var value=textInput.val();if(null!==value&&""!==value||!allowEmpty){var tiny=tinycolor(value);tiny.isValid()?(set(tiny),updateOriginalInput(!0)):textInput.addClass("sp-validation-error")}else set(null),updateOriginalInput(!0)}function toggle(){visible?hide():show()}function show(){var event=$.Event("beforeShow.spectrum");return visible?(reflow(),void 0):(boundElement.trigger(event,[get()]),callbacks.beforeShow(get())===!1||event.isDefaultPrevented()||(hideAll(),visible=!0,$(doc).bind("click.spectrum",clickout),$(window).bind("resize.spectrum",resize),replacer.addClass("sp-active"),container.removeClass("sp-hidden"),reflow(),updateUI(),colorOnShow=get(),drawInitial(),callbacks.show(colorOnShow),boundElement.trigger("show.spectrum",[colorOnShow])),void 0)}function clickout(e){e&&"click"==e.type&&2==e.button||(clickoutFiresChange?updateOriginalInput(!0):revert(),hide())}function hide(){visible&&!flat&&(visible=!1,$(doc).unbind("click.spectrum",clickout),$(window).unbind("resize.spectrum",resize),replacer.removeClass("sp-active"),container.addClass("sp-hidden"),callbacks.hide(get()),boundElement.trigger("hide.spectrum",[get()]))}function revert(){set(colorOnShow,!0)}function set(color,ignoreFormatChange){if(tinycolor.equals(color,get()))return updateUI(),void 0;var newColor,newHsv;!color&&allowEmpty?isEmpty=!0:(isEmpty=!1,newColor=tinycolor(color),newHsv=newColor.toHsv(),currentHue=newHsv.h%360/360,currentSaturation=newHsv.s,currentValue=newHsv.v,currentAlpha=newHsv.a),updateUI(),newColor&&newColor.isValid()&&!ignoreFormatChange&&(currentPreferredFormat=preferredFormat||newColor.getFormat())}function get(opts){return opts=opts||{},allowEmpty&&isEmpty?null:tinycolor.fromRatio({h:currentHue,s:currentSaturation,v:currentValue,a:Math.round(100*currentAlpha)/100},{format:opts.format||currentPreferredFormat})}function isValid(){return!textInput.hasClass("sp-validation-error")}function move(){updateUI(),callbacks.move(get()),boundElement.trigger("move.spectrum",[get()])}function updateUI(){textInput.removeClass("sp-validation-error"),updateHelperLocations();var flatColor=tinycolor.fromRatio({h:currentHue,s:1,v:1});dragger.css("background-color",flatColor.toHexString());var format=currentPreferredFormat;1>currentAlpha&&(0!==currentAlpha||"name"!==format)&&("hex"===format||"hex3"===format||"hex6"===format||"name"===format)&&(format="rgb");var realColor=get({format:format}),displayColor="";if(previewElement.removeClass("sp-clear-display"),previewElement.css("background-color","transparent"),!realColor&&allowEmpty)previewElement.addClass("sp-clear-display");else{var realHex=realColor.toHexString(),realRgb=realColor.toRgbString();if(rgbaSupport||1===realColor.alpha?previewElement.css("background-color",realRgb):(previewElement.css("background-color","transparent"),previewElement.css("filter",realColor.toFilter())),opts.showAlpha){var rgb=realColor.toRgb();rgb.a=0;var realAlpha=tinycolor(rgb).toRgbString(),gradient="linear-gradient(left, "+realAlpha+", "+realHex+")";IE?alphaSliderInner.css("filter",tinycolor(realAlpha).toFilter({gradientType:1},realHex)):(alphaSliderInner.css("background","-webkit-"+gradient),alphaSliderInner.css("background","-moz-"+gradient),alphaSliderInner.css("background","-ms-"+gradient),alphaSliderInner.css("background","linear-gradient(to right, "+realAlpha+", "+realHex+")"))}displayColor=realColor.toString(format)}opts.showInput&&textInput.val(displayColor),opts.showPalette&&drawPalette(),drawInitial()}function updateHelperLocations(){var s=currentSaturation,v=currentValue;if(allowEmpty&&isEmpty)alphaSlideHelper.hide(),slideHelper.hide(),dragHelper.hide();else{alphaSlideHelper.show(),slideHelper.show(),dragHelper.show();var dragX=s*dragWidth,dragY=dragHeight-v*dragHeight;dragX=Math.max(-dragHelperHeight,Math.min(dragWidth-dragHelperHeight,dragX-dragHelperHeight)),dragY=Math.max(-dragHelperHeight,Math.min(dragHeight-dragHelperHeight,dragY-dragHelperHeight)),dragHelper.css({top:dragY+"px",left:dragX+"px"});var alphaX=currentAlpha*alphaWidth;alphaSlideHelper.css({left:alphaX-alphaSlideHelperWidth/2+"px"});var slideY=currentHue*slideHeight;slideHelper.css({top:slideY-slideHelperHeight+"px"})}}function updateOriginalInput(fireCallback){var color=get(),displayColor="",hasChanged=!tinycolor.equals(color,colorOnShow);color&&(displayColor=color.toString(currentPreferredFormat),addColorToSelectionPalette(color)),isInput&&boundElement.val(displayColor),fireCallback&&hasChanged&&(callbacks.change(color),boundElement.trigger("change",[color]))}function reflow(){dragWidth=dragger.width(),dragHeight=dragger.height(),dragHelperHeight=dragHelper.height(),slideWidth=slider.width(),slideHeight=slider.height(),slideHelperHeight=slideHelper.height(),alphaWidth=alphaSlider.width(),alphaSlideHelperWidth=alphaSlideHelper.width(),flat||(container.css("position","absolute"),container.offset(getOffset(container,offsetElement))),updateHelperLocations(),opts.showPalette&&drawPalette(),boundElement.trigger("reflow.spectrum")}function destroy(){boundElement.show(),offsetElement.unbind("click.spectrum touchstart.spectrum"),container.remove(),replacer.remove(),spectrums[spect.id]=null}function option(optionName,optionValue){return optionName===undefined?$.extend({},opts):optionValue===undefined?opts[optionName]:(opts[optionName]=optionValue,applyOptions(),void 0)}function enable(){disabled=!1,boundElement.attr("disabled",!1),offsetElement.removeClass("sp-disabled")}function disable(){hide(),disabled=!0,boundElement.attr("disabled",!0),offsetElement.addClass("sp-disabled")}var opts=instanceOptions(o,element),flat=opts.flat,showSelectionPalette=opts.showSelectionPalette,localStorageKey=opts.localStorageKey,theme=opts.theme,callbacks=opts.callbacks,resize=throttle(reflow,10),visible=!1,dragWidth=0,dragHeight=0,dragHelperHeight=0,slideHeight=0,slideWidth=0,alphaWidth=0,alphaSlideHelperWidth=0,slideHelperHeight=0,currentHue=0,currentSaturation=0,currentValue=0,currentAlpha=1,palette=[],paletteArray=[],paletteLookup={},selectionPalette=opts.selectionPalette.slice(0),maxSelectionSize=opts.maxSelectionSize,draggingClass="sp-dragging",shiftMovementDirection=null,doc=element.ownerDocument,boundElement=(doc.body,$(element)),disabled=!1,container=$(markup,doc).addClass(theme),pickerContainer=container.find(".sp-picker-container"),dragger=container.find(".sp-color"),dragHelper=container.find(".sp-dragger"),slider=container.find(".sp-hue"),slideHelper=container.find(".sp-slider"),alphaSliderInner=container.find(".sp-alpha-inner"),alphaSlider=container.find(".sp-alpha"),alphaSlideHelper=container.find(".sp-alpha-handle"),textInput=container.find(".sp-input"),paletteContainer=container.find(".sp-palette"),initialColorContainer=container.find(".sp-initial"),cancelButton=container.find(".sp-cancel"),clearButton=container.find(".sp-clear"),chooseButton=container.find(".sp-choose"),toggleButton=container.find(".sp-palette-toggle"),isInput=boundElement.is("input"),isInputTypeColor=isInput&&inputTypeColorSupport&&"color"===boundElement.attr("type"),shouldReplace=isInput&&!flat,replacer=shouldReplace?$(replaceInput).addClass(theme).addClass(opts.className).addClass(opts.replacerClassName):$([]),offsetElement=shouldReplace?replacer:boundElement,previewElement=replacer.find(".sp-preview-inner"),initialColor=opts.color||isInput&&boundElement.val(),colorOnShow=!1,preferredFormat=opts.preferredFormat,currentPreferredFormat=preferredFormat,clickoutFiresChange=!opts.showButtons||opts.clickoutFiresChange,isEmpty=!initialColor,allowEmpty=opts.allowEmpty&&!isInputTypeColor;initialize();var spect={show:show,hide:hide,toggle:toggle,reflow:reflow,option:option,enable:enable,disable:disable,set:function(c){set(c),updateOriginalInput()},get:get,destroy:destroy,container:container};return spect.id=spectrums.push(spect)-1,spect}function getOffset(picker,input){var extraY=0,dpWidth=picker.outerWidth(),dpHeight=picker.outerHeight(),inputHeight=input.outerHeight(),doc=picker[0].ownerDocument,docElem=doc.documentElement,viewWidth=docElem.clientWidth+$(doc).scrollLeft(),viewHeight=docElem.clientHeight+$(doc).scrollTop(),offset=input.offset();return offset.top+=inputHeight,offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0),offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight-extraY):extraY),offset}function noop(){}function stopPropagation(e){e.stopPropagation()}function bind(func,obj){var slice=Array.prototype.slice,args=slice.call(arguments,2);return function(){return func.apply(obj,args.concat(slice.call(arguments)))}}function draggable(element,onmove,onstart,onstop){function prevent(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function move(e){if(dragging){if(IE&&doc.documentMode<9&&!e.button)return stop();var touches=e.originalEvent.touches,pageX=touches?touches[0].pageX:e.pageX,pageY=touches?touches[0].pageY:e.pageY,dragX=Math.max(0,Math.min(pageX-offset.left,maxWidth)),dragY=Math.max(0,Math.min(pageY-offset.top,maxHeight));hasTouch&&prevent(e),onmove.apply(element,[dragX,dragY,e])}}function start(e){var rightclick=e.which?3==e.which:2==e.button;rightclick||dragging||onstart.apply(element,arguments)!==!1&&(dragging=!0,maxHeight=$(element).height(),maxWidth=$(element).width(),offset=$(element).offset(),$(doc).bind(duringDragEvents),$(doc.body).addClass("sp-dragging"),hasTouch||move(e),prevent(e))}function stop(){dragging&&($(doc).unbind(duringDragEvents),$(doc.body).removeClass("sp-dragging"),onstop.apply(element,arguments)),dragging=!1}onmove=onmove||function(){},onstart=onstart||function(){},onstop=onstop||function(){};var doc=document,dragging=!1,offset={},maxHeight=0,maxWidth=0,hasTouch="ontouchstart"in window,duringDragEvents={};duringDragEvents.selectstart=prevent,duringDragEvents.dragstart=prevent,duringDragEvents["touchmove mousemove"]=move,duringDragEvents["touchend mouseup"]=stop,$(element).bind("touchstart mousedown",start)}function throttle(func,wait,debounce){var timeout;return function(){var context=this,args=arguments,throttler=function(){timeout=null,func.apply(context,args)};debounce&&clearTimeout(timeout),(debounce||!timeout)&&(timeout=setTimeout(throttler,wait))}}var defaultOpts={beforeShow:noop,move:noop,change:noop,show:noop,hide:noop,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1},spectrums=[],IE=!!/msie/i.exec(window.navigator.userAgent),rgbaSupport=function(){function contains(str,substr){return!!~(""+str).indexOf(substr)}var elem=document.createElement("div"),style=elem.style;return style.cssText="background-color:rgba(0,0,0,.5)",contains(style.backgroundColor,"rgba")||contains(style.backgroundColor,"hsla")}(),inputTypeColorSupport=function(){var colorInput=$("<input type='color' value='!' />")[0];return"color"===colorInput.type&&"!"!==colorInput.value}(),replaceInput=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),markup=function(){var gradientFix="";if(IE)for(var i=1;6>=i;i++)gradientFix+="<div class='sp-"+i+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",gradientFix,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),dataID="spectrum.id";$.fn.spectrum=function(opts){if("string"==typeof opts){var returnValue=this,args=Array.prototype.slice.call(arguments,1);return this.each(function(){var spect=spectrums[$(this).data(dataID)];if(spect){var method=spect[opts];if(!method)throw new Error("Spectrum: no such method: '"+opts+"'");"get"==opts?returnValue=spect.get():"container"==opts?returnValue=spect.container:"option"==opts?returnValue=spect.option.apply(spect,args):"destroy"==opts?(spect.destroy(),$(this).removeData(dataID)):method.apply(spect,args)}}),returnValue}return this.spectrum("destroy").each(function(){var options=$.extend({},opts,$(this).data()),spect=spectrum(this,options);$(this).data(dataID,spect.id)})},$.fn.spectrum.load=!0,$.fn.spectrum.loadOpts={},$.fn.spectrum.draggable=draggable,$.fn.spectrum.defaults=defaultOpts,$.spectrum={},$.spectrum.localization={},$.spectrum.palettes={},$.fn.spectrum.processNativeColorInputs=function(){inputTypeColorSupport||$("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function inputToRGB(color){var rgb={r:0,g:0,b:0},a=1,ok=!1,format=!1;return"string"==typeof color&&(color=stringInputToObject(color)),"object"==typeof color&&(color.hasOwnProperty("r")&&color.hasOwnProperty("g")&&color.hasOwnProperty("b")?(rgb=rgbToRgb(color.r,color.g,color.b),ok=!0,format="%"===String(color.r).substr(-1)?"prgb":"rgb"):color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("v")?(color.s=convertToPercentage(color.s),color.v=convertToPercentage(color.v),rgb=hsvToRgb(color.h,color.s,color.v),ok=!0,format="hsv"):color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("l")&&(color.s=convertToPercentage(color.s),color.l=convertToPercentage(color.l),rgb=hslToRgb(color.h,color.s,color.l),ok=!0,format="hsl"),color.hasOwnProperty("a")&&(a=color.a)),a=boundAlpha(a),{ok:ok,format:color.format||format,r:mathMin(255,mathMax(rgb.r,0)),g:mathMin(255,mathMax(rgb.g,0)),b:mathMin(255,mathMax(rgb.b,0)),a:a}}function rgbToRgb(r,g,b){return{r:255*bound01(r,255),g:255*bound01(g,255),b:255*bound01(b,255)}}function rgbToHsl(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(b>g?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,l:l}}function hslToRgb(h,s,l){function hue2rgb(p,q,t){return 0>t&&(t+=1),t>1&&(t-=1),1/6>t?p+6*(q-p)*t:.5>t?q:2/3>t?p+6*(q-p)*(2/3-t):p}var r,g,b;if(h=bound01(h,360),s=bound01(s,100),l=bound01(l,100),0===s)r=g=b=l;else{var q=.5>l?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return{r:255*r,g:255*g,b:255*b}}function rgbToHsv(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),v=max,d=max-min;if(s=0===max?0:d/max,max==min)h=0;else{switch(max){case r:h=(g-b)/d+(b>g?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,v:v}}function hsvToRgb(h,s,v){h=6*bound01(h,360),s=bound01(s,100),v=bound01(v,100);var i=math.floor(h),f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6,r=[v,q,p,p,t,v][mod],g=[t,v,v,q,p,p][mod],b=[p,p,t,v,v,q][mod];return{r:255*r,g:255*g,b:255*b}}function rgbToHex(r,g,b,allow3Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return allow3Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)?hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0):hex.join("")}function rgbaToHex(r,g,b,a){var hex=[pad2(convertDecimalToHex(a)),pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return hex.join("")}function desaturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s-=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function saturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s+=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function greyscale(color){return tinycolor(color).desaturate(100)}function lighten(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l+=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function brighten(color,amount){amount=0===amount?0:amount||10;var rgb=tinycolor(color).toRgb();return rgb.r=mathMax(0,mathMin(255,rgb.r-mathRound(255*-(amount/100)))),rgb.g=mathMax(0,mathMin(255,rgb.g-mathRound(255*-(amount/100)))),rgb.b=mathMax(0,mathMin(255,rgb.b-mathRound(255*-(amount/100)))),tinycolor(rgb)}function darken(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l-=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function spin(color,amount){var hsl=tinycolor(color).toHsl(),hue=(mathRound(hsl.h)+amount)%360;return hsl.h=0>hue?360+hue:hue,tinycolor(hsl)}function complement(color){var hsl=tinycolor(color).toHsl();return hsl.h=(hsl.h+180)%360,tinycolor(hsl)}function triad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+120)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+240)%360,s:hsl.s,l:hsl.l})]}function tetrad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+90)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+180)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+270)%360,s:hsl.s,l:hsl.l})]}function splitcomplement(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+72)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+216)%360,s:hsl.s,l:hsl.l})]}function analogous(color,results,slices){results=results||6,slices=slices||30;var hsl=tinycolor(color).toHsl(),part=360/slices,ret=[tinycolor(color)];for(hsl.h=(hsl.h-(part*results>>1)+720)%360;--results;)hsl.h=(hsl.h+part)%360,ret.push(tinycolor(hsl));return ret}function monochromatic(color,results){results=results||6;for(var hsv=tinycolor(color).toHsv(),h=hsv.h,s=hsv.s,v=hsv.v,ret=[],modification=1/results;results--;)ret.push(tinycolor({h:h,s:s,v:v})),v=(v+modification)%1;return ret}function flip(o){var flipped={};for(var i in o)o.hasOwnProperty(i)&&(flipped[o[i]]=i);return flipped}function boundAlpha(a){return a=parseFloat(a),(isNaN(a)||0>a||a>1)&&(a=1),a}function bound01(n,max){isOnePointZero(n)&&(n="100%");var processPercent=isPercentage(n);return n=mathMin(max,mathMax(0,parseFloat(n))),processPercent&&(n=parseInt(n*max,10)/100),math.abs(n-max)<1e-6?1:n%max/parseFloat(max)}function clamp01(val){return mathMin(1,mathMax(0,val))}function parseIntFromHex(val){return parseInt(val,16)}function isOnePointZero(n){return"string"==typeof n&&-1!=n.indexOf(".")&&1===parseFloat(n)}function isPercentage(n){return"string"==typeof n&&-1!=n.indexOf("%")}function pad2(c){return 1==c.length?"0"+c:""+c}function convertToPercentage(n){return 1>=n&&(n=100*n+"%"),n}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(h){return parseIntFromHex(h)/255}function stringInputToObject(color){color=color.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var named=!1;if(names[color])color=names[color],named=!0;else if("transparent"==color)return{r:0,g:0,b:0,a:0,format:"name"};var match;return(match=matchers.rgb.exec(color))?{r:match[1],g:match[2],b:match[3]}:(match=matchers.rgba.exec(color))?{r:match[1],g:match[2],b:match[3],a:match[4]}:(match=matchers.hsl.exec(color))?{h:match[1],s:match[2],l:match[3]}:(match=matchers.hsla.exec(color))?{h:match[1],s:match[2],l:match[3],a:match[4]}:(match=matchers.hsv.exec(color))?{h:match[1],s:match[2],v:match[3]}:(match=matchers.hex8.exec(color))?{a:convertHexToDecimal(match[1]),r:parseIntFromHex(match[2]),g:parseIntFromHex(match[3]),b:parseIntFromHex(match[4]),format:named?"name":"hex8"}:(match=matchers.hex6.exec(color))?{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),format:named?"name":"hex"}:(match=matchers.hex3.exec(color))?{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),format:named?"name":"hex"}:!1}var trimLeft=/^[\s,#]+/,trimRight=/\s+$/,tinyCounter=0,math=Math,mathRound=math.round,mathMin=math.min,mathMax=math.max,mathRandom=math.random,tinycolor=function tinycolor(color,opts){if(color=color?color:"",opts=opts||{},color instanceof tinycolor)return color;if(!(this instanceof tinycolor))return new tinycolor(color,opts);var rgb=inputToRGB(color);this._r=rgb.r,this._g=rgb.g,this._b=rgb.b,this._a=rgb.a,this._roundA=mathRound(100*this._a)/100,this._format=opts.format||rgb.format,this._gradientType=opts.gradientType,this._r<1&&(this._r=mathRound(this._r)),this._g<1&&(this._g=mathRound(this._g)),this._b<1&&(this._b=mathRound(this._b)),this._ok=rgb.ok,this._tc_id=tinyCounter++};tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var rgb=this.toRgb();return(299*rgb.r+587*rgb.g+114*rgb.b)/1e3},setAlpha:function(value){return this._a=boundAlpha(value),this._roundA=mathRound(100*this._a)/100,this},toHsv:function(){var hsv=rgbToHsv(this._r,this._g,this._b);return{h:360*hsv.h,s:hsv.s,v:hsv.v,a:this._a}},toHsvString:function(){var hsv=rgbToHsv(this._r,this._g,this._b),h=mathRound(360*hsv.h),s=mathRound(100*hsv.s),v=mathRound(100*hsv.v);return 1==this._a?"hsv("+h+", "+s+"%, "+v+"%)":"hsva("+h+", "+s+"%, "+v+"%, "+this._roundA+")"},toHsl:function(){var hsl=rgbToHsl(this._r,this._g,this._b);return{h:360*hsl.h,s:hsl.s,l:hsl.l,a:this._a}},toHslString:function(){var hsl=rgbToHsl(this._r,this._g,this._b),h=mathRound(360*hsl.h),s=mathRound(100*hsl.s),l=mathRound(100*hsl.l);return 1==this._a?"hsl("+h+", "+s+"%, "+l+"%)":"hsla("+h+", "+s+"%, "+l+"%, "+this._roundA+")"},toHex:function(allow3Char){return rgbToHex(this._r,this._g,this._b,allow3Char)},toHexString:function(allow3Char){return"#"+this.toHex(allow3Char)},toHex8:function(){return rgbaToHex(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:mathRound(this._r),g:mathRound(this._g),b:mathRound(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+")":"rgba("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound(100*bound01(this._r,255))+"%",g:mathRound(100*bound01(this._g,255))+"%",b:mathRound(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%)":"rgba("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1},toFilter:function(secondColor){var hex8String="#"+rgbaToHex(this._r,this._g,this._b,this._a),secondHex8String=hex8String,gradientType=this._gradientType?"GradientType = 1, ":"";if(secondColor){var s=tinycolor(secondColor);secondHex8String=s.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")"},toString:function(format){var formatSet=!!format;
format=format||this._format;var formattedString=!1,hasAlpha=this._a<1&&this._a>=0,needsAlphaFormat=!formatSet&&hasAlpha&&("hex"===format||"hex6"===format||"hex3"===format||"name"===format);return needsAlphaFormat?"name"===format&&0===this._a?this.toName():this.toRgbString():("rgb"===format&&(formattedString=this.toRgbString()),"prgb"===format&&(formattedString=this.toPercentageRgbString()),("hex"===format||"hex6"===format)&&(formattedString=this.toHexString()),"hex3"===format&&(formattedString=this.toHexString(!0)),"hex8"===format&&(formattedString=this.toHex8String()),"name"===format&&(formattedString=this.toName()),"hsl"===format&&(formattedString=this.toHslString()),"hsv"===format&&(formattedString=this.toHsvString()),formattedString||this.toHexString())},_applyModification:function(fn,args){var color=fn.apply(null,[this].concat([].slice.call(args)));return this._r=color._r,this._g=color._g,this._b=color._b,this.setAlpha(color._a),this},lighten:function(){return this._applyModification(lighten,arguments)},brighten:function(){return this._applyModification(brighten,arguments)},darken:function(){return this._applyModification(darken,arguments)},desaturate:function(){return this._applyModification(desaturate,arguments)},saturate:function(){return this._applyModification(saturate,arguments)},greyscale:function(){return this._applyModification(greyscale,arguments)},spin:function(){return this._applyModification(spin,arguments)},_applyCombination:function(fn,args){return fn.apply(null,[this].concat([].slice.call(args)))},analogous:function(){return this._applyCombination(analogous,arguments)},complement:function(){return this._applyCombination(complement,arguments)},monochromatic:function(){return this._applyCombination(monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement,arguments)},triad:function(){return this._applyCombination(triad,arguments)},tetrad:function(){return this._applyCombination(tetrad,arguments)}},tinycolor.fromRatio=function(color,opts){if("object"==typeof color){var newColor={};for(var i in color)color.hasOwnProperty(i)&&(newColor[i]="a"===i?color[i]:convertToPercentage(color[i]));color=newColor}return tinycolor(color,opts)},tinycolor.equals=function(color1,color2){return color1&&color2?tinycolor(color1).toRgbString()==tinycolor(color2).toRgbString():!1},tinycolor.random=function(){return tinycolor.fromRatio({r:mathRandom(),g:mathRandom(),b:mathRandom()})},tinycolor.mix=function(color1,color2,amount){amount=0===amount?0:amount||50;var w1,rgb1=tinycolor(color1).toRgb(),rgb2=tinycolor(color2).toRgb(),p=amount/100,w=2*p-1,a=rgb2.a-rgb1.a;w1=-1==w*a?w:(w+a)/(1+w*a),w1=(w1+1)/2;var w2=1-w1,rgba={r:rgb2.r*w1+rgb1.r*w2,g:rgb2.g*w1+rgb1.g*w2,b:rgb2.b*w1+rgb1.b*w2,a:rgb2.a*p+rgb1.a*(1-p)};return tinycolor(rgba)},tinycolor.readability=function(color1,color2){var c1=tinycolor(color1),c2=tinycolor(color2),rgb1=c1.toRgb(),rgb2=c2.toRgb(),brightnessA=c1.getBrightness(),brightnessB=c2.getBrightness(),colorDiff=Math.max(rgb1.r,rgb2.r)-Math.min(rgb1.r,rgb2.r)+Math.max(rgb1.g,rgb2.g)-Math.min(rgb1.g,rgb2.g)+Math.max(rgb1.b,rgb2.b)-Math.min(rgb1.b,rgb2.b);return{brightness:Math.abs(brightnessA-brightnessB),color:colorDiff}},tinycolor.isReadable=function(color1,color2){var readability=tinycolor.readability(color1,color2);return readability.brightness>125&&readability.color>500},tinycolor.mostReadable=function(baseColor,colorList){for(var bestColor=null,bestScore=0,bestIsReadable=!1,i=0;i<colorList.length;i++){var readability=tinycolor.readability(baseColor,colorList[i]),readable=readability.brightness>125&&readability.color>500,score=3*(readability.brightness/125)+readability.color/500;(readable&&!bestIsReadable||readable&&bestIsReadable&&score>bestScore||!readable&&!bestIsReadable&&score>bestScore)&&(bestIsReadable=readable,bestScore=score,bestColor=tinycolor(colorList[i]))}return bestColor};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names),matchers=function(){var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:"+CSS_NUMBER+")|(?:"+CSS_INTEGER+")",PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?";return{rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=tinycolor}(),$(function(){$.fn.spectrum.load&&$.fn.spectrum.processNativeColorInputs()})}(window,jQuery),function(root,factory){"use strict";"object"==typeof exports?module.exports=factory(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains")):"function"==typeof define&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],factory):root.URI=factory(root.punycode,root.IPv6,root.SecondLevelDomains,root)}(this,function(punycode,IPv6,SLD,root){"use strict";function URI(url,base){return this instanceof URI?(void 0===url&&(url="undefined"!=typeof location?location.href+"":""),this.href(url),void 0!==base?this.absoluteTo(base):this):new URI(url,base)}function escapeRegEx(string){return string.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function getType(value){return void 0===value?"Undefined":String(Object.prototype.toString.call(value)).slice(8,-1)}function isArray(obj){return"Array"===getType(obj)}function filterArrayValues(data,value){var i,length,lookup={};if(isArray(value))for(i=0,length=value.length;length>i;i++)lookup[value[i]]=!0;else lookup[value]=!0;for(i=0,length=data.length;length>i;i++)void 0!==lookup[data[i]]&&(data.splice(i,1),length--,i--);return data}function arrayContains(list,value){var i,length;if(isArray(value)){for(i=0,length=value.length;length>i;i++)if(!arrayContains(list,value[i]))return!1;return!0}var _type=getType(value);for(i=0,length=list.length;length>i;i++)if("RegExp"===_type){if("string"==typeof list[i]&&list[i].match(value))return!0}else if(list[i]===value)return!0;return!1}function arraysEqual(one,two){if(!isArray(one)||!isArray(two))return!1;if(one.length!==two.length)return!1;one.sort(),two.sort();for(var i=0,l=one.length;l>i;i++)if(one[i]!==two[i])return!1;return!0}function escapeForDumbFirefox36(value){return escape(value)}function strictEncodeURIComponent(string){return encodeURIComponent(string).replace(/[!'()*]/g,escapeForDumbFirefox36).replace(/\*/g,"%2A")}function generateSimpleAccessor(_part){return function(v,build){return void 0===v?this._parts[_part]||"":(this._parts[_part]=v||null,this.build(!build),this)}}function generatePrefixAccessor(_part,_key){return function(v,build){return void 0===v?this._parts[_part]||"":(null!==v&&(v+="",v.charAt(0)===_key&&(v=v.substring(1))),this._parts[_part]=v,this.build(!build),this)}}var _URI=root&&root.URI;URI.version="1.14.1";var p=URI.prototype,hasOwn=Object.prototype.hasOwnProperty;URI._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,duplicateQueryParameters:URI.duplicateQueryParameters,escapeQuerySpace:URI.escapeQuerySpace}},URI.duplicateQueryParameters=!1,URI.escapeQuerySpace=!0,URI.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,URI.idn_expression=/[^a-z0-9\.-]/i,URI.punycode_expression=/(xn--)/i,URI.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,URI.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,URI.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,URI.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/},URI.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},URI.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/,URI.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},URI.getDomAttribute=function(node){if(!node||!node.nodeName)return void 0;var nodeName=node.nodeName.toLowerCase();return"input"===nodeName&&"image"!==node.type?void 0:URI.domAttributes[nodeName]},URI.encode=strictEncodeURIComponent,URI.decode=decodeURIComponent,URI.iso8859=function(){URI.encode=escape,URI.decode=unescape},URI.unicode=function(){URI.encode=strictEncodeURIComponent,URI.decode=decodeURIComponent},URI.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}}},URI.encodeQuery=function(string,escapeQuerySpace){var escaped=URI.encode(string+"");return void 0===escapeQuerySpace&&(escapeQuerySpace=URI.escapeQuerySpace),escapeQuerySpace?escaped.replace(/%20/g,"+"):escaped},URI.decodeQuery=function(string,escapeQuerySpace){string+="",void 0===escapeQuerySpace&&(escapeQuerySpace=URI.escapeQuerySpace);try{return URI.decode(escapeQuerySpace?string.replace(/\+/g,"%20"):string)}catch(e){return string}},URI.recodePath=function(string){for(var segments=(string+"").split("/"),i=0,length=segments.length;length>i;i++)segments[i]=URI.encodePathSegment(URI.decode(segments[i]));return segments.join("/")},URI.decodePath=function(string){for(var segments=(string+"").split("/"),i=0,length=segments.length;length>i;i++)segments[i]=URI.decodePathSegment(segments[i]);return segments.join("/")};var _part,_parts={encode:"encode",decode:"decode"},generateAccessor=function(_group,_part){return function(string){try{return URI[_part](string+"").replace(URI.characters[_group][_part].expression,function(c){return URI.characters[_group][_part].map[c]})}catch(e){return string}}};for(_part in _parts)URI[_part+"PathSegment"]=generateAccessor("pathname",_parts[_part]);URI.encodeReserved=generateAccessor("reserved","encode"),URI.parse=function(string,parts){var pos;return parts||(parts={}),pos=string.indexOf("#"),pos>-1&&(parts.fragment=string.substring(pos+1)||null,string=string.substring(0,pos)),pos=string.indexOf("?"),pos>-1&&(parts.query=string.substring(pos+1)||null,string=string.substring(0,pos)),"//"===string.substring(0,2)?(parts.protocol=null,string=string.substring(2),string=URI.parseAuthority(string,parts)):(pos=string.indexOf(":"),pos>-1&&(parts.protocol=string.substring(0,pos)||null,parts.protocol&&!parts.protocol.match(URI.protocol_expression)?parts.protocol=void 0:"//"===string.substring(pos+1,pos+3)?(string=string.substring(pos+3),string=URI.parseAuthority(string,parts)):(string=string.substring(pos+1),parts.urn=!0))),parts.path=string,parts},URI.parseHost=function(string,parts){var bracketPos,t,pos=string.indexOf("/");return-1===pos&&(pos=string.length),"["===string.charAt(0)?(bracketPos=string.indexOf("]"),parts.hostname=string.substring(1,bracketPos)||null,parts.port=string.substring(bracketPos+2,pos)||null,"/"===parts.port&&(parts.port=null)):string.indexOf(":")!==string.lastIndexOf(":")?(parts.hostname=string.substring(0,pos)||null,parts.port=null):(t=string.substring(0,pos).split(":"),parts.hostname=t[0]||null,parts.port=t[1]||null),parts.hostname&&"/"!==string.substring(pos).charAt(0)&&(pos++,string="/"+string),string.substring(pos)||"/"},URI.parseAuthority=function(string,parts){return string=URI.parseUserinfo(string,parts),URI.parseHost(string,parts)},URI.parseUserinfo=function(string,parts){var t,firstSlash=string.indexOf("/"),pos=string.lastIndexOf("@",firstSlash>-1?firstSlash:string.length-1);return pos>-1&&(-1===firstSlash||firstSlash>pos)?(t=string.substring(0,pos).split(":"),parts.username=t[0]?URI.decode(t[0]):null,t.shift(),parts.password=t[0]?URI.decode(t.join(":")):null,string=string.substring(pos+1)):(parts.username=null,parts.password=null),string},URI.parseQuery=function(string,escapeQuerySpace){if(!string)return{};if(string=string.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,""),!string)return{};for(var v,name,value,items={},splits=string.split("&"),length=splits.length,i=0;length>i;i++)v=splits[i].split("="),name=URI.decodeQuery(v.shift(),escapeQuerySpace),value=v.length?URI.decodeQuery(v.join("="),escapeQuerySpace):null,hasOwn.call(items,name)?("string"==typeof items[name]&&(items[name]=[items[name]]),items[name].push(value)):items[name]=value;return items},URI.build=function(parts){var t="";return parts.protocol&&(t+=parts.protocol+":"),parts.urn||!t&&!parts.hostname||(t+="//"),t+=URI.buildAuthority(parts)||"","string"==typeof parts.path&&("/"!==parts.path.charAt(0)&&"string"==typeof parts.hostname&&(t+="/"),t+=parts.path),"string"==typeof parts.query&&parts.query&&(t+="?"+parts.query),"string"==typeof parts.fragment&&parts.fragment&&(t+="#"+parts.fragment),t},URI.buildHost=function(parts){var t="";return parts.hostname?(t+=URI.ip6_expression.test(parts.hostname)?"["+parts.hostname+"]":parts.hostname,parts.port&&(t+=":"+parts.port),t):""},URI.buildAuthority=function(parts){return URI.buildUserinfo(parts)+URI.buildHost(parts)},URI.buildUserinfo=function(parts){var t="";return parts.username&&(t+=URI.encode(parts.username),parts.password&&(t+=":"+URI.encode(parts.password)),t+="@"),t},URI.buildQuery=function(data,duplicateQueryParameters,escapeQuerySpace){var unique,key,i,length,t="";for(key in data)if(hasOwn.call(data,key)&&key)if(isArray(data[key]))for(unique={},i=0,length=data[key].length;length>i;i++)void 0!==data[key][i]&&void 0===unique[data[key][i]+""]&&(t+="&"+URI.buildQueryParameter(key,data[key][i],escapeQuerySpace),duplicateQueryParameters!==!0&&(unique[data[key][i]+""]=!0));else void 0!==data[key]&&(t+="&"+URI.buildQueryParameter(key,data[key],escapeQuerySpace));return t.substring(1)},URI.buildQueryParameter=function(name,value,escapeQuerySpace){return URI.encodeQuery(name,escapeQuerySpace)+(null!==value?"="+URI.encodeQuery(value,escapeQuerySpace):"")},URI.addQuery=function(data,name,value){if("object"==typeof name)for(var key in name)hasOwn.call(name,key)&&URI.addQuery(data,key,name[key]);else{if("string"!=typeof name)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===data[name])return data[name]=value,void 0;"string"==typeof data[name]&&(data[name]=[data[name]]),isArray(value)||(value=[value]),data[name]=(data[name]||[]).concat(value)}},URI.removeQuery=function(data,name,value){var i,length,key;if(isArray(name))for(i=0,length=name.length;length>i;i++)data[name[i]]=void 0;else if("object"==typeof name)for(key in name)hasOwn.call(name,key)&&URI.removeQuery(data,key,name[key]);else{if("string"!=typeof name)throw new TypeError("URI.addQuery() accepts an object, string as the first parameter");void 0!==value?data[name]===value?data[name]=void 0:isArray(data[name])&&(data[name]=filterArrayValues(data[name],value)):data[name]=void 0}},URI.hasQuery=function(data,name,value,withinArray){if("object"==typeof name){for(var key in name)if(hasOwn.call(name,key)&&!URI.hasQuery(data,key,name[key]))return!1;return!0}if("string"!=typeof name)throw new TypeError("URI.hasQuery() accepts an object, string as the name parameter");switch(getType(value)){case"Undefined":return name in data;case"Boolean":var _booly=Boolean(isArray(data[name])?data[name].length:data[name]);return value===_booly;case"Function":return!!value(data[name],name,data);case"Array":if(!isArray(data[name]))return!1;var op=withinArray?arrayContains:arraysEqual;return op(data[name],value);case"RegExp":return isArray(data[name])?withinArray?arrayContains(data[name],value):!1:Boolean(data[name]&&data[name].match(value));case"Number":value=String(value);case"String":return isArray(data[name])?withinArray?arrayContains(data[name],value):!1:data[name]===value;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},URI.commonPath=function(one,two){var pos,length=Math.min(one.length,two.length);for(pos=0;length>pos;pos++)if(one.charAt(pos)!==two.charAt(pos)){pos--;break}return 1>pos?one.charAt(0)===two.charAt(0)&&"/"===one.charAt(0)?"/":"":(("/"!==one.charAt(pos)||"/"!==two.charAt(pos))&&(pos=one.substring(0,pos).lastIndexOf("/")),one.substring(0,pos+1))},URI.withinString=function(string,callback,options){options||(options={});var _start=options.start||URI.findUri.start,_end=options.end||URI.findUri.end,_trim=options.trim||URI.findUri.trim,_attributeOpen=/[a-z0-9-]=["']?$/i;for(_start.lastIndex=0;;){var match=_start.exec(string);if(!match)break;var start=match.index;if(options.ignoreHtml){var attributeOpen=string.slice(Math.max(start-3,0),start);if(attributeOpen&&_attributeOpen.test(attributeOpen))continue}var end=start+string.slice(start).search(_end),slice=string.slice(start,end).replace(_trim,"");if(!options.ignore||!options.ignore.test(slice)){end=start+slice.length;var result=callback(slice,start,end,string);string=string.slice(0,start)+result+string.slice(end),_start.lastIndex=start+result.length}}return _start.lastIndex=0,string},URI.ensureValidHostname=function(v){if(v.match(URI.invalid_hostname_characters)){if(!punycode)throw new TypeError('Hostname "'+v+'" contains characters other than [A-Z0-9.-] and Punycode.js is not available');if(punycode.toASCII(v).match(URI.invalid_hostname_characters))throw new TypeError('Hostname "'+v+'" contains characters other than [A-Z0-9.-]')}},URI.noConflict=function(removeAll){if(removeAll){var unconflicted={URI:this.noConflict()};return root.URITemplate&&"function"==typeof root.URITemplate.noConflict&&(unconflicted.URITemplate=root.URITemplate.noConflict()),root.IPv6&&"function"==typeof root.IPv6.noConflict&&(unconflicted.IPv6=root.IPv6.noConflict()),root.SecondLevelDomains&&"function"==typeof root.SecondLevelDomains.noConflict&&(unconflicted.SecondLevelDomains=root.SecondLevelDomains.noConflict()),unconflicted}return root.URI===this&&(root.URI=_URI),this},p.build=function(deferBuild){return deferBuild===!0?this._deferred_build=!0:(void 0===deferBuild||this._deferred_build)&&(this._string=URI.build(this._parts),this._deferred_build=!1),this},p.clone=function(){return new URI(this)},p.valueOf=p.toString=function(){return this.build(!1)._string},p.protocol=generateSimpleAccessor("protocol"),p.username=generateSimpleAccessor("username"),p.password=generateSimpleAccessor("password"),p.hostname=generateSimpleAccessor("hostname"),p.port=generateSimpleAccessor("port"),p.query=generatePrefixAccessor("query","?"),p.fragment=generatePrefixAccessor("fragment","#"),p.search=function(v,build){var t=this.query(v,build);return"string"==typeof t&&t.length?"?"+t:t},p.hash=function(v,build){var t=this.fragment(v,build);return"string"==typeof t&&t.length?"#"+t:t},p.pathname=function(v,build){if(void 0===v||v===!0){var res=this._parts.path||(this._parts.hostname?"/":"");return v?URI.decodePath(res):res}return this._parts.path=v?URI.recodePath(v):"/",this.build(!build),this},p.path=p.pathname,p.href=function(href,build){var key;if(void 0===href)return this.toString();this._string="",this._parts=URI._parts();var _URI=href instanceof URI,_object="object"==typeof href&&(href.hostname||href.path||href.pathname);if(href.nodeName){var attribute=URI.getDomAttribute(href);href=href[attribute]||"",_object=!1}if(!_URI&&_object&&void 0!==href.pathname&&(href=href.toString()),"string"==typeof href||href instanceof String)this._parts=URI.parse(String(href),this._parts);else{if(!_URI&&!_object)throw new TypeError("invalid input");var src=_URI?href._parts:href;for(key in src)hasOwn.call(this._parts,key)&&(this._parts[key]=src[key])}return this.build(!build),this},p.is=function(what){var ip=!1,ip4=!1,ip6=!1,name=!1,sld=!1,idn=!1,punycode=!1,relative=!this._parts.urn;switch(this._parts.hostname&&(relative=!1,ip4=URI.ip4_expression.test(this._parts.hostname),ip6=URI.ip6_expression.test(this._parts.hostname),ip=ip4||ip6,name=!ip,sld=name&&SLD&&SLD.has(this._parts.hostname),idn=name&&URI.idn_expression.test(this._parts.hostname),punycode=name&&URI.punycode_expression.test(this._parts.hostname)),what.toLowerCase()){case"relative":return relative;case"absolute":return!relative;case"domain":case"name":return name;case"sld":return sld;case"ip":return ip;case"ip4":case"ipv4":case"inet4":return ip4;case"ip6":case"ipv6":case"inet6":return ip6;case"idn":return idn;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return punycode}return null};var _protocol=p.protocol,_port=p.port,_hostname=p.hostname;p.protocol=function(v,build){if(void 0!==v&&v&&(v=v.replace(/:(\/\/)?$/,""),!v.match(URI.protocol_expression)))throw new TypeError('Protocol "'+v+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return _protocol.call(this,v,build)},p.scheme=p.protocol,p.port=function(v,build){if(this._parts.urn)return void 0===v?"":this;if(void 0!==v&&(0===v&&(v=null),v&&(v+="",":"===v.charAt(0)&&(v=v.substring(1)),v.match(/[^0-9]/))))throw new TypeError('Port "'+v+'" contains characters other than [0-9]');return _port.call(this,v,build)},p.hostname=function(v,build){if(this._parts.urn)return void 0===v?"":this;if(void 0!==v){var x={};URI.parseHost(v,x),v=x.hostname}return _hostname.call(this,v,build)},p.host=function(v,build){return this._parts.urn?void 0===v?"":this:void 0===v?this._parts.hostname?URI.buildHost(this._parts):"":(URI.parseHost(v,this._parts),this.build(!build),this)},p.authority=function(v,build){return this._parts.urn?void 0===v?"":this:void 0===v?this._parts.hostname?URI.buildAuthority(this._parts):"":(URI.parseAuthority(v,this._parts),this.build(!build),this)},p.userinfo=function(v,build){if(this._parts.urn)return void 0===v?"":this;if(void 0===v){if(!this._parts.username)return"";var t=URI.buildUserinfo(this._parts);return t.substring(0,t.length-1)}return"@"!==v[v.length-1]&&(v+="@"),URI.parseUserinfo(v,this._parts),this.build(!build),this},p.resource=function(v,build){var parts;return void 0===v?this.path()+this.search()+this.hash():(parts=URI.parse(v),this._parts.path=parts.path,this._parts.query=parts.query,this._parts.fragment=parts.fragment,this.build(!build),this)},p.subdomain=function(v,build){if(this._parts.urn)return void 0===v?"":this;if(void 0===v){if(!this._parts.hostname||this.is("IP"))return"";var end=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,end)||""}var e=this._parts.hostname.length-this.domain().length,sub=this._parts.hostname.substring(0,e),replace=new RegExp("^"+escapeRegEx(sub));return v&&"."!==v.charAt(v.length-1)&&(v+="."),v&&URI.ensureValidHostname(v),this._parts.hostname=this._parts.hostname.replace(replace,v),this.build(!build),this},p.domain=function(v,build){if(this._parts.urn)return void 0===v?"":this;if("boolean"==typeof v&&(build=v,v=void 0),void 0===v){if(!this._parts.hostname||this.is("IP"))return"";var t=this._parts.hostname.match(/\./g);if(t&&t.length<2)return this._parts.hostname;var end=this._parts.hostname.length-this.tld(build).length-1;return end=this._parts.hostname.lastIndexOf(".",end-1)+1,this._parts.hostname.substring(end)||""}if(!v)throw new TypeError("cannot set domain empty");if(URI.ensureValidHostname(v),!this._parts.hostname||this.is("IP"))this._parts.hostname=v;else{var replace=new RegExp(escapeRegEx(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(replace,v)}return this.build(!build),this},p.tld=function(v,build){if(this._parts.urn)return void 0===v?"":this;if("boolean"==typeof v&&(build=v,v=void 0),void 0===v){if(!this._parts.hostname||this.is("IP"))return"";var pos=this._parts.hostname.lastIndexOf("."),tld=this._parts.hostname.substring(pos+1);return build!==!0&&SLD&&SLD.list[tld.toLowerCase()]?SLD.get(this._parts.hostname)||tld:tld}var replace;if(!v)throw new TypeError("cannot set TLD empty");if(v.match(/[^a-zA-Z0-9-]/)){if(!SLD||!SLD.is(v))throw new TypeError('TLD "'+v+'" contains characters other than [A-Z0-9]');replace=new RegExp(escapeRegEx(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(replace,v)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");replace=new RegExp(escapeRegEx(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(replace,v)}return this.build(!build),this},p.directory=function(v,build){if(this._parts.urn)return void 0===v?"":this;if(void 0===v||v===!0){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var end=this._parts.path.length-this.filename().length-1,res=this._parts.path.substring(0,end)||(this._parts.hostname?"/":"");return v?URI.decodePath(res):res}var e=this._parts.path.length-this.filename().length,directory=this._parts.path.substring(0,e),replace=new RegExp("^"+escapeRegEx(directory));return this.is("relative")||(v||(v="/"),"/"!==v.charAt(0)&&(v="/"+v)),v&&"/"!==v.charAt(v.length-1)&&(v+="/"),v=URI.recodePath(v),this._parts.path=this._parts.path.replace(replace,v),this.build(!build),this},p.filename=function(v,build){if(this._parts.urn)return void 0===v?"":this;if(void 0===v||v===!0){if(!this._parts.path||"/"===this._parts.path)return"";var pos=this._parts.path.lastIndexOf("/"),res=this._parts.path.substring(pos+1);return v?URI.decodePathSegment(res):res}var mutatedDirectory=!1;"/"===v.charAt(0)&&(v=v.substring(1)),v.match(/\.?\//)&&(mutatedDirectory=!0);var replace=new RegExp(escapeRegEx(this.filename())+"$");return v=URI.recodePath(v),this._parts.path=this._parts.path.replace(replace,v),mutatedDirectory?this.normalizePath(build):this.build(!build),this},p.suffix=function(v,build){if(this._parts.urn)return void 0===v?"":this;if(void 0===v||v===!0){if(!this._parts.path||"/"===this._parts.path)return"";var s,res,filename=this.filename(),pos=filename.lastIndexOf(".");return-1===pos?"":(s=filename.substring(pos+1),res=/^[a-z0-9%]+$/i.test(s)?s:"",v?URI.decodePathSegment(res):res)}"."===v.charAt(0)&&(v=v.substring(1));var replace,suffix=this.suffix();if(suffix)replace=v?new RegExp(escapeRegEx(suffix)+"$"):new RegExp(escapeRegEx("."+suffix)+"$");else{if(!v)return this;this._parts.path+="."+URI.recodePath(v)}return replace&&(v=URI.recodePath(v),this._parts.path=this._parts.path.replace(replace,v)),this.build(!build),this},p.segment=function(segment,v,build){var separator=this._parts.urn?":":"/",path=this.path(),absolute="/"===path.substring(0,1),segments=path.split(separator);if(void 0!==segment&&"number"!=typeof segment&&(build=v,v=segment,segment=void 0),void 0!==segment&&"number"!=typeof segment)throw new Error('Bad segment "'+segment+'", must be 0-based integer');if(absolute&&segments.shift(),0>segment&&(segment=Math.max(segments.length+segment,0)),void 0===v)return void 0===segment?segments:segments[segment];if(null===segment||void 0===segments[segment])if(isArray(v)){segments=[];for(var i=0,l=v.length;l>i;i++)(v[i].length||segments.length&&segments[segments.length-1].length)&&(segments.length&&!segments[segments.length-1].length&&segments.pop(),segments.push(v[i]))}else(v||"string"==typeof v)&&(""===segments[segments.length-1]?segments[segments.length-1]=v:segments.push(v));else v?segments[segment]=v:segments.splice(segment,1);return absolute&&segments.unshift(""),this.path(segments.join(separator),build)},p.segmentCoded=function(segment,v,build){var segments,i,l;if("number"!=typeof segment&&(build=v,v=segment,segment=void 0),void 0===v){if(segments=this.segment(segment,v,build),isArray(segments))for(i=0,l=segments.length;l>i;i++)segments[i]=URI.decode(segments[i]);else segments=void 0!==segments?URI.decode(segments):void 0;return segments}if(isArray(v))for(i=0,l=v.length;l>i;i++)v[i]=URI.decode(v[i]);else v="string"==typeof v||v instanceof String?URI.encode(v):v;return this.segment(segment,v,build)};var q=p.query;return p.query=function(v,build){if(v===!0)return URI.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof v){var data=URI.parseQuery(this._parts.query,this._parts.escapeQuerySpace),result=v.call(this,data);return this._parts.query=URI.buildQuery(result||data,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!build),this}return void 0!==v&&"string"!=typeof v?(this._parts.query=URI.buildQuery(v,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!build),this):q.call(this,v,build)},p.setQuery=function(name,value,build){var data=URI.parseQuery(this._parts.query,this._parts.escapeQuerySpace);
if("string"==typeof name||name instanceof String)data[name]=void 0!==value?value:null;else{if("object"!=typeof name)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var key in name)hasOwn.call(name,key)&&(data[key]=name[key])}return this._parts.query=URI.buildQuery(data,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof name&&(build=value),this.build(!build),this},p.addQuery=function(name,value,build){var data=URI.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return URI.addQuery(data,name,void 0===value?null:value),this._parts.query=URI.buildQuery(data,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof name&&(build=value),this.build(!build),this},p.removeQuery=function(name,value,build){var data=URI.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return URI.removeQuery(data,name,value),this._parts.query=URI.buildQuery(data,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof name&&(build=value),this.build(!build),this},p.hasQuery=function(name,value,withinArray){var data=URI.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return URI.hasQuery(data,name,value,withinArray)},p.setSearch=p.setQuery,p.addSearch=p.addQuery,p.removeSearch=p.removeQuery,p.hasSearch=p.hasQuery,p.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},p.normalizeProtocol=function(build){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!build)),this},p.normalizeHostname=function(build){return this._parts.hostname&&(this.is("IDN")&&punycode?this._parts.hostname=punycode.toASCII(this._parts.hostname):this.is("IPv6")&&IPv6&&(this._parts.hostname=IPv6.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!build)),this},p.normalizePort=function(build){return"string"==typeof this._parts.protocol&&this._parts.port===URI.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!build)),this},p.normalizePath=function(build){if(this._parts.urn)return this;if(!this._parts.path||"/"===this._parts.path)return this;var _was_relative,_parent,_pos,_path=this._parts.path,_leadingParents="";for("/"!==_path.charAt(0)&&(_was_relative=!0,_path="/"+_path),_path=_path.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),_was_relative&&(_leadingParents=_path.substring(1).match(/^(\.\.\/)+/)||"",_leadingParents&&(_leadingParents=_leadingParents[0]));;){if(_parent=_path.indexOf("/.."),-1===_parent)break;0!==_parent?(_pos=_path.substring(0,_parent).lastIndexOf("/"),-1===_pos&&(_pos=_parent),_path=_path.substring(0,_pos)+_path.substring(_parent+3)):_path=_path.substring(3)}return _was_relative&&this.is("relative")&&(_path=_leadingParents+_path.substring(1)),_path=URI.recodePath(_path),this._parts.path=_path,this.build(!build),this},p.normalizePathname=p.normalizePath,p.normalizeQuery=function(build){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(URI.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!build)),this},p.normalizeFragment=function(build){return this._parts.fragment||(this._parts.fragment=null,this.build(!build)),this},p.normalizeSearch=p.normalizeQuery,p.normalizeHash=p.normalizeFragment,p.iso8859=function(){var e=URI.encode,d=URI.decode;return URI.encode=escape,URI.decode=decodeURIComponent,this.normalize(),URI.encode=e,URI.decode=d,this},p.unicode=function(){var e=URI.encode,d=URI.decode;return URI.encode=strictEncodeURIComponent,URI.decode=unescape,this.normalize(),URI.encode=e,URI.decode=d,this},p.readable=function(){var uri=this.clone();uri.username("").password("").normalize();var t="";if(uri._parts.protocol&&(t+=uri._parts.protocol+"://"),uri._parts.hostname&&(uri.is("punycode")&&punycode?(t+=punycode.toUnicode(uri._parts.hostname),uri._parts.port&&(t+=":"+uri._parts.port)):t+=uri.host()),uri._parts.hostname&&uri._parts.path&&"/"!==uri._parts.path.charAt(0)&&(t+="/"),t+=uri.path(!0),uri._parts.query){for(var q="",i=0,qp=uri._parts.query.split("&"),l=qp.length;l>i;i++){var kv=(qp[i]||"").split("=");q+="&"+URI.decodeQuery(kv[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==kv[1]&&(q+="="+URI.decodeQuery(kv[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}t+="?"+q.substring(1)}return t+=URI.decodeQuery(uri.hash(),!0)},p.absoluteTo=function(base){var basedir,i,p,resolved=this.clone(),properties=["protocol","username","password","hostname","port"];if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(base instanceof URI||(base=new URI(base)),resolved._parts.protocol||(resolved._parts.protocol=base._parts.protocol),this._parts.hostname)return resolved;for(i=0;p=properties[i];i++)resolved._parts[p]=base._parts[p];return resolved._parts.path?".."===resolved._parts.path.substring(-2)&&(resolved._parts.path+="/"):(resolved._parts.path=base._parts.path,resolved._parts.query||(resolved._parts.query=base._parts.query)),"/"!==resolved.path().charAt(0)&&(basedir=base.directory(),resolved._parts.path=(basedir?basedir+"/":"")+resolved._parts.path,resolved.normalizePath()),resolved.build(),resolved},p.relativeTo=function(base){var relativeParts,baseParts,common,relativePath,basePath,relative=this.clone().normalize();if(relative._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(base=new URI(base).normalize(),relativeParts=relative._parts,baseParts=base._parts,relativePath=relative.path(),basePath=base.path(),"/"!==relativePath.charAt(0))throw new Error("URI is already relative");if("/"!==basePath.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(relativeParts.protocol===baseParts.protocol&&(relativeParts.protocol=null),relativeParts.username!==baseParts.username||relativeParts.password!==baseParts.password)return relative.build();if(null!==relativeParts.protocol||null!==relativeParts.username||null!==relativeParts.password)return relative.build();if(relativeParts.hostname!==baseParts.hostname||relativeParts.port!==baseParts.port)return relative.build();if(relativeParts.hostname=null,relativeParts.port=null,relativePath===basePath)return relativeParts.path="",relative.build();if(common=URI.commonPath(relative.path(),base.path()),!common)return relative.build();var parents=baseParts.path.substring(common.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return relativeParts.path=parents+relativeParts.path.substring(common.length),relative.build()},p.equals=function(uri){var one_query,two_query,key,one=this.clone(),two=new URI(uri),one_map={},two_map={},checked={};if(one.normalize(),two.normalize(),one.toString()===two.toString())return!0;if(one_query=one.query(),two_query=two.query(),one.query(""),two.query(""),one.toString()!==two.toString())return!1;if(one_query.length!==two_query.length)return!1;one_map=URI.parseQuery(one_query,this._parts.escapeQuerySpace),two_map=URI.parseQuery(two_query,this._parts.escapeQuerySpace);for(key in one_map)if(hasOwn.call(one_map,key)){if(isArray(one_map[key])){if(!arraysEqual(one_map[key],two_map[key]))return!1}else if(one_map[key]!==two_map[key])return!1;checked[key]=!0}for(key in two_map)if(hasOwn.call(two_map,key)&&!checked[key])return!1;return!0},p.duplicateQueryParameters=function(v){return this._parts.duplicateQueryParameters=!!v,this},p.escapeQuerySpace=function(v){return this._parts.escapeQuerySpace=!!v,this},URI}),function(){"use strict";/**
	 * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
	 *
	 * @codingstandard ftlabs-jsv2
	 * @copyright The Financial Times Limited [All Rights Reserved]
	 * @license MIT License (see LICENSE.txt)
	 */
function FastClick(layer,options){function bind(method,context){return function(){return method.apply(context,arguments)}}var oldOnClick;if(options=options||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=options.touchBoundary||10,this.layer=layer,this.tapDelay=options.tapDelay||200,this.tapTimeout=options.tapTimeout||700,!FastClick.notNeeded(layer)){for(var methods=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],context=this,i=0,l=methods.length;l>i;i++)context[methods[i]]=bind(context[methods[i]],context);deviceIsAndroid&&(layer.addEventListener("mouseover",this.onMouse,!0),layer.addEventListener("mousedown",this.onMouse,!0),layer.addEventListener("mouseup",this.onMouse,!0)),layer.addEventListener("click",this.onClick,!0),layer.addEventListener("touchstart",this.onTouchStart,!1),layer.addEventListener("touchmove",this.onTouchMove,!1),layer.addEventListener("touchend",this.onTouchEnd,!1),layer.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(layer.removeEventListener=function(type,callback,capture){var rmv=Node.prototype.removeEventListener;"click"===type?rmv.call(layer,type,callback.hijacked||callback,capture):rmv.call(layer,type,callback,capture)},layer.addEventListener=function(type,callback,capture){var adv=Node.prototype.addEventListener;"click"===type?adv.call(layer,type,callback.hijacked||(callback.hijacked=function(event){event.propagationStopped||callback(event)}),capture):adv.call(layer,type,callback,capture)}),"function"==typeof layer.onclick&&(oldOnClick=layer.onclick,layer.addEventListener("click",function(event){oldOnClick(event)},!1),layer.onclick=null)}}var deviceIsWindowsPhone=navigator.userAgent.indexOf("Windows Phone")>=0,deviceIsAndroid=navigator.userAgent.indexOf("Android")>0&&!deviceIsWindowsPhone,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent)&&!deviceIsWindowsPhone,deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS [6-7]_\d/.test(navigator.userAgent),deviceIsBlackBerry10=navigator.userAgent.indexOf("BB10")>0;FastClick.prototype.needsClick=function(target){switch(target.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(target.disabled)return!0;break;case"input":if(deviceIsIOS&&"file"===target.type||target.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(target.className)},FastClick.prototype.needsFocus=function(target){switch(target.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(target.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!target.disabled&&!target.readOnly;default:return/\bneedsfocus\b/.test(target.className)}},FastClick.prototype.sendClick=function(targetElement,event){var clickEvent,touch;document.activeElement&&document.activeElement!==targetElement&&document.activeElement.blur(),touch=event.changedTouches[0],clickEvent=document.createEvent("MouseEvents"),clickEvent.initMouseEvent(this.determineEventType(targetElement),!0,!0,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,!1,!1,!1,!1,0,null),clickEvent.forwardedTouchEvent=!0,targetElement.dispatchEvent(clickEvent)},FastClick.prototype.determineEventType=function(targetElement){return deviceIsAndroid&&"select"===targetElement.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(targetElement){var length;deviceIsIOS&&targetElement.setSelectionRange&&0!==targetElement.type.indexOf("date")&&"time"!==targetElement.type&&"month"!==targetElement.type?(length=targetElement.value.length,targetElement.setSelectionRange(length,length)):targetElement.focus()},FastClick.prototype.updateScrollParent=function(targetElement){var scrollParent,parentElement;if(scrollParent=targetElement.fastClickScrollParent,!scrollParent||!scrollParent.contains(targetElement)){parentElement=targetElement;do{if(parentElement.scrollHeight>parentElement.offsetHeight){scrollParent=parentElement,targetElement.fastClickScrollParent=parentElement;break}parentElement=parentElement.parentElement}while(parentElement)}scrollParent&&(scrollParent.fastClickLastScrollTop=scrollParent.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(eventTarget){return eventTarget.nodeType===Node.TEXT_NODE?eventTarget.parentNode:eventTarget},FastClick.prototype.onTouchStart=function(event){var targetElement,touch,selection;if(event.targetTouches.length>1)return!0;if(targetElement=this.getTargetElementFromEventTarget(event.target),touch=event.targetTouches[0],deviceIsIOS){if(selection=window.getSelection(),selection.rangeCount&&!selection.isCollapsed)return!0;if(!deviceIsIOS4){if(touch.identifier&&touch.identifier===this.lastTouchIdentifier)return event.preventDefault(),!1;this.lastTouchIdentifier=touch.identifier,this.updateScrollParent(targetElement)}}return this.trackingClick=!0,this.trackingClickStart=event.timeStamp,this.targetElement=targetElement,this.touchStartX=touch.pageX,this.touchStartY=touch.pageY,event.timeStamp-this.lastClickTime<this.tapDelay&&event.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(event){var touch=event.changedTouches[0],boundary=this.touchBoundary;return Math.abs(touch.pageX-this.touchStartX)>boundary||Math.abs(touch.pageY-this.touchStartY)>boundary?!0:!1},FastClick.prototype.onTouchMove=function(event){return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(event.target)||this.touchHasMoved(event))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},FastClick.prototype.findControl=function(labelElement){return void 0!==labelElement.control?labelElement.control:labelElement.htmlFor?document.getElementById(labelElement.htmlFor):labelElement.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(event){var forElement,trackingClickStart,targetTagName,scrollParent,touch,targetElement=this.targetElement;if(!this.trackingClick)return!0;if(event.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(event.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=event.timeStamp,trackingClickStart=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(touch=event.changedTouches[0],targetElement=document.elementFromPoint(touch.pageX-window.pageXOffset,touch.pageY-window.pageYOffset)||targetElement,targetElement.fastClickScrollParent=this.targetElement.fastClickScrollParent),targetTagName=targetElement.tagName.toLowerCase(),"label"===targetTagName){if(forElement=this.findControl(targetElement)){if(this.focus(targetElement),deviceIsAndroid)return!1;targetElement=forElement}}else if(this.needsFocus(targetElement))return event.timeStamp-trackingClickStart>100||deviceIsIOS&&window.top!==window&&"input"===targetTagName?(this.targetElement=null,!1):(this.focus(targetElement),this.sendClick(targetElement,event),deviceIsIOS&&"select"===targetTagName||(this.targetElement=null,event.preventDefault()),!1);return deviceIsIOS&&!deviceIsIOS4&&(scrollParent=targetElement.fastClickScrollParent,scrollParent&&scrollParent.fastClickLastScrollTop!==scrollParent.scrollTop)?!0:(this.needsClick(targetElement)||(event.preventDefault(),this.sendClick(targetElement,event)),!1)},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(event){return this.targetElement?event.forwardedTouchEvent?!0:event.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(event.stopImmediatePropagation?event.stopImmediatePropagation():event.propagationStopped=!0,event.stopPropagation(),event.preventDefault(),!1):!0:!0:!0},FastClick.prototype.onClick=function(event){var permitted;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===event.target.type&&0===event.detail?!0:(permitted=this.onMouse(event),permitted||(this.targetElement=null),permitted)},FastClick.prototype.destroy=function(){var layer=this.layer;deviceIsAndroid&&(layer.removeEventListener("mouseover",this.onMouse,!0),layer.removeEventListener("mousedown",this.onMouse,!0),layer.removeEventListener("mouseup",this.onMouse,!0)),layer.removeEventListener("click",this.onClick,!0),layer.removeEventListener("touchstart",this.onTouchStart,!1),layer.removeEventListener("touchmove",this.onTouchMove,!1),layer.removeEventListener("touchend",this.onTouchEnd,!1),layer.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(layer){var metaViewport,chromeVersion,blackberryVersion,firefoxVersion;if("undefined"==typeof window.ontouchstart)return!0;if(chromeVersion=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!deviceIsAndroid)return!0;if(metaViewport=document.querySelector("meta[name=viewport]")){if(-1!==metaViewport.content.indexOf("user-scalable=no"))return!0;if(chromeVersion>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(deviceIsBlackBerry10&&(blackberryVersion=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),blackberryVersion[1]>=10&&blackberryVersion[2]>=3&&(metaViewport=document.querySelector("meta[name=viewport]")))){if(-1!==metaViewport.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===layer.style.msTouchAction||"manipulation"===layer.style.touchAction?!0:(firefoxVersion=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],firefoxVersion>=27&&(metaViewport=document.querySelector("meta[name=viewport]"),metaViewport&&(-1!==metaViewport.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))?!0:"none"===layer.style.touchAction||"manipulation"===layer.style.touchAction?!0:!1)},FastClick.attach=function(layer,options){return new FastClick(layer,options)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick}(),function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.Clipboard=f()}}(function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){function closest(element,selector){for(;element&&element.nodeType!==DOCUMENT_NODE_TYPE;){if(element.matches(selector))return element;element=element.parentNode}}var DOCUMENT_NODE_TYPE=9;if(Element&&!Element.prototype.matches){var proto=Element.prototype;proto.matches=proto.matchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector||proto.webkitMatchesSelector}module.exports=closest},{}],2:[function(require,module){function delegate(element,selector,type,callback,useCapture){var listenerFn=listener.apply(this,arguments);return element.addEventListener(type,listenerFn,useCapture),{destroy:function(){element.removeEventListener(type,listenerFn,useCapture)}}}function listener(element,selector,type,callback){return function(e){e.delegateTarget=closest(e.target,selector),e.delegateTarget&&callback.call(element,e)}}var closest=require("./closest");module.exports=delegate},{"./closest":1}],3:[function(require,module,exports){exports.node=function(value){return void 0!==value&&value instanceof HTMLElement&&1===value.nodeType},exports.nodeList=function(value){var type=Object.prototype.toString.call(value);return void 0!==value&&("[object NodeList]"===type||"[object HTMLCollection]"===type)&&"length"in value&&(0===value.length||exports.node(value[0]))},exports.string=function(value){return"string"==typeof value||value instanceof String},exports.fn=function(value){var type=Object.prototype.toString.call(value);return"[object Function]"===type}},{}],4:[function(require,module){function listen(target,type,callback){if(!target&&!type&&!callback)throw new Error("Missing required arguments");if(!is.string(type))throw new TypeError("Second argument must be a String");if(!is.fn(callback))throw new TypeError("Third argument must be a Function");if(is.node(target))return listenNode(target,type,callback);if(is.nodeList(target))return listenNodeList(target,type,callback);if(is.string(target))return listenSelector(target,type,callback);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function listenNode(node,type,callback){return node.addEventListener(type,callback),{destroy:function(){node.removeEventListener(type,callback)}}}function listenNodeList(nodeList,type,callback){return Array.prototype.forEach.call(nodeList,function(node){node.addEventListener(type,callback)}),{destroy:function(){Array.prototype.forEach.call(nodeList,function(node){node.removeEventListener(type,callback)})}}}function listenSelector(selector,type,callback){return delegate(document.body,selector,type,callback)}var is=require("./is"),delegate=require("delegate");module.exports=listen},{"./is":3,delegate:2}],5:[function(require,module){function select(element){var selectedText;if("SELECT"===element.nodeName)element.focus(),selectedText=element.value;else if("INPUT"===element.nodeName||"TEXTAREA"===element.nodeName){var isReadOnly=element.hasAttribute("readonly");isReadOnly||element.setAttribute("readonly",""),element.select(),element.setSelectionRange(0,element.value.length),isReadOnly||element.removeAttribute("readonly"),selectedText=element.value}else{element.hasAttribute("contenteditable")&&element.focus();var selection=window.getSelection(),range=document.createRange();range.selectNodeContents(element),selection.removeAllRanges(),selection.addRange(range),selectedText=selection.toString()}return selectedText}module.exports=select},{}],6:[function(require,module){function E(){}E.prototype={on:function(name,callback,ctx){var e=this.e||(this.e={});return(e[name]||(e[name]=[])).push({fn:callback,ctx:ctx}),this},once:function(name,callback,ctx){function listener(){self.off(name,listener),callback.apply(ctx,arguments)}var self=this;return listener._=callback,this.on(name,listener,ctx)},emit:function(name){var data=[].slice.call(arguments,1),evtArr=((this.e||(this.e={}))[name]||[]).slice(),i=0,len=evtArr.length;for(i;len>i;i++)evtArr[i].fn.apply(evtArr[i].ctx,data);return this},off:function(name,callback){var e=this.e||(this.e={}),evts=e[name],liveEvents=[];if(evts&&callback)for(var i=0,len=evts.length;len>i;i++)evts[i].fn!==callback&&evts[i].fn._!==callback&&liveEvents.push(evts[i]);return liveEvents.length?e[name]=liveEvents:delete e[name],this}},module.exports=E},{}],7:[function(require,module,exports){!function(global,factory){if("function"==typeof define&&define.amd)define(["module","select"],factory);else if("undefined"!=typeof exports)factory(module,require("select"));else{var mod={exports:{}};factory(mod,global.select),global.clipboardAction=mod.exports}}(this,function(module,_select){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _select2=_interopRequireDefault(_select),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),ClipboardAction=function(){function ClipboardAction(options){_classCallCheck(this,ClipboardAction),this.resolveOptions(options),this.initSelection()}return _createClass(ClipboardAction,[{key:"resolveOptions",value:function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=options.action,this.emitter=options.emitter,this.target=options.target,this.text=options.text,this.trigger=options.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var _this=this,isRTL="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return _this.removeFake()},this.fakeHandler=document.body.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[isRTL?"right":"left"]="-9999px";var yPosition=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=yPosition+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,document.body.appendChild(this.fakeElem),this.selectedText=_select2.default(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(document.body.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(document.body.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=_select2.default(this.target),this.copyText()}},{key:"copyText",value:function(){var succeeded=void 0;try{succeeded=document.execCommand(this.action)}catch(err){succeeded=!1}this.handleResult(succeeded)}},{key:"handleResult",value:function(succeeded){this.emitter.emit(succeeded?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.target&&this.target.blur(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var action=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=action,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(target){if(void 0!==target){if(!target||"object"!==("undefined"==typeof target?"undefined":_typeof(target))||1!==target.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&target.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(target.hasAttribute("readonly")||target.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=target}},get:function(){return this._target}}]),ClipboardAction}();module.exports=ClipboardAction})},{select:5}],8:[function(require,module,exports){!function(global,factory){if("function"==typeof define&&define.amd)define(["module","./clipboard-action","tiny-emitter","good-listener"],factory);else if("undefined"!=typeof exports)factory(module,require("./clipboard-action"),require("tiny-emitter"),require("good-listener"));else{var mod={exports:{}};factory(mod,global.clipboardAction,global.tinyEmitter,global.goodListener),global.clipboard=mod.exports}}(this,function(module,_clipboardAction,_tinyEmitter,_goodListener){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function getAttributeValue(suffix,element){var attribute="data-clipboard-"+suffix;if(element.hasAttribute(attribute))return element.getAttribute(attribute)}var _clipboardAction2=_interopRequireDefault(_clipboardAction),_tinyEmitter2=_interopRequireDefault(_tinyEmitter),_goodListener2=_interopRequireDefault(_goodListener),_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Clipboard=function(_Emitter){function Clipboard(trigger,options){_classCallCheck(this,Clipboard);var _this=_possibleConstructorReturn(this,(Clipboard.__proto__||Object.getPrototypeOf(Clipboard)).call(this));return _this.resolveOptions(options),_this.listenClick(trigger),_this}return _inherits(Clipboard,_Emitter),_createClass(Clipboard,[{key:"resolveOptions",value:function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof options.action?options.action:this.defaultAction,this.target="function"==typeof options.target?options.target:this.defaultTarget,this.text="function"==typeof options.text?options.text:this.defaultText}},{key:"listenClick",value:function(trigger){var _this2=this;this.listener=_goodListener2.default(trigger,"click",function(e){return _this2.onClick(e)})}},{key:"onClick",value:function(e){var trigger=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new _clipboardAction2.default({action:this.action(trigger),target:this.target(trigger),text:this.text(trigger),trigger:trigger,emitter:this})}},{key:"defaultAction",value:function(trigger){return getAttributeValue("action",trigger)}},{key:"defaultTarget",value:function(trigger){var selector=getAttributeValue("target",trigger);return selector?document.querySelector(selector):void 0}},{key:"defaultText",value:function(trigger){return getAttributeValue("text",trigger)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var action=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],actions="string"==typeof action?[action]:action,support=!!document.queryCommandSupported;return actions.forEach(function(action){support=support&&!!document.queryCommandSupported(action)}),support}}]),Clipboard}(_tinyEmitter2.default);module.exports=Clipboard})},{"./clipboard-action":7,"good-listener":4,"tiny-emitter":6}]},{},[8])(8)}),!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.SignaturePad=e()}(this,function(){"use strict";function t(t,e,i){this.x=t,this.y=e,this.time=i||(new Date).getTime()}function e(t,e,i,o){this.startPoint=t,this.control1=e,this.control2=i,this.endPoint=o}function i(t,e,i){var o,n,s,r=null,h=0;i||(i={});var a=function(){h=!1===i.leading?0:Date.now(),r=null,s=t.apply(o,n),r||(o=n=null)};return function(){var c=Date.now();h||!1!==i.leading||(h=c);var d=e-(c-h);return o=this,n=arguments,0>=d||d>e?(r&&(clearTimeout(r),r=null),h=c,s=t.apply(o,n),r||(o=n=null)):r||!1===i.trailing||(r=setTimeout(a,d)),s}}function o(t,e){var n=this,s=e||{};this.velocityFilterWeight=s.velocityFilterWeight||.7,this.minWidth=s.minWidth||.5,this.maxWidth=s.maxWidth||2.5,this.throttle="throttle"in s?s.throttle:16,this.minDistance="minDistance"in s?s.minDistance:5,this._strokeMoveUpdate=this.throttle?i(o.prototype._strokeUpdate,this.throttle):o.prototype._strokeUpdate,this.dotSize=s.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=s.penColor||"black",this.backgroundColor=s.backgroundColor||"rgba(0,0,0,0)",this.onBegin=s.onBegin,this.onEnd=s.onEnd,this._canvas=t,this._ctx=t.getContext("2d"),this.clear(),this._handleMouseDown=function(t){1===t.which&&(n._mouseButtonDown=!0,n._strokeBegin(t))},this._handleMouseMove=function(t){n._mouseButtonDown&&n._strokeMoveUpdate(t)},this._handleMouseUp=function(t){1===t.which&&n._mouseButtonDown&&(n._mouseButtonDown=!1,n._strokeEnd(t))},this._handleTouchStart=function(t){if(1===t.targetTouches.length){var e=t.changedTouches[0];n._strokeBegin(e)}},this._handleTouchMove=function(t){t.preventDefault();var e=t.targetTouches[0];n._strokeMoveUpdate(e)},this._handleTouchEnd=function(t){t.target===n._canvas&&(t.preventDefault(),n._strokeEnd(t))},this.on()}return t.prototype.velocityFrom=function(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):1},t.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},t.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.time===t.time},e.prototype.length=function(){for(var t=0,e=void 0,i=void 0,o=0;10>=o;o+=1){var n=o/10,s=this._point(n,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),r=this._point(n,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(o>0){var h=s-e,a=r-i;t+=Math.sqrt(h*h+a*a)}e=s,i=r}return t},e.prototype._point=function(t,e,i,o,n){return e*(1-t)*(1-t)*(1-t)+3*i*(1-t)*(1-t)*t+3*o*(1-t)*t*t+n*t*t*t},o.prototype.clear=function(){var t=this._ctx,e=this._canvas;t.fillStyle=this.backgroundColor,t.clearRect(0,0,e.width,e.height),t.fillRect(0,0,e.width,e.height),this._data=[],this._reset(),this._isEmpty=!0},o.prototype.fromDataURL=function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=new Image,n=i.ratio||window.devicePixelRatio||1,s=i.width||this._canvas.width/n,r=i.height||this._canvas.height/n;this._reset(),o.src=t,o.onload=function(){e._ctx.drawImage(o,0,0,s,r)},this._isEmpty=!1},o.prototype.toDataURL=function(t){var e;switch(t){case"image/svg+xml":return this._toSVG();default:for(var i=arguments.length,o=Array(i>1?i-1:0),n=1;i>n;n++)o[n-1]=arguments[n];return(e=this._canvas).toDataURL.apply(e,[t].concat(o))}},o.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()},o.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)},o.prototype.isEmpty=function(){return this._isEmpty},o.prototype._strokeBegin=function(t){this._data.push([]),this._reset(),this._strokeUpdate(t),"function"==typeof this.onBegin&&this.onBegin(t)},o.prototype._strokeUpdate=function(t){var e=t.clientX,i=t.clientY,o=this._createPoint(e,i),n=this._data[this._data.length-1],s=n&&n[n.length-1],r=s&&o.distanceTo(s)<this.minDistance;if(!s||!r){var h=this._addPoint(o),a=h.curve,c=h.widths;a&&c&&this._drawCurve(a,c.start,c.end),this._data[this._data.length-1].push({x:o.x,y:o.y,time:o.time,color:this.penColor})}},o.prototype._strokeEnd=function(t){var e=this.points.length>2,i=this.points[0];if(!e&&i&&this._drawDot(i),i){var o=this._data[this._data.length-1],n=o[o.length-1];i.equals(n)||o.push({x:i.x,y:i.y,time:i.time,color:this.penColor})}"function"==typeof this.onEnd&&this.onEnd(t)},o.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)},o.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)},o.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor},o.prototype._createPoint=function(e,i,o){var n=this._canvas.getBoundingClientRect();return new t(e-n.left,i-n.top,o||(new Date).getTime())},o.prototype._addPoint=function(t){var i=this.points,o=void 0;if(i.push(t),i.length>2){3===i.length&&i.unshift(i[0]),o=this._calculateCurveControlPoints(i[0],i[1],i[2]);var n=o.c2;o=this._calculateCurveControlPoints(i[1],i[2],i[3]);var s=o.c1,r=new e(i[1],n,s,i[2]),h=this._calculateCurveWidths(r);return i.shift(),{curve:r,widths:h}}return{}},o.prototype._calculateCurveControlPoints=function(e,i,o){var n=e.x-i.x,s=e.y-i.y,r=i.x-o.x,h=i.y-o.y,a={x:(e.x+i.x)/2,y:(e.y+i.y)/2},c={x:(i.x+o.x)/2,y:(i.y+o.y)/2},d=Math.sqrt(n*n+s*s),l=Math.sqrt(r*r+h*h),u=a.x-c.x,v=a.y-c.y,p=l/(d+l),_={x:c.x+u*p,y:c.y+v*p},y=i.x-_.x,f=i.y-_.y;return{c1:new t(a.x+y,a.y+f),c2:new t(c.x+y,c.y+f)}},o.prototype._calculateCurveWidths=function(t){var e=t.startPoint,i=t.endPoint,o={start:null,end:null},n=this.velocityFilterWeight*i.velocityFrom(e)+(1-this.velocityFilterWeight)*this._lastVelocity,s=this._strokeWidth(n);return o.start=this._lastWidth,o.end=s,this._lastVelocity=n,this._lastWidth=s,o},o.prototype._strokeWidth=function(t){return Math.max(this.maxWidth/(t+1),this.minWidth)},o.prototype._drawPoint=function(t,e,i){var o=this._ctx;o.moveTo(t,e),o.arc(t,e,i,0,2*Math.PI,!1),this._isEmpty=!1},o.prototype._drawCurve=function(t,e,i){var o=this._ctx,n=i-e,s=Math.floor(t.length());o.beginPath();for(var r=0;s>r;r+=1){var h=r/s,a=h*h,c=a*h,d=1-h,l=d*d,u=l*d,v=u*t.startPoint.x;v+=3*l*h*t.control1.x,v+=3*d*a*t.control2.x,v+=c*t.endPoint.x;var p=u*t.startPoint.y;p+=3*l*h*t.control1.y,p+=3*d*a*t.control2.y,p+=c*t.endPoint.y;var _=e+c*n;this._drawPoint(v,p,_)}o.closePath(),o.fill()},o.prototype._drawDot=function(t){var e=this._ctx,i="function"==typeof this.dotSize?this.dotSize():this.dotSize;e.beginPath(),this._drawPoint(t.x,t.y,i),e.closePath(),e.fill()},o.prototype._fromData=function(e,i,o){for(var n=0;n<e.length;n+=1){var s=e[n];if(s.length>1)for(var r=0;r<s.length;r+=1){var h=s[r],a=new t(h.x,h.y,h.time),c=h.color;if(0===r)this.penColor=c,this._reset(),this._addPoint(a);else if(r!==s.length-1){var d=this._addPoint(a),l=d.curve,u=d.widths;l&&u&&i(l,u,c)}}else this._reset(),o(s[0])}},o.prototype._toSVG=function(){var t=this,e=this._data,i=this._canvas,o=Math.max(window.devicePixelRatio||1,1),n=i.width/o,s=i.height/o,r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS(null,"width",i.width),r.setAttributeNS(null,"height",i.height),this._fromData(e,function(t,e,i){var o=document.createElement("path");if(!(isNaN(t.control1.x)||isNaN(t.control1.y)||isNaN(t.control2.x)||isNaN(t.control2.y))){var n="M "+t.startPoint.x.toFixed(3)+","+t.startPoint.y.toFixed(3)+" C "+t.control1.x.toFixed(3)+","+t.control1.y.toFixed(3)+" "+t.control2.x.toFixed(3)+","+t.control2.y.toFixed(3)+" "+t.endPoint.x.toFixed(3)+","+t.endPoint.y.toFixed(3);o.setAttribute("d",n),o.setAttribute("stroke-width",(2.25*e.end).toFixed(3)),o.setAttribute("stroke",i),o.setAttribute("fill","none"),o.setAttribute("stroke-linecap","round"),r.appendChild(o)
}},function(e){var i=document.createElement("circle"),o="function"==typeof t.dotSize?t.dotSize():t.dotSize;i.setAttribute("r",o),i.setAttribute("cx",e.x),i.setAttribute("cy",e.y),i.setAttribute("fill",e.color),r.appendChild(i)});var h='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 '+n+" "+s+'" width="'+n+'" height="'+s+'">',a=r.innerHTML;if(void 0===a){var c=document.createElement("dummy"),d=r.childNodes;c.innerHTML="";for(var l=0;l<d.length;l+=1)c.appendChild(d[l].cloneNode(!0));a=c.innerHTML}var u=h+a+"</svg>";return"data:image/svg+xml;base64,"+btoa(u)},o.prototype.fromData=function(t){var e=this;this.clear(),this._fromData(t,function(t,i){return e._drawCurve(t,i.start,i.end)},function(t){return e._drawDot(t)}),this._data=t},o.prototype.toData=function(){return this._data},o}),/* ===========================================================
 * bootstrap-tooltip.js v2.3.1
 * http://twitter.github.com/bootstrap/javascript.html#tooltips
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ===========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */
!function($){"use strict";var Tooltip=function(element,options){this.init("tooltip",element,options)};Tooltip.prototype={constructor:Tooltip,init:function(type,element,options){var eventIn,eventOut,triggers,trigger,i;for(this.type=type,this.$element=$(element),this.options=this.getOptions(options),this.enabled=!0,triggers=this.options.trigger.split(" "),i=triggers.length;i--;)trigger=triggers[i],"click"==trigger?this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this)):"manual"!=trigger&&(eventIn="hover"==trigger?"mouseenter":"focus",eventOut="hover"==trigger?"mouseleave":"blur",this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this)));this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(options){return options=$.extend({},$.fn[this.type].defaults,this.$element.data(),options),options.delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},enter:function(e){var self,defaults=$.fn[this.type].defaults,options={};return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)},this),self=$(e.currentTarget)[this.type](options).data(this.type),self.options.delay&&self.options.delay.show?(clearTimeout(this.timeout),self.hoverState="in",this.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()},self.options.delay.show),void 0):self.show()},leave:function(e){var self=$(e.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),self.options.delay&&self.options.delay.hide?(self.hoverState="out",this.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide),void 0):self.hide()},show:function(){var $tip,pos,actualWidth,actualHeight,placement,tp,e=$.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(e),e.isDefaultPrevented())return;switch($tip=this.tip(),this.setContent(),this.options.animation&&$tip.addClass("fade"),placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,$tip.detach().css({top:0,left:0,display:"block"}),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element),pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight,placement){case"bottom":tp={top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2};break;case"top":tp={top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2};break;case"left":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth};break;case"right":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}}this.applyPlacement(tp,placement),this.$element.trigger("shown")}},applyPlacement:function(offset,placement){var actualWidth,actualHeight,delta,replace,$tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight;$tip.offset(offset).addClass(placement).addClass("in"),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight,"top"==placement&&actualHeight!=height&&(offset.top=offset.top+height-actualHeight,replace=!0),"bottom"==placement||"top"==placement?(delta=0,offset.left<0&&(delta=-2*offset.left,offset.left=0,$tip.offset(offset),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight),this.replaceArrow(delta-width+actualWidth,actualWidth,"left")):this.replaceArrow(actualHeight-height,actualHeight,"top"),replace&&$tip.offset(offset)},replaceArrow:function(delta,dimension,position){this.arrow().css(position,delta?50*(1-delta/dimension)+"%":"")},setContent:function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},hide:function(){function removeWithAnimation(){var timeout=setTimeout(function(){$tip.off($.support.transition.end).detach()},500);$tip.one($.support.transition.end,function(){clearTimeout(timeout),$tip.detach()})}var $tip=this.tip(),e=$.Event("hide");return this.$element.trigger(e),e.isDefaultPrevented()?void 0:($tip.removeClass("in"),$.support.transition&&this.$tip.hasClass("fade")?removeWithAnimation():$tip.detach(),this.$element.trigger("hidden"),this)},fixTitle:function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var el=this.$element[0];return $.extend({},"function"==typeof el.getBoundingClientRect?el.getBoundingClientRect():{width:el.offsetWidth,height:el.offsetHeight},this.$element.offset())},getTitle:function(){var title,$e=this.$element,o=this.options;return title=$e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},tip:function(){return this.$tip=this.$tip||$(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(e){var self=e?$(e.currentTarget)[this.type](this._options).data(this.type):this;self.tip().hasClass("in")?self.hide():self.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var old=$.fn.tooltip;$.fn.tooltip=function(option){return this.each(function(){var $this=$(this),data=$this.data("tooltip"),options="object"==typeof option&&option;data||$this.data("tooltip",data=new Tooltip(this,options)),"string"==typeof option&&data[option]()})},$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(window.jQuery),/* ===========================================================
 * bootstrap-popover.js v2.3.1
 * http://twitter.github.com/bootstrap/javascript.html#popovers
 * ===========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =========================================================== */
!function($){"use strict";var Popover=function(element,options){this.init("popover",element,options)};Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype,{constructor:Popover,setContent:function(){var $tip=this.tip(),title=this.getTitle(),content=this.getContent();$tip.find(".popover-title")[this.options.html?"html":"text"](title),$tip.find(".popover-content")[this.options.html?"html":"text"](content),$tip.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var content,$e=this.$element,o=this.options;return content=("function"==typeof o.content?o.content.call($e[0]):o.content)||$e.attr("data-content")},tip:function(){return this.$tip||(this.$tip=$(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var old=$.fn.popover;$.fn.popover=function(option){return this.each(function(){var $this=$(this),data=$this.data("popover"),options="object"==typeof option&&option;data||$this.data("popover",data=new Popover(this,options)),"string"==typeof option&&data[option]()})},$.fn.popover.Constructor=Popover,$.fn.popover.defaults=$.extend({},$.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),$.fn.popover.noConflict=function(){return $.fn.popover=old,this}}(window.jQuery),/* =========================================================
 * bootstrap-modal.js v2.3.1
 * http://twitter.github.com/bootstrap/javascript.html#modals
 * =========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */
!function($){"use strict";var Modal=function(element,options){this.options=options,this.$element=$(element).delegate('[data-dismiss="modal"]',"click.dismiss.modal",$.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};Modal.prototype={constructor:Modal,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var that=this,e=$.Event("show");this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(document.body),that.$element.show(),transition&&that.$element[0].offsetWidth,that.$element.addClass("in").attr("aria-hidden",!1),that.enforceFocus(),transition?that.$element.one($.support.transition.end,function(){that.$element.focus().trigger("shown")}):that.$element.focus().trigger("shown")}))},hide:function(e){e&&e.preventDefault(),e=$.Event("hide"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),$(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),$.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var that=this;$(document).on("focusin.modal",function(e){that.$element[0]===e.target||that.$element.has(e.target).length||that.$element.focus()})},escape:function(){var that=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(e){27==e.which&&that.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var that=this,timeout=setTimeout(function(){that.$element.off($.support.transition.end),that.hideModal()},500);this.$element.one($.support.transition.end,function(){clearTimeout(timeout),that.hideModal()})},hideModal:function(){var that=this;this.$element.hide(),this.backdrop(function(){that.removeBackdrop(),that.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(callback){var animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;if(this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?$.proxy(this.$element[0].focus,this.$element[0]):$.proxy(this.hide,this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!callback)return;doAnimate?this.$backdrop.one($.support.transition.end,callback):callback()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one($.support.transition.end,callback):callback()):callback&&callback()}};var old=$.fn.modal;$.fn.modal=function(option){return this.each(function(){var $this=$(this),data=$this.data("modal"),options=$.extend({},$.fn.modal.defaults,$this.data(),"object"==typeof option&&option);data||$this.data("modal",data=new Modal(this,options)),"string"==typeof option?data[option]():options.show&&data.show()})},$.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());e.preventDefault(),$target.modal(option).one("hide",function(){$this.focus()})})}(window.jQuery),function(window,document,undefined){"use strict";function isArrayLike(obj){return obj&&"number"==typeof obj.length?"function"!=typeof obj.hasOwnProperty&&"function"!=typeof obj.constructor?!0:obj instanceof JQLite||jQuery&&obj instanceof jQuery||"[object Object]"!==toString.call(obj)||"function"==typeof obj.callee:!1}function forEach(obj,iterator,context){var key;if(obj)if(isFunction(obj))for(key in obj)"prototype"!=key&&"length"!=key&&"name"!=key&&obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key);else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context);else if(isArrayLike(obj))for(key=0;key<obj.length;key++)iterator.call(context,obj[key],key);else for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key);return obj}function sortedKeys(obj){var keys=[];for(var key in obj)obj.hasOwnProperty(key)&&keys.push(key);return keys.sort()}function forEachSorted(obj,iterator,context){for(var keys=sortedKeys(obj),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){for(var digit,index=uid.length;index;){if(index--,digit=uid[index].charCodeAt(0),57==digit)return uid[index]="A",uid.join("");if(90!=digit)return uid[index]=String.fromCharCode(digit+1),uid.join("");uid[index]="0"}return uid.unshift("0"),uid.join("")}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function extend(dst){var h=dst.$$hashKey;return forEach(arguments,function(obj){obj!==dst&&forEach(obj,function(value,key){dst[key]=value})}),setHashKey(dst,h),dst}function int(str){return parseInt(str,10)}function inherit(parent,extra){return extend(new(extend(function(){},{prototype:parent})),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function isUndefined(value){return"undefined"==typeof value}function isDefined(value){return"undefined"!=typeof value}function isObject(value){return null!=value&&"object"==typeof value}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"==toString.apply(value)}function isArray(value){return"[object Array]"==toString.apply(value)}function isFunction(value){return"function"==typeof value}function isWindow(obj){return obj&&obj.document&&obj.location&&obj.alert&&obj.setInterval}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isFile(obj){return"[object File]"===toString.apply(obj)}function trim(value){return isString(value)?value.replace(/^\s*/,"").replace(/\s*$/,""):value}function isElement(node){return node&&(node.nodeName||node.bind&&node.find)}function map(obj,iterator,context){var results=[];return forEach(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results}function includes(array,obj){return-1!=indexOf(array,obj)}function indexOf(array,obj){if(array.indexOf)return array.indexOf(obj);for(var i=0;i<array.length;i++)if(obj===array[i])return i;return-1}function arrayRemove(array,value){var index=indexOf(array,value);return index>=0&&array.splice(index,1),value}function copy(source,destination){if(isWindow(source)||isScope(source))throw Error("Can't copy Window or Scope");if(destination){if(source===destination)throw Error("Can't copy equivalent objects or arrays");if(isArray(source)){destination.length=0;for(var i=0;i<source.length;i++)destination.push(copy(source[i]))}else{var h=destination.$$hashKey;forEach(destination,function(value,key){delete destination[key]});for(var key in source)destination[key]=copy(source[key]);setHashKey(destination,h)}}else destination=source,source&&(isArray(source)?destination=copy(source,[]):isDate(source)?destination=new Date(source.getTime()):isObject(source)&&(destination=copy(source,{})));return destination}function shallowCopy(src,dst){dst=dst||{};for(var key in src)src.hasOwnProperty(key)&&"$$"!==key.substr(0,2)&&(dst[key]=src[key]);return dst}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!==o1&&o2!==o2)return!0;var length,key,keySet,t1=typeof o1,t2=typeof o2;if(t1==t2&&"object"==t1){if(!isArray(o1)){if(isDate(o1))return isDate(o2)&&o1.getTime()==o2.getTime();if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2))return!1;keySet={};for(key in o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!keySet[key]&&"$"!==key.charAt(0)&&o2[key]!==undefined&&!isFunction(o2[key]))return!1;return!0}if((length=o1.length)==o2.length){for(key=0;length>key;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,curryArgs.concat(slice.call(arguments,0))):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return/^\$+/.test(key)?val=undefined:isWindow(value)?val="$WINDOW":value&&document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){return JSON.stringify(obj,toJsonReplacer,pretty?"  ":null)}function fromJson(json){return isString(json)?JSON.parse(json):json}function toBoolean(value){if(value&&0!==value.length){var v=lowercase(""+value);value=!("f"==v||"0"==v||"false"==v||"no"==v||"n"==v||"[]"==v)}else value=!1;return value}function startingTag(element){element=jqLite(element).clone();try{element.html("")}catch(e){}var TEXT_NODE=3,elemHtml=jqLite("<div>").append(element).html();try{return element[0].nodeType===TEXT_NODE?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function parseKeyValue(keyValue){var key_value,key,obj={};return forEach((keyValue||"").split("&"),function(keyValue){keyValue&&(key_value=keyValue.split("="),key=decodeURIComponent(key_value[0]),obj[key]=isDefined(key_value[1])?decodeURIComponent(key_value[1]):!0)}),obj}function toKeyValue(obj){var parts=[];return forEach(obj,function(value,key){parts.push(encodeUriQuery(key,!0)+(value===!0?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function angularInit(element,bootstrap){function append(element){element&&elements.push(element)}var appElement,module,elements=[element],names=["ng:app","ng-app","x-ng-app","data-ng-app"],NG_APP_CLASS_REGEXP=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;forEach(names,function(name){names[name]=!0,append(document.getElementById(name)),name=name.replace(":","\\:"),element.querySelectorAll&&(forEach(element.querySelectorAll("."+name),append),forEach(element.querySelectorAll("."+name+"\\:"),append),forEach(element.querySelectorAll("["+name+"]"),append))}),forEach(elements,function(element){if(!appElement){var className=" "+element.className+" ",match=NG_APP_CLASS_REGEXP.exec(className);match?(appElement=element,module=(match[2]||"").replace(/\s+/g,",")):forEach(element.attributes,function(attr){!appElement&&names[attr.name]&&(appElement=element,module=attr.value)})}}),appElement&&bootstrap(appElement,module?[module]:[])}function bootstrap(element,modules){var resumeBootstrapInternal=function(){element=jqLite(element),modules=modules||[],modules.unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),modules.unshift("ng");var injector=createInjector(modules);return injector.invoke(["$rootScope","$rootElement","$compile","$injector",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;return window&&!NG_DEFER_BOOTSTRAP.test(window.name)?resumeBootstrapInternal():(window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),angular.resumeBootstrap=function(extraModules){forEach(extraModules,function(module){modules.push(module)}),resumeBootstrapInternal()},void 0)}function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}function bindJQuery(){jQuery=window.jQuery,jQuery?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData}),JQLitePatchJQueryRemove("remove",!0),JQLitePatchJQueryRemove("empty"),JQLitePatchJQueryRemove("html")):jqLite=JQLite,angular.element=jqLite}function assertArg(arg,name,reason){if(!arg)throw new Error("Argument '"+(name||"?")+"' is "+(reason||"required"));return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function setupModuleLoader(window){function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}return ensure(ensure(window,"angular",Object),"module",function(){var modules={};return function(name,requires,configFn){return requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){function invokeLater(provider,method,insertMethod){return function(){return invokeQueue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}if(!requires)throw Error("No module: "+name);var invokeQueue=[],runBlocks=[],config=invokeLater("$injector","invoke"),moduleInstance={_invokeQueue:invokeQueue,_runBlocks:runBlocks,requires:requires,name:name,provider:invokeLater("$provide","provider"),factory:invokeLater("$provide","factory"),service:invokeLater("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),filter:invokeLater("$filterProvider","register"),controller:invokeLater("$controllerProvider","register"),directive:invokeLater("$compileProvider","directive"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance})}})}function publishExternalAPI(angular){extend(angular,{bootstrap:bootstrap,copy:copy,extend:extend,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,lowercase:lowercase,uppercase:uppercase,callbacks:{counter:0}}),angularModule=setupModuleLoader(window);try{angularModule("ngLocale")}catch(e){angularModule("ngLocale",[]).provider("$locale",$LocaleProvider)}angularModule("ng",["ngLocale"],["$provide",function($provide){$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,style:styleDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtmlUnsafe:ngBindHtmlUnsafeDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCsp:ngCspDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngSubmit:ngSubmitDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngView:ngViewDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,required:requiredDirective,ngRequired:requiredDirective,ngValue:ngValueDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$interpolate:$InterpolateProvider,$http:$HttpProvider,$httpBackend:$HttpBackendProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$route:$RouteProvider,$routeParams:$RouteParamsProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$sniffer:$SnifferProvider,$templateCache:$TemplateCacheProvider,$timeout:$TimeoutProvider,$window:$WindowProvider})}])}function jqNextId(){return++jqId}function camelCase(name){return name.replace(SPECIAL_CHARS_REGEXP,function(_,separator,letter,offset){return offset?letter.toUpperCase():letter}).replace(MOZ_HACK_REGEXP,"Moz$1")}function JQLitePatchJQueryRemove(name,dispatchThis){function removePatch(){for(var set,setIndex,setLength,element,childIndex,childLength,children,list=[this],fireEvent=dispatchThis;list.length;)for(set=list.shift(),setIndex=0,setLength=set.length;setLength>setIndex;setIndex++)for(element=jqLite(set[setIndex]),fireEvent?element.triggerHandler("$destroy"):fireEvent=!fireEvent,childIndex=0,childLength=(children=element.children()).length;childLength>childIndex;childIndex++)list.push(jQuery(children[childIndex]));return originalJqFn.apply(this,arguments)}var originalJqFn=jQuery.fn[name];originalJqFn=originalJqFn.$original||originalJqFn,removePatch.$original=originalJqFn,jQuery.fn[name]=removePatch}function JQLite(element){if(element instanceof JQLite)return element;if(!(this instanceof JQLite)){if(isString(element)&&"<"!=element.charAt(0))throw Error("selectors not implemented");return new JQLite(element)}if(isString(element)){var div=document.createElement("div");div.innerHTML="<div>&#160;</div>"+element,div.removeChild(div.firstChild),JQLiteAddNodes(this,div.childNodes),this.remove()}else JQLiteAddNodes(this,element)}function JQLiteClone(element){return element.cloneNode(!0)}function JQLiteDealoc(element){JQLiteRemoveData(element);for(var i=0,children=element.childNodes||[];i<children.length;i++)JQLiteDealoc(children[i])}function JQLiteUnbind(element,type,fn){var events=JQLiteExpandoStore(element,"events"),handle=JQLiteExpandoStore(element,"handle");handle&&(isUndefined(type)?forEach(events,function(eventHandler,type){removeEventListenerFn(element,type,eventHandler),delete events[type]}):isUndefined(fn)?(removeEventListenerFn(element,type,events[type]),delete events[type]):arrayRemove(events[type],fn))}function JQLiteRemoveData(element){var expandoId=element[jqName],expandoStore=jqCache[expandoId];expandoStore&&(expandoStore.handle&&(expandoStore.events.$destroy&&expandoStore.handle({},"$destroy"),JQLiteUnbind(element)),delete jqCache[expandoId],element[jqName]=undefined)}function JQLiteExpandoStore(element,key,value){var expandoId=element[jqName],expandoStore=jqCache[expandoId||-1];return isDefined(value)?(expandoStore||(element[jqName]=expandoId=jqNextId(),expandoStore=jqCache[expandoId]={}),expandoStore[key]=value,void 0):expandoStore&&expandoStore[key]}function JQLiteData(element,key,value){var data=JQLiteExpandoStore(element,"data"),isSetter=isDefined(value),keyDefined=!isSetter&&isDefined(key),isSimpleGetter=keyDefined&&!isObject(key);if(data||isSimpleGetter||JQLiteExpandoStore(element,"data",data={}),isSetter)data[key]=value;else{if(!keyDefined)return data;if(isSimpleGetter)return data&&data[key];extend(data,key)}}function JQLiteHasClass(element,selector){return(" "+element.className+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1}function JQLiteRemoveClass(element,cssClasses){cssClasses&&forEach(cssClasses.split(" "),function(cssClass){element.className=trim((" "+element.className+" ").replace(/[\n\t]/g," ").replace(" "+trim(cssClass)+" "," "))})}function JQLiteAddClass(element,cssClasses){cssClasses&&forEach(cssClasses.split(" "),function(cssClass){JQLiteHasClass(element,cssClass)||(element.className=trim(element.className+" "+trim(cssClass)))})}function JQLiteAddNodes(root,elements){if(elements){elements=elements.nodeName||!isDefined(elements.length)||isWindow(elements)?[elements]:elements;for(var i=0;i<elements.length;i++)root.push(elements[i])}}function JQLiteController(element,name){return JQLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function JQLiteInheritedData(element,name,value){for(element=jqLite(element),9==element[0].nodeType&&(element=element.find("html"));element.length;){if(value=element.data(name))return value;element=element.parent()}}function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[element.nodeName]&&booleanAttr}function createEventHandler(element,events){var eventHandler=function(event,type){if(event.preventDefault||(event.preventDefault=function(){event.returnValue=!1}),event.stopPropagation||(event.stopPropagation=function(){event.cancelBubble=!0}),event.target||(event.target=event.srcElement||document),isUndefined(event.defaultPrevented)){var prevent=event.preventDefault;event.preventDefault=function(){event.defaultPrevented=!0,prevent.call(event)},event.defaultPrevented=!1}event.isDefaultPrevented=function(){return event.defaultPrevented},forEach(events[type||event.type],function(fn){fn.call(element,event)}),8>=msie?(event.preventDefault=null,event.stopPropagation=null,event.isDefaultPrevented=null):(delete event.preventDefault,delete event.stopPropagation,delete event.isDefaultPrevented)};return eventHandler.elem=element,eventHandler}function hashKey(obj){var key,objType=typeof obj;return"object"==objType&&null!==obj?"function"==typeof(key=obj.$$hashKey)?key=obj.$$hashKey():key===undefined&&(key=obj.$$hashKey=nextUid()):key=obj,objType+":"+key}function HashMap(array){forEach(array,this.put,this)}function HashQueueMap(){}function annotate(fn){var $inject,fnText,argDecl,last;return"function"==typeof fn?($inject=fn.$inject)||($inject=[],fnText=fn.toString().replace(STRIP_COMMENTS,""),argDecl=fnText.match(FN_ARGS),forEach(argDecl[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})}),fn.$inject=$inject):isArray(fn)?(last=fn.length-1,assertArgFn(fn[last],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0),$inject}function createInjector(modulesToLoad){function supportObject(delegate){return function(key,value){return isObject(key)?(forEach(key,reverseParams(delegate)),void 0):delegate(key,value)}}function provider(name,provider_){if((isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw Error("Provider "+name+" must define $get factory method.");return providerCache[name+providerSuffix]=provider_}function factory(name,factoryFn){return provider(name,{$get:factoryFn})}function service(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}function value(name,value){return factory(name,valueFn(value))}function constant(name,value){providerCache[name]=value,instanceCache[name]=value}function decorator(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}function loadModules(modulesToLoad){var runBlocks=[];return forEach(modulesToLoad,function(module){if(!loadedModules.get(module))if(loadedModules.put(module,!0),isString(module)){var moduleFn=angularModule(module);runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks);try{for(var invokeQueue=moduleFn._invokeQueue,i=0,ii=invokeQueue.length;ii>i;i++){var invokeArgs=invokeQueue[i],provider="$injector"==invokeArgs[0]?providerInjector:providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}}catch(e){throw e.message&&(e.message+=" from "+module),e}}else if(isFunction(module))try{runBlocks.push(providerInjector.invoke(module))}catch(e){throw e.message&&(e.message+=" from "+module),e}else if(isArray(module))try{runBlocks.push(providerInjector.invoke(module))}catch(e){throw e.message&&(e.message+=" from "+String(module[module.length-1])),e}else assertArgFn(module,"module")}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName){if("string"!=typeof serviceName)throw Error("Service name expected");if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw Error("Circular dependency: "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName)}finally{path.shift()}}function invoke(fn,self,locals){var length,i,key,args=[],$inject=annotate(fn);for(i=0,length=$inject.length;length>i;i++)key=$inject[i],args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key));switch(fn.$inject||(fn=fn[length]),self?-1:args.length){case 0:return fn();case 1:return fn(args[0]);case 2:return fn(args[0],args[1]);case 3:return fn(args[0],args[1],args[2]);case 4:return fn(args[0],args[1],args[2],args[3]);case 5:return fn(args[0],args[1],args[2],args[3],args[4]);case 6:return fn(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return fn(args[0],args[1],args[2],args[3],args[4],args[5],args[6]);case 8:return fn(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7]);case 9:return fn(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8]);case 10:return fn(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9]);default:return fn.apply(self,args)}}function instantiate(Type,locals){var instance,returnedValue,Constructor=function(){};return Constructor.prototype=(isArray(Type)?Type[Type.length-1]:Type).prototype,instance=new Constructor,returnedValue=invoke(Type,instance,locals),isObject(returnedValue)?returnedValue:instance}return{invoke:invoke,instantiate:instantiate,get:getService,annotate:annotate}}var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new HashMap,providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(service),value:supportObject(value),constant:supportObject(constant),decorator:decorator}},providerInjector=createInternalInjector(providerCache,function(){throw Error("Unknown provider: "+path.join(" <- "))}),instanceCache={},instanceInjector=instanceCache.$injector=createInternalInjector(instanceCache,function(servicename){var provider=providerInjector.get(servicename+providerSuffix);return instanceInjector.invoke(provider.$get,provider)});return forEach(loadModules(modulesToLoad),function(fn){instanceInjector.invoke(fn||noop)}),instanceInjector}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){function getFirstAnchor(list){var result=null;return forEach(list,function(element){result||"a"!==lowercase(element.nodeName)||(result=element)}),result}function scroll(){var elm,hash=$location.hash();hash?(elm=document.getElementById(hash))?elm.scrollIntoView():(elm=getFirstAnchor(document.getElementsByName(hash)))?elm.scrollIntoView():"top"===hash&&$window.scrollTo(0,0):$window.scrollTo(0,0)}var document=$window.document;return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(){$rootScope.$evalAsync(scroll)}),scroll}]}function Browser(window,document,$log,$sniffer){function completeOutstandingRequest(fn){try{fn.apply(null,sliceArgs(arguments,1))}finally{if(outstandingRequestCount--,0===outstandingRequestCount)for(;outstandingRequestCallbacks.length;)try{outstandingRequestCallbacks.pop()()}catch(e){$log.error(e)}}}function startPoller(interval,setTimeout){!function check(){forEach(pollFns,function(pollFn){pollFn()}),pollTimeout=setTimeout(check,interval)}()}function fireUrlChange(){lastBrowserUrl!=self.url()&&(lastBrowserUrl=self.url(),forEach(urlChangeListeners,function(listener){listener(self.url())}))}var self=this,rawDocument=document[0],location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={};self.isMock=!1;var outstandingRequestCount=0,outstandingRequestCallbacks=[];self.$$completeOutstandingRequest=completeOutstandingRequest,self.$$incOutstandingRequestCount=function(){outstandingRequestCount++},self.notifyWhenNoOutstandingRequests=function(callback){forEach(pollFns,function(pollFn){pollFn()}),0===outstandingRequestCount?callback():outstandingRequestCallbacks.push(callback)};var pollTimeout,pollFns=[];self.addPollFn=function(fn){return isUndefined(pollTimeout)&&startPoller(100,setTimeout),pollFns.push(fn),fn};var lastBrowserUrl=location.href,baseElement=document.find("base");self.url=function(url,replace){if(url){if(lastBrowserUrl==url)return;return lastBrowserUrl=url,$sniffer.history?replace?history.replaceState(null,"",url):(history.pushState(null,"",url),baseElement.attr("href",baseElement.attr("href"))):replace?location.replace(url):location.href=url,self}return location.href.replace(/%27/g,"'")};var urlChangeListeners=[],urlChangeInit=!1;self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).bind("popstate",fireUrlChange),$sniffer.hashchange?jqLite(window).bind("hashchange",fireUrlChange):self.addPollFn(fireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^https?\:\/\/[^\/]*/,""):""};var lastCookies={},lastCookieString="",cookiePath=self.baseHref();self.cookies=function(name,value){var cookieLength,cookieArray,cookie,i,index;if(!name){if(rawDocument.cookie!==lastCookieString)for(lastCookieString=rawDocument.cookie,cookieArray=lastCookieString.split("; "),lastCookies={},i=0;i<cookieArray.length;i++)if(cookie=cookieArray[i],index=cookie.indexOf("="),index>0){var name=unescape(cookie.substring(0,index));lastCookies[name]===undefined&&(lastCookies[name]=unescape(cookie.substring(index+1)))}return lastCookies}value===undefined?rawDocument.cookie=escape(name)+"=;path="+cookiePath+";expires=Thu, 01 Jan 1970 00:00:00 GMT":isString(value)&&(cookieLength=(rawDocument.cookie=escape(name)+"="+escape(value)+";path="+cookiePath).length+1,cookieLength>4096&&$log.warn("Cookie '"+name+"' possibly not set or overflowed because it was too large ("+cookieLength+" > 4096 bytes)!"))},self.defer=function(fn,delay){var timeoutId;return outstandingRequestCount++,timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],completeOutstandingRequest(fn)},delay||0),pendingDeferIds[timeoutId]=!0,timeoutId},self.defer.cancel=function(deferId){return pendingDeferIds[deferId]?(delete pendingDeferIds[deferId],clearTimeout(deferId),completeOutstandingRequest(noop),!0):!1}}function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document",function($window,$log,$sniffer,$document){return new Browser($window,$document,$log,$sniffer)}]}function $CacheFactoryProvider(){this.$get=function(){function cacheFactory(cacheId,options){function refresh(entry){entry!=freshEnd&&(staleEnd?staleEnd==entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),freshEnd=entry,freshEnd.n=null)}function link(nextEntry,prevEntry){nextEntry!=prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}if(cacheId in caches)throw Error("cacheId "+cacheId+" taken");var size=0,stats=extend({},options,{id:cacheId}),data={},capacity=options&&options.capacity||Number.MAX_VALUE,lruHash={},freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){var lruEntry=lruHash[key]||(lruHash[key]={key:key});refresh(lruEntry),isUndefined(value)||(key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key))},get:function(key){var lruEntry=lruHash[key];if(lruEntry)return refresh(lruEntry),data[key]},remove:function(key){var lruEntry=lruHash[key];lruEntry&&(lruEntry==freshEnd&&(freshEnd=lruEntry.p),lruEntry==staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key],delete data[key],size--)},removeAll:function(){data={},size=0,lruHash={},freshEnd=staleEnd=null
},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}}}var caches={};return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}function $CompileProvider($provide){var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive\:\s*([\d\w\-_]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\d\w\-_]+)(?:\:([^;]+))?;?)/,MULTI_ROOT_TEMPLATE_ERROR="Template must have exactly one root element. was: ",urlSanitizationWhitelist=/^\s*(https?|ftp|mailto|file):/;this.directive=function registerDirective(name,directiveFactory){return isString(name)?(assertArg(directiveFactory,"directive"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.name=directive.name||name,directive.require=directive.require||directive.controller&&directive.name,directive.restrict=directive.restrict||"A",directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.urlSanitizationWhitelist=function(regexp){return isDefined(regexp)?(urlSanitizationWhitelist=regexp,this):urlSanitizationWhitelist},this.$get=["$injector","$interpolate","$exceptionHandler","$http","$templateCache","$parse","$controller","$rootScope","$document",function($injector,$interpolate,$exceptionHandler,$http,$templateCache,$parse,$controller,$rootScope,$document){function compile($compileNodes,transcludeFn,maxPriority){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes)),forEach($compileNodes,function(node,index){3==node.nodeType&&node.nodeValue.match(/\S+/)&&($compileNodes[index]=jqLite(node).wrap("<span></span>").parent()[0])});var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority);return function(scope,cloneConnectFn){assertArg(scope,"scope");for(var $linkNode=cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes,i=0,ii=$linkNode.length;ii>i;i++){var node=$linkNode[i];(1==node.nodeType||9==node.nodeType)&&$linkNode.eq(i).data("$scope",scope)}return safeAddClass($linkNode,"ng-scope"),cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode),$linkNode}}function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority){function compositeLinkFn(scope,nodeList,$rootElement,boundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,childTranscludeFn,i,ii,n,stableNodeList=[];for(i=0,ii=nodeList.length;ii>i;i++)stableNodeList.push(nodeList[i]);for(i=0,n=0,ii=linkFns.length;ii>i;n++)node=stableNodeList[n],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(isObject(nodeLinkFn.scope)),jqLite(node).data("$scope",childScope)):childScope=scope,childTranscludeFn=nodeLinkFn.transclude,childTranscludeFn||!boundTranscludeFn&&transcludeFn?nodeLinkFn(childLinkFn,childScope,node,$rootElement,function(transcludeFn){return function(cloneFn){var transcludeScope=scope.$new();return transcludeScope.$$transcluded=!0,transcludeFn(transcludeScope,cloneFn).bind("$destroy",bind(transcludeScope,transcludeScope.$destroy))}}(childTranscludeFn||transcludeFn)):nodeLinkFn(childLinkFn,childScope,node,undefined,boundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,undefined,boundTranscludeFn)}for(var nodeLinkFn,childLinkFn,directives,attrs,linkFnFound,linkFns=[],i=0;i<nodeList.length;i++)attrs=new Attributes,directives=collectDirectives(nodeList[i],[],attrs,maxPriority),nodeLinkFn=directives.length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement):null,childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!nodeList[i].childNodes||!nodeList[i].childNodes.length?null:compileNodes(nodeList[i].childNodes,nodeLinkFn?nodeLinkFn.transclude:transcludeFn),linkFns.push(nodeLinkFn),linkFns.push(childLinkFn),linkFnFound=linkFnFound||nodeLinkFn||childLinkFn;return linkFnFound?compositeLinkFn:null}function collectDirectives(node,directives,attrs,maxPriority){var match,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case 1:addDirective(directives,directiveNormalize(nodeName_(node).toLowerCase()),"E",maxPriority);for(var attr,name,nName,value,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;jj>j;j++)attr=nAttrs[j],attr.specified&&(name=attr.name,nName=directiveNormalize(name.toLowerCase()),attrsMap[nName]=name,attrs[nName]=value=trim(msie&&"href"==name?decodeURIComponent(node.getAttribute(name,2)):attr.value),getBooleanAttrName(node,nName)&&(attrs[nName]=!0),addAttrInterpolateDirective(node,directives,value,nName),addDirective(directives,nName,"A",maxPriority));if(className=node.className,isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)nName=directiveNormalize(match[2]),addDirective(directives,nName,"C",maxPriority)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case 3:addTextInterpolateDirective(directives,node.nodeValue);break;case 8:try{match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue),match&&(nName=directiveNormalize(match[1]),addDirective(directives,nName,"M",maxPriority)&&(attrs[nName]=trim(match[2])))}catch(e){}}return directives.sort(byPriority),directives}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection){function addLinkFns(pre,post){pre&&(pre.require=directive.require,preLinkFns.push(pre)),post&&(post.require=directive.require,postLinkFns.push(post))}function getControllers(require,$element){var value,retrievalMethod="data",optional=!1;if(isString(require)){for(;"^"==(value=require.charAt(0))||"?"==value;)require=require.substr(1),"^"==value&&(retrievalMethod="inheritedData"),optional=optional||"?"==value;if(value=$element[retrievalMethod]("$"+require+"Controller"),!value&&!optional)throw Error("No controller: "+require);return value}return isArray(require)&&(value=[],forEach(require,function(require){value.push(getControllers(require,$element))})),value}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){var attrs,$element,i,ii,linkFn,controller;if(attrs=compileNode===linkNode?templateAttrs:shallowCopy(templateAttrs,new Attributes(jqLite(linkNode),templateAttrs.$attr)),$element=attrs.$$element,newIsolateScopeDirective){var LOCAL_REGEXP=/^\s*([@=&])\s*(\w*)\s*$/,parentScope=scope.$parent||scope;forEach(newIsolateScopeDirective.scope,function(definiton,scopeName){var lastValue,parentGet,parentSet,match=definiton.match(LOCAL_REGEXP)||[],attrName=match[2]||scopeName,mode=match[1];switch(scope.$$isolateBindings[scopeName]=mode+attrName,mode){case"@":attrs.$observe(attrName,function(value){scope[scopeName]=value}),attrs.$$observers[attrName].$$scope=parentScope;break;case"=":parentGet=$parse(attrs[attrName]),parentSet=parentGet.assign||function(){throw lastValue=scope[scopeName]=parentGet(parentScope),Error(NON_ASSIGNABLE_MODEL_EXPRESSION+attrs[attrName]+" (directive: "+newIsolateScopeDirective.name+")")},lastValue=scope[scopeName]=parentGet(parentScope),scope.$watch(function(){var parentValue=parentGet(parentScope);return parentValue!==scope[scopeName]&&(parentValue!==lastValue?lastValue=scope[scopeName]=parentValue:parentSet(parentScope,parentValue=lastValue=scope[scopeName])),parentValue});break;case"&":parentGet=$parse(attrs[attrName]),scope[scopeName]=function(locals){return parentGet(parentScope,locals)};break;default:throw Error("Invalid isolate scope definition for directive "+newIsolateScopeDirective.name+": "+definiton)}})}for(controllerDirectives&&forEach(controllerDirectives,function(directive){var locals={$scope:scope,$element:$element,$attrs:attrs,$transclude:boundTranscludeFn};controller=directive.controller,"@"==controller&&(controller=attrs[directive.name]),$element.data("$"+directive.name+"Controller",$controller(controller,locals))}),i=0,ii=preLinkFns.length;ii>i;i++)try{linkFn=preLinkFns[i],linkFn(scope,$element,attrs,linkFn.require&&getControllers(linkFn.require,$element))}catch(e){$exceptionHandler(e,startingTag($element))}for(childLinkFn&&childLinkFn(scope,linkNode.childNodes,undefined,boundTranscludeFn),i=0,ii=postLinkFns.length;ii>i;i++)try{linkFn=postLinkFns[i],linkFn(scope,$element,attrs,linkFn.require&&getControllers(linkFn.require,$element))}catch(e){$exceptionHandler(e,startingTag($element))}}for(var directive,directiveName,$template,transcludeDirective,controllerDirectives,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,preLinkFns=[],postLinkFns=[],newScopeDirective=null,newIsolateScopeDirective=null,templateDirective=null,$compileNode=templateAttrs.$$element=jqLite(compileNode),childTranscludeFn=transcludeFn,i=0,ii=directives.length;ii>i&&(directive=directives[i],$template=undefined,!(terminalPriority>directive.priority));i++){if((directiveValue=directive.scope)&&(assertNoDuplicate("isolated scope",newIsolateScopeDirective,directive,$compileNode),isObject(directiveValue)&&(safeAddClass($compileNode,"ng-isolate-scope"),newIsolateScopeDirective=directive),safeAddClass($compileNode,"ng-scope"),newScopeDirective=newScopeDirective||directive),directiveName=directive.name,(directiveValue=directive.controller)&&(controllerDirectives=controllerDirectives||{},assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),(directiveValue=directive.transclude)&&(assertNoDuplicate("transclusion",transcludeDirective,directive,$compileNode),transcludeDirective=directive,terminalPriority=directive.priority,"element"==directiveValue?($template=jqLite(compileNode),$compileNode=templateAttrs.$$element=jqLite(document.createComment(" "+directiveName+": "+templateAttrs[directiveName]+" ")),compileNode=$compileNode[0],replaceWith(jqCollection,jqLite($template[0]),compileNode),childTranscludeFn=compile($template,transcludeFn,terminalPriority)):($template=jqLite(JQLiteClone(compileNode)).contents(),$compileNode.html(""),childTranscludeFn=compile($template,transcludeFn))),directiveValue=directive.template)if(assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if($template=jqLite("<div>"+trim(directiveValue)+"</div>").contents(),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw new Error(MULTI_ROOT_TEMPLATE_ERROR+directiveValue);replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}};directives=directives.concat(collectDirectives(compileNode,directives.splice(i+1,directives.length-(i+1)),newTemplateAttrs)),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),nodeLinkFn,$compileNode,templateAttrs,jqCollection,directive.replace,childTranscludeFn),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn),isFunction(linkFn)?addLinkFns(null,linkFn):linkFn&&addLinkFns(linkFn.pre,linkFn.post)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&newScopeDirective.scope,nodeLinkFn.transclude=transcludeDirective&&childTranscludeFn,nodeLinkFn}function addDirective(tDirectives,name,location,maxPriority){var match=!1;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;ii>i;i++)try{directive=directives[i],(maxPriority===undefined||maxPriority>directive.priority)&&-1!=directive.restrict.indexOf(location)&&(tDirectives.push(directive),match=!0)}catch(e){$exceptionHandler(e)}return match}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr,$element=dst.$$element;forEach(dst,function(value,key){"$"!=key.charAt(0)&&(src[key]&&(value+=("style"===key?";":" ")+src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){"class"==key?(safeAddClass($element,value),dst["class"]=(dst["class"]?dst["class"]+" ":"")+value):"style"==key?$element.attr("style",$element.attr("style")+";"+value):"$"==key.charAt(0)||dst.hasOwnProperty(key)||(dst[key]=value,dstAttr[key]=srcAttr[key])})}function compileTemplateUrl(directives,beforeTemplateNodeLinkFn,$compileNode,tAttrs,$rootElement,replace,childTranscludeFn){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=extend({},origAsyncDirective,{controller:null,templateUrl:null,transclude:null,scope:null});return $compileNode.html(""),$http.get(origAsyncDirective.templateUrl,{cache:$templateCache}).success(function(content){var compileNode,tempTemplateAttrs,$template;if(content=denormalizeTemplate(content),replace){if($template=jqLite("<div>"+trim(content)+"</div>").contents(),compileNode=$template[0],1!=$template.length||1!==compileNode.nodeType)throw new Error(MULTI_ROOT_TEMPLATE_ERROR+content);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode),collectDirectives(compileNode,directives,tempTemplateAttrs),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var controller=linkQueue.pop(),linkRootElement=linkQueue.pop(),beforeTemplateLinkNode=linkQueue.pop(),scope=linkQueue.pop(),linkNode=compileNode;beforeTemplateLinkNode!==beforeTemplateCompileNode&&(linkNode=JQLiteClone(compileNode),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode)),afterTemplateNodeLinkFn(function(){beforeTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,controller)},scope,linkNode,$rootElement,controller)}linkQueue=null}).error(function(response,code,headers,config){throw Error("Failed to load template: "+config.url)}),function(ignoreChildLinkFn,scope,node,rootElement,controller){linkQueue?(linkQueue.push(scope),linkQueue.push(node),linkQueue.push(rootElement),linkQueue.push(controller)):afterTemplateNodeLinkFn(function(){beforeTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,controller)},scope,node,rootElement,controller)}}function byPriority(a,b){return b.priority-a.priority}function assertNoDuplicate(what,previousDirective,directive,element){if(previousDirective)throw Error("Multiple directives ["+previousDirective.name+", "+directive.name+"] asking for "+what+" on: "+startingTag(element))}function addTextInterpolateDirective(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:valueFn(function(scope,node){var parent=node.parent(),bindings=parent.data("$binding")||[];bindings.push(interpolateFn),safeAddClass(parent.data("$binding",bindings),"ng-binding"),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})})})}function addAttrInterpolateDirective(node,directives,value,name){var interpolateFn=$interpolate(value,!0);interpolateFn&&directives.push({priority:100,compile:valueFn(function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers={});"class"===name&&(interpolateFn=$interpolate(attr[name],!0)),attr[name]=undefined,($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(value){attr.$set(name,value)})})})}function replaceWith($rootElement,$element,newNode){var i,ii,oldNode=$element[0],parent=oldNode.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;ii>i;i++)if($rootElement[i]==oldNode){$rootElement[i]=newNode;break}parent&&parent.replaceChild(newNode,oldNode),newNode[jqLite.expando]=oldNode[jqLite.expando],$element[0]=newNode}var Attributes=function(element,attr){this.$$element=element,this.$attr=attr||{}};Attributes.prototype={$normalize:directiveNormalize,$set:function(key,value,writeAttr,attrName){var normalizedVal,booleanKey=getBooleanAttrName(this.$$element[0],key),$$observers=this.$$observers;booleanKey&&(this.$$element.prop(key,value),attrName=booleanKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key],attrName||(this.$attr[key]=attrName=snake_case(key,"-"))),"A"===nodeName_(this.$$element[0])&&"href"===key&&(urlSanitizationNode.setAttribute("href",value),normalizedVal=urlSanitizationNode.href,normalizedVal.match(urlSanitizationWhitelist)||(this[key]=value="unsafe:"+normalizedVal)),writeAttr!==!1&&(null===value||value===undefined?this.$$element.removeAttr(attrName):this.$$element.attr(attrName,value)),$$observers&&forEach($$observers[key],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers={}),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||fn(attrs[key])}),fn}};var urlSanitizationNode=$document[0].createElement("a"),startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"==startSymbol||"}}"==endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)};return compile}]}function directiveNormalize(name){return camelCase(name.replace(PREFIX_REGEXP,""))}function $ControllerProvider(){var controllers={};this.register=function(name,constructor){isObject(name)?extend(controllers,name):controllers[name]=constructor},this.$get=["$injector","$window",function($injector,$window){return function(constructor,locals){if(isString(constructor)){var name=constructor;constructor=controllers.hasOwnProperty(name)?controllers[name]:getter(locals.$scope,name,!0)||getter($window,name,!0),assertArgFn(constructor,name,!0)}return $injector.instantiate(constructor,locals)}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(){$log.error.apply($log,arguments)}}]}function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse",function($parse){function $interpolate(text,mustHaveExpression){for(var startIndex,endIndex,fn,exp,index=0,parts=[],length=text.length,hasInterpolation=!1,concat=[];length>index;)-1!=(startIndex=text.indexOf(startSymbol,index))&&-1!=(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))?(index!=startIndex&&parts.push(text.substring(index,startIndex)),parts.push(fn=$parse(exp=text.substring(startIndex+startSymbolLength,endIndex))),fn.exp=exp,index=endIndex+endSymbolLength,hasInterpolation=!0):(index!=length&&parts.push(text.substring(index)),index=length);return(length=parts.length)||(parts.push(""),length=1),!mustHaveExpression||hasInterpolation?(concat.length=length,fn=function(context){for(var part,i=0,ii=length;ii>i;i++)"function"==typeof(part=parts[i])&&(part=part(context),null==part||part==undefined?part="":"string"!=typeof part&&(part=toJson(part))),concat[i]=part;return concat.join("")},fn.exp=text,fn.parts=parts,fn):void 0}var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length;return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}function encodePath(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i]);return segments.join("/")}function matchUrl(url,obj){var match=URL_MATCH.exec(url);return match={protocol:match[1],host:match[3],port:int(match[5])||DEFAULT_PORTS[match[1]]||null,path:match[6]||"/",search:match[8],hash:match[10]},obj&&(obj.$$protocol=match.protocol,obj.$$host=match.host,obj.$$port=match.port),match}function composeProtocolHostPort(protocol,host,port){return protocol+"://"+host+(port==DEFAULT_PORTS[protocol]?"":":"+port)}function pathPrefixFromBase(basePath){return basePath.substr(0,basePath.lastIndexOf("/"))}function convertToHtml5Url(url,basePath,hashPrefix){var match=matchUrl(url);return decodeURIComponent(match.path)!=basePath||isUndefined(match.hash)||0!==match.hash.indexOf(hashPrefix)?url:composeProtocolHostPort(match.protocol,match.host,match.port)+pathPrefixFromBase(basePath)+match.hash.substr(hashPrefix.length)}function convertToHashbangUrl(url,basePath,hashPrefix){var match=matchUrl(url);if(decodeURIComponent(match.path)!=basePath||isUndefined(match.hash)||0!==match.hash.indexOf(hashPrefix)){var search=match.search&&"?"+match.search||"",hash=match.hash&&"#"+match.hash||"",pathPrefix=pathPrefixFromBase(basePath),path=match.path.substr(pathPrefix.length);if(0!==match.path.indexOf(pathPrefix))throw Error('Invalid url "'+url+'", missing path prefix "'+pathPrefix+'" !');return composeProtocolHostPort(match.protocol,match.host,match.port)+basePath+"#"+hashPrefix+path+search+hash}return url}function LocationUrl(url,pathPrefix,appBaseUrl){pathPrefix=pathPrefix||"",this.$$parse=function(newAbsoluteUrl){var match=matchUrl(newAbsoluteUrl,this);if(0!==match.path.indexOf(pathPrefix))throw Error('Invalid url "'+newAbsoluteUrl+'", missing path prefix "'+pathPrefix+'" !');this.$$path=decodeURIComponent(match.path.substr(pathPrefix.length)),this.$$search=parseKeyValue(match.search),this.$$hash=match.hash&&decodeURIComponent(match.hash)||"",this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=composeProtocolHostPort(this.$$protocol,this.$$host,this.$$port)+pathPrefix+this.$$url},this.$$rewriteAppUrl=function(absoluteLinkUrl){return 0==absoluteLinkUrl.indexOf(appBaseUrl)?absoluteLinkUrl:void 0},this.$$parse(url)}function LocationHashbangUrl(url,hashPrefix,appBaseUrl){var basePath;this.$$parse=function(url){var match=matchUrl(url,this);if(match.hash&&0!==match.hash.indexOf(hashPrefix))throw Error('Invalid url "'+url+'", missing hash prefix "'+hashPrefix+'" !');basePath=match.path+(match.search?"?"+match.search:""),match=HASH_MATCH.exec((match.hash||"").substr(hashPrefix.length)),this.$$path=match[1]?("/"==match[1].charAt(0)?"":"/")+decodeURIComponent(match[1]):"",this.$$search=parseKeyValue(match[3]),this.$$hash=match[5]&&decodeURIComponent(match[5])||"",this.$$compose()},this.$$compose=function(){var search=toKeyValue(this.$$search),hash=this.$$hash?"#"+encodeUriSegment(this.$$hash):"";this.$$url=encodePath(this.$$path)+(search?"?"+search:"")+hash,this.$$absUrl=composeProtocolHostPort(this.$$protocol,this.$$host,this.$$port)+basePath+(this.$$url?"#"+hashPrefix+this.$$url:"")},this.$$rewriteAppUrl=function(absoluteLinkUrl){return 0==absoluteLinkUrl.indexOf(appBaseUrl)?absoluteLinkUrl:void 0},this.$$parse(url)}function LocationHashbangInHtml5Url(url,hashPrefix,appBaseUrl,baseExtra){LocationHashbangUrl.apply(this,arguments),this.$$rewriteAppUrl=function(absoluteLinkUrl){return 0==absoluteLinkUrl.indexOf(appBaseUrl)?appBaseUrl+baseExtra+"#"+hashPrefix+absoluteLinkUrl.substr(appBaseUrl.length):void 0}}function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="",html5Mode=!1;this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isDefined(mode)?(html5Mode=mode,this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement",function($rootScope,$browser,$sniffer,$rootElement){function afterLocationChange(oldUrl){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl)}var $location,basePath,pathPrefix,appBaseUrl,initUrl=$browser.url(),initUrlParts=matchUrl(initUrl);html5Mode?(basePath=$browser.baseHref()||"/",pathPrefix=pathPrefixFromBase(basePath),appBaseUrl=composeProtocolHostPort(initUrlParts.protocol,initUrlParts.host,initUrlParts.port)+pathPrefix+"/",$location=$sniffer.history?new LocationUrl(convertToHtml5Url(initUrl,basePath,hashPrefix),pathPrefix,appBaseUrl):new LocationHashbangInHtml5Url(convertToHashbangUrl(initUrl,basePath,hashPrefix),hashPrefix,appBaseUrl,basePath.substr(pathPrefix.length+1))):(appBaseUrl=composeProtocolHostPort(initUrlParts.protocol,initUrlParts.host,initUrlParts.port)+(initUrlParts.path||"")+(initUrlParts.search?"?"+initUrlParts.search:"")+"#"+hashPrefix+"/",$location=new LocationHashbangUrl(initUrl,hashPrefix,appBaseUrl)),$rootElement.bind("click",function(event){if(!event.ctrlKey&&!event.metaKey&&2!=event.which){for(var elm=jqLite(event.target);"a"!==lowercase(elm[0].nodeName);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;var absHref=elm.prop("href"),rewrittenUrl=$location.$$rewriteAppUrl(absHref);absHref&&!elm.attr("target")&&rewrittenUrl&&($location.$$parse(rewrittenUrl),$rootScope.$apply(),event.preventDefault(),window.angular["ff-684208-preventDefault"]=!0)}}),$location.absUrl()!=initUrl&&$browser.url($location.absUrl(),!0),$browser.onUrlChange(function(newUrl){if($location.absUrl()!=newUrl){if($rootScope.$broadcast("$locationChangeStart",newUrl,$location.absUrl()).defaultPrevented)return $browser.url($location.absUrl()),void 0;$rootScope.$evalAsync(function(){var oldUrl=$location.absUrl();$location.$$parse(newUrl),afterLocationChange(oldUrl)}),$rootScope.$$phase||$rootScope.$digest()}});var changeCounter=0;return $rootScope.$watch(function(){var oldUrl=$browser.url(),currentReplace=$location.$$replace;return changeCounter&&oldUrl==$location.absUrl()||(changeCounter++,$rootScope.$evalAsync(function(){$rootScope.$broadcast("$locationChangeStart",$location.absUrl(),oldUrl).defaultPrevented?$location.$$parse(oldUrl):($browser.url($location.absUrl(),currentReplace),afterLocationChange(oldUrl))})),$location.$$replace=!1,changeCounter}),$location}]}function $LogProvider(){this.$get=["$window",function($window){function formatError(arg){return arg instanceof Error&&(arg.stack?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop;return logFn.apply?function(){var args=[];return forEach(arguments,function(arg){args.push(formatError(arg))}),logFn.apply(console,args)}:function(arg1,arg2){logFn(arg1,arg2)}}return{log:consoleLog("log"),warn:consoleLog("warn"),info:consoleLog("info"),error:consoleLog("error")}}]}function lex(text,csp){function is(chars){return-1!=chars.indexOf(ch)}function was(chars){return-1!=chars.indexOf(lastCh)}function peek(){return index+1<text.length?text.charAt(index+1):!1}function isNumber(ch){return ch>="0"&&"9">=ch}function isWhitespace(ch){return" "==ch||"\r"==ch||"	"==ch||"\n"==ch||""==ch||" "==ch}function isIdent(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||"_"==ch||"$"==ch}function isExpOperator(ch){return"-"==ch||"+"==ch||isNumber(ch)}function throwError(error,start,end){throw end=end||index,Error("Lexer Error: "+error+" at column"+(isDefined(start)?"s "+start+"-"+index+" ["+text.substring(start,end)+"]":" "+end)+" in expression ["+text+"].")}function readNumber(){for(var number="",start=index;index<text.length;){var ch=lowercase(text.charAt(index));if("."==ch||isNumber(ch))number+=ch;else{var peekCh=peek();if("e"==ch&&isExpOperator(peekCh))number+=ch;else if(isExpOperator(ch)&&peekCh&&isNumber(peekCh)&&"e"==number.charAt(number.length-1))number+=ch;else{if(!isExpOperator(ch)||peekCh&&isNumber(peekCh)||"e"!=number.charAt(number.length-1))break;throwError("Invalid exponent")}}index++}number=1*number,tokens.push({index:start,text:number,json:!0,fn:function(){return number}})}function readIdent(){for(var lastDot,peekIndex,methodName,ch,ident="",start=index;index<text.length&&(ch=text.charAt(index),"."==ch||isIdent(ch)||isNumber(ch));)"."==ch&&(lastDot=index),ident+=ch,index++;if(lastDot)for(peekIndex=index;peekIndex<text.length;){if(ch=text.charAt(peekIndex),"("==ch){methodName=ident.substr(lastDot-start+1),ident=ident.substr(0,lastDot-start),index=peekIndex;break}if(!isWhitespace(ch))break;peekIndex++}var token={index:start,text:ident};if(OPERATORS.hasOwnProperty(ident))token.fn=token.json=OPERATORS[ident];else{var getter=getterFn(ident,csp);token.fn=extend(function(self,locals){return getter(self,locals)},{assign:function(self,value){return setter(self,ident,value)}})}tokens.push(token),methodName&&(tokens.push({index:lastDot,text:".",json:!1}),tokens.push({index:lastDot+1,text:methodName,json:!1}))}function readString(quote){var start=index;index++;for(var string="",rawString=quote,escape=!1;index<text.length;){var ch=text.charAt(index);if(rawString+=ch,escape){if("u"==ch){var hex=text.substring(index+1,index+5);hex.match(/[\da-f]{4}/i)||throwError("Invalid unicode escape [\\u"+hex+"]"),index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{var rep=ESCAPE[ch];string+=rep?rep:ch}escape=!1}else if("\\"==ch)escape=!0;else{if(ch==quote)return index++,tokens.push({index:start,text:rawString,string:string,json:!0,fn:function(){return string}}),void 0;string+=ch}index++}throwError("Unterminated quote",start)}for(var token,ch,tokens=[],index=0,json=[],lastCh=":";index<text.length;){if(ch=text.charAt(index),is("\"'"))readString(ch);else if(isNumber(ch)||is(".")&&isNumber(peek()))readNumber();else if(isIdent(ch))readIdent(),was("{,")&&"{"==json[0]&&(token=tokens[tokens.length-1])&&(token.json=-1==token.text.indexOf("."));else if(is("(){}[].,;:"))tokens.push({index:index,text:ch,json:was(":[,")&&is("{[")||is("}]:,")}),is("{[")&&json.unshift(ch),is("}]")&&json.shift(),index++;else{if(isWhitespace(ch)){index++;continue}var ch2=ch+peek(),fn=OPERATORS[ch],fn2=OPERATORS[ch2];fn2?(tokens.push({index:index,text:ch2,fn:fn2}),index+=2):fn?(tokens.push({index:index,text:ch,fn:fn,json:was("[,:")&&is("+-")}),index+=1):throwError("Unexpected next character ",index,index+1)}lastCh=ch}return tokens}function parser(text,json,$filter,csp){function throwError(msg,token){throw Error("Syntax Error: Token '"+token.text+"' "+msg+" at column "+(token.index+1)+" of the expression ["+text+"] starting at ["+text.substring(token.index)+"].")}function peekToken(){if(0===tokens.length)throw Error("Unexpected end of expression: "+text);return tokens[0]}function peek(e1,e2,e3,e4){if(tokens.length>0){var token=tokens[0],t=token.text;if(t==e1||t==e2||t==e3||t==e4||!e1&&!e2&&!e3&&!e4)return token}return!1}function expect(e1,e2,e3,e4){var token=peek(e1,e2,e3,e4);return token?(json&&!token.json&&throwError("is not valid json",token),tokens.shift(),token):!1}function consume(e1){expect(e1)||throwError("is unexpected, expecting ["+e1+"]",peek())}function unaryFn(fn,right){return function(self,locals){return fn(self,locals,right)}}function binaryFn(left,fn,right){return function(self,locals){return fn(self,locals,left,right)}}function statements(){for(var statements=[];;)if(tokens.length>0&&!peek("}",")",";","]")&&statements.push(filterChain()),!expect(";"))return 1==statements.length?statements[0]:function(self,locals){for(var value,i=0;i<statements.length;i++){var statement=statements[i];statement&&(value=statement(self,locals))}return value}}function _filterChain(){for(var token,left=expression();;){if(!(token=expect("|")))return left;
left=binaryFn(left,token.fn,filter())}}function filter(){for(var token=expect(),fn=$filter(token.text),argsFn=[];;){if(!(token=expect(":"))){var fnInvoke=function(self,locals,input){for(var args=[input],i=0;i<argsFn.length;i++)args.push(argsFn[i](self,locals));return fn.apply(self,args)};return function(){return fnInvoke}}argsFn.push(expression())}}function expression(){return assignment()}function _assignment(){var right,token,left=logicalOR();return(token=expect("="))?(left.assign||throwError("implies assignment but ["+text.substring(0,token.index)+"] can not be assigned to",token),right=logicalOR(),function(scope,locals){return left.assign(scope,right(scope,locals),locals)}):left}function logicalOR(){for(var token,left=logicalAND();;){if(!(token=expect("||")))return left;left=binaryFn(left,token.fn,logicalAND())}}function logicalAND(){var token,left=equality();return(token=expect("&&"))&&(left=binaryFn(left,token.fn,logicalAND())),left}function equality(){var token,left=relational();return(token=expect("==","!="))&&(left=binaryFn(left,token.fn,equality())),left}function relational(){var token,left=additive();return(token=expect("<",">","<=",">="))&&(left=binaryFn(left,token.fn,relational())),left}function additive(){for(var token,left=multiplicative();token=expect("+","-");)left=binaryFn(left,token.fn,multiplicative());return left}function multiplicative(){for(var token,left=unary();token=expect("*","/","%");)left=binaryFn(left,token.fn,unary());return left}function unary(){var token;return expect("+")?primary():(token=expect("-"))?binaryFn(ZERO,token.fn,unary()):(token=expect("!"))?unaryFn(token.fn,unary()):primary()}function primary(){var primary;if(expect("("))primary=filterChain(),consume(")");else if(expect("["))primary=arrayDeclaration();else if(expect("{"))primary=object();else{var token=expect();primary=token.fn,primary||throwError("not a primary expression",token)}for(var next,context;next=expect("(","[",".");)"("===next.text?(primary=functionCall(primary,context),context=null):"["===next.text?(context=primary,primary=objectIndex(primary)):"."===next.text?(context=primary,primary=fieldAccess(primary)):throwError("IMPOSSIBLE");return primary}function _fieldAccess(object){var field=expect().text,getter=getterFn(field,csp);return extend(function(scope,locals,self){return getter(self||object(scope,locals),locals)},{assign:function(scope,value,locals){return setter(object(scope,locals),field,value)}})}function _objectIndex(obj){var indexFn=expression();return consume("]"),extend(function(self,locals){var v,p,o=obj(self,locals),i=indexFn(self,locals);return o?(v=o[i],v&&v.then&&(p=v,"$$v"in v||(p.$$v=undefined,p.then(function(val){p.$$v=val})),v=v.$$v),v):undefined},{assign:function(self,value,locals){return obj(self,locals)[indexFn(self,locals)]=value}})}function _functionCall(fn,contextGetter){var argsFn=[];if(")"!=peekToken().text)do argsFn.push(expression());while(expect(","));return consume(")"),function(scope,locals){for(var args=[],context=contextGetter?contextGetter(scope,locals):scope,i=0;i<argsFn.length;i++)args.push(argsFn[i](scope,locals));var fnPtr=fn(scope,locals,context)||noop;return fnPtr.apply?fnPtr.apply(context,args):fnPtr(args[0],args[1],args[2],args[3],args[4])}}function arrayDeclaration(){var elementFns=[];if("]"!=peekToken().text)do elementFns.push(expression());while(expect(","));return consume("]"),function(self,locals){for(var array=[],i=0;i<elementFns.length;i++)array.push(elementFns[i](self,locals));return array}}function object(){var keyValues=[];if("}"!=peekToken().text)do{var token=expect(),key=token.string||token.text;consume(":");var value=expression();keyValues.push({key:key,value:value})}while(expect(","));return consume("}"),function(self,locals){for(var object={},i=0;i<keyValues.length;i++){var keyValue=keyValues[i];object[keyValue.key]=keyValue.value(self,locals)}return object}}var value,ZERO=valueFn(0),tokens=lex(text,csp),assignment=_assignment,functionCall=_functionCall,fieldAccess=_fieldAccess,objectIndex=_objectIndex,filterChain=_filterChain;return json?(assignment=logicalOR,functionCall=fieldAccess=objectIndex=filterChain=function(){throwError("is not valid json",{text:text,index:0})},value=primary()):value=statements(),0!==tokens.length&&throwError("is an unexpected token",tokens[0]),value}function setter(obj,path,setValue){for(var element=path.split("."),i=0;element.length>1;i++){var key=element.shift(),propertyObj=obj[key];propertyObj||(propertyObj={},obj[key]=propertyObj),obj=propertyObj}return obj[element.shift()]=setValue,setValue}function getter(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;len>i;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}function cspSafeGetterFn(key0,key1,key2,key3,key4){return function(scope,locals){var promise,pathVal=locals&&locals.hasOwnProperty(key0)?locals:scope;return null===pathVal||pathVal===undefined?pathVal:(pathVal=pathVal[key0],pathVal&&pathVal.then&&("$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key1&&null!==pathVal&&pathVal!==undefined?(pathVal=pathVal[key1],pathVal&&pathVal.then&&("$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key2&&null!==pathVal&&pathVal!==undefined?(pathVal=pathVal[key2],pathVal&&pathVal.then&&("$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key3&&null!==pathVal&&pathVal!==undefined?(pathVal=pathVal[key3],pathVal&&pathVal.then&&("$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),key4&&null!==pathVal&&pathVal!==undefined?(pathVal=pathVal[key4],pathVal&&pathVal.then&&("$$v"in pathVal||(promise=pathVal,promise.$$v=undefined,promise.then(function(val){promise.$$v=val})),pathVal=pathVal.$$v),pathVal):pathVal):pathVal):pathVal):pathVal)}}function getterFn(path,csp){if(getterFnCache.hasOwnProperty(path))return getterFnCache[path];var fn,pathKeys=path.split("."),pathKeysLength=pathKeys.length;if(csp)fn=6>pathKeysLength?cspSafeGetterFn(pathKeys[0],pathKeys[1],pathKeys[2],pathKeys[3],pathKeys[4]):function(scope,locals){var val,i=0;do val=cspSafeGetterFn(pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++],pathKeys[i++])(scope,locals),locals=undefined,scope=val;while(pathKeysLength>i);return val};else{var code="var l, fn, p;\n";forEach(pathKeys,function(key,index){code+="if(s === null || s === undefined) return s;\nl=s;\ns="+(index?"s":'((k&&k.hasOwnProperty("'+key+'"))?k:s)')+'["'+key+'"]'+";\n"+"if (s && s.then) {\n"+' if (!("$$v" in s)) {\n'+" p=s;\n"+" p.$$v = undefined;\n"+" p.then(function(v) {p.$$v=v;});\n"+"}\n"+" s=s.$$v\n"+"}\n"}),code+="return s;",fn=Function("s","k",code),fn.toString=function(){return code}}return getterFnCache[path]=fn}function $ParseProvider(){var cache={};this.$get=["$filter","$sniffer",function($filter,$sniffer){return function(exp){switch(typeof exp){case"string":return cache.hasOwnProperty(exp)?cache[exp]:cache[exp]=parser(exp,!1,$filter,$sniffer.csp);case"function":return exp;default:return noop}}}]}function $QProvider(){this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler)}]}function qFactory(nextTick,exceptionHandler){function defaultCallback(value){return value}function defaultErrback(reason){return reject(reason)}function all(promises){var deferred=defer(),counter=promises.length,results=[];return counter?forEach(promises,function(promise,index){ref(promise).then(function(value){index in results||(results[index]=value,--counter||deferred.resolve(results))},function(reason){index in results||deferred.reject(reason)})}):deferred.resolve(results),deferred.promise}var defer=function(){var value,deferred,pending=[];return deferred={resolve:function(val){if(pending){var callbacks=pending;pending=undefined,value=ref(val),callbacks.length&&nextTick(function(){for(var callback,i=0,ii=callbacks.length;ii>i;i++)callback=callbacks[i],value.then(callback[0],callback[1])})}},reject:function(reason){deferred.resolve(reject(reason))},promise:{then:function(callback,errback){var result=defer(),wrappedCallback=function(value){try{result.resolve((callback||defaultCallback)(value))}catch(e){exceptionHandler(e),result.reject(e)}},wrappedErrback=function(reason){try{result.resolve((errback||defaultErrback)(reason))}catch(e){exceptionHandler(e),result.reject(e)}};return pending?pending.push([wrappedCallback,wrappedErrback]):value.then(wrappedCallback,wrappedErrback),result.promise}}}},ref=function(value){return value&&value.then?value:{then:function(callback){var result=defer();return nextTick(function(){result.resolve(callback(value))}),result.promise}}},reject=function(reason){return{then:function(callback,errback){var result=defer();return nextTick(function(){result.resolve((errback||defaultErrback)(reason))}),result.promise}}},when=function(value,callback,errback){var done,result=defer(),wrappedCallback=function(value){try{return(callback||defaultCallback)(value)}catch(e){return exceptionHandler(e),reject(e)}},wrappedErrback=function(reason){try{return(errback||defaultErrback)(reason)}catch(e){return exceptionHandler(e),reject(e)}};return nextTick(function(){ref(value).then(function(value){done||(done=!0,result.resolve(ref(value).then(wrappedCallback,wrappedErrback)))},function(reason){done||(done=!0,result.resolve(wrappedErrback(reason)))})}),result.promise};return{defer:defer,reject:reject,when:when,all:all}}function $RouteProvider(){var routes={};this.when=function(path,route){if(routes[path]=extend({reloadOnSearch:!0},route),path){var redirectPath="/"==path[path.length-1]?path.substr(0,path.length-1):path+"/";routes[redirectPath]={redirectTo:path}}return this},this.otherwise=function(params){return this.when(null,params),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$http","$templateCache",function($rootScope,$location,$routeParams,$q,$injector,$http,$templateCache){function switchRouteMatcher(on,when){when="^"+when.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"$";for(var paramMatch,regex="",params=[],dst={},re=/:(\w+)/g,lastMatchedIndex=0;null!==(paramMatch=re.exec(when));)regex+=when.slice(lastMatchedIndex,paramMatch.index),regex+="([^\\/]*)",params.push(paramMatch[1]),lastMatchedIndex=re.lastIndex;regex+=when.substr(lastMatchedIndex);var match=on.match(new RegExp(regex));return match&&forEach(params,function(name,index){dst[name]=match[index+1]}),match?dst:null}function updateRoute(){var next=parseRoute(),last=$route.current;next&&last&&next.$$route===last.$$route&&equals(next.pathParams,last.pathParams)&&!next.reloadOnSearch&&!forceReload?(last.params=next.params,copy(last.params,$routeParams),$rootScope.$broadcast("$routeUpdate",last)):(next||last)&&(forceReload=!1,$rootScope.$broadcast("$routeChangeStart",next,last),$route.current=next,next&&next.redirectTo&&(isString(next.redirectTo)?$location.path(interpolate(next.redirectTo,next.params)).search(next.params).replace():$location.url(next.redirectTo(next.pathParams,$location.path(),$location.search())).replace()),$q.when(next).then(function(){if(next){var template,keys=[],values=[];return forEach(next.resolve||{},function(value,key){keys.push(key),values.push(isString(value)?$injector.get(value):$injector.invoke(value))}),isDefined(template=next.template)||isDefined(template=next.templateUrl)&&(template=$http.get(template,{cache:$templateCache}).then(function(response){return response.data})),isDefined(template)&&(keys.push("$template"),values.push(template)),$q.all(values).then(function(values){var locals={};return forEach(values,function(value,index){locals[keys[index]]=value}),locals})}}).then(function(locals){next==$route.current&&(next&&(next.locals=locals,copy(next.params,$routeParams)),$rootScope.$broadcast("$routeChangeSuccess",next,last))},function(error){next==$route.current&&$rootScope.$broadcast("$routeChangeError",next,last,error)}))}function parseRoute(){var params,match;return forEach(routes,function(route,path){!match&&(params=switchRouteMatcher($location.path(),path))&&(match=inherit(route,{params:extend({},$location.search(),params),pathParams:params}),match.$$route=route)}),match||routes[null]&&inherit(routes[null],{params:{},pathParams:{}})}function interpolate(string,params){var result=[];return forEach((string||"").split(":"),function(segment,i){if(0==i)result.push(segment);else{var segmentMatch=segment.match(/(\w+)(.*)/),key=segmentMatch[1];result.push(params[key]),result.push(segmentMatch[2]||""),delete params[key]}}),result.join("")}var forceReload=!1,$route={routes:routes,reload:function(){forceReload=!0,$rootScope.$evalAsync(updateRoute)}};return $rootScope.$on("$locationChangeSuccess",updateRoute),$route}]}function $RouteParamsProvider(){this.$get=valueFn({})}function $RootScopeProvider(){var TTL=10;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$injector","$exceptionHandler","$parse",function($injector,$exceptionHandler,$parse){function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this["this"]=this.$root=this,this.$$destroyed=!1,this.$$asyncQueue=[],this.$$listeners={},this.$$isolateBindings={}}function beginPhase(phase){if($rootScope.$$phase)throw Error($rootScope.$$phase+" already in progress");$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function compileToFn(exp,name){var fn=$parse(exp);return assertArgFn(fn,name),fn}function initWatchVal(){}Scope.prototype={$new:function(isolate){var Child,child;if(isFunction(isolate))throw Error("API-CHANGE: Use $controller to instantiate controllers.");return isolate?(child=new Scope,child.$root=this.$root):(Child=function(){},Child.prototype=this,child=new Child,child.$id=nextUid()),child["this"]=child,child.$$listeners={},child.$parent=this,child.$$asyncQueue=[],child.$$watchers=child.$$nextSibling=child.$$childHead=child.$$childTail=null,child.$$prevSibling=this.$$childTail,this.$$childHead?(this.$$childTail.$$nextSibling=child,this.$$childTail=child):this.$$childHead=this.$$childTail=child,child},$watch:function(watchExp,listener,objectEquality){var scope=this,get=compileToFn(watchExp,"watch"),array=scope.$$watchers,watcher={fn:listener,last:initWatchVal,get:get,exp:watchExp,eq:!!objectEquality};if(!isFunction(listener)){var listenFn=compileToFn(listener||noop,"listener");watcher.fn=function(newVal,oldVal,scope){listenFn(scope)}}return array||(array=scope.$$watchers=[]),array.unshift(watcher),function(){arrayRemove(array,watcher)}},$digest:function(){var watch,value,last,watchers,asyncQueue,length,dirty,next,current,logIdx,logMsg,ttl=TTL,target=this,watchLog=[];beginPhase("$digest");do{dirty=!1,current=target;do{for(asyncQueue=current.$$asyncQueue;asyncQueue.length;)try{current.$eval(asyncQueue.shift())}catch(e){$exceptionHandler(e)}if(watchers=current.$$watchers)for(length=watchers.length;length--;)try{watch=watchers[length],(value=watch.get(current))===(last=watch.last)||(watch.eq?equals(value,last):"number"==typeof value&&"number"==typeof last&&isNaN(value)&&isNaN(last))||(dirty=!0,watch.last=watch.eq?copy(value):value,watch.fn(value,last===initWatchVal?value:last,current),5>ttl&&(logIdx=4-ttl,watchLog[logIdx]||(watchLog[logIdx]=[]),logMsg=isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,logMsg+="; newVal: "+toJson(value)+"; oldVal: "+toJson(last),watchLog[logIdx].push(logMsg)))}catch(e){$exceptionHandler(e)}if(!(next=current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if(dirty&&!ttl--)throw clearPhase(),Error(TTL+" $digest() iterations reached. Aborting!\n"+"Watchers fired in the last 5 iterations: "+toJson(watchLog))}while(dirty||asyncQueue.length);clearPhase()},$destroy:function(){if($rootScope!=this&&!this.$$destroyed){var parent=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,parent.$$childHead==this&&(parent.$$childHead=this.$$nextSibling),parent.$$childTail==this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr){this.$$asyncQueue.push(expr)},$apply:function(expr){try{return beginPhase("$apply"),this.$eval(expr)}catch(e){$exceptionHandler(e)}finally{clearPhase();try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$on:function(name,listener){var namedListeners=this.$$listeners[name];return namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener),function(){namedListeners[indexOf(namedListeners,listener)]=null}},$emit:function(name){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;length>i;i++)if(namedListeners[i])try{if(namedListeners[i].apply(null,listenerArgs),stopPropagation)return event}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;scope=scope.$parent}while(scope);return event},$broadcast:function(name){var listeners,i,length,target=this,current=target,next=target,event={name:name,targetScope:target,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(current=next,event.currentScope=current,listeners=current.$$listeners[name]||[],i=0,length=listeners.length;length>i;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);return event}};var $rootScope=new Scope;return $rootScope}]}function $SnifferProvider(){this.$get=["$window",function($window){var eventSupport={},android=int((/android (\d+)/.exec(lowercase($window.navigator.userAgent))||[])[1]);return{history:!(!$window.history||!$window.history.pushState||4>android),hashchange:"onhashchange"in $window&&(!$window.document.documentMode||$window.document.documentMode>7),hasEvent:function(event){if("input"==event&&9==msie)return!1;if(isUndefined(eventSupport[event])){var divElm=$window.document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:!1}}]}function $WindowProvider(){this.$get=valueFn(window)}function parseHeaders(headers){var key,val,i,parsed={};return headers?(forEach(headers.split("\n"),function(line){i=line.indexOf(":"),key=lowercase(trim(line.substr(0,i))),val=trim(line.substr(i+1)),key&&(parsed[key]?parsed[key]+=", "+val:parsed[key]=val)}),parsed):parsed}function headersGetter(headers){var headersObj=isObject(headers)?headers:undefined;return function(name){return headersObj||(headersObj=parseHeaders(headers)),name?headersObj[lowercase(name)]||null:headersObj}}function transformData(data,headers,fns){return isFunction(fns)?fns(data,headers):(forEach(fns,function(fn){data=fn(data,headers)}),data)}function isSuccess(status){return status>=200&&300>status}function $HttpProvider(){var JSON_START=/^\s*(\[|\{[^\{])/,JSON_END=/[\}\]]\s*$/,PROTECTION_PREFIX=/^\)\]\}',?\n/,$config=this.defaults={transformResponse:[function(data){return isString(data)&&(data=data.replace(PROTECTION_PREFIX,""),JSON_START.test(data)&&JSON_END.test(data)&&(data=fromJson(data,!0))),data}],transformRequest:[function(d){return isObject(d)&&!isFile(d)?toJson(d):d}],headers:{common:{Accept:"application/json, text/plain, */*","X-Requested-With":"XMLHttpRequest"},post:{"Content-Type":"application/json;charset=utf-8"},put:{"Content-Type":"application/json;charset=utf-8"}}},providerResponseInterceptors=this.responseInterceptors=[];this.$get=["$httpBackend","$browser","$cacheFactory","$rootScope","$q","$injector",function($httpBackend,$browser,$cacheFactory,$rootScope,$q,$injector){function $http(config){function transformResponse(response){var resp=extend({},response,{data:transformData(response.data,response.headers,respTransformFn)});return isSuccess(response.status)?resp:$q.reject(resp)}config.method=uppercase(config.method);var promise,reqTransformFn=config.transformRequest||$config.transformRequest,respTransformFn=config.transformResponse||$config.transformResponse,defHeaders=$config.headers,reqHeaders=extend({"X-XSRF-TOKEN":$browser.cookies()["XSRF-TOKEN"]},defHeaders.common,defHeaders[lowercase(config.method)],config.headers),reqData=transformData(config.data,headersGetter(reqHeaders),reqTransformFn);return isUndefined(config.data)&&delete reqHeaders["Content-Type"],promise=sendReq(config,reqData,reqHeaders),promise=promise.then(transformResponse,transformResponse),forEach(responseInterceptors,function(interceptor){promise=interceptor(promise)}),promise.success=function(fn){return promise.then(function(response){fn(response.data,response.status,response.headers,config)}),promise},promise.error=function(fn){return promise.then(null,function(response){fn(response.data,response.status,response.headers,config)}),promise},promise}function createShortMethods(){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend(config||{},{method:name,url:url}))}})}function createShortMethodsWithData(){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend(config||{},{method:name,url:url,data:data}))}})}function sendReq(config,reqData,reqHeaders){function done(status,response,headersString){cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString)]):cache.remove(url)),resolvePromise(response,status,headersString),$rootScope.$apply()}function resolvePromise(response,status,headers){status=Math.max(status,0),(isSuccess(status)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config})}function removePendingReq(){var idx=indexOf($http.pendingRequests,config);-1!==idx&&$http.pendingRequests.splice(idx,1)}var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,url=buildUrl(config.url,config.params);if($http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),config.cache&&"GET"==config.method&&(cache=isObject(config.cache)?config.cache:defaultCache),cache)if(cachedResp=cache.get(url)){if(cachedResp.then)return cachedResp.then(removePendingReq,removePendingReq),cachedResp;isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],copy(cachedResp[2])):resolvePromise(cachedResp,200,{})}else cache.put(url,promise);return cachedResp||$httpBackend(config.method,url,reqData,done,reqHeaders,config.timeout,config.withCredentials),promise}function buildUrl(url,params){if(!params)return url;var parts=[];return forEachSorted(params,function(value,key){null!=value&&value!=undefined&&(isObject(value)&&(value=toJson(value)),parts.push(encodeURIComponent(key)+"="+encodeURIComponent(value)))}),url+(-1==url.indexOf("?")?"?":"&")+parts.join("&")}var defaultCache=$cacheFactory("$http"),responseInterceptors=[];return forEach(providerResponseInterceptors,function(interceptor){responseInterceptors.push(isString(interceptor)?$injector.get(interceptor):$injector.invoke(interceptor))}),$http.pendingRequests=[],createShortMethods("get","delete","head","jsonp"),createShortMethodsWithData("post","put"),$http.defaults=$config,$http}]}function $HttpBackendProvider(){this.$get=["$browser","$window","$document",function($browser,$window,$document){return createHttpBackend($browser,XHR,$browser.defer,$window.angular.callbacks,$document[0],$window.location.protocol.replace(":",""))}]}function createHttpBackend($browser,XHR,$browserDefer,callbacks,rawDocument,locationProtocol){function jsonpReq(url,done){var script=rawDocument.createElement("script"),doneWrapper=function(){rawDocument.body.removeChild(script),done&&done()};script.type="text/javascript",script.src=url,msie?script.onreadystatechange=function(){/loaded|complete/.test(script.readyState)&&doneWrapper()}:script.onload=script.onerror=doneWrapper,rawDocument.body.appendChild(script)}return function(method,url,post,callback,headers,timeout,withCredentials){function completeRequest(callback,status,response,headersString){var protocol=(url.match(URL_MATCH)||["",locationProtocol])[1];status="file"==protocol?response?200:404:status,status=1223==status?204:status,callback(status,response,headersString),$browser.$$completeOutstandingRequest(noop)}if($browser.$$incOutstandingRequestCount(),url=url||$browser.url(),"jsonp"==lowercase(method)){var callbackId="_"+(callbacks.counter++).toString(36);callbacks[callbackId]=function(data){callbacks[callbackId].data=data},jsonpReq(url.replace("JSON_CALLBACK","angular.callbacks."+callbackId),function(){callbacks[callbackId].data?completeRequest(callback,200,callbacks[callbackId].data):completeRequest(callback,-2),delete callbacks[callbackId]})}else{var xhr=new XHR;xhr.open(method,url,!0),forEach(headers,function(value,key){value&&xhr.setRequestHeader(key,value)});var status;xhr.onreadystatechange=function(){if(4==xhr.readyState){var responseHeaders=xhr.getAllResponseHeaders(),simpleHeaders=["Cache-Control","Content-Language","Content-Type","Expires","Last-Modified","Pragma"];responseHeaders||(responseHeaders="",forEach(simpleHeaders,function(header){var value=xhr.getResponseHeader(header);value&&(responseHeaders+=header+": "+value+"\n")})),completeRequest(callback,status||xhr.status,xhr.responseText,responseHeaders)}},withCredentials&&(xhr.withCredentials=!0),xhr.send(post||""),timeout>0&&$browserDefer(function(){status=-1,xhr.abort()},timeout)}}}function $LocaleProvider(){this.$get=function(){return{id:"en-us",NUMBER_FORMATS:{DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{minInt:1,minFrac:0,maxFrac:3,posPre:"",posSuf:"",negPre:"-",negSuf:"",gSize:3,lgSize:3},{minInt:1,minFrac:2,maxFrac:2,posPre:"¤",posSuf:"",negPre:"(¤",negSuf:")",gSize:3,lgSize:3}],CURRENCY_SYM:"$"},DATETIME_FORMATS:{MONTH:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),SHORTMONTH:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),DAY:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),SHORTDAY:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),AMPMS:["AM","PM"],medium:"MMM d, y h:mm:ss a","short":"M/d/yy h:mm a",fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",mediumDate:"MMM d, y",shortDate:"M/d/yy",mediumTime:"h:mm:ss a",shortTime:"h:mm a"},pluralCat:function(num){return 1===num?"one":"other"}}}}function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$exceptionHandler",function($rootScope,$browser,$q,$exceptionHandler){function timeout(fn,delay,invokeApply){var timeoutId,cleanup,deferred=$q.defer(),promise=deferred.promise,skipApply=isDefined(invokeApply)&&!invokeApply;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn())}catch(e){deferred.reject(e),$exceptionHandler(e)}skipApply||$rootScope.$apply()},delay),cleanup=function(){delete deferreds[promise.$$timeoutId]},promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise.then(cleanup,cleanup),promise}var deferreds={};return timeout.cancel=function(promise){return promise&&promise.$$timeoutId in deferreds?(deferreds[promise.$$timeoutId].reject("canceled"),$browser.defer.cancel(promise.$$timeoutId)):!1},timeout}]}function $FilterProvider($provide){function register(name,factory){return $provide.factory(name+suffix,factory)}var suffix="Filter";this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression){if(!isArray(array))return array;var predicates=[];predicates.check=function(value){for(var j=0;j<predicates.length;j++)if(!predicates[j](value))return!1;return!0};var search=function(obj,text){if("!"===text.charAt(0))return!search(obj,text.substr(1));switch(typeof obj){case"boolean":case"number":case"string":return(""+obj).toLowerCase().indexOf(text)>-1;case"object":for(var objKey in obj)if("$"!==objKey.charAt(0)&&search(obj[objKey],text))return!0;return!1;case"array":for(var i=0;i<obj.length;i++)if(search(obj[i],text))return!0;return!1;default:return!1}};switch(typeof expression){case"boolean":case"number":case"string":expression={$:expression};case"object":for(var key in expression)"$"==key?function(){var text=(""+expression[key]).toLowerCase();text&&predicates.push(function(value){return search(value,text)})}():function(){var path=key,text=(""+expression[key]).toLowerCase();text&&predicates.push(function(value){return search(getter(value,path),text)})}();break;case"function":predicates.push(expression);break;default:return array}for(var filtered=[],j=0;j<array.length;j++){var value=array[j];predicates.check(value)&&filtered.push(value)}return filtered}}function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol){return isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP).replace(/\u00A4/g,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(isNaN(number)||!isFinite(number))return"";var isNegative=0>number;number=Math.abs(number);var numStr=number+"",formatedText="",parts=[],hasExponent=!1;if(-1!==numStr.indexOf("e")){var match=numStr.match(/([\d\.]+)e(-?)(\d+)/);match&&"-"==match[2]&&match[3]>fractionSize+1?numStr="0":(formatedText=numStr,hasExponent=!0)}if(!hasExponent){var fractionLen=(numStr.split(DECIMAL_SEP)[1]||"").length;isUndefined(fractionSize)&&(fractionSize=Math.min(Math.max(pattern.minFrac,fractionLen),pattern.maxFrac));var pow=Math.pow(10,fractionSize);number=Math.round(number*pow)/pow;var fraction=(""+number).split(DECIMAL_SEP),whole=fraction[0];fraction=fraction[1]||"";var pos=0,lgroup=pattern.lgSize,group=pattern.gSize;if(whole.length>=lgroup+group){pos=whole.length-lgroup;for(var i=0;pos>i;i++)0===(pos-i)%group&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i)}for(i=pos;i<whole.length;i++)0===(whole.length-i)%lgroup&&0!==i&&(formatedText+=groupSep),formatedText+=whole.charAt(i);for(;fraction.length<fractionSize;)fraction+="0";fractionSize&&"0"!==fractionSize&&(formatedText+=decimalSep+fraction.substr(0,fractionSize))}return parts.push(isNegative?pattern.negPre:pattern.posPre),parts.push(formatedText),parts.push(isNegative?pattern.negSuf:pattern.posSuf),parts.join("")}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12==offset&&(value=12),padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name](),get=uppercase(shortForm?"SHORT"+name:name);return formats[get][value]}}function timeZoneGetter(date){var zone=-1*date.getTimezoneOffset(),paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function dateFilter($locale){function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0;
return match[9]&&(tzHour=int(match[9]+match[10]),tzMin=int(match[9]+match[11])),date.setUTCFullYear(int(match[1]),int(match[2])-1,int(match[3])),date.setUTCHours(int(match[4]||0)-tzHour,int(match[5]||0)-tzMin,int(match[6]||0),int(match[7]||0)),date}return string}var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?int(date):jsonStringToDate(date)),isNumber(date)&&(date=new Date(date)),!isDate(date))return date;for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=concat(parts,match,1),format=parts.pop()):(parts.push(format),format=null);return forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS):value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object){return toJson(object,!0)}}function limitToFilter(){return function(array,limit){if(!(array instanceof Array))return array;limit=int(limit);var i,n,out=[];if(!(array&&array instanceof Array))return out;for(limit>array.length?limit=array.length:limit<-array.length&&(limit=-array.length),limit>0?(i=0,n=limit):(i=array.length+limit,n=array.length);n>i;i++)out.push(array[i]);return out}}function orderByFilter($parse){return function(array,sortPredicate,reverseOrder){function comparator(o1,o2){for(var i=0;i<sortPredicate.length;i++){var comp=sortPredicate[i](o1,o2);if(0!==comp)return comp}return 0}function reverseComparator(comp,descending){return toBoolean(descending)?function(a,b){return comp(b,a)}:comp}function compare(v1,v2){var t1=typeof v1,t2=typeof v2;return t1==t2?("string"==t1&&(v1=v1.toLowerCase()),"string"==t1&&(v2=v2.toLowerCase()),v1===v2?0:v2>v1?-1:1):t2>t1?-1:1}if(!isArray(array))return array;if(!sortPredicate)return array;sortPredicate=isArray(sortPredicate)?sortPredicate:[sortPredicate],sortPredicate=map(sortPredicate,function(predicate){var descending=!1,get=predicate||identity;return isString(predicate)&&(("+"==predicate.charAt(0)||"-"==predicate.charAt(0))&&(descending="-"==predicate.charAt(0),predicate=predicate.substring(1)),get=$parse(predicate)),reverseComparator(function(a,b){return compare(get(a),get(b))},descending)});for(var arrayCopy=[],i=0;i<array.length;i++)arrayCopy.push(array[i]);return arrayCopy.sort(reverseComparator(comparator,reverseOrder))}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}function FormController(element,attrs){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",element.removeClass((isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey).addClass((isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey)}var form=this,parentForm=element.parent().controller("form")||nullFormCtrl,invalidCount=0,errors=form.$error={};form.$name=attrs.name,form.$dirty=!1,form.$pristine=!0,form.$valid=!0,form.$invalid=!1,parentForm.$addControl(form),element.addClass(PRISTINE_CLASS),toggleValidCss(!0),form.$addControl=function(control){control.$name&&!form.hasOwnProperty(control.$name)&&(form[control.$name]=control)},form.$removeControl=function(control){control.$name&&form[control.$name]===control&&delete form[control.$name],forEach(errors,function(queue,validationToken){form.$setValidity(validationToken,!0,control)})},form.$setValidity=function(validationToken,isValid,control){var queue=errors[validationToken];if(isValid)queue&&(arrayRemove(queue,control),queue.length||(invalidCount--,invalidCount||(toggleValidCss(isValid),form.$valid=!0,form.$invalid=!1),errors[validationToken]=!1,toggleValidCss(!0,validationToken),parentForm.$setValidity(validationToken,!0,form)));else{if(invalidCount||toggleValidCss(isValid),queue){if(includes(queue,control))return}else errors[validationToken]=queue=[],invalidCount++,toggleValidCss(!1,validationToken),parentForm.$setValidity(validationToken,!1,form);queue.push(control),form.$valid=!1,form.$invalid=!0}},form.$setDirty=function(){element.removeClass(PRISTINE_CLASS).addClass(DIRTY_CLASS),form.$dirty=!0,form.$pristine=!1,parentForm.$setDirty()}}function isEmpty(value){return isUndefined(value)||""===value||null===value||value!==value}function textInputType(scope,element,attr,ctrl,$sniffer,$browser){var listener=function(){var value=trim(element.val());ctrl.$viewValue!==value&&scope.$apply(function(){ctrl.$setViewValue(value)})};if($sniffer.hasEvent("input"))element.bind("input",listener);else{var timeout,deferListener=function(){timeout||(timeout=$browser.defer(function(){listener(),timeout=null}))};element.bind("keydown",function(event){var key=event.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||deferListener()}),element.bind("change",listener),$sniffer.hasEvent("paste")&&element.bind("paste cut",deferListener)}ctrl.$render=function(){element.val(isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue)};var patternValidator,pattern=attr.ngPattern,validate=function(regexp,value){return isEmpty(value)||regexp.test(value)?(ctrl.$setValidity("pattern",!0),value):(ctrl.$setValidity("pattern",!1),undefined)};if(pattern&&(pattern.match(/^\/(.*)\/$/)?(pattern=new RegExp(pattern.substr(1,pattern.length-2)),patternValidator=function(value){return validate(pattern,value)}):patternValidator=function(value){var patternObj=scope.$eval(pattern);if(!patternObj||!patternObj.test)throw new Error("Expected "+pattern+" to be a RegExp but was "+patternObj);return validate(patternObj,value)},ctrl.$formatters.push(patternValidator),ctrl.$parsers.push(patternValidator)),attr.ngMinlength){var minlength=int(attr.ngMinlength),minLengthValidator=function(value){return!isEmpty(value)&&value.length<minlength?(ctrl.$setValidity("minlength",!1),undefined):(ctrl.$setValidity("minlength",!0),value)};ctrl.$parsers.push(minLengthValidator),ctrl.$formatters.push(minLengthValidator)}if(attr.ngMaxlength){var maxlength=int(attr.ngMaxlength),maxLengthValidator=function(value){return!isEmpty(value)&&value.length>maxlength?(ctrl.$setValidity("maxlength",!1),undefined):(ctrl.$setValidity("maxlength",!0),value)};ctrl.$parsers.push(maxLengthValidator),ctrl.$formatters.push(maxLengthValidator)}}function numberInputType(scope,element,attr,ctrl,$sniffer,$browser){if(textInputType(scope,element,attr,ctrl,$sniffer,$browser),ctrl.$parsers.push(function(value){var empty=isEmpty(value);return empty||NUMBER_REGEXP.test(value)?(ctrl.$setValidity("number",!0),""===value?null:empty?value:parseFloat(value)):(ctrl.$setValidity("number",!1),undefined)}),ctrl.$formatters.push(function(value){return isEmpty(value)?"":""+value}),attr.min){var min=parseFloat(attr.min),minValidator=function(value){return!isEmpty(value)&&min>value?(ctrl.$setValidity("min",!1),undefined):(ctrl.$setValidity("min",!0),value)};ctrl.$parsers.push(minValidator),ctrl.$formatters.push(minValidator)}if(attr.max){var max=parseFloat(attr.max),maxValidator=function(value){return!isEmpty(value)&&value>max?(ctrl.$setValidity("max",!1),undefined):(ctrl.$setValidity("max",!0),value)};ctrl.$parsers.push(maxValidator),ctrl.$formatters.push(maxValidator)}ctrl.$formatters.push(function(value){return isEmpty(value)||isNumber(value)?(ctrl.$setValidity("number",!0),value):(ctrl.$setValidity("number",!1),undefined)})}function urlInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var urlValidator=function(value){return isEmpty(value)||URL_REGEXP.test(value)?(ctrl.$setValidity("url",!0),value):(ctrl.$setValidity("url",!1),undefined)};ctrl.$formatters.push(urlValidator),ctrl.$parsers.push(urlValidator)}function emailInputType(scope,element,attr,ctrl,$sniffer,$browser){textInputType(scope,element,attr,ctrl,$sniffer,$browser);var emailValidator=function(value){return isEmpty(value)||EMAIL_REGEXP.test(value)?(ctrl.$setValidity("email",!0),value):(ctrl.$setValidity("email",!1),undefined)};ctrl.$formatters.push(emailValidator),ctrl.$parsers.push(emailValidator)}function radioInputType(scope,element,attr,ctrl){isUndefined(attr.name)&&element.attr("name",nextUid()),element.bind("click",function(){element[0].checked&&scope.$apply(function(){ctrl.$setViewValue(attr.value)})}),ctrl.$render=function(){var value=attr.value;element[0].checked=value==ctrl.$viewValue},attr.$observe("value",ctrl.$render)}function checkboxInputType(scope,element,attr,ctrl){var trueValue=attr.ngTrueValue,falseValue=attr.ngFalseValue;isString(trueValue)||(trueValue=!0),isString(falseValue)||(falseValue=!1),element.bind("click",function(){scope.$apply(function(){ctrl.$setViewValue(element[0].checked)})}),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$formatters.push(function(value){return value===trueValue}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})}function classDirective(name,selector){return name="ngClass"+name,ngDirective(function(scope,element,attr){function ngClassWatchAction(newVal){(selector===!0||scope.$index%2===selector)&&(oldVal&&!equals(newVal,oldVal)&&removeClass(oldVal),addClass(newVal)),oldVal=copy(newVal)}function removeClass(classVal){isObject(classVal)&&!isArray(classVal)&&(classVal=map(classVal,function(v,k){return v?k:void 0})),element.removeClass(isArray(classVal)?classVal.join(" "):classVal)}function addClass(classVal){isObject(classVal)&&!isArray(classVal)&&(classVal=map(classVal,function(v,k){return v?k:void 0})),classVal&&element.addClass(isArray(classVal)?classVal.join(" "):classVal)}var oldVal=undefined;scope.$watch(attr[name],ngClassWatchAction,!0),attr.$observe("class",function(){var ngClass=scope.$eval(attr[name]);ngClassWatchAction(ngClass,ngClass)}),"ngClass"!==name&&scope.$watch("$index",function($index,old$index){var mod=1&$index;1&mod!==old$index&&(mod===selector?addClass(scope.$eval(attr[name])):removeClass(scope.$eval(attr[name])))})})}var lowercase=function(string){return isString(string)?string.toLowerCase():string},uppercase=function(string){return isString(string)?string.toUpperCase():string},manualLowercase=function(s){return isString(s)?s.replace(/[A-Z]/g,function(ch){return String.fromCharCode(32|ch.charCodeAt(0))}):s},manualUppercase=function(s){return isString(s)?s.replace(/[a-z]/g,function(ch){return String.fromCharCode(-33&ch.charCodeAt(0))}):s};"i"!=="I".toLowerCase()&&(lowercase=manualLowercase,uppercase=manualUppercase);var jqLite,jQuery,angularModule,nodeName_,msie=int((/msie (\d+)/.exec(lowercase(navigator.userAgent))||[])[1]),slice=[].slice,push=[].push,toString=Object.prototype.toString,angular=window.angular||(window.angular={}),uid=["0","0","0"];noop.$inject=[],identity.$inject=[],nodeName_=9>msie?function(element){return element=element.nodeName?element:element[0],element.scopeName&&"HTML"!=element.scopeName?uppercase(element.scopeName+":"+element.nodeName):element.nodeName}:function(element){return element.nodeName?element.nodeName:element[0].nodeName};var SNAKE_CASE_REGEXP=/[A-Z]/g,version={full:"1.0.7",major:1,minor:0,dot:7,codeName:"monochromatic-rainbow"},jqCache=JQLite.cache={},jqName=JQLite.expando="ng-"+(new Date).getTime(),jqId=1,addEventListenerFn=window.document.addEventListener?function(element,type,fn){element.addEventListener(type,fn,!1)}:function(element,type,fn){element.attachEvent("on"+type,fn)},removeEventListenerFn=window.document.removeEventListener?function(element,type,fn){element.removeEventListener(type,fn,!1)}:function(element,type,fn){element.detachEvent("on"+type,fn)},SPECIAL_CHARS_REGEXP=/([\:\-\_]+(.))/g,MOZ_HACK_REGEXP=/^moz([A-Z])/,JQLitePrototype=JQLite.prototype={ready:function(fn){function trigger(){fired||(fired=!0,fn())}var fired=!1;this.bind("DOMContentLoaded",trigger),JQLite(window).bind("load",trigger)},toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return index>=0?jqLite(this[index]):jqLite(this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form".split(","),function(value){BOOLEAN_ELEMENTS[uppercase(value)]=!0}),forEach({data:JQLiteData,inheritedData:JQLiteInheritedData,scope:function(element){return JQLiteInheritedData(element,"$scope")},controller:JQLiteController,injector:function(element){return JQLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:JQLiteHasClass,css:function(element,name,value){if(name=camelCase(name),!isDefined(value)){var val;return 8>=msie&&(val=element.currentStyle&&element.currentStyle[name],""===val&&(val="auto")),val=val||element.style[name],8>=msie&&(val=""===val?undefined:val),val}element.style[name]=value},attr:function(element,name,value){var lowercasedName=lowercase(name);if(BOOLEAN_ATTR[lowercasedName]){if(!isDefined(value))return element[name]||(element.attributes.getNamedItem(name)||noop).specified?lowercasedName:undefined;value?(element[name]=!0,element.setAttribute(name,lowercasedName)):(element[name]=!1,element.removeAttribute(lowercasedName))}else if(isDefined(value))element.setAttribute(name,value);else if(element.getAttribute){var ret=element.getAttribute(name,2);return null===ret?undefined:ret}},prop:function(element,name,value){return isDefined(value)?(element[name]=value,void 0):element[name]},text:extend(9>msie?function(element,value){if(1==element.nodeType){if(isUndefined(value))return element.innerText;element.innerText=value}else{if(isUndefined(value))return element.nodeValue;element.nodeValue=value}}:function(element,value){return isUndefined(value)?element.textContent:(element.textContent=value,void 0)},{$dv:""}),val:function(element,value){return isUndefined(value)?element.value:(element.value=value,void 0)},html:function(element,value){if(isUndefined(value))return element.innerHTML;for(var i=0,childNodes=element.childNodes;i<childNodes.length;i++)JQLiteDealoc(childNodes[i]);element.innerHTML=value}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key;if((2==fn.length&&fn!==JQLiteHasClass&&fn!==JQLiteController?arg1:arg2)!==undefined){for(i=0;i<this.length;i++)fn(this[i],arg1,arg2);return this}if(isObject(arg1)){for(i=0;i<this.length;i++)if(fn===JQLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}return this.length?fn(this[0],arg1,arg2):fn.$dv}}),forEach({removeData:JQLiteRemoveData,dealoc:JQLiteDealoc,bind:function bindFn(element,type,fn){var events=JQLiteExpandoStore(element,"events"),handle=JQLiteExpandoStore(element,"handle");events||JQLiteExpandoStore(element,"events",events={}),handle||JQLiteExpandoStore(element,"handle",handle=createEventHandler(element,events)),forEach(type.split(" "),function(type){var eventFns=events[type];if(!eventFns){if("mouseenter"==type||"mouseleave"==type){var contains=document.body.contains||document.body.compareDocumentPosition?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};events[type]=[];var eventmap={mouseleave:"mouseout",mouseenter:"mouseover"};bindFn(element,eventmap[type],function(event){var target=this,related=event.relatedTarget;(!related||related!==target&&!contains(target,related))&&handle(event,type)})}else addEventListenerFn(element,type,handle),events[type]=[];eventFns=events[type]}eventFns.push(fn)})},unbind:JQLiteUnbind,replaceWith:function(element,replaceNode){var index,parent=element.parentNode;JQLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){1===element.nodeType&&children.push(element)}),children},contents:function(element){return element.childNodes||[]},append:function(element,node){forEach(new JQLite(node),function(child){1===element.nodeType&&element.appendChild(child)})},prepend:function(element,node){if(1===element.nodeType){var index=element.firstChild;forEach(new JQLite(node),function(child){index?element.insertBefore(child,index):(element.appendChild(child),index=child)})}},wrap:function(element,wrapNode){wrapNode=jqLite(wrapNode)[0];var parent=element.parentNode;parent&&parent.replaceChild(wrapNode,element),wrapNode.appendChild(element)},remove:function(element){JQLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)},after:function(element,newElement){var index=element,parent=element.parentNode;forEach(new JQLite(newElement),function(node){parent.insertBefore(node,index.nextSibling),index=node})},addClass:JQLiteAddClass,removeClass:JQLiteRemoveClass,toggleClass:function(element,selector,condition){isUndefined(condition)&&(condition=!JQLiteHasClass(element,selector)),(condition?JQLiteAddClass:JQLiteRemoveClass)(element,selector)},parent:function(element){var parent=element.parentNode;return parent&&11!==parent.nodeType?parent:null},next:function(element){if(element.nextElementSibling)return element.nextElementSibling;for(var elm=element.nextSibling;null!=elm&&1!==elm.nodeType;)elm=elm.nextSibling;return elm},find:function(element,selector){return element.getElementsByTagName(selector)},clone:JQLiteClone,triggerHandler:function(element,eventName){var eventFns=(JQLiteExpandoStore(element,"events")||{})[eventName];forEach(eventFns,function(fn){fn.call(element,null)})}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){for(var value,i=0;i<this.length;i++)value==undefined?(value=fn(this[i],arg1,arg2),value!==undefined&&(value=jqLite(value))):JQLiteAddNodes(value,fn(this[i],arg1,arg2));return value==undefined?this:value}}),HashMap.prototype={put:function(key,value){this[hashKey(key)]=value},get:function(key){return this[hashKey(key)]},remove:function(key){var value=this[key=hashKey(key)];return delete this[key],value}},HashQueueMap.prototype={push:function(key,value){var array=this[key=hashKey(key)];array?array.push(value):this[key]=[value]},shift:function(key){var array=this[key=hashKey(key)];return array?1==array.length?(delete this[key],array[0]):array.shift():void 0},peek:function(key){var array=this[hashKey(key)];return array?array[0]:void 0}};var FN_ARGS=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,NON_ASSIGNABLE_MODEL_EXPRESSION="Non-assignable model expression: ";$CompileProvider.$inject=["$provide"];var PREFIX_REGEXP=/^(x[\:\-_]|data[\:\-_])/i,URL_MATCH=/^([^:]+):\/\/(\w+:{0,1}\w*@)?(\{?[\w\.-]*\}?)(:([0-9]+))?(\/[^\?#]*)?(\?([^#]*))?(#(.*))?$/,PATH_MATCH=/^([^\?#]*)?(\?([^#]*))?(#(.*))?$/,HASH_MATCH=PATH_MATCH,DEFAULT_PORTS={http:80,https:443,ftp:21};LocationUrl.prototype={$$replace:!1,absUrl:locationGetter("$$absUrl"),url:function(url,replace){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return match[1]&&this.path(decodeURIComponent(match[1])),(match[2]||match[1])&&this.search(match[3]||""),this.hash(match[5]||"",replace),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return"/"==path.charAt(0)?path:"/"+path}),search:function(search,paramValue){return isUndefined(search)?this.$$search:(isDefined(paramValue)?null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue:this.$$search=isString(search)?parseKeyValue(search):search,this.$$compose(),this)},hash:locationGetterSetter("$$hash",identity),replace:function(){return this.$$replace=!0,this}},LocationHashbangUrl.prototype=inherit(LocationUrl.prototype),LocationHashbangInHtml5Url.prototype=inherit(LocationHashbangUrl.prototype);var OPERATORS={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:noop,"+":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),isDefined(a)?isDefined(b)?a+b:a:isDefined(b)?b:undefined},"-":function(self,locals,a,b){return a=a(self,locals),b=b(self,locals),(isDefined(a)?a:0)-(isDefined(b)?b:0)},"*":function(self,locals,a,b){return a(self,locals)*b(self,locals)},"/":function(self,locals,a,b){return a(self,locals)/b(self,locals)},"%":function(self,locals,a,b){return a(self,locals)%b(self,locals)},"^":function(self,locals,a,b){return a(self,locals)^b(self,locals)},"=":noop,"==":function(self,locals,a,b){return a(self,locals)==b(self,locals)},"!=":function(self,locals,a,b){return a(self,locals)!=b(self,locals)},"<":function(self,locals,a,b){return a(self,locals)<b(self,locals)},">":function(self,locals,a,b){return a(self,locals)>b(self,locals)},"<=":function(self,locals,a,b){return a(self,locals)<=b(self,locals)},">=":function(self,locals,a,b){return a(self,locals)>=b(self,locals)},"&&":function(self,locals,a,b){return a(self,locals)&&b(self,locals)},"||":function(self,locals,a,b){return a(self,locals)||b(self,locals)},"&":function(self,locals,a,b){return a(self,locals)&b(self,locals)},"|":function(self,locals,a,b){return b(self,locals)(self,locals,a(self,locals))},"!":function(self,locals,a){return!a(self,locals)}},ESCAPE={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},getterFnCache={},XHR=window.XMLHttpRequest||function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e1){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e2){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e3){}throw new Error("This browser does not support XMLHttpRequest.")};$FilterProvider.$inject=["$provide"],currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DECIMAL_SEP=".",DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,!0),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter},DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,NUMBER_STRING=/^\d+$/;dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){return 8>=msie&&(attr.href||attr.name||attr.$set("href",""),element.append(document.createComment("IE fix"))),function(scope,element){element.bind("click",function(event){element.attr("href")||event.preventDefault()})}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:100,compile:function(){return function(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}}}}}),forEach(["src","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=function(){return{priority:99,link:function(scope,element,attr){attr.$observe(normalized,function(value){value&&(attr.$set(attrName,value),msie&&element.prop(attrName,attr[attrName]))})}}}});var nullFormCtrl={$addControl:noop,$removeControl:noop,$setValidity:noop,$setDirty:noop};FormController.$inject=["$element","$attrs","$scope"];var formDirectiveFactory=function(isNgForm){return["$timeout",function($timeout){var formDirective={name:"form",restrict:"E",controller:FormController,compile:function(){return{pre:function(scope,formElement,attr,controller){if(!attr.action){var preventDefaultListener=function(event){event.preventDefault?event.preventDefault():event.returnValue=!1};addEventListenerFn(formElement[0],"submit",preventDefaultListener),formElement.bind("$destroy",function(){$timeout(function(){removeEventListenerFn(formElement[0],"submit",preventDefaultListener)},0,!1)})}var parentFormCtrl=formElement.parent().controller("form"),alias=attr.name||attr.ngForm;alias&&(scope[alias]=controller),parentFormCtrl&&formElement.bind("$destroy",function(){parentFormCtrl.$removeControl(controller),alias&&(scope[alias]=undefined),extend(controller,nullFormCtrl)})}}}};return isNgForm?extend(copy(formDirective),{restrict:"EAC"}):formDirective}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0),URL_REGEXP=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,EMAIL_REGEXP=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/,NUMBER_REGEXP=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/,inputType={text:textInputType,number:numberInputType,url:urlInputType,email:emailInputType,radio:radioInputType,checkbox:checkboxInputType,hidden:noop,button:noop,submit:noop,reset:noop},inputDirective=["$browser","$sniffer",function($browser,$sniffer){return{restrict:"E",require:"?ngModel",link:function(scope,element,attr,ctrl){ctrl&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrl,$sniffer,$browser)}}}],VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",NgModelController=["$scope","$exceptionHandler","$attrs","$element","$parse",function($scope,$exceptionHandler,$attr,$element,$parse){function toggleValidCss(isValid,validationErrorKey){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",$element.removeClass((isValid?INVALID_CLASS:VALID_CLASS)+validationErrorKey).addClass((isValid?VALID_CLASS:INVALID_CLASS)+validationErrorKey)}this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$name=$attr.name;var ngModelGet=$parse($attr.ngModel),ngModelSet=ngModelGet.assign;if(!ngModelSet)throw Error(NON_ASSIGNABLE_MODEL_EXPRESSION+$attr.ngModel+" ("+startingTag($element)+")");this.$render=noop;var parentForm=$element.inheritedData("$formController")||nullFormCtrl,invalidCount=0,$error=this.$error={};$element.addClass(PRISTINE_CLASS),toggleValidCss(!0),this.$setValidity=function(validationErrorKey,isValid){$error[validationErrorKey]!==!isValid&&(isValid?($error[validationErrorKey]&&invalidCount--,invalidCount||(toggleValidCss(!0),this.$valid=!0,this.$invalid=!1)):(toggleValidCss(!1),this.$invalid=!0,this.$valid=!1,invalidCount++),$error[validationErrorKey]=!isValid,toggleValidCss(isValid,validationErrorKey),parentForm.$setValidity(validationErrorKey,isValid,this))},this.$setViewValue=function(value){this.$viewValue=value,this.$pristine&&(this.$dirty=!0,this.$pristine=!1,$element.removeClass(PRISTINE_CLASS).addClass(DIRTY_CLASS),parentForm.$setDirty()),forEach(this.$parsers,function(fn){value=fn(value)}),this.$modelValue!==value&&(this.$modelValue=value,ngModelSet($scope,value),forEach(this.$viewChangeListeners,function(listener){try{listener()}catch(e){$exceptionHandler(e)}}))};var ctrl=this;$scope.$watch(function(){var value=ngModelGet($scope);if(ctrl.$modelValue!==value){var formatters=ctrl.$formatters,idx=formatters.length;for(ctrl.$modelValue=value;idx--;)value=formatters[idx](value);ctrl.$viewValue!==value&&(ctrl.$viewValue=value,ctrl.$render())}})}],ngModelDirective=function(){return{require:["ngModel","^?form"],controller:NgModelController,link:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||nullFormCtrl;formCtrl.$addControl(modelCtrl),element.bind("$destroy",function(){formCtrl.$removeControl(modelCtrl)})}}},ngChangeDirective=valueFn({require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}}),requiredDirective=function(){return{require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){attr.required=!0;var validator=function(value){return attr.required&&(isEmpty(value)||value===!1)?(ctrl.$setValidity("required",!1),void 0):(ctrl.$setValidity("required",!0),value)};ctrl.$formatters.push(validator),ctrl.$parsers.unshift(validator),attr.$observe("required",function(){validator(ctrl.$viewValue)})}}}},ngListDirective=function(){return{require:"ngModel",link:function(scope,element,attr,ctrl){var match=/\/(.*)\//.exec(attr.ngList),separator=match&&new RegExp(match[1])||attr.ngList||",",parse=function(viewValue){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trim(value))}),list};ctrl.$parsers.push(parse),ctrl.$formatters.push(function(value){return isArray(value)?value.join(", "):undefined})}}},CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){return{priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){attr.$set("value",scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){attr.$set("value",value,!1)})}}}},ngBindDirective=ngDirective(function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.ngBind),scope.$watch(attr.ngBind,function(value){element.text(value==undefined?"":value)})}),ngBindTemplateDirective=["$interpolate",function($interpolate){return function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));element.addClass("ng-binding").data("$binding",interpolateFn),attr.$observe("ngBindTemplate",function(value){element.text(value)})}}],ngBindHtmlUnsafeDirective=[function(){return function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.ngBindHtmlUnsafe),scope.$watch(attr.ngBindHtmlUnsafe,function(value){element.html(value||"")})}}],ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",undefined),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{scope:!0,controller:"@"}}],ngCspDirective=["$sniffer",function($sniffer){return{priority:1e3,compile:function(){$sniffer.csp=!0}}}],ngEventDirectives={};forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave".split(" "),function(name){var directiveName=directiveNormalize("ng-"+name);ngEventDirectives[directiveName]=["$parse",function($parse){return function(scope,element,attr){var fn=$parse(attr[directiveName]);element.bind(lowercase(name),function(event){scope.$apply(function(){fn(scope,{$event:event})})})}}]});var ngSubmitDirective=ngDirective(function(scope,element,attrs){element.bind("submit",function(){scope.$apply(attrs.ngSubmit)})}),ngIncludeDirective=["$http","$templateCache","$anchorScroll","$compile",function($http,$templateCache,$anchorScroll,$compile){return{restrict:"ECA",terminal:!0,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,element){var childScope,changeCounter=0,clearContent=function(){childScope&&(childScope.$destroy(),childScope=null),element.html("")};scope.$watch(srcExp,function(src){var thisChangeId=++changeCounter;src?$http.get(src,{cache:$templateCache}).success(function(response){thisChangeId===changeCounter&&(childScope&&childScope.$destroy(),childScope=scope.$new(),element.html(response),$compile(element.contents())(childScope),!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll(),childScope.$emit("$includeContentLoaded"),scope.$eval(onloadExp))}).error(function(){thisChangeId===changeCounter&&clearContent()}):clearContent()})}}}}],ngInitDirective=ngDirective({compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngPluralizeDirective=["$locale","$interpolate",function($locale,$interpolate){var BRACE=/{}/g;return{restrict:"EA",link:function(scope,element,attr){var numberExp=attr.count,whenExp=element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp),whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol();forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,startSymbol+numberExp+"-"+offset+endSymbol))
}),scope.$watch(function(){var value=parseFloat(scope.$eval(numberExp));return isNaN(value)?"":(value in whens||(value=$locale.pluralCat(value-offset)),whensExpFns[value](scope,element,!0))},function(newVal){element.text(newVal)})}}}],ngRepeatDirective=ngDirective({transclude:"element",priority:1e3,terminal:!0,compile:function(element,attr,linker){return function(scope,iterStartElement,attr){var lhs,rhs,valueIdent,keyIdent,expression=attr.ngRepeat,match=expression.match(/^\s*(.+)\s+in\s+(.*)\s*$/);if(!match)throw Error("Expected ngRepeat in form of '_item_ in _collection_' but got '"+expression+"'.");if(lhs=match[1],rhs=match[2],match=lhs.match(/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/),!match)throw Error("'item' in 'item in collection' should be identifier or (key, value) but got '"+lhs+"'.");valueIdent=match[3]||match[1],keyIdent=match[2];var lastOrder=new HashQueueMap;scope.$watch(function(scope){var index,length,arrayBound,childScope,key,value,array,last,collection=scope.$eval(rhs),cursor=iterStartElement,nextOrder=new HashQueueMap;if(isArray(collection))array=collection||[];else{array=[];for(key in collection)collection.hasOwnProperty(key)&&"$"!=key.charAt(0)&&array.push(key);array.sort()}for(arrayBound=array.length-1,index=0,length=array.length;length>index;index++)key=collection===array?index:array[index],value=collection[key],last=lastOrder.shift(value),last?(childScope=last.scope,nextOrder.push(value,last),index===last.index?cursor=last.element:(last.index=index,cursor.after(last.element),cursor=last.element)):childScope=scope.$new(),childScope[valueIdent]=value,keyIdent&&(childScope[keyIdent]=key),childScope.$index=index,childScope.$first=0===index,childScope.$last=index===arrayBound,childScope.$middle=!(childScope.$first||childScope.$last),last||linker(childScope,function(clone){cursor.after(clone),last={scope:childScope,element:cursor=clone,index:index},nextOrder.push(value,last)});for(key in lastOrder)if(lastOrder.hasOwnProperty(key))for(array=lastOrder[key];array.length;)value=array.pop(),value.element.remove(),value.scope.$destroy();lastOrder=nextOrder})}}}),ngShowDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngShow,function(value){element.css("display",toBoolean(value)?"":"none")})}),ngHideDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngHide,function(value){element.css("display",toBoolean(value)?"none":"")})}),ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watch(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)},!0)}),ngSwitchDirective=valueFn({restrict:"EA",require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ctrl){var selectedTransclude,selectedElement,selectedScope,watchExpr=attr.ngSwitch||attr.on;scope.$watch(watchExpr,function(value){selectedElement&&(selectedScope.$destroy(),selectedElement.remove(),selectedElement=selectedScope=null),(selectedTransclude=ctrl.cases["!"+value]||ctrl.cases["?"])&&(scope.$eval(attr.change),selectedScope=scope.$new(),selectedTransclude(selectedScope,function(caseElement){selectedElement=caseElement,element.append(caseElement)}))})}}),ngSwitchWhenDirective=ngDirective({transclude:"element",priority:500,require:"^ngSwitch",compile:function(element,attrs,transclude){return function(scope,element,attr,ctrl){ctrl.cases["!"+attrs.ngSwitchWhen]=transclude}}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:500,require:"^ngSwitch",compile:function(element,attrs,transclude){return function(scope,element,attr,ctrl){ctrl.cases["?"]=transclude}}}),ngTranscludeDirective=ngDirective({controller:["$transclude","$element",function($transclude,$element){$transclude(function(clone){$element.append(clone)})}]}),ngViewDirective=["$http","$templateCache","$route","$anchorScroll","$compile","$controller",function($http,$templateCache,$route,$anchorScroll,$compile,$controller){return{restrict:"ECA",terminal:!0,link:function(scope,element,attr){function destroyLastScope(){lastScope&&(lastScope.$destroy(),lastScope=null)}function clearContent(){element.html(""),destroyLastScope()}function update(){var locals=$route.current&&$route.current.locals,template=locals&&locals.$template;if(template){element.html(template),destroyLastScope();var controller,link=$compile(element.contents()),current=$route.current;lastScope=current.scope=scope.$new(),current.controller&&(locals.$scope=lastScope,controller=$controller(current.controller,locals),element.children().data("$ngControllerController",controller)),link(lastScope),lastScope.$emit("$viewContentLoaded"),lastScope.$eval(onloadExp),$anchorScroll()}else clearContent()}var lastScope,onloadExp=attr.onload||"";scope.$on("$routeChangeSuccess",update),update()}}}],scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"==attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],ngOptionsDirective=valueFn({terminal:!0}),selectDirective=["$compile","$parse",function($compile,$parse){var NG_OPTIONS_REGEXP=/^\s*(.*?)(?:\s+as\s+(.*?))?(?:\s+group\s+by\s+(.*))?\s+for\s+(?:([\$\w][\$\w\d]*)|(?:\(\s*([\$\w][\$\w\d]*)\s*,\s*([\$\w][\$\w\d]*)\s*\)))\s+in\s+(.*)$/,nullModelCtrl={$setViewValue:noop};return{restrict:"E",require:["select","?ngModel"],controller:["$element","$scope","$attrs",function($element,$scope,$attrs){var nullOption,unknownOption,self=this,optionsMap={},ngModelCtrl=nullModelCtrl;self.databound=$attrs.ngModel,self.init=function(ngModelCtrl_,nullOption_,unknownOption_){ngModelCtrl=ngModelCtrl_,nullOption=nullOption_,unknownOption=unknownOption_},self.addOption=function(value){optionsMap[value]=!0,ngModelCtrl.$viewValue==value&&($element.val(value),unknownOption.parent()&&unknownOption.remove())},self.removeOption=function(value){this.hasOption(value)&&(delete optionsMap[value],ngModelCtrl.$viewValue==value&&this.renderUnknownOption(value))},self.renderUnknownOption=function(val){var unknownVal="? "+hashKey(val)+" ?";unknownOption.val(unknownVal),$element.prepend(unknownOption),$element.val(unknownVal),unknownOption.prop("selected",!0)},self.hasOption=function(value){return optionsMap.hasOwnProperty(value)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop})}],link:function(scope,element,attr,ctrls){function Single(scope,selectElement,ngModelCtrl,selectCtrl){ngModelCtrl.$render=function(){var viewValue=ngModelCtrl.$viewValue;selectCtrl.hasOption(viewValue)?(unknownOption.parent()&&unknownOption.remove(),selectElement.val(viewValue),""===viewValue&&emptyOption.prop("selected",!0)):isUndefined(viewValue)&&emptyOption?selectElement.val(""):selectCtrl.renderUnknownOption(viewValue)},selectElement.bind("change",function(){scope.$apply(function(){unknownOption.parent()&&unknownOption.remove(),ngModelCtrl.$setViewValue(selectElement.val())})})}function Multiple(scope,selectElement,ctrl){var lastView;ctrl.$render=function(){var items=new HashMap(ctrl.$viewValue);forEach(selectElement.find("option"),function(option){option.selected=isDefined(items.get(option.value))})},scope.$watch(function(){equals(lastView,ctrl.$viewValue)||(lastView=copy(ctrl.$viewValue),ctrl.$render())}),selectElement.bind("change",function(){scope.$apply(function(){var array=[];forEach(selectElement.find("option"),function(option){option.selected&&array.push(option.value)}),ctrl.$setViewValue(array)})})}function Options(scope,selectElement,ctrl){function render(){var optionGroupName,optionGroup,option,existingParent,existingOptions,existingOption,groupLength,length,groupIndex,index,selected,lastElement,element,label,optionGroups={"":[]},optionGroupNames=[""],modelValue=ctrl.$modelValue,values=valuesFn(scope)||[],keys=keyName?sortedKeys(values):values,locals={},selectedSet=!1;for(multiple&&(selectedSet=new HashMap(modelValue)),index=0;length=keys.length,length>index;index++)locals[valueName]=values[keyName?locals[keyName]=keys[index]:index],optionGroupName=groupByFn(scope,locals)||"",(optionGroup=optionGroups[optionGroupName])||(optionGroup=optionGroups[optionGroupName]=[],optionGroupNames.push(optionGroupName)),multiple?selected=selectedSet.remove(valueFn(scope,locals))!=undefined:(selected=modelValue===valueFn(scope,locals),selectedSet=selectedSet||selected),label=displayFn(scope,locals),label=label===undefined?"":label,optionGroup.push({id:keyName?keys[index]:index,label:label,selected:selected});for(multiple||(nullOption||null===modelValue?optionGroups[""].unshift({id:"",label:"",selected:!selectedSet}):selectedSet||optionGroups[""].unshift({id:"?",label:"",selected:!0})),groupIndex=0,groupLength=optionGroupNames.length;groupLength>groupIndex;groupIndex++){for(optionGroupName=optionGroupNames[groupIndex],optionGroup=optionGroups[optionGroupName],optionGroupsCache.length<=groupIndex?(existingParent={element:optGroupTemplate.clone().attr("label",optionGroupName),label:optionGroup.label},existingOptions=[existingParent],optionGroupsCache.push(existingOptions),selectElement.append(existingParent.element)):(existingOptions=optionGroupsCache[groupIndex],existingParent=existingOptions[0],existingParent.label!=optionGroupName&&existingParent.element.attr("label",existingParent.label=optionGroupName)),lastElement=null,index=0,length=optionGroup.length;length>index;index++)option=optionGroup[index],(existingOption=existingOptions[index+1])?(lastElement=existingOption.element,existingOption.label!==option.label&&lastElement.text(existingOption.label=option.label),existingOption.id!==option.id&&lastElement.val(existingOption.id=option.id),lastElement[0].selected!==option.selected&&lastElement.prop("selected",existingOption.selected=option.selected)):(""===option.id&&nullOption?element=nullOption:(element=optionTemplate.clone()).val(option.id).attr("selected",option.selected).text(option.label),existingOptions.push(existingOption={element:element,label:option.label,id:option.id,selected:option.selected}),lastElement?lastElement.after(element):existingParent.element.append(element),lastElement=element);for(index++;existingOptions.length>index;)existingOptions.pop().element.remove()}for(;optionGroupsCache.length>groupIndex;)optionGroupsCache.pop()[0].element.remove()}var match;if(!(match=optionsExp.match(NG_OPTIONS_REGEXP)))throw Error("Expected ngOptions in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '"+optionsExp+"'.");var displayFn=$parse(match[2]||match[1]),valueName=match[4]||match[6],keyName=match[5],groupByFn=$parse(match[3]||""),valueFn=$parse(match[2]?match[1]:valueName),valuesFn=$parse(match[7]),optionGroupsCache=[[{element:selectElement,label:""}]];nullOption&&($compile(nullOption)(scope),nullOption.removeClass("ng-scope"),nullOption.remove()),selectElement.html(""),selectElement.bind("change",function(){scope.$apply(function(){var optionGroup,key,value,optionElement,index,groupIndex,length,groupLength,collection=valuesFn(scope)||[],locals={};if(multiple)for(value=[],groupIndex=0,groupLength=optionGroupsCache.length;groupLength>groupIndex;groupIndex++)for(optionGroup=optionGroupsCache[groupIndex],index=1,length=optionGroup.length;length>index;index++)(optionElement=optionGroup[index].element)[0].selected&&(key=optionElement.val(),keyName&&(locals[keyName]=key),locals[valueName]=collection[key],value.push(valueFn(scope,locals)));else key=selectElement.val(),"?"==key?value=undefined:""==key?value=null:(locals[valueName]=collection[key],keyName&&(locals[keyName]=key),value=valueFn(scope,locals));ctrl.$setViewValue(value)})}),ctrl.$render=render,scope.$watch(render)}if(ctrls[1]){for(var emptyOption,selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,optionsExp=attr.ngOptions,nullOption=!1,optionTemplate=jqLite(document.createElement("option")),optGroupTemplate=jqLite(document.createElement("optgroup")),unknownOption=optionTemplate.clone(),i=0,children=element.children(),ii=children.length;ii>i;i++)if(""==children[i].value){emptyOption=nullOption=children.eq(i);break}if(selectCtrl.init(ngModelCtrl,nullOption,unknownOption),multiple&&(attr.required||attr.ngRequired)){var requiredValidator=function(value){return ngModelCtrl.$setValidity("required",!attr.required||value&&value.length),value};ngModelCtrl.$parsers.push(requiredValidator),ngModelCtrl.$formatters.unshift(requiredValidator),attr.$observe("required",function(){requiredValidator(ngModelCtrl.$viewValue)})}optionsExp?Options(scope,element,ngModelCtrl):multiple?Multiple(scope,element,ngModelCtrl):Single(scope,element,ngModelCtrl,selectCtrl)}}}}],optionDirective=["$interpolate",function($interpolate){var nullSelectCtrl={addOption:noop,removeOption:noop};return{restrict:"E",priority:100,compile:function(element,attr){if(isUndefined(attr.value)){var interpolateFn=$interpolate(element.text(),!0);interpolateFn||attr.$set("value",element.text())}return function(scope,element,attr){var selectCtrlName="$selectController",parent=element.parent(),selectCtrl=parent.data(selectCtrlName)||parent.parent().data(selectCtrlName);selectCtrl&&selectCtrl.databound?element.prop("selected",!1):selectCtrl=nullSelectCtrl,interpolateFn?scope.$watch(interpolateFn,function(newVal,oldVal){attr.$set("value",newVal),newVal!==oldVal&&selectCtrl.removeOption(oldVal),selectCtrl.addOption(newVal)}):selectCtrl.addOption(attr.value),element.bind("$destroy",function(){selectCtrl.removeOption(attr.value)})}}}}],styleDirective=valueFn({restrict:"E",terminal:!0});bindJQuery(),publishExternalAPI(angular),jqLite(document).ready(function(){angularInit(document,bootstrap)})}(window,document),angular.element(document).find("head").append('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak{display:none;}ng\\:form{display:block;}</style>'),function(window,angular,undefined){"use strict";angular.module("ngResource",["ng"]).factory("$resource",["$http","$parse",function($http,$parse){function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,pctEncodeSpaces?"%20":"+")}function Route(template,defaults){this.template=template+="#",this.defaults=defaults||{};var urlParams=this.urlParams={};forEach(template.split(/\W/),function(param){param&&new RegExp("(^|[^\\\\]):"+param+"\\W").test(template)&&(urlParams[param]=!0)}),this.template=template.replace(/\\:/g,":")}function ResourceFactory(url,paramDefaults,actions){function extractParams(data,actionParams){var ids={};return actionParams=extend({},paramDefaults,actionParams),forEach(actionParams,function(value,key){ids[key]=value.charAt&&"@"==value.charAt(0)?getter(data,value.substr(1)):value}),ids}function Resource(value){copy(value||{},this)}var route=new Route(url);return actions=extend({},DEFAULT_ACTIONS,actions),forEach(actions,function(action,name){action.method=angular.uppercase(action.method);var hasBody="POST"==action.method||"PUT"==action.method||"PATCH"==action.method;Resource[name]=function(a1,a2,a3,a4){var data,params={},success=noop,error=null;switch(arguments.length){case 4:error=a4,success=a3;case 3:case 2:if(!isFunction(a2)){params=a1,data=a2,success=a3;break}if(isFunction(a1)){success=a1,error=a2;break}success=a2,error=a3;case 1:isFunction(a1)?success=a1:hasBody?data=a1:params=a1;break;case 0:break;default:throw"Expected between 0-4 arguments [params, data, success, error], got "+arguments.length+" arguments."}var value=this instanceof Resource?this:action.isArray?[]:new Resource(data);return $http({method:action.method,url:route.url(extend({},extractParams(data,action.params||{}),params)),data:data}).then(function(response){var data=response.data;data&&(action.isArray?(value.length=0,forEach(data,function(item){value.push(new Resource(item))})):copy(data,value)),(success||noop)(value,response.headers)},error),value},Resource.prototype["$"+name]=function(a1,a2,a3){var error,params=extractParams(this),success=noop;switch(arguments.length){case 3:params=a1,success=a2,error=a3;break;case 2:case 1:isFunction(a1)?(success=a1,error=a2):(params=a1,success=a2||noop);case 0:break;default:throw"Expected between 1-3 arguments [params, success, error], got "+arguments.length+" arguments."}var data=hasBody?this:undefined;Resource[name].call(this,params,data,success,error)}}),Resource.bind=function(additionalParamDefaults){return ResourceFactory(url,extend({},paramDefaults,additionalParamDefaults),actions)},Resource}var DEFAULT_ACTIONS={get:{method:"GET"},save:{method:"POST"},query:{method:"GET",isArray:!0},remove:{method:"DELETE"},"delete":{method:"DELETE"}},noop=angular.noop,forEach=angular.forEach,extend=angular.extend,copy=angular.copy,isFunction=angular.isFunction,getter=function(obj,path){return $parse(path)(obj)};return Route.prototype={url:function(params){var val,encodedVal,self=this,url=this.template;params=params||{},forEach(this.urlParams,function(_,urlParam){val=params.hasOwnProperty(urlParam)?params[urlParam]:self.defaults[urlParam],angular.isDefined(val)&&null!==val?(encodedVal=encodeUriSegment(val),url=url.replace(new RegExp(":"+urlParam+"(\\W)","g"),encodedVal+"$1")):url=url.replace(new RegExp("(/?):"+urlParam+"(\\W)","g"),function(match,leadingSlashes,tail){return"/"==tail.charAt(0)?tail:leadingSlashes+tail})}),url=url.replace(/\/?#$/,"");var query=[];return forEach(params,function(value,key){self.urlParams[key]||query.push(encodeUriQuery(key)+"="+encodeUriQuery(value))}),query.sort(),url=url.replace(/\/*$/,""),url+(query.length?"?"+query.join("&"):"")}},ResourceFactory}])}(window,window.angular),function(window,angular,undefined){"use strict";angular.module("ngCookies",["ng"]).factory("$cookies",["$rootScope","$browser",function($rootScope,$browser){function push(){var name,value,browserCookies,updated;for(name in lastCookies)isUndefined(cookies[name])&&$browser.cookies(name,undefined);for(name in cookies)value=cookies[name],angular.isString(value)?value!==lastCookies[name]&&($browser.cookies(name,value),updated=!0):angular.isDefined(lastCookies[name])?cookies[name]=lastCookies[name]:delete cookies[name];if(updated){updated=!1,browserCookies=$browser.cookies();for(name in cookies)cookies[name]!==browserCookies[name]&&(isUndefined(browserCookies[name])?delete cookies[name]:cookies[name]=browserCookies[name],updated=!0)}}var lastBrowserCookies,cookies={},lastCookies={},runEval=!1,copy=angular.copy,isUndefined=angular.isUndefined;return $browser.addPollFn(function(){var currentCookies=$browser.cookies();lastBrowserCookies!=currentCookies&&(lastBrowserCookies=currentCookies,copy(currentCookies,lastCookies),copy(currentCookies,cookies),runEval&&$rootScope.$apply())})(),runEval=!0,$rootScope.$watch(push),cookies}]).factory("$cookieStore",["$cookies",function($cookies){return{get:function(key){var value=$cookies[key];return value?angular.fromJson(value):value},put:function(key,value){$cookies[key]=angular.toJson(value)},remove:function(key){delete $cookies[key]}}}])}(window,window.angular),function(window,angular){"use strict";var directive={};directive.dropdownToggle=["$document","$location","$window",function($document,$location){var close,openElement=null;return{restrict:"C",link:function(scope,element){scope.$watch(function(){return $location.path()},function(){close&&close()}),element.parent().bind("click",function(){close&&close()}),element.bind("click",function(event){event.preventDefault(),event.stopPropagation();var iWasOpen=!1;openElement&&(iWasOpen=openElement===element,close()),iWasOpen||(element.parent().addClass("open"),openElement=element,close=function(event){event&&event.preventDefault(),event&&event.stopPropagation(),$document.unbind("click",close),element.parent().removeClass("open"),close=null,openElement=null},$document.bind("click",close))})}}}],directive.tabbable=function(){return{restrict:"C",compile:function(element){var navTabs=angular.element('<ul class="nav nav-tabs"></ul>'),tabContent=angular.element('<div class="tab-content"></div>');tabContent.append(element.contents()),element.append(navTabs).append(tabContent)},controller:["$scope","$element",function($scope,$element){var selectedTab,navTabs=$element.contents().eq(0),ngModel=$element.controller("ngModel")||{},tabs=[];ngModel.$render=function(){var $viewValue=this.$viewValue;if((selectedTab?selectedTab.value!=$viewValue:$viewValue)&&(selectedTab&&(selectedTab.paneElement.removeClass("active"),selectedTab.tabElement.removeClass("active"),selectedTab=null),$viewValue)){for(var i=0,ii=tabs.length;ii>i;i++)if($viewValue==tabs[i].value){selectedTab=tabs[i];break}selectedTab&&(selectedTab.paneElement.addClass("active"),selectedTab.tabElement.addClass("active"))}},this.addPane=function(element,attr){function update(){tab.title=attr.title,tab.value=attr.value||attr.title,ngModel.$setViewValue||ngModel.$viewValue&&tab!=selectedTab||(ngModel.$viewValue=tab.value),ngModel.$render()}var li=angular.element("<li><a href></a></li>"),a=li.find("a"),tab={paneElement:element,paneAttrs:attr,tabElement:li};return tabs.push(tab),attr.$observe("value",update)(),attr.$observe("title",function(){update(),a.text(tab.title)})(),navTabs.append(li),li.bind("click",function(event){event.preventDefault(),event.stopPropagation(),ngModel.$setViewValue?$scope.$apply(function(){ngModel.$setViewValue(tab.value),ngModel.$render()}):(ngModel.$viewValue=tab.value,ngModel.$render())}),function(){tab.tabElement.remove();for(var i=0,ii=tabs.length;ii>i;i++)tab==tabs[i]&&tabs.splice(i,1)}}}]}},directive.table=function(){return{restrict:"E",link:function(scope,element){element[0].className="table table-bordered table-striped code-table"}}},directive.tabPane=function(){return{require:"^tabbable",restrict:"C",link:function(scope,element,attrs,tabsCtrl){element.bind("$remove",tabsCtrl.addPane(element,attrs))}}},angular.module("bootstrap",[]).directive(directive)}(window,window.angular),angular.module("templates",[]),angular.module("ngUpload",[]).directive("uploadSubmit",["$parse",function(){function getParentNodeByTagName(element,tagName){element=angular.element(element);var parent=element.parent();return tagName=tagName.toLowerCase(),parent&&parent[0].tagName.toLowerCase()===tagName?parent:parent?getParentNodeByTagName(parent,tagName):null}return{restrict:"AC",link:function(scope,element){element.bind("click",function($event){if($event&&($event.preventDefault(),$event.stopPropagation()),!element.attr("disabled")){var form=getParentNodeByTagName(element,"form");form.triggerHandler("submit"),form[0].submit()}})}}}]).directive("ngUpload",["$log","$parse","$document",function($log,$parse,$document){function getMetaTagWithName(name){var match,head=$document.find("head");return angular.forEach(head.find("meta"),function(element){element.getAttribute("name")===name&&(match=element)}),angular.element(match)}var iframeID=1;return{restrict:"AC",link:function(scope,element,attrs){function setLoadingState(state){scope.$isUploading=state}function uploadEnd(){iframe.unbind("load"),scope.$$phase?setLoadingState(!1):scope.$apply(function(){setLoadingState(!1)});var content,bodyContent=(iframe[0].contentDocument||iframe[0].contentWindow.document).body;try{content=angular.fromJson(bodyContent.innerText||bodyContent.textContent)}catch(e){content=bodyContent.innerHTML,$log.warn("Response is not valid JSON")}scope.$$phase?fn(scope,{content:content}):scope.$apply(function(){fn(scope,{content:content})})}iframeID++;var options={},fn=attrs.ngUpload?$parse(attrs.ngUpload):null,loading=attrs.ngUploadLoading?$parse(attrs.ngUploadLoading):null;attrs.hasOwnProperty("uploadOptionsConvertHidden")&&(options.convertHidden="false"!=attrs.uploadOptionsConvertHidden),attrs.hasOwnProperty("uploadOptionsEnableRailsCsrf")&&(options.enableRailsCsrf="false"!=attrs.uploadOptionsEnableRailsCsrf),attrs.hasOwnProperty("uploadOptionsBeforeSubmit")&&(options.beforeSubmit=$parse(attrs.uploadOptionsBeforeSubmit)),element.attr({target:"upload-iframe-"+iframeID,method:"post",enctype:"multipart/form-data",encoding:"multipart/form-data"});var iframe=angular.element('<iframe name="upload-iframe-'+iframeID+'" '+'border="0" width="0" height="0" '+'style="width:0px;height:0px;border:none;display:none">');if(options.enableRailsCsrf){var input=angular.element("<input />");input.attr("class","upload-csrf-token"),input.attr("type","hidden"),input.attr("name",getMetaTagWithName("csrf-param").attr("content")),input.val(getMetaTagWithName("csrf-token").attr("content")),element.append(input)}element.after(iframe),setLoadingState(!1),element.bind("submit",function(){var formController=scope[attrs.name];return formController&&formController.$invalid?!1:options.beforeSubmit?options.beforeSubmit():(iframe.bind("load",uploadEnd),options.convertHidden&&angular.forEach(element.find("input"),function(el){var _el=angular.element(el);_el.attr("ng-model")&&_el.attr("type")&&"hidden"==_el.attr("type")&&_el.attr("value",scope.$eval(_el.attr("ng-model")))}),scope.$$phase?(loading&&loading(scope),setLoadingState(!0)):scope.$apply(function(){loading&&loading(scope),setLoadingState(!0)}),void 0)})}}}]),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dialog","ui.bootstrap.dropdownToggle","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/popup.html","template/dialog/message.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset-titles.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function($q,$timeout,$rootScope){function findEndEventName(endEventNames){for(var name in endEventNames)if(void 0!==transElement.style[name])return endEventNames[name]}var $transition=function(element,trigger,options){options=options||{};var deferred=$q.defer(),endEventName=$transition[options.animation?"animationEndEventName":"transitionEndEventName"],transitionEndHandler=function(){$rootScope.$apply(function(){element.unbind(endEventName,transitionEndHandler),deferred.resolve(element)})};return endEventName&&element.bind(endEventName,transitionEndHandler),$timeout(function(){angular.isString(trigger)?element.addClass(trigger):angular.isFunction(trigger)?trigger(element):angular.isObject(trigger)&&element.css(trigger),endEventName||deferred.resolve(element)}),deferred.promise.cancel=function(){endEventName&&element.unbind(endEventName,transitionEndHandler),deferred.reject("Transition cancelled")},deferred.promise},transElement=document.createElement("trans"),transitionEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},animationEndEventNames={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return $transition.transitionEndEventName=findEndEventName(transitionEndEventNames),$transition.animationEndEventName=findEndEventName(animationEndEventNames),$transition}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function($transition){var fixUpHeight=function(scope,element,height){element.removeClass("collapse"),element.css({height:height}),element[0].offsetWidth,element.addClass("collapse")};return{link:function(scope,element,attrs){var isCollapsed,initialAnimSkip=!0;scope.$watch(function(){return element[0].scrollHeight},function(){0!==element[0].scrollHeight&&(isCollapsed||(initialAnimSkip?fixUpHeight(scope,element,element[0].scrollHeight+"px"):fixUpHeight(scope,element,"auto")))}),scope.$watch(attrs.collapse,function(value){value?collapse():expand()});var currentTransition,doTransition=function(change){return currentTransition&&currentTransition.cancel(),currentTransition=$transition(element,change),currentTransition.then(function(){currentTransition=void 0},function(){currentTransition=void 0}),currentTransition},expand=function(){initialAnimSkip?(initialAnimSkip=!1,isCollapsed||fixUpHeight(scope,element,"auto")):doTransition({height:element[0].scrollHeight+"px"}).then(function(){isCollapsed||fixUpHeight(scope,element,"auto")}),isCollapsed=!1},collapse=function(){isCollapsed=!0,initialAnimSkip?(initialAnimSkip=!1,fixUpHeight(scope,element,0)):(fixUpHeight(scope,element,element[0].scrollHeight+"px"),doTransition({height:"0"}))}}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function($scope,$attrs,accordionConfig){this.groups=[],this.closeOthers=function(openGroup){var closeOthers=angular.isDefined($attrs.closeOthers)?$scope.$eval($attrs.closeOthers):accordionConfig.closeOthers;closeOthers&&angular.forEach(this.groups,function(group){group!==openGroup&&(group.isOpen=!1)})},this.addGroup=function(groupScope){var that=this;this.groups.push(groupScope),groupScope.$on("$destroy",function(){that.removeGroup(groupScope)})},this.removeGroup=function(group){var index=this.groups.indexOf(group);-1!==index&&this.groups.splice(this.groups.indexOf(group),1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",["$parse","$transition","$timeout",function($parse){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@"},controller:["$scope",function(){this.setHeading=function(element){this.heading=element}}],link:function(scope,element,attrs,accordionCtrl){var getIsOpen,setIsOpen;accordionCtrl.addGroup(scope),scope.isOpen=!1,attrs.isOpen&&(getIsOpen=$parse(attrs.isOpen),setIsOpen=getIsOpen.assign,scope.$watch(function(){return getIsOpen(scope.$parent)},function(value){scope.isOpen=value}),scope.isOpen=getIsOpen?getIsOpen(scope.$parent):!1),scope.$watch("isOpen",function(value){value&&accordionCtrl.closeOthers(scope),setIsOpen&&setIsOpen(scope.$parent,value)})}}}]).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",compile:function(element,attr,transclude){return function(scope,element,attr,accordionGroupCtrl){accordionGroupCtrl.setHeading(transclude(scope,function(){}))}}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(scope,element,attr,controller){scope.$watch(function(){return controller[attr.accordionTransclude]},function(heading){heading&&(element.html(""),element.append(heading))})}}}),angular.module("ui.bootstrap.alert",[]).directive("alert",function(){return{restrict:"EA",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"=",close:"&"},link:function(scope,iElement,iAttrs){scope.closeable="close"in iAttrs}}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).directive("btnRadio",["buttonConfig",function(buttonConfig){var activeClass=buttonConfig.activeClass||"active",toggleEvent=buttonConfig.toggleEvent||"click";return{require:"ngModel",link:function(scope,element,attrs,ngModelCtrl){ngModelCtrl.$render=function(){element.toggleClass(activeClass,angular.equals(ngModelCtrl.$modelValue,scope.$eval(attrs.btnRadio)))},element.bind(toggleEvent,function(){element.hasClass(activeClass)||scope.$apply(function(){ngModelCtrl.$setViewValue(scope.$eval(attrs.btnRadio)),ngModelCtrl.$render()})})}}}]).directive("btnCheckbox",["buttonConfig",function(buttonConfig){var activeClass=buttonConfig.activeClass||"active",toggleEvent=buttonConfig.toggleEvent||"click";
return{require:"ngModel",link:function(scope,element,attrs,ngModelCtrl){function getTrueValue(){var trueValue=scope.$eval(attrs.btnCheckboxTrue);return angular.isDefined(trueValue)?trueValue:!0}function getFalseValue(){var falseValue=scope.$eval(attrs.btnCheckboxFalse);return angular.isDefined(falseValue)?falseValue:!1}ngModelCtrl.$render=function(){element.toggleClass(activeClass,angular.equals(ngModelCtrl.$modelValue,getTrueValue()))},element.bind(toggleEvent,function(){scope.$apply(function(){ngModelCtrl.$setViewValue(element.hasClass(activeClass)?getFalseValue():getTrueValue()),ngModelCtrl.$render()})})}}}]),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition","$q",function($scope,$timeout,$transition){function restartTimer(){function go(){isPlaying?($scope.next(),restartTimer()):$scope.pause()}currentTimeout&&$timeout.cancel(currentTimeout);var interval=+$scope.interval;!isNaN(interval)&&interval>=0&&(currentTimeout=$timeout(go,interval))}var currentTimeout,isPlaying,self=this,slides=self.slides=[],currentIndex=-1;self.currentSlide=null,self.select=function(nextSlide,direction){function goNext(){self.currentSlide&&angular.isString(direction)&&!$scope.noTransition&&nextSlide.$element?(nextSlide.$element.addClass(direction),nextSlide.$element[0].offsetWidth,angular.forEach(slides,function(slide){angular.extend(slide,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(nextSlide,{direction:direction,active:!0,entering:!0}),angular.extend(self.currentSlide||{},{direction:direction,leaving:!0}),$scope.$currentTransition=$transition(nextSlide.$element,{}),function(next,current){$scope.$currentTransition.then(function(){transitionDone(next,current)},function(){transitionDone(next,current)})}(nextSlide,self.currentSlide)):transitionDone(nextSlide,self.currentSlide),self.currentSlide=nextSlide,currentIndex=nextIndex,restartTimer()}function transitionDone(next,current){angular.extend(next,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(current||{},{direction:"",active:!1,leaving:!1,entering:!1}),$scope.$currentTransition=null}var nextIndex=slides.indexOf(nextSlide);self.slides.length>1&&void 0===direction&&(direction=nextIndex>currentIndex?"next":"prev"),nextSlide&&nextSlide!==self.currentSlide&&($scope.$currentTransition?($scope.$currentTransition.cancel(),$timeout(goNext)):goNext())},self.indexOfSlide=function(slide){return slides.indexOf(slide)},$scope.next=function(){var newIndex=(currentIndex+1)%slides.length;return $scope.$currentTransition?void 0:self.select(slides[newIndex],"next")},$scope.prev=function(){var newIndex=0>currentIndex-1?slides.length-1:currentIndex-1;return $scope.$currentTransition?void 0:self.select(slides[newIndex],"prev")},$scope.select=function(slide){self.select(slide)},$scope.isActive=function(slide){return self.currentSlide===slide},$scope.slides=function(){return slides},$scope.$watch("interval",restartTimer),$scope.play=function(){isPlaying||(isPlaying=!0,restartTimer())},$scope.pause=function(){$scope.noPause||(isPlaying=!1,currentTimeout&&$timeout.cancel(currentTimeout))},self.addSlide=function(slide,element){slide.$element=element,slides.push(slide),1===slides.length||slide.active?(self.select(slides[slides.length-1]),1==slides.length&&$scope.play()):slide.active=!1},self.removeSlide=function(slide){var index=slides.indexOf(slide);slides.splice(index,1),slides.length>0&&slide.active?index>=slides.length?self.select(slides[index-1]):self.select(slides[index]):currentIndex>index&&currentIndex--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",["$parse",function($parse){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{},link:function(scope,element,attrs,carouselCtrl){if(attrs.active){var getActive=$parse(attrs.active),setActive=getActive.assign,lastValue=scope.active=getActive(scope.$parent);scope.$watch(function(){var parentActive=getActive(scope.$parent);return parentActive!==scope.active&&(parentActive!==lastValue?lastValue=scope.active=parentActive:setActive(scope.$parent,parentActive=lastValue=scope.active)),parentActive})}carouselCtrl.addSlide(scope,element),scope.$on("$destroy",function(){carouselCtrl.removeSlide(scope)}),scope.$watch("active",function(active){active&&carouselCtrl.select(scope)})}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function($document,$window){function getStyle(el,cssprop){return el.currentStyle?el.currentStyle[cssprop]:$window.getComputedStyle?$window.getComputedStyle(el)[cssprop]:el.style[cssprop]}function isStaticPositioned(element){return"static"===(getStyle(element,"position")||"static")}var parentOffsetEl=function(element){for(var docDomEl=$document[0],offsetParent=element.offsetParent||docDomEl;offsetParent&&offsetParent!==docDomEl&&isStaticPositioned(offsetParent);)offsetParent=offsetParent.offsetParent;return offsetParent||docDomEl};return{position:function(element){var elBCR=this.offset(element),offsetParentBCR={top:0,left:0},offsetParentEl=parentOffsetEl(element[0]);return offsetParentEl!=$document[0]&&(offsetParentBCR=this.offset(angular.element(offsetParentEl)),offsetParentBCR.top+=offsetParentEl.clientTop-offsetParentEl.scrollTop,offsetParentBCR.left+=offsetParentEl.clientLeft-offsetParentEl.scrollLeft),{width:element.prop("offsetWidth"),height:element.prop("offsetHeight"),top:elBCR.top-offsetParentBCR.top,left:elBCR.left-offsetParentBCR.left}},offset:function(element){var boundingClientRect=element[0].getBoundingClientRect();return{width:element.prop("offsetWidth"),height:element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||$document[0].body.scrollTop),left:boundingClientRect.left+($window.pageXOffset||$document[0].body.scrollLeft)}}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.position"]).constant("datepickerConfig",{dayFormat:"dd",monthFormat:"MMMM",yearFormat:"yyyy",dayHeaderFormat:"EEE",dayTitleFormat:"MMMM yyyy",monthTitleFormat:"yyyy",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","dateFilter","datepickerConfig",function($scope,$attrs,dateFilter,dtConfig){function getValue(value,defaultValue){return angular.isDefined(value)?$scope.$parent.$eval(value):defaultValue}function getDaysInMonth(year,month){return new Date(year,month,0).getDate()}function getDates(startDate,n){for(var dates=new Array(n),current=startDate,i=0;n>i;)dates[i++]=new Date(current),current.setDate(current.getDate()+1);return dates}function makeDate(date,format,isSelected,isSecondary){return{date:date,label:dateFilter(date,format),selected:!!isSelected,secondary:!!isSecondary}}var format={day:getValue($attrs.dayFormat,dtConfig.dayFormat),month:getValue($attrs.monthFormat,dtConfig.monthFormat),year:getValue($attrs.yearFormat,dtConfig.yearFormat),dayHeader:getValue($attrs.dayHeaderFormat,dtConfig.dayHeaderFormat),dayTitle:getValue($attrs.dayTitleFormat,dtConfig.dayTitleFormat),monthTitle:getValue($attrs.monthTitleFormat,dtConfig.monthTitleFormat)},startingDay=getValue($attrs.startingDay,dtConfig.startingDay),yearRange=getValue($attrs.yearRange,dtConfig.yearRange);this.minDate=dtConfig.minDate?new Date(dtConfig.minDate):null,this.maxDate=dtConfig.maxDate?new Date(dtConfig.maxDate):null,this.modes=[{name:"day",getVisibleDates:function(date,selected){var year=date.getFullYear(),month=date.getMonth(),firstDayOfMonth=new Date(year,month,1),difference=startingDay-firstDayOfMonth.getDay(),numDisplayedFromPreviousMonth=difference>0?7-difference:-difference,firstDate=new Date(firstDayOfMonth),numDates=0;numDisplayedFromPreviousMonth>0&&(firstDate.setDate(-numDisplayedFromPreviousMonth+1),numDates+=numDisplayedFromPreviousMonth),numDates+=getDaysInMonth(year,month+1),numDates+=(7-numDates%7)%7;for(var days=getDates(firstDate,numDates),labels=new Array(7),i=0;numDates>i;i++){var dt=new Date(days[i]);days[i]=makeDate(dt,format.day,selected&&selected.getDate()===dt.getDate()&&selected.getMonth()===dt.getMonth()&&selected.getFullYear()===dt.getFullYear(),dt.getMonth()!==month)}for(var j=0;7>j;j++)labels[j]=dateFilter(days[j].date,format.dayHeader);return{objects:days,title:dateFilter(date,format.dayTitle),labels:labels}},compare:function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth(),date1.getDate())-new Date(date2.getFullYear(),date2.getMonth(),date2.getDate())},split:7,step:{months:1}},{name:"month",getVisibleDates:function(date,selected){for(var months=new Array(12),year=date.getFullYear(),i=0;12>i;i++){var dt=new Date(year,i,1);months[i]=makeDate(dt,format.month,selected&&selected.getMonth()===i&&selected.getFullYear()===year)}return{objects:months,title:dateFilter(date,format.monthTitle)}},compare:function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth())-new Date(date2.getFullYear(),date2.getMonth())},split:3,step:{years:1}},{name:"year",getVisibleDates:function(date,selected){for(var years=new Array(yearRange),year=date.getFullYear(),startYear=parseInt((year-1)/yearRange,10)*yearRange+1,i=0;yearRange>i;i++){var dt=new Date(startYear+i,0,1);years[i]=makeDate(dt,format.year,selected&&selected.getFullYear()===dt.getFullYear())}return{objects:years,title:[years[0].label,years[yearRange-1].label].join(" - ")}},compare:function(date1,date2){return date1.getFullYear()-date2.getFullYear()},split:5,step:{years:yearRange}}],this.isDisabled=function(date,mode){var currentMode=this.modes[mode||0];return this.minDate&&currentMode.compare(date,this.minDate)<0||this.maxDate&&currentMode.compare(date,this.maxDate)>0||$scope.dateDisabled&&$scope.dateDisabled({date:date,mode:currentMode.name})}}]).directive("datepicker",["dateFilter","$parse","datepickerConfig","$log",function(dateFilter,$parse,datepickerConfig){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(scope,element,attrs,ctrls){function updateShowWeekNumbers(){scope.showWeekNumbers=0===mode&&showWeeks}function split(arr,size){for(var arrays=[];arr.length>0;)arrays.push(arr.splice(0,size));return arrays}function refill(updateSelected){var date=null,valid=!0;ngModel.$modelValue&&(date=new Date(ngModel.$modelValue),isNaN(date)?valid=!1:updateSelected&&(selected=date)),ngModel.$setValidity("date",valid);var currentMode=datepickerCtrl.modes[mode],data=currentMode.getVisibleDates(selected,date);angular.forEach(data.objects,function(obj){obj.disabled=datepickerCtrl.isDisabled(obj.date,mode)}),ngModel.$setValidity("date-disabled",!date||!datepickerCtrl.isDisabled(date)),scope.rows=split(data.objects,currentMode.split),scope.labels=data.labels||[],scope.title=data.title}function setMode(value){mode=value,updateShowWeekNumbers(),refill()}function getISO8601WeekNumber(date){var checkDate=new Date(date);checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();return checkDate.setMonth(0),checkDate.setDate(1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1}var datepickerCtrl=ctrls[0],ngModel=ctrls[1];if(ngModel){var mode=0,selected=new Date,showWeeks=datepickerConfig.showWeeks;attrs.showWeeks?scope.$parent.$watch($parse(attrs.showWeeks),function(value){showWeeks=!!value,updateShowWeekNumbers()}):updateShowWeekNumbers(),attrs.min&&scope.$parent.$watch($parse(attrs.min),function(value){datepickerCtrl.minDate=value?new Date(value):null,refill()}),attrs.max&&scope.$parent.$watch($parse(attrs.max),function(value){datepickerCtrl.maxDate=value?new Date(value):null,refill()}),ngModel.$render=function(){refill(!0)},scope.select=function(date){if(0===mode){var dt=new Date(ngModel.$modelValue);dt.setFullYear(date.getFullYear(),date.getMonth(),date.getDate()),ngModel.$setViewValue(dt),refill(!0)}else selected=date,setMode(mode-1)},scope.move=function(direction){var step=datepickerCtrl.modes[mode].step;selected.setMonth(selected.getMonth()+direction*(step.months||0)),selected.setFullYear(selected.getFullYear()+direction*(step.years||0)),refill()},scope.toggleMode=function(){setMode((mode+1)%datepickerCtrl.modes.length)},scope.getWeekNumber=function(row){return 0===mode&&scope.showWeekNumbers&&7===row.length?getISO8601WeekNumber(row[0].date):null}}}}}]).constant("datepickerPopupConfig",{dateFormat:"yyyy-MM-dd",closeOnDateSelection:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","datepickerPopupConfig",function($compile,$parse,$document,$position,dateFilter,datepickerPopupConfig){return{restrict:"EA",require:"ngModel",link:function(originalScope,element,attrs,ngModel){function formatDate(value){return value?dateFilter(value,dateFormat):null}function parseDate(value){if(value){if(value.match(/\d+\/\d*\//))var date=moment(value,"DD/MM/YYYY").toDate();else var date=new Date(value);if(!isNaN(date))return date}return value}function setOpen(value){setIsOpen?setIsOpen(originalScope,!!value):scope.isOpen=!!value}function addWatchableAttribute(attribute,scopeProperty,datepickerAttribute){attribute&&(originalScope.$watch($parse(attribute),function(value){scope[scopeProperty]=value}),datepickerEl.attr(datepickerAttribute||scopeProperty,scopeProperty))}function updatePosition(){scope.position=$position.position(element),scope.position.top=scope.position.top+element.prop("offsetHeight"),scope.position.left+380>window.innerWidth&&(scope.position.left=window.innerWidth-380)}var closeOnDateSelection=angular.isDefined(attrs.closeOnDateSelection)?scope.$eval(attrs.closeOnDateSelection):datepickerPopupConfig.closeOnDateSelection,dateFormat=attrs.datepickerPopup||datepickerPopupConfig.dateFormat,scope=originalScope.$new();originalScope.$on("$destroy",function(){scope.$destroy()}),ngModel.$formatters.push(formatDate),ngModel.$parsers.push(parseDate);var getIsOpen,setIsOpen;attrs.isOpen&&(getIsOpen=$parse(attrs.isOpen),setIsOpen=getIsOpen.assign,originalScope.$watch(getIsOpen,function(value){scope.isOpen=!!value})),scope.isOpen=getIsOpen?getIsOpen(originalScope):!1;var documentClickBind=function(event){scope.isOpen&&event.target!==element[0]&&scope.$apply(function(){setOpen(!1)})},elementFocusBind=function(){scope.$apply(function(){setOpen(!0)})},popupEl=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");popupEl.attr({"ng-model":"date","ng-change":"dateSelection()"});var datepickerEl=popupEl.find("div");attrs.datepickerOptions&&datepickerEl.attr(angular.extend({},originalScope.$eval(attrs.datepickerOptions)));var $setModelValue=$parse(attrs.ngModel).assign;scope.dateSelection=function(){$setModelValue(originalScope,scope.date),closeOnDateSelection&&setOpen(!1)},scope.$watch(function(){return ngModel.$modelValue},function(value){if(angular.isString(value)){var date=parseDate(value);if(value&&!date)throw $setModelValue(originalScope,null),new Error(value+" cannot be parsed to a date object.");value=date}scope.date=value,updatePosition()}),addWatchableAttribute(attrs.min,"min"),addWatchableAttribute(attrs.max,"max"),attrs.showWeeks?addWatchableAttribute(attrs.showWeeks,"showWeeks","show-weeks"):(scope.showWeeks=!0,datepickerEl.attr("show-weeks","showWeeks")),attrs.dateDisabled&&datepickerEl.attr("date-disabled",attrs.dateDisabled);var documentBindingInitialized=!1,elementFocusInitialized=!1;scope.$watch("isOpen",function(value){value?(updatePosition(),$document.bind("click",documentClickBind),elementFocusInitialized&&element.unbind("click",elementFocusBind),element[0].focus(),documentBindingInitialized=!0):(documentBindingInitialized&&$document.unbind("click",documentClickBind),element.bind("click",elementFocusBind),elementFocusInitialized=!0),setIsOpen&&setIsOpen(originalScope,value)}),scope.today=function(){$setModelValue(originalScope,new Date)},scope.clear=function(){$setModelValue(originalScope,null)},element.after($compile(popupEl)(scope))}}}]).directive("datepickerPopupWrap",[function(){return{restrict:"AE",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(scope,element){element.bind("click",function(event){event.preventDefault(),event.stopPropagation()})}}}]);var dialogModule=angular.module("ui.bootstrap.dialog",["ui.bootstrap.transition"]);dialogModule.controller("MessageBoxController",["$scope","dialog","model",function($scope,dialog,model){$scope.title=model.title,$scope.message=model.message,$scope.buttons=model.buttons,$scope.close=function(res){dialog.close(res)}}]),dialogModule.provider("$dialog",function(){var defaults={backdrop:!0,dialogClass:"modal",backdropClass:"modal-backdrop",transitionClass:"fade",triggerClass:"in",dialogOpenClass:"modal-open",resolve:{},backdropFade:!1,dialogFade:!1,keyboard:!0,backdropClick:!0},globalOptions={},activeBackdrops={value:0};this.options=function(value){globalOptions=value},this.$get=["$http","$document","$compile","$rootScope","$controller","$templateCache","$q","$transition","$injector",function($http,$document,$compile,$rootScope,$controller,$templateCache,$q,$transition,$injector){function createElement(clazz){var el=angular.element("<div>");return el.addClass(clazz),el}function Dialog(opts){var self=this,options=this.options=angular.extend({},defaults,globalOptions,opts);this._open=!1,this.backdropEl=createElement(options.backdropClass),options.backdropFade&&(this.backdropEl.addClass(options.transitionClass),this.backdropEl.removeClass(options.triggerClass)),this.modalEl=createElement(options.dialogClass),options.dialogFade&&(this.modalEl.addClass(options.transitionClass),this.modalEl.removeClass(options.triggerClass)),this.handledEscapeKey=function(e){27===e.which&&(self.close(),e.preventDefault(),self.$scope.$apply())},this.handleBackDropClick=function(e){self.close(),e.preventDefault(),self.$scope.$apply()}}var body=$document.find("body");return Dialog.prototype.isOpen=function(){return this._open},Dialog.prototype.open=function(templateUrl,controller){var self=this,options=this.options;if(templateUrl&&(options.templateUrl=templateUrl),controller&&(options.controller=controller),!options.template&&!options.templateUrl)throw new Error("Dialog.open expected template or templateUrl, neither found. Use options or open method to specify them.");return this._loadResolves().then(function(locals){var $scope=locals.$scope=self.$scope=locals.$scope?locals.$scope:$rootScope.$new();if(self.modalEl.html(locals.$template),self.options.controller){var ctrl=$controller(self.options.controller,locals);self.modalEl.children().data("ngControllerController",ctrl)}$compile(self.modalEl)($scope),self._addElementsToDom(),setTimeout(function(){self.options.dialogFade&&self.modalEl.addClass(self.options.triggerClass),self.options.backdropFade&&self.backdropEl.addClass(self.options.triggerClass)}),body.addClass(defaults.dialogOpenClass),self._bindEvents()}),this.deferred=$q.defer(),this.deferred.promise},Dialog.prototype.close=function(result){function removeTriggerClass(el){el.removeClass(self.options.triggerClass)}function onCloseComplete(){self._open&&self._onCloseComplete(result)}var self=this,fadingElements=this._getFadingElements();if(fadingElements.length>0)for(var i=fadingElements.length-1;i>=0;i--)$transition(fadingElements[i],removeTriggerClass).then(onCloseComplete);else this._onCloseComplete(result)},Dialog.prototype._getFadingElements=function(){var elements=[];return this.options.dialogFade&&elements.push(this.modalEl),this.options.backdropFade&&elements.push(this.backdropEl),elements},Dialog.prototype._bindEvents=function(){this.options.keyboard&&body.bind("keydown",this.handledEscapeKey),this.options.backdrop&&this.options.backdropClick&&this.backdropEl.bind("click",this.handleBackDropClick)},Dialog.prototype._unbindEvents=function(){this.options.keyboard&&body.unbind("keydown",this.handledEscapeKey),this.options.backdrop&&this.options.backdropClick&&this.backdropEl.unbind("click",this.handleBackDropClick)},Dialog.prototype._onCloseComplete=function(result){this._removeElementsFromDom(),this._unbindEvents(),body.removeClass(defaults.dialogOpenClass),this.deferred.resolve(result)},Dialog.prototype._addElementsToDom=function(){body.append(this.modalEl),this.options.backdrop&&(0===activeBackdrops.value&&body.append(this.backdropEl),activeBackdrops.value++),this._open=!0},Dialog.prototype._removeElementsFromDom=function(){this.modalEl.remove(),this.options.backdrop&&(activeBackdrops.value--,0===activeBackdrops.value&&this.backdropEl.remove()),this._open=!1},Dialog.prototype._loadResolves=function(){var templatePromise,values=[],keys=[],self=this;return this.options.template?templatePromise=$q.when(this.options.template):this.options.templateUrl&&(templatePromise=$http.get(this.options.templateUrl,{cache:$templateCache}).then(function(response){return response.data})),angular.forEach(this.options.resolve||[],function(value,key){keys.push(key),values.push(angular.isString(value)?$injector.get(value):$injector.invoke(value))}),keys.push("$template"),values.push(templatePromise),$q.all(values).then(function(values){var locals={};return angular.forEach(values,function(value,index){locals[keys[index]]=value}),locals.dialog=self,locals})},{dialog:function(opts){return new Dialog(opts)},messageBox:function(title,message,buttons){return new Dialog({templateUrl:"template/dialog/message.html",controller:"MessageBoxController",resolve:{model:function(){return{title:title,message:message,buttons:buttons}}}})}}}]}),angular.module("ui.bootstrap.dropdownToggle",[]).directive("dropdownToggle",["$document","$location",function($document){var openElement=null,closeMenu=angular.noop;return{restrict:"CA",link:function(scope,element){scope.$watch("$location.path",function(){closeMenu()}),element.parent().bind("click",function(){closeMenu()}),element.bind("click",function(event){var elementWasOpen=element===openElement;event.preventDefault(),event.stopPropagation(),openElement&&closeMenu(),elementWasOpen||(element.parent().addClass("open"),openElement=element,closeMenu=function(event){event&&(event.preventDefault(),event.stopPropagation()),$document.unbind("click",closeMenu),element.parent().removeClass("open"),closeMenu=angular.noop,openElement=null},$document.bind("click",closeMenu))})}}}]),angular.module("ui.bootstrap.modal",["ui.bootstrap.dialog"]).directive("modal",["$parse","$dialog",function($parse,$dialog){return{restrict:"EA",terminal:!0,link:function(scope,elm,attrs){var setClosed,opts=angular.extend({},scope.$eval(attrs.uiOptions||attrs.bsOptions||attrs.options)),shownExpr=attrs.modal||attrs.show;opts=angular.extend(opts,{template:elm.html(),resolve:{$scope:function(){return scope}}});var dialog=$dialog.dialog(opts);elm.remove(),setClosed=attrs.close?function(){$parse(attrs.close)(scope)}:function(){angular.isFunction($parse(shownExpr).assign)&&$parse(shownExpr).assign(scope,!1)},scope.$watch(shownExpr,function(isShown){isShown?dialog.open().then(function(){setClosed()}):dialog.isOpen()&&dialog.close()})}}}]),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$interpolate",function($scope,$interpolate){this.currentPage=1,this.noPrevious=function(){return 1===this.currentPage},this.noNext=function(){return this.currentPage===$scope.numPages},this.isActive=function(page){return this.currentPage===page},this.reset=function(){$scope.pages=[],this.currentPage=parseInt($scope.currentPage,10),this.currentPage>$scope.numPages&&$scope.selectPage($scope.numPages)};var self=this;$scope.selectPage=function(page){!self.isActive(page)&&page>0&&page<=$scope.numPages&&($scope.currentPage=page,$scope.onSelectPage({page:page}))},this.getAttributeValue=function(attribute,defaultValue,interpolate){return angular.isDefined(attribute)?interpolate?$interpolate(attribute)($scope.$parent):$scope.$parent.$eval(attribute):defaultValue}}]).constant("paginationConfig",{boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["paginationConfig",function(config){return{restrict:"EA",scope:{numPages:"=",currentPage:"=",maxSize:"=",onSelectPage:"&"},controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(scope,element,attrs,paginationCtrl){function makePage(number,text,isActive,isDisabled){return{number:number,text:text,active:isActive,disabled:isDisabled}}var boundaryLinks=paginationCtrl.getAttributeValue(attrs.boundaryLinks,config.boundaryLinks),directionLinks=paginationCtrl.getAttributeValue(attrs.directionLinks,config.directionLinks),firstText=paginationCtrl.getAttributeValue(attrs.firstText,config.firstText,!0),previousText=paginationCtrl.getAttributeValue(attrs.previousText,config.previousText,!0),nextText=paginationCtrl.getAttributeValue(attrs.nextText,config.nextText,!0),lastText=paginationCtrl.getAttributeValue(attrs.lastText,config.lastText,!0),rotate=paginationCtrl.getAttributeValue(attrs.rotate,config.rotate);scope.$watch("numPages + currentPage + maxSize",function(){paginationCtrl.reset();var startPage=1,endPage=scope.numPages,isMaxSized=angular.isDefined(scope.maxSize)&&scope.maxSize<scope.numPages;isMaxSized&&(rotate?(startPage=Math.max(paginationCtrl.currentPage-Math.floor(scope.maxSize/2),1),endPage=startPage+scope.maxSize-1,endPage>scope.numPages&&(endPage=scope.numPages,startPage=endPage-scope.maxSize+1)):(startPage=(Math.ceil(paginationCtrl.currentPage/scope.maxSize)-1)*scope.maxSize+1,endPage=Math.min(startPage+scope.maxSize-1,scope.numPages)));for(var number=startPage;endPage>=number;number++){var page=makePage(number,number,paginationCtrl.isActive(number),!1);scope.pages.push(page)}if(isMaxSized&&!rotate){if(startPage>1){var previousPageSet=makePage(startPage-1,"...",!1,!1);scope.pages.unshift(previousPageSet)}if(endPage<scope.numPages){var nextPageSet=makePage(endPage+1,"...",!1,!1);scope.pages.push(nextPageSet)}}if(directionLinks){var previousPage=makePage(paginationCtrl.currentPage-1,previousText,!1,paginationCtrl.noPrevious());scope.pages.unshift(previousPage);var nextPage=makePage(paginationCtrl.currentPage+1,nextText,!1,paginationCtrl.noNext());scope.pages.push(nextPage)}if(boundaryLinks){var firstPage=makePage(1,firstText,!1,paginationCtrl.noPrevious());scope.pages.unshift(firstPage);var lastPage=makePage(scope.numPages,lastText,!1,paginationCtrl.noNext());scope.pages.push(lastPage)}})}}}]).constant("pagerConfig",{previousText:"« Previous",nextText:"Next »",align:!0}).directive("pager",["pagerConfig",function(config){return{restrict:"EA",scope:{numPages:"=",currentPage:"=",onSelectPage:"&"},controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(scope,element,attrs,paginationCtrl){function makePage(number,text,isDisabled,isPrevious,isNext){return{number:number,text:text,disabled:isDisabled,previous:align&&isPrevious,next:align&&isNext}}var previousText=paginationCtrl.getAttributeValue(attrs.previousText,config.previousText,!0),nextText=paginationCtrl.getAttributeValue(attrs.nextText,config.nextText,!0),align=paginationCtrl.getAttributeValue(attrs.align,config.align);scope.$watch("numPages + currentPage",function(){paginationCtrl.reset();var previousPage=makePage(paginationCtrl.currentPage-1,previousText,paginationCtrl.noPrevious(),!0,!1);scope.pages.unshift(previousPage);var nextPage=makePage(paginationCtrl.currentPage+1,nextText,paginationCtrl.noNext(),!1,!0);scope.pages.push(nextPage)})}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position"]).provider("$tooltip",function(){function snake_case(name){var regexp=/[A-Z]/g,separator="-";return name.replace(regexp,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}var defaultOptions={placement:"top",animation:!0,popupDelay:0},triggerMap={mouseenter:"mouseleave",click:"click",focus:"blur"},globalOptions={};this.options=function(value){angular.extend(globalOptions,value)},this.setTriggers=function(triggers){angular.extend(triggerMap,triggers)},this.$get=["$window","$compile","$timeout","$parse","$document","$position","$interpolate",function($window,$compile,$timeout,$parse,$document,$position,$interpolate){return function(type,prefix,defaultTriggerShow){function getTriggers(trigger){var show=trigger||options.trigger||defaultTriggerShow,hide=triggerMap[show]||show;return{show:show,hide:hide}}var options=angular.extend({},defaultOptions,globalOptions),directiveName=snake_case(type),startSym=$interpolate.startSymbol(),endSym=$interpolate.endSymbol(),template="<"+directiveName+"-popup "+'title="'+startSym+"tt_title"+endSym+'" '+'content="'+startSym+"tt_content"+endSym+'" '+'placement="'+startSym+"tt_placement"+endSym+'" '+'animation="tt_animation()" '+'is-open="tt_isOpen"'+">"+"</"+directiveName+"-popup>";return{restrict:"EA",scope:!0,link:function(scope,element,attrs){function toggleTooltipBind(){scope.tt_isOpen?hideTooltipBind():showTooltipBind()}function showTooltipBind(){scope.tt_popupDelay?popupTimeout=$timeout(show,scope.tt_popupDelay):scope.$apply(show)}function hideTooltipBind(){scope.$apply(function(){hide()})}function show(){var position,ttWidth,ttHeight,ttPosition;if(scope.tt_content){switch(transitionTimeout&&$timeout.cancel(transitionTimeout),tooltip.css({top:0,left:0,display:"block"}),appendToBody?($body=$body||$document.find("body"),$body.append(tooltip)):element.after(tooltip),position=appendToBody?$position.offset(element):$position.position(element),ttWidth=tooltip.prop("offsetWidth"),ttHeight=tooltip.prop("offsetHeight"),scope.tt_placement){case"right":ttPosition={top:position.top+position.height/2-ttHeight/2,left:position.left+position.width};break;case"bottom":ttPosition={top:position.top+position.height,left:position.left+position.width/2-ttWidth/2};break;case"left":ttPosition={top:position.top+position.height/2-ttHeight/2,left:position.left-ttWidth};break;default:ttPosition={top:position.top-ttHeight,left:position.left+position.width/2-ttWidth/2}}ttPosition.top+="px",ttPosition.left+="px",tooltip.css(ttPosition),scope.tt_isOpen=!0}}function hide(){scope.tt_isOpen=!1,$timeout.cancel(popupTimeout),angular.isDefined(scope.tt_animation)&&scope.tt_animation()?transitionTimeout=$timeout(function(){tooltip.remove()},500):tooltip.remove()}var transitionTimeout,popupTimeout,$body,tooltip=$compile(template)(scope),appendToBody=angular.isDefined(options.appendToBody)?options.appendToBody:!1,triggers=getTriggers(void 0),hasRegisteredTriggers=!1;scope.tt_isOpen=!1,attrs.$observe(type,function(val){scope.tt_content=val}),attrs.$observe(prefix+"Title",function(val){scope.tt_title=val}),attrs.$observe(prefix+"Placement",function(val){scope.tt_placement=angular.isDefined(val)?val:options.placement}),attrs.$observe(prefix+"Animation",function(val){scope.tt_animation=angular.isDefined(val)?$parse(val):function(){return options.animation}}),attrs.$observe(prefix+"PopupDelay",function(val){var delay=parseInt(val,10);scope.tt_popupDelay=isNaN(delay)?options.popupDelay:delay}),attrs.$observe(prefix+"Trigger",function(val){hasRegisteredTriggers&&(element.unbind(triggers.show,showTooltipBind),element.unbind(triggers.hide,hideTooltipBind)),triggers=getTriggers(val),triggers.show===triggers.hide?element.bind(triggers.show,toggleTooltipBind):(element.bind(triggers.show,showTooltipBind),element.bind(triggers.hide,hideTooltipBind)),hasRegisteredTriggers=!0}),attrs.$observe(prefix+"AppendToBody",function(val){appendToBody=angular.isDefined(val)?$parse(val)(scope):appendToBody}),appendToBody&&scope.$on("$locationChangeSuccess",function(){scope.tt_isOpen&&hide()}),scope.$on("$destroy",function(){scope.tt_isOpen?hide():tooltip.remove()})}}}}]}).directive("tooltipPopup",function(){return{restrict:"E",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function($tooltip){return $tooltip("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"E",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function($tooltip){return $tooltip("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}
}).directive("popover",["$compile","$timeout","$parse","$window","$tooltip",function($compile,$timeout,$parse,$window,$tooltip){return $tooltip("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",["ui.bootstrap.transition"]).constant("progressConfig",{animate:!0,autoType:!1,stackedTypes:["success","info","warning","danger"]}).controller("ProgressBarController",["$scope","$attrs","progressConfig",function($scope,$attrs,progressConfig){function getStackedType(index){return stackedTypes[index]}var animate=angular.isDefined($attrs.animate)?$scope.$eval($attrs.animate):progressConfig.animate,autoType=angular.isDefined($attrs.autoType)?$scope.$eval($attrs.autoType):progressConfig.autoType,stackedTypes=angular.isDefined($attrs.stackedTypes)?$scope.$eval("["+$attrs.stackedTypes+"]"):progressConfig.stackedTypes;this.makeBar=function(newBar,oldBar,index){var newValue=angular.isObject(newBar)?newBar.value:newBar||0,oldValue=angular.isObject(oldBar)?oldBar.value:oldBar||0,type=angular.isObject(newBar)&&angular.isDefined(newBar.type)?newBar.type:autoType?getStackedType(index||0):null;return{from:oldValue,to:newValue,type:type,animate:animate}},this.addBar=function(bar){$scope.bars.push(bar),$scope.totalPercent+=bar.to},this.clearBars=function(){$scope.bars=[],$scope.totalPercent=0},this.clearBars()}]).directive("progress",function(){return{restrict:"EA",replace:!0,controller:"ProgressBarController",scope:{value:"=percent",onFull:"&",onEmpty:"&"},templateUrl:"template/progressbar/progress.html",link:function(scope,element,attrs,controller){scope.$watch("value",function(newValue,oldValue){if(controller.clearBars(),angular.isArray(newValue))for(var i=0,n=newValue.length;n>i;i++)controller.addBar(controller.makeBar(newValue[i],oldValue[i],i));else controller.addBar(controller.makeBar(newValue,oldValue))},!0),scope.$watch("totalPercent",function(value){value>=100?scope.onFull():0>=value&&scope.onEmpty()},!0)}}}).directive("progressbar",["$transition",function($transition){return{restrict:"EA",replace:!0,scope:{width:"=",old:"=",type:"=",animate:"="},templateUrl:"template/progressbar/bar.html",link:function(scope,element){scope.$watch("width",function(value){scope.animate?(element.css("width",scope.old+"%"),$transition(element,{width:value+"%"})):element.css("width",value+"%")})}}}]),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5}).controller("RatingController",["$scope","$attrs","$parse","ratingConfig",function($scope,$attrs,$parse,ratingConfig){this.maxRange=angular.isDefined($attrs.max)?$scope.$parent.$eval($attrs.max):ratingConfig.max,$scope.range=[];for(var i=1;i<=this.maxRange;i++)$scope.range.push(i);$scope.rate=function(value){$scope.readonly||($scope.value=value)},$scope.enter=function(value){$scope.readonly||($scope.val=value),$scope.onHover({value:value})},$scope.reset=function(){$scope.val=angular.copy($scope.value),$scope.onLeave()},$scope.$watch("value",function(value){$scope.val=value}),$scope.readonly=!1,$attrs.readonly&&$scope.$parent.$watch($parse($attrs.readonly),function(value){$scope.readonly=!!value})}]).directive("rating",function(){return{restrict:"EA",scope:{value:"=",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0}}),angular.module("ui.bootstrap.tabs",[]).directive("tabs",function(){return function(){throw new Error("The `tabs` directive is deprecated, please migrate to `tabset`. Instructions can be found at http://github.com/angular-ui/bootstrap/tree/master/CHANGELOG.md")}}).controller("TabsetController",["$scope","$element",function($scope){var ctrl=this,tabs=ctrl.tabs=$scope.tabs=[];ctrl.select=function(tab){angular.forEach(tabs,function(tab){tab.active=!1}),tab.active=!0},ctrl.addTab=function(tab){tabs.push(tab),(1===tabs.length||tab.active)&&ctrl.select(tab)},ctrl.removeTab=function(tab){var index=tabs.indexOf(tab);if(tab.active&&tabs.length>1){var newActiveIndex=index==tabs.length-1?index-1:index+1;ctrl.select(tabs[newActiveIndex])}tabs.splice(index,1)}}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,require:"^tabset",scope:{},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",compile:function(elm,attrs,transclude){return function(scope,element,attrs,tabsetCtrl){scope.vertical=angular.isDefined(attrs.vertical)?scope.$eval(attrs.vertical):!1,scope.type=angular.isDefined(attrs.type)?scope.$parent.$eval(attrs.type):"tabs",scope.direction=angular.isDefined(attrs.direction)?scope.$parent.$eval(attrs.direction):"top",scope.tabsAbove="below"!=scope.direction,tabsetCtrl.$scope=scope,tabsetCtrl.$transcludeFn=transclude}}}}).directive("tab",["$parse","$http","$templateCache","$compile",function($parse){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(elm,attrs,transclude){return function(scope,elm,attrs,tabsetCtrl){var getActive,setActive;attrs.active?(getActive=$parse(attrs.active),setActive=getActive.assign,scope.$parent.$watch(getActive,function(value){scope.active=!!value}),scope.active=getActive(scope.$parent)):setActive=getActive=angular.noop,scope.$watch("active",function(active){setActive(scope.$parent,active),active?(tabsetCtrl.select(scope),scope.onSelect()):scope.onDeselect()}),scope.disabled=!1,attrs.disabled&&scope.$parent.$watch($parse(attrs.disabled),function(value){scope.disabled=!!value}),scope.select=function(){scope.disabled||(scope.active=!0)},tabsetCtrl.addTab(scope),scope.$on("$destroy",function(){tabsetCtrl.removeTab(scope)}),scope.active&&setActive(scope.$parent,!0),scope.$transcludeFn=transclude}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(scope,elm){scope.$watch("headingElement",function(heading){heading&&(elm.html(""),elm.append(heading))})}}}]).directive("tabContentTransclude",["$compile","$parse",function(){function isTabHeading(node){return node.tagName&&(node.hasAttribute("tab-heading")||node.hasAttribute("data-tab-heading")||"tab-heading"===node.tagName.toLowerCase()||"data-tab-heading"===node.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(scope,elm,attrs){var tab=scope.$eval(attrs.tabContentTransclude);tab.$transcludeFn(tab.$parent,function(contents){angular.forEach(contents,function(node){isTabHeading(node)?tab.headingElement=node:elm.append(node)})})}}}]).directive("tabsetTitles",["$http",function(){return{restrict:"A",require:"^tabset",templateUrl:"template/tabs/tabset-titles.html",replace:!0,link:function(scope,elm,attrs,tabsetCtrl){scope.$eval(attrs.tabsetTitles)?tabsetCtrl.$transcludeFn(tabsetCtrl.$scope.$parent,function(node){elm.append(node)}):elm.remove()}}}]),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:["AM","PM"],readonlyInput:!1,mousewheel:!0}).directive("timepicker",["$parse","$log","timepickerConfig",function($parse,$log,timepickerConfig){return{restrict:"EA",require:"?^ngModel",replace:!0,scope:{model:"=ngModel"},templateUrl:"template/timepicker/timepicker.html",link:function(scope,element,attrs,ngModel){function getHoursFromTemplate(){var hours=parseInt(scope.hours,10),valid=scope.showMeridian?hours>0&&13>hours:hours>=0&&24>hours;return valid?(scope.showMeridian&&(12===hours&&(hours=0),scope.meridian===meridians[1]&&(hours+=12)),hours):void 0}function getMinutesFromTemplate(){var minutes=parseInt(scope.minutes,10);return minutes>=0&&60>minutes?minutes:void 0}function pad(value){return angular.isDefined(value)&&value.toString().length<2?"0"+value:value}function refresh(keyboardChange){makeValid(),ngModel.$setViewValue(new Date(selected)),scope.model.setHours(selected.getHours()),scope.model.setMinutes(selected.getMinutes()),updateTemplate(keyboardChange)}function makeValid(){ngModel.$setValidity("time",!0),scope.invalidHours=!1,scope.invalidMinutes=!1}function updateTemplate(keyboardChange){var hours=selected.getHours(),minutes=selected.getMinutes();scope.showMeridian&&(hours=0===hours||12===hours?12:hours%12),scope.hours="h"===keyboardChange?hours:pad(hours),scope.minutes="m"===keyboardChange?minutes:pad(minutes),scope.meridian=selected.getHours()<12?meridians[0]:meridians[1]}function addMinutes(minutes){var dt=new Date(selected.getTime()+6e4*minutes);selected.setHours(dt.getHours(),dt.getMinutes()),refresh()}if(ngModel){scope.model||(scope.model=new Date);var selected=new Date(scope.model.getTime()),meridians=timepickerConfig.meridians;scope.$parent.$watch(attrs.ngModel,function(value){value&&(selected.setTime(value.getTime()),refresh())});var hourStep=timepickerConfig.hourStep;attrs.hourStep&&scope.$parent.$watch($parse(attrs.hourStep),function(value){hourStep=parseInt(value,10)});var minuteStep=timepickerConfig.minuteStep;attrs.minuteStep&&scope.$parent.$watch($parse(attrs.minuteStep),function(value){minuteStep=parseInt(value,10)}),scope.showMeridian=timepickerConfig.showMeridian,attrs.showMeridian&&scope.$parent.$watch($parse(attrs.showMeridian),function(value){if(scope.showMeridian=!!value,ngModel.$error.time){var hours=getHoursFromTemplate(),minutes=getMinutesFromTemplate();angular.isDefined(hours)&&angular.isDefined(minutes)&&(selected.setHours(hours),refresh())}else updateTemplate()});var inputs=element.find("input"),hoursInputEl=inputs.eq(0),minutesInputEl=inputs.eq(1),mousewheel=angular.isDefined(attrs.mousewheel)?scope.$eval(attrs.mousewheel):timepickerConfig.mousewheel;if(mousewheel){var isScrollingUp=function(e){e.originalEvent&&(e=e.originalEvent);var delta=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||delta>0};hoursInputEl.bind("mousewheel wheel",function(e){scope.$apply(isScrollingUp(e)?scope.incrementHours():scope.decrementHours()),e.preventDefault()}),minutesInputEl.bind("mousewheel wheel",function(e){scope.$apply(isScrollingUp(e)?scope.incrementMinutes():scope.decrementMinutes()),e.preventDefault()})}if(scope.readonlyInput=angular.isDefined(attrs.readonlyInput)?scope.$eval(attrs.readonlyInput):timepickerConfig.readonlyInput,scope.readonlyInput)scope.updateHours=angular.noop,scope.updateMinutes=angular.noop;else{var invalidate=function(invalidHours,invalidMinutes){ngModel.$setViewValue(null),ngModel.$setValidity("time",!1),angular.isDefined(invalidHours)&&(scope.invalidHours=invalidHours),angular.isDefined(invalidMinutes)&&(scope.invalidMinutes=invalidMinutes)};scope.updateHours=function(){var hours=getHoursFromTemplate();angular.isDefined(hours)?(selected.setHours(hours),refresh("h")):invalidate(!0)},hoursInputEl.bind("blur",function(){!scope.validHours&&scope.hours<10&&scope.$apply(function(){scope.hours=pad(scope.hours)})}),scope.updateMinutes=function(){var minutes=getMinutesFromTemplate();angular.isDefined(minutes)?(selected.setMinutes(minutes),refresh("m")):invalidate(void 0,!0)},minutesInputEl.bind("blur",function(){!scope.invalidMinutes&&scope.minutes<10&&scope.$apply(function(){scope.minutes=pad(scope.minutes)})})}ngModel.$render=function(){var date=ngModel.$modelValue?new Date(ngModel.$modelValue):null;isNaN(date)?ngModel.$setValidity("time",!1):(date&&(selected=date),makeValid(),updateTemplate())},scope.incrementHours=function(){addMinutes(60*hourStep)},scope.decrementHours=function(){addMinutes(60*-hourStep)},scope.incrementMinutes=function(){addMinutes(minuteStep)},scope.decrementMinutes=function(){addMinutes(-minuteStep)},scope.toggleMeridian=function(){addMinutes(720*(selected.getHours()<12?1:-1))}}}}}]),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position"]).factory("typeaheadParser",["$parse",function($parse){var TYPEAHEAD_REGEXP=/^\s*(.*?)(?:\s+as\s+(.*?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+(.*)$/;return{parse:function(input){var match=input.match(TYPEAHEAD_REGEXP);if(!match)throw new Error("Expected typeahead specification in form of '_modelValue_ (as _label_)? for _item_ in _collection_' but got '"+input+"'.");return{itemName:match[3],source:$parse(match[4]),viewMapper:$parse(match[2]||match[1]),modelMapper:$parse(match[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function($compile,$parse,$q,$timeout,$document,$position,typeaheadParser){var HOT_KEYS=[9,13,27,38,40];return{require:"ngModel",link:function(originalScope,element,attrs,modelCtrl){var minSearch=originalScope.$eval(attrs.typeaheadMinLength)||1,waitTime=originalScope.$eval(attrs.typeaheadWaitMs)||0,isEditable=originalScope.$eval(attrs.typeaheadEditable)!==!1,isLoadingSetter=$parse(attrs.typeaheadLoading).assign||angular.noop,onSelectCallback=$parse(attrs.typeaheadOnSelect),inputFormatter=attrs.typeaheadInputFormatter?$parse(attrs.typeaheadInputFormatter):void 0,$setModelValue=$parse(attrs.ngModel).assign,parserResult=typeaheadParser.parse(attrs.typeahead),popUpEl=angular.element("<typeahead-popup></typeahead-popup>");popUpEl.attr({matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(attrs.typeaheadTemplateUrl)&&popUpEl.attr("template-url",attrs.typeaheadTemplateUrl);var scope=originalScope.$new();originalScope.$on("$destroy",function(){scope.$destroy()});var resetMatches=function(){scope.matches=[],scope.activeIdx=-1},getMatchesAsync=function(inputValue){var locals={$viewValue:inputValue};isLoadingSetter(originalScope,!0),$q.when(parserResult.source(scope,locals)).then(function(matches){if(inputValue===modelCtrl.$viewValue){if(matches.length>0){scope.activeIdx=0,scope.matches.length=0;for(var i=0;i<matches.length;i++)locals[parserResult.itemName]=matches[i],scope.matches.push({label:parserResult.viewMapper(scope,locals),model:matches[i]});scope.query=inputValue,scope.position=$position.position(element),scope.position.top=scope.position.top+element.prop("offsetHeight")}else resetMatches();isLoadingSetter(originalScope,!1)}},function(){resetMatches(),isLoadingSetter(originalScope,!1)})};resetMatches(),scope.query=void 0;var timeoutPromise;modelCtrl.$parsers.push(function(inputValue){return resetMatches(),inputValue&&inputValue.length>=minSearch&&(waitTime>0?(timeoutPromise&&$timeout.cancel(timeoutPromise),timeoutPromise=$timeout(function(){getMatchesAsync(inputValue)},waitTime)):getMatchesAsync(inputValue)),isEditable?inputValue:(modelCtrl.$setValidity("editable",!1),void 0)}),modelCtrl.$formatters.push(function(modelValue){var candidateViewValue,emptyViewValue,locals={};return inputFormatter?(locals.$model=modelValue,inputFormatter(originalScope,locals)):(locals[parserResult.itemName]=modelValue,candidateViewValue=parserResult.viewMapper(originalScope,locals),locals[parserResult.itemName]=void 0,emptyViewValue=parserResult.viewMapper(originalScope,locals),candidateViewValue!==emptyViewValue?candidateViewValue:modelValue)}),scope.select=function(activeIdx){var model,item,locals={};locals[parserResult.itemName]=item=scope.matches[activeIdx].model,model=parserResult.modelMapper(originalScope,locals),$setModelValue(originalScope,model),modelCtrl.$setValidity("editable",!0),onSelectCallback(originalScope,{$item:item,$model:model,$label:parserResult.viewMapper(originalScope,locals)}),resetMatches(),element[0].focus()},attrs.enableSubmit||element.bind("keypress",function(evt){13===evt.which&&evt.preventDefault()}),element.bind("keydown",function(evt){0!==scope.matches.length&&-1!==HOT_KEYS.indexOf(evt.which)&&(evt.preventDefault(),40===evt.which?(scope.activeIdx=(scope.activeIdx+1)%scope.matches.length,scope.$digest()):38===evt.which?(scope.activeIdx=(scope.activeIdx?scope.activeIdx:scope.matches.length)-1,scope.$digest()):13===evt.which||9===evt.which?scope.$apply(function(){scope.select(scope.activeIdx)}):27===evt.which&&(evt.stopPropagation(),resetMatches(),scope.$digest()))}),$document.bind("click",function(){resetMatches(),scope.$digest()}),element.after($compile(popUpEl)(scope))}}}]).directive("typeaheadPopup",function(){return{restrict:"E",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(scope,element,attrs){scope.templateUrl=attrs.templateUrl,scope.isOpen=function(){return scope.matches.length>0},scope.isActive=function(matchIdx){return scope.active==matchIdx},scope.selectActive=function(matchIdx){scope.active=matchIdx},scope.selectMatch=function(activeIdx){scope.select({activeIdx:activeIdx})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function($http,$templateCache,$compile,$parse){return{restrict:"E",scope:{index:"=",match:"=",query:"="},link:function(scope,element,attrs){var tplUrl=$parse(attrs.templateUrl)(scope.$parent)||"template/typeahead/typeahead-match.html";$http.get(tplUrl,{cache:$templateCache}).success(function(tplContent){element.replaceWith($compile(tplContent.trim())(scope))})}}}]).filter("typeaheadHighlight",function(){function escapeRegexp(queryToEscape){return queryToEscape.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(matchItem,query){return query?matchItem.replace(new RegExp(escapeRegexp(query),"gi"),"<strong>$&</strong>"):query}}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion-group.html",'<div class="accordion-group">\n  <div class="accordion-heading" ><a class="accordion-toggle" ng-click="isOpen = !isOpen" accordion-transclude="heading">{{heading}}</a></div>\n  <div class="accordion-body" collapse="!isOpen">\n    <div class="accordion-inner" ng-transclude></div>  </div>\n</div>')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion.html",'<div class="accordion" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/alert/alert.html","<div class='alert' ng-class='type && \"alert-\" + type'>\n    <button ng-show='closeable' type='button' class='close' ng-click='close()'>&times;</button>\n    <div ng-transclude></div>\n</div>\n")}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel">\n    <ol class="carousel-indicators" ng-show="slides().length > 1">\n        <li ng-repeat="slide in slides()" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a ng-click="prev()" class="carousel-control left" ng-show="slides().length > 1">&lsaquo;</a>\n    <a ng-click="next()" class="carousel-control right" ng-show="slides().length > 1">&rsaquo;</a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/carousel/slide.html","<div ng-class=\"{\n    'active': leaving || (active && !entering),\n    'prev': (next || active) && direction=='prev',\n    'next': (next || active) && direction=='next',\n    'right': direction=='prev',\n    'left': direction=='next'\n  }\" class=\"item\" ng-transclude></div>\n")}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/datepicker.html",'<table>\n  <thead>\n    <tr class="text-center">\n      <th><button type="button" class="btn pull-left" ng-click="move(-1)"><i class="icon-chevron-left"></i></button></th>\n      <th colspan="{{rows[0].length - 2 + showWeekNumbers}}"><button type="button" class="btn btn-block" ng-click="toggleMode()"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn pull-right" ng-click="move(1)"><i class="icon-chevron-right"></i></button></th>\n    </tr>\n    <tr class="text-center" ng-show="labels.length > 0">\n      <th ng-show="showWeekNumbers">#</th>\n      <th ng-repeat="label in labels">{{label}}</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows">\n      <td ng-show="showWeekNumbers" class="text-center"><em>{{ getWeekNumber(row) }}</em></td>\n      <td ng-repeat="dt in row" class="text-center">\n        <button type="button" style="width:100%;" class="btn" ng-class="{\'btn-info\': dt.selected}" ng-click="select(dt.date)" ng-disabled="dt.disabled"><span ng-class="{muted: dt.secondary}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" class="dropdown-menu">\n	<li ng-transclude></li>\n	<li class="divider"></li>\n	<li style="padding: 9px;">\n		<span class="btn-group">\n			<button type="button" class="btn btn-small btn-inverse" ng-click="today()">Today</button>\n			<button type="button" class="btn btn-small btn-info" ng-click="showWeeks = ! showWeeks" ng-class="{active: showWeeks}">Weeks</button>\n			<button type="button" class="btn btn-small btn-danger" ng-click="clear()">Clear</button>\n		</span>\n		<button type="button" class="btn btn-small btn-success pull-right" ng-click="isOpen = false">Close</button>\n	</li>\n</ul>')}]),angular.module("template/dialog/message.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/dialog/message.html",'<div class="modal-header">\n	<h3>{{ title }}</h3>\n</div>\n<div class="modal-body">\n	<p>{{ message }}</p>\n</div>\n<div class="modal-footer">\n	<button ng-repeat="btn in buttons" ng-click="close(btn.result)" class="btn" ng-class="btn.cssClass">{{ btn.label }}</button>\n</div>\n')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/pagination/pager.html",'<div class="pager">\n  <ul>\n    <li ng-repeat="page in pages" ng-class="{disabled: page.disabled, previous: page.previous, next: page.next}"><a ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  </ul>\n</div>\n')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/pagination/pagination.html",'<div class="pagination"><ul>\n  <li ng-repeat="page in pages" ng-class="{active: page.active, disabled: page.disabled}"><a ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  </ul>\n</div>\n')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/bar.html",'<div class="bar" ng-class=\'type && "bar-" + type\'></div>')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/progress.html",'<div class="progress"><progressbar ng-repeat="bar in bars" width="bar.to" old="bar.from" animate="bar.animate" type="bar.type"></progressbar></div>')}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/rating/rating.html",'<span ng-mouseleave="reset()">\n	<i ng-repeat="number in range" ng-mouseenter="enter(number)" ng-click="rate(number)" ng-class="{\'icon-star\': number <= val, \'icon-star-empty\': number > val}"></i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset-titles.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tabset-titles.html","<ul class=\"nav {{type && 'nav-' + type}}\" ng-class=\"{'nav-stacked': vertical}\">\n</ul>\n")}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tabset.html",'\n<div class="tabbable" ng-class="{\'tabs-right\': direction == \'right\', \'tabs-left\': direction == \'left\', \'tabs-below\': direction == \'below\'}">\n  <div tabset-titles="tabsAbove"></div>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n  <div tabset-titles="!tabsAbove"></div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/timepicker/timepicker.html",'<table class="form-inline">\n	<tr class="text-center">\n		<td><a ng-click="incrementHours()" class="btn btn-link"><i class="icon-chevron-up"></i></a></td>\n		<td>&nbsp;</td>\n		<td><a ng-click="incrementMinutes()" class="btn btn-link"><i class="icon-chevron-up"></i></a></td>\n		<td ng-show="showMeridian"></td>\n	</tr>\n	<tr>\n		<td class="control-group" ng-class="{\'error\': invalidHours}"><input type="text" ng-model="hours" ng-change="updateHours()" class="span1 text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2" /></td>\n		<td>:</td>\n		<td class="control-group" ng-class="{\'error\': invalidMinutes}"><input type="text" ng-model="minutes" ng-change="updateMinutes()" class="span1 text-center" ng-readonly="readonlyInput" maxlength="2"></td>\n		<td ng-show="showMeridian"><button ng-click="toggleMeridian()" class="btn text-center">{{meridian}}</button></td>\n	</tr>\n	<tr class="text-center">\n		<td><a ng-click="decrementHours()" class="btn btn-link"><i class="icon-chevron-down"></i></a></td>\n		<td>&nbsp;</td>\n		<td><a ng-click="decrementMinutes()" class="btn btn-link"><i class="icon-chevron-down"></i></a></td>\n		<td ng-show="showMeridian"></td>\n	</tr>\n</table>')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" ng-bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead-popup.html",'<ul class="typeahead dropdown-menu" ng-style="{display: isOpen()&&\'block\' || \'none\', top: position.top+\'px\', left: position.left+\'px\'}">\n    <li ng-repeat="match in matches" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)">\n        <typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></typeahead-match>\n    </li>\n</ul>')}]),angular.module("template/typeahead/typeahead.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead.html",'<ul class="typeahead dropdown-menu" ng-style="{display: isOpen()&&\'block\' || \'none\', top: position.top+\'px\', left: position.left+\'px\'}">\n    <li ng-repeat="match in matches" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)">\n        <a tabindex="-1" ng-click="selectMatch($index)" ng-bind-html-unsafe="match.label | typeaheadHighlight:query"></a>\n    </li>\n</ul>')}]),angular.module("ui.calendar",[]).constant("uiCalendarConfig",{}).directive("uiCalendar",["uiCalendarConfig","$locale",function(uiCalendarConfig,$locale){var tValues=function(data){var r,k;r=[];for(k in data)r[k]=data[k];return r},dtf=$locale.DATETIME_FORMATS;uiCalendarConfig=angular.extend({monthNames:tValues(dtf.MONTH),monthNamesShort:tValues(dtf.SHORTMONTH),dayNames:tValues(dtf.DAY),dayNamesShort:tValues(dtf.SHORTDAY)},uiCalendarConfig||{});var sourceSerialId=1,eventSerialId=1;return{require:"ngModel",scope:{ngModel:"=",config:"="},restrict:"A",link:function(scope,elm,attrs){var sources=scope.ngModel;scope.destroy=function(){scope.calendar=attrs.calendar?scope.$parent[attrs.calendar]=elm.html(""):elm.html("")},scope.destroy(),scope.init=function(){var options={eventSources:sources};angular.extend(options,uiCalendarConfig,attrs.uiCalendar?scope.$parent.$eval(attrs.uiCalendar):{}),scope.calendar.fullCalendar(options)},scope.init();var changeWatcher=function(arraySource,tokenFn){var self,getTokens=function(){var array=angular.isFunction(arraySource)?arraySource():arraySource;return array.map(function(el){var token=tokenFn(el);return map[token]=el,token})},subtractAsSets=function(a,b){var i,n,result=[],inB={};for(i=0,n=b.length;n>i;i++)inB[b[i]]=!0;for(i=0,n=a.length;n>i;i++)inB[a[i]]||result.push(a[i]);return result},map={},applyChanges=function(newTokens,oldTokens){var i,n,el,token,replacedTokens={},removedTokens=subtractAsSets(oldTokens,newTokens);for(i=0,n=removedTokens.length;n>i;i++){var removedToken=removedTokens[i];el=map[removedToken],delete map[removedToken];var newToken=tokenFn(el);newToken===removedToken?self.onRemoved(el):(replacedTokens[newToken]=removedToken,self.onChanged(el))}var addedTokens=subtractAsSets(newTokens,oldTokens);for(i=0,n=addedTokens.length;n>i;i++)token=addedTokens[i],el=map[token],replacedTokens[token]||self.onAdded(el)};return self={subscribe:function(scope,onChanged){scope.$watch(getTokens,function(newTokens,oldTokens){onChanged&&onChanged(newTokens,oldTokens)===!1||applyChanges(newTokens,oldTokens)},!0)},onAdded:angular.noop,onChanged:angular.noop,onRemoved:angular.noop}},sourcesChanged=!1,eventSourcesWatcher=changeWatcher(sources,function(source){return source.__id||(source.__id=sourceSerialId++)});eventSourcesWatcher.subscribe(scope),eventSourcesWatcher.onAdded=function(source){scope.calendar.fullCalendar("addEventSource",source),sourcesChanged=!0},eventSourcesWatcher.onRemoved=function(source){scope.calendar.fullCalendar("removeEventSource",source),sourcesChanged=!0};var allEvents=function(){for(var arraySources=[],i=0,srcLen=sources.length;srcLen>i;i++){var source=sources[i];angular.isArray(source)&&arraySources.push(source)}return Array.prototype.concat.apply([],arraySources)},eventsWatcher=changeWatcher(allEvents,function(e){return e.__uiCalId||(e.__uiCalId=eventSerialId++),""+e.__uiCalId+(e.id||"")+(e.title||"")+(e.url||"")+(+e.start||"")+(+e.end||"")+(e.allDay||!1)+(e.className||"")});eventsWatcher.subscribe(scope,function(){return sourcesChanged?(scope.calendar.fullCalendar("rerenderEvents"),sourcesChanged=!1,!1):void 0}),eventsWatcher.onAdded=function(event){scope.calendar.fullCalendar("renderEvent",event)},eventsWatcher.onRemoved=function(event){scope.calendar.fullCalendar("removeEvents",function(e){return e===event})},eventsWatcher.onChanged=function(event){scope.calendar.fullCalendar("updateEvent",event)}}}}]),angular.module("ui.select2",[]).value("uiSelect2Config",{}).directive("uiSelect2",["uiSelect2Config","$timeout",function(uiSelect2Config,$timeout){var options={};return uiSelect2Config&&angular.extend(options,uiSelect2Config),{require:"ngModel",compile:function(tElm,tAttrs){var watch,repeatOption,repeatAttr,isSelect=tElm.is("select"),isMultiple=void 0!==tAttrs.multiple;return tElm.is("select")&&(repeatOption=tElm.find("option[ng-repeat], option[data-ng-repeat]"),repeatOption.length&&(repeatAttr=repeatOption.attr("ng-repeat")||repeatOption.attr("data-ng-repeat"),watch=jQuery.trim(repeatAttr.split("|")[0]).split(" ").pop())),function(scope,elm,attrs,controller){var opts=angular.extend({},options,scope.$eval(attrs.uiSelect2)),convertToAngularModel=function(select2_data){var model;
return opts.simple_tags?(model=[],angular.forEach(select2_data,function(value){model.push(value.id)})):model=select2_data,model},convertToSelect2Model=function(angular_data){var model=[];return angular_data?(opts.simple_tags?(model=[],angular.forEach(angular_data,function(value){model.push({id:value,text:value})})):model=angular_data,model):model};if(isSelect?(delete opts.multiple,delete opts.initSelection):isMultiple&&(opts.multiple=!0),controller&&(scope.$watch(tAttrs.ngModel,function(current,old){current&&current!=old&&controller.$render()},!0),controller.$render=function(){isSelect?elm.select2("val",controller.$viewValue):opts.multiple?elm.select2("data",convertToSelect2Model(controller.$viewValue)):angular.isObject(controller.$viewValue)?elm.select2("data",controller.$viewValue):controller.$viewValue?elm.select2("val",controller.$viewValue):elm.select2("data",null)},watch&&scope.$watch(watch,function(newVal){newVal&&$timeout(function(){elm.select2("val",controller.$viewValue),elm.trigger("change")})}),controller.$parsers.push(function(value){var div=elm.prev();return div.toggleClass("ng-invalid",!controller.$valid).toggleClass("ng-valid",controller.$valid).toggleClass("ng-invalid-required",!controller.$valid).toggleClass("ng-valid-required",controller.$valid).toggleClass("ng-dirty",controller.$dirty).toggleClass("ng-pristine",controller.$pristine),value}),!isSelect&&(elm.bind("change",function(){scope.$$phase||scope.$apply(function(){controller.$setViewValue(convertToAngularModel(elm.select2("data")))})}),opts.initSelection))){var initSelection=opts.initSelection;opts.initSelection=function(element,callback){initSelection(element,function(value){controller.$setViewValue(convertToAngularModel(value)),callback(value)})}}elm.bind("$destroy",function(){elm.select2("destroy")}),attrs.$observe("disabled",function(value){elm.select2("enable",!value)}),attrs.$observe("readonly",function(value){elm.select2("readonly",!!value)}),attrs.ngMultiple&&scope.$watch(attrs.ngMultiple,function(){elm.select2(opts)}),$timeout(function(){elm.select2(opts),elm.val(controller.$viewValue),controller.$render()})}}}}]),angular.module("selectize",[]).value("selectizeConfig",{}).directive("selectize",["selectizeConfig",function(selectizeConfig){return{restrict:"EA",require:"^ngModel",scope:{ngModel:"=",config:"=",initOptions:"=",ngDisabled:"="},link:function(scope,element,attrs,modelCtrl){var selectize,settings=angular.extend({},Selectize.defaults,selectizeConfig,scope.config);scope.options=[],scope.initOptions&&scope.initOptions.length>0&&angular.copy(scope.initOptions,scope.options),scope.config=scope.config||{};var toggle=function(disabled){disabled?selectize.disable():selectize.enable()},setSelectizeOptions=function(curr,prev){curr&&scope.options!=curr&&curr.length>0&&angular.copy(curr,scope.options),angular.forEach(prev,function(opt){if(-1===scope.options.indexOf(opt)){var value=opt[settings.valueField];selectize.removeOption(value,!0)}}),selectize.addOption(scope.options,!0),selectize.refreshOptions(!1),setSelectizeValue()},setSelectizeValue=function(){selectize.$control.toggleClass("ng-valid",modelCtrl.$valid),selectize.$control.toggleClass("ng-invalid",modelCtrl.$invalid),selectize.$control.toggleClass("ng-dirty",modelCtrl.$dirty),selectize.$control.toggleClass("ng-pristine",modelCtrl.$pristine),angular.equals(selectize.items,scope.ngModel)||selectize.setValue(scope.ngModel,!0)};settings.onChange=function(value){var old_value=[];angular.copy(scope.ngModel,old_value);var value=angular.copy(selectize.items);1==settings.maxItems&&(value=value[0]),angular.copy(selectize.items,scope.ngModel),modelCtrl.$setViewValue(value),scope.config.onChange&&scope.config.onChange({old:old_value,value:value}),scope.$apply()},settings.onOptionAdd=function(value,data){-1===scope.options.indexOf(data)&&(scope.options.push(data),scope.config.onOptionAdd&&scope.config.onOptionAdd.apply(this,arguments))},settings.onInitialize=function(){selectize=element[0].selectize,setSelectizeOptions(scope.options),scope.config.onInitialize&&scope.config.onInitialize(selectize),scope.$watch("initOptions",setSelectizeOptions,!0),scope.$watch("ngModel",setSelectizeValue,!0),scope.$watch("ngDisabled",toggle)},element.selectize(settings),element.on("$destroy",function(){selectize&&(selectize.destroy(),element=null)})}}}]),/*!
 * angular-spectrum-colorpicker v1.2.0
 * https://github.com/Jimdo/angular-spectrum-colorpicker
 *
 * Angular directive for a colorpicker, that bases on http://bgrins.github.io/spectrum/
 * Idea from http://jsfiddle.net/g/LAJCa/
 *
 * Copyright 2014, Jimdo
 * Released under the MIT license
 */
function(angular){"use strict";var angularSpectrumColorpicker=angular.module("angularSpectrumColorpicker",[]);!function(undefined){angularSpectrumColorpicker.directive("spectrumColorpicker",function(){return{restrict:"E",require:"ngModel",scope:!1,replace:!0,template:'<span><input class="input-small" /></span>',link:function($scope,$element,attrs,$ngModel){function setViewValue(color){var value=fallbackValue;color?value=color.toString(format):angular.isUndefined(fallbackValue)&&(value=color),$ngModel.$setViewValue(value)}var $input=$element.find("input"),fallbackValue=$scope.$eval(attrs.fallbackValue),format=$scope.$eval(attrs.format)||undefined,onChange=function(color){$scope.$apply(function(){setViewValue(color)})},onToggle=function(){return $input.spectrum("toggle"),!1},options=angular.extend({color:$ngModel.$viewValue,change:onChange,move:onChange,hide:onChange},$scope.$eval(attrs.options));attrs.triggerId&&angular.element(document.body).on("click","#"+attrs.triggerId,onToggle),$ngModel.$render=function(){$input.spectrum("set",$ngModel.$viewValue||"")},options.color&&($input.spectrum("set",options.color||""),setViewValue(options.color)),$input.spectrum(options),$scope.$on("$destroy",function(){$input.spectrum("destroy")})}}})}()}(window.angular),angular.module("ui.sortable",[]).value("uiSortableConfig",{}).directive("uiSortable",["uiSortableConfig","$log",function(uiSortableConfig,log){return{require:"?ngModel",link:function(scope,element,attrs,ngModel){function combineCallbacks(first,second){return second&&"function"==typeof second?function(e,ui){first(e,ui),second(e,ui)}:first}var opts={},callbacks={receive:null,remove:null,start:null,stop:null,update:null},apply=function(e,ui){(ui.item.sortable.resort||ui.item.sortable.relocate)&&scope.$apply()};angular.extend(opts,uiSortableConfig),ngModel?(ngModel.$render=function(){element.sortable("refresh")},callbacks.start=function(e,ui){ui.item.sortable={index:ui.item.index()}},callbacks.update=function(e,ui){ui.item.sortable.resort=ngModel},callbacks.receive=function(e,ui){ui.item.sortable.relocate=!0,"moved"in ui.item.sortable&&ngModel.$modelValue.splice(ui.item.index(),0,ui.item.sortable.moved)},callbacks.remove=function(e,ui){ui.item.sortable.moved=1===ngModel.$modelValue.length?ngModel.$modelValue.splice(0,1)[0]:ngModel.$modelValue.splice(ui.item.sortable.index,1)[0]},callbacks.stop=function(e,ui){if(ui.item.sortable.resort&&!ui.item.sortable.relocate){var end,start;start=ui.item.sortable.index,end=ui.item.index(),ui.item.sortable.resort.$modelValue.splice(end,0,ui.item.sortable.resort.$modelValue.splice(start,1)[0])}},scope.$watch(attrs.uiSortable,function(newVal){angular.forEach(newVal,function(value,key){callbacks[key]&&(value=combineCallbacks(callbacks[key],value),"stop"===key&&(value=combineCallbacks(value,apply))),element.sortable("option",key,value)})},!0),angular.forEach(callbacks,function(value,key){opts[key]=combineCallbacks(value,opts[key])}),opts.stop=combineCallbacks(opts.stop,apply)):log.info("ui.sortable: ngModel not provided!",element),element.sortable(opts)}}}]),angular.module("ngAutocomplete",[]).directive("ngAutocomplete",function(){return{require:"ngModel",scope:{ngModel:"=",options:"=",details:"="},link:function(scope,element,attrs,controller){var opts,watchEnter=!1,initOpts=function(){opts={},scope.options&&(watchEnter=scope.options.watchEnter!==!0?!1:!0,scope.options.types?(opts.types=[],opts.types.push(scope.options.types),scope.gPlace.setTypes(opts.types)):scope.gPlace.setTypes([]),scope.options.bounds?(opts.bounds=scope.options.bounds,scope.gPlace.setBounds(opts.bounds)):scope.gPlace.setBounds(null),scope.options.country?(opts.componentRestrictions={country:scope.options.country},scope.gPlace.setComponentRestrictions(opts.componentRestrictions)):scope.gPlace.setComponentRestrictions(null))};void 0==scope.gPlace&&(scope.gPlace=new google.maps.places.Autocomplete(element[0],{})),jQuery(element).bind("keypress",function(evt){13===evt.which&&evt.preventDefault()}),jQuery(element).bind("keyup",function(){scope.no_update=!0,scope.ngModel=element.val()}),google.maps.event.addListener(scope.gPlace,"place_changed",function(){var result=scope.gPlace.getPlace();return void 0!==result&&(void 0!==result.address_components?scope.$apply(function(){scope.details=result,controller.$setViewValue(element.val())}):watchEnter&&getPlace(result)),!1});var getPlace=function(result){var autocompleteService=new google.maps.places.AutocompleteService;result.name.length>0&&autocompleteService.getPlacePredictions({input:result.name,offset:result.name.length},function(list){if(null==list||0==list.length)scope.$apply(function(){scope.details=null});else{var placesService=new google.maps.places.PlacesService(element[0]);placesService.getDetails({reference:list[0].reference},function(detailsResult,placesServiceStatus){placesServiceStatus==google.maps.GeocoderStatus.OK&&scope.$apply(function(){controller.$setViewValue(detailsResult.formatted_address),element.val(detailsResult.formatted_address),scope.details=detailsResult,element.on("focusout",function(){element.val(detailsResult.formatted_address),element.unbind("focusout")})})})}})};controller.$render=function(){var location=controller.$viewValue;element.val(location)},scope.watchOptions=function(){return scope.options},scope.$watch(scope.watchOptions,function(){initOpts()},!0),scope.$watch("ngModel",function(){scope.no_update?scope.no_update=!1:element.val(scope.ngModel)},!0)}}}),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}};this.Configuration=function(){function Configuration(options){null==options&&(options={}),this.configuration=__bind(this.configuration,this),this.configuration=options.configuration}return Configuration.prototype.configuration=function(){return this.configuration},Configuration}()}.call(this),function(){this.AutoWorkshopFilters=angular.module("auto_workshop_filters",[]),this.AutoWorkshopModels=angular.module("auto_workshop_models",["ngResource"]),this.AutoWorkshopApp=angular.module("auto_workshop",["templates","ngCookies","ui.bootstrap","ui.bootstrap.dropdownToggle","ui.calendar","ui.select2","selectize","ui.sortable","auto_workshop_models","auto_workshop_filters","angularSpectrumColorpicker","ngUpload","ngAutocomplete"]).run(function(lookupService,reportService,confirmationService,savedTextsService,vehicleVisualService,permissionService){return lookupService.init(),reportService.init(),confirmationService.init(),savedTextsService.init(),vehicleVisualService.init(),permissionService.init()})}.call(this),function(){this.AutoWorkshopApp.config(function($routeProvider){return $routeProvider.when("/",{templateUrl:template("support_portal/dashboard/index")}).when("/object_reassociation/",{templateUrl:template("support_portal/object_reassociation/index")}).when("/bookings",{templateUrl:template("bookings/index")}).when("/diary",{templateUrl:template("diary/index")}).when("/bookings/new",{templateUrl:template("bookings/new")}).when("/bookings/:id/edit",{templateUrl:template("bookings/edit")}).when("/jobs/new",{templateUrl:template("jobs/current_jobs/new")}).when("/jobs/:jobId",{templateUrl:template("mapp/jobs/show")}).when("/all_jobs",{templateUrl:template("mapp/jobs/all_jobs.html")}).when("/stocks",{templateUrl:template("mapp/stocks/index.html")}).when("/helps",{templateUrl:template("helps/index")})})}.call(this),function(){this.AutoWorkshopApp.directive("adDatepicker",function(){return{restrict:"AE",require:"ngModel",scope:{model:"=ngModel",error:"@error"},link:function(scope,elem,attrs){return void 0===attrs.error?attrs.error="right":void 0},templateUrl:template("directives/ad_datepicker")}})}.call(this),function(){this.AutoWorkshopApp.directive("addresspicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{address:"=ngModel",country:"@",address_label:"@addressLabel"},templateUrl:template("directives/addresspicker"),controller:function($scope,lookupService){var country;return $scope.address_search="",!$scope.country&&lookupService.configurations()&&($scope.country=lookupService.configurations().country),$scope.details={},country=$scope.country,$scope.$watch("details",function(){return $scope.details&&$scope.details.address_components&&$scope.details.address_components.length>0&&($scope.address||($scope.address={}),"nz"===country?($scope.address.number=$scope.extract("street_number")||"",$scope.address.street=$scope.extract("route")||"",$scope.address.street_line=""+$scope.address.number+" "+$scope.address.street,$scope.address.suburb=$scope.extract("locality")||$scope.extract("sublocality"),$scope.address.postcode=$scope.extract("postal_code"),$scope.address.state=$scope.extract("administrative_area_level_1")):"my"===country?($scope.address.number=$scope.extract("street_number")||"",$scope.address.street=$scope.extract("route")||"",$scope.address.street_line=""+$scope.address.number+" "+$scope.address.street,$scope.address.suburb=$scope.extract("sublocality"),$scope.address.postcode=$scope.extract("postal_code"),$scope.address.state=$scope.extract("locality")||$scope.extract("administrative_area_level_1")):($scope.address.number=$scope.extract("street_number")||"",$scope.address.street=$scope.extract("route")||"",$scope.address.street_line=""+$scope.address.number+" "+$scope.address.street,$scope.address.suburb=$scope.extract("locality"),$scope.address.postcode=$scope.extract("postal_code"),$scope.address.state=$scope.extract("administrative_area_level_1")),$scope.details.geometry&&$scope.details.geometry.location)?($scope.address.latitude=$scope.details.geometry.location.lat(),$scope.address.longitude=$scope.details.geometry.location.lng()):void 0}),$scope.options={country:$scope.country},$scope.extract=function(info){var value;return value=null,$scope.details.address_components.each(function(component){return component.types.each(function(type){return type===info?value=component.long_name:void 0})}),value},$scope.label=function(){return $scope.address_label||"Address"}}}})}.call(this),function(){this.AutoWorkshopApp.directive("selectValueOnClick",function(){return{restrict:"A",link:function(scope,element,attrs){return element.on("click",function(){return element.val()===attrs.selectValueOnClick?element.get(0).setSelectionRange(0,9999):void 0})}}})}.call(this),function(){this.AutoWorkshopFilters.filter("error",function(){return function(errors){return errors?errors.join("and"):void 0}})}.call(this),function(){this.AutoWorkshopFilters.filter("na",function(){return function(value,short){return null==short&&(short=!1),value?value:short?"N/A":"Not Available"}})}.call(this),function(){this.AutoWorkshopFilters.filter("zero_as_na",function($filter){return function(value,currency){return null==currency&&(currency=!0),0!==value?currency?$filter("currency")(value):value:"N/A"}})}.call(this),function(){this.AutoWorkshopApp.config(function($httpProvider){return $httpProvider.responseInterceptors.push(function($q,$location,$window,spinnerService){return function(promise){return promise.then(angular.identity,function(response){return response.config.url.match("/notifications/unread")?$q.reject(response):response.config.url.match("/auto_workshop/subscription_notification")?$q.reject(response):response.config.url.match("/accounting_sync_requests/current")?$q.reject(response):500===response.status?(spinnerService.stop_spinner(".spinner"),alert("The server is unable to process your request due to an unexpected error. Please check your input and try again. If the problem persists, please contact MechanicDesk Support support@mechanicdesk.com.au. We apologise for any inconvenience")):$q.reject(response)})}})})}.call(this),function(){this.AutoWorkshopApp.config(function($httpProvider){return $httpProvider.responseInterceptors.push(function($q,$location,$window,$log,$timeout,spinnerService){return function(promise){return promise.then(angular.identity,function(response){return response.config.url.match("/notifications/unread")?$q.reject(response):response.config.url.match("/auto_workshop/subscription_notification")?$q.reject(response):response.config.url.match("/accounting_sync_requests/current")?$q.reject(response):0===response.status?$timeout(function(){return spinnerService.stop_spinner(".spinner"),alert("Cannot contact server. Please refresh your browser and try again. If the problem persists please contact MechanicDesk Support Team support@mechanicdesk.com.au. We apologise for any inconvenience")},1e3):$q.reject(response)})}})})}.call(this),function(){this.AutoWorkshopApp.config(function($httpProvider){return $httpProvider.responseInterceptors.push(function($q,$window){return function(promise){return promise.then(angular.identity,function(response){return 401===response.status?$window.location.href="login?message="+response.data.message:$q.reject(response)})}})})}.call(this),function(){var __hasProp={}.hasOwnProperty,__slice=[].slice;this.AutoWorkshopApp.service("formService",function(timeService){return{submit_form:function(scope,form,callback){return form.$valid?callback():scope.show_form_validation=!0},focus:function(id,delay){var focus_element;return null==delay&&(delay=0),focus_element=function(){var element;return element=$(id),element&&element.is(":visible")?element.focus():timeService.timeout(focus_element,100)},timeService.timeout(focus_element,delay)},params:function(params,full){var converted,key,subkey,subvalue,value;null==full&&(full=!1),converted={};for(key in params)if(__hasProp.call(params,key))if(value=params[key],Array.isArray(value))converted[""+key+"[]"]=value;else if(null!==value&&value instanceof Date)converted[key]=value.toString();else if(null!==value&&"object"==typeof value)for(subkey in value)__hasProp.call(value,subkey)&&(subvalue=value[subkey],null===subvalue?full&&(converted[""+key+"["+subkey+"]"]=""):converted[""+key+"["+subkey+"]"]=subvalue);else converted[key]=value;return converted},select_text:function(id,delay){var select_element;return null==delay&&(delay=0),select_element=function(){var element;return element=$(id),element&&element.is(":visible")?(element.focus(),element.select()):timeService.timeout(select_element,100)},timeService.timeout(select_element,delay)},edit_fields:function(){var copy,field,fields,source,staging_attribute,_i,_len;if(source=arguments[0],staging_attribute=arguments[1],fields=3<=arguments.length?__slice.call(arguments,2):[],copy={},fields.length>0)for(_i=0,_len=fields.length;_len>_i;_i++)field=fields[_i],copy[field]=angular.copy(source[field]);else angular.copy(source,copy);return source[staging_attribute]=copy},cancel:function(object,attribute){return object[attribute]=void 0}}})}.call(this),function(){this.AutoWorkshopApp.service("popoverService",function(){return{hide:function(popover){return popover=$(""+popover+" .popover"),popover.hide()},show_in_position:function(popover,x,y,options){var fixed,left,placement,top;return null==options&&(options={}),popover=$(""+popover+" > .popover"),popover.hide(),placement=options.placement||"left",fixed=options.fixed,"left"===placement?(top=y-popover.height()/2,left=x-popover.width()):"bottom"===placement?(top=y,left=x-popover.width()/2):"right"===placement?(top=y-popover.height()/2,left=x+popover.width()):"top"===placement&&(top=y-popover.height(),left=x-popover.width()/2),left+popover.width()>window.innerWidth&&(left=window.innerWidth-popover.width()-50),options.fixed_position&&top+popover.height()>window.innerHeight&&(top=window.innerHeight-popover.height()-50),0>top&&(top=100),0>left&&(left=10),popover.css("top",""+top+"px"),popover.css("left",""+left+"px"),popover.css("display","block"),options.fixed_position&&popover.css("position","fixed"),fixed||popover.draggable(),popover.show()},show:function(popover,container,options){var arrow,arrow_top,err,fixed,left,placement,position,top;if(null==options&&(options={}),popover=$(""+popover+" > .popover"),popover.hide(),container=$(container),options.fixed_position)try{position=container[0].getBoundingClientRect(),position.top<=0&&position.left<=0?(popover.css("position",""),position=container.position()):popover.css("position","fixed")}catch(_error){err=_error,popover.css("position",""),position=container.position()}else popover.css("position",""),position=container.position();return placement=options.placement||"left",fixed=options.fixed,"left"===placement?(top=position.top-popover.height()/2+10,left=position.left-popover.width()):"bottom"===placement?(top=position.top+container.height()+15,left=position.left-popover.width()/2+container.width()/2):"right"===placement?(top=position.top-popover.height()/2+10,left=position.left+container.width()+10):"top"===placement&&(top=position.top-popover.height()-15,left=position.left-popover.width()/2+container.width()/2),left+popover.width()>window.innerWidth&&(left=window.innerWidth-popover.width()),0>top&&(top=100),0>left&&(left=10),popover.css("top",""+top+"px"),popover.css("left",""+left+"px"),popover.css("display","block"),"left"===placement&&(arrow=popover.find(".arrow"),arrow_top=position.top-top+15,arrow.css("top",""+arrow_top+"px")),popover.show(),fixed?void 0:popover.draggable()}}})}.call(this),function(){this.AutoWorkshopApp.service("reportService",function($filter){var _this=this;return{init:function(){return _this.bar_label_formatter=function(value){return" "+$filter("round_currency")(value)},_this.label_formatter=function(label,series){return"<div style='font-size:10pt; text-align:center; padding:2px; color:white;'>"+series.percent.toFixed(2)+"%<br/></div>"},_this.legend_formatter=function(label,series){return"<span style='font-size:10pt;'>"+label+": "+$filter("round_currency")(series.data[0][1])+"<span>"},_this.hour_legend_formatter=function(label,series){return"<span style='font-size:10pt;'>"+label+": "+series.data[0][1]+"h<span>"},_this.number_legend_formatter=function(label,series){return"<span style='font-size:10pt;'>"+label+": "+series.data[0][1]+"<span>"},_this.clear_report=function(element){return $(element).empty()}},bar:function(element,data){var i,ticks,values,week_data,_i,_len;if(0===data.length)return _this.clear_report(element);for(ticks=[],values=[],$(element).css("width",100*data.length+35),i=_i=0,_len=data.length;_len>_i;i=++_i)week_data=data[i],ticks.push([i+1,week_data.label]),values.push([i+1,week_data.data]);return $.plot(element,[values],{series:{bars:{show:!0,fillColor:"#757dad"},valueLabels:{show:!0,labelFormatter:_this.bar_label_formatter,font:"bold 10pt Courier"}},xaxis:{ticks:ticks},grid:{borderWidth:0}})},pie:function(element,data,options){var default_options,legend_formatter;return null==options&&(options={}),legend_formatter=options.unit&&"h"===options.unit?_this.hour_legend_formatter:options.unit&&"number"===options.unit?_this.number_legend_formatter:_this.legend_formatter,0===data.length?_this.clear_report(element):(default_options={series:{pie:{show:!0,radius:1,label:{show:!0,radius:.75,formatter:_this.label_formatter,background:{opacity:.5,color:"#000"}}}},legend:{show:!0,labelFormatter:legend_formatter}},$.plot(element,data,$.extend(!0,default_options,options)))}}})}.call(this),function(){this.AutoWorkshopApp.service("spinnerService",function(){return{start_spinner:function(element,size){return null==size&&(size="medium"),$(element).show(),$(element).spin(size)},stop_spinner:function(element){return $(element).hide(),$(element).spin(!1)}}})}.call(this),function(){this.AutoWorkshopApp.service("timeServiceMethods",function(){return{round_to_five_minutes:function(time){var min,mod;return min=time.getMinutes(),mod=min%5,0===mod&&(mod=0),2>=mod&&(mod=mod),mod>2&&(mod=5-mod),time.getMinutes()+mod}}}),this.AutoWorkshopApp.service("timeService",function(timeServiceMethods,$timeout){return{current:function(){var time;return time=new Date,time.setMinutes(timeServiceMethods.round_to_five_minutes(time)),time},round_to_five_minutes:function(time){return timeServiceMethods.round_to_five_minutes(time)},timeout:function(callback,delay){var x;x=function(){callback()},$timeout(x,delay)},cancel_timeout:function(timer){$timeout.cancel(timer)},add_minutes:function(time,minutes){return moment(time).add(minutes,"minutes").toDate()}}})}.call(this),function(){var __slice=[].slice;this.template=function(){var components,path;return components=1<=arguments.length?__slice.call(arguments,0):[],path="",path+=components.join("/"),path.match(/\.html$/)||(path+=".html"),path}}.call(this),function(){var __slice=[].slice;this.AccountingIntegrationController=function($scope,$cookies,$window,$timeout,timeService,lookupService,integrationsNavService,spinnerService,popoverService,AutoWorkshop,AccountingIntegrationAccount,AccountingSyncRequest){return $scope.edit_accounting_integration=function(){return $scope.editing=!0,$scope.editing_accounting_integration_account={third_party:"Xero",enabled:!0},$scope.accounting_integration_account?angular.copy($scope.accounting_integration_account,$scope.editing_accounting_integration_account):void 0},$scope.cancel_edit_accounting_integration=function(){return $scope.editing_accounting_integration_account=void 0,$scope.editing=!1},$scope.save_accounting_integration_account=function(){return $scope.editing_accounting_integration_account.id?AccountingIntegrationAccount.update($scope.editing_accounting_integration_account,function(data){return angular.copy(data,$scope.accounting_integration_account),$scope.editing_accounting_integration_account=void 0,$scope.editing=!1}):AccountingIntegrationAccount.save($scope.editing_accounting_integration_account,function(data){return $scope.accounting_integration_account=data,$scope.editing_accounting_integration_account=void 0,$scope.editing=!1})},$scope.cancel_sync_request=function(request){return AccountingSyncRequest.cancel(request,function(data){return angular.copy(data,request)})},$scope.start_monitoring_sync_requests=function(){return $scope.monitoring_sync_requests=!0,AutoWorkshop.accounting_integration_account(function(data){return $scope.accounting_integration_account=data,$scope.accounting_accounts=data.accounting_accounts||[],$scope.current_sync_requests=data.current_sync_requests||[],0===$scope.current_sync_requests.length?$scope.monitoring_sync_requests=!1:$scope.existed?void 0:timeService.timeout($scope.start_monitoring_sync_requests,3e3)})},$scope.accounting_integration_sync=function(){return $scope.full_sync="",$timeout(function(){return $("#new-sync-request").submit(),$scope.monitoring_sync_requests?void 0:$scope.start_monitoring_sync_requests()})},$scope.accounting_integration_full_sync=function(){return $scope.full_sync=!0,$timeout(function(){return $("#new-sync-request").submit(),$scope.monitoring_sync_requests?void 0:$scope.start_monitoring_sync_requests()})},$scope.unauthorize=function(){return AccountingIntegrationAccount.unauthorize($scope.accounting_integration_account,function(data){return $scope.accounting_integration_account=data})},$scope.edit_accounting_accounts=function(){return lookupService.fetch_accounting_accounts(),$scope.editing_accounting_accounts={disable_stock_sync:$scope.accounting_integration_account.disable_stock_sync,tracking_categories:$scope.accounting_integration_account.tracking_categories.clone(),enable_tracking_category_selection:$scope.accounting_integration_account.enable_tracking_category_selection,id:$scope.accounting_integration_account.id,invoice_account_id:$scope.accounting_integration_account.invoice_account_id,part_sale_account_id:$scope.accounting_integration_account.part_sale_account_id,discount_account_id:$scope.accounting_integration_account.discount_account_id,cash_payment_account_id:$scope.accounting_integration_account.cash_payment_account_id,bank_payment_account_id:$scope.accounting_integration_account.bank_payment_account_id,eftpos_payment_account_id:$scope.accounting_integration_account.eftpos_payment_account_id,direct_debit_payment_account_id:$scope.accounting_integration_account.direct_debit_payment_account_id,credit_card_payment_account_id:$scope.accounting_integration_account.credit_card_payment_account_id,cheque_payment_account_id:$scope.accounting_integration_account.cheque_payment_account_id,paypal_payment_account_id:$scope.accounting_integration_account.paypal_payment_account_id,other_payment_account_id:$scope.accounting_integration_account.other_payment_account_id,customer_credit_account_id:$scope.accounting_integration_account.customer_credit_account_id,bill_account_id:$scope.accounting_integration_account.bill_account_id,part_purchase_account_id:$scope.accounting_integration_account.part_purchase_account_id,bill_cash_payment_account_id:$scope.accounting_integration_account.bill_cash_payment_account_id,bill_payment_account_id:$scope.accounting_integration_account.bill_payment_account_id,bill_eftpos_payment_account_id:$scope.accounting_integration_account.bill_eftpos_payment_account_id,bill_direct_debit_payment_account_id:$scope.accounting_integration_account.bill_direct_debit_payment_account_id,bill_credit_card_payment_account_id:$scope.accounting_integration_account.bill_credit_card_payment_account_id,bill_cheque_payment_account_id:$scope.accounting_integration_account.bill_cheque_payment_account_id,bill_paypal_payment_account_id:$scope.accounting_integration_account.bill_paypal_payment_account_id,bill_other_payment_account_id:$scope.accounting_integration_account.bill_other_payment_account_id,supplier_credit_account_id:$scope.accounting_integration_account.supplier_credit_account_id,invoice_no_gst_tax_type:$scope.accounting_integration_account.invoice_no_gst_tax_type,invoice_gst_tax_type:$scope.accounting_integration_account.invoice_gst_tax_type,invoice_gst_free_tax_type:$scope.accounting_integration_account.invoice_gst_free_tax_type,bill_gst_tax_type:$scope.accounting_integration_account.bill_gst_tax_type,bill_gst_free_tax_type:$scope.accounting_integration_account.bill_gst_free_tax_type,invoice_gst_tax_rate:$scope.accounting_integration_account.invoice_gst_tax_rate,invoice_gst_free_tax_rate:$scope.accounting_integration_account.invoice_gst_free_tax_rate,bill_gst_tax_rate:$scope.accounting_integration_account.bill_gst_tax_rate,bill_gst_free_tax_rate:$scope.accounting_integration_account.bill_gst_free_tax_rate},$scope.editing_accounting_accounts.tracking_categories.each(function(category){return category.options.each(function(option){var selected;return selected=$scope.accounting_integration_account.tracking_category_option_ids.find(function(i){return i.id===option.id}),selected?category.selected_option_id=option.id:void 0})})},$scope.cancel_edit_accounting_accounts=function(){return $scope.editing_accounting_accounts=void 0},$scope.save_accounting_accounts=function(){var option_ids;return option_ids=[],$scope.editing_accounting_accounts.tracking_categories.each(function(category){return category.selected_option_id?option_ids.push(category.selected_option_id):void 0}),$scope.editing_accounting_accounts.tracking_category_option_ids=option_ids,AccountingIntegrationAccount.update_accounts($scope.editing_accounting_accounts,function(data){return angular.copy(data,$scope.accounting_integration_account),$scope.editing_accounting_accounts=void 0})},$scope.remove_accounting_integration=function(){return $scope.showing_remove_integration_dialog=!0},$scope.cancel_remove_accounting_integration=function(){return $scope.showing_remove_integration_dialog=!1},$scope.do_remove_accounting_integration=function(){return AccountingIntegrationAccount["delete"]($scope.accounting_integration_account,function(){return $scope.showing_remove_integration_dialog=!1,$scope.start_monitoring_sync_requests()})},$scope.output_accounts=function(){return lookupService.output_accounts()},$scope.output_input_accounts=function(){return lookupService.output_input_accounts()},$scope.payment_accounts=function(){var result;return result=[],$scope.accounting_integration_account&&$scope.accounting_integration_account.accounting_accounts&&$scope.accounting_integration_account.accounting_accounts.each(function(account){return"BANK"===account.account_type||account.receive_payment?result.push(account):void 0}),result},$scope.input_accounts=function(){return lookupService.input_accounts()},$scope.bank_accounts=function(){return $scope.filter_accounts("BANK")},$scope.filter_accounts=function(){var result,types;return types=1<=arguments.length?__slice.call(arguments,0):[],result=[],$scope.accounting_integration_account&&$scope.accounting_integration_account.accounting_accounts&&$scope.accounting_integration_account.accounting_accounts.each(function(account){return types.each(function(type){return account.tax_type===type||account.account_type===type?result.push(account):void 0})}),result},$scope.show_instruction=function(){return popoverService.show("#instruction-popover","#show-instruction-anchor",{placement:"bottom"})},$scope.hide_instruction=function(){return popoverService.hide("#instruction-popover")},$scope.tax_code_name=function(tax_code){var name;return name=null,$scope.tax_types().each(function(tax){return tax.tax_type===tax_code?name=tax.name:void 0}),name||tax_code},$scope.tax_rates=function(){var i_account;return i_account=$scope.accounting_integration_account,i_account&&i_account.tax_rates&&i_account.tax_rates.length>0?i_account.tax_rates:[]},$scope.tax_types=function(){var i_account;return i_account=$scope.accounting_integration_account,i_account&&i_account.tax_codes&&i_account.tax_codes.length>0?i_account.tax_codes:lookupService.configurations().xero_tax_types},$scope.show_error_hints=function(request){return $scope.showing_error_hint_request=request,popoverService.show_in_position("#request-hints-popover",200,400)},$scope.hide_error_hints=function(){return $scope.showing_error_hint_request=void 0,popoverService.hide("#request-hints-popover")},$scope.$on("$destroy",function(){return $scope.existed=!0}),integrationsNavService.activate("Accounting Integration"),$scope.start_monitoring_sync_requests(),$scope.not_registered_for_gst=lookupService.configurations().not_registered_for_gst,window.$scope=$scope,$scope.csrf_value=$cookies["XSRF-TOKEN"],timeService.timeout(function(){return $scope.cancel_edit_accounting_integration()})}}.call(this),function(){this.AccountingAccountsController=function($scope,$window,administrationNavService,spinnerService,formService,lookupService,popoverService,AutoWorkshop,AccountingAccount){return administrationNavService.activate("Chart of Accounts"),lookupService.fetch_accounting_accounts(),$scope.accounting_accounts=lookupService.accounting_accounts(),$scope.edit=function(account){return formService.edit_fields(account,"editing"),$scope.editing_account=account.editing,popoverService.show("#accounting-account-popover","#accounting-account-"+account.id,{placement:"top"})},$scope.cancel_edit=function(){return $scope.editing_account=void 0,popoverService.hide("#accounting-account-popover")},$scope["new"]=function(){return $scope.editing_account={active:!0},popoverService.show("#accounting-account-popover","#new-accounting-account",{placement:"left"})},$scope.save=function(){return $scope.editing_account.id?AccountingAccount.update($scope.editing_account,function(){return $scope.cancel_edit(),lookupService.fetch_accounting_accounts()}):AccountingAccount.save($scope.editing_account,function(){return $scope.cancel_edit(),lookupService.fetch_accounting_accounts()})}}}.call(this),function(){this.AutoWorkshopApp.service("accountingNavService",function(navbarService){var _this=this;return this.active="Invoices",{activate:function(activate,title){return _this.active=activate,title||(title=activate),navbarService.activate("Invoices & Bills",title)},active:function(){return _this.active}}}),this.AccountingNavController=function($scope,timeService,navbarService,accountingNavService,lookupService,Session){return $scope.links=[{name:"Invoices",href:"#/jobs",icon:"icon-dollar"}],Session.current(function(session){return session&&(session.is_admin||session.is_staff)?timeService.timeout(function(){return $scope.links=[{name:"Invoices",href:"#/invoices",icon:"icon-dollar"},{name:"Customer Payments",href:"#/payments",icon:"icon-dollar"},{name:"Customer Credit Notes",href:"#/credit_notes",icon:"icon-dollar"},{name:"Bills",href:"#/bills",icon:"icon-dollar"},{name:"Bill Payments",href:"#/bill_payments",icon:"icon-dollar"},{name:"Supplier Credit Notes",href:"#/supplier_credit_notes",icon:"icon-dollar"},{name:"Invoice Items",href:"#/costs",icon:"icon-tag"}]}):void 0}),$scope.active=function(){return accountingNavService.active()},$scope.isActive=function(name){return name===$scope.active()?"active":""}}}.call(this),function(){this.AutoWorkshopApp.service("administrationNavService",function(navbarService){var _this=this;return this.active="Employees",{activate:function(activate,title){return _this.active=activate,title||(title=activate),navbarService.activate("Settings",title)
},active:function(){return _this.active}}}),this.AdministrationNavController=function($scope,timeService,navbarService,administrationNavService,Session){return $scope.links=[{name:"Personal Details",href:"#/personal/show",icon:"icon-info-sign"}],Session.current(function(session){return session.is_admin?timeService.timeout(function(){return $scope.links.push([{name:"Workshop Details",href:"#/auto_workshop_details",icon:"icon-info-sign"},{name:"Employees",href:"#/employees",icon:"icon-user"},{name:"Chart of Accounts",href:"#/accounting_accounts",icon:""},{name:"Integrations",href:"#/integrations/accounting",icon:"icon-refresh"},{name:"Data Export/Import",href:"#/data_export",icon:"icon-share"}]),$scope.links=$scope.links.flatten()}):session.is_staff&&!session.restrictions.any("access_integrations")?timeService.timeout(function(){return $scope.links.push([{name:"Integrations",href:"#/integrations/accounting",icon:"icon-refresh"}]),$scope.links=$scope.links.flatten()}):void 0}),$scope.active=function(){return administrationNavService.active()},$scope.isActive=function(name){return name===$scope.active()?"active":""}}}.call(this),function(){var __slice=[].slice;this.ApplicationController=function($scope,$route,$window,$location,timeService,navbarService,lookupService,repcoNavigatorService,savedTextsService){return $scope.partial=function(){var components,path,paths;return components=1<=arguments.length?__slice.call(arguments,0):[],components[0].match(/^\//)?template(components):(paths=$route.current.templateUrl.split("/"),paths.pop(),path=""+paths.join("/")+"/"+components.join("/"),path.match(/\.html$/)||(path+=".html"),path)},$scope.asset_name=function(){return lookupService.asset_name()},$scope.wof_name=function(){return lookupService.wof_name()},$scope.asset_property_set=function(){return lookupService.asset_property_set()},$scope.asset_name_plural=function(){return lookupService.asset_name_plural()},$scope.repco_account=function(){return lookupService.repco_account()},$scope.active_repco_account=function(){return repcoNavigatorService.active_repco_account()},$scope.no_wof=function(){return lookupService.configurations()?lookupService.configurations().no_wof:void 0},$scope.quantum_account=function(){return lookupService.quantum_account()},$scope.pro_link_account=function(){return lookupService.pro_link_account()},$scope.bank_accounts=function(){return lookupService.bank_accounts()},$scope.country=function(){return lookupService.configurations().country},$scope.enable_tracking_category_selection=function(){return lookupService.configurations().enable_tracking_category_selection},$scope.tax_name=function(){return lookupService.tax_name()},$scope.disable_default_pickup_time=function(){return lookupService.configurations().disable_default_pickup_time},$scope.back=function(){return $window.history.back()},$scope.copy_fields=function(){var destination,field,fields,source,_i,_len,_results;if(source=arguments[0],destination=arguments[1],fields=3<=arguments.length?__slice.call(arguments,2):[],fields.length>0){for(_results=[],_i=0,_len=fields.length;_len>_i;_i++)field=fields[_i],_results.push(destination[field]=source[field]);return _results}return angular.copy(source,destination)},$scope.is_present=function(object){return!$.isEmptyObject(object)},$scope.cancel=function(object,attribute){return object[attribute]=void 0},$scope.goto=function(path,options){return null==options&&(options={}),$location.path(path).search(options)},$scope.show_popover=function(popover,container,options){var arrow,arrow_top,left,placement,position,top;return null==options&&(options={}),$scope.hide_popover(popover),popover=$(""+popover+" .popover"),container=$(container),position=container.position(),placement=options.placement||"left","left"===placement?(top=position.top-popover.height()/2+10,left=position.left-popover.width()):"bottom"===placement?(top=position.top+container.height()+15,left=position.left-popover.width()/2+container.width()/2):"right"===placement&&(top=position.top-popover.height()/2+10,left=position.left+container.width()+10),100>top&&(top=100),popover.css("top",""+top+"px"),popover.css("left",""+left+"px"),popover.css("display","block"),"left"===placement&&(arrow=popover.find(".arrow"),arrow_top=position.top-top+15,arrow.css("top",""+arrow_top+"px")),popover.show()},$scope.hide_popover=function(popover){return popover=$(""+popover+" .popover"),popover.hide()},$scope.submit_form=function(form,callback){return form.$valid?callback():$scope.show_form_validation=!0},$scope.select_text=function(id,delay){var select_element;return null==delay&&(delay=0),select_element=function(){var element;return element=$(id),element&&element.is(":visible")?(element.focus(),element.select()):timeService.timeout(select_element,100)},timeService.timeout(select_element,delay)},$scope.focus=function(id,delay){var focus_element;return null==delay&&(delay=0),focus_element=function(){var element;return element=$(id),element&&element.is(":visible")?element.focus():timeService.timeout(select_element,100)},timeService.timeout(focus_element,delay)},$scope.start_spinner=function(element){return $(element).spin("medium")},$scope.stop_spinner=function(element){return $(element).spin(!1)},$scope.unread_notification_count=function(){return navbarService.unread_notification_count()},$scope.booking_request_count=function(){return navbarService.booking_request_count()},$scope.subscription_notification=function(){var session;return session=lookupService.session(),session&&session.is_admin?navbarService.subscription_notification():void 0},$scope.subscription_notification_code=function(){return navbarService.subscription_notification_code()},$scope.restricted_to_enter_payment=function(){var session;return session=lookupService.session(),session&&session.restrictions&&session.restrictions.any("create_payments")},$scope.restricted_to=function(){var restricted,restrictions,session;return restrictions=1<=arguments.length?__slice.call(arguments,0):[],session=lookupService.session(),restricted=!1,session&&session.restrictions&&restrictions.forEach(function(r){return session.restrictions.any(r)?restricted=!0:void 0}),restricted},angular.element($window).on("keydown",function(e){return 118===e.keyCode?savedTextsService.toggle():void 0})}}.call(this),function(){this.AssetAttributesController=function($scope,$cookies,$window,formService,lookupService,autoWorkshopSettingsNavService,spinnerService,AutoWorkshop,AssetPropertySet,timeService){return autoWorkshopSettingsNavService.activate("Service Item Attributes"),$scope.csrf_value=$cookies["XSRF-TOKEN"],$scope.asset_property_set=lookupService.asset_property_set(),$scope.save=function(attribute,delay){var attributes,saving;return null==delay&&(delay=0),attributes={id:$scope.asset_property_set.id},attributes[attribute]=$scope.asset_property_set[attribute],saving=function(){return spinnerService.start_spinner("#asset-property-set-spinner"),AssetPropertySet.update(attributes,function(){return spinnerService.stop_spinner("#asset-property-set-spinner"),lookupService.fetch_configurations()})},timeService.timeout(saving,delay)}}}.call(this),function(){this.AutoWorkshopDetailsController=function($scope,$cookies,$window,formService,lookupService,autoWorkshopSettingsNavService,spinnerService,AutoWorkshop,Invoice){return $scope.tax_registration_name=function(){return lookupService.tax_registration_name()},AutoWorkshop.get(function(data){return $scope.auto_workshop=data,$scope.invoice_resource_number=$scope.auto_workshop.resource_numbers.find(function(rn){return"invoice"===rn.resource})}),$scope.select_invoice_template=function(){return $scope.selecting_invoice_template=!0},$scope.cancel_select_invoice_template=function(){return $scope.selecting_invoice_template=!1},$scope.edit_invoice_number=function(){var copy;return copy={},angular.copy($scope.invoice_resource_number,copy),$scope.invoice_resource_number.editing=copy},$scope.cancel_edit_invoice_number=function(){return $scope.invoice_resource_number.editing=void 0},$scope.save_invoice_number=function(){return AutoWorkshop.update_resource_number($scope.invoice_resource_number.editing,function(data){return data.errors?angular.copy(data,$scope.invoice_resource_number.editing):angular.copy(data,$scope.invoice_resource_number)})},$scope.edit_rounding=function(){return formService.edit_fields($scope.auto_workshop,"editing_rounding","rounding")},$scope.cancel_edit_rounding=function(){return formService.cancel($scope.auto_workshop.editing_rounding)},$scope.save_rounding=function(){return AutoWorkshop.update($scope.auto_workshop.editing_rounding,function(data){return angular.copy(data,$scope.auto_workshop)})},$scope.edit_buyin_markup_percentage=function(){return formService.edit_fields($scope.auto_workshop,"editing_buyin_markup_percentage","id","buyin_markup_percentage","buyin_markup_percentage2","buyin_markup_percentage3","buyin_markup_percentage4","buyin_markup_percentage5","buyin_markup_percentage6","buyin_markup_percentage7")},$scope.cancel_edit_buyin_markup_percentage=function(){return $scope.auto_workshop.editing_buyin_markup_percentage=void 0},$scope.save_buyin_markup_percentage=function(){return AutoWorkshop.update($scope.auto_workshop.editing_buyin_markup_percentage,function(data){return $scope.auto_workshop.buyin_markup_percentage=data.buyin_markup_percentage,$scope.auto_workshop.buyin_markup_percentage2=data.buyin_markup_percentage2,$scope.auto_workshop.buyin_markup_percentage3=data.buyin_markup_percentage3,$scope.auto_workshop.buyin_markup_percentage4=data.buyin_markup_percentage4,$scope.auto_workshop.buyin_markup_percentage5=data.buyin_markup_percentage5,$scope.auto_workshop.buyin_markup_percentage6=data.buyin_markup_percentage6,$scope.auto_workshop.buyin_markup_percentage7=data.buyin_markup_percentage7,$scope.auto_workshop.editing_buyin_markup_percentage=void 0,lookupService.fetch_configurations()})},$scope.edit_invoice_thank_you_comment=function(){return formService.edit_fields($scope.auto_workshop,"editing_invoice_thank_you_comment","invoice_thank_you_comment"),formService.select_text("#editing-invoice-thank-you-comment")},$scope.cancel_edit_invoice_thank_you_comment=function(){return $scope.auto_workshop.editing_invoice_thank_you_comment=void 0},$scope.save_invoice_thank_you_comment=function(){return AutoWorkshop.update($scope.auto_workshop.editing_invoice_thank_you_comment,function(data){return angular.copy(data,$scope.auto_workshop)})},$scope.edit_workshop_details=function(){return formService.edit_fields($scope.auto_workshop,"editing_details","id","registered_name","abn","acn","tax_registration_number","licence","name","servicings","prices_include_gst","send_booking_reminder","send_booking_confirmation","booking_reminder_by","booking_reminder_days_prior","allow_partner_login","opening_time","closing_time","provide_mobile_service","export_email"),$scope.auto_workshop.editing_details.registered_for_gst=!$scope.auto_workshop.not_registered_for_gst},$scope.edit_workshop_contacts=function(){return formService.edit_fields($scope.auto_workshop,"editing_contacts","id","phone","fax","address","email","website")},$scope.upload_logo=function(data){return angular.copy(data,$scope.auto_workshop)},$scope.close_logo_upload=function($event){return $scope.auto_workshop.uploading_logo=void 0,$event.stopPropagation(),!1},$scope.delete_logo=function($event){return AutoWorkshop.delete_logo(function(data){return angular.copy(data,$scope.auto_workshop)}),$event.stopPropagation(),!1},$scope.upload_invoice_ad=function(data){return angular.copy(data,$scope.auto_workshop)},$scope.close_invoice_ad_upload=function($event){return $scope.auto_workshop.uploading_invoice_ad=void 0,$event.stopPropagation(),!1},$scope.delete_invoice_ad=function($event){return AutoWorkshop.delete_invoice_ad(function(data){return angular.copy(data,$scope.auto_workshop)}),$event.stopPropagation(),!1},$scope.save_auto_workshop_details=function(){return $scope.auto_workshop.editing_details.not_registered_for_gst=!$scope.auto_workshop.editing_details.registered_for_gst,AutoWorkshop.update($scope.auto_workshop.editing_details,function(data){return angular.copy(data,$scope.auto_workshop),lookupService.fetch_configurations()})},$scope.save_auto_workshop_contacts=function(){return $scope.submit_form($scope.edit_contact_form,function(){return AutoWorkshop.update($scope.auto_workshop.editing_contacts,function(data){return angular.copy(data,$scope.auto_workshop)})})},$scope.change_plan=function(){return $scope.show_pricing_plan=!0},$scope.update_auto_workshop=function(){return AutoWorkshop.get(function(data){return angular.copy(data,$scope.auto_workshop)})},$scope.pay=function(invoice){return $scope.paying_placement="#pay-invoice-"+invoice.id,$scope.paying_invoice=invoice,$scope.paying_title="Paying Invoice "+$scope.paying_invoice.invoice_number,$scope.paying=!0},$scope.update_card_details=function(){return $scope.paying_invoice=void 0,$scope.paying=!0,$scope.paying_title="Update Card"},$scope.edit_quote_footer=function(){return formService.edit_fields($scope.auto_workshop,"editing_quote_footer","quote_footer"),formService.select_text("#editing-quote-footer")},$scope.cancel_edit_quote_footer=function(){return $scope.auto_workshop.editing_quote_footer=void 0},$scope.save_quote_footer=function(){return AutoWorkshop.update($scope.auto_workshop.editing_quote_footer,function(data){return angular.copy(data,$scope.auto_workshop)})},$scope.edit_surcharge=function(){return $scope.editing_surcharge={},$scope.auto_workshop.surcharge?angular.copy($scope.auto_workshop.surcharge,$scope.editing_surcharge):void 0},$scope.cancel_edit_surcharge=function(){return $scope.editing_surcharge=void 0},$scope.save_surcharge=function(){return AutoWorkshop.surcharge($scope.editing_surcharge,function(data){return $scope.auto_workshop.surcharge=data,lookupService.fetch_configurations(),$scope.editing_surcharge=void 0})},$scope.edit_diary=function(){return $scope.showing_diary=!0},autoWorkshopSettingsNavService.activate("Workshop"),$scope.csrf_value=$cookies["XSRF-TOKEN"],$scope.invoice_templates=Invoice.templates(),$scope.output_accounts=lookupService.output_accounts()}}.call(this),function(){this.AutoWorkshopApp.service("autoWorkshopSettingsNavService",function(navbarService,administrationNavService){var _this=this;return this.active="Workshop",{activate:function(activate){return navbarService.activate("Settings"),administrationNavService.activate("Workshop Details"),_this.active=activate},active:function(){return _this.active}}}),this.AutoWorkshopSettingsNavController=function($scope,autoWorkshopSettingsNavService){return $scope.links=[{path:"auto_workshop_details",name:"Workshop"},{path:"asset_attributes",name:"Service Item Attributes"},{path:"online_booking",name:"Online Booking"},{path:"numbering",name:"Numbering Settings"},{path:"misc",name:"Miscellaneous"}],$scope.active=function(){return autoWorkshopSettingsNavService.active()},$scope.isActive=function(name){return name===$scope.active()?"active":""}}}.call(this),function(){this.MiscController=function($scope,$cookies,$window,formService,lookupService,autoWorkshopSettingsNavService,spinnerService,AutoWorkshop){return autoWorkshopSettingsNavService.activate("Miscellaneous"),$scope.csrf_value=$cookies["XSRF-TOKEN"],$scope.payment_terms=lookupService.payment_terms(),AutoWorkshop.options(function(data){return $scope.auto_workshop=data}),$scope.edit=function(attribute){return formService.edit_fields($scope.auto_workshop,"editing_"+attribute,"id",attribute)},$scope.cancel_edit=function(attribute){return formService.cancel($scope.auto_workshop,"editing_"+attribute)},$scope.save=function(attribute){return spinnerService.start_spinner("#asset-property-set-spinner"),AutoWorkshop.update($scope.auto_workshop["editing_"+attribute],function(data){var quote_types;return $scope.auto_workshop[attribute]=data[attribute],"default_payment_term"===attribute?$scope.auto_workshop.default_payment_term_name=data.default_payment_term_name:"default_supplier_payment_term"===attribute?$scope.auto_workshop.default_supplier_payment_term_name=data.default_supplier_payment_term_name:"default_diary_view"===attribute?$scope.auto_workshop.default_diary_view_name=data.default_diary_view_name:"quote_title"===attribute&&(quote_types=lookupService.quote_types(),quote_types.unshift(data[attribute]),quote_types=quote_types.unique(),lookupService.set_quote_types(quote_types)),$scope.auto_workshop["editing_"+attribute]=void 0,spinnerService.stop_spinner("#asset-property-set-spinner"),lookupService.fetch_configurations()})}}}.call(this),function(){this.NumberingController=function($scope,$cookies,$window,formService,lookupService,autoWorkshopSettingsNavService,spinnerService,AutoWorkshop){return $scope.edit_resource_number=function(resource_type){var copy,_base;return $scope.error_message={},copy={},(_base=$scope.resource_number_list)[resource_type]||(_base[resource_type]={}),angular.copy($scope.resource_number_list[resource_type],copy),$scope.resource_number_list[resource_type].editing=copy},$scope.cancel_edit_resource_number=function(resource_type){return $scope.error_message={},$scope.resource_number_list[resource_type].editing=void 0},$scope.save_resource_number=function(resource_type){return AutoWorkshop.update_resource_number($scope.resource_number_list[resource_type].editing,function(data){return data.errors?$scope.error_message[resource_type]=data.errors.next_number[0]:($scope.error_message={},angular.copy(data,$scope.resource_number_list[resource_type]))})},autoWorkshopSettingsNavService.activate("Numbering Settings"),$scope.resource_number_list={Invoice:{resource:"invoice"},Quote:{resource:"quote"},"Purchase Order":{resource:"purchase"},Job:{resource:"invoice"},"Credit Note":{resource:"credit_note"}},AutoWorkshop.get(function(data){var credit_rnumber,invoice_rnumber,job_rnumber,po_rnumber,quote_rnumber;return $scope.auto_workshop=data,$scope.fetched=!0,invoice_rnumber=$scope.auto_workshop.resource_numbers.find(function(rn){return"invoice"===rn.resource}),invoice_rnumber&&($scope.resource_number_list.Invoice=invoice_rnumber),quote_rnumber=$scope.auto_workshop.resource_numbers.find(function(rn){return"quote"===rn.resource}),quote_rnumber&&($scope.resource_number_list.Quote=quote_rnumber),po_rnumber=$scope.auto_workshop.resource_numbers.find(function(rn){return"purchase"===rn.resource}),po_rnumber&&($scope.resource_number_list["Purchase Order"]=po_rnumber),job_rnumber=$scope.auto_workshop.resource_numbers.find(function(rn){return"job"===rn.resource}),job_rnumber&&($scope.resource_number_list.Job=job_rnumber),credit_rnumber=$scope.auto_workshop.resource_numbers.find(function(rn){return"credit_note"===rn.resource}),credit_rnumber?$scope.resource_number_list["Credit Note"]=credit_rnumber:void 0}),$scope.resource_number_types_left=["Purchase Order","Job","Credit Note"],$scope.resource_number_types_right=["Invoice","Quote"]}}.call(this),function(){this.OnlineBookingController=function($scope,$cookies,$window,formService,lookupService,autoWorkshopSettingsNavService,spinnerService,AutoWorkshop){return $scope.enabled=function(){return lookupService.configurations().enable_booking_requests},$scope.enable=function(){return AutoWorkshop.enable_online_booking(function(){return lookupService.fetch_configurations()})},$scope.escapeHTML=function(unsafe){return unsafe.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},$scope.booking_notification=function(){return lookupService.configurations().online_booking_notification_by},$scope.edit_online_booking=function(){return $scope.editing_online_booking={online_booking_notification_by:lookupService.configurations().online_booking_notification_by,online_booking_notification_number:lookupService.configurations().online_booking_notification_number,online_booking_notification_email:lookupService.configurations().online_booking_notification_email,online_booking_confirmation_by:lookupService.configurations().online_booking_confirmation_by}},$scope.save_online_booking=function(){return AutoWorkshop.update($scope.editing_online_booking,function(){return lookupService.fetch_configurations(),$scope.editing_online_booking=void 0})},$scope.cancel_online_booking=function(){return $scope.editing_online_booking=void 0},$scope.booking_notification_to=function(){return"email"===lookupService.configurations().online_booking_notification_by?lookupService.configurations().online_booking_notification_email:"sms"===lookupService.configurations().online_booking_notification_by?lookupService.configurations().online_booking_notification_number:void 0},$scope.booking_confirmation_by=function(){var wording;return wording={"":"",email_then_sms:"Email then SMS",sms_then_email:"SMS then Email",email:"Email Only",sms:"SMS Only",email_and_sms:"Both Email and SMS"},lookupService.configurations().online_booking_confirmation_by?wording[lookupService.configurations().online_booking_confirmation_by]:""},$scope.url=function(){return"<iframe src='https://www.mechanicdesk.com.au/booking_requests/new?token="+lookupService.configurations().booking_request_token+"' width='700' height='750' frameBorder='0'></iframe>"},autoWorkshopSettingsNavService.activate("Online Booking")}}.call(this),function(){this.BillPaymentsController=function($scope,$location,$routeParams,accountingNavService,spinnerService,lookupService,BillPayment,timeService){var search_query;return $scope.search=function(page){var search_query;return null==page&&(page=1),search_query={query:$scope.query,page:page,order:$scope.order,order_by:$scope.order_by},lookupService.save_search_query("bill_payments",search_query),$scope.start_spinner("#bill-payments-spinner"),BillPayment.search(search_query,function(data){return $scope.stop_spinner("#bill-payments-spinner"),$scope.keyword=$scope.query.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.bill_payments=data.bill_payments,$scope.bank_accounts=lookupService.bank_accounts()})},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.search()},$scope.toggle_deleted=function(){return timeService.timeout(function(){return $scope.query.finalized=void 0,$scope.query.in_progress=void 0,$scope.search()})},$scope.toggle_unallocated=function(){return timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.search()})},$scope.toggle_finalized=function(){return timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.in_progress=void 0,$scope.search()})},$scope.toggle_in_progress=function(){return timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.finalized=void 0,$scope.search()})},accountingNavService.activate("Bill Payments"),search_query=lookupService.search_query("bill_payments"),search_query&&search_query.query&&$routeParams.cached?($scope.query=search_query.query,$scope.order=search_query.order,$scope.order_by=search_query.order_by,$scope.search(search_query.page||1)):($scope.query={query:null},lookupService.save_search_query("bill_payments",{query:{query:""}}),$location.path("/bill_payments").search({cached:Math.random()}).replace())}}.call(this),function(){this.NewBillPaymentController=function($scope,$location,$routeParams,lookupService,spinnerService,accountingNavService,Stock,Supplier,Bill,BillPayment){var cash_payment_method;return accountingNavService.activate("Bill Payments"),$scope.payment_methods=lookupService.payment_methods(),cash_payment_method=lookupService.payment_method("cash"),$scope.bill_payment={date:new Date,due_date:new Date,payment_method_id:cash_payment_method?cash_payment_method.id:void 0},$routeParams.bill_id&&Bill.get({id:$routeParams.bill_id},function(data){return $scope.bill=data,$scope.bill_payment.bill_id=$routeParams.bill_id,$scope.bill_payment.amount=data.unpaid_amount,$scope.bill_payment.supplier_id=data.billing_supplier_id,$scope.bill_payment.supplier=data.billing_supplier}),$routeParams.supplier_id&&Supplier.get({id:$routeParams.supplier_id},function(data){return $scope.bill_payment.supplier=data,$scope.bill_payment.supplier_id=data.id}),$scope.save_bill_payment=function(){return $scope.bill_payment.supplier_id?$scope.bill_payment.payment_method_id?(spinnerService.start_spinner("#bill-payment-spinner"),BillPayment.save($scope.bill_payment,function(data){return spinnerService.stop_spinner("#bill-payment-spinner"),$location.path("/bill_payments/"+data.id)})):alert("Please select payment type"):alert("Please select a supplier from the dropdown or click 'New' to create one")},$scope.show_select_bank_account=function(){return cash_payment_method=lookupService.payment_method("cash"),$scope.bill_payment.payment_method_id&&cash_payment_method&&lookupService.bank_accounts().length>1?$scope.bill_payment.payment_method_id!==cash_payment_method.id:void 0}}}.call(this),function(){this.ShowBillPaymentController=function($scope,accountingNavService,lookupService,spinnerService,formService,confirmationService,popoverService,$routeParams,Stock,BillPayment){return accountingNavService.activate("Bill Payments"),$scope.payment_methods=lookupService.payment_methods(),spinnerService.start_spinner("#bill-payment-loading"),$scope.bill_payment=BillPayment.get({id:$routeParams.id},function(){return spinnerService.stop_spinner("#bill-payment-loading")}),$scope.selected_bills=[],$scope.open_delete_dialog=function(){return $scope.showing_delete_bill_payment_dialog=!0},$scope.do_delete_bill_payment=function(){return spinnerService.start_spinner("#delete-bill-payment-spinner"),$scope.bill_payment=BillPayment["delete"]({id:$scope.bill_payment.id,deleted_reason:$scope.deleted_reason},function(){return spinnerService.stop_spinner("#delete-bill-payment-spinner"),$scope.showing_delete_bill_payment_dialog=!1})},$scope.cancel_delete_bill_payment=function(){return $scope.showing_delete_bill_payment_dialog=!1},$scope.add_bills=function(){return $scope.selected_purchase_orders=[],$scope.showing_related_bills=!0},$scope.save_selected_bills=function(){var bill_allocations;return bill_allocations=[],$scope.selected_bills.each(function(bill){return bill_allocations.push({bill_id:bill.id,amount:bill.allocated_amount})}),BillPayment.allocate_payments({id:$scope.bill_payment.id,bill_allocations:bill_allocations},function(data){return angular.copy(data,$scope.bill_payment),$scope.selected_bills=[],$scope.showing_related_bills=!1})},$scope.finalize=function(){return BillPayment.finalize({id:$scope.bill_payment.id},function(data){return angular.copy(data,$scope.bill_payment)})},$scope.edit_bill_payment=function(){return formService.edit_fields($scope.bill_payment,"editing","id","supplier_id","date","amount","reference","supplier","payment_method_id","accounting_account_id")},$scope.save_bill_payment=function(){var updated;return updated=new BillPayment($scope.bill_payment.editing),updated.$update(function(data){return angular.copy(data,$scope.bill_payment)})},$scope.cancel_edit_bill_payment=function(){return $scope.bill_payment.editing=void 0},$scope.save_bpayment=function(bpayment){return BillPayment.update_allocation({id:$scope.bill_payment.id,allocation:bpayment.editing},function(data){return angular.copy(data,$scope.bill_payment)})},$scope.remove_bpayment=function(bpayment){return confirmationService.confirm("Are you sure you want to delete this allocation?",!0,function(){return BillPayment.remove_allocation({id:$scope.bill_payment.id,bill_id:bpayment.bill_id},function(data){return angular.copy(data,$scope.bill_payment)})})},$scope.show_select_bank_account=function(){return $scope.bill_payment.editing&&"cash"!==$scope.bill_payment.editing.payment_type&&!$scope.bill_payment.original_bill_payment_id?lookupService.bank_accounts().length>1&&$scope.choose_specific_bank_account||$scope.bill_payment.accounting_account_id:void 0},$scope.open_email_bill_payment=function(){return $scope.email_bill_payment_to=$scope.bill_payment.supplier.email,$scope.email_bill_payment_subject=$scope.bill_payment.email_preview.subject,$scope.email_bill_payment_message=$scope.bill_payment.email_preview.message,popoverService.show("#bill-payment-send-email","#send-bill-payment",{placement:"left"})},$scope.cancel_email_bill_payment=function(){return popoverService.hide("#bill-payment-send-email")},$scope.email_bill_payment=function(){return $scope.email_bill_payment_to?(spinnerService.start_spinner("#bill-payment-send-email-spinner"),BillPayment.send_email({id:$scope.bill_payment.id,email:$scope.email_bill_payment_to,subject:$scope.email_bill_payment_subject,message:$scope.email_bill_payment_message},function(data){return spinnerService.stop_spinner("#bill-payment-send-email-spinner"),data.error?alert(data.error.message):popoverService.hide("#bill-payment-send-email")})):alert("Please provide a email address to send to")}}}.call(this),function(){this.BillsController=function($scope,$location,$routeParams,formService,lookupService,accountingNavService,spinnerService,timeService,Bill){var search_query;return $scope.search=function(page){var search_count,search_query;return null==page&&(page=1),search_query={query:$scope.query,page:page,showing_deleted:$scope.showing_deleted,showing_paid:$scope.showing_paid,showing_unpaid:$scope.showing_unpaid,showing_in_progress:$scope.showing_in_progress,showing_finalized:$scope.showing_finalized,showing_filter:$scope.showing_filter,order:$scope.order,order_by:$scope.order_by},lookupService.save_search_query("bills",search_query),$scope.start_spinner("#bills-spinner"),$scope.search_count||($scope.search_count=0),$scope.search_count+=1,search_count=$scope.search_count,Bill.search(search_query,function(data){return search_count===$scope.search_count?($scope.keyword=$scope.query.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.bills=data.bills,$scope.stop_spinner("#bills-spinner")):void 0})},$scope.show_filter=function(){return $scope.showing_filter=!0},$scope.hide_filter=function(){return $scope.query.issued_from="",$scope.query.issued_to="",$scope.query.statuses=["paid","unpaid","deleted"],$scope.showing_filter=!1},$scope.toggle_deleted=function(number){return null==number&&(number=1),$scope.showing_unpaid=!1,$scope.showing_paid=!1,$scope.showing_finalized=!1,$scope.showing_in_progress=!1,timeService.timeout(function(){return $scope.query.statuses=void 0,$scope.query.finalized=void 0,$scope.query.in_progress=void 0,$scope.query.deleted=$scope.showing_deleted?!0:void 0,$scope.search()})},$scope.toggle_unpaid=function(number){return null==number&&(number=1),$scope.showing_deleted=!1,$scope.showing_paid=!1,timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.statuses=$scope.showing_unpaid?["unpaid"]:["unpaid","paid"],$scope.search()})},$scope.toggle_paid=function(number){return null==number&&(number=1),$scope.showing_deleted=!1,$scope.showing_unpaid=!1,timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.statuses=$scope.showing_paid?["paid"]:["unpaid","paid"],$scope.search()})},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.search()},$scope.toggle_finalized=function(number){return null==number&&(number=1),$scope.showing_deleted=!1,$scope.showing_in_progress=!1,timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.in_progress=void 0,$scope.query.finalized=$scope.showing_finalized?!0:void 0,$scope.search()})},$scope.download=function(){var params;return params=formService.params({query:$scope.query}),window.open("/bills/download?"+$.param(params))},$scope.preview=function(bill){return $scope.previewed_bill=bill},$scope.tags=function(){return lookupService.tags_of_type("Bill")},$scope.toggle_in_progress=function(number){return null==number&&(number=1),$scope.showing_deleted=!1,$scope.showing_finalized=!1,timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.finalized=void 0,$scope.query.in_progress=$scope.showing_in_progress?!0:void 0,$scope.search()})},$scope.bulk_finalize=function(){var ids,selected;return selected=$scope.bills.findAll(function(b){return b.selected}),selected&&0!==selected.length?(ids=selected.map(function(b){return b.id}),$scope.start_spinner("#bill-bulk-action-spinner"),Bill.bulk_finalize({ids:ids},function(){return $scope.stop_spinner("#bill-bulk-action-spinner"),$scope.search()})):alert("Please select one or more bills to finalize")},$scope.toggle_select_all=function(){return $scope.all_selected?($scope.bills.forEach(function(b){return b.selected=!1}),$scope.all_selected=!1):($scope.all_selected=!0,$scope.bills.forEach(function(b){return b.selected=!0
}))},accountingNavService.activate("Bills"),search_query=lookupService.search_query("bills"),search_query&&search_query.query&&$routeParams.cached?($scope.query=search_query.query,$scope.showing_unpaid=search_query.showing_unpaid,$scope.showing_paid=search_query.showing_paid,$scope.showing_deleted=search_query.showing_deleted,$scope.showing_in_progress=search_query.showing_in_progress,$scope.showing_finalized=search_query.showing_finalized,$scope.showing_filter=search_query.showing_filter,$scope.order=search_query.order,$scope.order_by=search_query.order_by,$scope.search(search_query.page||1)):($scope.query={query:null},lookupService.save_search_query("bills",{query:{query:""},statuses:["unpaid","paid"]}),$location.path("/bills").search({cached:Math.random()}).replace())}}.call(this),function(){this.NewBillController=function($scope,$location,$routeParams,spinnerService,lookupService,confirmationService,accountingNavService,formService,paymentTermService,timeService,Stock,Supplier,Bill,Purchase){return accountingNavService.activate("Bills"),$scope.bill={date:new Date,due_date:new Date},$scope.input_accounts=lookupService.input_accounts(),$routeParams.purchase_id&&($scope.purchase=Purchase.get({id:$routeParams.purchase_id},function(data){return $scope.bill.purchase_id=data.id,$scope.bill.supplier_id=data.supplier_id,$scope.bill.billing_supplier_id=data.creditor_id,$scope.bill.supplier=data.supplier,$scope.bill.total_amount=data.total_amount,$scope.bill.tracking_categories=data.tracking_categories})),$routeParams.supplier_id&&Supplier.get({id:$routeParams.supplier_id},function(data){return $scope.bill.supplier={},angular.copy(data,$scope.bill.supplier),$scope.bill.supplier_id=data.id,$scope.bill.billing_supplier_id=data.creditor_id}),formService.select_text("#supplierpicker-name"),$scope.save_bill=function(){var no_amount;return $scope.bill.supplier_id?(no_amount=!$scope.bill.total_amount||0===$scope.bill.total_amount,confirmationService.confirm("You have not enter the bill total amount, are you sure you want to proceed?",no_amount,function(){return $scope.bill.errors=void 0,spinnerService.start_spinner("#create-bill-spinner"),Bill.save($scope.bill,function(data){return spinnerService.stop_spinner("#create-bill-spinner"),data.errors?angular.copy(data,$scope.bill):$location.path("/bills/"+data.id)})})):alert("Please select a supplier from the dropdown or click on 'New' to create one")},$scope.$watch("bill.supplier_id",function(){return $scope.bill.supplier_id&&$scope.bill.supplier&&$scope.bill.supplier.creditor_id&&($scope.bill.billing_supplier_id=$scope.bill.supplier.creditor_id),$scope.populate_due_date()}),$scope.$watch("bill.date",function(){return $scope.populate_due_date()}),$scope.populate_due_date=function(){var supplier;return $scope.bill&&$scope.bill.date?(supplier=$scope.bill.supplier,$scope.bill.due_date=supplier&&supplier.payment_term?paymentTermService.due_date($scope.bill.date,supplier.payment_term):$scope.bill.date):void 0}}}.call(this),function(){this.ShowBillController=function($scope,timeService,accountingNavService,formService,$routeParams,lookupService,stockInfoService,spinnerService,confirmationService,paymentTermService,permissionService,popoverService,Stock,Bill,Supplier,AutoWorkshop,DbFile){return accountingNavService.activate("Bills"),$scope.input_accounts=lookupService.input_accounts(),spinnerService.start_spinner("#bill-loading"),$scope.bill=Bill.get({id:$routeParams.id},function(){return spinnerService.stop_spinner("#bill-loading")}),$scope.selected_purchase_orders=[],$scope.input_accounts=lookupService.input_accounts(),$scope.accounting_integration=function(){return lookupService.configurations().accounting_integration},$scope.edit_bill=function(){return $scope.confirm_edit_finalized_bill(function(){return formService.edit_fields($scope.bill,"editing","id","supplier_id","billing_supplier_id","date","due_date","reference","total_amount","accounting_account_id","supplier","tracking_categories")})},$scope.save_bill=function(){return $scope.bill.editing.errors=void 0,Bill.update($scope.bill.editing,function(data){return data.errors?angular.copy(data,$scope.bill.editing):angular.copy(data,$scope.bill)})},$scope.cancel_edit_bill=function(){return $scope.bill.editing=void 0},$scope.bill_item_total=function(bill_item){return bill_item&&bill_item.unit_price&&bill_item.quantity?bill_item.total=(bill_item.unit_price*bill_item.quantity).round(2):0},$scope.update_bill_item_amount=function(item){return item.is_buyin&&$scope.update_buyin_price(item),$scope.bill_item_total(item)},$scope.reset_markup_percentage=function(item){return item.markup_percentage=void 0},$scope.update_buyin_price=function(item,markup_percentage){return timeService.timeout(function(){return item.is_buyin?(markup_percentage||0===markup_percentage?item.markup_percentage=markup_percentage:!item.markup_percentage&&$scope.markup_percentages().length>0&&(item.markup_percentage=$scope.markup_percentages()[0]),(item.markup_percentage||0===item.markup_percentage)&&(item.sell_price=(item.unit_price*(1+item.markup_percentage/100)).round(4)),!item.included_gst&&lookupService.configurations().prices_include_gst?item.sell_price=(item.sell_price*(1+lookupService.configurations().tax_rate)).round(2):void 0):item.sell_price=0})},$scope.add_purchase_order=function(){return $scope.confirm_edit_finalized_bill(function(){return $scope.showing_related_purchase_order=!0})},$scope.edit_bill_item=function(bill_item){return $scope.confirm_edit_finalized_bill(function(){var editing,element;return $scope.editing_bill_item&&$scope.close_edit_bill_item(),$scope.editing_bill_item=bill_item,formService.edit_fields($scope.editing_bill_item,"editing"),editing=document.getElementById("editing-bill-item"),element=document.getElementById("bill-item-"+bill_item.id),document.getElementById("bill-item-list").insertBefore(editing,element)})},$scope.cancel_edit_bill_item=function(){return $scope.editing_bill_item.editing=null,$scope.editing_bill_item=void 0},$scope.save_bill_item=function(form,bill_item){return formService.submit_form($scope,form,function(){return Bill.update_item({id:$scope.bill.id,item:bill_item.editing},function(data){return angular.copy(data,$scope.bill),$scope.close_edit_bill_item()})})},$scope.remove_bill_item=function(bill_item){return Bill.delete_item({id:$scope.bill.id,item:bill_item},function(data){return angular.copy(data,$scope.bill),$scope.close_edit_bill_item()})},$scope.close_edit_bill_item=function(){return $scope.editing_bill_item.editing=void 0,$scope.editing_bill_item=void 0},$scope.add_bill_item=function(){return $scope.confirm_edit_finalized_bill(function(){return $scope.new_bill_item={unit_price:0,quantity:1,description:"code/description",included_gst:$scope.bill.supplier.prices_include_gst,gst_free:$scope.bill.supplier.gst_free},formService.select_text("#new-bill-item-description")})},$scope.set_prices_include_gst=function(){return spinnerService.start_spinner("#bill-prices-gst-spinner"),Bill.set_prices_include_gst({id:$scope.bill.id,prices_include_gst:$scope.bill.supplier.prices_include_gst},function(data){return spinnerService.stop_spinner("#bill-prices-gst-spinner"),angular.copy(data,$scope.bill)})},$scope.set_gst_free=function(){return spinnerService.start_spinner("#bill-prices-gst-spinner"),Bill.set_gst_free({id:$scope.bill.id,gst_free:$scope.bill.supplier.gst_free},function(data){return spinnerService.stop_spinner("#bill-prices-gst-spinner"),angular.copy(data,$scope.bill)})},$scope.cancel_add_bill_item=function(){return $scope.new_bill_item=void 0},$scope.save_new_bill_item=function(){var saving_item;return lookupService.disable_arbitrary_line_items()&&!$scope.new_bill_item.stock_id?(alert("Please select an item from the dropdown or click 'Create Stock' button to create one"),void 0):(saving_item=$scope.new_bill_item,saving_item.saving=!0,$scope.bill.bill_items.push(saving_item),formService.focus("#add-bill-item-button"),$scope.new_bill_item=void 0,Bill.new_item({id:$scope.bill.id,item:saving_item},function(data){return angular.copy(data,$scope.bill)}))},$scope.calculate_from_total=function(item){return item.quantity&&item.quantity>0?item.unit_price=(item.total/item.quantity).round(4):item.unit_price&&item.unit_price>0?item.quantity=(item.total/item.unit_price).round(2):(item.quantity=1,item.unit_price=item.total)},$scope.open_delete_dialog=function(){return $scope.showing_delete_bill_dialog=!0},$scope.do_delete_bill=function(){return $scope.bill=Bill["delete"]({id:$scope.bill.id,deleted_reason:$scope.delete_reasson}),$scope.showing_delete_bill_dialog=!1},$scope.cancel_delete_bill=function(){return $scope.showing_delete_bill_dialog=!1},$scope.save_selected_purchase_orders=function(){var ids;return ids=[],$scope.selected_purchase_orders.each(function(item){return ids.push(item.id)}),Bill.add_purchase_orders({id:$scope.bill.id,purchase_order_ids:ids},function(data){return angular.copy(data,$scope.bill),$scope.selected_purchase_orders=[],$scope.showing_related_purchase_order=!1})},$scope.finalize=function(){return permissionService.check_finalize_documents_restriction_before_proceed(function(){return Bill.finalize({id:$scope.bill.id},function(data){return angular.copy(data,$scope.bill)})})},$scope.new_stock={with_gst:{}},$scope.select_new_stock=function(){var _base,_base1;return $scope.new_bill_item.stock_id=$scope.new_stock.id,(_base=$scope.new_bill_item).quantity||(_base.quantity=1),(_base1=$scope.new_bill_item).unit_price||(_base1.unit_price=$scope.new_stock.buy_price),$scope.new_bill_item.description=""+$scope.new_stock.stock_number+" - "+($scope.new_stock.name||""),$scope.new_bill_item.included_gst?void 0:$scope.new_bill_item.included_gst=$scope.new_stock.included_gst},$scope.edit_finalized_bill_warning=function(){var message,third_party;return third_party=$scope.accounting_integration(),message=third_party?"You're editing a bill that has been finalized.\nAre you sure you want to proceed?.\n\nIMPORTANT! Editing a finalized bill requires manually updating the stock items' quantity on hand\n\n"+("If the bill has been sync'd to "+third_party+", ")+("any changes you make here will NOT appear in "+third_party+", ")+("you will need to make these changes manually in "+third_party):"You're editing an bill that has been finalized.\n\nAre you sure you want to proceed?.\n\nIMPORTANT! Editing a finalized bill requires manually updating the stock items' quantity on hand"},$scope.confirm_edit_finalized_bill=function(callback){return $scope.bill.finalized?permissionService.check_update_finalized_documents_restriction_before_proceed(function(){return confirmationService.confirm($scope.edit_finalized_bill_warning(),$scope.bill.finalized&&!$scope.edit_finalized_bill_confirmed,function(){return $scope.bill.finalized&&($scope.edit_finalized_bill_confirmed=!0),callback()})}):callback()},$scope.markup_percentages=function(item,unique){var markups;return null==unique&&(unique=!1),markups=item&&item.markup_percentages?item.markup_percentages:lookupService.configurations()&&lookupService.configurations().markup_percentages?lookupService.configurations().markup_percentages:[],unique&&(markups=markups.filter(function(el){return null!==el&&void 0!==el}),markups=markups.unique()),markups},$scope.unset_sell_price=function(item){return $scope.reset_markup_percentage(item),item.sell_price=void 0},$scope.selected_invoice=null,$scope.add_related_invoice=function(){return $scope.adding_related_invoice=!0},$scope.remove_related_invoice=function(invoice){return spinnerService.start_spinner("#related-invoices-spinner"),Bill.remove_related_invoice({id:$scope.bill.id,invoice_id:invoice.id},function(){return spinnerService.stop_spinner("#related-invoices-spinner"),$scope.bill.invoices.remove(invoice)})},$scope.invoice_items_selected=function(){var items;return items=$scope.selected_invoice.items.findAll(function(i){return i.selected}),Bill.invoice({id:$scope.bill.id,invoice_id:$scope.selected_invoice.id,items:items},function(data){return angular.copy(data,$scope.bill),$scope.adding_related_invoice=!1})},$scope.$watch("bill.editing.date",function(){return $scope.populate_due_date()}),$scope.$watch("bill.editing.supplier_id",function(){return $scope.populate_due_date()}),$scope.populate_due_date=function(){var supplier;return $scope.bill.editing&&$scope.bill.editing.date&&(supplier=$scope.bill.editing.supplier,supplier&&supplier.payment_term)?$scope.bill.editing.due_date=paymentTermService.due_date($scope.bill.editing.date,supplier.payment_term):void 0},$scope.upload_bill_files=function(){return $scope.uploading_files=!0},$scope.cancel_upload_files=function(){return $("#upload-file1").val(void 0),$("#upload-file2").val(void 0),$("#upload-file3").val(void 0),$scope.uploading_files=!1},$scope.start_uploading=function(){return $scope.start_spinner("#upload-photos-spinner")},$scope.full_size_photo=function(){var active_photo;return active_photo=$scope.bill.photos.find(function(p){return p.active}),window.open(active_photo.url)},$scope.remove_photo=function(photo){return DbFile["delete"](photo,function(){return $scope.bill.photos.remove(photo),0===$scope.bill.photos.length?$scope.close_photo_viewer():void 0})},$scope.edit_file=function(document){return formService.edit_fields(document,"editing","id","file_name")},$scope.cancel_edit_file=function(document){return formService.cancel(document,"editing")},$scope.rename_file=function(document){return DbFile.rename(document.editing,function(data){return document.file_name=data.file_name,document.editing=void 0})},$scope.remove_file=function(document){return $scope.start_spinner("#upload-photos-spinner"),DbFile["delete"](document,function(){return $scope.stop_spinner("#upload-photos-spinner"),$scope.bill.documents.remove(document)})},$scope.close_photo_viewer=function(){return popoverService.hide("#photo-viewer"),$scope.bill.photos.each(function(p){return p.active=!1})},$scope.view_photo=function(photo){return photo.active=!0,popoverService.show("#photo-viewer","#bill-photos",{placement:"left"})},$scope.show_stock=function(bill_item){return stockInfoService.show(bill_item.stock_id,"#bill-item-list","top")},$scope.files_uploaded=function(data){return $scope.stop_spinner("#upload-photos-spinner"),$("#upload-file1").val(void 0),$("#upload-file2").val(void 0),$("#upload-file3").val(void 0),$scope.uploading_files=!1,"object"==typeof data?angular.copy(data,$scope.bill):alert("Error while uploading file(s), please check that each file is maximum 1Mb and try again.")}}}.call(this),function(){this.AutoWorkshopApp.service("bookingsNavService",function(navbarService){var _this=this;return this.active="Diary",{activate:function(activate,title){return _this.active=activate,title||(title=activate),navbarService.activate("Diary",title)},active:function(){return _this.active}}}),this.BookingsNavController=function($scope,navbarService,customersNavService,lookupService,timeService,bookingsNavService){return $scope.links=lookupService.session()&&(lookupService.session().is_restricted_mechanic||lookupService.session().is_mechanic)?[]:[{name:"Diary",href:"#/diary",icon:"icon-calendar"},{name:"All Bookings",href:"#/bookings",icon:"icon-calendar"},{name:"Online Booking Requests",href:"#/booking_requests",icon:"icon-star"},{name:"Courtesy Vehicle Bookings",href:"#/courtesy_vehicle_bookings",icon:"icon-car"}],$scope.active=function(){return bookingsNavService.active()},$scope.isActive=function(name){return name===$scope.active()?"active":""}}}.call(this),function(){this.BookingRequestsController=function($window,$location,$routeParams,dateFilter,$scope,Booking,popoverService,lookupService,formService,navbarService,bookingsNavService,spinnerService,Session,Employee,AutoWorkshop){return bookingsNavService.activate("Online Booking Requests"),$scope.today=moment().toString(),spinnerService.start_spinner("#booking-request-spinner"),AutoWorkshop.booking_requests(function(data){return spinnerService.stop_spinner("#booking-request-spinner"),$scope.booking_requests=data}),$scope.enabled=function(){return lookupService.configurations().enable_booking_requests},$scope.cancel_booking_request=function(request){return $scope.cancelling_request=request,popoverService.show("#booking-request-cancellation","#cancel-booking-request-"+request.id,{placement:"left"})},$scope.close_booking_cancellation=function(){return $scope.cancelling_request=void 0,popoverService.hide("#booking-request-cancellation")},$scope.cancel_booking=function(){return AutoWorkshop.cancel_booking_request({booking_request_id:$scope.cancelling_request.id},function(){return $scope.booking_requests.remove($scope.cancelling_request),$scope.close_booking_cancellation(),navbarService.update_booking_request_count()})}}}.call(this),function(){this.BookingsController=function($window,$location,$routeParams,dateFilter,$scope,Booking,timeService,popoverService,lookupService,spinnerService,formService,navbarService,bookingsNavService){var search_query;return $scope.toggle_active=function(number){return null==number&&(number=1),timeService.timeout(function(){return $scope.query.finished&&($scope.query.deleted=!1),$scope.search()})},$scope.toggle_deleted=function(number){return null==number&&(number=1),timeService.timeout(function(){return $scope.query.deleted&&($scope.query.active=!1),$scope.search()})},$scope.search=function(number){var search_count,search_query;return null==number&&(number=1),$scope.query.deleted?$scope.query.active=!1:$scope.query.active&&($scope.query.deleted=!1),search_query={query:$scope.query,page:number,order_by:"time",order:"desc"},lookupService.save_search_query("suppliers",search_query),$scope.search_count||($scope.search_count=0),$scope.search_count+=1,search_count=$scope.search_count,spinnerService.start_spinner("#bookings-spinner"),Booking.search(search_query,function(data){return search_count===$scope.search_count?($scope.keyword=$scope.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.bookings=data.bookings,spinnerService.stop_spinner("#bookings-spinner")):void 0})},$scope.selectPage=function(number){return $scope.search(number)},$scope.tags=function(){return lookupService.tags_of_type("Job","Booking")},$scope.preview=function(booking){return $scope.booking=booking,popoverService.show("#booking-preview","#booking-"+booking.id,{placement:"bottom"})},$scope.close_preview=function(){return $scope.booking=void 0,popoverService.hide("#booking-preview")},$scope.delete_booking=function(){return $scope.showing_delete_booking_dialog=!0},$scope.cancel_delete_booking=function(){return $scope.showing_delete_booking_dialog=!1},$scope.do_delete_booking=function(){return spinnerService.start_spinner("#delete-booking-spinner"),Booking["delete"]($scope.booking,function(){return $scope.showing_delete_booking_dialog=!1,spinnerService.stop_spinner("#delete-booking-spinner"),$scope.bookings.remove($scope.booking),$scope.close_preview()})},$scope.undelete_booking=function(booking){return booking||(booking=$scope.booking),spinnerService.start_spinner("#edit-booking-spinner"),Booking.undelete({id:booking.id},function(){return spinnerService.stop_spinner("#edit-booking-spinner"),$scope.bookings.remove(booking),$scope.close_preview()})},bookingsNavService.activate("All Bookings"),search_query=lookupService.search_query("bookings"),search_query&&$routeParams.cached?($scope.query=search_query.query,$scope.search(search_query.page||1),formService.select_text("#all-jobs-search-input")):(lookupService.save_search_query("bookings",{query:{query:""},deleted:!1,active:!0,start:moment().subtract(7,"days").toDate()}),$location.path("/bookings").search({cached:Math.random()}).replace())}}.call(this),function(){this.EditBookingController=function(){}}.call(this),function(){this.NewBookingController=function(){}}.call(this),function(){this.UpdateBookingController=function($scope,$routeParams,$window,navbarService,formService,lookupService,spinnerService,popoverService,confirmationService,recommendationService,Quote,VehicleModel,Vehicle,Customer,Booking,AutoWorkshop,CourtesyVehicleBooking){return $scope.add_note=function(){return $scope.show_note=!0},$scope.show_assign_to_mechanics=function(){return $scope.showing_assign_to_mechanics=!0},$scope.show_schedule=function(){var scheduler;return scheduler=$window.open("/auto_workshop/diary_view","Diary","directories=0,titlebar=0,toolbar=0, menubar=0, height=800, width="+window.outerWidth)},$scope.provide_mobile_service=function(){return lookupService.configuration("provide_mobile_service")},$scope.start=function(form){return $scope.save(form,function(){return $scope.goto("/jobs/new",{booking:$scope.booking.id})})},$scope.prepare=function(form){return $scope.save(form,function(){return $scope.goto("/jobs/new",{booking:$scope.booking.id,prepare:!0})})},$scope.remove_mechanic=function(mechanic){return 1===mechanic&&($scope.booking.mechanic_1_id=void 0),2===mechanic&&($scope.booking.mechanic_2_id=void 0),3===mechanic&&($scope.booking.mechanic_3_id=void 0),4===mechanic?$scope.booking.mechanic_4_id=void 0:void 0},$scope.remove_booking=function(){return $scope.deleted_reason=void 0,$scope.showing_delete_booking_dialog=!0},$scope.do_delete_booking=function(){return Booking["delete"]({id:$scope.booking.id,deleted_reason:$scope.deleted_reason},function(){return $scope.showing_delete_booking_dialog=!1,$scope.back()})},$scope.cancel_delete_booking=function(){return $scope.showing_delete_booking_dialog=!1},$scope.save=function(form,callback){return!lookupService.business_source_required()||$scope.booking.customer.id||$scope.booking.customer.business_source_id?($scope.booking.employee_ids=[$scope.booking.mechanic_1_id,$scope.booking.mechanic_2_id,$scope.booking.mechanic_3_id,$scope.booking.mechanic_4_id],confirmationService.confirm("This customer requires Order Number for all jobs and invoices. Proceed anyway?",$scope.booking.customer.require_order_number,function(){return $scope.submit_form(form,function(){return spinnerService.start_spinner("#saving-booking"),$scope.booking.id?Booking.update($scope.booking,function(){return spinnerService.stop_spinner("#saving-booking"),$scope.finish_saving(callback)}):Booking.save($scope.booking,function(data){return spinnerService.stop_spinner("#saving-booking"),data.error?alert(data.error):$scope.finish_saving(callback)})})})):alert("Please select the customer's source of business")},$scope.finish_saving=function(callback){var options;return spinnerService.stop_spinner("#saving-booking"),$routeParams.booking_request_id&&navbarService.update_booking_request_count(),callback?callback():(options={},$routeParams.bookingView&&(options.year=$routeParams.year,options.month=$routeParams.month,options.date=$routeParams.date,options.view=$routeParams.bookingView),$scope.goto("/diary",options))},$scope.initialize_data=function(data){return data.description&&($scope.booking.description=data.description),data.customer&&($scope.recommendations=[data.customer],$scope.selection.customer=data.customer),data.vehicle?($scope.selection.vehicle=$scope.selection.customer.vehicles.find(function(vehicle){return vehicle.id.toString()===data.vehicle.id.toString()}),$scope.selection.vehicle||($scope.selection.customer.vehicles.unshift(data.vehicle),$scope.selection.vehicle=data.vehicle)):data.vehicle_id&&($scope.selection.vehicle=$scope.selection.customer.vehicles.find(function(vehicle){return vehicle.id.toString()===data.vehicle_id.toString()}),$scope.selection.vehicle||Vehicle.get({id:data.vehicle_id},function(vehicle_data){return $scope.selection.customer.vehicles.unshift(vehicle_data),$scope.selection.vehicle=vehicle_data})),data.job_type_ids&&($scope.booking.job_type_ids=data.job_type_ids),data.order_number&&($scope.booking.order_number=data.order_number),data.insurer_id&&($scope.booking.insurer_id=data.insurer_id,$scope.booking.claim_number=data.claim_number,$scope.booking.account_number=data.account_number),data.royalty_integration_account_id&&($scope.booking.royalty_integration_account_id=data.royalty_integration_account_id,$scope.booking.royalty_account_number=data.royalty_account_number,$scope.booking.royalty_auto_club=data.royalty_auto_club),data.time&&($scope.booking.time=new Date(data.time)),data.pickup_time&&($scope.booking.pickup_time=new Date(data.pickup_time),$scope.booking.note&&($scope.show_note=!0)),data.tracking_categories&&($scope.booking.tracking_categories=data.tracking_categories),data.courtesy_vehicle_bookings&&data.courtesy_vehicle_bookings.length>0?($scope.booking.courtesy_vehicle_booking={},angular.copy(data.courtesy_vehicle_bookings[0],$scope.booking.courtesy_vehicle_booking)):void 0},$scope.employees=function(){return lookupService.assignable_employees()},$scope.initialize_data_from_booking_request=function(data){var search,_base;return $scope.booking.customer.name=data.name,$scope.booking.customer.mobile=data.mobile,$scope.booking.customer.phone=data.phone,$scope.booking.customer.email=data.email,(_base=$scope.booking.customer).address||(_base.address={}),$scope.booking.customer.address.street_line=data.street_line,$scope.booking.customer.address.suburb=data.suburb,$scope.booking.customer.address.state=data.state,$scope.booking.customer.address.postcode=data.postcode,$scope.booking.vehicle.registration_number=data.registration_number,$scope.booking.vehicle.make=data.make,$scope.booking.vehicle.model=data.model,$scope.booking.vehicle.year=data.year,$scope.booking.vehicle.color=data.color,$scope.booking.vehicle.fuel_type=data.fuel_type,$scope.booking.vehicle.drive_type=data.drive_type,$scope.booking.vehicle.engine_size=data.engine_size,$scope.booking.vehicle.vin=data.vin,$scope.booking.vehicle.transmission=data.transmission,$scope.booking.vehicle.body=data.body,$scope.booking.note=data.note,$scope.booking.time=new Date(data.drop_off_time),data.pickup_time&&($scope.booking.pickup_time=new Date(data.pickup_time)),data.job_type_ids&&($scope.booking.job_type_ids=data.job_type_ids,$scope.calculate_estimate_work_hours()),search={vehicle:{},customer:{}},angular.copy($scope.booking.vehicle,search.vehicle),angular.copy($scope.booking.customer,search.customer),spinnerService.start_spinner("#recommendation-spinner"),recommendationService.recommendations(search,function(data){return angular.copy(data,$scope.recommendations),spinnerService.stop_spinner("#recommendation-spinner")})},$scope.calculate_estimate_work_hours=function(old,value){var current_value,difference,estimate_work_hours,new_hours,old_hours;return old||(old=[]),value||(value=$scope.booking.job_type_ids),current_value=$scope.booking.total_hours,$scope.booking&&$scope.booking.job_type_ids&&(old_hours=0,new_hours=0,lookupService.job_types().forEach(function(jt){return old.includes(jt.id.toString())&&jt.total_hours&&(old_hours+=jt.total_hours),value.includes(jt.id.toString())&&jt.total_hours?new_hours+=jt.total_hours:void 0}),difference=new_hours-old_hours),estimate_work_hours=$scope.booking.total_hours||0,estimate_work_hours+difference>0?$scope.booking.total_hours=estimate_work_hours+difference:void 0},$scope.default_booking_time=function(){return lookupService.configurations().default_booking_time},$scope.init=function(){var default_booking_time,drop_off,pickup;return navbarService.activate("Diary"),$scope.selection={},$scope.recommendations=[],$scope.booking={vehicle:{},customer:{},tags:[],job_type_ids:[]},$routeParams.id?(spinnerService.start_spinner("#edit-booking-spinner"),Booking.get({id:$routeParams.id},function(data){return spinnerService.stop_spinner("#edit-booking-spinner"),angular.copy(data,$scope.booking),$scope.initialize_data(data),data.employees[0]&&($scope.booking.mechanic_1_id=data.employees[0].id),data.employees[1]&&($scope.booking.mechanic_2_id=data.employees[1].id),data.employees[2]&&($scope.booking.mechanic_3_id=data.employees[2].id),data.employees[3]?$scope.booking.mechanic_4_id=data.employees[3].id:void 0})):($routeParams.quote_id&&($scope.booking.quote_id=$routeParams.quote_id,Quote.get({id:$routeParams.quote_id},function(data){return $scope.initialize_data(data),$scope.calculate_estimate_work_hours()})),$routeParams.booking_request_id&&($scope.booking.booking_request_id=$routeParams.booking_request_id,AutoWorkshop.booking_request({booking_request_id:$routeParams.booking_request_id},function(data){return $scope.initialize_data_from_booking_request(data)})),drop_off=new Date,$routeParams.booking_date&&(drop_off=new Date($routeParams.booking_date)),drop_off.setSeconds(0),$scope.default_booking_time()?(default_booking_time=moment($scope.default_booking_time()).toDate(),drop_off.setMinutes(default_booking_time.getMinutes()),drop_off.setHours(default_booking_time.getHours())):(drop_off.setMinutes(0),drop_off.setHours(8)),$scope.booking.time=drop_off,$scope.disable_default_pickup_time()||(pickup=new Date,$routeParams.booking_date&&(pickup=new Date($routeParams.booking_date)),pickup.setSeconds(0),pickup.setMinutes(0),pickup.setHours(17),$scope.booking.pickup_time=pickup),formService.select_text("#ad-customer-vehicle-form-name"))},$scope.on_book_courtesy_vehicle=function(){return popoverService.hide("#courtesy-vehicle-booking-form")},$scope.show_courtesy_vehicle_bookings=function(){return popoverService.show("#courtesy-vehicle-booking-form","#show-courtesy-booking-form-position",{placement:"top"})},$scope.hide_courtesy_vehicle_bookings=function(){return $scope.booking.courtesy_vehicle_booking&&$scope.booking.courtesy_vehicle_booking.vehicle_id||($scope.booking.courtesy_vehicle_booking=void 0,$scope.booking.replacement_provided=!1),popoverService.hide("#courtesy-vehicle-booking-form")},$scope.toggle_courtesy_vehicle_bookings=function(){var courtesy_vehicle_booking;return courtesy_vehicle_booking=$scope.booking.courtesy_vehicle_booking,$scope.booking.replacement_provided&&lookupService.courtesy_vehicles().length>0?$scope.show_courtesy_vehicle_bookings():courtesy_vehicle_booking&&courtesy_vehicle_booking.id?confirmationService.confirm_in_position("Delete the current courtesy vehicle booking for this booking?",!0,{anchor:"#booking-courtesy-vehicle-checkbox",placement:"right"},function(){return CourtesyVehicleBooking["delete"]({id:courtesy_vehicle_booking.id},function(){return $scope.booking.courtesy_vehicle_booking=void 0,$scope.hide_courtesy_vehicle_bookings()})},function(){return $scope.booking.replacement_provided=!0}):$scope.booking.replacement_provided?void 0:($scope.booking.courtesy_vehicle_booking=void 0,$scope.hide_courtesy_vehicle_bookings())},$scope.init()}}.call(this),function(){this.CommunicationTemplatesController=function($scope,jobNavService,CommunicationTemplate){return jobNavService.activate("Communication Templates"),CommunicationTemplate.all(function(data){return $scope.communication_templates=data,$scope.show_template(data[0])}),$scope.show_template=function(template){return $scope.template=template},$scope.edit=function(template){var editing;return editing={},angular.copy(template,editing),template.editing=editing},$scope.template_name=function(template){return template.name.replace("Template","")},$scope.save=function(form,template){return $scope.submit_form(form,function(){return CommunicationTemplate.update(template.editing,function(data){return data.errors?template.editing=data:(delete template.editing,angular.copy(data,template))})})},$scope.cancel_editing=function(template){return template.editing=null}}}.call(this),function(){this.CostsController=function($scope,$log,lookupService,accountingNavService,formService,popoverService,Cost){return accountingNavService.activate("Invoice Items"),$scope.costs=Cost.all(),$scope.keyword="",$scope.prices_include_gst=lookupService.configurations().prices_include_gst,$scope.tax_rate=lookupService.configurations().tax_rate,$scope.edit_cost=function(cost){return formService.edit_fields(cost,"editing"),$scope.prices_include_gst?void 0:(cost.editing.with_gst={},$scope.price_with_gst(cost.editing))},$scope.new_cost_dialog=function(){return $scope.new_cost={with_gst:{}},popoverService.show("#new-cost","#new-cost-button"),formService.select_text("#new-cost-description")},$scope.cancel_new_cost=function(){return $scope.new_cost=void 0,popoverService.hide("#new-cost")},$scope.save_cost=function(cost){return Cost.update(cost.editing,function(data){return lookupService.fetch_invoice_items(),angular.copy(data,cost)})},$scope.remove_cost=function(cost){return Cost["delete"](cost,function(){return lookupService.fetch_invoice_items(),$scope.costs.remove(cost)})},$scope.cost_description=function(cost){return""+cost.description+" - "+cost.unit_price},$scope.cancel_edit_cost=function(cost){return formService.cancel(cost,"editing")},$scope.save_new_cost=function(){return Cost.save($scope.new_cost,function(data){return lookupService.fetch_invoice_items(),$scope.costs.unshift(data),$scope.new_cost=void 0,popoverService.hide("#new-cost")
})},$scope.price_with_gst=function(object){return $scope.prices_with_gst?void 0:object.with_gst.unit_price=object.unit_price*(1+$scope.tax_rate)},$scope.price_without_gst=function(object){return object.unit_price=object.with_gst.unit_price/(1+$scope.tax_rate)}}}.call(this),function(){this.CourtesyVehicleBookingsController=function($scope,$window,$location,$route,$routeParams,dateFilter,popoverService,timeService,lookupService,spinnerService,formService,navbarService,bookingsNavService,CourtesyVehicleBooking){return $scope.fetch_upcomings=function(page){return null==page&&(page=1),CourtesyVehicleBooking.upcomings({page:page},function(data){return $scope.upcomings=data,$scope.upcomings_page=page})},$scope.fetch_pasts=function(page){return null==page&&(page=1),CourtesyVehicleBooking.pasts({page:page},function(data){return $scope.pasts=data,$scope.pasts_page=page})},$scope.update=function(){return"pasts"===$scope.left_side?$scope.fetch_pasts($scope.pasts_page):$scope.fetch_upcomings($scope.upcomings_page)},$scope.show_left_side=function(section){if($scope.left_side=section,"pasts"===$scope.left_side){if(!$scope.pasts)return $scope.fetch_pasts()}else if(!$scope.upcomings)return $scope.fetch_upcomings()},bookingsNavService.activate("Courtesy Vehicle Bookings"),$scope.show_left_side("upcomings")}}.call(this),function(){this.CreditNoteController=function($scope,$routeParams,timeService,$location,$window,formService,jobNavService,accountingNavService,lookupService,confirmationService,permissionService,navbarService,spinnerService,popoverService,CreditNote){return accountingNavService.activate("Customer Credit Notes"),$scope.credit_note=CreditNote.get({id:$routeParams.id},function(data){return $scope.email=data.customer.email,$scope.message="Your credit note is attached",$routeParams.returning&&data.original_invoice&&data.original_invoice.id?$scope.add_item_from_invoice():void 0}),$scope.selected_invoices=[],$scope.payment_methods=lookupService.payment_methods(),$scope.accounting_integration=function(){return lookupService.configurations().accounting_integration},$scope.edit_invoice_item_details=function(invoice_item){return invoice_item.edit_details=!0},$scope.invoice_item_total=function(invoice_item){return invoice_item&&invoice_item.quantity&&invoice_item.unit_price?invoice_item.quantity*invoice_item.unit_price:0},$scope.add_invoice_item=function(){return $scope.confirm_edit_finalized_credit_note(function(){return $scope.new_invoice_item={description:"code/description",quantity:1,unit_price:0,included_gst:lookupService.configurations().prices_include_gst},formService.select_text("#new-credit-note-item-description")})},$scope.add_item_from_invoice=function(){return popoverService.show("#return-item-selection","#add-invoice-item-button",{placement:"left"})},$scope.close_add_item_from_invoice=function(){return $scope.credit_note.original_invoice.items.forEach(function(item){return item.selected=!1,item.returning_quantity=void 0}),popoverService.hide("#return-item-selection")},$scope.toggle_item_from_invoice=function(item){return item.selected===!0?(item.selected=!1,item.returning_quantity=void 0):(item.selected=!0,item.returning_quantity=item.quantity)},$scope.do_select_item_from_invoice=function(){var items;return spinnerService.start_spinner("#returning-items-spinner"),items=[],$scope.credit_note.original_invoice.items.forEach(function(item){return item.selected&&item.returning_quantity>0?items.push({quantity:item.returning_quantity,unit_price:item.unit_price,stock_id:item.stock_id,description:item.description,included_gst:item.included_gst,gst_free:item.gst_free,discount_percentage:item.discount_percentage}):void 0}),CreditNote.new_items({id:$scope.credit_note.id,items:items},function(data){return angular.copy(data,$scope.credit_note),$scope.close_add_item_from_invoice(),spinnerService.stop_spinner("#returning-items-spinner")})},$scope.edit_credit_note=function(){return $scope.confirm_edit_finalized_credit_note(function(){return formService.edit_fields($scope.credit_note,"editing","id","reference","date","original_invoice_id","tracking_categories","royalty_integration_account_id","royalty_account_number","royalty_auto_club","customer","original_invoice")})},$scope.cancel_edit_credit_card=function(){return formService.cancel($scope.credit_note,"editing")},$scope.select_price_level=function(item,price){return item.unit_price=price},$scope.save_credit_note=function(){return CreditNote.update($scope.credit_note.editing,function(data){return angular.copy(data,$scope.credit_note)})},$scope.close_customer=function(){return popoverService.hide("#customer")},$scope.show_customer=function(){return popoverService.show("#customer","#vehicle-owner-details",{placement:"bottom"})},$scope.open_delete_dialog=function(){return $scope.showing_delete_credit_note_dialog=!0},$scope.cancel_delete_credit_note=function(){return $scope.showing_delete_credit_note_dialog=!1},$scope.do_delete_credit_note=function(){return CreditNote["delete"]({id:$scope.credit_note.id,deleted_reason:$scope.deleted_reason},function(data){return angular.copy(data,$scope.credit_note),$scope.showing_delete_credit_note_dialog=!1})},$scope.save_new_invoice_item=function(){var saving_item;return lookupService.disable_arbitrary_line_items()&&!$scope.new_invoice_item.stock_id?(alert("Please select an item from the dropdown or click 'Create Stock' button to create one"),void 0):(saving_item=$scope.new_invoice_item,$scope.credit_note.items.push(saving_item),$scope.new_invoice_item=null,formService.focus("#add-item-button"),formService.submit_form($scope,$scope.new_invoice_item_form,function(){return CreditNote.new_item({id:$scope.credit_note.id,item:saving_item},function(data){return angular.copy(data,$scope.credit_note)})}))},$scope.edit_invoice_item=function(invoice_item){return $scope.confirm_edit_finalized_credit_note(function(){return formService.edit_fields(invoice_item,"editing")})},$scope.cancel_edit_invoice_item=function(invoice_item){return invoice_item.editing=null},$scope.save_invoice_item=function(form,invoice_item){return formService.submit_form($scope,form,function(){return spinnerService.start_spinner("#credit_note-spinner"),CreditNote.update_item({id:$scope.credit_note.id,item:invoice_item.editing},function(data){return spinnerService.stop_spinner("#credit_note-spinner"),angular.copy(data,$scope.credit_note)})})},$scope.remove_invoice_item=function(invoice_item){return spinnerService.start_spinner("#credit_note-spinner"),CreditNote.delete_item({id:$scope.credit_note.id,item:invoice_item},function(data){return spinnerService.stop_spinner("#credit_note-spinner"),angular.copy(data,$scope.credit_note)})},$scope.cancel_add_invoice_item=function(){return $scope.new_invoice_item=null},$scope.show_invoice_item_details=function(invoice_item){return invoice_item.show_details=!0},$scope.hide_invoice_item_details=function(invoice_item){return invoice_item.show_details=!1},$scope.edit_credit_note_details=function(){return formService.edit_fields($scope.credit_note,"editing_details","id","details"),formService.select_text("#edit-credit_note-details")},$scope.save_credit_note_details=function(){return CreditNote.update($scope.credit_note.editing_details,function(data){return angular.copy(data,$scope.credit_note),$scope.job?$scope.job.maintenance_entry_content=data.details:void 0})},$scope.cancel_edit_credit_note_details=function(){return $scope.credit_note.editing_details=null},$scope.clear_credit_note_details=function(){return $scope.credit_note.editing_details.details="",CreditNote.update($scope.credit_note.editing_details,function(data){return angular.copy(data,$scope.credit_note),$scope.job?$scope.job.maintenance_entry_content="":void 0})},$scope.finalize=function(){return permissionService.check_finalize_documents_restriction_before_proceed(function(){return CreditNote.finalize({id:$scope.credit_note.id},function(data){return angular.copy(data,$scope.credit_note)})})},$scope.add_invoices=function(){return $scope.showing_related_invoices=!0},$scope.remove_bpayment=function(bpayment){return confirmationService.confirm("Are you sure you want to delete this allocation?",!0,function(){return CreditNote.remove_allocation({id:$scope.credit_note.id,allocation_id:bpayment.id},function(data){return angular.copy(data,$scope.credit_note)})})},$scope.save_selected_invoices=function(){var allocations;return allocations=[],$scope.selected_invoices.each(function(invoice){return allocations.push({id:invoice.id,amount:invoice.allocated_amount})}),CreditNote.allocate_payments({id:$scope.credit_note.id,allocations:allocations},function(data){return angular.copy(data,$scope.credit_note),$scope.selected_invoices=[],$scope.showing_related_invoices=!1})},$scope.open_send_email=function(){return popoverService.show("#credit-note-send-email","#credit-note-send-email-button",{placement:"left"})},$scope.cancel=function(){return popoverService.hide("#credit-note-send-email")},$scope.send_email=function(){return spinnerService.start_spinner("#credit-note-send-email-spinner"),CreditNote.send_email({id:$scope.credit_note.id,email:$scope.email,message:$scope.message},function(){return spinnerService.stop_spinner("#credit-note-send-email-spinner"),popoverService.hide("#credit-note-send-email")})},$scope.open_refund=function(){var cash_payment_method;return cash_payment_method=lookupService.payment_method("cash"),$scope.refund={id:$scope.credit_note.id,reference:"Credit Note "+$scope.credit_note.number+" Refund",amount:$scope.credit_note.unallocated_amount,date:timeService.current(),payment_method_id:cash_payment_method?cash_payment_method.id:void 0},popoverService.show("#create-refund","#create-refund-button",{placement:"left"})},$scope.bank_accounts=function(){return lookupService.bank_accounts()},$scope.show_select_bank_account=function(){var cash_payment_method;return $scope.refund&&$scope.refund.payment_method_id&&$scope.bank_accounts()&&(cash_payment_method=lookupService.payment_method("cash"),cash_payment_method&&$scope.bank_accounts().length>1)?$scope.refund.payment_method_id!==cash_payment_method.id:void 0},$scope.close_refund=function(){return $scope.refund.reference=void 0,popoverService.hide("#create-refund")},$scope.do_refund=function(){return $scope.refund.payment_method_id?(spinnerService.start_spinner("#create-refund-spinner"),CreditNote.refund($scope.refund,function(data){return spinnerService.stop_spinner("#create-refund-spinner"),angular.copy(data,$scope.credit_note),$scope.close_refund()})):alert("Please select a payment type")},$scope.email_select_contact=function(contacts){var emails;return emails=contacts.map(function(c){return c.email}),emails&&emails.length>0?$scope.email=emails.join(";"):void 0},$scope.new_stock={with_gst:{}},$scope.select_new_stock=function(){var customer,_base;return $scope.new_invoice_item.stock_id=$scope.new_stock.id,(_base=$scope.new_invoice_item).quantity||(_base.quantity=1),$scope.new_invoice_item.description=""+$scope.new_stock.stock_number+" - "+($scope.new_stock.name||""),$scope.new_invoice_item.included_gst||($scope.new_invoice_item.included_gst=$scope.new_stock.included_gst),customer=$scope.credit_note.customer,$scope.new_invoice_item.unit_price=customer&&customer.price_level&&$scope.new_stock["price"+customer.price_level]>0?$scope.new_stock["price"+customer.price_level]:$scope.new_stock.price},$scope.edit_finalized_credit_note_warning=function(){var message,third_party;return third_party=$scope.accounting_integration(),message=third_party?"You're editing a credit note that has been finalized.\nAre you sure you want to proceed?.\n\nIMPORTANT! Editing a finalized credit note requires manually updating the stock items' quantity on hand\n\n"+("If the credit note has been sync'd to "+third_party+", ")+("any changes you make here will NOT appear in "+third_party+", ")+("you will need to make these changes manually in "+third_party):"You're editing an credit note that has been finalized.\n\nAre you sure you want to proceed?.\n\nIMPORTANT! Editing a finalized credit note requires manually updating the stock items' quantity on hand"},$scope.confirm_edit_finalized_credit_note=function(callback){return $scope.credit_note.finalized?permissionService.check_update_finalized_documents_restriction_before_proceed(function(){return confirmationService.confirm($scope.edit_finalized_credit_note_warning(),!$scope.edit_finalized_credit_note_confirmed,function(){return $scope.credit_note.finalized&&($scope.edit_finalized_credit_note_confirmed=!0),callback()})}):callback()}}}.call(this),function(){this.CreditNotesController=function($scope,$location,spinnerService,lookupService,$routeParams,accountingNavService,formService,timeService,CreditNote){var search_query;return $scope.search=function(page){var search_query;return null==page&&(page=1),$scope.query.deleted||delete $scope.query.deleted,$scope.query.unallocated||delete $scope.query.unallocated,search_query={query:$scope.query,page:page},lookupService.save_search_query("credit_notes",search_query),spinnerService.start_spinner("#credit-notes-spinner"),CreditNote.all(formService.params(search_query),function(data){return spinnerService.stop_spinner("#credit-notes-spinner"),$scope.keyword=$scope.query.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.credit_notes=data.credit_notes})},$scope.tags=function(){return lookupService.tags_of_type("CreditNote")},accountingNavService.activate("Customer Credit Notes"),search_query=lookupService.search_query("credit_notes"),search_query&&search_query.query&&$routeParams.cached?($scope.query=search_query.query,$scope.search(search_query.page||1)):(lookupService.save_search_query("credit_notes",{query:{query:""}}),$location.path("/credit_notes").search({cached:Math.random()}).replace())}}.call(this),function(){this.NewCreditNoteController=function($scope,$http,$location,$routeParams,accountingNavService,spinnerService,Stock,Supplier,CreditNote){return accountingNavService.activate("Customer Credit Notes"),$scope.credit_note={date:new Date},$routeParams.original_invoice_id&&($scope.credit_note.original_invoice_id=$routeParams.original_invoice_id,$scope.credit_note.customer_id=$routeParams.customer_id,$scope.credit_note.original_invoice={id:$routeParams.original_invoice_id,title:$routeParams.original_invoice_number,lookup_text:""+$routeParams.original_invoice_number+" - "+$routeParams.customer_name+", "+$routeParams.original_invoice_total_amount},$scope.selected_customer={name:$routeParams.customer_name,id:$routeParams.customer_id,lookup:""+$routeParams.customer_name}),$scope.select_customer=function(){return $scope.credit_note.customer_id=$scope.selected_customer.id},$scope.save_credit_note=function(){var original_invoice;return original_invoice=$scope.credit_note.original_invoice,original_invoice&&!$scope.credit_note.customer_id&&($scope.credit_note.customer_id=original_invoice.customer_id),$scope.credit_note.customer_id?(spinnerService.start_spinner("#new-credit-note-spinner"),CreditNote.save($scope.credit_note,function(data){return spinnerService.stop_spinner("#new-credit-note-spinner"),$location.path("/credit_notes/"+data.id).search({returning:!0})})):alert("Please select a customer")}}}.call(this),function(){this.CustomersController=function($scope,$routeParams,timeService,lookupService,customersNavService,$location,spinnerService,formService,Customer){var search_query;return $scope.search=function(number){return null==number&&(number=1),timeService.timeout(function(){var params,search_query;return $scope.showing_positive_balances=!1,$scope.query.is_company||delete $scope.query.is_company,search_query={query:$scope.query,page:number,order:$scope.order,order_by:$scope.order_by,showing_positive_balances:!1},lookupService.save_search_query("customers",search_query),spinnerService.start_spinner("#customer-list-spinner"),params=formService.params(search_query),Customer.all(params,function(data){return $scope.keyword=$scope.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.customers=data.customers,spinnerService.stop_spinner("#customer-list-spinner")})})},$scope.selectPage=function(number){return $scope.search(number)},$scope.sort=function(attribute){return $scope.order_by===attribute?$scope.order="asc"===$scope.order?"desc":"asc":$scope.order_by=attribute,$scope.search()},$scope.tags=function(){return lookupService.tags_of_type("Customer")},$scope.toggle_positive_balances=function(number){return null==number&&(number=1),$scope.query="",timeService.timeout(function(){return $scope.showing_positive_balances?(lookupService.save_search_query("customers",{query:"",showing_positive_balances:!0}),spinnerService.start_spinner("#customer-list-spinner"),Customer.positive_balance(function(data){return $scope.customers=data,spinnerService.stop_spinner("#customer-list-spinner")}),$scope.keyword=void 0,$scope.page_number=void 0,$scope.total_pages=void 0):$scope.search()})},$scope.show_download=function(){return lookupService.session()&&lookupService.session().is_admin},$scope.download=function(){var params;return params={query:$scope.query,order:$scope.order,order_by:$scope.order_by},$scope.showing_positive_balances&&(params.positive_balance=!0),params=formService.params(params),window.open("/customers/download?"+$.param(params))},customersNavService.activate("Customers"),search_query=lookupService.search_query("customers"),search_query&&$routeParams.cached?($scope.query=search_query.query,$scope.order=search_query.order||"desc",$scope.order_by=search_query.order_by||"number",$scope.query=search_query.query,search_query.showing_positive_balances?($scope.showing_positive_balances=!0,$scope.toggle_positive_balances()):$scope.search(search_query.page||1)):(lookupService.save_search_query("customers",{query:"",order:"desc",order_by:"number"}),$location.path("/customers").search({cached:Math.random()}).replace())}}.call(this),function(){this.InsurersController=function($scope,customersNavService,$location,spinnerService,Customer){return $scope.search=function(){return $scope.showing_positive_balances=!1,spinnerService.start_spinner("#insurer-list-spinner"),Customer.insurers(function(data){return $scope.customers=data,spinnerService.stop_spinner("#insurer-list-spinner")})},customersNavService.activate("3rd Parties"),$scope.search()}}.call(this),function(){this.NewCustomerController=function($scope,$location,$routeParams,customersNavService,spinnerService,lookupService){return customersNavService.activate("Customers"),$scope.payment_terms=lookupService.payment_terms(),$scope.customer={},$routeParams.is_insurer&&(customersNavService.activate("Insurers"),$scope.customer.is_insurer=!0),$scope.save_new_customer=function(){var route;return route="/customers/"+$scope.customer.id,$location.path(route)},$scope.cancel_new_customer=function(){return $scope.back()}}}.call(this),function(){this.ShowCustomerController=function($scope,$window,Customer,$routeParams,popoverService,customersNavService,spinnerService,lookupService,Vehicle){return $scope.fetch=function(){return spinnerService.start_spinner("#customer-spinner"),Customer.get({id:$routeParams.customerId},function(data){return spinnerService.stop_spinner("#customer-spinner"),$scope.customer=data,$scope.customer.is_insurer&&customersNavService.activate("Insurers"),!$routeParams.vehicleId&&$scope.customer.vehicles&&$scope.customer.vehicles.length>0?$scope.fetch_vehicle($scope.customer.vehicles[0]):void 0}),$routeParams.vehicleId?(customersNavService.activate(lookupService.asset_name_plural()),$scope.fetch_vehicle({id:$routeParams.vehicleId})):void 0},$scope.fetch_vehicle=function(vehicle){return spinnerService.start_spinner("#vehicle-spinner"),$scope.vehicle=void 0,Vehicle.get({id:vehicle.id},function(data){return spinnerService.stop_spinner("#vehicle-spinner"),data.id?($scope.vehicle=vehicle,angular.copy(data,$scope.vehicle)):void 0})},$scope.customer_updated=function(data){return $scope.vehicle?angular.copy(data,$scope.vehicle.customer):void 0},$scope.show_vehicle=function(vehicle){return $scope.fetch_vehicle(vehicle)},$scope.open_new_vehicle_form=function(){return $scope.new_vehicle={custom_attributes:{}},$scope.show_popover("#new-vehicle","#new-vehicle-button")},$scope.cancel_create_new_vehicle=function(){return $scope.hide_popover("#new-vehicle")},$scope.save_new_vehicle=function(){return $scope.new_vehicle.customer_id=$scope.customer.id,$scope.new_vehicle.registration_due_date&&($scope.new_vehicle.registration_due_date=moment($scope.new_vehicle.registration_due_date).format("DD/MM/YYYY")),spinnerService.start_spinner("#save-vehicle-spinner"),Vehicle.save($scope.new_vehicle,function(data){return spinnerService.stop_spinner("#save-vehicle-spinner"),$scope.customer.vehicles.push(data),$scope.vehicle=data,$scope.hide_popover("#new-vehicle")})},$scope.send_email=function(){return $scope.show_send_email=!0},$scope.send_sms=function(){return $scope.show_send_sms=!0},$scope.send_customer_statement=function(){return $scope.show_send_statement=!0},$scope.print_customer_statement=function(){return $window.open("/customers/"+$scope.customer.id+"/statement.pdf")},$scope.open_delete_vehicle_form=function(){return $scope.showing_delete_vehicle_dialog=!0},$scope.do_delete_vehicle=function(){return spinnerService.start_spinner("#delete-vehicle-spinner"),Vehicle["delete"]({id:$scope.vehicle.id,deleted_reason:$scope.deleted_vehicle_reason},function(){return spinnerService.stop_spinner("#delete-vehicle-spinner"),$scope.showing_delete_vehicle_dialog=!1,$scope.customer.vehicles.remove($scope.vehicle),$scope.customer.vehicles.length>0?$scope.fetch_vehicle($scope.customer.vehicles[0]):$scope.vehicle=void 0})},$scope.cancel_delete_vehicle=function(){return $scope.showing_delete_vehicle_dialog=!1},$scope.open_delete_customer_form=function(){return $scope.showing_delete_customer_dialog=!0},$scope.do_delete_customer=function(){return spinnerService.start_spinner("#delete-customer-spinner"),Customer["delete"]({id:$scope.customer.id,deleted_reason:$scope.deleted_customer_reason},function(data){return spinnerService.stop_spinner("#delete-customer-spinner"),$scope.showing_delete_customer_dialog=!1,angular.copy(data,$scope.customer)})},$scope.cancel_delete_customer=function(){return $scope.showing_delete_customer_dialog=!1},$scope.transfer_vehicle=function(){return $scope.showing_transfer_vehicle=!0},$scope.merge_vehicle=function(){return $scope.showing_merge_vehicle=!0},$scope.merge_customer=function(){return $scope.showing_merge_customer=!0},$scope.refresh=function(){return $scope.fetch()},$scope.fetch(),customersNavService.activate("Customers")}}.call(this),function(){this.AutoWorkshopApp.service("customersNavService",function(navbarService,lookupService){var _this=this;return this.active="Customers",{activate:function(activate,title){return _this.active=activate,title||(title=activate),navbarService.activate("Customers & "+lookupService.asset_name_plural(),title)},active:function(){return _this.active}}}),this.CustomersNavController=function($scope,navbarService,customersNavService,lookupService){return $scope.links=[{name:"Customers",href:"#/customers",icon:"icon-group"},{name:"3rd Parties",href:"#/insurers",icon:"icon-star"},{name:""+lookupService.asset_name_plural(),href:"#/vehicles"},{name:"Emails & SMS",href:"#/messages",icon:"icon-envelope"}],$scope.active=function(){return customersNavService.active()},$scope.isActive=function(name){return name===$scope.active()?"active":""}}}.call(this),function(){this.DataExportController=function($scope,timeService,administrationNavService,confirmationService,spinnerService,popoverService,$timeout,AutoWorkshop,ExportRequest){return administrationNavService.activate("Data Export/Import"),$scope.all_resources=[{name:"Suppliers",value:"suppliers"},{name:"Customers",value:"customers"},{name:"Vehicles",value:"vehicles"},{name:"Inventory",value:"stocks"},{name:"Job Types",value:"job_types"},{name:"Jobs",value:"jobs"},{name:"Quotes",value:"quotes"},{name:"Invoices",value:"invoices"},{name:"Bills",value:"bills"},{name:"Purchase Orders",value:"purchases"},{name:"Emails",value:"emails"},{name:"SMS",value:"sms"}],$scope.toggle_select_all=function(){return $scope.all_selected()?$scope.selected_resources=[]:$scope.select_all()},$scope.selected_resources=[],$scope.all_selected=function(){return $scope.selected_resources.length===$scope.all_resources.length},$scope.select_all=function(){return $scope.selected_resources=$scope.all_resources.map(function(e){return e.value})},$scope.cancel=function(request){return confirmationService.confirm("Do you want to cancel this export request?",!0,function(){return ExportRequest.cancel({id:request.id},function(data){return angular.copy(data,request)})})},$scope["export"]=function(){return 0===$scope.selected_resources.length?alert("Please select resources(s) to export"):ExportRequest.save({password:$scope.password,resources:$scope.selected_resources,from_date:$scope.from_date},function(data){return data.error?$scope.error=data.error.message:($scope.error=null,$scope.current_requests.unshift(data),$scope.monitor_current_requests(),$scope.password=null)})},$scope.monitor_current_requests=function(){return $scope.monitoring_current_requests=!0,ExportRequest.finished(function(data){return $scope.previous_requests=data}),ExportRequest.current(function(data){return $scope.current_requests=data,0===$scope.current_requests.length?$scope.monitoring_current_requests=!1:$scope.monitoring=$timeout($scope.monitor_current_requests,6e3)})},$scope.$on("$destroy",function(){return $timeout.cancel($scope.monitoring)}),$scope.monitor_current_requests()}}.call(this),function(){this.DiaryController=function($window,$location,$routeParams,dateFilter,$scope,Booking,popoverService,lookupService,formService,navbarService,bookingsNavService){return $scope.employees=function(){return lookupService.employees()},$scope.restricted_to_create_jobs=function(){return lookupService.restricted_to_create_jobs()},$scope.print_day_run_sheet=function(){var url;return url=URI("/jobs/print_run_sheet.pdf").query({day:$scope.today}),$window.open(url)},$scope.print_week_run_sheet=function(){var url;return url=URI("/jobs/print_run_sheet.pdf").query({week:$scope.today}),$window.open(url)},$scope.new_booking=function(){return $scope.goto("/bookings/new",{bookingView:$scope.view,year:$scope.date.getFullYear(),month:$scope.date.getMonth(),date:$scope.date.getDate()})},$scope.new_job=function(){return $scope.goto("/jobs/new")},$scope.print_run_sheet_options=function(){return $scope.run_sheet={start_date:new Date,end_date:null,all_employees:!0,employee_ids:$scope.employees().map(function(e){return e.id.toString()})},$scope.run_sheet.end_date=null,popoverService.show("#print-run-sheet-popover","#print-run-sheet-button",{placement:"left"})},$scope.print_run_sheet=function(){var options,url;return options={start_date:$scope.run_sheet.start_date,end_date:$scope.run_sheet.end_date,"employee_ids[]":$scope.run_sheet.employee_ids,without_on_hold:$scope.run_sheet.without_on_hold},$scope.run_sheet.employee_ids.length===$scope.employees().length&&(options.all_employees=!0),url=URI("/jobs/print_run_sheet.pdf").query(options),popoverService.hide("#print-run-sheet-popover"),$window.open(url)},$scope.cancel_print_run_sheet=function(){return popoverService.hide("#print-run-sheet-popover")},$scope.run_sheet_toggle_all_employees=function(){return $scope.run_sheet.all_employees?($scope.run_sheet.all_employees=!1,$scope.run_sheet.employee_ids=[]):($scope.run_sheet.all_employees=!0,$scope.run_sheet.employee_ids=$scope.employees().map(function(e){return e.id.toString()}))},bookingsNavService.activate("Diary"),$scope.date=new Date,$scope.view="basicWeek",$scope.today=moment().toString()}}.call(this),function(){this.MapController=function($window,$location,$routeParams,dateFilter,$scope,Booking,popoverService,lookupService,formService,navbarService,bookingsNavService,Job){var init_map;return init_map=function(){var address;return $scope.jobs=[],$scope.markers=[],address=lookupService.address(),$scope.map=new google.maps.Map(document.getElementById("jobs-map"),{zoom:12,center:{lat:parseFloat(address.latitude),lng:parseFloat(address.longitude)}}),Job.current(function(data){return data.forEach(function(job){var infowindow,marker;return address=$scope.street_address(job.customer),infowindow=new google.maps.InfoWindow({content:$scope.bubble_content(job)}),marker=new google.maps.Marker({position:{lat:parseFloat(address.latitude),lng:parseFloat(address.longitude)},map:$scope.map,title:"Job# "+job.number+": "+address}),marker.addListener("click",function(){return infowindow.open(map,marker)}),$scope.jobs.push([{job:job,marker:marker}])}),$scope.filter()})},$scope.bubble_content=function(job){var title;return title=dateFilter(job.time,"shortTime"),job.finished_time&&(title+=""+title+" - "+dateFilter(job.finished_time,"shortTime"),dateFilter(job.finished_time,"shortDate")!==dateFilter(job.start,"shortDate")&&(title+=""+title+" ("+dateFilter(job.finished_time,"dd/MM")+")")),title=""+title+"<br/><br/>"+$scope.street_address(job.customer).full_address+"<hr/>",job.number&&(title=""+title+"Job No.#"+job.number),job.full_description&&job.full_description.length>0&&(title=""+title+"<br/>"+job.full_description),title=""+title+"<hr/>",job.vehicle&&(title=""+title+job.vehicle.title+"<br/>"),title=""+title+job.customer.name+"<br/>",(job.customer.mobile||job.customer.phone)&&(title=""+title+"Ph: "+(job.customer.mobile||job.customer.phone)),title},$scope.street_address=function(customer){return customer.street_address&&customer.street_address.full_address.length>0?customer.street_address:customer.address},$scope.tags=function(){return lookupService.tags_of_type("Job")},$scope.employees=function(){return lookupService.assignable_employees()},$scope.filter=function(){return $scope.filtered_jobs=[],$scope.jobs.forEach(function(j){return $scope.filter_out(j.job)?j.marker.setMap(null):(j.marker.setMap($scope.map),$scope.filtered_jobs.push(j.job))})},$(window).resize(function(){var h,offsetTop;return h=$(window).height(),offsetTop=20,$("#jobs-map").css("height",h-offsetTop)}).resize(),init_map()}}.call(this),function(){this.EftposMachineIntegrationController=function($scope,timeService,lookupService,integrationsNavService,spinnerService,repcoNavigatorService,formService,AutoWorkshop,EftposMachineIntegrationAccount){return integrationsNavService.activate("EFTPOS Integration"),$scope.tyro_account={third_party:"tyro"},$scope.payment_express_account={third_party:"payment_express"},EftposMachineIntegrationAccount.tyro(function(data){return data.id?$scope.tyro_account=data:void 0}),EftposMachineIntegrationAccount.payment_express(function(data){return data.id?$scope.payment_express_account=data:void 0}),$scope.edit_accounting_integration=function(account){return formService.edit_fields(account,"editing")},$scope.save=function(account){return account.editing.id?EftposMachineIntegrationAccount.update(account.editing,function(data){return angular.copy(data,account),"tyro"===data.third_party?lookupService.set_tyro_account(data):"payment_express"===data.third_party?lookupService.set_payment_express_account(data):void 0}):EftposMachineIntegrationAccount.save(account.editing,function(data){return angular.copy(data,account),"tyro"===data.third_party?lookupService.set_tyro_account(data):"payment_express"===data.third_party?lookupService.set_payment_express_account(data):void 0})},$scope.cancel=function(account){return account.editing=void 0},$scope.start_integration=function(account){return formService.edit_fields(account,"editing")}}}.call(this),function(){this.EditEmployeeController=function($scope,$routeParams,$location,lookupService,administrationNavService,spinnerService,Employee){return administrationNavService.activate("Employees"),$scope.employee=Employee.get({id:$routeParams.employeeId}),$scope.save_employee=function(){return $scope.submit_form($scope.employee_form,function(){return spinnerService.start_spinner("#save-employee-spinner"),Employee.update($scope.employee,function(data){return spinnerService.stop_spinner("#save-employee-spinner"),data.errors?$scope.copy_fields(data,$scope.employee):(lookupService.fetch_employees(),$location.path("/employees"))})})},$scope.show_delete_employee_dialog=function(){return $scope.showing_delete_employee_dialog=!0},$scope.cancel_delete_employee=function(){return $scope.showing_delete_employee_dialog=!1},$scope.do_delete_employee=function(){return Employee["delete"]($scope.employee,function(){return lookupService.fetch_employees(),$scope.showing_delete_employee_dialog=!1,$location.path("/employees")})},$scope.output_accounts=function(){return lookupService.output_accounts()
}}}.call(this),function(){this.EmployeesController=function($scope,lookupService,administrationNavService){return administrationNavService.activate("Employees"),$scope.employees=lookupService.employees()}}.call(this),function(){this.NewEmployeeController=function($scope,lookupService,administrationNavService,spinnerService,Employee,AutoWorkshop){return administrationNavService.activate("Employees"),$scope.employee=new Employee({role:"staff",restrictions:[],no_password:!0}),AutoWorkshop.get(function(data){return $scope.auto_workshop=data}),$scope.save_employee=function(){return $scope.paying_employee()&&!$scope.confirmed_paying_employee?alert("Please confirm the extra charge to your pricing plan as a result of adding this employee"):(spinnerService.start_spinner("#save-employee-spinner"),$scope.submit_form($scope.employee_form,function(){return $scope.employee.$save(function(data){return lookupService.fetch_employees(),spinnerService.stop_spinner("#save-employee-spinner"),data.errors?void 0:$scope.back()})}))},$scope.additional_employee_price=function(){return $scope.auto_workshop.pricing_plan.display_additional_user_price},$scope.additional_employee_price_message=function(){return"Adding new employee may incur a "+$scope.additional_employee_price()+" on your current pricing plan, Please confirm to proceed"},$scope.paying_employee=function(){return $scope.auto_workshop&&$scope.auto_workshop.pricing_plan&&$scope.auto_workshop.pricing_plan.number_of_users_allowed&&lookupService.employees()&&$scope.auto_workshop.pricing_plan.number_of_users_allowed<lookupService.employees().length+1},$scope.confirm_paying_employee=function(){return $scope.confirmed_paying_employee=!0}}}.call(this),function(){this.AutoWorkshopApp.service("employeesNavService",function(navbarService){var _this=this;return this.active="Employees",{activate:function(activate,title){return _this.active=activate,title||(title=activate),navbarService.activate("Employees",title)},active:function(){return _this.active}}}),this.EmployeesNavController=function($scope,navbarService,employeesNavService){return $scope.links=[{name:"Employees",href:"#/employees",icon:"icon-group"}],$scope.active=function(){return employeesNavService.active()},$scope.isActive=function(name){return name===$scope.active()?"active":""}}}.call(this),function(){this.FollowUpsController=function($scope,jobNavService,popoverService,spinnerService,FollowUp){return $scope.search=function(page_number){return null==page_number&&(page_number=1),$scope.search_current(),$scope.search_processed()},$scope.search_current=function(page_number){return null==page_number&&(page_number=1),spinnerService.start_spinner("#current-follow-up-spinner"),FollowUp.current({query:$scope.query,page:page_number},function(data){return spinnerService.stop_spinner("#current-follow-up-spinner"),$scope.current=data})},$scope.search_processed=function(page_number){return null==page_number&&(page_number=1),spinnerService.start_spinner("#processed-follow-up-spinner"),FollowUp.processed({query:$scope.query,page:page_number},function(data){return spinnerService.stop_spinner("#processed-follow-up-spinner"),$scope.processed=data})},$scope.show_filter=function(){return $scope.showing_filter=!0},$scope.hide_filter=function(){return $scope.showing_filter=!1},$scope.edit=function(follow_up){return $scope.follow_up=follow_up,popoverService.show("#edit-follow-up-popover","#follow-up-"+follow_up.id,{placement:"bottom"})},$scope.cancel=function(){return $scope.follow_up=void 0,popoverService.hide("#edit-follow-up-popover")},$scope["new"]=function(){return $scope.follow_up={},popoverService.show("#edit-follow-up-popover","#new-follow-up-button",{placement:"bottom"})},$scope.save=function(){return spinnerService.start_spinner("#edit-follow-up-spinner"),$scope.follow_up.id?FollowUp.update($scope.follow_up,function(data){return spinnerService.stop_spinner("#edit-follow-up-spinner"),$scope.follow_up=data,popoverService.hide("#edit-follow-up-popover")}):FollowUp.save($scope.follow_up,function(){return spinnerService.stop_spinner("#edit-follow-up-spinner"),popoverService.hide("#edit-follow-up-popover"),$scope.search_current()})},$scope.cancel_follow_up=function(){return spinnerService.start_spinner("#edit-follow-up-spinner"),FollowUp.cancel($scope.follow_up,function(data){return spinnerService.stop_spinner("#edit-follow-up-spinner"),$scope.current.follow_ups.remove($scope.follow_up),$scope.follow_up=data,$scope.follow_up=void 0,popoverService.hide("#edit-follow-up-popover")})},jobNavService.activate("Follow Ups"),$scope.search()}}.call(this),function(){this.HelpsController=function($scope,Help,navbarService,timeService){return navbarService.activate("Help"),$scope.structure=Help.structure(),$scope.close=function(area){return area.close=!0},$scope.open=function(area){return area.close=!1},$scope.show=function(help,anchor){return null==anchor&&(anchor=null),$scope.help&&$scope.help.id===help.id?anchor?$scope.scroll_to(anchor):void 0:$scope.help=Help.get({id:help.id},function(){return $scope.search_results=void 0,$scope.query=void 0,$scope.help.parents=$scope.find_parents($scope.help),anchor?timeService.timeout(function(){return $scope.scroll_to(anchor)},500):void 0})},$scope.isActive=function(help){return $scope.help&&$scope.help.id===help.id&&!$scope.search_results?"active":""},$scope.home=function(){return $scope.help=void 0,$scope.search_results=void 0,$scope.query=void 0},$scope.search=function(){return $scope.search_results=Help.search({query:$scope.query},function(){return $scope.help=void 0,$scope.search_results.each(function(result){return result.parents=$scope.find_parents(result)})})},$scope.find_help=function(id,helps){var element,help,_i,_len;for(_i=0,_len=helps.length;_len>_i;_i++){if(element=helps[_i],element.id===id)return element;if(help=$scope.find_help(id,element.children))return help}},$scope.find_parents=function(help){var parent,parents,tmp;for(parents=[],tmp=help;tmp.parent_id;)parent=$scope.find_help(tmp.parent_id,$scope.structure),parent?(tmp=parent,parents.push(parent)):tmp={};return parents},$scope.scroll_to=function(help){var element;return element=document.getElementById("help-"+help.id),element?element.scrollIntoView(!0):void 0},$scope.send_message=function(){return $scope.start_spinner("#spinner"),Help.send_message({message:$scope.message},function(){return $scope.stop_spinner("#spinner"),$scope.message="",$scope.sent=!0})},$scope.send_again=function(){return $scope.sent=!1}}}.call(this),function(){this.AutoWorkshopApp.service("integrationsNavService",function(){var _this=this;return{activate:function(id){return _this.active_id=id},active_id:function(){return _this.active_id}}}),this.IntegrationsNavController=function($scope,integrationsNavService,administrationNavService){return administrationNavService.activate("Integrations","Integrations"),$scope.isActive=function(id){return id.toString()===integrationsNavService.active_id()?"active":""}}}.call(this),function(){this.AutoWorkshopApp.service("inventoryNavService",function(navbarService){var _this=this;return this.active="Stocks",{activate:function(activate,title){return _this.active=activate,title||(title=activate),navbarService.activate("Inventory & Suppliers",activate)},active:function(){return _this.active}}}),this.InventoryNavController=function($scope,timeService,navbarService,lookupService,inventoryNavService){var session;return session=lookupService.session(),$scope.links=[],session&&session.restrictions&&session.restrictions.any("access_inventory")||timeService.timeout(function(){return $scope.links=[{name:"Stocks",href:"#/stocks",icon:"icon-tags"},{name:"Kits",href:"#/kits",icon:"icon-tags"},{name:"Suppliers",href:"#/suppliers",icon:"icon-truck"},{name:"Stock Categories",href:"#/stock_categories",icon:"icon-list"},{name:"Purchase Orders",href:"#/purchases",icon:"icon-download-alt"},{name:"Stock-takes",href:"#/stocktakes",icon:"icon-ok-alt"}],session.is_admin?$scope.links.push({name:"Price Groups",href:"#/price_groups",icon:"icon-ok-alt"}):void 0}),$scope.active=function(){return inventoryNavService.active()},$scope.isActive=function(name){return name===$scope.active()?"active":""}}}.call(this),function(){this.InvoiceController=function($scope,$routeParams,$location,$window,formService,jobNavService,accountingNavService,permissionService,confirmationService,popoverService,lookupService,spinnerService,Invoice,Stock,Payment,Vehicle,DbFile){return $scope.delete_invoice=function(){return $scope.showing_delete_invoice_dialog=!0,$scope.deleted_reason=null},$scope.copy_invoice=function(){return confirmationService.confirm("Copy this invoice?",!0,function(){return spinnerService.start_spinner("#copy-invoice-spinner"),Invoice.copy({id:$scope.invoice.id},function(data){return spinnerService.stop_spinner("#copy-invoice-spinner"),$location.path("/invoices/"+data.id)})})},$scope.cancel_delete_invoice=function(){return $scope.showing_delete_invoice_dialog=!1},$scope.digital_signature_enabled=function(){return lookupService.configurations().digital_signature_enabled},$scope.digital_signature_message=function(){return lookupService.configurations().digital_signature_message},$scope.do_delete_invoice=function(){return spinnerService.start_spinner("#delete-invoice-spinner"),Invoice["delete"]({id:$scope.invoice.id,deleted_reason:$scope.deleted_reason},function(data){return spinnerService.stop_spinner("#delete-invoice-spinner"),angular.copy(data,$scope.invoice),$scope.showing_delete_invoice_dialog=!1})},$scope.show_cogs=function(){var session;return session=lookupService.session(),session&&(session.is_admin||session.is_staff)},$scope.show_hubodometer=function(){return lookupService.servicing("truck","bus")},$scope.open_cogs=function(){return $scope.cogs_opened=!0},$scope.close_cogs=function(){return $scope.cogs_opened=!1},$scope.open_related_bills=function(){return $scope.related_bills_opened=!0},$scope.close_related_bills=function(){return $scope.related_bills_opened=!1},$scope.start_pay=function(){return $scope.paying=!0},$scope.load=function(){return spinnerService.start_spinner("#invoice-loading"),Invoice.get({id:$routeParams.invoiceId},function(data){return $scope.invoice=data,spinnerService.stop_spinner("#invoice-loading"),$scope.job=$scope.invoice.job,$scope.customer=$scope.invoice.customer})},$scope.edit_customer_detail=function(){return formService.edit_fields($scope.invoice,"editing_customer_detail","id","customer_name","customer_phone","customer_street","customer_suburb")},$scope.save_customer_detail=function(){return Invoice.update($scope.invoice.editing_customer_detail,function(data){return angular.copy(data,$scope.invoice)})},$scope.edit_invoice_description=function(){return formService.edit_fields($scope.invoice,"editing_description","id","description","claim_number","excess","account_number")},$scope.save_invoice_description=function(){return Invoice.update($scope.invoice.editing_description,function(data){return angular.copy(data,$scope.invoice)})},$scope.edit_invoice_odometer=function(){return formService.edit_fields($scope.invoice,"editing_odometer","id","odometer")},$scope.save_invoice_odometer=function(){return Invoice.update($scope.invoice.editing_odometer,function(data){return angular.copy(data,$scope.invoice)})},$scope.edit_invoice_machine_hours=function(){return formService.edit_fields($scope.invoice,"editing_machine_hours","id","machine_hours")},$scope.save_invoice_machine_hours=function(){return Invoice.update($scope.invoice.editing_machine_hours,function(data){return angular.copy(data,$scope.invoice)})},$scope.edit_invoice_engine_hours=function(){return formService.edit_fields($scope.invoice,"editing_engine_hours","id","engine_hours")},$scope.save_invoice_engine_hours=function(){return Invoice.update($scope.invoice.editing_engine_hours,function(data){return angular.copy(data,$scope.invoice)})},$scope.edit_invoice_hubodometer=function(){return formService.edit_fields($scope.invoice,"editing_hubodometer","id","hubodometer")},$scope.save_invoice_hubodometer=function(){return Invoice.update($scope.invoice.editing_hubodometer,function(data){return angular.copy(data,$scope.invoice)})},$scope.edit_issue_date=function(){return formService.edit_fields($scope.invoice,"editing_issue_date","id","issue_date")},$scope.save_issue_date=function(){return $scope.submit_form($scope.edit_issue_date_form,function(){return Invoice.update($scope.invoice.editing_issue_date,function(data){return angular.copy(data,$scope.invoice)})})},$scope.edit_due_date=function(){return formService.edit_fields($scope.invoice,"editing_due_date","id","due_date")},$scope.save_due_date=function(){return $scope.submit_form($scope.edit_due_date_form,function(){return Invoice.update($scope.invoice.editing_due_date,function(data){return angular.copy(data,$scope.invoice)})})},$scope.show_customer=function(){return popoverService.show("#customer","#customer-name",{placement:"right"})},$scope.close_customer=function(){return popoverService.hide("#customer")},$scope.change_customer=function(){return permissionService.check_update_finalized_documents_restriction_before_proceed(function(){return $scope.changing_customer=!0})},$scope.create_vehicle=function(){return popoverService.hide("#change-vehicle"),popoverService.show("#new-vehicle",".vehicle-details",{placement:"bottom"}),$scope.changing_vehicle=!1},$scope.change_vehicle=function(){return permissionService.check_update_finalized_documents_restriction_before_proceed(function(){return popoverService.hide("#vehicle"),popoverService.show("#change-vehicle",".vehicle-details",{placement:"bottom"}),$scope.changing_vehicle=!0})},$scope.show_vehicle=function(){return popoverService.hide("#change-vehicle"),popoverService.show("#vehicle",".vehicle-details",{placement:"bottom"})},$scope.close_vehicle=function(){return popoverService.hide("#vehicle"),popoverService.hide("#change-vehicle")},$scope.restricted_to_enter_payment=function(){return lookupService.restricted_to_enter_payment()},$scope.upload_invoice_files=function(){return $scope.uploading_files=!0},$scope.cancel_upload_files=function(){return $("#upload-file1").val(void 0),$("#upload-file2").val(void 0),$("#upload-file3").val(void 0),$scope.uploading_files=!1},$scope.start_uploading=function(){return $scope.start_spinner("#upload-photos-spinner")},$scope.full_size_photo=function(){var active_photo;return active_photo=$scope.invoice.photos.find(function(p){return p.active}),window.open(active_photo.url)},$scope.remove_photo=function(photo){return DbFile["delete"](photo,function(){return $scope.invoice.photos.remove(photo),0===$scope.invoice.photos.length?$scope.close_photo_viewer():void 0})},$scope.edit_file=function(document){return formService.edit_fields(document,"editing","id","file_name")},$scope.cancel_edit_file=function(document){return formService.cancel(document,"editing")},$scope.rename_file=function(document){return DbFile.rename(document.editing,function(data){return document.file_name=data.file_name,document.editing=void 0})},$scope.remove_file=function(document){return $scope.start_spinner("#upload-photos-spinner"),DbFile["delete"](document,function(){return $scope.stop_spinner("#upload-photos-spinner"),$scope.invoice.documents.remove(document)})},$scope.close_photo_viewer=function(){return popoverService.hide("#photo-viewer"),$scope.invoice.photos.each(function(p){return p.active=!1})},$scope.view_photo=function(photo){return photo.active=!0,popoverService.show("#photo-viewer","#invoice-photos",{placement:"left"})},$scope.files_uploaded=function(data){return $scope.stop_spinner("#upload-photos-spinner"),$("#upload-file1").val(void 0),$("#upload-file2").val(void 0),$("#upload-file3").val(void 0),$scope.uploading_files=!1,"object"==typeof data?angular.copy(data,$scope.invoice):alert("Error while uploading file(s), please check that each file is maximum 1Mb and try again.")},$scope.cancel_create_new_vehicle=function(){return popoverService.hide("#new-vehicle"),$scope.change_vehicle()},$scope.save_new_vehicle=function(){return $scope.new_vehicle.customer_id=$scope.customer.id,$scope.new_vehicle.registration_due_date&&($scope.new_vehicle.registration_due_date=moment($scope.new_vehicle.registration_due_date).format("DD/MM/YYYY")),spinnerService.start_spinner("#save-vehicle-spinner"),Vehicle.save($scope.new_vehicle,function(data){return Invoice.change_vehicle({id:$scope.invoice.id,vehicle:{id:data.id}},function(){}),spinnerService.stop_spinner("#save-vehicle-spinner"),$scope.invoice.vehicle=data,$scope.hide_popover("#new-vehicle")})},$scope.configurations=lookupService.configurations(),"jobs"===$routeParams.template?($scope.view="jobs",jobNavService.activate("Current Jobs")):($scope.view="invoices",accountingNavService.activate("Invoices")),$scope.paying=!1,$scope.send_email=!1,$scope.print=!1,window.$scope=$scope,$scope.load()}}.call(this),function(){this.InvoicesController=function(timeService,$scope,$routeParams,$location,$window,accountingNavService,lookupService,spinnerService,popoverService,confirmationService,Invoice){var search_query;return $scope.sort=function(attribute){return $scope.order_by===attribute?$scope.order="asc"===$scope.order?"desc":"asc":$scope.order_by=attribute,$scope.search()},$scope.search=function(page){var search_count,search_query;return null==page&&(page=1),search_query={query:$scope.query,page:page,order_by:$scope.order_by,order:$scope.order,showing_deleted:$scope.showing_deleted,showing_paid:$scope.showing_paid,showing_unpaid:$scope.showing_unpaid,showing_in_progress:$scope.showing_in_progress,showing_finalized:$scope.showing_finalized,showing_filter:$scope.showing_filter},lookupService.save_search_query("invoices",search_query),$scope.start_spinner("#invoices-spinner"),$scope.search_count||($scope.search_count=0),$scope.search_count+=1,search_count=$scope.search_count,Invoice.search(search_query,function(data){return search_count===$scope.search_count?($scope.keyword=$scope.query.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.invoices=data.invoices,$scope.stop_spinner("#invoices-spinner")):void 0})},$scope.show_filter=function(){return $scope.showing_filter=!0},$scope.hide_filter=function(){return $scope.query.issued_from="",$scope.query.issued_to="",$scope.query.statuses=["paid","unpaid","deleted"],$scope.showing_filter=!1},$scope.download=function(){var params;return params=$.param({query:$scope.query}),window.open("/invoices/download?"+params)},$scope.bulk_print=function(){var ids,selected;return selected=$scope.invoices.findAll(function(i){return i.selected}),ids=selected.map(function(i){return i.id}),selected&&0!==selected.length?selected.length<5?$window.open("/invoices/bulk_print.pdf?"+$.param({ids:ids})):Invoice.bulk_invoices({ids:ids},function(){return $scope.message="Your customer invoices are now queued to be generated. You will receive a email once the process is finished"}):alert("Please select one or more invoices to print")},$scope.bulk_finalize=function(){var ids,selected;return selected=$scope.invoices.findAll(function(i){return i.selected}),selected&&0!==selected.length?(ids=selected.map(function(i){return i.id}),$scope.start_spinner("#invoice-bulk-action-spinner"),Invoice.bulk_finalize({ids:ids},function(){return $scope.stop_spinner("#invoice-bulk-action-spinner"),$scope.search()})):alert("Please select one or more invoices to finalize")},$scope.start_bulk_send=function(){var customer_id,multiple_customers,selected;return selected=$scope.invoices.findAll(function(i){return i.selected}),selected&&0!==selected.length?(customer_id=selected[0].customer.id,multiple_customers=!1,selected.forEach(function(invoice){return invoice.customer.id!==customer_id?multiple_customers=!0:void 0}),confirmationService.confirm("The invoices selected are associated with more than one customers. Do you want to proceed?",multiple_customers,function(){return $scope.email=selected[0].customer.email,popoverService.show("#bulk-send-invoice-popover","#invoice-bulk-actions",{placement:"left"})})):alert("Please select one or more invoices to send")},$scope.cancel_bulk_send=function(){return popoverService.hide("#bulk-send-invoice-popover")},$scope.bulk_send=function(){var ids,selected;return selected=$scope.invoices.findAll(function(i){return i.selected}),ids=selected.map(function(i){return i.id}),spinnerService.start_spinner("#bulk-send-invoice-spinner"),Invoice.bulk_send({ids:ids,email:$scope.email,message:$scope.email_message,subject:$scope.email_subject},function(){return $scope.message="Your customer invoices are now queued to be generated and send.",spinnerService.start_spinner("#bulk-send-invoice-spinner"),popoverService.hide("#bulk-send-invoice-popover")})},$scope.toggle_deleted=function(number){return null==number&&(number=1),$scope.showing_unpaid=!1,$scope.showing_paid=!1,$scope.showing_finalized=!1,$scope.showing_in_progress=!1,timeService.timeout(function(){return $scope.query.statuses=void 0,$scope.query.finalized=void 0,$scope.query.in_progress=void 0,$scope.showing_deleted?($scope.query.deleted=!0,$scope.order_by="deleted_at"):($scope.query.deleted=void 0,$scope.order_by=void 0),$scope.search()})},$scope.toggle_unpaid=function(number){return null==number&&(number=1),$scope.showing_deleted=!1,$scope.showing_paid=!1,timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.statuses=$scope.showing_unpaid?["unpaid"]:["unpaid","paid"],$scope.search()})},$scope.toggle_paid=function(number){return null==number&&(number=1),$scope.showing_deleted=!1,$scope.showing_unpaid=!1,timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.statuses=$scope.showing_paid?["paid"]:["unpaid","paid"],$scope.search()})},$scope.toggle_finalized=function(number){return null==number&&(number=1),$scope.showing_deleted=!1,$scope.showing_in_progress=!1,timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.in_progress=void 0,$scope.query.finalized=$scope.showing_finalized?!0:void 0,$scope.search()})},$scope.toggle_in_progress=function(number){return null==number&&(number=1),$scope.showing_deleted=!1,$scope.showing_finalized=!1,timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.finalized=void 0,$scope.query.in_progress=$scope.showing_in_progress?!0:void 0,$scope.search()})},$scope.tags=function(){return lookupService.tags_of_type("Invoice")},$scope.preview=function(invoice){return $scope.preview_anchor="#preview-"+invoice.id,$scope.previewed_invoice=invoice},$scope.invoice_path=function(invoice){return invoice.job_id?"#/jobs/"+invoice.job_id:"#/invoices/"+invoice.id},$scope.toggle_select_all=function(){return $scope.all_selected?($scope.invoices.forEach(function(i){return i.selected=!1}),$scope.all_selected=!1):($scope.all_selected=!0,$scope.invoices.forEach(function(i){return i.selected=!0}))},$scope.can_undelete_invoice=function(){return lookupService.enable_undelete()&&lookupService.session().is_admin},$scope.undelete=function(invoice){return confirmationService.confirm("Do you want to undelete this invoice?",!0,function(){return Invoice.undelete({id:invoice.id},function(data){return $location.path("/invoices/"+data.id)})})},accountingNavService.activate("Invoices"),search_query=lookupService.search_query("invoices"),search_query&&search_query.query&&$routeParams.cached?($scope.query=search_query.query,$scope.order_by="issue_date",$scope.showing_unpaid=search_query.showing_unpaid,$scope.showing_paid=search_query.showing_paid,$scope.showing_deleted=search_query.showing_deleted,$scope.showing_in_progress=search_query.showing_in_progress,$scope.showing_finalized=search_query.showing_finalized,$scope.showing_filter=search_query.showing_filter,$scope.search(search_query.page||1)):($scope.query={query:null},lookupService.save_search_query("invoices",{query:{query:""},statuses:["unpaid","paid"]}),$location.path("/invoices").search({cached:Math.random()}).replace())}}.call(this),function(){this.NewInvoiceController=function($scope,$routeParams,$location,accountingNavService,lookupService,spinnerService,paymentTermService,formService,Invoice,Customer,Vehicle){return accountingNavService.activate("Invoices"),$scope.selection={},$scope.recommendations=[],$scope.configurations=lookupService.configurations(),$scope.employees=function(){return lookupService.assignable_employees()},$scope.invoice=new Invoice({items:[],issue_date:new Date,customer:{},vehicle:{},quote_id:$routeParams.quote_id,employee_id:lookupService.session().employee_id}),$routeParams.customer_id&&Customer.recommendation({id:$routeParams.customer_id},function(data){return $scope.initialize_data({customer:data,vehicle_id:$routeParams.vehicle_id})}),formService.select_text("#ad-customer-vehicle-form-name"),$scope.save_invoice=function(){return!lookupService.business_source_required()||$scope.invoice.customer.id||$scope.invoice.customer.business_source_id?$scope.invoice.customer.require_order_number&&!$scope.invoice.order_number?alert("This customer requires Order Number for all jobs and invoices"):$scope.submit_form($scope.new_invoice_form,function(){return spinnerService.start_spinner("#create-invoice-spinner"),$scope.invoice.$save(function(data){return spinnerService.stop_spinner("#create-invoice-spinner"),$location.path("/invoices/"+data.id+"?template=invoices")})}):alert("Please select the customer's source of business")},$scope.show_hubodometer=function(){return lookupService.servicing("truck","bus")},$scope.initialize_data=function(data){return data.customer?($scope.selection.customer=data.customer,$scope.recommendations=[data.customer],$scope.invoice.due_date=paymentTermService.due_date($scope.invoice.issue_date,data.customer.payment_term)):$scope.invoice.due_date=new Date,data.description&&($scope.invoice.description=data.description),data.vehicle&&($scope.selection.vehicle=$scope.selection.customer.vehicles.find(function(vehicle){return vehicle.id.toString()===data.vehicle.id.toString()}),$scope.selection.vehicle||($scope.selection.customer.vehicles.unshift(data.vehicle),$scope.selection.vehicle=data.vehicle)),data.vehicle_id&&($scope.selection.vehicle=$scope.selection.customer.vehicles.find(function(vehicle){return vehicle.id.toString()===data.vehicle_id.toString()}),$scope.selection.vehicle||Vehicle.get({id:data.vehicle_id},function(vehicle_data){return $scope.selection.customer.vehicles.unshift(vehicle_data),$scope.selection.vehicle=vehicle_data})),data.tracking_categories&&($scope.invoice.tracking_categories=data.tracking_categories),data.royalty_integration_account_id?($scope.invoice.royalty_integration_account_id(data.royalty_integration_account_id),$scope.invoice.royalty_account_number(data.royalty_account_number),$scope.invoice.royalty_auto_club(data.royalty_auto_club)):void 0}}}.call(this),function(){this.SignInvoiceController=function($scope,$window,$route,$routeParams,$location,spinnerService,Invoice){var wrapper;return $scope.clear_signature=function(){return $scope.signaturePad.clear()},$scope.sign=function(invoice_id){var signature;return $scope.signature_email=$("#signature-email").val(),$scope.signaturePad.isEmpty()?alert("Please sign"):$scope.signature_email&&0!==$scope.signature_email.length?(signature=$scope.signaturePad.toDataURL("image/svg+xml"),spinnerService.start_spinner("#signing-spinner"),Invoice.sign({id:invoice_id,signature:signature,signature_email:$scope.signature_email},function(data){return spinnerService.stop_spinner("#signing-spinner"),data.error?alert(data.error.message):(window.opener.$scope.load(),$scope.close_signature())})):alert("Please enter the customer's email address to send the signed invoice to")},$scope.resize_canvas=function(){return $scope.canvas.width=$(".sign-area-body").width(),$scope.canvas.height=200,$scope.signaturePad.clear()},$scope.close_signature=function(){return window.opener.focus(),window.close()},wrapper=document.getElementById("sign-area"),$scope.canvas=wrapper.querySelector("canvas"),$scope.signaturePad=new SignaturePad($scope.canvas,{backgroundColor:"rgb(255, 255, 255)"}),$scope.resize_canvas()}}.call(this),function(){this.AutoWorkshopApp.service("jobNavService",function(navbarService){var _this=this;return this.active="Current Job",{activate:function(activate,title){return _this.active=activate,title||(title=activate),navbarService.activate("Jobs",title)},active:function(){return _this.active}}}),this.JobNavController=function($scope,navbarService,jobNavService,lookupService){return $scope.nav_links=[],$scope.links=function(){return 0===$scope.nav_links.length&&lookupService.session().auto_workshop_id&&$scope.build_nav_links(),$scope.nav_links},$scope.build_nav_links=function(){return lookupService.session()&&lookupService.session().employee_id?(lookupService.session().is_restricted_mechanic||lookupService.session().is_mechanic?($scope.nav_links=[{name:"Current Jobs",href:"#",icon:"icon-wrench"}],lookupService.restricted_to_access_all_jobs()||$scope.nav_links.push([{name:"All Jobs",href:"#/all_jobs",icon:"icon-ok"}])):($scope.nav_links=[{name:"Current Jobs",href:"/auto_workshop/app",icon:"icon-wrench"},{name:"Quotes",href:"#/quotes",icon:"icon-file-text-alt"}],lookupService.restricted_to_access_all_jobs()||$scope.nav_links.push([{name:"All Jobs",href:"#/all_jobs",icon:"icon-ok"}]),$scope.nav_links.push([{name:"Follow Ups",href:"#/follow_ups",icon:"icon-mail-forward"}]),(lookupService.session().is_staff||lookupService.session().is_admin)&&$scope.nav_links.push([{name:"Job Types",href:"#/job_types",icon:"icon-file"},{name:"Communication Templates",href:"#/communication_templates",icon:"icon-file"}])),$scope.nav_links=$scope.nav_links.flatten()):void 0},$scope.active=function(){return jobNavService.active()},$scope.isActive=function(name){return name===$scope.active()?"active":""}}}.call(this),function(){this.JobTypesController=function($scope,jobTypesNavService){return jobTypesNavService.activate(null)}}.call(this),function(){this.AutoWorkshopApp.service("jobTypesNavService",function(){var _this=this;return{activate:function(id){return _this.active_id=id},active_id:function(){return _this.active_id}}}),this.JobTypesNavController=function($scope,jobTypesNavService,spinnerService,jobNavService,JobType){return jobNavService.activate("Job Types"),spinnerService.start_spinner("#job-type-list-spinner"),JobType.all(function(data){return $scope.job_types=data,spinnerService.stop_spinner("#job-type-list-spinner")}),$scope.isActive=function(id){return id.toString()===jobTypesNavService.active_id()?"active":""}}}.call(this),function(){this.NewJobTypeController=function($scope,jobTypesNavService,JobType,lookupService,$location,formService,spinnerService,$routeParams){return $scope.save_new_job_type=function(){return $scope.submit_form($scope.new_job_type_form,function(){return spinnerService.start_spinner("#save-job-type-spinner"),$scope.job_type.$save(function(data){return spinnerService.stop_spinner("#save-job-type-spinner"),lookupService.fetch_job_types(),$location.path("/job_types/"+data.id)})})},$scope.cancel_new_job_type=function(){return $location.path("/job_types")},$scope.copy_job_type=function(){var descriptions,job_types_with_description,job_types_with_next_service_days,next_service_days,selected_job_types;return selected_job_types=[],$scope.job_type.copied_from_job_type_ids&&(selected_job_types=$scope.job_type.copied_from_job_type_ids.map(function(selected_id){var job_type;return job_type=lookupService.job_types().find(function(jt){return jt.id===parseInt(selected_id)})}),job_types_with_description=selected_job_types.filter(function(jt){return jt.description}),descriptions=job_types_with_description.map(function(jt){return jt.description}),$scope.job_type.description=descriptions.join("\n\n"),job_types_with_next_service_days=selected_job_types.filter(function(jt){return jt.next_service_days}),next_service_days=job_types_with_next_service_days.map(function(jt){return jt.next_service_days}),next_service_days.length>0)?$scope.job_type.next_service_days=next_service_days.min():void 0},jobTypesNavService.activate(null),$scope.job_type=new JobType({title:"name",copied_from_job_type_ids:[]}),formService.select_text("#new-job-type-title"),$routeParams.copied_from_job_type&&($scope.copied_from_job_type=!0,$scope.job_type.copied_from_job_type_ids=[$routeParams.copied_from_job_type]),$routeParams.copied_from_invoice?($scope.copied_from_invoice=!0,$scope.job_type.copied_from_invoice_number=[$routeParams.copied_from_invoice]):void 0}}.call(this),function(){this.ShowJobTypeController=function($scope,$location,$routeParams,spinnerService,jobTypesNavService,lookupService,formService,JobType,Cost,Work,DbFile){return $scope.add_work=function(header){return null==header&&(header=!1),$scope.new_work=new Work({job_id:$scope.job_type.id,title:"name"}),header&&($scope.new_work.header=!0),formService.select_text("#new-work-title")
},$scope.add_work_header=function(){return $scope.add_work(!0)},$scope.save_new_work=function(){return $scope.submit_form($scope.new_work_form,function(){return $scope.new_work.$save(),$scope.job_type.works.push($scope.new_work),$scope.new_work=null,formService.focus("#new-work-button")})},$scope.cancel_new_work=function(){return $scope.new_work=null},$scope.edit_work=function(work){var copy;return copy={},angular.copy(work,copy),work.editing=copy},$scope.edit_cost_details=function(cost){return cost.edit_details=!0},$scope.show_cost_details=function(cost){return cost.show_details=!0},$scope.hide_cost_details=function(cost){return cost.show_details=!1},$scope.save_work=function(form,work){return $scope.submit_form(form,function(){var updated_work;return updated_work=new Work(work.editing),updated_work.$update(function(data){return angular.copy(data,work),work.editing=!1,formService.focus("#new-work-button")})})},$scope.remove_work=function(work){var deleted_work;return deleted_work=new Work(work),deleted_work.$delete(),$scope.job_type.works.remove(work)},$scope.cancel_edit_work=function(work){return work.editing=!1},$scope.add_cost=function(){return formService.select_text("#new-cost-description"),$scope.new_cost=new Cost({job_id:$scope.job_type.id,description:"description",quantity:1,unit_price:0,included_gst:lookupService.configurations().prices_include_gst,use_stock_price:!0})},$scope.save_new_cost=function(){return lookupService.disable_arbitrary_line_items()&&!$scope.new_cost.stock_id?(alert("Please select an item from the dropdown or click 'Create Stock' button to create one"),void 0):$scope.submit_form($scope.new_cost_form,function(){return $scope.new_cost.$save(function(data){return $scope.job_type.costs.push(data),JobType.get({id:$routeParams.jobTypeId},function(data){return angular.copy(data,$scope.job_type)}),$scope.new_cost=null})})},$scope.edit_cost=function(cost){var copy;return copy={},angular.copy(cost,copy),cost.editing=copy},$scope.cancel_edit_cost=function(cost){return cost.editing=!1},$scope.save_cost=function(form,cost){return $scope.submit_form(form,function(){var edited_cost;return edited_cost=new Cost(cost.editing),edited_cost.$update(function(data){return cost.editing=null,angular.copy(data,cost),$scope.job_type=JobType.get({id:$routeParams.jobTypeId})})})},$scope.remove_cost=function(cost){var deleted_cost;return deleted_cost=new Cost({job_id:$scope.job_type.id,id:cost.id}),deleted_cost.$delete(function(){return JobType.get({id:$routeParams.jobTypeId},function(data){return angular.copy(data,$scope.job_type)})})},$scope.cancel_add_cost=function(){return $scope.new_cost=null},$scope.cost_total=function(cost){return cost&&cost.quantity&&cost.unit_price?cost.quantity*cost.unit_price:0},$scope.edit=function(){return formService.edit_fields($scope.job_type,"editing")},$scope.save_job_type=function(){return $scope.submit_form($scope.edit_job_type_form,function(){return JobType.update($scope.job_type.editing,function(data){return angular.copy(data,$scope.job_type),lookupService.fetch_job_types()})})},$scope.upload_job_files=function(){return $scope.uploading_files=!0},$scope.cancel_upload_files=function(){return $("#upload-file1").val(void 0),$("#upload-file2").val(void 0),$("#upload-file3").val(void 0),$scope.uploading_files=!1},$scope.files_uploaded=function(data){return $scope.stop_spinner("#upload-photos-spinner"),$("#upload-file1").val(void 0),$("#upload-file2").val(void 0),$("#upload-file3").val(void 0),$scope.uploading_files=!1,"object"==typeof data?angular.copy(data,$scope.job_type):alert("Error while uploading file(s), please check that each file is maximum 1Mb and try again.")},$scope.start_uploading=function(){return $scope.start_spinner("#upload-photos-spinner")},$scope.edit_file=function(file){return formService.edit_fields(file,"editing","id","file_name","print_with_job_card")},$scope.cancel_edit_file=function(file){return formService.cancel(file,"editing")},$scope.rename_file=function(file){return DbFile.rename(file.editing,function(data){return angular.copy(data,file)})},$scope.remove_file=function(file){return DbFile["delete"](file,function(){return $scope.job_type.files.remove(file)})},$scope.new_stock={with_gst:{}},$scope.select_new_stock=function(){var _base;return $scope.new_cost.stock_id=$scope.new_stock.id,(_base=$scope.new_cost).quantity||(_base.quantity=1),$scope.new_cost.unit_price=$scope.new_stock.price,$scope.new_cost.description=""+$scope.new_stock.stock_number+" - "+($scope.new_stock.name||""),$scope.new_cost.included_gst?void 0:$scope.new_cost.included_gst=$scope.new_stock.included_gst},$scope.reorder_works=function(){return JobType.reorder_works($scope.job_type,function(data){return angular.copy(data,$scope.job_type)})},$scope.reorder_costs=function(){return JobType.reorder_costs($scope.job_type,function(data){return angular.copy(data,$scope.job_type)})},$scope.work_sortable_options={handle:".dragable-handle",helper:"clone",stop:function(){return $scope.reorder_works()}},$scope.cost_sortable_options={handle:".dragable-handle",helper:"clone",stop:function(){return $scope.reorder_costs()}},jobTypesNavService.activate($routeParams.jobTypeId),spinnerService.start_spinner("#job-type-loading"),JobType.get({id:$routeParams.jobTypeId},function(data){return spinnerService.stop_spinner("#job-type-loading"),$scope.job_type=data}),$scope.do_delete_job_type=function(){return $scope.showing_delete_job_type_dialog=!1,$scope.job_type.$delete(function(){return lookupService.fetch_job_types(),$location.path("/job_types")})}}}.call(this),function(){this.AllJobsController=function($scope,Job,confirmationService,spinnerService,timeService,jobNavService,lookupService,formService,$location,$routeParams){var search_query;return $scope.search=function(query,number){var search_count,search_query;return null==query&&(query=$scope.query),null==number&&(number=1),spinnerService.start_spinner("#all-jobs-spinner"),query.deleted&&(query.statuses=void 0),$scope.search_count||($scope.search_count=0),$scope.search_count+=1,search_count=$scope.search_count,search_query={query:query,page:number,order:"desc",order_by:"id"},lookupService.save_search_query("jobs",search_query),Job.search(search_query,function(data){return search_count===$scope.search_count?($scope.keyword=$scope.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.jobs=data.jobs,spinnerService.stop_spinner("#all-jobs-spinner")):void 0})},$scope.selectPage=function(number){return $scope.search($scope.query,number)},$scope.tags=function(){return lookupService.tags_of_type("Job")},$scope.toggle_finalized=function(number){return null==number&&(number=1),timeService.timeout(function(){return $scope.query.finalized&&($scope.query.unfinalized=!1),$scope.search()})},$scope.toggle_unfinalized=function(number){return null==number&&(number=1),timeService.timeout(function(){return $scope.query.unfinalized&&($scope.query.finalized=!1),$scope.search()})},$scope.toggle_finished=function(number){return null==number&&(number=1),timeService.timeout(function(){return $scope.query.finished&&($scope.query.unfinished=!1),$scope.search()})},$scope.toggle_unfinished=function(number){return null==number&&(number=1),timeService.timeout(function(){return $scope.query.unfinished&&($scope.query.finished=!1),$scope.search()})},$scope.toggle_on_hold=function(number){return null==number&&(number=1),timeService.timeout(function(){return $scope.query.on_hold&&($scope.query.on_hold=!1),$scope.search()})},$scope.can_undelete_job=function(){return lookupService.enable_undelete()&&lookupService.session().is_admin},$scope.undelete=function(job){return confirmationService.confirm("Do you want to undelete this job?",!0,function(){return Job.undelete({id:job.id},function(data){return $location.path("/jobs/"+data.id)})})},jobNavService.activate("All Jobs"),formService.select_text("#all-jobs-search-input"),search_query=lookupService.search_query("jobs"),search_query&&search_query.query&&$routeParams.cached?($scope.query=search_query.query,$scope.search(search_query.query,search_query.number)):($scope.query={query:null,deleted:!1},lookupService.save_search_query("jobs",{query:{query:null,deleted:!1}}),$location.path("/all_jobs").search({cached:Math.random()}).replace())}}.call(this),function(){this.JobsController=function($location,$scope,$log,$route,timeService,Job,spinnerService,jobNavService,lookupService,formService,$filter,$timeout,Booking,Invoice){var next_week,today;return $scope.cancel_booking=function(booking){return Booking["delete"](booking,function(){return $scope.bookings.remove(booking)})},$scope.hide_unpaid_invoices_for_mechanics=function(){return lookupService.hide_unpaid_invoices_for_mechanics()},$scope.open_invoice=function(invoice){return timeService.timeout(function(){return invoice.job_id?$location.path("/jobs/"+invoice.job_id):$location.path("/invoices/"+invoice.id)},100)},$scope.search_invoices=function(){return $timeout.cancel($scope.searching_invoice),$scope.searching_invoice=$timeout($scope.fetch_unpaid_invoices,1500)},$scope.fetch_unpaid_invoices=function(page){return null==page&&(page=1),spinnerService.start_spinner("#unpaid-jobs-spinner"),Invoice.search({query:{query:$scope.unpaid_invoice_search,statuses:["unpaid"]},order_by:"number",order:"desc",per_page:15,page:page},function(data){return $scope.unpaid_invoices={invoices:data.invoices,total_pages:data.meta.total_pages,page_number:data.meta.page},spinnerService.stop_spinner("#unpaid-jobs-spinner")})},$scope.open_job=function(job){return spinnerService.start_spinner("#job-"+job.id),$location.path("jobs/"+job.id)},$scope.search=function(){var params;return spinnerService.start_spinner("#current-jobs-spinner"),params={},$scope.only_on_hold&&(params.on_hold=!0),Job.get_open(params,function(data){return $scope.open_jobs=data,spinnerService.stop_spinner("#current-jobs-spinner")})},$scope.$watch("only_on_hold",function(){return $scope.search()}),$scope.filtered_jobs=function(){var current_jobs;return $scope.open_jobs?(current_jobs=$scope.open_jobs.findAll(function(job){return!job.on_hold}),$filter("filter")(current_jobs,$scope.current_job_search)):[]},$scope.filtered_bookings=function(){return $scope.bookings?$filter("filter")($scope.bookings,$scope.current_job_search):[]},$scope.total_pages=function(){var full,length;return length=$scope.filtered_jobs().length,full=parseInt(length/$scope.per_page),length%$scope.per_page>0?full+1:full},$scope.current_jobs=function(page_number){var filtered_jobs;return null==page_number&&(page_number=1),filtered_jobs=$scope.filtered_jobs(),filtered_jobs.slice((page_number-1)*$scope.per_page,page_number*$scope.per_page)},$scope.on_hold_jobs=function(){var on_hold_jobs;return $scope.open_jobs?(on_hold_jobs=$scope.open_jobs.findAll(function(job){return job.on_hold}),$filter("filter")(on_hold_jobs,$scope.current_job_search)):[]},$scope.restricted_to_create_jobs=function(){return lookupService.restricted_to_create_jobs()},$scope.put_on_hold=function(job){return $scope.putting_on_hold=!1,$scope.action_job=job,$scope.actions_job_anchor="#actions-job-"+job.id,$scope.putting_on_hold=!0},$scope["continue"]=function(job){return Job["continue"]({id:job.id},function(data){return angular.copy(data,job)})},$scope.send_sms=function(job){return $scope.sending_sms=!1,$scope.action_job=job,$scope.actions_job_anchor="#actions-job-"+job.id,$scope.sending_sms=!0},$scope.send_email=function(job){return $scope.sending_email=!1,$scope.action_job=job,$scope.actions_job_anchor="#actions-job-"+job.id,$scope.sending_email=!0},$scope.tag=function(job){return $scope.tagging_job=!1,$scope.action_job=job,$scope.actions_job_anchor="#actions-job-"+job.id,$scope.tagging_job=!0},$scope.assign=function(job){return $scope.assigning_job=!1,$scope.action_job=job,$scope.actions_job_anchor="#actions-job-"+job.id,$scope.assigning_job=!0},jobNavService.activate("Current Jobs"),today=new Date,today.setHours(0),next_week=moment().add(7,"days").toDate(),$scope.per_page=12,$scope.search(),spinnerService.start_spinner("#upcoming-bookings-spinner"),Booking.active({start:today,end:next_week},function(data){return $scope.bookings=data,spinnerService.stop_spinner("#upcoming-bookings-spinner")}),$scope.fetch_unpaid_invoices(),formService.select_text("#jobs-search-input")}}.call(this),function(){this.LoadingJobController=function($scope,$routeParams,lookupService,spinnerService,timeService,$location,jobNavService){return jobNavService.activate("Current Jobs"),spinnerService.start_spinner("#job-loading"),timeService.timeout(function(){return lookupService.preference("use_simple_job_page")?$location.path("/jobs/"+$routeParams.jobId+"/simple"):$location.path("/jobs/"+$routeParams.jobId+"/full"),$location.replace()},100)}}.call(this),function(){this.NewJobController=function($scope,$routeParams,$window,$location,lookupService,jobNavService,timeService,Vehicle,Invoice,Quote,Job,Booking,VehicleModel,Customer,Employee,CourtesyVehicleBooking,confirmationService,spinnerService,popoverService,formService){return $scope.initialize=function(){var time;return jobNavService.activate("Current Jobs"),$scope.selection={},$scope.recommendations=[],$routeParams.time?(time=new Date($routeParams.time),time.setHours(timeService.current().getHours())):time=timeService.current(),$scope.job={customer:{},vehicle:{},prepare:$routeParams.prepare,job:{master_job_id:$routeParams.master_job_id,time:time,tags:[],job_type_ids:[]}},$scope.disable_default_pickup_time()||($scope.job.job.pickup_time=time.clone(),$scope.job.job.pickup_time.setSeconds(0),$scope.job.job.pickup_time.setMinutes(0),$scope.job.job.pickup_time.setHours(17)),$routeParams.booking&&($scope.booking=Booking.get({id:$routeParams.booking},function(data){return $scope.initialize_data(data),data.pickup_time&&($scope.job.job.pickup_time=new Date(data.pickup_time)),$routeParams.prepare&&data.time&&($scope.job.job.time=new Date(data.time)),$routeParams.prepare&&data.finished_time&&($scope.job.job.finished_time=new Date(data.finished_time)),$scope.job.job.total_hours=data.total_hours,data.employees[0]&&($scope.job.mechanic_1_id=data.employees[0].id),data.employees[1]&&($scope.job.mechanic_2_id=data.employees[1].id),data.employees[2]&&($scope.job.mechanic_3_id=data.employees[2].id),data.employees[3]&&($scope.job.mechanic_4_id=data.employees[3].id),$scope.booking.job_id?confirmationService.confirm("The job for this booking has been created. Navigate to the job?",!0,function(){return $location.path("/jobs/"+$scope.booking.job_id)}):void 0})),$routeParams.quote_id&&($scope.job.job.quote_id=$routeParams.quote_id,Quote.get({id:$routeParams.quote_id},function(data){return $scope.initialize_data(data),$scope.calculate_estimate_work_hours()})),$routeParams.customer_id&&Customer.recommendation({id:$routeParams.customer_id},function(data){return $scope.initialize_data({customer:data,vehicle_id:$routeParams.vehicle_id,insurer_id:data.insurer_id})}),$routeParams.invoice_id&&Invoice.get({id:$routeParams.invoice_id},function(data){return data.vehicle?Vehicle.get({id:data.vehicle.id},function(vehicle_data){return data.customer.id!==vehicle_data.customer.id&&(data.insurer_id=data.customer.id),data.customer=vehicle_data.customer,$scope.initialize_data(data),$scope.job.job.invoice_id=data.id}):($scope.initialize_data(data),$scope.job.job.invoice_id=data.id)}),formService.select_text("#ad-customer-vehicle-form-name")},$scope.employees=function(){return lookupService.assignable_employees()},$scope.show_assign_to_mechanics=function(){return $scope.showing_assign_to_mechanics=!0},$scope.show_schedule=function(){var scheduler;return scheduler=$window.open("/auto_workshop/diary_view","Diary","directories=0,titlebar=0,toolbar=0, menubar=0, height=800, width="+window.outerWidth)},$scope.remove_mechanic=function(mechanic){return 1===mechanic&&($scope.job.mechanic_1_id=void 0),2===mechanic&&($scope.job.mechanic_2_id=void 0),3===mechanic&&($scope.job.mechanic_3_id=void 0),4===mechanic&&($scope.job.mechanic_4_id=void 0),5===mechanic&&($scope.job.mechanic_5_id=void 0),6===mechanic&&($scope.job.mechanic_6_id=void 0),7===mechanic&&($scope.job.mechanic_7_id=void 0),8===mechanic?$scope.job.mechanic_8_id=void 0:void 0},$scope.add_note=function(){return $scope.show_note=!0},$scope.create=function(){return!lookupService.business_source_required()||$scope.job.customer.id||$scope.job.customer.business_source_id?$scope.job.customer.require_order_number&&!$scope.job.job.order_number?alert("This customer requires Order Number for all jobs and invoices"):$scope.submit_form($scope.job_form,function(){return $scope.is_present($scope.job.vehicle)&&$scope.is_present($scope.job.customer)?$scope.do_save_job():$scope.showing_data_alert=!0}):alert("Please Select a source of business for the customer")},$scope.cancel_save_job=function(){return $scope.showing_data_alert=!1},$scope.open_current_jobs=function(){return popoverService.show("#vehicle-current-jobs-popover","#current-jobs-notification",{placement:"top"})},$scope.close_current_jobs=function(){return popoverService.hide("#vehicle-current-jobs-popover")},$scope.do_save_job=function(){return confirmationService.confirm_in_position("Ongoing job exists for this vehicle, create new job anyway?",$scope.current_jobs.length>0,{anchor:"#create-new-job",placement:"top"},function(){return $scope.showing_data_alert=!1,$scope.booking&&($scope.job.booking=$scope.booking),$scope.job.employee_ids=[$scope.job.mechanic_1_id,$scope.job.mechanic_2_id,$scope.job.mechanic_3_id,$scope.job.mechanic_4_id,$scope.job.mechanic_5_id,$scope.job.mechanic_6_id,$scope.job.mechanic_7_id,$scope.job.mechanic_8_id],$scope.job.job.insurer_id||(delete $scope.job.job.account_number,delete $scope.job.job.claim_number,delete $scope.job.job.excess),spinnerService.start_spinner("#new-job-spinner"),Job.save($scope.job,function(data){return spinnerService.stop_spinner("#new-job-spinner"),data.error?alert(data.error):$location.path("/jobs/"+data.id)})})},$scope.initialize_data=function(data){return data.customer&&($scope.selection.customer=data.customer,$scope.recommendations=[data.customer]),data.vehicle?($scope.selection.vehicle=$scope.selection.customer.vehicles.find(function(vehicle){return vehicle.id.toString()===data.vehicle.id.toString()}),$scope.selection.vehicle||($scope.selection.customer.vehicles.unshift(data.vehicle),$scope.selection.vehicle=data.vehicle)):data.vehicle_id&&($scope.selection.vehicle=$scope.selection.customer.vehicles.find(function(vehicle){return vehicle.id.toString()===data.vehicle_id.toString()}),$scope.selection.vehicle||Vehicle.get({id:data.vehicle_id},function(vehicle_data){return $scope.selection.customer.vehicles.unshift(vehicle_data),$scope.selection.vehicle=vehicle_data})),data.note&&($scope.job.job.note=data.note,$scope.show_note=!0),data.description&&($scope.job.job.description=data.description),data.job_type_ids&&($scope.job.job.job_type_ids=data.job_type_ids),data.order_number&&($scope.job.job.order_number=data.order_number),data.odometer&&($scope.job.job.odometer=data.odometer),data.machine_hours&&($scope.job.job.machine_hours=data.machine_hours),data.replacement_provided&&($scope.job.job.replacement_provided=data.replacement_provided),data.quote_id&&($scope.job.job.quote_id=data.quote_id),data.tags&&angular.copy(data.tags,$scope.job.job.tags),data.insurer_id&&($scope.job.job.insurer_id=data.insurer_id,$scope.job.job.claim_number=data.claim_number,$scope.job.job.excess=data.excess,$scope.job.job.account_number=data.account_number),data.royalty_integration_account_id&&($scope.job.job.royalty_integration_account_id=data.royalty_integration_account_id,$scope.job.job.royalty_account_number=data.royalty_account_number,$scope.job.job.royalty_auto_club=data.royalty_auto_club),data.tracking_categories&&($scope.job.job.tracking_categories=data.tracking_categories),data.courtesy_vehicle_bookings&&data.courtesy_vehicle_bookings.length>0?($scope.job.job.courtesy_vehicle_booking={},angular.copy(data.courtesy_vehicle_bookings[0],$scope.job.job.courtesy_vehicle_booking)):void 0},$scope.calculate_estimate_work_hours=function(old,value){var current_value,difference,estimate_work_hours,new_hours,old_hours;return old||(old=[]),value||(value=$scope.job.job.job_type_ids),current_value=$scope.job.job.total_hours,$scope.job.job&&$scope.job.job.job_type_ids&&(old_hours=0,new_hours=0,lookupService.job_types().forEach(function(jt){return old.includes(jt.id.toString())&&jt.total_hours&&(old_hours+=jt.total_hours),value.includes(jt.id.toString())&&jt.total_hours?new_hours+=jt.total_hours:void 0}),difference=new_hours-old_hours),estimate_work_hours=$scope.job.job.total_hours||0,estimate_work_hours+difference>0?$scope.job.job.total_hours=estimate_work_hours+difference:void 0},$scope.on_book_courtesy_vehicle=function(){return popoverService.hide("#courtesy-vehicle-booking-form")},$scope.show_courtesy_vehicle_bookings=function(){return popoverService.show("#courtesy-vehicle-booking-form","#show-courtesy-booking-form-position",{placement:"top"})},$scope.hide_courtesy_vehicle_bookings=function(){return $scope.job.job.courtesy_vehicle_booking&&$scope.job.job.courtesy_vehicle_booking.vehicle_id||($scope.job.job.courtesy_vehicle_booking=void 0,$scope.job.job.replacement_provided=!1),popoverService.hide("#courtesy-vehicle-booking-form")},$scope.toggle_courtesy_vehicle_bookings=function(){var courtesy_vehicle_booking;return courtesy_vehicle_booking=$scope.job.job.courtesy_vehicle_booking,$scope.job.job.replacement_provided&&lookupService.courtesy_vehicles().length>0?$scope.show_courtesy_vehicle_bookings():courtesy_vehicle_booking&&courtesy_vehicle_booking.id?confirmationService.confirm_in_position("Delete the current courtesy vehicle booking for this job?",!0,{anchor:"#job-courtesy-vehicle-checkbox",placement:"right"},function(){return CourtesyVehicleBooking["delete"]({id:courtesy_vehicle_booking.id},function(){return $scope.job.job.courtesy_vehicle_booking=void 0,$scope.hide_courtesy_vehicle_bookings()})},function(){return $scope.job.job.replacement_provided=!0}):$scope.job.job.replacement_provided?void 0:($scope.job.job.courtesy_vehicle_booking=void 0,$scope.hide_courtesy_vehicle_bookings())},$scope.manual_job_number=function(){return lookupService.configurations()&&lookupService.configurations().manual_job_number},$scope.show_hubodometer=function(){return lookupService.servicing("truck","bus")},$scope.provide_mobile_service=function(){return lookupService.configuration("provide_mobile_service")},$scope.initialize(),$scope.$watch("job.vehicle.id",function(){return $scope.current_jobs=[],$scope.job&&$scope.job.vehicle.id?Vehicle.current_jobs({id:$scope.job.vehicle.id},function(data){return $scope.current_jobs=data}):void 0})}}.call(this),function(){this.ShowJobController=function($scope,$route,$routeParams,$location,spinnerService,lookupService,jobNavService,popoverService,formService,repcoNavigatorService,confirmationService,timeService,permissionService,Job,Employee,Work,WorkHour,Stock,Vehicle,Quote,DbFile,Invoice,Purchase,RepcoNavigator){return $scope.repco_supplier=function(purchase){return purchase.supplier&&purchase.supplier.name.toLowerCase().match(/repco/)?!0:void 0},$scope.quantum_supplier=function(purchase){return purchase.supplier&&purchase.supplier.name.toLowerCase().match(/ashdown ingram/)?!0:void 0},$scope.pro_link_supplier=function(purchase){return purchase.supplier&&purchase.supplier.name.toLowerCase().match(/covs/)?!0:void 0},$scope.motospecs_supplier=function(purchase){return purchase.supplier&&purchase.supplier.name.toLowerCase().match(/motospecs/)?!0:void 0},$scope.repco_account=function(){return lookupService.repco_account()},$scope.quantum_account=function(){return lookupService.quantum_account()},$scope.pro_link_account=function(){return lookupService.pro_link_account()},$scope.motospecs_account=function(){return lookupService.motospecs_account()},$scope.order_repco=function(purchase,account){var required_confirmation;return required_confirmation=purchase.purchase_items.find(function(i){return!i.sku}),confirmationService.confirm("Some items are missing Repco SKUs, You will need to re-enter them in Repco Navigator",required_confirmation,function(){return RepcoNavigator.purchase_order_access({id:purchase.id},function(data){return window.$repco_scope=$scope,repcoNavigatorService.submit_purchase_order(purchase,data.url,account)})})},$scope.repco_success=function(){return Job.get({id:$scope.job.id},function(data){return angular.copy(data,$scope.job)})},$scope.oscar_invoice_success=function(account){return $scope.oscar_account=account,popoverService.show("#oscar-response","#add-buyin-button",{placement:"left"}),$scope.waiting_repco_response=!0,spinnerService.start_spinner("#waiting-oscar-response"),Job.get({id:$scope.job.id},function(data){return angular.copy(data,$scope.job),$scope.waiting_oscar_response=!1,spinnerService.stop_spinner("#waiting-oscar-response")})},$scope.repco_invoice_success=function(){return popoverService.show("#repco-response","#add-buyin-button",{placement:"left"}),$scope.waiting_repco_response=!0,spinnerService.start_spinner("#waiting-repco-response"),Job.get({id:$scope.job.id},function(data){return angular.copy(data,$scope.job),$scope.waiting_repco_response=!1,spinnerService.stop_spinner("#waiting-repco-response")})},$scope.active_repco_account=function(){return repcoNavigatorService.active_repco_account()},$scope.active_oscar_account=function(){return $scope.oscar_account},$scope.create_purchase_order=function(active_account){return popoverService.hide("#repco-response"),popoverService.hide("#oscar-response"),$scope.show_right_side("purchases"),timeService.timeout(function(){return active_account&&active_account.supplier?$scope.add_purchase_order({open_invoice_items:!0,supplier_id:active_account.supplier.id,supplier:active_account.supplier,creditor_id:active_account.supplier.creditor_id}):$scope.add_purchase_order({open_invoice_items:!0})})},$scope.remove_checksheet_text=function(){return $scope.job.checksheet_text=void 0,Job.remove_checksheet_text({id:$scope.job.id})},$scope.cancel_create_purchase_order=function(){return popoverService.hide("#repco-response"),popoverService.hide("#oscar-response"),$scope.oscar_account=null},$scope.show_right_side=function(element){return $scope.right_side=element},$scope.show_left_side=function(element){return $scope.left_side=element},$scope.add_work=function(){return $scope.new_work={title:"work's title",job_id:$scope.job.id},formService.select_text("#new-work-title")},$scope.add_work_header=function(){return $scope.new_work={title:"work's title",job_id:$scope.job.id,header:!0},formService.select_text("#new-work-title")},$scope.save_new_work=function(){return $scope.submit_form($scope.new_work_form,function(){return Work.save($scope.new_work,function(data){return $scope.job.works.push(data),$scope.new_work=null,formService.focus("#add-checklist-item")})})},$scope.cancel_new_work=function(){return $scope.new_work=null},$scope.edit_work=function(work){var editing,element;return $scope.editing_work=work,formService.edit_fields($scope.editing_work,"editing"),editing=document.getElementById("editing-work"),element=document.getElementById("work-"+work.id),document.getElementById("work-check-list").insertBefore(editing,element)},$scope.save_work=function(form,work){return $scope.submit_form(form,function(){return Work.update(work.editing,function(data){return angular.copy(data,work),$scope.editing_work=void 0})})},$scope.remove_work=function(work){return work.header&&!work.editing.confirm_deletion?work.editing.confirm_deletion=!0:Job.delete_work({id:$scope.job.id,item:work,include_children:work.editing.delete_children||!1},function(data){return $scope.job.works=data,$scope.editing_work=void 0})},$scope.bulk_remove_works=function(){return confirmationService.confirm_in_position("Are you sure you want to remove all checksheet items? (if yes please wait for all items to be removed before navigating elsewhere)",!0,{anchor:"#works-more-actions",placement:"top"},function(){return Job.delete_all_works({id:$scope.job.id},function(data){return $scope.job.works=data})})},$scope.bulk_tick_works=function(){return confirmationService.confirm_in_position("Are you sure you want to mark all checksheet items as completed?",!0,{anchor:"#works-more-actions",placement:"top"},function(){},Job.check_all_works({id:$scope.job.id},function(data){return $scope.job.works=data}))},$scope.toggle_work=function(work){return work.status="unset"===work.status?"yes":"yes"===work.status?"no":"no"===work.status?"cautious":"unset",Work.update(work,function(data){return work.status=data.status})},$scope.finish=function(){return $scope.finishing=!0},$scope.unfinish=function(){return Job.unfinish({id:$scope.job.id},function(data){return angular.copy(data,$scope.job)})},$scope.pay=function(){return $scope.paying=!0},$scope.cancel_edit_work=function(work){return work.editing=null,$scope.editing_work=void 0},$scope.add_note=function(){return $scope.new_note={content:"note's content",office_only:!1},formService.select_text("#new-note-content")},$scope.save_new_note=function(){return $scope.submit_form($scope.new_note_form,function(){return Job.create_note({id:$scope.job.id,note:$scope.new_note},function(data){return $scope.job.notes.push(data),$scope.new_note=null})})},$scope.remove_note=function(note){return Job.destroy_note({id:$scope.job.id,note:note},function(){return $scope.job.notes.remove(note)})},$scope.edit_note=function(note){return formService.edit_fields(note,"editing")},$scope.cancel_edit_note=function(note){return formService.cancel(note,"editing")},$scope.cancel_add_note=function(){return $scope.new_note=void 0},$scope.save_note=function(form,note){return $scope.submit_form(form,function(){return Job.update_note({id:$scope.job.id,note:note.editing},function(data){return angular.copy(data,note)})})},$scope.delete_job=function(){return $scope.delete_booking=!0,$scope.deleted_reason=null,$scope.showing_delete_job_dialog=!0},$scope.do_delete_job=function(){var options;return options={id:$scope.job.id,deleted_reason:$scope.deleted_reason},$scope.delete_booking&&(options.delete_booking=!0),spinnerService.start_spinner("#delete-job-spinner"),Job["delete"](options,function(data){return spinnerService.stop_spinner("#delete-job-spinner"),angular.copy(data,$scope.job),$scope.showing_delete_job_dialog=!1})},$scope.cancel_delete_job=function(){return $scope.showing_delete_job_dialog=!1},$scope.total_work_hours=function(){var total;return $scope.job&&$scope.job.work_hours?(total=$scope.job.work_hours.sum(function(i){return i.hour}),total.round(2)):void 0},$scope.edit_job_details=function(){return formService.edit_fields($scope.job,"editing_job_details","id","time","pickup_time","total_hours","key_tag","description","number","finished_time","odometer","hubodometer","order_number","machine_hours","engine_hours","sleeper_air_engine_hours","replacement_provided")},$scope.save_job_details=function(){return $scope.submit_form($scope.job_details_form,function(){return spinnerService.start_spinner("#job-update-details-spinner"),Job.update($scope.job.editing_job_details,function(data){return spinnerService.stop_spinner("#job-update-details-spinner"),angular.copy(data,$scope.job)})})},$scope.edit_job_types=function(){return formService.edit_fields($scope.job,"editing_job_types","id","job_type_ids")},$scope.save_job_types=function(){return $scope.submit_form($scope.job_types_form,function(){var added,current_job_type_ids,removed,updated_job_type_ids;return current_job_type_ids=$scope.job.job_type_ids||[],updated_job_type_ids=$scope.job.editing_job_types.job_type_ids||[],current_job_type_ids=current_job_type_ids.map(function(x){return parseInt(x)}),updated_job_type_ids=updated_job_type_ids.map(function(x){return parseInt(x)}),added=[],updated_job_type_ids.forEach(function(x){return current_job_type_ids.includes(x)?void 0:added.push(x)}),removed=[],current_job_type_ids.forEach(function(x){return updated_job_type_ids.includes(x)?void 0:removed.push(x)}),spinnerService.start_spinner("#job-update-job-types-spinner"),Job.update_job_types({id:$scope.job.id,added_job_type_ids:added,removed_job_type_ids:removed},function(data){return spinnerService.stop_spinner("#job-update-job-types-spinner"),angular.copy(data,$scope.job)})})},$scope.show_customer=function(){return $scope.pop_customer=!0,timeService.timeout(function(){return popoverService.show("#customer",".vehicle-owner-details",{placement:"left"})})},$scope.show_vehicle=function(){return $scope.pop_vehicle=!0,timeService.timeout(function(){return popoverService.hide("#change-vehicle"),popoverService.show("#vehicle",".vehicle-details",{placement:"left"})})},$scope.close_vehicle=function(){return popoverService.hide("#vehicle"),popoverService.hide("#change-vehicle"),$scope.pop_vehicle=!1
},$scope.vehicle_changed=function(){return $scope.vehicle=Vehicle.get({id:$scope.job.vehicle.id},function(){return $scope.close_vehicle()})},$scope.change_vehicle=function(){return permissionService.check_update_finalized_documents_restriction_before_proceed(function(){return popoverService.hide("#vehicle"),popoverService.show("#change-vehicle",".vehicle-details",{placement:"left"}),$scope.changing_vehicle=!0})},$scope.goto_vehicle=function(vehicle){return $scope.goto("/customers/"+$scope.customer.id+"/vehicles/"+vehicle.id)},$scope.customer_updated=function(){return $scope.job.invoice&&$scope.job.invoice.customer&&$scope.job.invoice.customer.id===$scope.customer.id&&angular.copy($scope.customer,$scope.job.invoice.customer),$scope.close_customer()},$scope.close_customer=function(){return popoverService.hide("#customer"),$scope.pop_customer=!1},$scope.save_job=function(){return Job.save({id:$scope.job.id},$scope.job.editing,function(data){return angular.copy(data,$scope.job)})},$scope.upload_job_files=function(){return $scope.uploading_files=!0},$scope.cancel_upload_files=function(){return $("#upload-file1").val(void 0),$("#upload-file2").val(void 0),$("#upload-file3").val(void 0),$scope.uploading_files=!1},$scope.files_uploaded=function(data){return $scope.stop_spinner("#upload-photos-spinner"),$("#upload-file1").val(void 0),$("#upload-file2").val(void 0),$("#upload-file3").val(void 0),$scope.uploading_files=!1,"object"==typeof data?angular.copy(data,$scope.job):alert("Error while uploading file(s), please check that each file is maximum 1Mb and try again.")},$scope.start_uploading=function(){return $scope.start_spinner("#upload-photos-spinner")},$scope.view_photo=function(photo){return photo.active=!0,popoverService.show("#photo-viewer","#job-photos",{placement:"right"})},$scope.full_size_photo=function(){var active_photo;return active_photo=$scope.job.photos.find(function(p){return p.active}),window.open(active_photo.url)},$scope.close_photo_viewer=function(){return popoverService.hide("#photo-viewer"),$scope.job.photos.each(function(p){return p.active=!1})},$scope.remove_photo=function(photo){return DbFile["delete"](photo,function(){return $scope.job.photos.remove(photo),0===$scope.job.photos.length?$scope.close_photo_viewer():void 0})},$scope.add_work_hour=function(){return $scope.new_work_hour={job_id:$scope.job.id,rate:$scope.employees()[0].rate,started_at:new Date},$scope.new_work_hour.started_at.setHours(8),$scope.new_work_hour.started_at.setMinutes(0)},$scope.pending_work_hour=function(){var session;return session=lookupService.session(),session&&$scope.job&&$scope.job.work_hours?$scope.job.work_hours.find(function(wh){return wh.employee_id===session.employee_id&&!wh.ended_at}):void 0},$scope.save_new_work_hour=function(save_then_create){return null==save_then_create&&(save_then_create=!1),$scope.submit_form($scope.new_work_hour_form,function(){return WorkHour.save($scope.new_work_hour,function(data){var just_created;return angular.copy(data,$scope.new_work_hour),$scope.job.work_hours.unshift($scope.new_work_hour),save_then_create?(just_created=$scope.new_work_hour,$scope.add_work_hour(),$scope.new_work_hour.employee_id=just_created.employee_id,$scope.new_work_hour.started_at=just_created.ended_at,$scope.new_work_hour.ended_at=void 0):$scope.new_work_hour=null})})},$scope.cancel_new_work_hour=function(){return $scope.new_work_hour=null},$scope.cancel_edit_work_hour=function(work_hour){return work_hour.editing=null},$scope.edit_work_hour=function(work_hour){var editing,element;return $scope.editing_work_hour&&($scope.editing_work_hour.editing=void 0),$scope.editing_work_hour=work_hour,formService.edit_fields($scope.editing_work_hour,"editing"),$scope.editing_work_hour.editing.started_at&&($scope.editing_work_hour.editing.started_at=new Date($scope.editing_work_hour.editing.started_at)),$scope.editing_work_hour.editing.ended_at&&($scope.editing_work_hour.editing.ended_at=new Date($scope.editing_work_hour.editing.ended_at)),editing=document.getElementById("editing-work-hour"),element=document.getElementById("work-hour-"+work_hour.id),document.getElementById("work-hour-list").insertBefore(editing,element)},$scope.show_assign_to_mechanics=function(){return $scope.showing_assign_to_mechanics=!0},$scope.save_work_hour=function(form){return $scope.submit_form(form,function(){var updated_work_hour;return updated_work_hour=new WorkHour($scope.editing_work_hour.editing),updated_work_hour.$update(function(data){return angular.copy(data,$scope.editing_work_hour),$scope.editing_work_hour=null})})},$scope.remove_work_hour=function(work_hour){var deleted_work_hour;return deleted_work_hour=new WorkHour(work_hour),deleted_work_hour.$delete(),$scope.job.work_hours.remove(work_hour),$scope.editing_work_hour=void 0},$scope.send_email=function(){return $scope.show_send_email=!0},$scope.send_sms=function(){return $scope.show_send_sms=!0},$scope.edit_job_mechanics=function(){return $scope.job.employees[0]&&($scope.mechanic_1_id=$scope.job.employees[0].id),$scope.job.employees[1]&&($scope.mechanic_2_id=$scope.job.employees[1].id),$scope.job.employees[2]&&($scope.mechanic_3_id=$scope.job.employees[2].id),$scope.job.employees[3]&&($scope.mechanic_4_id=$scope.job.employees[3].id),$scope.job.editing_mechanics=!0},$scope.save_job_mechanics=function(){var employee_ids;return employee_ids=[$scope.mechanic_1_id,$scope.mechanic_2_id,$scope.mechanic_3_id,$scope.mechanic_4_id],Job.update_employees({id:$scope.job.id,employee_ids:employee_ids},function(data){return angular.copy(data,$scope.job)})},$scope.remove_mechanic=function(mechanic){return 1===mechanic&&($scope.mechanic_1_id=void 0),2===mechanic&&($scope.mechanic_2_id=void 0),3===mechanic&&($scope.mechanic_3_id=void 0),4===mechanic?$scope.mechanic_4_id=void 0:void 0},$scope.employee_names=function(){var names;return $scope.job&&$scope.job.employees?(names=$scope.job.employees.map(function(e){return e.name}),names.join(", ")):void 0},$scope.edit_file=function(document){return formService.edit_fields(document,"editing","id","file_name")},$scope.cancel_edit_file=function(document){return formService.cancel(document,"editing")},$scope.rename_file=function(document){return DbFile.rename(document.editing,function(data){return document.file_name=data.file_name,document.editing=void 0})},$scope.remove_file=function(document){return"Signature"===document.type?alert("You cannot delete a signed job card"):DbFile["delete"](document,function(){return $scope.job.documents.remove(document)})},$scope.select_work_hour_employee=function(work_hour){var employee;return employee=$scope.employees().find(function(e){return e.id===work_hour.employee_id}),employee?work_hour.rate=employee.rate:void 0},$scope.transfer_checksheet=function(){return confirmationService.confirm_in_position("Transfer checksheet to invoice's details section?",!0,{anchor:"#works-more-actions",placement:"top"},function(){return spinnerService.start_spinner("#work-spinner"),Job.transfer_checksheet({id:$scope.job.id},function(data){return spinnerService.stop_spinner("#work-spinner"),angular.copy(data,$scope.job.invoice)})})},$scope.transfer_work_hours=function(transfer_method){var options;return options={id:$scope.job.id,transfer_method:transfer_method},spinnerService.start_spinner("#transfer-work-hours-spinner"),Job.transfer_work_hours(options,function(data){return spinnerService.stop_spinner("#transfer-work-hours-spinner"),angular.copy(data,$scope.job)})},$scope.update_duration=function(work_hour){var cloned;return work_hour&&work_hour.started_at&&work_hour.ended_at?(cloned=work_hour.ended_at,work_hour.ended_at=work_hour.started_at.clone(),work_hour.ended_at.setHours(cloned.getHours()),work_hour.ended_at.setMinutes(cloned.getMinutes()),work_hour.hour=Math.round(10*work_hour.ended_at.minutesSince(work_hour.started_at)/6)/100):work_hour?work_hour.hour=0:void 0},$scope.update_ended_at=function(work_hour){return work_hour&&work_hour.started_at&&work_hour.hour?work_hour.ended_at=new moment(work_hour.started_at).add(work_hour.hour,"h").toDate():void 0},$scope.work_sortable_options={handle:".dragable-handle",helper:"clone",stop:function(){return $scope.reorder_works()}},$scope.reorder_works=function(){return Job.reorder_works({id:$scope.job.id,works:$scope.job.works},function(data){return angular.copy(data,$scope.job)})},$scope.add_purchase_order=function(options){return null==options&&(options={}),$scope.new_purchase_order=$.extend(options,{date:new Date,job_id:$scope.job.id,tracking_categories:$scope.job.tracking_categories,title:"Purchase Order"}),popoverService.show("#new-purchase-order-popover","#new-purchase-order-button",{placement:"left"})},$scope.cancel_add_purchase_order=function(){return $scope.new_purchase_order=void 0,popoverService.hide("#new-purchase-order-popover")},$scope.process_purchase_order=function(purchase){return $scope.processing_purchase=purchase},$scope.insert_new_purchase_order=function(){var newly_created_purchase_order;return $scope.job.purchases.unshift($scope.new_purchase_order),newly_created_purchase_order=$scope.new_purchase_order,$scope.new_purchase_order=void 0,timeService.timeout(function(){return popoverService.hide("#new-purchase-order-popover"),$scope.edit_purchase(newly_created_purchase_order)})},$scope.close_edit_and_send_purchase=function(){var purchase_order;return purchase_order=$scope.editing_purchase,$scope.close_edit_purchase(),$scope.repco_account()&&$scope.repco_supplier(purchase_order)?$scope.order_repco(purchase_order,$scope.repco_account()):$scope.quantum_account()&&$scope.quantum_supplier(purchase_order)?$scope.order_repco(purchase_order,$scope.quantum_account()):$scope.pro_link_account()&&$scope.pro_link_supplier(purchase_order)?$scope.order_repco(purchase_order,$scope.pro_link_account()):$scope.motospecs_account()&&$scope.motospecs_supplier(purchase_order)?$scope.order_repco(purchase_order,$scope.motospecs_account()):$scope.send_purchase_order(purchase_order)},$scope.edit_purchase=function(purchase){return $scope.editing_purchase=purchase,popoverService.show("#purchase-order-popover","#purchase-orders",{placement:"top"}),formService.focus("#new-purchase-item-button")},$scope.close_edit_purchase=function(){return $scope.editing_purchase.processed&&$scope.refresh_invoice(),$scope.editing_purchase=void 0,popoverService.hide("#purchase-order-popover")},$scope.send_purchase_order=function(purchase){return $scope.sending_purchase=purchase},$scope.send_quote=function(){return $scope.sending_quote=!0},$scope.remove_purchase_order=function(purchase){return $scope.deleting_purchase=purchase},$scope.do_delete_purchase=function(){return Purchase["delete"]({id:$scope.deleting_purchase.id},function(){return $scope.job.purchases.remove($scope.deleting_purchase),$scope.deleting_purchase=void 0})},$scope.cancel_delete_purchase=function(){return $scope.deleting_purchase=void 0},$scope.restricted_to_enter_bills=function(){return lookupService.restricted_to_enter_bills()},$scope.add_purchase_bill=function(purchase){return $scope.billed_purchase=purchase},$scope.refresh_invoice=function(){return $scope.job&&$scope.job.invoice&&$scope.job.invoice.id?(spinnerService.start_spinner("#invoice-spinner"),Invoice.get({id:$scope.job.invoice.id},function(data){return spinnerService.stop_spinner("#invoice-spinner"),angular.copy(data,$scope.job.invoice)})):$scope.refresh_job()},$scope.refresh_job=function(){return $scope.fetch_job($scope.job.id)},$scope.fetch_job=function(id){return spinnerService.start_spinner("#job-loading"),Job.get({id:id},function(data){spinnerService.stop_spinner("#job-loading"),$scope.job=data,$scope.customer=data.customer,$scope.vehicle=data.vehicle,$scope.vehicle&&$scope.fetch_vehicle(),timeService.timeout(function(){var _base;return $scope.job=data,(_base=$scope.job).invoice||(_base.invoice={job_id:$scope.job.id,net_amount:0,gst_amount:0,total_amount:0,paid_amount:0,unpaid_amount:0})})})},$scope.fetch_vehicle=function(){return Vehicle.get({id:$scope.job.vehicle.id},function(data){return data&&data.id?angular.extend($scope.vehicle,data):void 0})},$scope.create_quote=function(){return spinnerService.start_spinner("#create-quote-spinner"),Job.create_quote({id:$scope.job.id},function(data){return spinnerService.stop_spinner("#create-quote-spinner"),angular.copy(data,$scope.job)})},$scope.delete_quote=function(){return $scope.showing_delete_quote_dialog=!0},$scope.cancel_delete_quote=function(){return $scope.showing_delete_quote_dialog=!1},$scope.do_delete_quote=function(){return Quote["delete"]($scope.job.quote,function(data){return angular.copy(data,$scope.job.quote),$scope.job.quote=void 0,$scope.showing_delete_quote_dialog=!1})},$scope.transfer_quote_to_invoice=function(){return spinnerService.start_spinner("#quote-page-spinner"),Job.transfer_quote_to_invoice({id:$scope.job.id},function(data){return angular.copy(data,$scope.job),spinnerService.stop_spinner("#quote-page-spinner"),$scope.show_right_side("invoice")})},$scope.copy_from_invoice=function(){return $scope.start_spinner("#quote-page-spinner"),Job.copy_invoice_to_quote({id:$scope.job.id},function(data){return $scope.stop_spinner("#quote-page-spinner"),angular.copy(data,$scope.job)})},$scope.copy_invoice_items_to_job_card=function(){return spinnerService.start_spinner("#work-spinner"),Job.copy_invoice_items_to_job_card({id:$scope.job.id},function(data){return angular.copy(data,$scope.job),spinnerService.stop_spinner("#work-spinner")})},$scope.create_invoice=function(){return $scope.start_spinner("#create-invoice-spinner"),Job.create_invoice({id:$scope.job.id},function(data){return $scope.stop_spinner("#create-invoice-spinner"),angular.copy(data,$scope.job.invoice)})},$scope.close_note=function(note){return note.closed=!0},$scope.open_note=function(note){return note.closed=!1},$scope.put_on_hold=function(){return $scope.put_on_hold_anchor="#put-on-hold",$scope.putting_on_hold=!0},$scope["continue"]=function(){return Job["continue"]({id:$scope.job.id},function(data){return angular.copy(data,$scope.job)})},$scope.restricted_to_enter_payment=function(){var session;return session=lookupService.session(),session&&session.restrictions&&session.restrictions.any("create_payments")},$scope.restricted_to_process_purchase_orders=function(){return lookupService.restricted_to_process_purchase_orders()},$scope.show_cogs=function(){var session;return session=lookupService.session(),session&&(session.is_admin||session.is_staff)},$scope.work_hour_editable=function(wh){var session;return session=lookupService.session(),session?session.is_staff||session.is_admin?!0:session.employee_id===wh.employee_id:void 0},$scope.can_assign_employee=function(){var session;return session=lookupService.session(),session&&(session.is_staff||session.is_admin)?!0:void 0},$scope.clock_on=function(){var started_at;return started_at=new Date,started_at.setMinutes(timeService.round_to_five_minutes(started_at)),spinnerService.start_spinner("#clocking-spinner"),Job.clock_on({id:$scope.job.id,started_at:started_at},function(data){return spinnerService.stop_spinner("#clocking-spinner"),$scope.job.work_hours.unshift(data.work_hour),data.in_progress.length>0?$scope.open_in_progress_work_hours(data.in_progress):void 0})},$scope.clock_off_in_progress=function(work_hour){var ended_at;return ended_at=new Date,ended_at.setMinutes(timeService.round_to_five_minutes(ended_at)),spinnerService.start_spinner("#in-progress-clocking-spinner"),WorkHour.update({id:work_hour.id,ended_at:ended_at},function(){return $scope.in_progress_work_hours.remove(work_hour),spinnerService.stop_spinner("#in-progress-clocking-spinner"),0===$scope.in_progress_work_hours.length?$scope.close_in_progress_work_hours():void 0})},$scope.clock_off=function(){var ended_at,work_hour;return ended_at=new Date,ended_at.setMinutes(timeService.round_to_five_minutes(ended_at)),work_hour=$scope.pending_work_hour(),$scope.require_timesheet_description(work_hour)?($scope.edit_work_hour(work_hour),work_hour.editing.ended_at=ended_at,$scope.show_left_side("work_hours")):(spinnerService.start_spinner("#clocking-spinner"),WorkHour.update({id:work_hour.id,ended_at:ended_at},function(data){return spinnerService.stop_spinner("#clocking-spinner"),angular.copy(data,work_hour)}))},$scope.open_in_progress_work_hours=function(work_hours){return $scope.in_progress_work_hours=work_hours,popoverService.show("#in-progress-work-hours","#clock-on-button",{placement:"left"})},$scope.close_in_progress_work_hours=function(){return popoverService.hide("#in-progress-work-hours")},$scope.require_timesheet_description=function(work_hour){return lookupService.configurations().require_timesheet_description&&(!work_hour.description||0===work_hour.description.length)},$scope.selectable_items=function(){var selectables;return $scope.job&&$scope.job.invoice&&$scope.job.invoice.items?selectables=$scope.job.invoice.items.findAll(function(item){return!item.header}):[]},$scope.show_hubodometer=function(){return lookupService.servicing("truck","bus")},$scope.change_job_customer=function(){return popoverService.hide("#customer"),$scope.changing_job_customer=!0},$scope.change_customer=function(){return permissionService.check_update_finalized_documents_restriction_before_proceed(function(){return $scope.changing_invoice_customer=!0})},$scope.employees=function(){return lookupService.assignable_employees()},$scope.email_job_card=function(){return $scope.email=$scope.customer.email,$scope.job.email_preview&&($scope.subject=$scope.job.email_preview.subject,$scope.message=$scope.job.email_preview.message),popoverService.show("#job-send-email","#email-job-card",{placement:"left"})},$scope.cancel_email_job_card=function(){return popoverService.hide("#job-send-email")},$scope.send_job_card=function(){var attached_files;return $scope.email&&""!==$scope.email?(spinnerService.start_spinner("#job-send-email-spinner"),attached_files=$scope.job.documents.findAll(function(d){return d.attached}),attached_files=attached_files.concat($scope.job.photos.findAll(function(d){return d.attached})),attached_files=attached_files.map(function(f){return f.id}),Job.send_email({id:$scope.job.id,subject:$scope.subject,email:$scope.email,message:$scope.message,send_me_a_copy:$scope.send_me_a_copy,delivery_notification_required:$scope.delivery_notification_required,attached_files:attached_files},function(data){return spinnerService.stop_spinner("#job-send-email-spinner"),data.error?alert(data.error.message):(angular.copy(data,$scope.job),popoverService.hide("#job-send-email"))})):alert("Please enter an email address")},$scope.show_sub_jobs_list=function(){return popoverService.show("#sub-jobs-list","#show-sub-jobs-list",{placement:"bottom"})},$scope.close_sub_jobs_list=function(){return popoverService.hide("#sub-jobs-list")},$scope.allow_invoice_item_on_timesheet=function(){return lookupService.allow_invoice_item_on_timesheet()},$scope.courtesy_vehicles=function(){return lookupService.courtesy_vehicles()},$scope.no_access_to_timesheets=function(){var session;return session=lookupService.session(),permissionService.restricted_to_access_timesheets()},$scope.add_existing_sub_job=function(){return $scope.existing_sub_job={},popoverService.show("#add-existing-sub-job","#sub-job-actions",{placement:"right"})},$scope.hide_add_existing_sub_job=function(){return popoverService.hide("#add-existing-sub-job"),$scope.existing_sub_job=void 0},$scope.add_sub_job=function(){return spinnerService.start_spinner("#adding-existing-sub-job"),Job.add_sub_job({id:$scope.job.id,sub_job_id:$scope.existing_sub_job.id},function(data){return spinnerService.stop_spinner("#adding-existing-sub-job"),angular.copy(data.sub_jobs,$scope.job.sub_jobs),$scope.hide_add_existing_sub_job()})},$scope.digital_signature_enabled=function(){return lookupService.configurations().digital_signature_enabled},$scope.digital_signature_message=function(){return lookupService.configurations().digital_signature_message},$scope.add_existing_quote=function(){return $scope.added_quote={},popoverService.show("#add-existing-quote-popover","#add-existing-quote-button",{placement:"left"})},$scope.do_add_existing_quote=function(){return spinnerService.start_spinner("#adding-quote-spinner"),Job.add_quote({id:$scope.job.id,quote:$scope.added_quote},function(data){return spinnerService.stop_spinner("#adding-quote-spinner"),angular.copy(data,$scope.job),$scope.close_add_existing_quote()})},$scope.close_add_existing_quote=function(){return $scope.added_quote=void 0,popoverService.hide("#add-existing-quote-popover")},$scope.promote=function(){return confirmationService.confirm("Promote this Job and take it off the master job's sub job list?",!0,function(){return Job.promote({id:$scope.job.id},function(data){return angular.copy(data,$scope.job)})})},$scope.configurations=lookupService.configurations(),jobNavService.activate("Current Jobs"),$scope.show_right_side("invoice"),$scope.show_left_side("job"),$scope.fetch_job($routeParams.jobId),window.$scope=$scope}}.call(this),function(){this.SignJobController=function($scope,$window,$route,$routeParams,$location,spinnerService,Job){var wrapper;return $scope.clear_signature=function(){return $scope.signaturePad.clear()},$scope.sign=function(job_id){var signature;return $scope.signature_email=$("#signature-email").val(),$scope.signaturePad.isEmpty()?alert("Please sign"):$scope.signature_email&&0!==$scope.signature_email.length?(signature=$scope.signaturePad.toDataURL("image/svg+xml"),spinnerService.start_spinner("#signing-spinner"),Job.sign({id:job_id,signature:signature,signature_email:$scope.signature_email},function(data){return spinnerService.stop_spinner("#signing-spinner"),data.error?alert(data.error.message):(window.opener.$scope.refresh_job(),$scope.close_signature())})):alert("Please enter the customer's email address to send the signed job card to")},$scope.resize_canvas=function(){return $scope.canvas.width=$(".sign-area-body").width(),$scope.canvas.height=200,$scope.signaturePad.clear()},$scope.close_signature=function(){return window.opener.focus(),window.close()},wrapper=document.getElementById("sign-area"),$scope.canvas=wrapper.querySelector("canvas"),$scope.signaturePad=new SignaturePad($scope.canvas,{backgroundColor:"rgb(255, 255, 255)"}),$scope.resize_canvas()}}.call(this),function(){this.LoginController=function($scope,$cookies,$location,$window,$routeParams,$cacheFactory,navbarService,Session,Password){var _ref;return $scope.login=function(){return Session.save($scope.loginForm,function(data){return data.error?$scope.message=data.error.message:$("#workstation").val()?(navbarService.hideLogout(!1),$window.location.href="/workstations/"):(navbarService.hideLogout(!1),$window.location.href="app")})},$scope.forgot_password=function(){return Password.reset($scope.forgotPasswordForm,function(data){return data.error?$scope.error=data.error:($scope.message=data.message,$scope.show_login())})},$scope.show_forgot_password=function(){return $scope.display_login=!1,$scope.display_forgot_password=!0},$scope.show_login=function(){return $scope.display_login=!0,$scope.display_forgot_password=!1},$scope.url_param=function(sParam){var i,sPageURL,sParameterName,sURLVariables,_i,_ref;for(sPageURL=window.location.search.substring(1),sURLVariables=sPageURL.split("&"),i=_i=0,_ref=sURLVariables.length;_ref>=0?_ref>_i:_i>_ref;i=_ref>=0?++_i:--_i)if(sParameterName=sURLVariables[i].split("="),sParameterName[0]===sParam)return sParameterName[1]},$scope.message=$routeParams.message,$cacheFactory.get("$http").remove("/session"),navbarService.hideLogout(!0),Session.current(),$scope.loginForm={auto_workshop_id:$scope.url_param("auto_workshop_id")||$cookies.auto_workshop_id,employee_username:$scope.url_param("username")||$cookies.username,remembered:null!=(_ref="true"===$cookies.remembered)?_ref:{"true":!1}},$scope.forgotPasswordForm={auto_workshop_id:$cookies.auto_workshop_id,employee_username:$cookies.username},$scope.show_login()}}.call(this),function(){this.MarketingIntegrationController=function($scope,popoverService,lookupService,timeService,integrationsNavService,spinnerService,formService,AutoWorkshop,MarketingIntegrationAccount,MarketingSyncRequest){return $scope.start_integration=function(){return $scope.marketing_integration_account.editing={}},$scope.edit_marketing_integration_account=function(){return formService.edit_fields($scope.marketing_integration_account,"editing")},$scope.save_marketing_integration_account=function(){return $scope.marketing_integration_account.id?MarketingIntegrationAccount.update($scope.marketing_integration_account.editing,function(data){return angular.copy(data,$scope.marketing_integration_account)}):MarketingIntegrationAccount.save($scope.marketing_integration_account.editing,function(data){return angular.copy(data,$scope.marketing_integration_account)})},$scope.cancel_edit_marketing_integration=function(){return $scope.marketing_integration_account.editing=void 0},$scope.sync=function(){return spinnerService.start_spinner("#sync-request-spinner"),MarketingSyncRequest.save(function(data){return $scope.marketing_sync_request=data,data.access_request_url&&$scope.open_authorize_window(data),spinnerService.stop_spinner("#sync-request-spinner"),$scope.monitoring_sync_requests?void 0:$scope.start_monitoring_sync_requests()})},$scope.start_monitoring_sync_requests=function(){return $scope.monitoring_sync_requests=!0,AutoWorkshop.marketing_integration_account(function(data){return $scope.marketing_integration_account=data,$scope.current_sync_requests=data.current_sync_requests||[],0===$scope.current_sync_requests.length?$scope.monitoring_sync_requests=!1:$scope.existed?void 0:timeService.timeout($scope.start_monitoring_sync_requests,3e3)})},$scope.show_third_party_api_key_popover=function(){return popoverService.show("#third-party-api-key-popover","#marketing-save",{placement:"bottom"})},$scope.close_third_party_api_key_popover=function(){return popoverService.hide("#third-party-api-key-popover")},integrationsNavService.activate("Marketing Integration"),$scope.marketing_integration_account={},$scope.start_monitoring_sync_requests(),$scope.$on("$destroy",function(){return $scope.existed=!0})}}.call(this),function(){this.MessagesController=function($scope,spinnerService,customersNavService,Email,Sms){return Sms.balance(function(data){return $scope.sms_unpaid_amount=data.unpaid_amount,$scope.sms_billed_amount=data.billed_amount,$scope.sms_new_amount=data.new_amount}),$scope.search=function(query,number){return null==query&&(query=$scope.query),null==number&&(number=1),spinnerService.start_spinner("#emails-spinner"),spinnerService.start_spinner("#sms-spinner"),$scope.fetch_sms(number),$scope.fetch_emails(number)},$scope.fetch_sms=function(number){return null==number&&(number=1),Sms.get({query:$scope.query,page:number},function(data){return $scope.keyword=$scope.query,$scope.sms_page_number=data.meta.page,$scope.sms_total_pages=data.meta.total_pages,$scope.smses=data.sms,spinnerService.stop_spinner("#sms-spinner")})},$scope.fetch_emails=function(number){return Email.get({query:$scope.query,page:number},function(data){return $scope.keyword=$scope.query,$scope.email_page_number=data.meta.page,$scope.email_total_pages=data.meta.total_pages,$scope.emails=data.emails,spinnerService.stop_spinner("#emails-spinner")})},customersNavService.activate("Emails & SMS"),$scope.query="",$scope.search()}}.call(this),function(){this.AutoWorkshopApp.service("navbarService",function(Notification,AutoWorkshop){var _this=this;return{activate:function(activate,title){return _this.active=activate,title||(title=activate),document.title=title},active:function(){return _this.active},hideLogout:function(value){return null==value&&(value=null),null!==value&&(_this.shouldHideLayout=value),_this.shouldHideLayout},hideWarning:function(value){return null==value&&(value=null),null!==value&&(_this.shouldHideWarning=value),_this.shouldHideWarning},update_unread_notification_count:function(){return Notification.unread_count(function(data){return _this.unread_notification_count=data.count})},update_booking_request_count:function(){return AutoWorkshop.booking_request_count(function(data){return _this.booking_request_count=data.count})},update_subscription_notification:function(){return AutoWorkshop.subscription_notification(function(data){return _this.subscription_notification=data})},subscription_notification:function(){return _this.subscription_notification?_this.subscription_notification.message:void 0},subscription_notification_code:function(){return _this.subscription_notification?_this.subscription_notification.code:void 0},unread_notification_count:function(){return _this.unread_notification_count},booking_request_count:function(){return _this.booking_request_count}}}),this.NavbarController=function($scope,navbarService,Session,Notification,AutoWorkshop,$window,$cacheFactory,$location,savedTextsService,vehicleVisualService,lookupService,spinnerService,popoverService,timeService,$timeout){var timed_update;return $scope.links=function(){return 0===$scope.nav_links.length&&lookupService.session().auto_workshop_id&&0!==lookupService.asset_name().length&&$scope.build_nav_links(),$scope.nav_links},$scope.new_links=function(){return $scope.nav_new_links},$scope.build_nav_links=function(){var session;return session=lookupService.session(),$scope.nav_links=[],session.is_restricted_mechanic||session.is_mechanic?(session.restrictions.any("access_diary")||$scope.nav_links.push([{name:"Diary",href:"#/diary",icon:"icon-calendar"}]),$scope.nav_links.push([{name:"Jobs",href:"#",icon:"icon-wrench"}]),session.restrictions.any("access_inventory")||$scope.nav_links.push([{name:"Inventory & Suppliers",href:"#/stocks",icon:"icon-retweet"}]),$scope.nav_links.push([{name:"Settings",href:"#/personal/",icon:"icon-cogs"},{name:"Help",href:"#/helps",icon:"icon-question"}]),$scope.nav_links=$scope.nav_links.flatten()):session.is_support_portal?($scope.nav_links=[{name:"Dashboard",href:"#",icon:"icon-th"},{name:"Object Reassociation",href:"#object_reassociation/",icon:"icon-random"}],$scope.nav_links=$scope.nav_links.flatten()):(session.restrictions.any("access_diary")||$scope.nav_links.push([{name:"Diary",href:"#/diary",icon:"icon-calendar"}]),$scope.nav_links.push([{name:"Jobs",href:"/auto_workshop/app",icon:"icon-wrench"}]),session.restrictions.any("access_customers_and_vehicles")||$scope.nav_links.push([{name:"Customers & "+lookupService.asset_name_plural(),href:"#/customers",icon:"icon-group"}]),(session.is_admin||session.is_staff)&&$scope.nav_links.push([{name:"Invoices & Bills",href:"#/invoices",icon:"icon-dollar"}]),session.restrictions.any("access_inventory")||$scope.nav_links.push([{name:"Inventory & Suppliers",href:"#/inventory",icon:"icon-retweet"}]),session.restrictions.any("access_service_schedules")||$scope.nav_links.push([{name:"Service Schedules",href:"#/service_schedules/overdue_services",icon:"icon-calendar-empty"}]),!session.is_admin&&!session.is_staff||session.restrictions.any("access_reports")||$scope.nav_links.push([{name:"Reports",href:"#/reports",icon:"icon-bar-chart"}]),(session.is_admin||session.is_staff)&&($scope.nav_links.push([{name:"Notifications",href:"#/notifications",icon:"icon-info-sign"}]),session.restrictions.any("access_timesheets")||$scope.nav_links.push([{name:"Timesheets",href:"#/timesheets",icon:"icon-time"}])),session.restrictions&&!session.restrictions.any("access_pos")&&$scope.nav_links.push([{name:"POS",href:"#/pos",icon:"icon-money"}]),$scope.nav_links.push([{name:"Settings",href:"#/personal/",icon:"icon-cogs"},{name:"Help",href:"#/helps",icon:"icon-question"}]),$scope.nav_links=$scope.nav_links.flatten(),$scope.nav_new_links=[{name:"New Booking",href:"#/bookings/new",icon:"icon-calendar"},{name:"New Job",href:"#/jobs/new",icon:"icon-wrench"},{name:"New Invoice",href:"#/invoices/new",icon:"icon-dollar"},{name:"New Quote/Estimate",href:"#/quotes/new",icon:"icon-file"},{divider:!0},{name:"New Customer",href:"#/customers/new",icon:"icon-user"}],!session.is_admin&&!session.is_staff||session.restrictions.any("create_payments")||$scope.nav_new_links.push([{name:"New Customer Payment",href:"#/payments/new",icon:"icon-dollar"},{name:"New Customer Credit Note",href:"#/credit_notes/new",icon:"icon-dollar"}]),session.restrictions.any("access_inventory")||$scope.nav_new_links.push([{divider:!0},{name:"New Stock",href:"#/stocks/new",icon:"icon-file"},{name:"New Supplier",href:"#/suppliers/new",icon:"icon-truck"},{name:"New Purchase Order",href:"#/purchases/new",icon:"icon-tags"}]),(session.is_admin||session.is_staff)&&$scope.nav_new_links.push([{name:"New Bill",href:"#/bills/new",icon:"icon-file"},{name:"New Bill Payment",href:"#/bill_payments/new",icon:"icon-dollar"},{name:"New Supplier Credit Note",href:"#/supplier_credit_notes/new",icon:"icon-dollar"}])),$scope.nav_new_links=$scope.nav_new_links.flatten()
},$scope.hideLogout=function(){return navbarService.hideLogout()},$scope.hideWarning=function(){return navbarService.hideWarning()},$scope.logout=function(){return Session["delete"](function(){return $cacheFactory.get("$http").removeAll(),$window.location.href="login"})},$scope.active=function(){return navbarService.active()},$scope.isActive=function(name){return name===$scope.active()?"active":""},$scope.reset_global_search=function(){return $scope.global_query=void 0},$scope.global_search=function(){return timeService.cancel_timeout($scope.searching),$scope.search_count||($scope.search_count=0),$scope.search_count=$scope.search_count+1,$scope.searching=$timeout($scope.looking_up,500)},$scope.toggle_saved_texts=function(){return savedTextsService.toggle()},$scope.vehicle_visual_enabled=function(){var account;return account=lookupService.vehicle_visual_account(),account&&account.enabled},$scope.toggle_vehicle_visual=function(){return vehicleVisualService.toggle()},$scope.$on("$destroy",function(){return $timeout.cancel($scope.searching)}),$scope.looking_up=function(){var count;return spinnerService.start_spinner("#global-search-spinner"),count=$scope.search_count,AutoWorkshop.resource_search({query:$scope.global_query},function(data){return spinnerService.stop_spinner("#global-search-spinner"),count===$scope.search_count?$scope.global_search_result=data:void 0}),null},$scope.goto=function(path,options){return null==options&&(options={}),$location.path(path).search(options)},$scope.new_job=function(param,value){var options;return options={},options[param]=value,$scope.goto("/jobs/new",options)},$scope.new_invoice=function(param,value){var options;return options={},options[param]=value,$scope.goto("/invoices/new",options)},$scope.new_quote=function(param,value){var options;return options={},options[param]=value,$scope.goto("/quotes/new",options)},$scope.show_quick_search=function(){return lookupService.session()&&(lookupService.session().is_admin||lookupService.session().is_staff)},$scope.open_quick_search_instruction=function(){return popoverService.show("#quick-search-instruction","#global-search-icon",{placement:"bottom"})},$scope.hide_quick_search_instruction=function(){return popoverService.hide("#quick-search-instruction")},$scope.switch_auto_workshop=function(){return popoverService.show("#workshop-list","#switch-workshop",{placement:"bottom"})},$scope.cancel_switch_auto_workshop=function(){return popoverService.hide("#workshop-list")},$scope.nav_links=[],$scope.nav_new_links=[],$("#global-search-input").focusout(function(){return $scope.reset_global_search()}),timed_update=function(){return navbarService.update_unread_notification_count(),navbarService.update_booking_request_count(),navbarService.update_subscription_notification(),$scope.scheduled_update=$timeout(timed_update,18e5),null},timed_update(),$scope.$on("$destroy",function(){return $timeout.cancel($scope.scheduled_update)})}}.call(this),function(){this.NotificationsController=function($scope,$window,navbarService,spinnerService,formService,Notification){return navbarService.activate("Notifications"),$scope.refetch=function(){return spinnerService.start_spinner("#notification-spinner"),Notification.all(function(data){return spinnerService.stop_spinner("#notification-spinner"),$scope.notifications=data})},$scope.toggle_select_all=function(){return $scope.select_all?($scope.ids=[],$scope.select_all=!1):($scope.ids=[],$scope.notifications.forEach(function(notification){return $scope.ids.push(notification.id.toString())}),$scope.select_all=!0)},$scope.bulk_read=function(){return $scope.ids&&0!==!$scope.ids.length?(spinnerService.start_spinner("#notification-spinner"),Notification.bulk_read({ids:$scope.ids},function(){return $scope.ids=[],$scope.refetch(),spinnerService.stop_spinner("#notification-spinner")})):alert("Please select a notification")},$scope.bulk_delete=function(){return $scope.ids&&0!==!$scope.ids.length?(spinnerService.start_spinner("#notification-spinner"),Notification.bulk_delete({ids:$scope.ids},function(){return $scope.ids=[],$scope.refetch(),spinnerService.stop_spinner("#notification-spinner")})):alert("Please select a notification")},$scope.bulk_print=function(){return $scope.ids&&0!==!$scope.ids.length?$window.open("/notifications/bulk_print.pdf?"+$.param(formService.params({ids:$scope.ids}))):alert("Please select a notification")},$scope.refetch(),$scope.ids=[]}}.call(this),function(){this.ShowNotificationController=function($scope,$routeParams,navbarService,Notification,timeService,popoverService){return navbarService.activate("Notifications"),$scope.notification_template="index.html",$scope.mark_as_read=function(){return Notification.read({id:$scope.notification.id},function(data){return angular.copy(data,$scope.notification),navbarService.update_unread_notification_count()})},$scope.notification=Notification.get({id:$routeParams.id},function(data){return $scope.notification_template=$scope.notification.type.underscore().replace("_notification","")+".html",data.read?void 0:timeService.timeout($scope.mark_as_read,3e3)}),$scope.show_image=function(path,element,placement){return null==placement&&(placement="right"),$scope.showing_image_path=path,popoverService.show("#image-lightbox",element,placement)}}}.call(this),function(){this.WelcomeNotificationController=function($scope,formService,Session,AutoWorkshop,Invoice){return $scope.session=Session.current(),$scope.invoice_templates=Invoice.templates(),$scope.auto_workshop=AutoWorkshop.get(function(){return formService.edit_fields($scope.auto_workshop,"editing")}),$scope.setup_auto_workshop=function(){return AutoWorkshop.setup($scope.auto_workshop.editing,function(data){return data.errors?$scope.auto_workshop.editing.errors=data.errors:(angular.copy(data,$scope.auto_workshop),formService.edit_fields($scope.auto_workshop,"editing"))})},$scope.completed=function(){var workshop;return workshop=$scope.auto_workshop,workshop.name&&workshop.phone&&workshop.address.street_line},$scope.select_invoice_template=function(){return $scope.selecting_invoice_template=!0}}}.call(this),function(){this.NewPaymentController=function($scope,$http,$location,$routeParams,lookupService,spinnerService,accountingNavService,Stock,Supplier,Payment,Customer){var cash_payment_method;return accountingNavService.activate("Customer Payments"),$scope.payment_methods=lookupService.payment_methods(),cash_payment_method=lookupService.payment_method("cash"),$scope.payment={date:new Date,customer:{name:""},payment_method_id:cash_payment_method?cash_payment_method.id:void 0},$scope.select_customer=function(){return $scope.payment.customer_id=$scope.selected_customer.id,Customer.transactions({id:$scope.payment.customer_id},function(data){return $scope.credit_balance=data.meta.credit_balance,$scope.credit_available=$scope.credit_balance?!0:!1})},$scope.save_payment=function(){return $scope.payment.customer_id?(spinnerService.start_spinner("#saving-payment"),Payment.save($scope.payment,function(data){return spinnerService.stop_spinner("#saving-payment"),$location.path("/payments/"+data.id)})):alert("Please select a customer")},$scope.show_select_bank_account=function(){return cash_payment_method=lookupService.payment_method("cash"),$scope.payment&&lookupService.bank_accounts()&&lookupService.bank_accounts().length>1&&cash_payment_method?$scope.payment.payment_method_id!==cash_payment_method.id:void 0}}}.call(this),function(){this.PaymentsController=function($scope,$location,$routeParams,spinnerService,accountingNavService,lookupService,formService,Payment){var search_query;return $scope.search=function(page){var search_query;return null==page&&(page=1),search_query={query:$scope.query,page:page},lookupService.save_search_query("payments",search_query),spinnerService.start_spinner("#payments-spinner"),Payment.search(search_query,function(data){return spinnerService.stop_spinner("#payments-spinner"),$scope.keyword=$scope.query.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.payments=data.payments})},accountingNavService.activate("Customer Payments"),search_query=lookupService.search_query("payments"),search_query&&search_query.query&&$routeParams.cached?($scope.query=search_query.query,$scope.search(search_query.page||1)):(lookupService.save_search_query("payments",{query:{query:""}}),$location.path("/payments").search({cached:Math.random()}).replace())}}.call(this),function(){this.ShowPaymentController=function($scope,accountingNavService,formService,lookupService,spinnerService,$routeParams,popoverService,confirmationService,Stock,Payment){return accountingNavService.activate("Customer Payments"),$scope.payment_methods=lookupService.payment_methods(),spinnerService.start_spinner("#payment-loading"),Payment.get({id:$routeParams.id},function(data){return $scope.payment=data,spinnerService.stop_spinner("#payment-loading")}),$scope.selected_invoices=[],$scope.select_customer=function(selected_customer){return $scope.payment.customer_id=selected_customer.id},$scope.open_delete_dialog=function(){var confirmation_message,need_confirmation;return need_confirmation=$scope.payment.disable_manual_deletion_reason,need_confirmation&&(confirmation_message=""+$scope.payment.disable_manual_deletion_reason+"\n\n Delete Anyway?"),confirmationService.danger_confirm(confirmation_message,need_confirmation,function(){return $scope.showing_delete_payment_dialog=!0})},$scope.do_delete_payment=function(){return spinnerService.start_spinner("#delete-payment-spinner"),$scope.payment=Payment["delete"]({id:$scope.payment.id,deleted_reason:$scope.deleted_reason},function(){return spinnerService.start_spinner("#delete-payment-spinner"),$scope.showing_delete_payment_dialog=!1})},$scope.cancel_delete_payment=function(){return $scope.showing_delete_payment_dialog=!1},$scope.add_invoices=function(){return $scope.selected_purchase_orders=[],$scope.showing_related_invoices=!0},$scope.finalize=function(){return Payment.finalize({id:$scope.payment.id},function(data){return angular.copy(data,$scope.payment)})},$scope.save_selected_invoices=function(){var allocations;return allocations=[],$scope.selected_invoices.each(function(invoice){return allocations.push({id:invoice.id,amount:invoice.allocated_amount})}),Payment.allocate_payments({id:$scope.payment.id,allocations:allocations},function(data){return angular.copy(data,$scope.payment),$scope.selected_invoices=[],$scope.showing_related_invoices=!1})},$scope.edit_payment=function(){return formService.edit_fields($scope.payment,"editing","id","customer_id","date","amount","reference","customer","payment_method_id","accounting_account_id")},$scope.save_payment=function(){var updated;return updated=new Payment($scope.payment.editing),updated.$update(function(data){return angular.copy(data,$scope.payment)})},$scope.cancel_edit_payment=function(){return $scope.payment.editing=void 0},$scope.remove_bpayment=function(bpayment){var confirmation_message;return confirmation_message=bpayment.disable_manual_deletion_reason?""+bpayment.disable_manual_deletion_reason+"\n\n Delete Anyway?":"Are you sure you want to delete this payment allocation?",confirmationService.danger_confirm(confirmation_message,!0,function(){return Payment.remove_allocation({id:$scope.payment.id,allocation_id:bpayment.id},function(data){return angular.copy(data,$scope.payment)})})},$scope.open_email_payment=function(){return $scope.email_payment_to=$scope.payment.customer.email,$scope.email_payment_subject=$scope.payment.email_preview.subject,$scope.email_payment_message=$scope.payment.email_preview.message,popoverService.show("#payment-send-email","#send-payment",{placement:"left"})},$scope.cancel_email_payment=function(){return popoverService.hide("#payment-send-email")},$scope.email_payment=function(){return $scope.email_payment_to?(spinnerService.start_spinner("#payment-send-email-spinner"),Payment.send_email({id:$scope.payment.id,email:$scope.email_payment_to,subject:$scope.email_payment_subject,message:$scope.email_payment_message},function(data){return spinnerService.stop_spinner("#payment-send-email-spinner"),data.error?alert(data.error.message):popoverService.hide("#payment-send-email")})):alert("Please provide a email address to send to")},$scope.show_select_bank_account=function(){return $scope.payment&&$scope.payment.editing&&"cash"!==$scope.payment.editing.payment_type&&!$scope.payment.original_payment_id?lookupService.bank_accounts().length>1&&$scope.choose_specific_bank_account||$scope.payment.accounting_account_id:void 0}}}.call(this),function(){this.PersonalDetailsController=function($scope,Employee,$routeParams,administrationNavService){return administrationNavService.activate("Personal Details"),$scope.employee=Employee.current(function(){return"edit"===$routeParams.action?$scope.edit():void 0}),$scope.edit=function(){var copy;return copy={},angular.copy($scope.employee,copy),$scope.employee.editing=copy},$scope.cancel_editing=function(){return $scope.employee.editing=void 0},$scope.save=function(){return $scope.submit_form($scope.employee_form,function(){var updated_employee;return updated_employee=new Employee($scope.employee.editing),updated_employee.$update(function(data){return angular.copy(data,$scope.employee)})})},$scope.save_password=function(){return Employee.change_password({id:$scope.employee.id},$scope.change_password,function(data){return data.errors?$scope.change_password.errors=data.errors:($scope.change_password=void 0,$scope.hide_popover("#change_password"))})}}}.call(this),function(){this.PosController=function($scope,$filter,$location,$window,$http,$route,timeService,limitToFilter,navbarService,formService,lookupService,spinnerService,popoverService,confirmationService,posService,tyroService,paymentExpressService,roundingService,Stock,Pos,Customer){return $scope.init=function(){return navbarService.activate("POS"),$scope.new_invoice(),$scope.today=new Date,$scope.offline=!1,$scope.workshop_name=function(){return lookupService.name()},$scope.workshop_phone=function(){return lookupService.phone()},$scope.workshop_email=function(){return lookupService.email()},$scope.workshop_website=function(){return lookupService.website()},$scope.parks=posService.parks(),$scope.sales=posService.sales(),$scope.payment_methods=lookupService.pos_payment_methods(),Pos.use_normal_invoice_for_pos(function(data){return $scope.use_normal_invoice_for_pos=data.use_normal_invoice_for_pos}),angular.element($window).on("keydown",function(e){return 115===e.keyCode&&$scope.pay(),116===e.keyCode?$scope.park():void 0})},$scope.check_credit_limit=function(){return $scope.customer&&$scope.customer.id?Customer.recommendation({id:$scope.customer.id},function(data){var balance_text,credit_limit_text;return $scope.customer.credit_limit=data.credit_limit,$scope.customer.balance=data.balance,balance_text=$filter("currency")(data.balance),credit_limit_text=$filter("currency")(data.credit_limit),data.credit_limit>0&&data.balance>=data.credit_limit?alert("This customer balance of "+balance_text+" has reached or exceeded the credit limit of "+credit_limit_text):data.credit_limit>0&&data.balance+200>=data.balance?alert("This customer balance of "+balance_text+" is approaching the credit limit of "+credit_limit_text):void 0}):void 0},$scope.new_invoice=function(){return popoverService.hide("#pos-finish"),$scope.invoice={items:[],payments:[]},$scope.payment=0,$scope.customer=void 0,formService.select_text("#new-invoice-item-description"),$scope.new_invoice_item={quantity:1},$scope.change_amount=0,$scope.add_invoice_details=!1,$scope.paying=!1},$scope.return_item=function(item){return item.returning=!0},$scope.cancel_return=function(item){return item.returning=!1},$scope.employees=function(){return lookupService.employees()},$scope.allow_salesperson_selection_on_pos=function(){return lookupService.allow_salesperson_selection_on_pos()},$scope.tax_rate=function(item){return item.gst_free?0:item.tax_rate?item.tax_rate:lookupService.configurations?lookupService.configurations().tax_rate:0},$scope.rounding=function(){return lookupService.rounding()},$scope.rounding_amount=function(){return roundingService.apply($scope.total_amount($scope.invoice),$scope.rounding())},$scope.tax_registration_number=function(){return lookupService.configurations?""+lookupService.configurations().tax_registration_name+" "+lookupService.configurations().tax_registration_number:void 0},$scope.select_item=function(selected_item){return selected_item.id!==$scope.new_invoice_item.stock_id&&($scope.new_invoice_item.unit_price=void 0),$scope.new_invoice_item.included_gst=!0,$scope.new_invoice_item.gst_free=selected_item.gst_free,$scope.new_invoice_item.description=$scope.item_description(selected_item),$scope.new_invoice_item.stock_id=selected_item.id,$scope.new_invoice_item.prices=selected_item.included_gst_prices,$scope.customer&&$scope.customer.price_level&&($scope.new_invoice_item.unit_price=selected_item["sell_price"+$scope.customer.price_level+"_included_gst"]),$scope.new_invoice_item.unit_price&&0!==$scope.new_invoice_item.unit_price?void 0:$scope.new_invoice_item.unit_price=selected_item.sell_price_included_gst},$scope.item_description=function(data){return data.stock_number&&""!==data.stock_number?lookupService.configurations().print_without_stock_number?data.name:""+data.stock_number+" - "+data.name:data.name},$scope.lookup_items=function(term){return spinnerService.start_spinner("#pos-lookup-item-spinner","small"),$("#pos-lookup-item-icon").hide(),$http.jsonp("/pos/stocks?limit=100&callback=JSON_CALLBACK&query="+term).then(function(response){return spinnerService.stop_spinner("#pos-lookup-item-spinner"),$("#pos-lookup-item-icon").show(),limitToFilter(response.data,100)})},$scope.add_invoice_item=function(){var new_item;return new_item={},angular.copy($scope.new_invoice_item,new_item),formService.select_text("#new-invoice-item-description"),$scope.new_invoice_item.quantity=1,new_item.quantity||(new_item.quantity=1),new_item.included_gst=!0,$scope.invoice.items.push(new_item),$scope.offline?void 0:(new_item.looking_up=!0,Stock.find_by_barcode({barcode:new_item.description},function(data){return new_item.looking_up=!1,null!==data&&data.name?(new_item.description=$scope.item_description(data),new_item.stock_id=data.id,new_item.unit_price||(new_item.unit_price=data.sell_price_included_gst),new_item.gst_free||(new_item.gst_free=data.gst_free)):void 0}))},$scope.remove_item=function(item){return $scope.invoice.items.remove(item),formService.select_text("#new-invoice-item-description")},$scope.item_total_amount=function(item){return($scope.item_net_amount(item)+$scope.item_gst_amount(item)).round(4)},$scope.item_net_amount=function(line){var value;return line.unit_price&&line.quantity?(line.unit_price*line.quantity/(1+$scope.tax_rate(line))).round(4):value=0},$scope.item_gst_amount=function(line){return($scope.item_net_amount(line)*$scope.tax_rate(line)).round(4)},$scope.total_net_amount=function(invoice){return invoice.items.sum(function(x){return $scope.item_net_amount(x)}).round(2)},$scope.total_gst_amount=function(invoice){return invoice.items.sum(function(x){return $scope.item_gst_amount(x)}).round(2)},$scope.total_amount=function(invoice){return($scope.total_net_amount(invoice)+$scope.total_gst_amount(invoice)).round(2)},$scope.total=function(invoice){return invoice?($scope.total_amount(invoice)+$scope.rounding_amount(invoice)).round(2):0},$scope.gst=function(invoice){var gst;return invoice?(gst=0,angular.forEach(invoice.items,function(item){return gst+=$scope.item_gst_amount(item)}),gst.round(2)):void 0},$scope.sub_total=function(invoice){return invoice?($scope.total(invoice)-$scope.gst(invoice)).round(2):void 0},$scope.print=function(close){return null==close&&(close=!0),$scope.use_normal_invoice_for_pos&&$scope.invoice&&$scope.invoice.id?$window.open("/invoices/"+$scope.invoice.id+"/print.pdf"):window.print(),$scope.change_amount&&$scope.change_amount>0?(popoverService.show("#pos-finish","#pos-pay-button",{placement:"right"}),timeService.timeout(function(){return formService.focus("#pos-confirm-change",300)})):close?$scope.new_invoice():void 0},$scope.pay=function(){return popoverService.show("#pos-pay","#pos-pay-button",{placement:"right"}),$scope.payment=$scope.unpaid_amount($scope.invoice),$scope.waive_surcharge=!1,formService.select_text("#pos-payment-amount")},$scope.credit_card_surcharge=function(){return lookupService.configurations().surcharge},$scope.credit_card_surcharge_amount=function(){var surcharge;return surcharge=$scope.credit_card_surcharge(),surcharge&&surcharge>0&&$scope.payment&&$scope.payment>0&&!$scope.waive_surcharge?parseFloat(($scope.payment*surcharge/100).toFixed(2)):0},$scope.payment_with_credit_card_surcharge=function(){return $scope.payment?$scope.payment+$scope.credit_card_surcharge_amount():0},$scope.cancel_payment=function(){return $scope.paying=!1,popoverService.hide("#pos-pay","#pos-pay-button",{placement:"right"})},$scope.park=function(){return $scope.cancel_payment(),$scope.parks.push($scope.invoice),$scope.new_invoice()},$scope.unpaid_amount=function(invoice){return $scope.total(invoice)-$scope.total_payment_amount(invoice)},$scope.total_payment_amount=function(invoice){var total;return total=0,angular.forEach(invoice.payments,function(p){return total+=p.amount}),total},$scope.clear=function(){return confirmationService.confirm("Do you want to clear all items on this sale?",!0,function(){return $scope.new_invoice()})},$scope.display_invoice=function(invoice){return $scope.showing_invoice=invoice,$scope.refund_payment_method=lookupService.payment_method("cash"),popoverService.show_in_position("#pos-show-invoice",200,100)},$scope.cancel_display_invoice=function(){return angular.forEach($scope.showing_invoice.items,function(item){return item.returning=!1}),popoverService.hide("#pos-show-invoice")},$scope.return_and_refund=function(){var eftpos_machine,finish_refund,is_eftpos_refund,items,method,_i,_len,_ref;if(items=$scope.showing_invoice.items.filter(function(item){return item.returning}),0===items.length)return alert("Please selct item(s) to return and refund");for(_ref=$scope.payment_methods,_i=0,_len=_ref.length;_len>_i;_i++)method=_ref[_i],method.id===$scope.refund_payment_method.id&&($scope.refund_payment_method=method);return finish_refund=function(){return Pos.return_and_refund({refund_payment_method:$scope.refund_payment_method,invoice:$scope.showing_invoice},function(){return angular.forEach($scope.showing_invoice.items,function(item){return item.returning?(item.returned=!0,item.returning=!1):void 0}),popoverService.hide("#pos-show-invoice")})},eftpos_machine=$scope.eftpos_machine(),is_eftpos_refund="eftpos"===$scope.refund_payment_method.value||"credit"===$scope.refund_payment_method.value,eftpos_machine&&is_eftpos_refund&&$scope.total_refund_amount()>0?eftpos_machine.start_refund_transaction($scope.total_refund_amount(),finish_refund):finish_refund()},$scope.total_refund_amount=function(){var total_gst,total_net;return total_gst=0,total_net=0,$scope.showing_invoice&&angular.forEach($scope.showing_invoice.items,function(item){return item.returning?(total_gst+=$scope.item_gst_amount(item),total_net+=$scope.item_net_amount(item)):void 0}),(total_gst.round(2)+total_net.round(2)).round(2)},$scope.change=function(invoice){return $scope.payment-$scope.unpaid_amount(invoice)},$scope.save_invoice_if_not_saved=function(invoice,callback){var rounding;return rounding=$scope.rounding_amount().round(2),0!==rounding&&invoice.items.push({description:"Rounding to "+$scope.rounding()+"c",unit_price:rounding,quantity:1,gst_free:!0}),invoice.id?callback():($scope.customer&&(invoice.customer_id=$scope.customer.id),spinnerService.start_spinner("#create-invoice-spinner"),invoice.total_amount=$scope.total(invoice),Pos.create_invoice(invoice,function(data){return spinnerService.stop_spinner("#create-invoice-spinner"),angular.copy(data,$scope.invoice),callback()}))},$scope.put_on_account=function(){var cash_customer,credit_limit_text,exceed_credit_limit,no_customer;return no_customer=!$scope.customer||$scope.customer.is_pos,cash_customer=$scope.invoice.customer&&$scope.invoice.customer.is_pos,no_customer||cash_customer?alert("Please select a non-cash customer"):(exceed_credit_limit=$scope.customer&&$scope.customer.credit_limit&&$scope.customer.credit_limit>0&&$scope.customer.balance+$scope.total_amount($scope.invoice)>=$scope.customer.credit_limit,credit_limit_text=$filter("currency")($scope.customer.credit_limit),confirmationService.confirm("This action will exceed the customer credit limit of "+credit_limit_text,exceed_credit_limit,function(){return $scope.save_invoice_if_not_saved($scope.invoice,function(){return $scope.sales.push($scope.invoice),popoverService.hide("#pos-pay"),$scope.waive_surcharge=!1,timeService.timeout(function(){return $scope.print()})})}))},$scope.tyro_ready=function(){return lookupService.tyro_account()?!0:void 0},$scope.payment_express_ready=function(){return lookupService.payment_express_account()?!0:void 0},$scope.eftpos_machine=function(){return tyroService.enabled()?tyroService:paymentExpressService.enabled()?paymentExpressService:void 0},$scope.payment_made=function(payment_type){var eftpos_machine,finish_transaction,is_eftpos_payment,pay_amount,surcharge;if(!($scope.paying&&$scope.invoice.items.length>0))return $scope.paying=!0,pay_amount=$scope.unpaid_amount($scope.invoice)>=$scope.payment?$scope.payment:$scope.unpaid_amount($scope.invoice),"credit"===payment_type&&$scope.credit_card_surcharge_amount()>0?(pay_amount=$scope.payment_with_credit_card_surcharge(),surcharge=$scope.credit_card_surcharge_amount()):surcharge=0,$scope.change_amount=$scope.payment-pay_amount,finish_transaction=function(payment_info){return null==payment_info&&(payment_info={}),payment_info=$.extend(payment_info,{payment_type:payment_type,amount:pay_amount,surcharge:surcharge}),$scope.invoice.payments.push(payment_info),$scope.save_invoice_if_not_saved($scope.invoice,function(){return $scope.sales.push($scope.invoice),popoverService.hide("#pos-pay"),$scope.waive_surcharge=!1,timeService.timeout(function(){return $scope.print()})})},eftpos_machine=$scope.eftpos_machine(),is_eftpos_payment="eftpos"===payment_type||"credit"===payment_type,eftpos_machine&&is_eftpos_payment&&pay_amount>0?eftpos_machine.start_purchase_transaction(pay_amount,finish_transaction,function(){return $scope.paying=!1}):finish_transaction()},$scope.open=function(invoice){var required_confirmation;return required_confirmation=$scope.invoice.items.length>0,confirmationService.confirm("Current invoice has some item(s), Park it before proceed?",required_confirmation,function(){return $scope.invoice.items.length>0&&$scope.park(),$scope.invoice=invoice,$scope.parks.remove(invoice)})},$scope.use_normal_invoice_for_pos=function(){return lookupService.use_normal_invoice_for_pos()},$scope.toggle_normal_invoice_for_pos=function(){return Pos.toggle_use_normal_invoice_for_pos(function(data){return $scope.use_normal_invoice_for_pos=data.use_normal_invoice_for_pos})},$scope.select_price_level=function(price){return $scope.new_invoice_item.unit_price=price},$scope.init()}}.call(this),function(){this.PriceGroupController=function($location,$scope,$log,$route,$routeParams,confirmationService,timeService,spinnerService,inventoryNavService,popoverService,lookupService,formService,priceGroupService,$filter,PriceGroup){return $scope.open_delete=function(){return $scope.showing_delete_quote_dialog=!0},$scope.open_update_items=function(){return popoverService.show("#price-group-update-prices","#price-group-update-items-button",{placement:"left"})},$scope.update_items=function(){return spinnerService.start_spinner("#price-group-update-items-spinner"),PriceGroup.update_items({id:$scope.price_group.id},function(data){return spinnerService.stop_spinner("#price-group-update-items-spinner"),$scope.price_group=data,$scope.hide_update_items()})},$scope.hide_update_items=function(){return popoverService.hide("#price-group-update-prices")},$scope.cancel_delete=function(){return $scope.showing_delete_quote_dialog=!1},$scope["delete"]=function(){return $scope.deletion_solution?"move"!==$scope.deletion_solution&&"move_update"!==$scope.deletion_solution||$scope.deletion_new_price_group_id?(spinnerService.start_spinner("#delete-price-group-spinner"),PriceGroup["delete"]({id:$routeParams.priceGroupId,solution:$scope.deletion_solution,new_price_group_id:$scope.deletion_new_price_group_id},function(data){return spinnerService.stop_spinner("#delete-price-group-spinner"),angular.copy(data,$scope.price_group),lookupService.fetch_price_groups(),$scope.showing_delete_quote_dialog=!1})):alert("Please select a price group to move the items to"):alert("Please decide what to do with the existing price group's items")},$scope.edit_price_group=function(){return formService.edit_fields($scope.price_group,"editing")},$scope.margin=function(markup){return priceGroupService.calculate_margin_percentage(markup)},$scope.cancel_edit_price_group=function(){return formService.cancel($scope.price_group,"editing")},$scope.save_price_group=function(){var markup_updated;return markup_updated=$scope.price_group.markup_percentage!==$scope.price_group.editing.markup_percentage||$scope.price_group.markup_percentage2!==$scope.price_group.editing.markup_percentage2||$scope.price_group.markup_percentage3!==$scope.price_group.editing.markup_percentage3||$scope.price_group.markup_percentage4!==$scope.price_group.editing.markup_percentage4||$scope.price_group.markup_percentage5!==$scope.price_group.editing.markup_percentage5||$scope.price_group.markup_percentage6!==$scope.price_group.editing.markup_percentage6||$scope.price_group.markup_percentage7!==$scope.price_group.editing.markup_percentage7,confirmationService.confirm('One or more markup values is changed, Please use "Update Items\' Prices" button if you want to update the items prices',markup_updated,function(){return spinnerService.start_spinner("#price-group-spinner"),PriceGroup.update($scope.price_group.editing,function(data){return spinnerService.stop_spinner("#price-group-spinner"),angular.copy(data,$scope.price_group),lookupService.fetch_price_groups()})})},$scope.fetch_stocks=function(page){return null==page&&(page=1),PriceGroup.stocks({id:$routeParams.priceGroupId,"query[page]":page},function(data){return $scope.stocks=data})},$scope.fetch_price_group=function(){return PriceGroup.get({id:$routeParams.priceGroupId},function(data){return spinnerService.stop_spinner("#price-group-spinner"),$scope.price_group=data})},inventoryNavService.activate("Price Groups"),spinnerService.start_spinner("#price-group-spinner"),$scope.fetch_stocks(),$scope.fetch_price_group()}}.call(this),function(){this.PriceGroupsController=function($location,$scope,$log,$route,inventoryNavService,timeService,spinnerService,popoverService,lookupService,formService,priceGroupService,$filter,PriceGroup){return $scope["new"]=function(){return $scope.new_price_group={},popoverService.show("#new-price-group-popover","#new-price-group-button",{placement:"left"}),formService.select_text("#new-price-group-name-input")},$scope.after_create=function(){return spinnerService.start_spinner("#price-group-spinner"),PriceGroup.save($scope.new_price_group,function(){return lookupService.fetch_price_groups(),spinnerService.stop_spinner("#price-group-spinner"),$scope.price_groups.unshift($scope.new_price_group),popoverService.hide("#new-price-group-popover")})},$scope.margin=function(markup){return priceGroupService.calculate_margin_percentage(markup)},$scope.after_cancel=function(){return popoverService.hide("#new-price-group-popover")},spinnerService.start_spinner("#price-groups-spinner"),inventoryNavService.activate("Price Groups"),PriceGroup.all(function(data){return spinnerService.stop_spinner("#price-groups-spinner"),$scope.price_groups=data})}}.call(this),function(){this.NewPurchaseController=function($scope,$location,lookupService,spinnerService,inventoryNavService,Stock,Supplier,Purchase){return inventoryNavService.activate("Purchase Orders"),$scope.purchase={date:new Date,update_stock_quantity:!0,title:"Purchase Order"},$scope.save_purchase=function(){return $scope.purchase.supplier_id?(spinnerService.start_spinner("#saving-purchase"),Purchase.save($scope.purchase,function(data){return $location.path("/purchases/"+data.id),spinnerService.stop_spinner("#saving-purchase")})):alert("Please select a supplier from the dropdown or click New to create one")},$scope.$watch("purchase.supplier_id",function(){return $scope.purchase.supplier_id&&$scope.purchase.supplier&&$scope.purchase.supplier.creditor_id?$scope.purchase.creditor_id=$scope.purchase.supplier.creditor_id:void 0
})}}.call(this),function(){this.PurchasesController=function($scope,$location,$routeParams,confirmationService,lookupService,timeService,spinnerService,inventoryNavService,Purchase){var search_query;return $scope.search=function(page){var search_query;return null==page&&(page=1),search_query={query:$scope.query,page:page},lookupService.save_search_query("suppliers",search_query),spinnerService.start_spinner("#purchase-list-spinner"),Purchase.search({query:$scope.query,page:page},function(data){return $scope.keyword=$scope.query.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.purchases=data.purchases,spinnerService.stop_spinner("#purchase-list-spinner")})},$scope.toggle_open=function(number){return null==number&&(number=1),timeService.timeout(function(){return $scope.query.open&&($scope.query.processed=!1,$scope.query.deleted=!1),$scope.search()})},$scope.toggle_overdue=function(number){return null==number&&(number=1),timeService.timeout(function(){return $scope.query.overdue&&($scope.query.processed=!1,$scope.query.deleted=!1),$scope.search()})},$scope.toggle_processed=function(number){return null==number&&(number=1),timeService.timeout(function(){return $scope.query.processed&&($scope.query.open=!1,$scope.query.overdue=!1),$scope.search()})},$scope.toggle_deleted=function(number){return null==number&&(number=1),timeService.timeout(function(){return $scope.query.deleted&&($scope.query.open=!1,$scope.query.overdue=!1),$scope.search()})},$scope.tags=function(){return lookupService.tags_of_type("Purchase")},$scope.can_undelete_purchase=function(){return lookupService.enable_undelete()&&lookupService.session().is_admin},$scope.undelete=function(purchase){return confirmationService.confirm("Do you want to undelete this purchase order?",!0,function(){return Purchase.undelete({id:purchase.id},function(data){return $location.path("/purchases/"+data.id)})})},inventoryNavService.activate("Purchase Orders"),search_query=lookupService.search_query("purchases"),search_query&&$routeParams.cached?($scope.query=search_query.query,$scope.search(search_query.page||1)):(lookupService.save_search_query("purchases",{query:{query:""}}),$location.path("/purchases").search({cached:Math.random()}).replace())}}.call(this),function(){this.ShowPurchaseController=function($scope,inventoryNavService,formService,$routeParams,lookupService,spinnerService,repcoNavigatorService,confirmationService,popoverService,permissionService,Stock,Purchase,RepcoNavigator){return $scope.open_delete_dialog=function(){return $scope.showing_delete_purchase_dialog=!0},$scope.do_delete_purchase=function(){return permissionService.check_deletion_restriction_before_proceed(function(){return Purchase["delete"]({id:$scope.purchase.id},function(data){return $scope.purchase=data,$scope.showing_delete_purchase_dialog=!1})})},$scope.restricted_to_enter_bills=function(){return lookupService.restricted_to_enter_bills()},$scope.restricted_to_process_purchase_orders=function(){return lookupService.restricted_to_process_purchase_orders()},$scope.cancel_delete_purchase=function(){return $scope.showing_delete_purchase_dialog=!1},$scope.send_purchase_order=function(){return $scope.show_send_purchase_order=!0},$scope.process_purchase_order=function(){return permissionService.check_finalize_documents_restriction_before_proceed(function(){return $scope.show_process_purchase_order=!0})},$scope.repco_account=function(){return lookupService.repco_account()},$scope.quantum_account=function(){return lookupService.quantum_account()},$scope.pro_link_account=function(){return lookupService.pro_link_account()},$scope.motospecs_account=function(){return lookupService.motospecs_account()},$scope.repco_supplier=function(){var supplier_name;return $scope.purchase&&$scope.purchase.supplier?(supplier_name=$scope.purchase.supplier.name.toLowerCase(),supplier_name.match(/repco/)||supplier_name.match(/ashdown ingram/)||supplier_name.match(/covs/)||supplier_name.match(/motospecs/)?!0:void 0):!1},$scope.order_repco=function(account){var required_confirmation;return required_confirmation=$scope.purchase.purchase_items.find(function(i){return!i.sku}),confirmationService.confirm("Some items are missing SKUs, You will need to re-enter them in "+account.name,required_confirmation,function(){return RepcoNavigator.purchase_order_access({id:$scope.purchase.id},function(data){return window.$repco_scope=$scope,repcoNavigatorService.submit_purchase_order($scope.purchase,data.url,account)})})},$scope.repco_success=function(){return Purchase.get({id:$scope.purchase.id},function(data){return angular.copy(data,$scope.purchase)})},$scope.load=function(){return spinnerService.start_spinner("#purchase-loading"),Purchase.get({id:$routeParams.id},function(data){return $scope.purchase=data,spinnerService.stop_spinner("#purchase-loading")})},inventoryNavService.activate("Purchase Orders"),$scope.load()}}.call(this),function(){this.NewQuoteController=function($scope,$location,$routeParams,spinnerService,lookupService,jobNavService,formService,Quote,Customer){var copy_from;return $scope.save_quote=function(){return $scope.submit_form($scope.new_quote_form,function(){}),!lookupService.business_source_required()||$scope.quote.customer.id||$scope.quote.customer.business_source_id?(spinnerService.start_spinner("#new-quote-spinner"),$scope.quote.insurer_id||(delete $scope.quote.account_number,delete $scope.quote.claim_number,delete $scope.quote.excess),Quote.save($scope.quote,function(data){return spinnerService.stop_spinner("#new-quote-spinner"),$location.path("/quotes/"+data.id+"?template=quotes")})):alert("Please Select the customer's source of business")},$scope.remove_mechanic=function(mechanic){return $scope.quote[mechanic]=void 0},$scope.initialize_data=function(data){return data.customer?($scope.selection.customer=data.customer,$scope.recommendations=[data.customer]):void 0},jobNavService.activate("Quotes"),$scope.selection={},$scope.recommendations=[],$scope.employees=lookupService.employees(),$scope.quote_types=lookupService.quote_types(),$scope.quote={items:[],issue_date:new Date,customer:{},vehicle:{},quote_type:$scope.quote_types[0],job_type_ids:[]},$routeParams.copy_from_quote_id&&(copy_from=Quote.get({id:$routeParams.copy_from_quote_id},function(data){return $scope.quote.quote_type=data.quote_type,$scope.quote.job_type_ids=data.job_type_ids,$scope.quote.copy_from_quote_id=data.id})),formService.select_text("#ad-customer-vehicle-form-name"),$routeParams.customer_id?Customer.recommendation({id:$routeParams.customer_id},function(data){return $scope.initialize_data({customer:data,vehicle_id:$routeParams.vehicle_id})}):void 0}}.call(this),function(){this.QuoteController=function($scope,$routeParams,$location,formService,spinnerService,confirmationService,popoverService,lookupService,jobNavService,Quote,Stock,Customer,Cost,DbFile){return $scope.delete_quote=function(){return $scope.showing_delete_quote_dialog=!0},$scope.cancel_delete_quote=function(){return $scope.showing_delete_quote_dialog=!1},$scope.do_delete_quote=function(){return spinnerService.start_spinner("#delete-quote-spinner"),Quote["delete"]($scope.quote,function(data){return spinnerService.stop_spinner("#delete-quote-spinner"),angular.copy(data,$scope.quote),$scope.showing_delete_quote_dialog=!1})},$scope.edit_quote_description=function(){return formService.edit_fields($scope.quote,"editing_description","id","description","claim_number","excess")},$scope.cancel_edit_quote_description=function(){return $scope.quote.editing_description=void 0},$scope.save_quote_description=function(){return Quote.update($scope.quote.editing_description,function(data){return angular.copy(data,$scope.quote)})},$scope.edit_quote_info=function(){return formService.edit_fields($scope.quote,"editing_quote_info","id","quote_type","issue_date","order_number")},$scope.cancel_edit_quote_info=function(){return formService.cancel($scope.quote,"editing_quote_info")},$scope.cancel_quote=function(){return confirmationService.confirm("Do you want to cancel this quote",!0,function(){return Quote.cancel({id:$scope.quote.id},function(data){return angular.copy(data,$scope.quote)})})},$scope.save_quote_info=function(){return $scope.submit_form($scope.edit_quote_info_form,function(){return Quote.update($scope.quote.editing_quote_info,function(data){return angular.copy(data,$scope.quote)})})},$scope.cost_total=function(cost){return cost&&cost.quantity&&cost.unit_price?cost.quantity*cost.unit_price:0},$scope.create_invoice=function(){return Quote.create_invoice($scope.quote,function(data){return $location.path("/invoices/"+data.id)})},$scope.create_booking=function(){return $location.path("/bookings/new").search({quote_id:$scope.quote.id})},$scope.create_job=function(){return $location.path("/jobs/new").search({quote_id:$scope.quote.id})},$scope.select_price_level=function(cost,price){return cost.unit_price=price},$scope.edit_quote_details=function(){return formService.edit_fields($scope.quote,"editing_details","id","details"),formService.select_text("#edit-quote-details")},$scope.save_quote_details=function(){return Quote.update($scope.quote.editing_details,function(data){return angular.copy(data,$scope.quote)})},$scope.cancel_edit_quote_details=function(){return $scope.quote.editing_details=null},$scope.clear_quote_details=function(){return $scope.quote.editing_details.details="",Quote.update($scope.quote.editing_details,function(data){return angular.copy(data,$scope.quote)})},$scope.upload_quote_files=function(){return $scope.uploading_files=!0},$scope.cancel_upload_files=function(){return $("#upload-file1").val(void 0),$("#upload-file2").val(void 0),$("#upload-file3").val(void 0),$scope.uploading_files=!1},$scope.start_uploading=function(){return $scope.start_spinner("#upload-photos-spinner")},$scope.full_size_photo=function(){var active_photo;return active_photo=$scope.quote.photos.find(function(p){return p.active}),window.open(active_photo.url)},$scope.remove_photo=function(photo){return DbFile["delete"](photo,function(){return $scope.quote.photos.remove(photo),0===$scope.quote.photos.length?$scope.close_photo_viewer():void 0})},$scope.edit_file=function(document){return formService.edit_fields(document,"editing","id","file_name")},$scope.cancel_edit_file=function(document){return formService.cancel(document,"editing")},$scope.rename_file=function(document){return DbFile.rename(document.editing,function(data){return document.file_name=data.file_name,document.editing=void 0})},$scope.remove_file=function(document){return $scope.start_spinner("#upload-photos-spinner"),DbFile["delete"](document,function(){return $scope.stop_spinner("#upload-photos-spinner"),$scope.quote.documents.remove(document)})},$scope.close_photo_viewer=function(){return popoverService.hide("#photo-viewer"),$scope.quote.photos.each(function(p){return p.active=!1})},$scope.view_photo=function(photo){return photo.active=!0,popoverService.show("#photo-viewer","#quote-photos",{placement:"left"})},$scope.files_uploaded=function(data){return $scope.stop_spinner("#upload-photos-spinner"),$("#upload-file1").val(void 0),$("#upload-file2").val(void 0),$("#upload-file3").val(void 0),$scope.uploading_files=!1,"object"==typeof data?angular.copy(data,$scope.quote):alert("Error while uploading file(s), please check that each file is maximum 1Mb and try again.")},$scope.select_invoice=function(invoice){return invoice.job_id?$location.path("/jobs/"+invoice.job_id):$location.path("/invoices/"+invoice.id)},$scope.show_vehicle=function(){return popoverService.show("#vehicle",".vehicle-details",{placement:"bottom"})},$scope.change_vehicle=function(){return popoverService.hide("#vehicle"),popoverService.show("#change-vehicle",".vehicle-details",{placement:"bottom"}),$scope.changing_vehicle=!0},$scope.close_vehicle=function(){return popoverService.hide("#vehicle"),popoverService.hide("#change-vehicle")},$scope.remove_mechanic=function(mechanic){return 1===mechanic&&($scope.mechanic_1_id=void 0),2===mechanic?$scope.mechanic_2_id=void 0:void 0},$scope.edit_mechanics=function(){return $scope.quote.assessed_by&&($scope.mechanic_1_id=$scope.quote.assessed_by.id),$scope.quote.estimated_by&&($scope.mechanic_2_id=$scope.quote.estimated_by.id),$scope.quote.editing_mechanics=!0},$scope.cancel_edit_mechanics=function(){return $scope.quote.editing_mechanics=void 0},$scope.save_mechanics=function(){return Quote.update_employees({id:$scope.quote.id,assessed_by_id:$scope.mechanic_1_id,estimated_by_id:$scope.mechanic_2_id},function(data){return angular.copy(data,$scope.quote)})},$scope.edit_odometer=function(){return formService.edit_fields($scope.quote,"editing_odometer","id","odometer")},$scope.cancel_edit_odometer=function(){return formService.cancel($scope.quote,"editing_odometer")},$scope.save_odometer=function(){return Quote.update($scope.quote.editing_odometer,function(data){return angular.copy(data,$scope.quote)})},$scope.edit_machine_hours=function(){return formService.edit_fields($scope.quote,"editing_machine_hours","id","machine_hours")},$scope.cancel_edit_machine_hours=function(){return formService.cancel($scope.quote,"editing_machine_hours")},$scope.save_machine_hours=function(){return Quote.update($scope.quote.editing_machine_hours,function(data){return angular.copy(data,$scope.quote)})},$scope.edit_engine_hours=function(){return formService.edit_fields($scope.quote,"editing_engine_hours","id","engine_hours")},$scope.cancel_edit_engine_hours=function(){return formService.cancel($scope.quote,"editing_engine_hours")},$scope.save_engine_hours=function(){return Quote.update($scope.quote.editing_engine_hours,function(data){return angular.copy(data,$scope.quote)})},$scope.edit_tracking_category=function(){return formService.edit_fields($scope.quote,"editing_tracking_category","id","tracking_categories")},$scope.cancel_edit_tracking_category=function(){return formService.cancel($scope.quote,"editing_tracking_category")},$scope.save_tracking_category=function(){return Quote.update($scope.quote.editing_tracking_category,function(data){return angular.copy(data,$scope.quote)})},$scope.send_email=function(){return $scope.email_quote=!0},$scope.close_customer=function(){return popoverService.hide("#quote-paying-customer")},$scope.change_customer=function(){return $scope.changing_customer=!0},$scope.show_customer=function(){return popoverService.show("#quote-paying-customer","#quote-customer-name",{placement:"right"})},$scope.open_cogs=function(){return $scope.cogs_opened=!0},$scope.close_cogs=function(){return $scope.cogs_opened=!1},jobNavService.activate("Quotes"),$scope.print=!1,$scope.employees=lookupService.employees(),$scope.quote_types=lookupService.quote_types(),spinnerService.start_spinner("#quote-spinner"),$scope.quote=Quote.get({id:$routeParams.quoteId},function(){return spinnerService.stop_spinner("#quote-spinner"),$scope.job=$scope.quote.job,$scope.auto_workshop=$scope.quote.auto_workshop,$scope.customer=$scope.quote.customer})}}.call(this),function(){this.QuotesController=function($scope,$location,$routeParams,jobNavService,confirmationService,timeService,lookupService,Quote){var search_query;return $scope.tags=function(){return lookupService.tags_of_type("Quote")},$scope.search=function(page){var search_query;return null==page&&(page=1),search_query={query:$scope.query,page:page},lookupService.save_search_query("quotes",search_query),$scope.start_spinner("#quotes-spinner"),Quote.search(search_query,function(data){return $scope.keyword=$scope.query.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.quotes=data.quotes,$scope.stop_spinner("#quotes-spinner")})},$scope.toggle_active=function(){return $scope.query.deleted=!1,timeService.timeout(function(){return $scope.search()})},$scope.toggle_deleted=function(){return $scope.query.active=!1,timeService.timeout(function(){return $scope.search()})},$scope.download=function(){var params;return params=$.param({query:$scope.query}),window.open("/quotes/download?"+params)},$scope.quote_path=function(quote){return"#/quotes/"+quote.id},$scope.can_undelete_quote=function(){return lookupService.enable_undelete()&&lookupService.session().is_admin},$scope.undelete=function(quote){return confirmationService.confirm("Do you want to undelete this quote?",!0,function(){return Quote.undelete({id:quote.id},function(data){return $location.path("/quotes/"+data.id)})})},jobNavService.activate("Quotes"),search_query=lookupService.search_query("quotes"),search_query&&search_query.query&&$routeParams.cached?($scope.query=search_query.query,$scope.search(search_query.page||1)):($scope.query={query:null},lookupService.save_search_query("quotes",{query:{query:""}}),$location.path("/quotes").search({cached:Math.random()}).replace())}}.call(this),function(){this.RepcoIntegrationController=function($scope,timeService,lookupService,integrationsNavService,spinnerService,repcoNavigatorService,formService,RepcoNavigator,AutoWorkshop,SupplierIntegrationAccount){return integrationsNavService.activate("Supplier Integration"),$scope.repco_account={type:"RepcoAccount",store_parts:!0,active:!0},$scope.quantum_account={type:"QuantumAccount",store_parts:!0,active:!0},$scope.pro_link_account={type:"ProLinkAccount",store_parts:!0,active:!0},$scope.ezy_parts_account={type:"EzyPartsAccount",store_parts:!0,active:!0},$scope.autopro_account={type:"AutoproAccount",store_parts:!0,active:!0},$scope.motospecs_account={type:"MotospecsAccount",store_parts:!0,active:!0},SupplierIntegrationAccount.repco(function(data){return data.id?$scope.repco_account=data:void 0}),SupplierIntegrationAccount.pro_link(function(data){return data.id?$scope.pro_link_account=data:void 0}),SupplierIntegrationAccount.motospecs(function(data){return data.id?$scope.motospecs_account=data:void 0}),SupplierIntegrationAccount.quantum(function(data){return data.id?$scope.quantum_account=data:void 0}),SupplierIntegrationAccount.ezy_parts(function(data){return data.id?$scope.ezy_parts_account=data:void 0}),SupplierIntegrationAccount.autopro(function(data){return data.id?$scope.autopro_account=data:void 0}),$scope.start_integration=function(account){return formService.edit_fields(account,"editing")},$scope.edit_accounting_integration=function(account){return formService.edit_fields(account,"editing")},$scope.repco_success=function(){return timeService.timeout(function(){return $scope.repco_success_message="Your inventory has been updated"})},$scope.save=function(account){return account.editing.id?SupplierIntegrationAccount.update(account.editing,function(data){return angular.copy(data,account),"RepcoAccount"===account.type?lookupService.set_repco_account(data):"QuantumAccount"===account.type?lookupService.set_quantum_account(data):"EzyPartsAccount"===account.type?lookupService.set_ezy_parts_account(data):"ProLinkAccount"===account.type?lookupService.set_pro_link_account(data):"AutoproAccount"===account.type?lookupService.set_autopro_account(data):"MotospecsAccount"===account.type?lookupService.set_motospecs_account(data):void 0}):(account===$scope.repco_account&&"RepcoAccount"===account.editing.type,account===$scope.quantum_account&&"QuantumAccount"===account.editing.type,account===$scope.pro_link_account&&"ProLinkAccount"===account.editing.type,account===$scope.ezy_parts_account&&"EzyPartsAccount"===account.editing.type,account===$scope.autopro_account&&"AutoproAccount"===account.editing.type,account===$scope.motospecs_account&&"MotospecsAccount"===account.editing.type,SupplierIntegrationAccount.save(account.editing,function(data){return angular.copy(data,account),"RepcoAccount"===account.type?lookupService.set_repco_account(data):"QuantumAccount"===account.type?lookupService.set_quantum_account(data):"EzyPartsAccount"===account.type?lookupService.set_ezy_parts_account(data):"ProLinkAccount"===account.type?lookupService.set_pro_link_account(data):"AutoproAccount"===account.type?lookupService.set_autopro_account(data):"MotospecsAccount"===account.type?lookupService.set_motospecs_account(data):void 0}))},$scope.cancel=function(account){return account.editing=void 0},$scope.setup_repco_inventory=function(account){return RepcoNavigator.inventory_access({account_id:account.id},function(data){return window.$repco_scope=$scope,repcoNavigatorService.inquiry(data.url,account)})}}}.call(this),function(){this.AmsReportController=function($scope,$window,$location,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){var end_today,start_today;return reportsNavService.activate("AMS Rewards Report"),start_today=moment().startOf("day"),end_today=moment().endOf("day"),$scope.query={from:start_today.toDate(),to:end_today.toDate()},$scope.open_invoice=function(invoice){return"invoice"===invoice.type?$location.path("/invoices/"+invoice.id):"credit_note"===invoice.type?$location.path("/credit_notes/"+invoice.id):void 0},$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.ams(params,function(data){return $scope.data||($scope.data={}),$scope.reporting_from=params.from,$scope.reporting_to=params.to,angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner")}),$scope.download=function(){return $window.open("/reports/ams.csv?"+$.param({from:$scope.query.from,to:$scope.query.to}))}},$scope.filter_report()}}.call(this),function(){this.BillsReportController=function($scope,$window,$location,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){var one_months_ago,today;return reportsNavService.activate("Bills Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.open_bill=function(bill){return"bill"===bill.type?$location.path("/bills/"+bill.id):"credit_note"===bill.type?$location.path("/credit_notes/"+bill.id):void 0},$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.bills(params,function(data){return $scope.data||($scope.data={}),$scope.reporting_from=params.from,$scope.reporting_to=params.to,angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner")}),$scope.print=function(){return $window.open("/reports/bills.pdf?"+$.param({from:$scope.query.from,to:$scope.query.to}))},$scope.download=function(){return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),window.open("/reports/bills/download?"+$.param(params))}},$scope.by_time="week",$scope.filter_report()}}.call(this),function(){this.BuyinReportController=function($scope,$location,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,formService,Report){var one_months_ago,today;return reportsNavService.activate("Buyin Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate()},$scope.order_by="quantity",$scope.order="desc",$scope.stock={},formService.focus("#stockpicker-input"),$scope.filter_report=function(){var params;return $scope.stock.id=$scope.stock.stock_id,$scope.stock.id?(params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),params.order=$scope.order,params.order_by=$scope.order_by,params.stock_id=$scope.stock.id,spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.buyin(params,function(data){return $scope.data||($scope.data={}),angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner")})):alert("Please select a stock by using the search box and choose from the recommendation dropdown")},$scope.open_purchase=function(purchase){return $window.open("#/bills/"+purchase.bill_id)},$scope.open_return=function(ri){return $window.open("#/supplier_credit_notes/"+ri.supplier_credit_note_id)},$scope.open_customer_return=function(cr){return $window.open("#/credit_notes/"+cr.credit_note_id)}}}.call(this),function(){this.ChangeLogsReportController=function($scope,$window,$location,$routeParams,$filter,reportService,lookupService,reportsNavService,spinnerService,Report){var one_months_ago,today;return reportsNavService.activate("Change Logs Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.employees=function(){return lookupService.employees()},$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),$scope.query.employee_id&&(params["employee_ids[]"]=$scope.query.employee_id),spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.change_logs(params,function(data){return $scope.data||($scope.data={}),$scope.reporting_from=params.from,$scope.reporting_to=params.to,angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner")}),$scope.print=function(){return $window.open("/reports/bills.pdf?"+$.param({from:$scope.query.from,to:$scope.query.to}))},$scope.download=function(){return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),window.open("/reports/change_logs/download?"+$.param(params))}},$scope.by_time="week",$scope.filter_report()}}.call(this),function(){this.CommissionReportController=function($scope,$location,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){var one_months_ago,today;return reportsNavService.activate("Commission Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.order_by="quantity",$scope.order="desc",$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),params.order=$scope.order,params.order_by=$scope.order_by,spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.commission(params,function(data){return $scope.data||($scope.data={}),angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner"),$scope.show_report(),$scope.show_quote_amount="percentage_on_quote_and_sales_margin"===data.commission_calculator_type?!0:!1})},$scope.open_employee=function(employee){return $scope.showing_employee=employee},$scope.close_employee=function(){return $scope.showing_employee=void 0},$scope.show_report=function(){return reportService.pie("#commission-report",$scope.data.data,{series:{pie:{combine:{threshold:.03,label:"Other Employee(less than 3% each)"}}}})},$scope.print=function(){return $window.open("/reports/commission.pdf?"+$.param({from:$scope.query.from,to:$scope.query.to}))},$scope.open_invoice=function(item){return"invoice"===item.type?$window.open.path("/invoices/"+item.id):$window.open.path("/credit_notes/"+item.id)},$scope.sort_categories=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.categories=$scope.categories.sortBy(attribute,"desc"===$scope.order)},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.data.data=$scope.data.data.sortBy(attribute,"desc"===$scope.order)},$scope.average_cost=function(item){return(item.total_cost/(item.quantity-item["return"])).round(2)},$scope.average_sell=function(item){return(item.total_net_amount/(item.quantity-item["return"])).round(2)},$scope.average_profit=function(item){return(item.profit_margin/(item.quantity-item["return"])).round(2)},$scope.filter_report()}}.call(this),function(){this.DailyIncomeReportController=function($scope,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){var one_months_ago,today;return reportsNavService.activate("Received Payments"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.income_by_payment_type(params,function(data){return $scope.data||($scope.data={}),$scope.reporting_from=params.from,$scope.reporting_to=params.to,angular.copy(data,$scope.data),reportService.pie("#income-payment-method-report",data.data),spinnerService.stop_spinner("#report-spinner")})},$scope.print=function(){return $window.open("/reports/income_by_payment_type.pdf?"+$.param({from:$scope.query.from,to:$scope.query.to}))},$scope.show_day=function(day){return $scope.showing_day=day},$scope.show_summary=function(){return $scope.showing_day=void 0},$scope.download=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),window.open("/reports/income_by_payment_type/download?"+$.param(params))},$scope.filter_report()}}.call(this),function(){this.DebtorsReportController=function($scope,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report,Customer,CustomerStatementSendingRequest){return reportsNavService.activate("Customer Statements"),$scope.filter_report=function(){return spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.debtors(function(data){var graph;return $scope.data||($scope.data={}),angular.copy(data,$scope.data),$scope.data.customers=$scope.data.customer_accounts.map(function(a){return a.customer}),spinnerService.stop_spinner("#report-spinner"),graph=[{label:"Due",data:data.total_overdue_amount},{label:"Remaining",data:data.total_receivable_amount-data.total_overdue_amount}],reportService.pie("#debtors-report",graph)})},$scope.print=function(){return $window.open("/reports/debtors.pdf")},$scope.print_statements=function(){var ids,selected_customers;return selected_customers=$scope.data.customers.filter(function(c){return c.selected}),0===selected_customers.length?alert("Please select customer statements to print"):selected_customers.length<=5?(ids=selected_customers.map(function(c){return c.id}),$window.open("/reports/debtors/statements.pdf?"+$.param({ids:ids}))):(ids=selected_customers.map(function(c){return c.id}),Customer.bulk_statements({ids:ids},function(){return $scope.message="Your customer statements are now queued to be generated. You will receive a email once the process is finished"}))},$scope.send_statements=function(){var ids,selected_customers;return selected_customers=$scope.data.customers.filter(function(c){return c.selected}),0===selected_customers.length?alert("Please select at least one customer, or click on the 'All' checkbox to select all customers"):(ids=selected_customers.map(function(c){return c.id}),CustomerStatementSendingRequest.save({customer_ids:ids},function(){return $scope.message="Your customer statements are now queued to be sent. You will receive a email once the process is finished"}))},$scope.toggle_select_all=function(){return $scope.all_selected?($scope.data.customers.forEach(function(c){return c.selected=!1}),$scope.all_selected=!1):($scope.all_selected=!0,$scope.data.customers.forEach(function(c){return c.selected=!0}))},$scope.filter_report()}}.call(this),function(){this.EfficiencyReportController=function($scope,$location,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){var one_months_ago,today;return reportsNavService.activate("Efficiency Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.order_by="name",$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),params.order=$scope.order,params.order_by=$scope.order_by,$scope.include_in_progress_jobs&&(params.include_in_progress_jobs=!0),$scope.employee&&(params.employee_id=$scope.employee.id),spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.efficiency(params,function(data){return $scope.data||($scope.data={}),angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner"),reportService.pie("#efficiency-category-report",[{label:"Efficient",data:data.total_effective_charge_out_hours},{label:"Non-Efficient",data:data.total_hours-data.total_effective_charge_out_hours}],{unit:"h",series:{pie:{combine:{threshold:.03,label:"Other"}}}})
})},$scope.print=function(){return $window.open("/reports/efficiency.pdf?"+$.param({from:$scope.query.from,to:$scope.query.to}))},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.data.data=$scope.data.data.sortBy(attribute,"desc"===$scope.order)},$scope.percentage=function(employee){return employee.total_hours&&employee.total_effective_charge_out_hours?""+(100*(employee.total_effective_charge_out_hours/employee.total_hours)).round(2)+"%":"N/A"},$scope.open_employee=function(employee){return $scope.employee=employee,$scope.filter_report()},$scope.summary=function(){return $scope.employee=void 0,$scope.filter_report()},$scope.open_wh=function(wh){return $location.path("/jobs/"+wh.job_id)},$scope.filter_report()}}.call(this),function(){this.IncomeByJobTypeReportController=function($scope,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){var one_months_ago,today;return reportsNavService.activate("Income By Job Types"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.income_by_job_type(params,function(data){return $scope.data||($scope.data={}),$scope.reporting_from=params.from,$scope.reporting_to=params.to,angular.copy(data,$scope.data),reportService.pie("#income-job-type-report",data.income_by_job_types,{series:{pie:{combine:{threshold:.03,label:"Other Job Types(less than 3% each)"}}}}),spinnerService.stop_spinner("#report-spinner")})},$scope.filter_report()}}.call(this),function(){this.IncomePaidUnpaidReportController=function($scope,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){var one_months_ago,today;return reportsNavService.activate("Income Paid/Unpaid"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.income_by_status(params,function(data){return $scope.data||($scope.data={}),$scope.reporting_from=params.from,$scope.reporting_to=params.to,angular.copy(data,$scope.data),reportService.pie("#income-status-report",data.income_by_statuses),spinnerService.stop_spinner("#report-spinner")})},$scope.filter_report()}}.call(this),function(){this.IncomeWeeklyMonthlyReportController=function($scope,$window,$location,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){var one_months_ago,today;return reportsNavService.activate("Invoice Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.open_invoice=function(invoice){return"invoice"===invoice.type?$location.path("/invoices/"+invoice.id):"credit_note"===invoice.type?$location.path("/credit_notes/"+invoice.id):void 0},$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.income_by_time(params,function(data){return $scope.data||($scope.data={}),$scope.reporting_from=params.from,$scope.reporting_to=params.to,angular.copy(data,$scope.data),reportService.bar("#income-by-week-report",data.income_by_week),reportService.bar("#income-by-month-report",data.income_by_month),spinnerService.stop_spinner("#report-spinner")}),$scope.print=function(){return $window.open("/reports/income_by_time.pdf?"+$.param({from:$scope.query.from,to:$scope.query.to}))},$scope.average_total=function(){return $scope.data&&$scope.data.invoices&&$scope.data.invoices.length>0?($scope.data.total_receivable_amount/$scope.data.invoices.length).toFixed(2):0},$scope.average_net_total=function(){return $scope.data&&$scope.data.invoices&&$scope.data.invoices.length>0?($scope.data.total_net_amount/$scope.data.invoices.length).toFixed(2):0},$scope.average_margin=function(){return $scope.data&&$scope.data.invoices&&$scope.data.invoices.length>0?($scope.data.total_profit_margin/$scope.data.invoices.length).toFixed(2):0},$scope.average_margin_percentage=function(){return $scope.data&&$scope.data.invoices&&$scope.data.invoices.length>0?(100*($scope.average_margin()/$scope.average_net_total())).toFixed(2):0},$scope.download=function(){return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),window.open("/reports/income_by_time/download?"+$.param(params))}},$scope.by_time="week",$scope.filter_report()}}.call(this),function(){this.JobReportController=function($scope,$timeout,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,popoverService,lookupService,Report){var one_months_ago,today;return reportsNavService.activate("Job Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate(),include_unfinished:!0},$scope.employees=function(){return lookupService.employees()},$scope.filter_report=function(){return $timeout(function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),$scope.query.include_unfinished&&(params.include_unfinished=$scope.query.include_unfinished),$scope.query.employee_id&&(params.employee_id=$scope.query.employee_id),spinnerService.start_spinner("#report-spinner"),$scope.report=Report.job(params,function(){return $scope.reporting_from=params.from,$scope.reporting_to=params.to,spinnerService.stop_spinner("#report-spinner")})})},$scope.download=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),$scope.query.include_unfinished&&(params.include_unfinished=$scope.query.include_unfinished),$scope.query.employee_id&&(params.employee_id=$scope.query.employee_id),window.open("/reports/job/download?"+$.param(params))},$scope.open=function(job){return $window.open("#/jobs/"+job.id)},$scope.filter_report()}}.call(this),function(){this.LeadReportController=function($scope,$routeParams,$filter,reportService,reportsNavService,spinnerService,popoverService,Report){var one_months_ago,today;return reportsNavService.activate("Lead Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),$scope.query.original_source&&(params.original_source=!0),spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.lead(params,function(data){return $scope.data||($scope.by_source={}),$scope.reporting_from=params.from,$scope.reporting_to=params.to,angular.copy(data,$scope.by_source),reportService.pie("#lead-report",data.data,{series:{pie:{combine:{threshold:.03,label:"Other Sources(less than 3% each)"}}}}),reportService.pie("#original-lead-report",data.original_source_data,{series:{pie:{combine:{threshold:.03,label:"Other Sources(less than 3% each)"}}}}),spinnerService.stop_spinner("#report-spinner")}),spinnerService.start_spinner("#lead-new-customer-report"),Report.lead_new_customer(params,function(data){return $scope.new_customers=data,reportService.pie("#lead-new-customer-report",data.data,{unit:"number"}),spinnerService.stop_spinner("#lead-new-customer-report-spinner")})},$scope.show_new_customers_details=function(){return popoverService.show("#new-customers-details-popover","#lead-report-header",{placement:"bottom"})},$scope.hide_new_customers_details=function(){return popoverService.hide("#new-customers-details-popover")},$scope.show_income_by_source_details=function(){return popoverService.show("#income-by-source-details-popover","#lead-report-header",{placement:"bottom"})},$scope.hide_income_by_source_details=function(){return popoverService.hide("#income-by-source-details-popover")},$scope.show_income_by_original_details=function(){return popoverService.show("#income-by-original-details-popover","#lead-report-header",{placement:"top"})},$scope.hide_income_by_original_details=function(){return popoverService.hide("#income-by-original-details-popover")},$scope.preview=function(invoice){var copy;return copy={},angular.copy(invoice,copy),$scope.previewed_invoice=copy},$scope.filter_report()}}.call(this),function(){this.ProductivityReportController=function($scope,$location,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){var one_months_ago,today;return reportsNavService.activate("Productivity Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.order_by="name",$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),params.order=$scope.order,params.order_by=$scope.order_by,$scope.include_in_progress_jobs&&(params.include_in_progress_jobs=!0),$scope.employee&&(params.employee_id=$scope.employee.id),spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.productivity(params,function(data){return $scope.data||($scope.data={}),angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner"),reportService.pie("#productivity-category-report",[{label:"Charged",data:data.total_charged_hours},{label:"Non-charged",data:data.total_non_charged_hours}],{unit:"h",series:{pie:{combine:{threshold:.03,label:"Other"}}}})})},$scope.print=function(){return $window.open("/reports/productivity.pdf?"+$.param({from:$scope.query.from,to:$scope.query.to}))},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.data.data=$scope.data.data.sortBy(attribute,"desc"===$scope.order)},$scope.percentage=function(employee){return employee.total_hours&&employee.total_charged_hours?""+(100*(employee.total_charged_hours/employee.total_hours)).round(2)+"%":"N/A"},$scope.open_employee=function(employee){return $scope.employee=employee,$scope.filter_report()},$scope.summary=function(){return $scope.employee=void 0,$scope.filter_report()},$scope.open_wh=function(wh){return $location.path("/jobs/"+wh.job_id)},$scope.filter_report()}}.call(this),function(){this.PurchasesReportController=function($scope,$location,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){var one_months_ago,today;return reportsNavService.activate("Purchases Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.order_by="quantity",$scope.order="desc",$scope.download=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),params.order=$scope.order,params.order_by=$scope.order_by,$scope.include_unfinalized&&(params.unfinalized=!0),window.open("/reports/purchases/download?"+$.param(params))},$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),params.order=$scope.order,params.order_by=$scope.order_by,spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.purchases(params,function(data){return $scope.data||($scope.data={}),angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner"),$scope.group_by_categories(),$scope.group_by_brand(),$scope.show_category_report()})},$scope.open_category=function(category){return $scope.showing_category=category},$scope.open_brand=function(brand){return $scope.showing_brand=brand},$scope.close_category=function(){return $scope.showing_category=void 0},$scope.close_brand=function(){return $scope.showing_brand=void 0},$scope.item_list=function(){return $scope.showing_category?$scope.data.data.filter(function(i){return i.stock_category?i.stock_category===$scope.showing_category.name:"Other"===$scope.showing_category.name}):$scope.showing_brand?$scope.data.data.filter(function(i){return i.brand?i.brand===$scope.showing_brand.name:"Other"===$scope.showing_brand.name}):$scope.data?$scope.data.data:[]},$scope.group_by_categories=function(){var data_categories,k,v,_results;data_categories={},$scope.categories=[],$scope.data.data.each(function(item){var category;return category=item.stock_category?item.stock_category:"Other",data_categories[category]||(data_categories[category]={label:category,data:0,name:category,quantity:0,total_net_amount:0,total_gst_amount:0,total_amount:0,"return":0,profit_margin:0,id:item.stock_category_id}),data_categories[category].data+=item.total_amount,data_categories[category].quantity+=item.quantity,data_categories[category].total_amount+=item.total_amount,data_categories[category].total_net_amount+=item.total_net_amount,data_categories[category].total_gst_amount+=item.total_gst_amount,data_categories[category]["return"]+=item["return"],data_categories[category].profit_margin+=item.profit_margin}),_results=[];for(k in data_categories)v=data_categories[k],_results.push($scope.categories.push(v));return _results},$scope.group_by_brand=function(){var data_brands,k,v,_results;data_brands={},$scope.brands=[],$scope.data.data.each(function(item){var brand;return brand=item.brand?item.brand:"No brand",data_brands[brand]||(data_brands[brand]={label:brand,data:0,name:brand,quantity:0,total_net_amount:0,total_gst_amount:0,total_amount:0,"return":0,profit_margin:0}),data_brands[brand].data+=item.total_amount,data_brands[brand].quantity+=item.quantity,data_brands[brand].total_amount+=item.total_amount,data_brands[brand].total_net_amount+=item.total_net_amount,data_brands[brand].total_gst_amount+=item.total_gst_amount,data_brands[brand]["return"]+=item["return"],data_brands[brand].profit_margin+=item.profit_margin}),_results=[];for(k in data_brands)v=data_brands[k],_results.push($scope.brands.push(v));return _results},$scope.show_category_report=function(){return reportService.pie("#purchase-category-report",$scope.categories,{series:{pie:{combine:{threshold:.03,label:"Other Categories(less than 3% each)"}}}})},$scope.sort_categories=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.categories=$scope.categories.sortBy(attribute,"desc"===$scope.order)},$scope.sort_brand=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.categories=$scope.brands.sortBy(attribute,"desc"===$scope.order)},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.data.data=$scope.data.data.sortBy(attribute,"desc"===$scope.order)},$scope.print=function(){var category_id;return category_id=$scope.showing_category?$scope.showing_category.id||"other":"",$window.open("/reports/purchases.pdf?"+$.param({from:$scope.query.from,to:$scope.query.to,category_id:category_id}))},$scope.open_item=function(item){return item.stock_id?$location.path("/stocks/"+item.stock_id):void 0},$scope.filter_report()}}.call(this),function(){this.QuoteReportController=function($scope,$timeout,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,popoverService,lookupService,Report){var one_months_ago,today;return reportsNavService.activate("Quote Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.employees=function(){return lookupService.employees()},$scope.filter_report=function(){return $timeout(function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),spinnerService.start_spinner("#report-spinner"),$scope.report=Report.quote(params,function(data){return $scope.reporting_from=params.from,$scope.reporting_to=params.to,spinnerService.stop_spinner("#report-spinner"),reportService.pie("#value-report",data.value_data),reportService.pie("#count-report",data.count_data,{unit:"number"}),$scope.quotes=data.quotes})})},$scope.download=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),window.open("/reports/quote/download?"+$.param(params))},$scope.open=function(quote){return $window.open("#/quotes/"+quote.id)},$scope.filter_report()}}.call(this),function(){this.AutoWorkshopApp.service("reportsNavService",function(){var _this=this;return{activate:function(id){return _this.active_id=id},active_id:function(){return _this.active_id}}}),this.ReportsNavController=function($scope,navbarService,reportsNavService,lookupService){var ams_account;return navbarService.activate("Reports"),$scope.isActive=function(id){return id.toString()===reportsNavService.active_id()?"active":""},$scope.income_reports=[{path:"daily_income",name:"Received Payments"},{path:"income_by_job_type",name:"Income By Job Type"},{path:"income_paid_unpaid",name:"Income Paid/Unpaid"},{path:"income_weekly_monthly",name:"Invoice Report"},{path:"sales",name:"Sales Report"},{path:"debtors",name:"Customer Statements"}],$scope.work_reports=[{path:"job",name:"Job Report"},{path:"wip",name:"Work In Progress Jobs Report"},{path:"wip_invoice",name:"Work In Progress Invoices Report"},{path:"workshop_efficiency",name:"Workshop Efficiency Report"},{path:"quote",name:"Quote Report"}],$scope.expense_reports=[{path:"bills",name:"Bills Report"},{path:"purchases",name:"Purchases Report"},{path:"suppliers",name:"Suppliers Report"}],$scope.employee_reports=[{path:"commission",name:"Commission Report"},{path:"productivity",name:"Productivity Report"},{path:"efficiency",name:"Efficiency Report"}],$scope.marketing_reports=[{path:"lead",name:"Lead Report"}],$scope.inventory_reports=[{path:"buyin",name:"Buyin Report"},{path:"stock_value",name:"Stock Value Report"}],ams_account=lookupService.royalty_integration_accounts().find(function(a){return"AmsAccount"===a.type}),ams_account?$scope.income_reports.push({path:"ams",name:"AMS Rewards Report"}):void 0}}.call(this),function(){this.SalesReportController=function($scope,$location,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){var one_months_ago,today;return reportsNavService.activate("Sales Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.order_by="quantity",$scope.order="desc",$scope.download=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),params.order=$scope.order,params.order_by=$scope.order_by,$scope.include_unfinalized&&(params.unfinalized=!0),window.open("/reports/sales/download?"+$.param(params))},$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),params.order=$scope.order,params.order_by=$scope.order_by,$scope.include_unfinalized&&(params.unfinalized=!0),spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.sales(params,function(data){return $scope.data||($scope.data={}),angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner"),$scope.group_by_categories(),$scope.show_category_report()})},$scope.open_category=function(category){return $scope.showing_category=category},$scope.close_category=function(){return $scope.showing_category=void 0},$scope.item_list=function(){return $scope.showing_category?$scope.data.data.filter(function(i){return i.stock_category?i.stock_category===$scope.showing_category.name:"Other"===$scope.showing_category.name}):$scope.data?$scope.data.data:[]},$scope.group_by_categories=function(){var data_categories,k,v,_results;data_categories={},$scope.categories=[],$scope.data.data.each(function(item){var category;return category=item.stock_category?item.stock_category:"Other",data_categories[category]||(data_categories[category]={label:category,data:0,name:category,quantity:0,total_net_amount:0,total_gst_amount:0,total_cost:0,total_amount:0,"return":0,profit_margin:0,id:item.stock_category_id}),data_categories[category].data+=item.total_amount,data_categories[category].quantity+=item.quantity,data_categories[category].total_amount+=item.total_amount,data_categories[category].total_net_amount+=item.total_net_amount,data_categories[category].total_gst_amount+=item.total_gst_amount,data_categories[category]["return"]+=item["return"],data_categories[category].profit_margin+=item.profit_margin,data_categories[category].total_cost+=item.total_cost}),_results=[];for(k in data_categories)v=data_categories[k],v.profit_margin_percentage=(100*(v.profit_margin/v.total_net_amount)).round(2),_results.push($scope.categories.push(v));return _results},$scope.show_category_report=function(){return reportService.pie("#sale-category-report",$scope.categories,{series:{pie:{combine:{threshold:.03,label:"Other Categories(less than 3% each)"}}}})},$scope.print=function(){var category_id;return category_id=$scope.showing_category?$scope.showing_category.id||"other":"",$window.open("/reports/sales.pdf?"+$.param({from:$scope.query.from,to:$scope.query.to,category_id:category_id}))},$scope.open_item=function(item){return item.stock_id?$location.path("/stocks/"+item.stock_id):void 0},$scope.sort_categories=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.categories=$scope.categories.sortBy(attribute,"desc"===$scope.order)},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.data.data=$scope.data.data.sortBy(attribute,"desc"===$scope.order)},$scope.average_cost=function(item){return(item.total_cost/(item.quantity-item["return"])).round(2)},$scope.average_sell=function(item){return(item.total_net_amount/(item.quantity-item["return"])).round(2)},$scope.average_profit=function(item){return(item.profit_margin/(item.quantity-item["return"])).round(2)},$scope.filter_report()}}.call(this),function(){this.StockValueReportController=function($scope,$routeParams,$filter,$window,reportService,reportsNavService,spinnerService,Report){return $scope.filter_report=function(){var params;return spinnerService.start_spinner("#report-spinner"),params={},$scope.include_negative_quantity&&(params.include_negative_quantity=!0),$scope.category&&(params.category_id=$scope.category.id),$scope.reports=Report.stock_value(params,function(data){return $scope.data||($scope.data={}),angular.copy(data,$scope.data),reportService.pie("#stock-value-report",data.data,{series:{pie:{combine:{threshold:.03,label:"Other(less than 3% each)"}}}}),spinnerService.stop_spinner("#report-spinner")})},$scope.show_category=function(category){return $scope.category=category},$scope.show_summary=function(){return $scope.category=void 0},$scope.goto_category=function(category){return category.id?$window.open("#/stock_categories/"+category.id):alert("Other are stocks without a category")},$scope.goto_stock=function(stock){return $window.open("#/stocks/"+stock.id)},$scope.download=function(){var params;return params={include_negative_quantity:$scope.include_negative_quantity},$scope.category&&(params.category_id=$scope.category.id),window.open("/reports/stock_value/download?"+$.param(params))},reportsNavService.activate("Stock Value Report"),$scope.include_negative_quantity=!0,$scope.filter_report()}}.call(this),function(){this.SuppliersReportController=function($scope,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){return reportsNavService.activate("Supplier Statements"),$scope.filter_report=function(){return spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.suppliers(function(data){var graph;return $scope.data||($scope.data={}),angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner"),graph=[{label:"Due",data:data.total_overdue_amount},{label:"Remaining",data:data.total_payable_amount-data.total_overdue_amount}],reportService.pie("#suppliers-report",graph)})},$scope.download=function(){return window.open("/reports/suppliers/download")},$scope.filter_report()}}.call(this),function(){this.WipInvoiceReportController=function($scope,$location,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){return reportsNavService.activate("Work In Progress Invoices Report"),$scope.open=function(item){return item.job_number?$window.open("#/jobs/"+item.job_id):$window.open("#/invoices/"+item.id)},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.data.data=$scope.data.data.sortBy(attribute,"desc"===$scope.order)},$scope.filter_report=function(){var params;return params={},params.order=$scope.order,params.order_by=$scope.order_by,spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.wip_invoice(params,function(data){return $scope.data||($scope.data={}),angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner")})},$scope.print=function(){var params;return params={},params.order=$scope.order,params.order_by=$scope.order_by,$window.open("/reports/wip_invoice.pdf?"+$.param(params))},$scope.filter_report()}}.call(this),function(){this.WipReportController=function($scope,$location,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){return reportsNavService.activate("Work In Progress Jobs Report"),$scope.open=function(item){return item.job_number?$window.open("#/jobs/"+item.job_id):$window.open("#/invoices/"+item.id)},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.data.data=$scope.data.data.sortBy(attribute,"desc"===$scope.order)},$scope.filter_report=function(){var params;return params={},params.order=$scope.order,params.order_by=$scope.order_by,params.date=$scope.date,spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.wip(params,function(data){return $scope.data||($scope.data={}),angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner")})},$scope.print=function(){var params;return params={},params.order=$scope.order,params.order_by=$scope.order_by,params.date=$scope.date,$window.open("/reports/wip.pdf?"+$.param(params))},$scope.download=function(){var params;return params={},params.order=$scope.order,params.order_by=$scope.order_by,params.date=$scope.date,$window.open("/reports/wip/download?"+$.param(params))},$scope.date=new Date,$scope.filter_report()}}.call(this),function(){this.WorkshopEfficiencyReportController=function($scope,$location,$window,$routeParams,$filter,reportService,reportsNavService,spinnerService,Report){var one_months_ago,today;return reportsNavService.activate("Workshop Efficiency Report"),today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.query={from:one_months_ago.toDate(),to:today.toDate()},$scope.order_by="name",$scope.filter_report=function(){var params;return params={},$scope.query.from&&(params.from=$scope.query.from),$scope.query.to&&(params.to=$scope.query.to),params.order=$scope.order,params.order_by=$scope.order_by,$scope.employee&&(params.employee_id=$scope.employee.id),spinnerService.start_spinner("#report-spinner"),$scope.reports=Report.workshop_efficiency(params,function(data){return $scope.data||($scope.data={}),angular.copy(data,$scope.data),spinnerService.stop_spinner("#report-spinner")})},$scope.print=function(){return $window.open("/reports/workshop_efficiency.pdf?"+$.param({from:$scope.query.from,to:$scope.query.to}))},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.data.data=$scope.data.data.sortBy(attribute,"desc"===$scope.order)},$scope.percentage=function(employee){return employee.total_hours&&employee.total_effective_charge_out_hours?""+(100*(employee.total_effective_charge_out_hours/employee.total_hours)).round(2)+"%":"N/A"},$scope.open_employee=function(employee){return $scope.employee=employee,$scope.filter_report()},$scope.summary=function(){return $scope.employee=void 0,$scope.filter_report()},$scope.open_wh=function(wh){return $window.open("#/jobs/"+wh.job_id)},$scope.filter_report()}}.call(this),function(){this.RoyaltyIntegrationAccountsController=function($scope,$window,$route,lookupService,integrationsNavService,spinnerService,formService,AutoWorkshop,RoyaltyIntegrationAccount){return $scope.edit_account=function(account){return formService.edit_fields(account,"editing")},$scope.save=function(account){return account.id?RoyaltyIntegrationAccount.update(account.editing,function(data){return angular.copy(data,account),lookupService.fetch_royalty_integration_accounts()}):RoyaltyIntegrationAccount.save(account.editing,function(data){return angular.copy(data,account),lookupService.fetch_royalty_integration_accounts()})},$scope.cancel=function(account){return account.editing=void 0},$scope.fetch_accounts=function(){return RoyaltyIntegrationAccount.ams(function(data){return data.id?($scope.ams_account=data,lookupService.set_vehicle_look_up_integration_account(data)):void 0})},integrationsNavService.activate("Royalty Membership Integrations"),$scope.ams_account={type:"AmsAccount",discount_percentage:5,name:"AMS Rewards"},$scope.fetch_accounts(),$scope.ams_auto_club_options=[{name:"NRMA",code:"NRMA"},{name:"RACV",code:"RACV"},{name:"RACQ",code:"RACQ"},{name:"RAA",code:"RAA"},{name:"RAC",code:"RAC"},{name:"RACT",code:"RACT"},{name:"AANT",code:"AANT"}]}}.call(this),function(){this.AutoWorkshopApp.service("serviceScheduleNavService",function(navbarService){var _this=this;return this.active="Current Job",{activate:function(activate,title){return _this.active=activate,title||(title=activate),navbarService.activate("Service Schedules",title)},active:function(){return _this.active}}}),this.ServiceScheduleNavController=function($scope,timeService,lookupService,serviceScheduleNavService){return $scope.links=[{name:"Overdue Services",href:"#/service_schedules/overdue_services",icon:"icon-warning-sign"},{name:"Upcoming Services",href:"#/service_schedules/upcoming_services",icon:"icon-calendar-empty"}],lookupService.asset_property_set()&&lookupService.asset_property_set().registration_due_date&&($scope.links.push([{name:"Registration Overdues",href:"#/service_schedules/overdue_registrations",icon:"icon-warning-sign"},{name:"Registration Upcomings",href:"#/service_schedules/upcoming_registrations",icon:"icon-calendar-empty"}]),$scope.links=$scope.links.flatten()),lookupService.configurations()&&!lookupService.configurations().no_wof&&timeService.timeout(function(){return $scope.links.push([{name:""+lookupService.wof_name()+" Overdues",href:"#/service_schedules/wof_overdue_services",icon:"icon-warning-sign"},{name:""+lookupService.wof_name()+" Upcomings",href:"#/service_schedules/wof_upcoming_services",icon:"icon-calendar-empty"}]),$scope.links=$scope.links.flatten()}),$scope.active=function(){return serviceScheduleNavService.active()},$scope.isActive=function(name){return name===$scope.active()?"active":""}}}.call(this),function(){this.OverdueRegistrationsController=function($scope,spinnerService,formService,serviceScheduleNavService,lookupService,$routeParams,$window,CustomerCommunicationType,CustomerCommunication,ServiceSchedule,Customer,timeService){return $scope.search=function(page_number){return null==page_number&&(page_number=1),$scope.query.page=page_number,$scope.query.per_page=45,angular.copy($scope.query,$scope.current_criteria),spinnerService.start_spinner("#service-schedule-spinner"),ServiceSchedule.registration_overdue($scope.query,function(data){return spinnerService.stop_spinner("#service-schedule-spinner"),$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.service_schedules=data.service_schedules
})},$scope.service_reminder_created=function(){return $scope.customer_communications.unshift($scope.customer_communication),$scope.customer_communication={},$scope.search($scope.current_criteria.page),$scope.selected_service_schedule_ids=[],$scope.sending=!0,timeService.timeout(function(){return $scope.sending=!1,$scope.search($scope.current_criteria.page)},5e3)},$scope.show_send_service_reminder_popover=function(){return 0===$scope.selected_service_schedule_ids.length?alert("Please make at least one selection"):$scope.showing_service_reminder_dialog=!0},$scope.selectPage=function(number){return $scope.search(number)},$scope.print=function(){return $window.open("/service_schedules/registration_overdue.pdf?"+jQuery.param($scope.query))},$scope.download=function(){return $scope.query.type="registration_overdue",$window.open("/service_schedules/download.xls?"+jQuery.param($scope.query))},serviceScheduleNavService.activate("Registration Overdues"),$scope.customer_communication_type=CustomerCommunicationType.registration_reminder(function(){return $scope.customer_communication_type.delivery_method="email_then_sms"}),$scope.query={},$scope.current_criteria={},$scope.selected_service_schedule_ids=[],$scope.customer_communication={},$scope.customer_communications=[],$scope.pulled=!1,$scope.search()}}.call(this),function(){this.OverdueServicesController=function($scope,spinnerService,formService,serviceScheduleNavService,$routeParams,$window,CustomerCommunicationType,CustomerCommunication,ServiceSchedule,Customer,timeService){return $scope.search=function(page_number){return null==page_number&&(page_number=$scope.page_number),$scope.query.page=page_number,$scope.query.per_page=45,angular.copy($scope.query,$scope.current_criteria),spinnerService.start_spinner("#service-schedule-spinner"),ServiceSchedule.overdue($scope.query,function(data){return spinnerService.stop_spinner("#service-schedule-spinner"),$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.service_schedules=data.service_schedules})},$scope.service_reminder_created=function(){return $scope.customer_communications.unshift($scope.customer_communication),$scope.customer_communication={},$scope.search($scope.current_criteria.page),$scope.selected_service_schedule_ids=[],$scope.sending=!0,timeService.timeout(function(){return $scope.sending=!1,$scope.search($scope.current_criteria.page)},5e3)},$scope.show_send_service_reminder_popover=function(){return 0===$scope.selected_service_schedule_ids.length?alert("Please make at least one selection"):$scope.showing_service_reminder_dialog=!0},$scope.selectPage=function(number){return $scope.search(number)},$scope.print=function(){return $window.open("/service_schedules/overdue.pdf?"+jQuery.param($scope.query))},$scope.download=function(){return $scope.query.type="overdue",$window.open("/service_schedules/download.xls?"+jQuery.param($scope.query))},$scope.page_number=1,serviceScheduleNavService.activate("Overdue Services"),$scope.customer_communication_type=CustomerCommunicationType.service_reminder(function(){return $scope.customer_communication_type.delivery_method="email_then_sms"}),$scope.query={},$scope.current_criteria={},$scope.selected_service_schedule_ids=[],$scope.customer_communication={},$scope.customer_communications=[],$scope.search()}}.call(this),function(){this.UpcomingRegistrationsController=function($scope,spinnerService,formService,serviceScheduleNavService,lookupService,$routeParams,$window,CustomerCommunicationType,CustomerCommunication,ServiceSchedule,Customer,timeService){return $scope.search=function(page_number){return null==page_number&&(page_number=1),$scope.query.page=page_number,$scope.query.per_page=45,angular.copy($scope.query,$scope.current_criteria),spinnerService.start_spinner("#service-schedule-spinner"),ServiceSchedule.registration_upcomings($scope.query,function(data){return spinnerService.stop_spinner("#service-schedule-spinner"),$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.service_schedules=data.service_schedules})},$scope.service_reminder_created=function(){return $scope.customer_communications.unshift($scope.customer_communication),$scope.customer_communication={},$scope.search($scope.current_criteria.page),$scope.selected_service_schedule_ids=[],$scope.sending=!0,timeService.timeout(function(){return $scope.sending=!1,$scope.search($scope.current_criteria.page)},5e3)},$scope.show_send_service_reminder_popover=function(){return 0===$scope.selected_service_schedule_ids.length?alert("Please make at least one selection"):$scope.showing_service_reminder_dialog=!0},$scope.selectPage=function(number){return $scope.search(number)},$scope.print=function(){return $window.open("/service_schedules/registration_upcomings.pdf?"+jQuery.param($scope.query))},$scope.download=function(){return $scope.query.type="registration_upcomings",$window.open("/service_schedules/download.xls?"+jQuery.param($scope.query))},serviceScheduleNavService.activate("Registration Upcomings"),$scope.customer_communication_type=CustomerCommunicationType.registration_reminder(function(){return $scope.customer_communication_type.delivery_method="email_then_sms"}),$scope.query={},$scope.current_criteria={},$scope.selected_service_schedule_ids=[],$scope.customer_communication={},$scope.customer_communications=[],$scope.pulled=!1,$scope.search()}}.call(this),function(){this.UpcomingServicesController=function($scope,formService,spinnerService,serviceScheduleNavService,$routeParams,$window,CustomerCommunicationType,CustomerCommunication,ServiceSchedule,Customer,timeService){return $scope.search=function(page_number){return null==page_number&&(page_number=$scope.page_number),$scope.query.page=page_number,$scope.query.per_page=45,angular.copy($scope.query,$scope.current_criteria),spinnerService.start_spinner("#service-schedule-spinner"),ServiceSchedule.upcomings($scope.query,function(data){return spinnerService.stop_spinner("#service-schedule-spinner"),$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.service_schedules=data.service_schedules})},$scope.service_reminder_created=function(){return $scope.customer_communications.unshift($scope.customer_communication),$scope.customer_communication={},$scope.search($scope.current_criteria.page),$scope.selected_service_schedule_ids=[],$scope.sending=!0,timeService.timeout(function(){return $scope.sending=!1,$scope.search($scope.current_criteria.page)},5e3)},$scope.show_send_service_reminder_popover=function(){return 0===$scope.selected_service_schedule_ids.length?alert("Please make at least one selection"):$scope.showing_service_reminder_dialog=!0},$scope.selectPage=function(number){return $scope.search(number)},$scope.print=function(){return $window.open("/service_schedules/upcomings.pdf?"+jQuery.param($scope.query))},$scope.download=function(){return $scope.query.type="upcomings",$window.open("/service_schedules/download.xls?"+jQuery.param($scope.query))},$scope.page_number=1,serviceScheduleNavService.activate("Upcoming Services"),$scope.customer_communication_type=CustomerCommunicationType.service_reminder(function(){return $scope.customer_communication_type.delivery_method="email_then_sms"}),$scope.query={},$scope.current_criteria={},$scope.selected_service_schedule_ids=[],$scope.customer_communication={},$scope.customer_communications=[],$scope.search()}}.call(this),function(){this.WofOverdueServicesController=function($scope,spinnerService,formService,serviceScheduleNavService,lookupService,$routeParams,$window,CustomerCommunicationType,CustomerCommunication,ServiceSchedule,Customer,timeService){return $scope.search=function(page_number){return null==page_number&&(page_number=1),$scope.query.page=page_number,$scope.query.per_page=45,angular.copy($scope.query,$scope.current_criteria),spinnerService.start_spinner("#service-schedule-spinner"),ServiceSchedule.wof_overdue($scope.query,function(data){return spinnerService.stop_spinner("#service-schedule-spinner"),$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.service_schedules=data.service_schedules})},$scope.service_reminder_created=function(){return $scope.customer_communications.unshift($scope.customer_communication),$scope.customer_communication={},$scope.search($scope.current_criteria.page),$scope.selected_service_schedule_ids=[],$scope.sending=!0,timeService.timeout(function(){return $scope.sending=!1,$scope.search($scope.current_criteria.page)},5e3)},$scope.show_send_service_reminder_popover=function(){return 0===$scope.selected_service_schedule_ids.length?alert("Please make at least one selection"):$scope.showing_service_reminder_dialog=!0},$scope.selectPage=function(number){return $scope.search(number)},$scope.print=function(){return $window.open("/service_schedules/wof_overdue.pdf?"+jQuery.param($scope.query))},$scope.download=function(){return $scope.query.type="wof_overdue",$window.open("/service_schedules/download.xls?"+jQuery.param($scope.query))},serviceScheduleNavService.activate(""+lookupService.wof_name()+" Overdues"),$scope.customer_communication_type=CustomerCommunicationType.wof_reminder(function(){return $scope.customer_communication_type.delivery_method="email_then_sms"}),$scope.query={},$scope.current_criteria={},$scope.selected_service_schedule_ids=[],$scope.customer_communication={},$scope.customer_communications=[],$scope.pulled=!1,$scope.search()}}.call(this),function(){this.WofUpcomingServicesController=function($scope,spinnerService,formService,serviceScheduleNavService,lookupService,$routeParams,$window,CustomerCommunicationType,CustomerCommunication,ServiceSchedule,Customer,timeService){return $scope.search=function(page_number){return null==page_number&&(page_number=1),$scope.query.page=page_number,$scope.query.per_page=45,angular.copy($scope.query,$scope.current_criteria),spinnerService.start_spinner("#service-schedule-spinner"),ServiceSchedule.wof_upcomings($scope.query,function(data){return spinnerService.stop_spinner("#service-schedule-spinner"),$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.service_schedules=data.service_schedules})},$scope.service_reminder_created=function(){return $scope.customer_communications.unshift($scope.customer_communication),$scope.customer_communication={},$scope.search($scope.current_criteria.page),$scope.selected_service_schedule_ids=[],$scope.sending=!0,timeService.timeout(function(){return $scope.sending=!1,$scope.search($scope.current_criteria.page)},5e3)},$scope.show_send_service_reminder_popover=function(){return 0===$scope.selected_service_schedule_ids.length?alert("Please make at least one selection"):$scope.showing_service_reminder_dialog=!0},$scope.selectPage=function(number){return $scope.search(number)},$scope.print=function(){return $window.open("/service_schedules/wof_upcomings.pdf?"+jQuery.param($scope.query))},$scope.download=function(){return $scope.query.type="wof_upcomings",$window.open("/service_schedules/download.xls?"+jQuery.param($scope.query))},serviceScheduleNavService.activate(""+lookupService.wof_name()+" Upcomings"),$scope.customer_communication_type=CustomerCommunicationType.wof_reminder(function(){return $scope.customer_communication_type.delivery_method="email_then_sms"}),$scope.query={},$scope.current_criteria={},$scope.selected_service_schedule_ids=[],$scope.customer_communication={},$scope.customer_communications=[],$scope.pulled=!1,$scope.search()}}.call(this),function(){this.ShowStockCategoryController=function($scope,$timeout,timeService,$routeParams,lookupService,inventoryNavService,spinnerService,formService,StockCategory,Stock){return $scope.tags=function(){return lookupService.tags_of_type("Stock")},$scope.edit_stock_category=function(){var copy;return copy={},angular.copy($scope.stock_category,copy),$scope.stock_category.editing=copy},$scope.cancel_edit_stock_category=function(){return $scope.stock_category.editing=void 0},$scope.save_stock_category=function(){var updated;return updated=new StockCategory($scope.stock_category.editing),updated.$update(function(data){return lookupService.fetch_stock_categories(),angular.copy(data,$scope.stock_category)})},$scope.do_delete_stock_category=function(){return StockCategory["delete"]({id:$scope.stock_category.id,stocks_new_category_id:$scope.deleted_to,stocks_decision:$scope.stocks_decision},function(){return lookupService.fetch_stock_categories(),$scope.showing_delete_stock_category_dialog=!1,timeService.timeout(function(){return $scope.back()},200)})},$scope.fetch_stocks=function(page){var params;return null==page&&(page=1),params={page:page,per_page:200,order_by:$scope.order_by||"stock_number",order:$scope.order||"asc",query:{stock_category_id:$routeParams.id}},$scope.tag&&$scope.tag.length>0&&(params.query.tag=$scope.tag),spinnerService.start_spinner("#stock-category-stock-list-spinner"),Stock.all(formService.params(params),function(data){return spinnerService.stop_spinner("#stock-category-stock-list-spinner"),$scope.stocks=data.stocks,$scope.total_pages=data.meta.total_pages,$scope.page_number=data.meta.page})},$scope.delete_stock_category=function(){return $scope.showing_delete_stock_category_dialog=!0,$scope.deleted_to=void 0,$scope.stocks_decision="reset"},$scope.cancel_delete_stock_category=function(){return $scope.showing_delete_stock_category_dialog=!1},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.fetch_stocks()},inventoryNavService.activate("Stock Categories"),$scope.stock_category=StockCategory.get({id:$routeParams.id}),$scope.stock_categories=lookupService.stock_categories(),$scope.fetch_stocks()}}.call(this),function(){this.StockCategoriesController=function($scope,$routeParams,$location,formService,lookupService,inventoryNavService,StockCategory){return inventoryNavService.activate("Stock Categories"),$scope.stock_categories=lookupService.stock_categories(),$scope.create_stock_category=function(){return $scope.new_stock_category=new StockCategory,formService.select_text("#create-stock-category-name")},$scope.cancel_create_stock_category=function(){return $scope.new_stock_category=void 0},$scope.save_new_stock_category=function(){return StockCategory.save($scope.new_stock_category,function(data){return lookupService.stock_categories().push(data),$scope.new_stock_category=void 0})}}}.call(this),function(){this.KitsController=function($scope,$routeParams,$location,spinnerService,inventoryNavService,formService,Stock){return $scope.search=function(page){return null==page&&(page=1),spinnerService.start_spinner("#stock-list-spinner"),Stock.kits(function(data){return $scope.stocks=data,spinnerService.stop_spinner("#stock-list-spinner")})},inventoryNavService.activate("Kits"),$scope.search()}}.call(this),function(){this.NewStockController=function($scope,$routeParams,$location,spinnerService,inventoryNavService,lookupService,formService,$filter,Stock){return inventoryNavService.activate("Stocks"),$scope.stock||($scope.stock={with_gst:{}}),$routeParams.category_id&&($scope.stock.stock_category_id=parseInt($routeParams.category_id)),$routeParams.is_kit&&($scope.stock.is_kit=!0),$scope.save_stock=function(){return spinnerService.start_spinner("#saving-stock"),Stock.save($scope.stock,function(data){return spinnerService.stop_spinner("#saving-stock"),angular.copy(data,$scope.stock),data.errors?void 0:(lookupService.fetch_invoice_items(),$routeParams.category_id?$location.path("/stock_categories/"+$routeParams.category_id):$scope.back())})},$scope.cancel=function(){return $scope.back()},formService.focus("#stock-number-input")}}.call(this),function(){this.ShowStockController=function($scope,$routeParams,formService,permissionService,popoverService,lookupService,inventoryNavService,spinnerService,$filter,Stock,Supplier,StockSupplier){return $scope.enable_stock_alert=function(){return permissionService.check_update_inventory_restriction_before_proceed(function(){return $scope.stock.$update({stock_alert:!0},function(){return $scope.stock.stock_alert=!0})})},$scope.disable_stock_alert=function(){return permissionService.check_update_inventory_restriction_before_proceed(function(){return $scope.stock.$update({stock_alert:!1},function(){return $scope.stock.stock_alert=!1})})},$scope.edit_stock_alert=function(){return permissionService.check_update_inventory_restriction_before_proceed(function(){return $scope.stock_alert={id:$scope.stock.id,alert_quantity:$scope.stock.alert_quantity,maximum_quantity:$scope.stock.maximum_quantity,reorder_point:$scope.stock.reorder_point}})},$scope.cancel_edit_stock_alert=function(){return $scope.stock_alert=void 0},$scope.preferred_supplier=function(stock_supplier){return $scope.stock_suppliers?stock_supplier===$scope.stock_suppliers[0]:void 0},$scope.save_stock_alert=function(){return Stock.update($scope.stock_alert,function(data){return angular.copy(data,$scope.stock),$scope.stock_alert=void 0})},$scope.create_stock_supplier=function(){return permissionService.check_update_inventory_restriction_before_proceed(function(){return $scope.new_stock_supplier=new StockSupplier({stock_id:$scope.stock.id})})},$scope.delete_stock_supplier=function(stock_supplier){return StockSupplier["delete"]({id:stock_supplier.id},function(){return $scope.stock_suppliers.remove(stock_supplier)})},$scope.cancel_create_stock_supplier=function(){return $scope.new_stock_supplier=void 0},$scope.save_new_stock_supplier=function(){return $scope.new_stock_supplier.supplier_id?$scope.new_stock_supplier.$save(function(){return $scope.stock_suppliers.push($scope.new_stock_supplier),$scope.new_stock_supplier=void 0}):alert("Please select a supplier or click New to create one")},$scope.edit_stock_supplier=function(stock_supplier){return permissionService.check_update_inventory_restriction_before_proceed(function(){var copy;return copy={},angular.copy(stock_supplier,copy),stock_supplier.editing=copy})},$scope.cancel_edit_stock_supplier=function(stock_supplier){return stock_supplier.editing=void 0},$scope.save_stock_supplier=function(stock_supplier){var updated;return updated=new StockSupplier(stock_supplier.editing),updated.$update(function(data){return angular.copy(data,stock_supplier),stock_supplier.editing=void 0})},$scope.delete_stock=function(){return permissionService.check_update_inventory_restriction_before_proceed(function(){return $scope.showing_delete_stock_dialog=!0})},$scope.do_delete_stock=function(){return Stock["delete"]({id:$scope.stock.id,deleted_reason:$scope.deleted_reason},function(data){return lookupService.fetch_invoice_items(),angular.copy(data,$scope.stock),$scope.showing_delete_stock_dialog=!1})},$scope.cancel_delete_stock=function(){return $scope.showing_delete_stock_dialog=!1},$scope.price_with_gst=function(attribute){return $scope.stock.editing[attribute]?$scope.stock.editing.with_gst[attribute]=$scope.stock.editing[attribute]*(1+$scope.tax_rate):void 0},$scope.price_without_gst=function(attribute){return $scope.stock.editing.with_gst[attribute]?$scope.stock.editing[attribute]=$scope.stock.editing.with_gst[attribute]/(1+$scope.tax_rate):void 0},$scope.edit_accounting_accounts=function(){return permissionService.check_update_inventory_restriction_before_proceed(function(){return formService.edit_fields($scope.stock,"editing_accounts","id","purchase_account_id","sale_account_id","inventory_asset_account_id")})},$scope.cancel_edit_accounting_accounts=function(){return $scope.stock.editing_accounts=void 0},$scope.save_accounting_accounts=function(){return Stock.update($scope.stock.editing_accounts,function(data){return angular.copy(data,$scope.stock)})},$scope.merge_stock=function(){return permissionService.check_update_inventory_restriction_before_proceed(function(){return $scope.merging=!1,popoverService.show("#merge-stock-popover","#merge-stock-button",{placement:"left"})})},$scope.merge=function(){if($scope.selected_stock){if($scope.selected_stock.stock_id===$scope.stock.id)return $scope.selected_supplier=null,alert("Please select different stock from the current one (Stock Number "+$scope.stock.stock_number+") to merge");if(spinnerService.start_spinner("#merge-stock-spinner"),$scope.merging)return;return $scope.merging=!0,Stock.merge({id:$scope.stock.id,stock_id:$scope.selected_stock.stock_id},function(data){return $scope.merging=!1,spinnerService.stop_spinner("#merge-stock-spinner"),angular.copy(data,$scope.stock),$scope.hide_merge()})}return alert("Please select a stock to merge to")},$scope.hide_merge=function(){return popoverService.hide("#merge-stock-popover")},$scope.show_left_side=function(panel){return $scope.left_side=panel},$scope.show_history_side=function(panel){return $scope.history_side=panel},$scope.component_cost=function(component){return component.stock.average_buy_price?(component.stock.average_buy_price*component.quantity).round(2):0},$scope.total_component_cost=function(){var total;return total=0,$scope.stock&&$scope.stock.components&&$scope.stock.components.forEach(function(c){return total+=$scope.component_cost(c)}),total},$scope.add_component=function(){return permissionService.check_update_inventory_restriction_before_proceed(function(){return $scope.new_component={},formService.focus("#new-component-stock")})},$scope.cancel_new_component=function(){return $scope.new_component=void 0},$scope.create_component=function(){return permissionService.check_update_inventory_restriction_before_proceed(function(){return spinnerService.start_spinner("#new-component-spinner"),Stock.new_component({id:$scope.stock.id,component:$scope.new_component},function(data){return spinnerService.stop_spinner("#new-component-spinner"),angular.copy(data,$scope.stock),$scope.new_component=void 0,formService.focus("#new-component-button")})})},$scope.update_component=function(component){return permissionService.check_update_inventory_restriction_before_proceed(function(){return spinnerService.start_spinner("#edit-component-spinner-"+component.id),Stock.update_component({id:$scope.stock.id,component:component.editing},function(data){return spinnerService.stop_spinner("#edit-component-spinner-"+component.id),angular.copy(data,$scope.stock)})})},$scope.open_build=function(){return permissionService.check_update_inventory_restriction_before_proceed(function(){return popoverService.show("#build-kit-popover","#build-kit-button",{placement:"left"}),formService.select_text("#build-quantity-input"),$scope.build_quantity=1})},$scope.cancel_build=function(){return popoverService.hide("#build-kit-popover"),$scope.build_quantity=void 0},$scope.build=function(){return spinnerService.start_spinner("#build-kit-spinner"),Stock.build({id:$scope.stock.id,quantity:$scope.build_quantity},function(data){return spinnerService.stop_spinner("#build-kit-spinner"),angular.copy(data,$scope.stock),popoverService.hide("#build-kit-popover")})},$scope.delete_component=function(component){return permissionService.check_update_inventory_restriction_before_proceed(function(){return spinnerService.start_spinner("#edit-component-spinner-"+component.id),Stock.delete_component({id:$scope.stock.id,component:component.editing},function(data){return spinnerService.stop_spinner("#edit-component-spinner-"+component.id),angular.copy(data,$scope.stock)})})},$scope.edit_component=function(component){return formService.edit_fields(component,"editing")},$scope.cancel_edit_component=function(component){return component.editing=void 0},$scope.supplier_sortable_options={handle:".dragable-handle",helper:"clone",stop:function(){return $scope.reorder_suppliers()}},$scope.reorder_suppliers=function(){return Stock.reorder_suppliers({id:$scope.stock.id,stock_suppliers:$scope.stock_suppliers},function(){return $scope.fetch_stock_suppliers()})},$scope.reorder_components=function(){return Stock.reorder_components({id:$scope.stock.id,components:$scope.stock.components},function(data){return angular.copy(data,$scope.stock)})},$scope.fetch_change_logs=function(page){return null==page&&(page=1),$routeParams.id?Stock.change_logs({id:$routeParams.id,page:page},function(data){return $scope.change_logs=data}):void 0},$scope.fetch_stock_suppliers=function(page){return null==page&&(page=1),spinnerService.start_spinner("#stock-suppliers-spinner"),$routeParams.id?StockSupplier.all({stock_id:$routeParams.id},function(data){return spinnerService.stop_spinner("#stock-suppliers-spinner"),$scope.stock_suppliers=data}):void 0},$scope.adjust_stock_quantity=function(){return formService.edit_fields($scope.stock,"editing_quantity","id","quantity"),popoverService.show("#adjust-quantity-popover","#create-adjustment-button",{placement:"right"})},$scope.hide_adjust_stock_quantity=function(){return popoverService.hide("#adjust-quantity-popover")},$scope.save_stock_quantity=function(){return spinnerService.start_spinner("#adjust-quantity-spinner"),Stock.update($scope.stock.editing_quantity,function(data){return spinnerService.stop_spinner("#adjust-quantity-spinner"),angular.copy(data,$scope.stock),$scope.hide_adjust_stock_quantity(),$scope.fetch_change_logs()})},$scope.transferable=function(){return lookupService.session()&&lookupService.session().related_auto_workshops&&lookupService.session().related_auto_workshops.length>0},$scope.related_auto_workshops=function(){return lookupService.session()&&lookupService.session().related_auto_workshops?lookupService.session().related_auto_workshops:[]},$scope.transfer_stock=function(){return $scope.transfer_data={id:$scope.stock.id,date:new Date},popoverService.show("#transfer-popover","#transfer-stock-button",{placement:"left"}),spinnerService.start_spinner("#business-stock-spinner"),Stock.business_stocks({stock_number:$scope.stock.stock_number},function(data){return spinnerService.stop_spinner("#business-stock-spinner"),angular.copy(data,$scope.business_stocks)})},$scope.cancel_transfer=function(){return popoverService.hide("#transfer-popover")},$scope.transfer=function(){return spinnerService.start_spinner("#transfer-spinner"),Stock.transfer($scope.transfer_data,function(data){return spinnerService.stop_spinner("#transfer-spinner"),data.error?alert(data.error):(angular.copy(data,$scope.stock),popoverService.hide("#transfer-popover"))})},inventoryNavService.activate("Stocks"),$scope.show_left_side("details"),$scope.show_history_side("purchase_history"),$scope.business_stocks=[],$scope.prices_include_gst=function(){return lookupService.configurations().prices_include_gst},$scope.tax_rate=lookupService.configurations().tax_rate,$scope.input_accounts=function(){return lookupService.input_accounts()},$scope.output_accounts=function(){return lookupService.output_accounts()},$scope.inventory_accounts=function(){return lookupService.inventory_accounts()},spinnerService.start_spinner("#stock-loading"),Stock.get({id:$routeParams.id},function(data){return $scope.stock=data,spinnerService.stop_spinner("#stock-loading"),data.id?($scope.fetch_change_logs(),$scope.fetch_stock_suppliers()):void 0}),$scope.stock_categories=lookupService.stock_categories(),$scope.stock_alert=void 0,$scope.component_sortable_options={handle:".dragable-handle",helper:"clone",stop:function(){return $scope.reorder_components()}}}}.call(this),function(){this.StocksController=function($scope,$routeParams,$location,spinnerService,popoverService,inventoryNavService,formService,timeService,lookupService,confirmationService,Stock,StockCategory,Purchase){var search_query;return $scope.search=function(page){var search_count,search_query;return null==page&&(page=1),spinnerService.start_spinner("#stock-list-spinner"),(!$scope.query.deleted||$scope.query.reorder)&&delete $scope.query.deleted,(!$scope.query.reorder||$scope.query.deleted)&&delete $scope.query.reorder,search_query={query:$scope.query,page:page,showing_deleted:$scope.showing_deleted,showing_reorder:$scope.showing_reorder,order:$scope.order,order_by:$scope.order_by,supplier_id:$scope.supplier_id},lookupService.save_search_query("stocks",search_query),$scope.search_count||($scope.search_count=0),$scope.search_count+=1,search_count=$scope.search_count,$scope.query.reorder?Stock.reorder({supplier_id:$scope.supplier_id},function(data){return search_count===$scope.search_count?($scope.stocks=data,spinnerService.stop_spinner("#stock-list-spinner")):void 0}):Stock.all(formService.params(search_query),function(data){return search_count===$scope.search_count?($scope.keyword=$scope.query.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.stocks=data.stocks,spinnerService.stop_spinner("#stock-list-spinner")):void 0})},$scope.toggle_select=function(stock){return $scope.selected_stocks||($scope.selected_stocks=[]),$scope.selected(stock)?(stock.selected=!1,$scope.selected_stocks.remove(stock),stock.order_quantity=void 0):(stock.selected=!0,$scope.selected_stocks.push(stock))},$scope.open_stock=function(stock){return $location.path("/stocks/"+stock.id)},$scope.add_selected_stocks=function(){var items;return $scope.new_purchase_order?(items=[],$scope.selected_stocks.forEach(function(s){return items.push({stock_id:s.id,quantity:s.order_quantity,unit_price:s.buy_price,description:""+s.stock_number+" - "+s.name})}),Purchase.new_items({id:$scope.new_purchase_order.id,purchase_items:items},function(data){return $scope.search(),$scope.send_purchase_order(data),$scope.selected_stocks=[]})):void 0},$scope.show_selection_preview=function(){var supplier;return 0===$scope.selected_stocks.length?alert("Please select stocks to reorder"):($scope.new_purchase_order={date:new Date},$scope.supplier_id&&(supplier=$scope.reorder_supplier,supplier&&($scope.new_purchase_order.supplier_id=supplier.id,$scope.new_purchase_order.supplier=supplier)),$scope.selected_stocks.forEach(function(s){return s.order_quantity&&0!==s.order_quantity?void 0:s.order_quantity=s.maximum_quantity-s.available_quantity}),popoverService.show("#stock-list-preview-popover","#selection-list",{placement:"left"}))},$scope.close_selection_preview=function(){return $scope.new_purchase_order=void 0,popoverService.hide("#stock-list-preview-popover")},$scope.selected=function(stock){var a;return a=$scope.selected_stocks.find(function(x){return x.id===stock.id})},$scope.cancel_add_purchase_order=function(){return $scope.new_purchase_order=void 0,popoverService.hide("#new-purchase-order-popover")},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.search()},$scope.toggle_deleted=function(number){return null==number&&(number=1),$scope.showing_reorder=!1,timeService.timeout(function(){return $scope.query.reorder=void 0,$scope.query.deleted=$scope.showing_deleted?!0:void 0,$scope.search()})},$scope.toggle_select_all=function(number){return null==number&&(number=1),timeService.timeout(function(){return $scope.all_selected?$scope.select_all():($scope.stocks.forEach(function(s){return s.selected=!1}),$scope.selected_stocks=[])})},$scope.select_all=function(){return $scope.selected_stocks=[],$scope.stocks.forEach(function(s){return $scope.selected_stocks.push(s),s.selected=!0})},$scope.toggle_reorder=function(number){return null==number&&(number=1),$scope.showing_deleted=!1,timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.reorder=$scope.showing_reorder?!0:void 0,$scope.search()})},$scope.reorder_all_supplier=function(){return $scope.reorder_supplier={},$scope.supplier_id=null,$scope.search()},$scope.send_purchase_order=function(purchase){return $scope.close_selection_preview(),$scope.sending_purchase=purchase},$scope.tags=function(){return lookupService.tags_of_type("Stock")},$scope.can_undelete_stock=function(){return lookupService.enable_undelete()&&lookupService.session().is_admin},$scope.undelete=function(stock){return confirmationService.confirm("Do you want to undelete this stock?",!0,function(){return Stock.undelete({id:stock.id},function(data){return $location.path("/stocks/"+data.id)})})},inventoryNavService.activate("Stocks"),search_query=lookupService.search_query("stocks"),search_query&&search_query.query&&$routeParams.cached?($scope.query=search_query.query,$scope.order=search_query.order||"asc",$scope.order_by=search_query.order_by||"stock_number",$scope.showing_deleted=search_query.showing_deleted,$scope.showing_reorder=search_query.showing_reorder,$scope.supplier_id=search_query.supplier_id,$scope.search(search_query.page||1)):($scope.query={query:null},lookupService.save_search_query("stocks",{query:{query:""}}),$location.path("/stocks").search({cached:Math.random()}).replace())}}.call(this),function(){this.NewStocktakeController=function($scope,$routeParams,$location,inventoryNavService,lookupService,$filter,Stocktake){var today;
return $scope.save_new_stocktake=function(){return Stocktake.save($scope.stocktake,function(data){return $location.path("/stocktakes/"+data.id)})},inventoryNavService.activate("Stock-takes"),today=moment(),$scope.stocktake={time:today,name:"Stocktake "+today.format("DD/MM/YYYY"),remaining_stocks_decision:"keep_system_quantity"}}}.call(this),function(){this.ShowStocktakeController=function($scope,$routeParams,$location,$timeout,inventoryNavService,lookupService,confirmationService,formService,popoverService,spinnerService,$filter,Stocktake){return $scope.save_new_stocktake_item=function(){return spinnerService.start_spinner("#new-stocktake-item-spinner"),Stocktake.new_item({id:$scope.stocktake.id,item:$scope.new_stocktake_item},function(data){return spinnerService.stop_spinner("#new-stocktake-item-spinner"),angular.copy(data,$scope.stocktake),$scope.new_stocktake_item={count:1,counted:!0},formService.focus("#new-stocktake-item input")})},$scope.finish_stocktake=function(){var uncounted;return uncounted=$scope.stocktake.stocktake_items.find(function(i){return!i.counted}),confirmationService.confirm("Warning: One more items are not counted. Proceed Anyway?",uncounted,function(){return popoverService.show("#finish-stocktake-popover","#finish-stocktake-button",{placement:"left"})})},$scope.cancel_add_stock_category=function(){return $scope.add_stock_category_id=void 0,$scope.adding_stock_category=!1},$scope.add_stock_category=function(){return $scope.add_stock_category_id?confirmationService.confirm("Add stocks from this category for this stocktake?",!0,function(){return spinnerService.start_spinner("#adding-stock-category"),Stocktake.add_stock_category({id:$scope.stocktake.id,stock_category:{id:$scope.add_stock_category_id}},function(data){return spinnerService.stop_spinner("#adding-stock-category"),$scope.add_stock_category_id=void 0,$scope.adding_stock_category=!1,angular.copy(data,$scope.stocktake)})}):alert("Please select a stock category to add")},$scope.cancel_add_location=function(){return $scope.add_location_id=void 0,$scope.adding_location=!1},$scope.add_location=function(){return $scope.add_location_id?confirmationService.confirm("Add stocks from this location for this stocktake?",!0,function(){return spinnerService.start_spinner("#adding-stock-category"),Stocktake.add_location({id:$scope.stocktake.id,location:$scope.add_location_id},function(data){return spinnerService.stop_spinner("#adding-stock-category"),$scope.add_location_id=void 0,$scope.adding_location=!1,angular.copy(data,$scope.stocktake)})}):alert("Please select a stock location to add")},$scope.do_finish=function(){return spinnerService.start_spinner("#finish-stocktake-spinner"),Stocktake.finish($scope.stocktake,function(data){return angular.copy(data,$scope.stocktake),spinnerService.stop_spinner("#finish-stocktake-spinner"),popoverService.hide("#finish-stocktake-popover")})},$scope.cancel_finish=function(){return popoverService.hide("#finish-stocktake-popover")},$scope.delete_stocktake=function(){return $scope.showing_delete_stocktake_dialog=!0},$scope.cancel_delete_stocktake=function(){return $scope.showing_delete_stocktake_dialog=!1},$scope.do_delete_stocktake=function(){return Stocktake["delete"]({id:$scope.stocktake.id},function(data){return angular.copy(data,$scope.stocktake),$scope.showing_delete_stocktake_dialog=!1})},$scope.save_item=function(item){var saving;return spinnerService.start_spinner("#stocktake-item-"+item.id+"-spinner","small"),$timeout.cancel(item.saving_schedule),saving=function(){return item.saving=!0,item.counted=!0,Stocktake.update_item({id:$scope.stocktake.id,item:item},function(){return item.saving=!1,spinnerService.stop_spinner("#stocktake-item-"+item.id+"-spinner")})},item.saving_schedule=$timeout(saving,500)},$scope.remove_item=function(item){return confirmationService.confirm("Remove this item?",!0,function(){return Stocktake.delete_item({id:$scope.stocktake.id,item:item},function(data){return angular.copy(data,$scope.stocktake)})})},inventoryNavService.activate("Stock-takes"),spinnerService.start_spinner("#stocktake-spinner"),Stocktake.get({id:$routeParams.id},function(data){return spinnerService.stop_spinner("#stocktake-spinner"),$scope.stocktake=data}),$scope.show_right_side=function(tab){return $scope.right_side=tab},$scope.new_stocktake_item={count:1,counted:!0},$scope.right_side="stocktake"}}.call(this),function(){this.StocktakesController=function($scope,$routeParams,$location,spinnerService,inventoryNavService,Stocktake){return inventoryNavService.activate("Stock-takes"),spinnerService.start_spinner("#stocktake-list-spinner"),Stocktake.all(function(data){return spinnerService.stop_spinner("#stocktake-list-spinner"),$scope.stocktakes=data})}}.call(this),function(){this.NewSupplierCreditNoteController=function($scope,$http,$location,$routeParams,lookupService,confirmationService,accountingNavService,spinnerService,Stock,Supplier,SupplierCreditNote){return accountingNavService.activate("Supplier Credit Notes"),$scope.input_accounts=lookupService.input_accounts(),$scope.credit_note={date:new Date},$scope.select_supplier=function(selected_supplier){return $scope.credit_note.supplier_id=selected_supplier.id,$scope.selected_supplier=selected_supplier},$scope.save_credit_note=function(){var no_amount,original_bill;return original_bill=$scope.credit_note.original_bill,original_bill&&!$scope.credit_note.supplier_id&&($scope.credit_note.supplier_id=original_bill.supplier_id),$scope.credit_note.supplier_id?(no_amount=!$scope.credit_note.total_amount||0===$scope.credit_note.total_amount,confirmationService.confirm("You have not enter the credit note total amount, are you sure you want to proceed?",no_amount,function(){return $scope.credit_note.errors=void 0,spinnerService.start_spinner("#new-supplier-credit-note-spinner"),SupplierCreditNote.save($scope.credit_note,function(data){return spinnerService.stop_spinner("#new-supplier-credit-note-spinner"),data.errors?angular.copy(data,$scope.credit_note):$location.path("/supplier_credit_notes/"+data.id).search({returning:!0})})})):alert("Please select a supplier")},$scope.$watch("credit_note.supplier_id",function(){return $scope.credit_note.supplier_id&&$scope.credit_note.supplier&&$scope.credit_note.supplier.creditor_id?$scope.credit_note.billing_supplier_id=$scope.credit_note.supplier.creditor_id:void 0})}}.call(this),function(){this.SupplierCreditNoteController=function($scope,$routeParams,$location,$window,formService,jobNavService,accountingNavService,lookupService,navbarService,permissionService,spinnerService,popoverService,confirmationService,timeService,SupplierCreditNote){return accountingNavService.activate("Supplier Credit Notes"),$scope.credit_note={},$scope.payment_methods=lookupService.payment_methods(),SupplierCreditNote.get({id:$routeParams.id},function(data){return angular.copy(data,$scope.credit_note),$routeParams.returning&&data.original_bill&&data.original_bill.id?$scope.add_item_from_bill():void 0}),$scope.selected_bills=[],$scope.accounting_integration=function(){return lookupService.configurations().accounting_integration},$scope.edit_bill_item_details=function(bill_item){return bill_item.edit_details=!0},$scope.bill_item_total=function(bill_item){return bill_item&&bill_item.quantity&&bill_item.unit_price?bill_item.quantity*bill_item.unit_price:0},$scope.add_bill_item=function(){return $scope.confirm_edit_finalized_credit_note(function(){return $scope.new_bill_item={description:"code/description",quantity:1,unit_price:0,included_gst:lookupService.configurations().prices_include_gst},formService.select_text("#new-credit-note-item-description")})},$scope.add_item_from_bill=function(){return popoverService.show("#return-item-selection","#add-bill-item-button",{placement:"left"})},$scope.close_add_item_from_bill=function(){return $scope.credit_note.original_bill.bill_items.forEach(function(item){return item.selected=!1,item.returning_quantity=void 0}),popoverService.hide("#return-item-selection")},$scope.toggle_item_from_bill=function(item){return item.selected===!0?(item.selected=!1,item.returning_quantity=void 0):(item.selected=!0,item.returning_quantity=item.quantity)},$scope.do_select_item_from_bill=function(){var items;return spinnerService.start_spinner("#returning-items-spinner"),items=[],$scope.credit_note.original_bill.bill_items.forEach(function(item){return item.selected&&item.returning_quantity>0?items.push({quantity:item.returning_quantity,unit_price:item.unit_price,stock_id:item.stock_id,description:item.description,included_gst:item.included_gst,gst_free:item.gst_free}):void 0}),SupplierCreditNote.new_items({id:$scope.credit_note.id,items:items},function(data){return angular.copy(data,$scope.credit_note),$scope.close_add_item_from_bill(),spinnerService.stop_spinner("#returning-items-spinner")})},$scope.edit_credit_note=function(){return $scope.confirm_edit_finalized_credit_note(function(){return formService.edit_fields($scope.credit_note,"editing","id","supplier_id","reference","date","total_amount","description","accounting_account_id","billing_supplier_id","original_bill","supplier","original_bill_id","tracking_categories")})},$scope.cancel_edit_credit_card=function(){return formService.cancel($scope.credit_note,"editing")},$scope.save_credit_note=function(){return SupplierCreditNote.update($scope.credit_note.editing,function(data){return data.errors?angular.copy(data,$scope.credit_note.editing):angular.copy(data,$scope.credit_note)})},$scope.close_supplier=function(){return popoverService.hide("#supplier")},$scope.show_supplier=function(){return $scope.goto("/suppliers/"+$scope.credit_note.supplier.id)},$scope.open_delete_dialog=function(){return $scope.showing_delete_credit_note_dialog=!0},$scope.cancel_delete_credit_note=function(){return $scope.showing_delete_credit_note_dialog=!1},$scope.do_delete_credit_note=function(){return SupplierCreditNote["delete"]({id:$scope.credit_note.id,deleted_reason:$scope.deleted_reason},function(data){return angular.copy(data,$scope.credit_note),$scope.showing_delete_credit_note_dialog=!1})},$scope.save_new_bill_item=function(){var saving_item;return lookupService.disable_arbitrary_line_items()&&!$scope.new_bill_item.stock_id?(alert("Please select an item from the dropdown or click 'Create Stock' button to create one"),void 0):($scope.credit_note=$scope.credit_note||{},saving_item=$scope.new_bill_item,$scope.credit_note.items.push(saving_item),$scope.new_bill_item=null,formService.focus("#add-item-button"),formService.submit_form($scope,$scope.new_bill_item_form,function(){return SupplierCreditNote.new_item({id:$scope.credit_note.id,item:saving_item},function(data){return angular.copy(data,$scope.credit_note)})}))},$scope.edit_bill_item=function(bill_item){return $scope.confirm_edit_finalized_credit_note(function(){return formService.edit_fields(bill_item,"editing")})},$scope.cancel_edit_bill_item=function(bill_item){return bill_item.editing=null},$scope.save_bill_item=function(form,bill_item){return formService.submit_form($scope,form,function(){return spinnerService.start_spinner("#credit-note-spinner"),SupplierCreditNote.update_item({id:$scope.credit_note.id,item:bill_item.editing},function(data){return spinnerService.stop_spinner("#credit-note-spinner"),angular.copy(data,$scope.credit_note)})})},$scope.remove_bill_item=function(bill_item){return spinnerService.start_spinner("#credit-note-spinner"),SupplierCreditNote.delete_item({id:$scope.credit_note.id,item:bill_item},function(data){return spinnerService.stop_spinner("#credit-note-spinner"),angular.copy(data,$scope.credit_note)})},$scope.cancel_add_bill_item=function(){return $scope.new_bill_item=null},$scope.show_bill_item_details=function(bill_item){return bill_item.show_details=!0},$scope.hide_bill_item_details=function(bill_item){return bill_item.show_details=!1},$scope.edit_credit_note_details=function(){return formService.edit_fields($scope.credit_note,"editing_details","id","details"),formService.select_text("#edit-credit_note-details")},$scope.save_credit_note_details=function(){return SupplierCreditNote.update($scope.credit_note.editing_details,function(data){return angular.copy(data,$scope.credit_note),$scope.job?$scope.job.maintenance_entry_content=data.details:void 0})},$scope.cancel_edit_credit_note_details=function(){return $scope.credit_note.editing_details=null},$scope.clear_credit_note_details=function(){return $scope.credit_note.editing_details.details="",SupplierCreditNote.update($scope.credit_note.editing_details,function(data){return angular.copy(data,$scope.credit_note),$scope.job?$scope.job.maintenance_entry_content="":void 0})},$scope.finalize=function(){return permissionService.check_finalize_documents_restriction_before_proceed(function(){return SupplierCreditNote.finalize({id:$scope.credit_note.id},function(data){return angular.copy(data,$scope.credit_note)})})},$scope.add_bills=function(){return $scope.showing_related_bills=!0},$scope.remove_bpayment=function(bpayment){return confirmationService.confirm("Are you sure you want to delete this allocation?",!0,function(){return SupplierCreditNote.remove_allocation({id:$scope.credit_note.id,allocation_id:bpayment.id},function(data){return angular.copy(data,$scope.credit_note)})})},$scope.save_selected_bills=function(){var allocations;return allocations=[],$scope.selected_bills.each(function(bill){return allocations.push({id:bill.id,amount:bill.allocated_amount})}),SupplierCreditNote.allocate_payments({id:$scope.credit_note.id,allocations:allocations},function(data){return angular.copy(data,$scope.credit_note),$scope.selected_bills=[],$scope.showing_related_bills=!1})},$scope.open_refund=function(){var cash_payment_method;return cash_payment_method=lookupService.payment_method("cash"),$scope.refund={id:$scope.credit_note.id,reference:"Credit Note "+$scope.credit_note.reference+" Refund",amount:$scope.credit_note.unallocated_amount,date:timeService.current(),payment_method_id:cash_payment_method?cash_payment_method.id:void 0},popoverService.show("#create-refund","#create-refund-button",{placement:"left"})},$scope.close_refund=function(){return $scope.refund.reference=void 0,popoverService.hide("#create-refund")},$scope.do_refund=function(){return $scope.refund.payment_method_id?SupplierCreditNote.refund($scope.refund,function(data){return angular.copy(data,$scope.credit_note),$scope.close_refund()}):alert("Please select a payment type")},$scope.bank_accounts=function(){return lookupService.bank_accounts()},$scope.show_select_bank_account=function(){var cash_payment_method;return $scope.refund&&$scope.refund.payment_method_id&&$scope.bank_accounts()&&(cash_payment_method=lookupService.payment_method("cash"),cash_payment_method&&$scope.bank_accounts().length>1)?$scope.refund.payment_method_id!==cash_payment_method.id:void 0},$scope.new_stock={with_gst:{}},$scope.select_new_stock=function(){var _base,_base1;return $scope.new_bill_item.stock_id=$scope.new_stock.id,(_base=$scope.new_bill_item).quantity||(_base.quantity=1),(_base1=$scope.new_bill_item).unit_price||(_base1.unit_price=$scope.new_stock.buy_price),$scope.new_bill_item.description=""+$scope.new_stock.stock_number+" - "+($scope.new_stock.name||""),$scope.new_bill_item.included_gst?void 0:$scope.new_bill_item.included_gst=$scope.new_stock.included_gst},$scope.edit_finalized_credit_note_warning=function(){var message,third_party;return third_party=$scope.accounting_integration(),message=third_party?"You're editing a credit note that has been finalized.\nAre you sure you want to proceed?.\n\nIMPORTANT! Editing a finalized supplier credit note requires manually updating the stock items' quantity on hand\n\n"+("If the supplier credit note has been sync'd to "+third_party+", ")+("any changes you make here will NOT appear in "+third_party+", ")+("you will need to make these changes manually in "+third_party):"You're editing an supplier credit note that has been finalized.\n\nAre you sure you want to proceed?.\n\nIMPORTANT! Editing a finalized supplier credit note requires manually updating the stock items' quantity on hand"},$scope.confirm_edit_finalized_credit_note=function(callback){return $scope.credit_note.finalized?permissionService.check_update_finalized_documents_restriction_before_proceed(function(){return confirmationService.confirm($scope.edit_finalized_credit_note_warning(),$scope.credit_note.finalized&&!$scope.edit_finalized_credit_note_confirmed,function(){return $scope.credit_note.finalized&&($scope.edit_finalized_credit_note_confirmed=!0),callback()})}):callback()},$scope.open_send_email=function(){return $scope.email=$scope.credit_note.supplier.email,$scope.subject=$scope.credit_note.email_preview.subject,$scope.message=$scope.credit_note.email_preview.message,popoverService.show("#supplier-credit-note-send-email","#supplier-credit-note-send-email-button",{placement:"left"})},$scope.cancel=function(){return popoverService.hide("#supplier-credit-note-send-email")},$scope.send_email=function(){return spinnerService.start_spinner("#supplier-credit-note-send-email-spinner"),SupplierCreditNote.send_email({id:$scope.credit_note.id,email:$scope.email,message:$scope.message},function(){return spinnerService.stop_spinner("#supplier-credit-note-send-email-spinner"),popoverService.hide("#supplier-credit-note-send-email")})}}}.call(this),function(){this.SupplierCreditNotesController=function($scope,$location,$routeParams,lookupService,accountingNavService,formService,spinnerService,timeService,SupplierCreditNote){var search_query;return $scope.search=function(page){var search_query;return null==page&&(page=1),$scope.query.deleted||delete $scope.query.deleted,$scope.query.finalized||delete $scope.query.finalized,$scope.query.in_progress||delete $scope.query.in_progress,$scope.query.unallocated||delete $scope.query.unallocated,search_query={query:$scope.query,page:page,showing_deleted:$scope.showing_deleted,showing_in_progress:$scope.showing_unpaid,showing_finalized:$scope.showing_finalized,order:$scope.order,order_by:$scope.order_by},lookupService.save_search_query("supplier_credit_notes",search_query),spinnerService.start_spinner("#supplier-credit-notes-spinner"),SupplierCreditNote.all(formService.params({query:$scope.query,page:page}),function(data){return spinnerService.stop_spinner("#supplier-credit-notes-spinner"),$scope.keyword=$scope.query.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.credit_notes=data.supplier_credit_notes})},$scope.toggle_unallocated=function(){return $scope.query.query=null,timeService.timeout(function(){return $scope.search()})},$scope.toggle_deleted=function(){return timeService.timeout(function(){return $scope.query.finalized=void 0,$scope.query.in_progress=void 0,$scope.search()})},$scope.toggle_finalized=function(){return timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.in_progress=void 0,$scope.search()})},$scope.toggle_in_progress=function(){return timeService.timeout(function(){return $scope.query.deleted=void 0,$scope.query.finalized=void 0,$scope.search()})},accountingNavService.activate("Supplier Credit Notes"),search_query=lookupService.search_query("supplier_credit_notes"),search_query&&search_query.query&&$routeParams.cached?($scope.query=search_query.query,$scope.showing_deleted=search_query.showing_deleted,$scope.showing_finalized=search_query.showing_finalized,$scope.showing_in_progress=search_query.showing_in_progress,$scope.search(search_query.page||1)):($scope.query={query:null},lookupService.save_search_query("supplier_credit_notes",{query:{query:""}}),$location.path("/supplier_credit_notes").search({cached:Math.random()}).replace())}}.call(this),function(){this.NewSupplierController=function($scope,$routeParams,$location,inventoryNavService,Supplier){return inventoryNavService.activate("Suppliers"),$scope.new_supplier=new Supplier,$scope.on_save_new_supplier=function(){return $location.path("/suppliers/"+$scope.new_supplier.id)}}}.call(this),function(){this.ShowSupplierController=function($scope,$routeParams,formService,$location,lookupService,inventoryNavService,spinnerService,Stock,StockSupplier,Supplier){return $scope.create_stock_supplier=function(){return $scope.new_stock_supplier={supplier_id:$scope.supplier.id}},$scope.cancel_create_stock_supplier=function(){return $scope.new_stock_supplier=void 0},$scope.save_new_stock_supplier=function(){return $scope.new_stock_supplier.stock&&($scope.new_stock_supplier.stock_id=$scope.new_stock_supplier.stock.stock_id),StockSupplier.save($scope.new_stock_supplier,function(data){return $scope.stock_supplier_list.stock_suppliers.push(data),$scope.new_stock_supplier=void 0})},$scope.edit_stock_supplier=function(stock_supplier){var copied_stock,copy;return copy={},copied_stock={},angular.copy(stock_supplier,copy),angular.copy(stock_supplier.stock,copied_stock),copy.stock=copied_stock,stock_supplier.editing=copy},$scope.cancel_edit_stock_supplier=function(stock_supplier){return stock_supplier.editing=void 0},$scope.save_stock_supplier=function(stock_supplier){return stock_supplier.editing.stock&&(stock_supplier.editing.stock_id=stock_supplier.editing.stock.stock_id),StockSupplier.update(stock_supplier.editing,function(data){return angular.copy(data,stock_supplier),stock_supplier.editing=void 0})},$scope.edit_supplier=function(){return formService.edit_fields($scope.supplier,"editing")},$scope.do_delete_supplier=function(){return Supplier["delete"]($scope.supplier,function(data){return lookupService.fetch_creditors(),$scope.showing_delete_supplier_dialog=!1,angular.copy(data,$scope.supplier)})},$scope.delete_supplier=function(){return $scope.showing_delete_supplier_dialog=!0},$scope.cancel_delete_supplier=function(){return $scope.showing_delete_supplier_dialog=!1},$scope.select_creditor=function(){return formService.edit_fields($scope.supplier,"editing_creditor","id","creditor_id")},$scope.save_selected_creditor=function(){return Supplier.update($scope.supplier.editing_creditor,function(data){return angular.copy(data,$scope.supplier)})},$scope.cancel_select_creditor=function(){return $scope.supplier.editing_creditor=void 0},$scope.merge_supplier=function(){return $scope.showing_merge_supplier=!0},$scope.show_left_side=function(menu_name){return $scope.left_side=menu_name},$scope.create_contact=function(){return $scope.new_contact={}},$scope.cancel_new_contact=function(){return $scope.new_contact=void 0},$scope.save_new_contact=function(){return spinnerService.start_spinner("#supplier-contacts-spinner"),Supplier.create_contact({id:$scope.supplier.id,contact:$scope.new_contact},function(data){return spinnerService.stop_spinner("#supplier-contacts-spinner"),$scope.supplier.contacts.push(data),$scope.new_contact=void 0})},$scope.edit_contact=function(contact){return formService.edit_fields(contact,"editing")},$scope.cancel_editing_contact=function(contact){return contact.editing=void 0},$scope.save_contact=function(contact){return spinnerService.start_spinner("#supplier-contacts-spinner"),Supplier.update_contact({id:$scope.supplier.id,contact:contact.editing},function(data){return spinnerService.stop_spinner("#supplier-contacts-spinner"),angular.copy(data,contact)})},$scope.destroy_contact=function(contact){return spinnerService.start_spinner("#supplier-contacts-spinner"),Supplier.destroy_contact({id:$scope.supplier.id,contact:contact},function(){return spinnerService.stop_spinner("#supplier-contacts-spinner"),$scope.supplier.contacts.remove(contact)})},$scope.selectStockSupplierPage=function(number){return $scope.supplier?Supplier.stock_suppliers({id:$scope.supplier.id,page:number,order:"supplier_stock_number"},function(data){return $scope.stock_supplier_list=data,$scope.stock_supplier_list.total_pages=data.meta.total_pages,$scope.stock_supplier_list.page=data.meta.page}):void 0},$scope.delete_stock_supplier=function(stock_supplier){return StockSupplier["delete"]({id:stock_supplier.id},function(){return $scope.stock_supplier_list.stock_suppliers.remove(stock_supplier)})},inventoryNavService.activate("Suppliers"),$scope.left_side="details",spinnerService.start_spinner("#supplier-spinner"),Supplier.get({id:$routeParams.id},function(data){return spinnerService.stop_spinner("#supplier-spinner"),$scope.supplier=data,Supplier.stock_suppliers({id:$scope.supplier.id},function(data){return $scope.stock_supplier_list=data,$scope.stock_supplier_list.total_pages=data.meta.total_pages,$scope.stock_supplier_list.page=data.meta.page})})}}.call(this),function(){this.SuppliersController=function($scope,timeService,$routeParams,$location,spinnerService,lookupService,inventoryNavService,formService,Supplier){var search_query;return $scope.search=function(number){var search_query;return null==number&&(number=1),$scope.showing_positive_balances=!1,$scope.query.query&&delete $scope.query.tag,search_query={query:$scope.query,page:number,order:$scope.order,order_by:$scope.order_by,showing_positive_balances:!1},lookupService.save_search_query("suppliers",search_query),spinnerService.start_spinner("#supplier-list-spinner"),Supplier.search(formService.params(search_query),function(data){return $scope.keyword=$scope.query.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.suppliers=data.suppliers,spinnerService.stop_spinner("#supplier-list-spinner")})},$scope.selectPage=function(number){return $scope.search(number)},$scope.tags=function(){return lookupService.tags_of_type("Supplier")},$scope.sort=function(attribute){return $scope.order_by===attribute&&"asc"===$scope.order?$scope.order="desc":($scope.order="asc",$scope.order_by=attribute),$scope.search()},$scope.toggle_positive_balances=function(number){return null==number&&(number=1),$scope.query={},lookupService.save_search_query("suppliers",{query:search_query,showing_positive_balances:!0}),timeService.timeout(function(){return $scope.showing_positive_balances?(spinnerService.start_spinner("#supplier-list-spinner"),Supplier.positive_balance(function(data){return $scope.suppliers=data,spinnerService.stop_spinner("#supplier-list-spinner")}),$scope.keyword=void 0,$scope.page_number=void 0,$scope.total_pages=void 0):$scope.search()})},inventoryNavService.activate("Suppliers"),search_query=lookupService.search_query("suppliers"),search_query&&$routeParams.cached?($scope.query=search_query.query,$scope.order=search_query.order||"desc",$scope.order_by=search_query.order_by||"number",$scope.showing_positive_balances=search_query.showing_positive_balances,search_query.showing_positive_balances?($scope.showing_positive_balances=!0,$scope.toggle_positive_balances()):$scope.search(search_query.page||1)):(lookupService.save_search_query("suppliers",{query:"",order:"desc",order_by:"number"}),$location.path("/suppliers").search({cached:Math.random()}).replace())}}.call(this),function(){this.DashboardController=function($scope,$cookies,$window,$routeParams,$location,confirmationService,popoverService,SupportPortal){return $scope.role_color=function(role){return"admin"===role?"green":"restricted mechanic"===role?"red":"orange"},$scope.ws_status_color=function(auto_workshop){return auto_workshop.locked?"lightgrey":auto_workshop.owing?"red":auto_workshop.has_plan&&!auto_workshop.is_paying_customer?"orange":auto_workshop.is_paying_customer&&!auto_workshop.owing?"green":auto_workshop.trial_expired&&!auto_workshop.has_plan?"darkgoldenrod":"none"},$scope.view_switch=function(view){return $scope.view=view},$scope.selected_workshop_id=function(){return $window.localStorage.getItem("selected_workshop_id")},$scope.get_auto_workshop=function(id){return $scope.$broadcast("getWorkshopChannel",{id:id})},$scope.lock_auto_workshop=function(){return SupportPortal.lock({id:$scope.auto_workshop.id,locking_reason:$scope.locking_reason},function(data){return $scope.auto_workshop.locked=data.locked,$scope.auto_workshop.locking_reason=data.locking_reason,$scope.locking_reason=""})},$scope.unlock_auto_workshop=function(){return SupportPortal.unlock({id:$scope.auto_workshop.id},function(data){return $scope.auto_workshop.locked=data.locked,$scope.auto_workshop.locking_reason=data.locking_reason})},$scope.show_change_password=function(employee_id){return $scope.changing_password=employee_id},$scope.change_password=function(employee_id){return""!==$scope.new_password?SupportPortal.change_password({employee_id:employee_id,new_password:$scope.current_auto_workshop.new_password},function(data){return $scope.changing_password=void 0,data.error||($scope.password_changed=!0),data.error&&($scope.error.message=data.error),$scope.current_auto_workshop.new_password=""}):$scope.error.message="New password cannot be empty"},$scope.cancel_change_password=function(){return $scope.current_auto_workshop.new_password="",$scope.changing_password=void 0},$scope.set_workshop_attribute=function(attribute,value){return SupportPortal.update({id:$scope.auto_workshop.id,attribute:attribute,value:value},function(data){return data.error||($scope.auto_workshop[attribute]=value),$scope.error.message=data.error})},$scope.add_workshop_credit=function(credit){return SupportPortal.add_workshop_credit({id:$scope.auto_workshop.id,credit_to_add:credit},function(data){return $scope.auto_workshop.credit=data.result})},$scope.delete_md_invoice=function(id){return popoverService.hide("#delete-md-invoice"),SupportPortal.delete_mechanic_desk_invoice({id:$scope.auto_workshop.id,invoice_id:id},function(data){return $scope.auto_workshop.mechanic_desk_invoices=data.result,$scope.md_invoice=null})},$scope.confirm_delete_md_invoice=function(id){return $scope.md_invoice=id,popoverService.show("#delete-md-invoice","#md-invoices",{placement:"right"})},$scope.close_confirm_delete_md_invoice=function(){return popoverService.hide("#delete-md-invoice")},$scope.add_custom_attribute=function(){return SupportPortal.add_custom_attribute({id:$scope.auto_workshop.id,attr_name:$scope.custom_attribute_name},function(){return $scope.custom_attribute_name=null,$scope.close_add_custom_attribute()})},$scope.confirm_add_custom_attribute=function(){return $scope.custom_attribute_name=null,popoverService.show("#add-custom-attribute-dialogue","#add-custom-attribute",{placement:"right"})},$scope.close_add_custom_attribute=function(){return $scope.custom_attribute_name=null,popoverService.hide("#add-custom-attribute-dialogue")},$scope.csrf_value=$cookies["XSRF-TOKEN"],$scope.view="basic",$scope.current_auto_workshop={new_password:""},$scope.auto_workshop_search_result=[],$scope.search_term="search term",$scope.locking_reason="",$scope.error={message:null},$scope.auto_workshop={id:null,name:null,phone:null,email:null,trial_expired_workshops:null},$scope.$watch("selected_workshop_id",function(){return $scope.selected_workshop_id()?$scope.get_auto_workshop($scope.selected_workshop_id()):void 0})}}.call(this),function(){this.ObjectReassociationController=function($scope,$cookies,$window,$routeParams,$location,confirmationService,popoverService,SupportPortal){return $scope.selected_workshop_id=function(){return $window.localStorage.getItem("selected_workshop_id")},$scope.get_auto_workshop=function(id){return $scope.$broadcast("getWorkshopChannel",{id:id})},$scope.object_search=function(){return $scope.error.message=null,"na"!==$scope.success&&($scope.success="na"),$scope.current_auto_workshop.id?SupportPortal.object_search({id:$scope.auto_workshop.id,search_term:$scope.search_term},function(data){return data.error?$scope.error.message=data.error:$scope.data_list={data:data.result,attributes:data.meta.attributes,object_klass:data.meta.object_klass}}):$scope.error.message="Workshop required"},$scope.reassociate=function(){return $scope.reassociator.id=$scope.auto_workshop.id,$scope.reassociator.subject_id&&$scope.reassociator.object_id&&$scope.reassociator.subject_attribute?SupportPortal.reassociate($scope.reassociator,function(data){return data.error&&($scope.error.message=data.error),data.success&&($scope.success=data.success),$scope.reassociator={id:null,subject_id:null,subject_klass:null,object_id:null,object_klass:null,subject_attribute:null},$scope.current_object.attribute=null}):$scope.error.message="Assign all objects to reassociate"},$scope.select=function(index){return null===$scope.assigning?$scope.error.message="Select object to assign":("subject"===$scope.assigning&&($scope.reassociator.subject_id=$scope.data_list.data[index].id,$scope.reassociator.subject_klass=$scope.data_list.object_klass),"object"===$scope.assigning&&($scope.reassociator.object_id=$scope.data_list.data[index].id,$scope.reassociator.object_klass=$scope.data_list.object_klass),$scope.assigning=null,$scope.saved_data_list.push({data:$scope.data_list.data[index],attributes:$scope.data_list.attributes,object_klass:$scope.data_list.object_klass}))
},$scope.select_saved=function(index){return null===$scope.assigning?$scope.error.message="Select object to assign":("subject"===$scope.assigning&&($scope.reassociator.subject_id=$scope.saved_data_list[index].data.id,$scope.reassociator.subject_klass=$scope.saved_data_list[index].object_klass),"object"===$scope.assigning&&($scope.reassociator.object_id=$scope.saved_data_list[index].data.id,$scope.reassociator.object_klass=$scope.saved_data_list[index].object_klass),$scope.data_list.attributes=$scope.saved_data_list[index].attributes,$scope.data_list.object_klass=$scope.saved_data_list[index].object_klass,$scope.assigning=null)},$scope.set_subject_attribute=function(){return $scope.data_list.object_klass===$scope.reassociator.subject_klass?$scope.reassociator.subject_attribute=$scope.current_object.attribute:$scope.error.message="Attributes do not match that of subject class"},$scope.set_string_value=function(){return"object"===$scope.assigning?($scope.reassociator.object_id=$scope.string_value,$scope.reassociator.object_klass="String",$scope.assigning=null):$scope.error.message="Must assign text to object"},$scope.show=function(index){return $scope.show_data={raw:$scope.data_list.data[index],klass:$scope.data_list.object_klass,attributes:$scope.data_list.attributes}},$scope.show_saved=function(index){return $scope.show_data={raw:$scope.saved_data_list[index].data,klass:$scope.saved_data_list[index].object_klass,attributes:$scope.saved_data_list[index].attributes},$scope.data_list.attributes=$scope.show_data.attributes,$scope.data_list.object_klass=$scope.show_data.klass},$scope.dump_clipboard=function(){return $scope.saved_data_list=[]},$scope.dump_show_data=function(){return $scope.show_data=null},$scope.view_switch=function(view){return $scope.view=view},$scope.toggle_assignment=function(target){return $scope.assigning=target===$scope.assigning?null:target},$scope.status_color=function(deleted){return deleted?"red":"none"},$scope.init=function(){return $scope.auto_workshop_search_result=[],$scope.search_term="search term",$scope.current_object={},$scope.data_list=[],$scope.saved_data_list=[],$scope.string_value=null,$scope.assigning=null,$scope.show_data=null,$scope.error={message:null},$scope.success="na",$scope.reassociator={id:null,subject_id:null,subject_klass:null,object_id:null,object_klass:null,subject_attribute:null},$scope.auto_workshop={id:null,name:null,phone:null,email:null},$scope.current_auto_workshop={id:null,focused_raw_key:null,focused_raw_value:null}},$scope.csrf_value=$cookies["XSRF-TOKEN"],$scope.init(),$scope.$watch("selected_workshop_id",function(){return $scope.selected_workshop_id()?$scope.get_auto_workshop($scope.selected_workshop_id()):void 0})}}.call(this),function(){this.TimesheetsController=function($routeParams,dateFilter,$scope,WorkHour,navbarService,lookupService,spinnerService,formService,$timeout){return navbarService.activate("Timesheets"),$scope.date=new Date,$scope.showing_employee_list=!0,$scope.showing_employees=[],$scope.timesheet={group_by:"job"},$scope.quick_range="this_two_weeks",$scope.open_jobs=[],$scope.filtered_jobs=[],$scope.search=function(){return $scope.searching&&$timeout.cancel($scope.searching),$scope.searching=$timeout($scope.do_search,500)},$scope.do_search=function(){return spinnerService.start_spinner("#work-hour-spinner"),WorkHour.timesheets($scope.search_options(),function(data){return $scope.timesheet=data,$scope.filtered(),spinnerService.stop_spinner("#work-hour-spinner")})},$scope.download=function(){var params;return params=formService.params($scope.search_options()),window.open("/work_hours/download?"+$.param(params))},$scope.search_options=function(){var options;return options={},$scope.custom_range?($scope.timesheet.from&&(options.from=$scope.timesheet.from),$scope.timesheet.date&&(options.to=$scope.timesheet.date)):options.range=$scope.quick_range,$scope.timesheet.group_by&&(options.group_by=$scope.timesheet.group_by),options},$scope.toggle_select_all=function(){return $scope.showing_employees=$scope.selecting_all?$scope.employees.map(function(e){return e.id.toString()}):[]},$scope.show_employee_list=function(){return $scope.showing_employee_list=!0},$scope.hide_employee_list=function(){return $scope.showing_employee_list=!1},$scope.filtered=function(){return $scope.filtered_timesheet={},$scope.filtered_jobs=[],angular.copy($scope.timesheet,$scope.filtered_timesheet),$scope.filtered_timesheet.timesheets.each(function(sheet){var work_hours;return sheet.job&&$scope.filtered_jobs.push(sheet.job),work_hours=[],angular.copy(sheet.work_hours,work_hours),sheet.work_hours=[],work_hours.each(function(wh){return $scope.showing_employees.indexOf(wh.employee_id.toString())>=0?sheet.work_hours.push(wh):void 0})})},$scope.total_hours=function(timesheet){var total;return total=0,timesheet&&timesheet.timesheets&&timesheet.timesheets.length>0?timesheet.timesheets.each(function(sheet){return sheet.work_hours.each(function(wh){return total+=wh.hour})}):timesheet&&timesheet.work_hours&&timesheet.work_hours.length>0&&timesheet.work_hours.each(function(wh){return total+=wh.hour}),total.toFixed(2)},$scope.total_hours_charged=function(timesheet){var total;return total=0,timesheet&&timesheet.timesheets&&timesheet.timesheets.length>0?timesheet.timesheets.each(function(sheet){return sheet.work_hours.each(function(wh){return total+=wh.charge_out_hours})}):timesheet&&timesheet.work_hours&&timesheet.work_hours.length>0&&timesheet.work_hours.each(function(wh){return total+=wh.charge_out_hours}),total.toFixed(2)},$scope.total_amount=function(timesheet){var total;return total=0,timesheet&&timesheet.timesheets&&timesheet.timesheets.length>0?timesheet.timesheets.each(function(sheet){return sheet.work_hours.each(function(wh){return total+=wh.total_amount})}):timesheet&&timesheet.work_hours&&timesheet.work_hours.length>0&&timesheet.work_hours.each(function(wh){return total+=wh.total_amount}),total.toFixed(2)},$scope.total_effective_hours=function(timesheet){var total;return total=0,timesheet&&timesheet.timesheets&&timesheet.timesheets.length>0?timesheet.timesheets.each(function(sheet){return sheet.work_hours.each(function(wh){return total+=wh.effective_charge_out_hours})}):timesheet&&timesheet.work_hours&&timesheet.work_hours.length>0&&timesheet.work_hours.each(function(wh){return total+=wh.effective_charge_out_hours}),total.toFixed(2)},$scope.show_custom_range=function(){return $scope.custom_range=!0},$scope.hide_custom_range=function(){return $scope.custom_range=!1},$scope.quick_ranges=[{value:"today",name:"Today"},{value:"this_week",name:"This Week"},{value:"this_two_weeks",name:"This Fortnight"},{value:"this_month",name:"This Month"},{value:"last_week",name:"Last Week"},{value:"last_two_weeks",name:"Last Fortnight"},{value:"last_month",name:"Last Month"}],$scope.employees=lookupService.assignable_employees(),$scope.selecting_all=!0,$scope.toggle_select_all(),$scope.search(),$scope.$watch("showing_employees",function(){return $scope.timesheet&&$scope.timesheet.timesheets?$scope.filtered():void 0},!0),$scope.edit_work_hour=function(work_hour){return work_hour?(formService.edit_fields(work_hour,"editing"),$scope.editing_work_hour=work_hour.editing):void 0},$scope.new_item=function(){return $scope.new_work_hour={started_at:new Date,ended_at:new Date},$scope.edit_work_hour($scope.new_work_hour)}}}.call(this),function(){this.VehicleLookUpIntegrationController=function($scope,$window,$route,popoverService,lookupService,timeService,integrationsNavService,spinnerService,formService,AutoWorkshop,VehicleLookUpIntegrationAccount,VehicleLookUpRequest){return $scope.open_auth_window=function(url){return window.$scope=$scope,$window.open(url,"CarJam API key registration")},$scope.get_api_key=function(account){return VehicleLookUpIntegrationAccount.generate_auth_url(account,function(data){return $scope.open_auth_window(data.url)})},$scope.start_integration=function(account){return VehicleLookUpIntegrationAccount.save(account,function(data){return angular.copy(data,account),lookupService.set_vehicle_look_up_integration_account(data),$scope.edit_account(account)})},$scope.edit_account=function(account){return formService.edit_fields(account,"editing")},$scope.check_carjam_availability=function(){return VehicleLookUpRequest.check_availability({third_party:"carjam"},function(data){return $scope.carjam_all_availability=data.all_available,$scope.carjam_carjam_availability=data.carjam_available,$scope.carjam_mvr_availability=data.mvr_available,$scope.carjam_ppsr_availability=data.ppsr_available})},$scope.save=function(account){return VehicleLookUpIntegrationAccount.update(account.editing,function(data){return angular.copy(data,account),lookupService.set_vehicle_look_up_integration_account(data),$scope.close_carjam_api_key_popover(),$scope.close_mycarcheck_api_key_popover()})},$scope.cancel=function(account){return account.editing=void 0,$scope.dummy_api_key=""},$scope.open_carjam_api_key_popover=function(){return popoverService.show("#carjam-api-key-popover","#carjam-api-key-help-button",{placement:"right"})},$scope.close_carjam_api_key_popover=function(){return popoverService.hide("#carjam-api-key-popover")},$scope.open_mycarcheck_api_key_popover=function(){return popoverService.show("#mycarcheck-api-key-popover","#mycarcheck-setup",{placement:"left"})},$scope.close_mycarcheck_api_key_popover=function(){return popoverService.hide("#mycarcheck-api-key-popover")},$scope.fetch_account=function(){return VehicleLookUpIntegrationAccount.carjam(function(data){return data.id?($scope.carjam_account=data,lookupService.set_vehicle_look_up_integration_account(data)):void 0}),VehicleLookUpIntegrationAccount.mycarcheck(function(data){return data.id?($scope.mycarcheck_account=data,lookupService.set_vehicle_look_up_integration_account(data)):void 0})},integrationsNavService.activate("Vehicle Look Up Integration"),$scope.carjam_account={third_party:"carjam",enabled:!1},$scope.mycarcheck_account={third_party:"mycarcheck",enabled:!1},$scope.dummy_api_key="",$scope.fetch_account(),$scope.carjam_all_availability="Not checked",$scope.carjam_carjam_availability="Not checked",$scope.carjam_mvr_availability="Not checked",$scope.carjam_ppsr_availability="Not checked"}}.call(this),function(){this.VehicleVisualIntegrationController=function($scope,$window,$route,popoverService,lookupService,timeService,integrationsNavService,spinnerService,formService,AutoWorkshop,VehicleVisualIntegrationAccount){return $scope.get_api_key=function(account){return VehicleVisualIntegrationAccount.generate_auth_url(account,function(data){return $scope.open_auth_window(data.url)})},$scope.start_integration=function(account){return VehicleVisualIntegrationAccount.save(account,function(data){return angular.copy(data,account),lookupService.set_vehicle_visual_account(data),$scope.edit_account(account)})},$scope.edit_account=function(account){return formService.edit_fields(account,"editing")},$scope.save=function(account){return VehicleVisualIntegrationAccount.update(account.editing,function(data){return angular.copy(data,account),lookupService.set_vehicle_visual_account(data),$scope.close_vehicle_visual_api_key_popover()})},$scope.cancel=function(account){return account.editing=void 0,$scope.show_api_input=!1},$scope.open_vehicle_visual_api_key_popover=function(){return popoverService.show("#vehicle-visual-api-key-popover","#vehicle-visual-api-key-help-button",{placement:"right"})},$scope.close_vehicle_visual_api_key_popover=function(){return popoverService.hide("#vehicle-visual-api-key-popover")},$scope.fetch_account=function(){return VehicleVisualIntegrationAccount.vehicle_visual(function(data){return data.id?($scope.vehicle_visual_account=data,lookupService.set_vehicle_visual_account(data)):void 0})},integrationsNavService.activate("Vehicle Visual Integration"),$scope.vehicle_visual_account=lookupService.vehicle_visual_account()||{enabled:!1,third_party:"vehicle_visual"},$scope.fetch_account(),window.$scope=$scope}}.call(this),function(){this.VehiclesController=function($scope,$routeParams,lookupService,spinnerService,customersNavService,$location,Vehicle){var search_query;return $scope.search=function(number){var search_query;return null==number&&(number=1),search_query={query:$scope.query,page:number,order_by:$scope.order_by||"id",order:$scope.order||"desc"},lookupService.save_search_query("vehicles",search_query),spinnerService.start_spinner("#vehicle-list-spinner"),Vehicle.all(search_query,function(data){return $scope.keyword=$scope.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.vehicles=data.vehicles,spinnerService.stop_spinner("#vehicle-list-spinner")})},$scope.selectPage=function(number){return $scope.search(number)},$scope.sort=function(attribute){return $scope.order_by===attribute?$scope.order="asc"===$scope.order?"desc":"asc":$scope.order_by=attribute,$scope.search()},customersNavService.activate("Vehicles"),search_query=lookupService.search_query("vehicles"),search_query&&$routeParams.cached?($scope.query=search_query.query,$scope.search(search_query.page||1)):(lookupService.save_search_query("vehicles",{query:""}),$location.path("/vehicles").search({cached:Math.random()}).replace())}}.call(this),function(){this.EditWorkTypeController=function($scope,$routeParams,$location,jobTypesNavService,WorkType){return jobTypesNavService.activate("work_type",$routeParams.workTypeId),$scope.work_type=WorkType.get({id:$routeParams.workTypeId}),$scope.save_work_type=function(){return $scope.work_type.$update(function(){}),$location.path("/work_types/"+$scope.work_type.id)},$scope.cancel_edit_work_type=function(){return $location.path("/work_types/"+$scope.work_type.id)}}}.call(this),function(){this.NewWorkTypeController=function($scope,administrationNavService,WorkType,$location){return administrationNavService.activate("Job Templates"),$scope.work_type=new WorkType,$scope.save_new_work=function(){return $scope.work_type.$save(function(){return $location.path("/job_types")})},$scope.cancel_new_work=function(){return $location.path("/job_types")}}}.call(this),function(){this.ShowWorkTypeController=function($scope,$routeParams,$location,jobTypesNavService,WorkType){return jobTypesNavService.activate("work_type",$routeParams.workTypeId),$scope.work_type=WorkType.get({id:$routeParams.workTypeId}),$scope.create_new_work_item=function(){return $scope.new_work_item={}},$scope.cancel_new_work_item=function(){return $scope.new_work_item=null},$scope.save_new_work_item=function(){return $scope.work_type.work_items.push($scope.new_work_item),$scope.work_type.$update(),$scope.new_work_item=null},$scope.edit_work_item=function(item){return item.editing=!0},$scope.cancel_edit_work_item=function(item){return item.editing=!1},$scope.save_work_item=function(item){return item.editing=!1,$scope.work_type.$update()},$scope.remove_work_item=function(item){return $scope.work_type.work_items.remove(item),$scope.work_type.$update(),item.editing=!1},$scope.remove=function(){return $scope.work_type.$delete(function(){return $location.path("/job_types")})}}}.call(this),function(){this.WorkstationController=function($scope,$cacheFactory,$routeParams,$location,$filter,$window,formService,confirmationService,popoverService,lookupService,spinnerService,timeService,Session,Employee,Job,AutoWorkshop,WorkHour,Workstation){return $scope.avatar_url=function(employee){return employee.avatar?"/workstations/avatar?employee_id="+employee.id:""},$scope.logout=function(){return Session["delete"](function(){return $cacheFactory.get("$http").removeAll(),$window.location.href="/auto_workshop/login?workstation=true"})},$scope.switch_to=function(employee){return $scope.error=void 0,spinnerService.start_spinner("#employee-spinner"),Workstation.switch_to({employee_id:employee.id,password:$scope.password},function(data){return spinnerService.stop_spinner("#employee-spinner"),data.error?($scope.error=data.error,formService.select_text("#password")):($scope.error=void 0,$scope.logged_in=!0,$scope.jobs=data.jobs.sort(function(x,y){return $scope.clocked_on(x)?-1:$scope.clocked_on(y)?1:0}),$scope.password=void 0)})},$scope.open=function(employee){return $scope.logged_in=!1,$scope.current_employee=employee,$scope.page_number=1,popoverService.show("#pin-pad","#popup-anchor",{placement:"top"}),formService.focus("#password")},$scope.clocked_on=function(job){return $scope.pending_work_hour(job)},$scope.pending_work_hour=function(job){return job.work_hours?job.work_hours.find(function(wh){return wh.employee_id===$scope.current_employee.id&&!wh.ended_at}):void 0},$scope.clock_on=function(job){var started_at;return started_at=new Date,started_at.setMinutes(timeService.round_to_five_minutes(started_at)),spinnerService.start_spinner("#employee-spinner"),Job.clock_on({id:job.id,started_at:started_at},function(data){return spinnerService.stop_spinner("#employee-spinner"),job.work_hours.unshift(data.work_hour),$scope.sign_off()})},$scope.cancel_clock_off=function(){return $scope.work_hour=void 0,popoverService.hide("#clock-off")},$scope.clock_off=function(){var ended_at;return ended_at=new Date,ended_at.setMinutes(timeService.round_to_five_minutes(ended_at)),spinnerService.start_spinner("#clocking-spinner"),WorkHour.update({id:$scope.work_hour.id,ended_at:ended_at,description:$scope.work_hour.description},function(data){return spinnerService.stop_spinner("#clocking-spinner"),angular.copy(data,$scope.work_hour),$scope.work_hour=void 0,popoverService.hide("#clock-off")})},$scope.open_clock_off=function(job){return $scope.work_hour=$scope.pending_work_hour(job),popoverService.show("#clock-off","#clock-off-button-"+job.id,{placement:top}),formService.focus("#work-hour-description")},$scope.sign_off=function(){return spinnerService.start_spinner("#employee-spinner"),Workstation.sign_off(function(){return $scope.logged_in=!1,spinnerService.stop_spinner("#employee-spinner"),$scope.jobs=void 0,$scope.current_employee=void 0,popoverService.hide("#pin-pad")})},$scope.filtered_jobs=function(){return $scope.jobs?$filter("filter")($scope.jobs,$scope.job_search):[]},$scope.current_jobs=function(page_number){var filtered_jobs;return null==page_number&&(page_number=1),filtered_jobs=$scope.filtered_jobs(),filtered_jobs.slice((page_number-1)*$scope.per_page,page_number*$scope.per_page)},$scope.total_pages=function(){var full,length;return length=$scope.filtered_jobs().length,full=parseInt(length/$scope.per_page),length%$scope.per_page>0?full+1:full},$scope.put_on_hold=function(job){return $scope.putting_on_hold=!1,$scope.action_job=job,$scope.actions_job_anchor="#actions-job-"+job.id,$scope.putting_on_hold=!0},$scope["continue"]=function(job){return Job["continue"]({id:job.id},function(data){return angular.copy(data,job)})},$scope.send_sms=function(job){return $scope.sending_sms=!1,$scope.action_job=job,$scope.actions_job_anchor="#actions-job-"+job.id,$scope.sending_sms=!0},$scope.send_email=function(job){return $scope.sending_email=!1,$scope.action_job=job,$scope.actions_job_anchor="#actions-job-"+job.id,$scope.sending_email=!0},$scope.tag=function(job){return $scope.tagging_job=!1,$scope.action_job=job,$scope.actions_job_anchor="#actions-job-"+job.id,$scope.tagging_job=!0},$scope.per_page=12,$scope.page_number=1,$scope.employees=Workstation.employees()}}.call(this),function(){this.AutoWorkshopApp.directive("ad3rdPartyExplain",function(){return{restrict:"AE",restrict:"AE",scope:{},templateUrl:template("directives/ad_3rd_party_explain"),controller:function($scope,popoverService){return $scope.show=function(){return popoverService.show("#3rd-party-popover","#3rd-party-explain-link",{placement:"right"})},$scope.hide=function(){return popoverService.hide("#3rd-party-popover")}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adAccountingAccountPicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{accounting_account:"=ngModel",accounts:"="},templateUrl:template("directives/ad_accounting_account_picker"),controller:function($scope,lookupService){return $scope.filtered_accounts=function(){return $scope.accounts||lookupService.accounting_accounts()||[]}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adAccountingSyncResult",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{sync_result:"=ngModel",name:"@"},templateUrl:template("directives/ad_accounting_sync_result"),controller:function($scope){return $scope.show_details=function(){}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adAdjustTime",function(){return{restrict:"AE",restrict:"AE",require:"showing",scope:{ngModel:"=",showing:"=",anchorElement:"=",placement:"@",onSuccess:"&"},templateUrl:template("directives/ad_adjust_time"),controller:function($scope,lookupService,formService,popoverService,spinnerService,Job,Booking){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.provide_mobile_service=function(){return lookupService.configuration("provide_mobile_service")},$scope.show=function(){return $scope.time=$scope.ngModel.time,$scope.pickup_time=$scope.ngModel.pickup_time,$scope.total_hours=$scope.ngModel.total_hours,$scope.finished_time=$scope.ngModel.finished_time,popoverService.show("#adjust-time",$scope.anchorElement,{placement:$scope.placement,fixed_position:!0})},$scope.time_label=function(){return $scope.ngModel&&"booking"===$scope.ngModel.type?"Booking Time":$scope.ngModel&&"job"===$scope.ngModel.type?"Start Time":"Time"},$scope.save=function(){var params,resource;return spinnerService.start_spinner("#adjust-time-spinner"),resource="booking"===$scope.ngModel.type?Booking:Job,params={id:$scope.ngModel.id,time:$scope.time,pickup_time:$scope.pickup_time,total_hours:$scope.total_hours,finished_time:$scope.finished_time},resource.update(params,function(data){return spinnerService.stop_spinner("#adjust-time-spinner"),$scope.ngModel.time=data.time,$scope.ngModel.pickup_time=data.pickup_time,$scope.ngModel.finished_time=data.finished_time,$scope.ngModel.total_hours=data.total_hours,$scope.showing=!1,$scope.onSuccess?$scope.onSuccess():void 0})},$scope.hide=function(){return popoverService.hide("#adjust-time"),$scope.showing=!1}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adAssignEmployees",function(){return{restrict:"AE",restrict:"AE",require:"showing",scope:{job:"=",showing:"=",anchorElement:"=",placement:"@",onSuccess:"&"},templateUrl:template("directives/ad_assign_employees"),controller:function($scope,lookupService,formService,popoverService,spinnerService,Job){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.employees=function(){return lookupService.assignable_employees()},$scope.show=function(){return $scope.job.employees[0]&&($scope.mechanic_1_id=$scope.job.employees[0].id),$scope.job.employees[1]&&($scope.mechanic_2_id=$scope.job.employees[1].id),$scope.job.employees[2]&&($scope.mechanic_3_id=$scope.job.employees[2].id),$scope.job.employees[3]&&($scope.mechanic_4_id=$scope.job.employees[3].id),popoverService.show("#assign-employees",$scope.anchorElement,{placement:$scope.placement,fixed_position:!0})},$scope.save=function(){var employee_ids;return employee_ids=[$scope.mechanic_1_id,$scope.mechanic_2_id,$scope.mechanic_3_id,$scope.mechanic_4_id],spinnerService.start_spinner("#assign-employees-spinner"),Job.reassign({id:$scope.job.id,employee_ids:employee_ids,type:$scope.job.type},function(data){return spinnerService.stop_spinner("#assign-employees-spinner"),$scope.job.employees=data.employees,$scope.showing=!1,$scope.onSuccess?$scope.onSuccess():void 0})},$scope.remove_mechanic=function(mechanic){return 1===mechanic&&($scope.mechanic_1_id=void 0),2===mechanic&&($scope.mechanic_2_id=void 0),3===mechanic&&($scope.mechanic_3_id=void 0),4===mechanic?$scope.mechanic_4_id=void 0:void 0},$scope.hide=function(){return popoverService.hide("#assign-employees"),$scope.showing=!1}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adAvatar",function(){return{restrict:"AE",restrict:"AE",scope:{employee:"=ngModel",upload_url:"=uploadUrl",title:"@"},templateUrl:template("directives/ad_avatar"),controller:function($scope,spinnerService){return $scope.viewer_id=Math.floor(1e10*Math.random()+1),$scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.title||($scope.title="Photos/Documents"),$scope.viewer_placement||($scope.viewer_placement="right"),$scope.upload_files=function(){return $scope.uploading_files=!0},$scope.cancel_upload_files=function(){return $("#upload-avatar").val(void 0),$scope.uploading_files=!1},$scope.files_uploaded=function(data){return spinnerService.stop_spinner("#upload-photos-spinner-"+$scope.spinner_id),$("#upload-avatar").val(void 0),$scope.uploading_files=!1,"object"==typeof data?angular.copy(data,$scope.employee):alert("Error while uploading file(s), please check that each file is maximum 1Mb and try again.")},$scope.start_uploading=function(){return spinnerService.start_spinner("#upload-photos-spinner-"+$scope.spinner_id)}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adBillSelection",function(){return{restrict:"AE",restrict:"AE",require:"supplier,showing,title",scope:{supplier:"=",showing:"=",title:"@",anchorElement:"@",placement:"@",selection:"=",bill_payment:"=billPayment",credit_note:"=creditNote",onSelect:"&"},templateUrl:template("directives/ad_bill_selection"),controller:function($scope,spinnerService,popoverService,confirmationService,Bill){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.payment={},$scope.show=function(){return spinnerService.stop_spinner("#select-bills-spinner"),$scope.parent=$scope.bill_payment||$scope.credit_note,popoverService.show("#bill-selection",$scope.anchorElement,{placement:$scope.placement}),spinnerService.start_spinner("#loading-bills-spinner"),Bill.unpaid({supplier_id:$scope.supplier.id},function(data){return $scope.bills=data,spinnerService.stop_spinner("#loading-bills-spinner")})},$scope.hide=function(){return $scope.showing=!1,spinnerService.stop_spinner("#select-bills-spinner"),popoverService.hide("#bill-selection")},$scope.show_items=function(bill){return bill.show_items=!0},$scope.hide_items=function(bill){return bill.show_items=!1},$scope.total_allocated_amount=function(){return $scope.bills?$scope.bills.sum(function(bill){return bill.selected?parseFloat(bill.allocated_amount):0}):0},$scope.allocatable_amount=function(){return $scope.parent&&$scope.bills?$scope.parent.unallocated_amount-$scope.total_allocated_amount():0},$scope.unallocate=function(){return confirmationService.confirm("Remove all allocations?",!0,function(){return $scope.bills.each(function(bill){return $scope.deselect(bill)})})},$scope.automatic_allocate=function(){return $scope.auto_allocating?void 0:confirmationService.confirm("Automatically allocate until the payment is full allocated?",!0,function(){var remaining;return $scope.auto_allocating=!0,spinnerService.start_spinner("#auto-allocate-spinner"),remaining=$scope.allocatable_amount(),$scope.bills.each(function(bill){return remaining>0?($scope.select(bill),remaining-=bill.allocated_amount):void 0}),$scope.auto_allocating=!1,spinnerService.stop_spinner("#auto-allocate-spinner")})},$scope.select=function(bill){return $scope.parent&&(bill.allocated_amount=Math.min(bill.unpaid_amount,$scope.allocatable_amount())),bill.selected=!0,$scope.selection?$scope.selection.add(bill):void 0},$scope.deselect=function(bill){return $scope.selection&&$scope.selection.remove(bill),bill.selected=!1,bill.allocated_amount=0},$scope.do_select=function(){return $scope.onSelect?(spinnerService.start_spinner("#select-bills-spinner"),$scope.onSelect.call()):void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adBillViewer",function(){return{restrict:"AE",restrict:"AE",require:"showing",scope:{bill:"=",anchorElement:"@",placement:"@",showing:"="},templateUrl:template("directives/ad_bill_viewer"),controller:function($scope,lookupService,spinnerService,popoverService,Bill,SupplierCreditNote){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){var resource,type;return spinnerService.start_spinner("#bill-viewer-spinner"),$scope.bill&&"credit note"===$scope.bill.type?(resource=SupplierCreditNote,type="credit note"):(resource=Bill,type="bill"),resource.get({id:$scope.bill.id},function(data){return angular.copy(data,$scope.bill),$scope.bill.type=type,spinnerService.stop_spinner("#bill-viewer-spinner")}),$scope.placement||($scope.placement="left"),popoverService.show("#bill-viewer-popover",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.showing=!1,spinnerService.stop_spinner("#bill-viewer-spinner"),popoverService.hide("#bill-viewer-popover")},$scope.tax_name=function(){return lookupService.tax_name()},$scope.bill_path=function(){return $scope.bill?"credit note"===$scope.bill.type?"#/supplier_credit_notes/"+$scope.bill.id:"#/bills/"+$scope.bill.id:void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adBillpicker",function(){return{restrict:"AE",restrict:"AE",scope:{billId:"=ngModel",bill:"=",supplierId:"=",onSelect:"&",input_id:"@inputId",readonly:"="},templateUrl:template("directives/ad_billpicker"),controller:function($scope,lookupService){return $scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.lookup=function(term){return lookupService.lookup_bills({term:term,supplier_id:$scope.supplierId},"#lookup-bill-spinner-"+$scope.spinner_id,"#lookup-bill-icon-"+$scope.spinner_id)},$scope.select=function(selected_bill){return $scope.bill.id=selected_bill.id,$scope.bill.title=selected_bill.title,$scope.bill.supplier_id=selected_bill.supplier_id,$scope.billId=selected_bill.id,$scope.onSelect?$scope.onSelect():void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adBuyinSelection",function(){return{restrict:"AE",restrict:"AE",require:"showing",scope:{showing:"=",anchorElement:"@",placement:"@",selection:"=",onSelect:"&"},templateUrl:template("directives/ad_buyin_selection"),controller:function($scope,popoverService,spinnerService,Bill){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.query={query:""},$scope.search(),popoverService.show("#buyin-selection",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.showing=!1,$scope.selection=[],popoverService.hide("#buyin-selection")},$scope.show_items=function(bill){return bill.show_items=!0},$scope.hide_items=function(bill){return bill.show_items=!1},$scope.select=function(bill_item){return bill_item.selected=!0,$scope.selection?$scope.selection.add(bill_item):void 0},$scope.deselect=function(bill_item){return $scope.selection&&$scope.selection.remove(bill_item),bill_item.selected=!1},$scope.do_select=function(){return $scope.onSelect?$scope.onSelect.call():void 0},$scope.toggle_select=function(item){return item.selected?$scope.deselect(item):$scope.select(item)},$scope.search=function(page){return null==page&&(page=1),spinnerService.start_spinner("#bill-list-spinner"),Bill.all({query:$scope.query.query,order_by:"date",order:"desc",page:page,per_page:5},function(data){return $scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.bills=data.bills,spinnerService.stop_spinner("#bill-list-spinner")})},$scope.selectPage=function(number){return $scope.search(number)}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adChangeCustomer",function(){return{restrict:"AE",scope:{job:"=",invoice:"=",quote:"=",showing:"=",customer:"=",anchor_element:"@anchorElement",onTransferVehicle:"&",onChangeCustomer:"&"},templateUrl:template("directives/ad_change_customer"),controller:function($scope,Job,Invoice,Quote,popoverService,spinnerService,formService){return $scope.popover_id=Math.floor(1e10*Math.random()+1),$scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.input_id=Math.floor(1e10*Math.random()+1),$scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.invoice?$scope.editing_customer={id:$scope.invoice.id,customer:Object.clone($scope.customer||$scope.invoice.customer),account_number:$scope.invoice.account_number,claim_number:$scope.invoice.claim_number,excess:$scope.invoice.excess}:$scope.job?$scope.editing_customer={id:$scope.job.id,customer:Object.clone($scope.customer||$scope.job.customer)}:$scope.quote&&($scope.editing_customer={id:$scope.quote.id,customer:Object.clone($scope.customer||$scope.quote.customer),insurer_id:$scope.quote.insurer_id,account_number:$scope.quote.account_number,claim_number:$scope.quote.claim_number,excess:$scope.quote.excess}),popoverService.show("#"+$scope.popover_id,$scope.anchor_element,{placement:"right"}),formService.select_text("#"+$scope.input_id,300)
},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#"+$scope.popover_id)},$scope.change_customer=function(){return $scope.invoice?$scope.change_invoice_cusomter():$scope.job?$scope.change_job_cusomter():$scope.quote?$scope.change_quote_cusomter():void 0},$scope.change_invoice_cusomter=function(){return spinnerService.start_spinner("#"+$scope.spinner_id),Invoice.change_customer($scope.editing_customer,function(data){return spinnerService.stop_spinner("#"+$scope.spinner_id),angular.copy(data,$scope.invoice),$scope.customer&&angular.copy(data.customer,$scope.customer),$scope.showing=!1})},$scope.change_job_cusomter=function(){return spinnerService.start_spinner("#"+$scope.spinner_id),Job.change_customer($scope.editing_customer,function(data){return spinnerService.stop_spinner("#"+$scope.spinner_id),angular.copy(data,$scope.job),$scope.customer&&angular.copy(data.customer,$scope.customer),$scope.editing_customer.transfer_vehicle&&$scope.onTransferVehicle&&$scope.onTransferVehicle.call(),$scope.showing=!1})},$scope.change_quote_cusomter=function(){return spinnerService.start_spinner("#"+$scope.spinner_id),Quote.change_customer($scope.editing_customer,function(data){return spinnerService.stop_spinner("#"+$scope.spinner_id),angular.copy(data,$scope.quote),$scope.customer&&angular.copy(data.customer,$scope.customer),$scope.showing=!1})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adChangeVehicle",function(){return{restrict:"AE",scope:{owner:"=ngModel",model_type:"@modelType",showing:"=",onSave:"&",onCancel:"&"},templateUrl:template("directives/ad_change_vehicle"),controller:function($scope,Invoice,Quote,Job,popoverService,spinnerService,formService,lookupService){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():void 0}),$scope.show=function(){return formService.select_text("#vehicle-picker-input",300),$scope.editing_vehicle={id:$scope.owner.id,vehicle:{}},angular.copy($scope.owner.vehicle,$scope.editing_vehicle.vehicle),$scope.customer=$scope.owner.customer},$scope.resource=function(){return"invoice"===$scope.model_type?Invoice:"quote"===$scope.model_type?Quote:"job"===$scope.model_type?Job:void 0},$scope.change_vehicle=function(){return spinnerService.start_spinner("#change-vehicle-spinner"),$scope.resource().change_vehicle($scope.editing_vehicle,function(data){var _base;return(_base=$scope.owner).vehicle||(_base.vehicle={}),angular.copy(data.vehicle,$scope.owner.vehicle),$scope.onSave&&$scope.onSave(),spinnerService.stop_spinner("#change-vehicle-spinner")})},$scope.cancel=function(){return $scope.onCancel?$scope.onCancel():void 0},$scope.asset_name=function(){return lookupService.asset_name()},$scope.asset_name_plural=function(){return lookupService.asset_name_plural()}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adConfirmation",function(){return{restrict:"AE",scope:{item:"=ngModel",message:"@"},templateUrl:template("directives/ad_confirmation"),controller:function($scope,confirmationService){return $scope.cancel=function(){return confirmationService.cancel()},$scope.ok=function(){return confirmationService.ok()},$scope.message=function(){return confirmationService.message()}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adContactNameWarning",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{contact:"=ngModel",resource:"@",message:"@"},templateUrl:template("directives/ad_contact_name_warning"),controller:function($scope,lookupService,Customer,Supplier,$timeout){return $scope.$watch("contact.name",function(){return $scope.message||($scope.message="A "+$scope.resource+" with the same name exists. We recommend assign a different name for this "+$scope.resource+" or select the existing "+$scope.resource+" from the recommendations"),$scope.contact&&$scope.contact.name&&!$scope.contact.id?($scope.lookup&&$timeout.cancel($scope.lookup),$scope.lookup=$timeout($scope.search,500)):void 0}),$scope.search=function(name){return null==name&&(name=void 0),$scope.matches=[],name=name||$scope.contact.name,Customer.find_by_name({name:name},function(data){return $scope.matches=data}),null},$scope.$on("$destroy",function(){return $timeout.cancel($scope.lookup)})}}})}.call(this),function(){this.AutoWorkshopApp.directive("adCourtesyVehicleAvailability",function(){return{restrict:"AE",restrict:"AE",scope:{job:"=",booking:"=",onUpdate:"&",onSelectVehicle:"&"},templateUrl:template("directives/ad_courtesy_vehicle_availability"),controller:function($scope,$window,lookupService,spinnerService,popoverService,Vehicle,Customer,AutoWorkshop,CourtesyVehicleBooking,confirmationService){return $scope.availability_indicator=function(day){return $scope.job&&$scope.job.courtesy_vehicle_booking?day.booking&&day.booking.id===$scope.job.courtesy_vehicle_booking.id?"yellow":day.available?"#009900":"red":day.available?"#009900":"red"},$scope.highlight_indicator=function(day){var end_hightlight,highlight,start_hightlight;return $scope.job&&$scope.job.time&&$scope.job.pickup_time&&(start_hightlight=moment($scope.job.time).startOf("day"),end_hightlight=moment($scope.job.pickup_time).endOf("day"),highlight=moment(day.date).isSame(start_hightlight)||moment(day.date).isBetween(start_hightlight,end_hightlight)||moment(day.date).isSame(end_hightlight)),highlight?"black":null},$scope.jump_to_today=function(){return $scope.start_time=new Date,$scope.fetch_availabilities()},$scope.jump_back_seven_days=function(){return $scope.start_time=moment(Object.clone($scope.start_time)).subtract(7,"days").toDate(),$scope.fetch_availabilities()},$scope.jump_forward_seven_days=function(){return $scope.start_time=moment(Object.clone($scope.start_time)).add(7,"days").toDate(),$scope.fetch_availabilities()},$scope.add_new_vehicle=function(){return $scope.new_vehicle={},popoverService.show("#new-vehicle-form","#vehicle-form-anchor",{placement:"right"})},$scope.cancel_new_vehicle=function(){return popoverService.hide("#new-vehicle-form"),$scope.new_vehicle=void 0},$scope.create_vehicle=function(){return spinnerService.start_spinner("#save-vehicle-spinner"),Vehicle.create_courtesy_vehicle($scope.new_vehicle,function(){return spinnerService.stop_spinner("#save-vehicle-spinner"),popoverService.hide("#new-vehicle-form"),lookupService.fetch_courtesy_vehicles(function(){return $scope.fetch_availabilities()})})},$scope.booking_actions=function(day){return $scope.booking_error=void 0,day.available?$scope.editing_booking={vehicle_id:day.vehicle.id,check_out_time:day.date,return_time:day.date}:($scope.editing_booking={},angular.copy(day.booking,$scope.editing_booking)),popoverService.show("#vehicle-booking-form","#vehicle-form-anchor",{placement:"right"})},$scope.cancel_edit_booking=function(){return popoverService.hide("#vehicle-booking-form"),$scope.editing_booking=void 0,$scope.booking_error=void 0},$scope.save_booking=function(){var after_save;return spinnerService.start_spinner("#edit-booking-spinner"),after_save=function(data){return spinnerService.stop_spinner("#edit-booking-spinner"),data.error?$scope.booking_error=data.error:($scope.fetch_availabilities(),$scope.job&&($scope.job.replacement_provided=!0),popoverService.hide("#vehicle-booking-form")),$scope.onUpdate?$scope.onUpdate():void 0},$scope.editing_booking.id?CourtesyVehicleBooking.update($scope.editing_booking,function(data){return after_save(data)}):CourtesyVehicleBooking.save($scope.editing_booking,function(data){return after_save(data)})},$scope.delete_booking=function(booking){return confirmationService.confirm("Do you want to delete this booking ?",!0,function(){return spinnerService.start_spinner("#edit-booking-spinner"),CourtesyVehicleBooking["delete"](booking,function(data){return data.error?($scope.booking_error=data.error,spinnerService.stop_spinner("#edit-booking-spinner")):($scope.job&&$scope.job.courtesy_vehicle_booking&&$scope.job.courtesy_vehicle_booking.id===booking.id&&($scope.job.courtesy_vehicle_booking=void 0,$scope.job.replacement_provided=!1),spinnerService.stop_spinner("#edit-booking-spinner"),popoverService.hide("#vehicle-booking-form"),$scope.fetch_availabilities(),$scope.onUpdate?$scope.onUpdate():void 0)})})},$scope.select_vehicle=function(vehicle){var _base;return $scope.job&&((_base=$scope.job).courtesy_vehicle_booking||(_base.courtesy_vehicle_booking={}),$scope.job.courtesy_vehicle_booking.vehicle=vehicle,$scope.job.courtesy_vehicle_booking.vehicle_id=vehicle.id,$scope.job.courtesy_vehicle_booking.check_out_time=$scope.job.time,$scope.job.courtesy_vehicle_booking.return_time=$scope.job.pickup_time),$scope.onSelectVehicle?$scope.onSelectVehicle():void 0},$scope.$watch("job.time",function(){return $scope.job&&$scope.job.time?$scope.start_time=Object.clone($scope.job.time):void 0}),$scope.$watch("start_time",function(){return $scope.start_time?$scope.fetch_availabilities():void 0}),$scope.fetch_availabilities=function(){var from,to;if($scope.start_time)return from=$scope.start_time,to=moment($scope.start_time).add($scope.time_frame,"days").toDate(),spinnerService.start_spinner("#bookings-spinner"),CourtesyVehicleBooking.all({from:from,to:to},function(data){return spinnerService.stop_spinner("#bookings-spinner"),$scope.courtesy_vehicle_availabilities=$scope.availabilities(data)})},$scope.remove=function(vehicle_id){return confirmationService.confirm("Remove this courtesy vehicle?",!0,function(){return Vehicle.update({id:vehicle_id,is_courtesy_vehicle:!1},function(){return lookupService.fetch_courtesy_vehicles(function(){return $scope.fetch_availabilities()})})})},$scope.availabilities=function(data){var day_in_milliseconds,results,start_date;return results={},day_in_milliseconds=864e5,start_date=moment($scope.start_time).startOf("day"),lookupService.courtesy_vehicles().forEach(function(vehicle){var init_days,key;return key=vehicle.id,init_days=Array.apply(null,Array($scope.time_frame)),init_days=init_days.map(function(object,index){var date;return{date:date=moment(start_date).add(index,"days").toDate(),vehicle:vehicle,available:!0}}),results[key]={vehicle:vehicle,days:init_days}}),data.forEach(function(booking){var check_out_date,index,key,return_date,running_date,_results;if(booking.vehicle&&booking.vehicle.id){for(key=booking.vehicle.id,check_out_date=moment(booking.check_out_time).startOf("day"),return_date=moment(booking.return_time).startOf("day"),running_date=check_out_date,_results=[];return_date-running_date>=0;)index=running_date.diff(start_date,"days"),results[key]&&results[key].days[index]&&(results[key].days[index].booking=booking,results[key].days[index].available=!1),_results.push(running_date=moment(running_date).add(1,"days"));return _results}}),$scope.date_1=moment($scope.start_time).toDate(),$scope.date_2=moment($scope.start_time).add(7,"days").toDate(),$scope.date_3=moment($scope.start_time).add(14,"days").toDate(),$scope.date_4=moment($scope.start_time).add(21,"days").toDate(),$scope.date_5=moment($scope.start_time).add(28,"days").toDate(),results},$scope.date_marker_padding=[0,1,2,3],$scope.time_frame=30,$scope.start_time=new Date}}})}.call(this),function(){this.AutoWorkshopApp.directive("adCustomer",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{customer:"=ngModel",onSave:"&",onSelectVehicle:"&",showInvoices:"=",allowRename:"@"},templateUrl:template("directives/ad_customer"),controller:function($scope,$window,lookupService,formService,spinnerService,Customer){return $scope.payment_terms=lookupService.payment_terms(),$scope.left_side="details",$scope.add_street_address=function(){return $scope.customer.editing.street_address={}},$scope.country=function(){return lookupService.configurations()?lookupService.configurations().country:void 0},$scope.tax_registration_name=function(){return lookupService.configurations()?lookupService.configurations().tax_registration_name:void 0},$scope.edit=function(element){var copy;return copy={},angular.copy(element,copy),element.editing=copy},$scope.customer_updated=function(){return angular.copy($scope.customer.editing,$scope.customer),$scope.onSave?$scope.onSave($scope.customer.editing):void 0},$scope.cancel_edit=function(){return formService.cancel($scope.customer,"editing")},$scope.asset_name=function(){return lookupService.asset_name()},$scope.asset_name_plural=function(){return lookupService.asset_name_plural()},$scope.show_left_side=function(menu_name){return $scope.left_side=menu_name,"vehicles"===menu_name&&$scope.customer&&$scope.customer.vehicles&&$scope.customer.vehicles.length>=30?$scope.load_vehicles():void 0},$scope.load_vehicles=function(number){return null==number&&(number=1),$scope.customer?(spinnerService.start_spinner("#customer-vehicle-list-spinner"),Customer.vehicles({id:$scope.customer.id,page:number},function(data){return $scope.vehicle_page_number=data.meta.page,$scope.vehicle_total_pages=data.meta.total_pages,$scope.customer.vehicles=data.vehicles,spinnerService.stop_spinner("#customer-vehicle-list-spinner")})):void 0},$scope.selectVehiclePage=function(number){return $scope.load_vehicles(number)},$scope.create_contact=function(){return $scope.new_contact={}},$scope.cancel_new_contact=function(){return $scope.new_contact=void 0},$scope.save_new_contact=function(){return spinnerService.start_spinner("#customer-contacts-spinner"),Customer.create_contact({id:$scope.customer.id,contact:$scope.new_contact},function(data){return spinnerService.stop_spinner("#customer-contacts-spinner"),$scope.customer.contacts.push(data),$scope.new_contact=void 0})},$scope.edit_contact=function(contact){return formService.edit_fields(contact,"editing")},$scope.cancel_editing_contact=function(contact){return contact.editing=void 0},$scope.save_contact=function(contact){return spinnerService.start_spinner("#customer-contacts-spinner"),Customer.update_contact({id:$scope.customer.id,contact:contact.editing},function(data){return spinnerService.stop_spinner("#customer-contacts-spinner"),angular.copy(data,contact)})},$scope.destroy_contact=function(contact){return spinnerService.start_spinner("#customer-contacts-spinner"),Customer.destroy_contact({id:$scope.customer.id,contact:contact},function(){return spinnerService.stop_spinner("#customer-contacts-spinner"),$scope.customer.contacts.remove(contact)})},$scope.select_vehicle=function(vehicle){return $scope.onSelectVehicle?$scope.onSelectVehicle({vehicle:vehicle}):void 0},$scope.customer_price_level_name=function(){return $scope.customer?lookupService.customer_price_level_name($scope.customer.price_level):void 0},$scope.price_levels=function(){return[1,2,3,4,5,6,7].map(function(price_level){return{value:price_level,name:lookupService.customer_price_level_name(price_level)}})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adCustomerCommunication",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{customer_communication:"=ngModel",showing:"=",anchorElement:"@",placement:"@",onSave:"&",customer_communication_type:"=customerCommunicationType",service_schedule_ids:"=serviceScheduleIds"},templateUrl:template("directives/ad_customer_communication"),controller:function($scope,$window,lookupService,formService,spinnerService,popoverService,CustomerCommunication){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.customer_communication||($scope.customer_communication={}),$scope.customer_communication_type&&($scope.customer_communication.subject=$scope.customer_communication_type.communication_template.subject,$scope.customer_communication.message=$scope.customer_communication_type.communication_template.message,$scope.customer_communication.delivery_method=$scope.customer_communication_type.delivery_method,$scope.customer_communication.customer_communication_type_id=$scope.customer_communication_type.id,$scope.customer_communication.communication_template_id=$scope.customer_communication_type.communication_template.id),popoverService.show("#send-reminder-dialog",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return popoverService.hide("#send-reminder-dialog")},$scope.cancel_reminder=function(){return $scope.showing=!1},$scope.send_reminder=function(){return spinnerService.start_spinner("#send-reminder-spinner"),$scope.customer_communication.service_schedule_ids=$scope.service_schedule_ids,CustomerCommunication.save($scope.customer_communication,function(data){return spinnerService.stop_spinner("#send-reminder-spinner"),angular.copy(data,$scope.customer_communication),$scope.showing=!1,$scope.onSave&&$scope.onSave(),$scope.customer_communication={}})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adCustomerCommunications",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{customer_communications:"=ngModel",refresh:"="},templateUrl:template("directives/ad_customer_communications"),controller:function($scope,$window,timeService,popoverService,spinnerService,lookupService,CustomerCommunication){return $scope.show=function(customer_communication){return popoverService.show("#showing-customer-communication-popover","#customer-communications",{placement:"left"}),spinnerService.start_spinner("#loading-customer-communication-spinner"),CustomerCommunication.get({id:customer_communication.id},function(data){return $scope.showing_customer_communication||($scope.showing_customer_communication={}),angular.copy(data,$scope.showing_customer_communication),spinnerService.stop_spinner("#loading-customer-communication-spinner")})},$scope.close=function(){return popoverService.hide("#showing-customer-communication-popover"),$scope.showing_customer_communication=void 0},$scope.show_receivers=function(){return $scope.showing_receivers=!0},$scope.hide_receivers=function(){return $scope.showing_receivers=!1},$scope.show_uncommunicated_attempts=function(){return $scope.showing_uncommunicated_attempts=!0},$scope.hide_uncommunicated_attempts=function(){return $scope.showing_uncommunicated_attempts=!1},$scope.sending_started=function(sending){return $scope.sending=sending},$scope.sending_finished=function(){return $scope.sending=void 0},$scope.asset_name=function(){return lookupService.asset_name()},$scope.asset_name_plural=function(){return lookupService.asset_name_plural()},$scope.fetch_customer_communications=function(page){return null==page&&(page=1),CustomerCommunication.all({page:page},function(data){return angular.copy(data.customer_communications,$scope.customer_communications),$scope.page=data.meta.page,$scope.total_pages=data.meta.total_pages})},$scope.refresh_customer_communications=function(){var sending;return sending=$scope.customer_communications.find(function(customer_communication){return"processed"!==customer_communication.status&&"cancelled"!==customer_communication.status}),sending||!$scope.pulled?(void 0===$scope.sending&&$scope.sending_started(sending),$scope.fetch_customer_communications($scope.page),$scope.pulled=!0):void 0!==$scope.sending&&$scope.sending_finished(),timeService.timeout(function(){return $scope.refresh_customer_communications()},1e4)},$scope.refresh_customer_communications()}}})}.call(this),function(){this.AutoWorkshopApp.directive("adCustomerForm",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{customer:"=ngModel",allowRename:"=",onSave:"&",onCancel:"&"},templateUrl:template("directives/ad_customer_form"),controller:function($scope,lookupService,spinnerService,Customer){return $scope.add_street_address=function(){return $scope.customer.street_address={}},$scope.cancel=function(){return $scope.onCancel?$scope.onCancel():void 0},$scope.country=function(){return lookupService.configurations()?lookupService.configurations().country:void 0},$scope.tax_registration_name=function(){return lookupService.configurations()?lookupService.configurations().tax_registration_name:void 0},$scope.save=function(){return $scope.do_save(function(data){return angular.copy(data,$scope.customer),$scope.onSave?$scope.onSave(data):void 0})},$scope.show_more_customer_fields=function(){return $scope.showing_more_customer_fields=!0},$scope.do_save=function(callback){return $scope.customer.id?(spinnerService.start_spinner("#saving-customer-spinner"),Customer.update($scope.customer,function(data){return lookupService.fetch_insurers(),callback(data),spinnerService.stop_spinner("#saving-customer-spinner")})):lookupService.business_source_required()&&!$scope.customer.business_source_id?alert("Please select the customer's source of business"):(spinnerService.start_spinner("#saving-customer-spinner"),Customer.save($scope.customer,function(data){return lookupService.fetch_insurers(),callback(data),spinnerService.stop_spinner("#saving-customer-spinner")}))},$scope.payment_terms=lookupService.payment_terms(),$scope.insurers=lookupService.insurers(),$scope.price_levels=function(){return[1,2,3,4,5,6,7].map(function(price_level){return{value:price_level,name:lookupService.customer_price_level_name(price_level)}})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adCustomerVehicleForm",function(VehicleModel){return{restrict:"AE",restrict:"AE",scope:{selection:"=",recommendations:"=",vehicle:"=",customer:"="},templateUrl:template("directives/ad_customer_vehicle_form"),controller:function($scope,lookupService,spinnerService,formService,recommendationService,timeService,$timeout){return $scope.asset_property_set=function(){return lookupService.asset_property_set()},$scope.makes=lookupService.makes(),$scope.vehicle_models=[],$scope.vehicle_body_types=lookupService.vehicle_body_types(),$scope.payment_terms=lookupService.payment_terms(),$scope.vehicle_drive_types=lookupService.vehicle_drive_types(),$scope.vehicle_transmission_types=lookupService.vehicle_transmission_types(),$scope.fuel_types=lookupService.fuel_types(),$scope.exhaust_systems=lookupService.exhaust_systems(),$scope.exhaust_headers=lookupService.exhaust_headers(),$scope.odometer_units=lookupService.odometer_units(),$scope.air_intakes=lookupService.air_intakes(),$scope.entered_customer_data={},$scope.entered_vehicle_data={},$scope.$watch("selection.customer",function(newValue,oldValue){return newValue?(oldValue||$scope.customer.id||angular.copy($scope.customer,$scope.entered_customer_data),newValue!==$scope.customer?(angular.copy(newValue,$scope.customer),$scope.customer.vehicles=void 0):void 0):angular.copy($scope.entered_customer_data,$scope.customer)}),$scope.$watch("selection.vehicle",function(newValue,oldValue){return newValue?(oldValue||$scope.vehicle.id||angular.copy($scope.vehicle,$scope.entered_vehicle_data),newValue!==$scope.vehicle?angular.copy(newValue,$scope.vehicle):void 0):angular.copy($scope.entered_vehicle_data,$scope.vehicle)}),$scope.update_models=function(){return $scope.vehicle_models=VehicleModel.models({make:$scope.vehicle.make})},$scope.unselect_customer=function(){return $scope.selection.customer=null,$scope.selection.vehicle=null,$scope.search_recommendations(),formService.select_text("#ad-customer-vehicle-form-name")},$scope.edit_customer=function(){return $scope.customer.editing=!0,formService.select_text("#ad-customer-vehicle-form-name")},$scope.unselect_vehicle=function(){return $scope.selection.vehicle=null,$scope.search_recommendations()},$scope.search_recommendations=function(){return $scope.selection.vehicle||$scope.selection.customer?void 0:($scope.counter||($scope.counter=0),$scope.counter+=1,timeService.cancel_timeout($scope.searching),$scope.searching=$timeout(function(){return $scope.looking_up($scope.counter)},500))},$scope.$on("$destroy",function(){return $timeout.cancel($scope.searching)}),$scope.looking_up=function(counter){var search;return search={vehicle:{},customer:{}},$scope.vehicle.registration_number&&(search.vehicle.registration_number=$scope.vehicle.registration_number),$scope.vehicle.vin&&(search.vehicle.vin=$scope.vehicle.vin),$scope.vehicle.fleet_number&&(search.vehicle.fleet_number=$scope.vehicle.fleet_number),$scope.customer.name&&(search.customer.name=$scope.customer.name),$scope.customer.phone&&(search.customer.phone=$scope.customer.phone),$scope.customer.mobile&&(search.customer.mobile=$scope.customer.mobile),$scope.customer.email&&(search.customer.email=$scope.customer.email),spinnerService.start_spinner("#recommendation-spinner"),recommendationService.recommendations(search,function(data){return $scope.counter===counter?(angular.copy(data,$scope.recommendations),spinnerService.stop_spinner("#recommendation-spinner")):void 0}),null},$scope.update_custom_attribute=function(attribute_id,event){var value;return value=event.target.getVal(),$scope.vehicle.custom_attributes||($scope.vehicle.custom_attributes={}),$scope.vehicle.custom_attributes[attribute_id]=value},$scope.asset_name=function(){return lookupService.asset_name()},$scope.add_street_address=function(){return $scope.customer.street_address={}},$scope.asset_name_plural=function(){return lookupService.asset_name_plural()},$scope.price_levels=function(){return[1,2,3,4,5].map(function(price_level){return{value:price_level,name:lookupService.customer_price_level_name(price_level)}})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adCustomerVehicleRecommendations",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{recommendations:"=ngModel",owner:"=",selection:"="},templateUrl:template("directives/ad_customer_vehicle_recommendations"),controller:function($scope,Vehicle,Customer,$timeout,lookupService,popoverService,spinnerService){return $scope.select_customer=function(customer){return $scope.selection.customer=customer,$scope.owner&&customer.insurer_id?($scope.owner.insurer_id=customer.insurer_id,$scope.owner.account_number=customer.third_party_account_number):void 0},$scope.unselect_customer=function(){return $scope.selection.customer=void 0,$scope.selection.vehicle=void 0,$scope.owner?$scope.owner.insurer_id=void 0:void 0},$scope.select_vehicle=function(vehicle){return $scope.selection.vehicle=vehicle},$scope.asset_name=function(){return lookupService.asset_name()},$scope.asset_name_plural=function(){return lookupService.asset_name_plural()},$scope.hide_customer_balance=function(){return lookupService.configurations()?lookupService.configurations().hide_customer_balance_on_job_creation:void 0},$scope.search_vehicles=function(customer){return customer.vehicle_search&&$timeout.cancel(customer.vehicle_search),customer.vehicle_search=$timeout(function(){return customer.vehicle_search_text&&customer.vehicle_search_text.length>0?Vehicle.lookup({term:customer.vehicle_search_text,customer_id:customer.id},function(data){return customer.vehicles=data}):Customer.vehicles({id:customer.id,per_page:30},function(data){return customer.vehicles=data.vehicles})},500)},$scope.open_service_book=function(){return popoverService.show("#service-book-popover","#recommendation-header",{placement:"bottom"}),spinnerService.start_spinner("#service-book-spinner"),$scope.showing_vehicle={},angular.copy($scope.selection.vehicle,$scope.showing_vehicle),Vehicle.get({id:$scope.selection.vehicle.id},function(data){return angular.copy(data,$scope.showing_vehicle),spinnerService.stop_spinner("#service-book-spinner")})},$scope.close_service_book=function(){return popoverService.hide("#service-book-popover")}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adDateRangeSelection",function(){return{restrict:"AE",restrict:"AE",scope:{from:"=",to:"=",onSelect:"&"},templateUrl:template("directives/ad_date_range_selection"),controller:function($scope,$timeout){return $scope.select_today=function(){var today;return today=moment().startOf("day"),$scope.set_date_range(today,today)},$scope.select_one_month_back=function(){var one_months_ago,today;return today=moment().startOf("day"),one_months_ago=moment().subtract("months",1).add(1,"day").startOf("day"),$scope.set_date_range(one_months_ago,today)},$scope.select_month_to_date=function(){var start_month,today;return today=moment().startOf("day"),start_month=moment().startOf("month"),$scope.set_date_range(start_month,today)},$scope.select_last_month=function(){var end_month,start_month;return start_month=moment().subtract("months",1).startOf("month"),end_month=moment().subtract("months",1).endOf("month"),$scope.set_date_range(start_month,end_month)},$scope.select_last_two_weeks=function(){var today,two_weeks_ago;return today=moment().startOf("day"),two_weeks_ago=moment().subtract("weeks",2).add(1,"day"),$scope.set_date_range(two_weeks_ago,today)},$scope.set_date_range=function(from,to){return $scope.from=from.toDate(),$scope.to=to.toDate(),$scope.onSelect?$timeout(function(){return $scope.onSelect()}):void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adDiary",function(){return{restrict:"AE",scope:{diary:"=ngModel",onSave:"=",anchorElement:"@",placement:"@",showing:"="},templateUrl:template("directives/ad_diary"),controller:function($scope,popoverService,AutoWorkshop){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.save=function(){return AutoWorkshop.update_diary($scope.diary,function(){return $scope.showing=!1,$scope.onSave?$scope.onSave():void 0})},$scope.show=function(){return popoverService.show("#diary",$scope.anchorElement,{placement:$scope.placement})},$scope.cancel=function(){return $scope.showing=!1},$scope.hide=function(){return popoverService.hide("#diary")}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adEmailPurchaseOrder",function(){return{restrict:"AE",restrict:"AE",require:"ngModel,showing",scope:{purchase:"=ngModel",anchorElement:"@",showing:"=",title:"@",placement:"@"},templateUrl:template("directives/ad_email_purchase_order"),controller:function($scope,spinnerService,popoverService,Purchase){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.title||($scope.title="Email Purchase Order"),$scope.email=$scope.purchase.supplier.email,$scope.subject=$scope.purchase.email_preview.subject||"Our purchase order is attached",$scope.message=$scope.purchase.email_preview.message||"Our purchase order is attached",popoverService.show("#email-purchase-order",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#email-purchase-order")},$scope.select_contact=function(contacts){var emails;return emails=contacts.map(function(c){return c.email}),emails&&emails.length>0?$scope.email=emails.join(";"):void 0},$scope.send_email=function(){var attached_files;return spinnerService.start_spinner("#email-purchase-spinner"),attached_files=$scope.purchase.documents.findAll(function(d){return d.attached}),attached_files=attached_files.concat($scope.purchase.photos.findAll(function(d){return d.attached})),attached_files=attached_files.map(function(f){return f.id}),Purchase.send_order({id:$scope.purchase.id,email:$scope.email,message:$scope.message,delivery_notification_required:$scope.delivery_notification_required,attachments:attached_files},function(data){return spinnerService.stop_spinner("#email-purchase-spinner"),data.error?alert(data.error.message):$scope.showing=!1})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adEmailQuote",function(){return{restrict:"AE",restrict:"AE",require:"ngModel,showing",scope:{quote:"=ngModel",job:"=",anchorElement:"@",showing:"=",title:"@",placement:"@"},templateUrl:template("directives/ad_email_quote"),controller:function($scope,spinnerService,popoverService,Quote){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.title||($scope.title="Email Quote"),$scope.customer=$scope.send_to(),$scope.customer&&($scope.email=$scope.customer.email),$scope.subject=$scope.quote.email_preview.subject,$scope.message=$scope.quote.email_preview.message,popoverService.show("#email-quote",$scope.anchorElement,{placement:$scope.placement})},$scope.send_to=function(){return $scope.quote.paying_customer?$scope.quote.paying_customer:$scope.quote.customer?$scope.quote.customer:$scope.job&&$scope.job.insurer?$scope.job.insurer:$scope.job&&$scope.job.customer?$scope.job.customer:void 0},$scope.hide=function(){return $scope.showing=!1,$scope.attached_files=!1,$scope.selected_files().forEach(function(f){return f.attached=!1}),popoverService.hide("#email-quote")},$scope.select_contact=function(contacts){var emails;return emails=contacts.map(function(c){return c.email}),emails&&emails.length>0?$scope.email=emails.join(";"):void 0},$scope.selected_files=function(){var selected_files;return selected_files=[],$scope.attached_files&&($scope.quote.documents&&(selected_files=selected_files.concat($scope.quote.documents.findAll(function(d){return d.attached
}))),$scope.job&&$scope.job.documents&&(selected_files=selected_files.concat($scope.job.documents.findAll(function(d){return d.attached}))),$scope.quote.photos&&(selected_files=selected_files.concat($scope.quote.photos.findAll(function(d){return d.attached}))),$scope.job&&$scope.job.photos&&(selected_files=selected_files.concat($scope.job.photos.findAll(function(d){return d.attached})))),selected_files},$scope.send_email=function(){var attached_files;return $scope.email&&""!==$scope.email?(spinnerService.start_spinner("#email-quote-spinner"),attached_files=$scope.selected_files().map(function(f){return f.id}),Quote.send_email({id:$scope.quote.id,email:$scope.email,subject:$scope.subject,message:$scope.message,delivery_notification_required:$scope.delivery_notification_required,attached_files:attached_files},function(data){return spinnerService.stop_spinner("#email-quote-spinner"),data.error?alert(data.error.message):$scope.showing=!1})):alert("Please enter an email address")}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adEmailStatement",function(){return{restrict:"AE",restrict:"AE",require:"ngModel,showing",scope:{anchorElement:"@",defaultEmail:"=",customer:"=",showing:"=",title:"@",placement:"@"},templateUrl:template("directives/ad_email_statement"),controller:function($scope,spinnerService,popoverService,Customer){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.email=$scope.defaultEmail,$scope.customer.statement_email_preview&&($scope.subject=$scope.customer.statement_email_preview.subject,$scope.message=$scope.customer.statement_email_preview.message),popoverService.show("#email-statement",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#email-statement")},$scope.send_email=function(){var options;return spinnerService.start_spinner("#email-statement-spinner"),options={id:$scope.customer.id,email:$scope.email,subject:$scope.subject,message:$scope.message},Customer.send_statement(options,function(data){return spinnerService.stop_spinner("#email-statement-spinner"),data.error?alert(data.error.message):$scope.showing=!1})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adEmployeeTag",function(){return{restrict:"AE",restrict:"AE",require:"employees",scope:{employees:"=",empty:"@"},templateUrl:template("directives/ad_employee_tag"),controller:function(){}}})}.call(this),function(){this.AutoWorkshopApp.directive("adExistingVehicleWarning",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{vehicle:"=ngModel",message:"@"},templateUrl:template("directives/ad_existing_vehicle_warning"),controller:function($scope,lookupService,Vehicle,$timeout){return $scope.$watch("vehicle.registration_number",function(){return $scope.message||($scope.message="A vehicle with the same registration number exists.\nPlease check to avoid duplication"),$scope.vehicle&&$scope.vehicle.registration_number&&!$scope.vehicle.id?($scope.lookup&&$timeout.cancel($scope.lookup),$scope.lookup=$timeout($scope.search,500)):void 0}),$scope.search=function(){return $scope.matches=[],Vehicle.find_by($scope.vehicle,function(data){return $scope.matches=data}),null},$scope.$on("$destroy",function(){return $timeout.cancel($scope.lookup)})}}})}.call(this),function(){this.AutoWorkshopApp.directive("adEzyParts",function(){return{restrict:"AE",restrict:"AE",scope:{job:"=job",invoice:"=invoice",quote:"=quote",purchase:"=purchase",onUpdate:"&",account:"="},templateUrl:template("directives/ad_ezy_parts"),controller:function($scope,$timeout,lookupService,formService,popoverService,spinnerService,Job,OscarSupplierSystems){return $scope.ezy_parts_button_id=Math.floor(1e10*Math.random()+1),$scope.autopro_button_id=Math.floor(1e10*Math.random()+1),$scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.popover_id=Math.floor(1e10*Math.random()+1),$scope.status="Connecting...",$scope.status_message="Please wait, We are sending request...",$scope.ezy_parts_account=function(){return lookupService.ezy_parts_account()},$scope.autopro_account=function(){return lookupService.autopro_account()},$scope.send=function(account){var callback;return $timeout.cancel($scope.checking),popoverService.show("#"+$scope.popover_id,"#"+$scope.ezy_parts_button_id,{placement:"left"}),callback=function(){return $scope.send_request(account)},$scope.quote||$scope.purchase?callback():($scope.invoice=$scope.invoice||{},$scope.invoice.id?callback():$scope.job&&$scope.job.id?($scope.creating_invoice=!0,Job.create_invoice({id:$scope.job.id},function(data){return $scope.creating_invoice=!1,angular.copy(data,$scope.invoice),callback()})):void 0)},$scope.send_request=function(account){var options;return options={account_id:account.id},$scope.invoice?options.invoice_id=$scope.invoice.id:$scope.quote?options.quote_id=$scope.quote.id:$scope.purchase&&(options.purchase_id=$scope.purchase.id),spinnerService.start_spinner("#"+$scope.spinner_id),OscarSupplierSystems.inquire(options,function(data){var update;return spinnerService.stop_spinner("#"+$scope.spinner_id),$scope.status="Connected to "+account.third_party,$scope.status_message="Request sent with Request ID: "+data.request_id+", Please select the parts/log book service from "+account.third_party+". We are checking for your selection every 5 seconds ...",$scope.request_id=data.request_id,options.request_id=data.request_id,update=function(){return $scope.check_update(account,options),null},$scope.checking=$timeout(update,1e4)})},$scope.cancel=function(){return $timeout.cancel($scope.checking),popoverService.hide("#"+$scope.popover_id)},$scope.check_update=function(account,options){return spinnerService.start_spinner("#"+$scope.spinner_id),OscarSupplierSystems.check_update(options,function(data){var update;return spinnerService.stop_spinner("#"+$scope.spinner_id),data.in_progress||data.error?(data.error&&alert(data.error),update=function(){return $scope.check_update(account,options),null},$scope.checking=$timeout(update,3e3)):($scope.status="Connected to "+account.third_party,$scope.status_message="Finished, Please wait we are refreshing the data",spinnerService.start_spinner("#"+$scope.spinner_id),$scope.onUpdate?(spinnerService.stop_spinner("#"+$scope.spinner_id),$scope.onUpdate({account:account}),popoverService.hide("#"+$scope.popover_id)):void 0)})},$scope.$on("$destroy",function(){return $timeout.cancel($scope.checking)})}}})}.call(this),function(){this.AutoWorkshopApp.directive("adFiles",function(){return{restrict:"AE",restrict:"AE",scope:{owner:"=ngModel",upload_url:"=uploadUrl",title:"@",viewer_placement:"@viewerPlacement"},templateUrl:template("directives/ad_files"),controller:function($scope,spinnerService,popoverService,formService,DbFile){return $scope.viewer_id=Math.floor(1e10*Math.random()+1),$scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.title||($scope.title="Photos/Documents"),$scope.viewer_placement||($scope.viewer_placement="right"),$scope.upload_files=function(){return $scope.uploading_files=!0},$scope.cancel_upload_files=function(){return $("#upload-file1").val(void 0),$("#upload-file2").val(void 0),$("#upload-file3").val(void 0),$scope.uploading_files=!1},$scope.files_uploaded=function(data){return spinnerService.stop_spinner("#upload-photos-spinner-"+$scope.spinner_id),$("#upload-file1").val(void 0),$("#upload-file2").val(void 0),$("#upload-file3").val(void 0),$scope.uploading_files=!1,"object"==typeof data?angular.copy(data,$scope.owner):alert("Error while uploading file(s), please check that each file is maximum 1Mb and try again.")},$scope.start_uploading=function(){return spinnerService.start_spinner("#upload-photos-spinner-"+$scope.spinner_id)},$scope.view_photo=function(photo){return photo.active=!0,popoverService.show("#photo-viewer-"+$scope.viewer_id,"#photo-list",{placement:$scope.viewer_placement})},$scope.full_size_photo=function(){var active_photo;return active_photo=$scope.owner.photos.find(function(p){return p.active}),window.open(active_photo.url)},$scope.close_photo_viewer=function(){return popoverService.hide("#photo-viewer-"+$scope.viewer_id),$scope.owner.photos.each(function(p){return p.active=!1})},$scope.remove_photo=function(photo){return DbFile["delete"](photo,function(){return $scope.owner.photos.remove(photo),0===$scope.owner.photos.length?$scope.close_photo_viewer():void 0})},$scope.edit_file=function(document){return formService.edit_fields(document,"editing","id","file_name")},$scope.cancel_edit_file=function(document){return formService.cancel(document,"editing")},$scope.rename_file=function(document){return DbFile.rename(document.editing,function(data){return document.file_name=data.file_name,document.editing=void 0})},$scope.remove_file=function(document){return"Signature"===document.type?alert("You cannot delete a signed job card"):DbFile["delete"](document,function(){return $scope.owner.documents.remove(document)})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adFinishJob",function(){return{restrict:"AE",restrict:"AE",require:"ngModel,showing",scope:{job:"=ngModel",showing:"=",onPaying:"&",anchorElement:"@",vehicle:"="},templateUrl:template("directives/ad_finish_job"),controller:function($scope,formService,popoverService,spinnerService,lookupService,Job,Vehicle){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.asset_property_set=function(){return lookupService.asset_property_set()},$scope.show_hubodometer=function(){return $scope.vehicle&&lookupService.servicing("truck","bus")},$scope.show_odometer=function(){return $scope.vehicle},$scope.show_machine_hours=function(){return $scope.vehicle&&$scope.asset_property_set().machine_hours},$scope.show_engine_hours=function(){return $scope.vehicle&&$scope.asset_property_set().engine_hours},$scope.show_port_engine_hours=function(){return $scope.vehicle&&$scope.asset_property_set().port_engine_hours},$scope.show_starboard_engine_hours=function(){return $scope.vehicle&&$scope.asset_property_set().starboard_engine_hours},$scope.show_next_service=function(){return $scope.vehicle},$scope.show_registration_due_date=function(){return $scope.vehicle&&$scope.asset_property_set().registration_due_date},$scope.show_wof=function(){return $scope.vehicle&&lookupService.configurations()&&!lookupService.configurations().no_wof},$scope.show=function(){return $scope.communications={sms:"",email:""},$scope.sms_preview=Job.done_sms_preview({id:$scope.job.id}),$scope.email_preview=Job.done_email_preview({id:$scope.job.id}),$scope.vehicle||($scope.vehicle=$scope.job.vehicle),$scope.customer=$scope.job.customer,$scope.vehicle&&$scope.vehicle.service_schedule&&($scope.job.wof_date=$scope.vehicle.service_schedule.wof_date),$scope.vehicle&&$scope.next_service_date()&&($scope.job.next_service_date=$scope.next_service_date()),$scope.vehicle&&$scope.show_registration_due_date()&&($scope.job.registration_due_date=$scope.vehicle.registration_due_date),$scope.vehicle&&$scope.next_wof_date()&&($scope.job.wof_date=$scope.next_wof_date()),$scope.vehicle&&($scope.job.service_note=$scope.vehicle.service_note,$scope.vehicle.service_note&&($scope.service_note=!0)),$scope.customer.mobile&&"sms"===lookupService.default_job_complete_communication()?$scope.communications.sms=!0:$scope.customer.email&&"email"===lookupService.default_job_complete_communication()&&($scope.communications.email=!0),popoverService.show("#finish-popover",$scope.anchorElement,{placement:"left"})},$scope.next_service_date=function(){var next_service_date;return next_service_date=void 0,$scope.job.job_types.length>0&&$scope.job.job_types.forEach(function(jt){return!jt.next_service_days||next_service_date||jt.is_wof?void 0:(next_service_date=new Date,next_service_date.setDate(next_service_date.getDate()+parseInt(jt.next_service_days)))}),!next_service_date&&$scope.vehicle&&$scope.vehicle.service_schedule&&$scope.vehicle.service_schedule.next_service_date&&(next_service_date=new Date($scope.vehicle.service_schedule.next_service_date)),next_service_date},$scope.clear_service_note=function(){return $scope.job.service_note="",formService.select_text("#finish-job-service-note")},$scope.add_service_note=function(){return $scope.service_note=!0,formService.select_text("#finish-job-service-note")},$scope.next_wof_date=function(){var next_wof_date;return next_wof_date=void 0,$scope.job.job_types.length>0&&$scope.job.job_types.forEach(function(jt){return jt.next_service_days&&jt.is_wof&&!next_wof_date?(next_wof_date=new Date,next_wof_date.setDate(next_wof_date.getDate()+parseInt(jt.next_service_days))):void 0}),!next_wof_date&&$scope.vehicle&&$scope.vehicle.service_schedule&&$scope.vehicle.service_schedule.wof_date&&(next_wof_date=new Date($scope.vehicle.service_schedule.wof_date)),next_wof_date},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#finish-popover")},$scope.country=function(){return lookupService.configurations()?lookupService.configurations().country:void 0},$scope.wof_name=function(){return lookupService.configurations()?lookupService.wof_name():void 0},$scope.add_follow_up=function(){var follow_up_days;return follow_up_days=lookupService.follow_up_days()||15,$scope.follow_up={date:moment(new Date).add(follow_up_days,"days").toDate(),delivery_method:"email"}},$scope.edit_next_service_date=function(){return $scope.follow_up={date:moment(new Date).add(15,"days").toDate(),delivery_method:"email"}},$scope.cancel_follow_up=function(){return $scope.follow_up=void 0},$scope.save=function(paying){return null==paying&&(paying=!1),formService.submit_form($scope,$scope.finish_job_form,function(){var params;return spinnerService.start_spinner("#finish-job-spinner"),params={id:$scope.job.id,next_service_date:$scope.job.next_service_date,registration_due_date:$scope.job.registration_due_date,wof_date:$scope.job.wof_date,sms:$scope.communications.sms,email:$scope.communications.email,odometer:$scope.job.odometer,machine_hours:$scope.job.machine_hours,engine_hours:$scope.job.engine_hours,port_engine_hours:$scope.job.port_engine_hours,starboard_engine_hours:$scope.job.starboard_engine_hours,hubodometer:$scope.job.hubodometer,service_note:$scope.job.service_note,no_invoice:$scope.job.no_invoice},$scope.job.invoice||$scope.job.invoice.id||!$scope.job.no_invoice||(params.no_invoice=!0),$scope.job.finished_time&&(params.finished_time=$scope.job.finished_time),$scope.follow_up&&$scope.follow_up.message&&$scope.follow_up.message.length>0&&(params.follow_up=$scope.follow_up),Job.finish(params,function(data){return spinnerService.stop_spinner("#finish-job-spinner"),angular.copy(data,$scope.job),$scope.hide(),data.vehicle&&($scope.vehicle=Vehicle.get({id:data.vehicle.id})),paying&&$scope.onPaying?$scope.onPaying(data):void 0})})}}}})}.call(this),function(){var __slice=[].slice;this.AutoWorkshopApp.directive("adFundsAvailable",function(){return{restrict:"AE",restrict:"AE",scope:{invoice:"=",onComplete:"&"},templateUrl:template("directives/ad_funds_available"),controller:function($scope,$window,spinnerService,popoverService,lookupService,Customer,CreditNote,Payment,Invoice){return $scope.show_funds=function(){var total_inv_unpaid_amount;return popoverService.show("#available-credit-popover","#available-credit",{placement:"right"}),$scope.funds=[],total_inv_unpaid_amount=$scope.invoice.unpaid_amount,$scope.transactions.each(function(f){var fund;return f.unallocated_amount>0?(fund={id:f.id,original_amount:f.unallocated_amount,allocated_amount:0,selected:!1,number:f.number,date:f.date,type:f.type},total_inv_unpaid_amount>f.unallocated_amount?(fund.allocated_amount=f.unallocated_amount,total_inv_unpaid_amount-=f.unallocated_amount):total_inv_unpaid_amount>0&&(fund.allocated_amount=total_inv_unpaid_amount,total_inv_unpaid_amount=0),$scope.funds.push(fund)):void 0})},$scope.close=function(){return popoverService.hide("#available-credit-popover")},$scope.balance_due=function(){return $scope.invoice?$scope.invoice.unpaid_amount-$scope.total_allocated_funds():0},$scope.total_allocated_funds=function(){return $scope.funds?$scope.funds.sum(function(i){return i.allocated_amount}):void 0},$scope.allocate=function(){return spinnerService.start_spinner("#available-credit-spinner"),Invoice.allocate_payments({id:$scope.invoice.id,allocations:$scope.funds},function(data){return spinnerService.stop_spinner("#available-credit-spinner"),angular.copy(data,$scope.invoice),$scope.close(),$scope.onComplete()&&$scope.onComplete(),$scope.get_transactions()})},$scope.get_transactions=function(){return Customer.credit_notes({id:$scope.invoice.customer.id,unallocated_only:!0,nopaging:!0},function(data){return $scope.transactions=data.credit_notes.map(function(credit_note){return credit_note.type="credit note",credit_note}),Customer.payments({id:$scope.invoice.customer.id,unallocated_only:!0,nopaging:!0},function(data){var payments;return data?($scope.transactions||($scope.transactions=[]),payments=data.payments.map(function(payment){return payment.type="payment",payment}),$scope.transactions=__slice.call($scope.transactions).concat(__slice.call(payments))):void 0})})},$scope.funds_available=function(){var unallocated_credit;return $scope.transactions&&$scope.transactions.length>0?(unallocated_credit=$scope.transactions.find(function(t){return t.unallocated_amount&&t.unallocated_amount>0}),unallocated_credit?!0:!1):!1},$scope.$watch("invoice",function(){return $scope.invoice&&$scope.invoice.customer&&$scope.invoice.customer.id?$scope.get_transactions():void 0})}}})}.call(this),function(){this.AutoWorkshopApp.directive("adHelp",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{help:"=ngModel"},templateUrl:template("directives/ad_help"),controller:function($scope){return $scope.$watch("help.steps",function(newValue){return $scope.selected_step=newValue&&newValue.length>0?newValue[0]:void 0}),$scope.select=function(step){return $scope.selected_step=step},$scope.previous_step=function(){var current_step_number;return current_step_number=$scope.selected_step.step_number,$scope.help.steps[current_step_number-2]?$scope.selected_step=$scope.help.steps[current_step_number-2]:void 0},$scope.next_step=function(){var current_step_number;return current_step_number=$scope.selected_step.step_number,$scope.help.steps[current_step_number]?$scope.selected_step=$scope.help.steps[current_step_number]:void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInputCreditCard",function(){return{restrict:"AE",restrict:"AE",require:"autoWorkshop,showing,title,amount",scope:{auto_workshop:"=autoWorkshop",invoice:"=",showing:"=",title:"=",anchorElement:"@",amount:"=",placement:"@",onPaying:"&"},templateUrl:template("directives/ad_input_credit_card"),controller:function($scope,navbarService,spinnerService,formService,lookupService,popoverService,AutoWorkshop){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.placement||($scope.placement="left"),$scope.auto_workshop.credit_card?($scope.new_credit_card=void 0,$scope.existing_card=$scope.auto_workshop.credit_card):$scope.new_credit_card={},$scope.error=void 0,popoverService.show("#input-credit-card",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.error=void 0,$scope.showing=!1,popoverService.hide("#input-credit-card")},$scope.edit_card=function(){return formService.edit_fields($scope.existing_card,"editing","exp_month","exp_year","payment_gateway_id")},$scope.cancel_editing_card=function(){return $scope.existing_card.editing=void 0},$scope.update_card=function(){return spinnerService.start_spinner("#credit-card-spinner"),AutoWorkshop.update_credit_card({card:$scope.existing_card.editing},function(data){return spinnerService.stop_spinner("#credit-card-spinner"),angular.copy(data,$scope.existing_card)})},$scope.pay=function(){return spinnerService.start_spinner("#credit-card-spinner"),AutoWorkshop.charge({card:$scope.existing_card,invoice_id:$scope.invoice.id},function(data){return data.error?($scope.error=data.error,spinnerService.stop_spinner("#credit-card-spinner")):($scope.invoice.charged=!0,$scope.invoice.due=!1,$scope.invoice.charged_at=data.charged_at,$scope.hide(),spinnerService.stop_spinner("#credit-card-spinner"),navbarService.update_subscription_notification(),$scope.onPaying?$scope.onPaying():void 0)})},$scope.submit_payment=function(card){return null==card&&(card=null),spinnerService.start_spinner("#credit-card-spinner"),card&&!card.id?$scope.save_new_card(function(){return $scope.pay()}):$scope.pay()},$scope.change_card=function(){return $scope.new_credit_card={}},$scope.save_new_card=function(callback){var $form;return $form=$("#credit-card"),spinnerService.start_spinner("#credit-card-spinner"),Stripe.card.createToken($form,function(code,data){return data.error?($scope.error=data.error.message,spinnerService.stop_spinner("#credit-card-spinner"),$scope.$apply()):(angular.copy(data.card,$scope.new_credit_card),$scope.new_credit_card.payment_gateway_id=data.card.id,$scope.new_credit_card.token=data.id,$scope.new_credit_card.id=null,spinnerService.start_spinner("#credit-card-spinner"),AutoWorkshop.update_credit_card({card:$scope.new_credit_card},function(data){return spinnerService.stop_spinner("#credit-card-spinner"),angular.copy(data,$scope.existing_card),callback?callback():$scope.hide()}))})},$scope.show_cvv_help=function(){return $scope.showing_cvv_help=!0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInvoice",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{invoice:"=ngModel",job:"=",onRepcoSuccess:"&",onOscarSuccess:"&"},templateUrl:template("directives/ad_invoice"),controller:function($scope,$timeout,timeService,permissionService,navbarService,formService,lookupService,spinnerService,popoverService,stockInfoService,confirmationService,repcoNavigatorService,AutoWorkshop,Job,Invoice,Cost,RepcoNavigator){return $scope.tax_name=function(){return lookupService.tax_name()},$scope.$watch("invoice",function(){return $scope.invoice||($scope.invoice={}),$scope.invoice.id?void 0:$scope.invoice.not_registered_for_gst=lookupService.configurations().not_registered_for_gst}),$scope.repco_account=function(){return lookupService.repco_account()},$scope.quantum_account=function(){return lookupService.quantum_account()},$scope.pro_link_account=function(){return lookupService.pro_link_account()},$scope.motospecs_account=function(){return lookupService.motospecs_account()},$scope.ezy_parts_account=function(){return lookupService.ezy_parts_account()},$scope.invoice_item_sortable_options={handle:".dragable-handle",helper:"clone",stop:function(){return $scope.reorder_invoice_items()}},$scope.accounting_integration=function(){return lookupService.configurations().accounting_integration},$scope.reorder_invoice_items=function(){return Invoice.reorder_items({id:$scope.invoice.id,items:$scope.invoice.items},function(data){return angular.copy(data,$scope.invoice)})},$scope.customer=function(){return $scope.invoice&&$scope.invoice.customer?$scope.invoice.customer:$scope.job&&$scope.job.insurer?$scope.job.insurer:$scope.job&&$scope.job.customer?$scope.job.customer:void 0},$scope.edit_invoice_item_details=function(invoice_item){return invoice_item.edit_details=!0},$scope.invoice_item_total=function(invoice_item){return invoice_item&&invoice_item.quantity&&invoice_item.unit_price?invoice_item.quantity*invoice_item.unit_price*(1-invoice_item.discount_percentage/100):0},$scope.add_invoice_item=function(){return $scope.confirm_edit_finalized_invoice(function(){return $scope.new_invoice_item={description:"code/description",quantity:1,unit_price:0,included_gst:lookupService.configurations().prices_include_gst,discount_percentage:0},formService.select_text("#new-invoice-item-description")})},$scope.add_invoice_item_header=function(){return $scope.confirm_edit_finalized_invoice(function(){return $scope.new_invoice_item={details:"description",header:!0},formService.select_text("#new-invoice-item-header-description")})},$scope.create_invoice_if_not_exists=function(callback){if(!$scope.creating_invoice){if($scope.invoice=$scope.invoice||{},$scope.invoice.id)return callback();if($scope.job&&$scope.job.id)return $scope.creating_invoice=!0,Job.create_invoice({id:$scope.job.id},function(data){return $scope.creating_invoice=!1,angular.copy(data,$scope.invoice),callback()})}},$scope.save_new_invoice_item=function(){return $scope.create_invoice_if_not_exists(function(){var form;if($scope.new_invoice_item.header)form=$scope.new_invoice_item_header_form;else{if(lookupService.disable_arbitrary_line_items()&&!$scope.new_invoice_item.stock_id)return alert("Please select an item from the dropdown or click 'Create Stock' button to create one"),void 0;form=$scope.new_invoice_item_form}return formService.submit_form($scope,form,function(){var saving_item;return saving_item=$scope.new_invoice_item,saving_item.saving=!0,$scope.invoice.items.push(saving_item),$scope.new_invoice_item=null,timeService.timeout(function(){return document.getElementById("add-item-button").focus()}),Invoice.new_item({id:$scope.invoice.id,item:saving_item},function(data){return angular.copy(data,$scope.invoice)})})})},$scope.add_items_from_repco=function(account){return $scope.create_invoice_if_not_exists(function(){return RepcoNavigator.invoice_access({id:$scope.invoice.id,account_id:account.id},function(data){return window.$repco_scope=$scope,repcoNavigatorService.open_smart_quote($scope.invoice,data.url,account)})})},$scope.oscar_success=function(account){return $scope.onOscarSuccess({account:account})},$scope.repco_success=function(){return $scope.onRepcoSuccess()},$scope.edit_finalized_invoice_warning=function(){var accounting_software,message;return accounting_software=$scope.accounting_integration(),message=accounting_software?"You're editing an invoice that has been finalized.\n\nAre you sure you want to proceed?.\n\nIMPORTANT! Editing a finalized invoice requires manually updating the stock items' quantity on hand\n\n"+("If the invoice has been sync'd to "+accounting_software+", ")+("any changes you make here will NOT appear in "+accounting_software+", ")+("you will need to make these changes manually in "+accounting_software):"You're editing an invoice that has been finalized.\n\nAre you sure you want to proceed?.\n\nIMPORTANT! Editing a finalized invoice requires manually updating the stock items' quantity on hand"},$scope.confirm_edit_finalized_invoice=function(callback){return $scope.invoice.finalized?permissionService.check_update_finalized_documents_restriction_before_proceed(function(){return confirmationService.confirm($scope.edit_finalized_invoice_warning(),!$scope.edit_finalized_invoice_confirmed,function(){return $scope.invoice.finalized&&($scope.edit_finalized_invoice_confirmed=!0),callback()})}):callback()},$scope.edit_invoice_item=function(invoice_item){return $scope.editing_invoice_item&&$scope.close_edit_invoice_item(),$scope.confirm_edit_finalized_invoice(function(){var editing,element;return $scope.editing_invoice_item=invoice_item,formService.edit_fields($scope.editing_invoice_item,"editing"),editing=document.getElementById("editing-invoice-item"),element=document.getElementById("invoice-item-"+invoice_item.id),document.getElementById("invoice-item-list").insertBefore(editing,element)})},$scope.cancel_edit_invoice_item=function(invoice_item){return invoice_item.editing=null,$scope.close_edit_invoice_item()},$scope.close_edit_invoice_item=function(){return $scope.editing_invoice_item.editing=void 0,$scope.editing_invoice_item=void 0},$scope.save_invoice_item=function(form,invoice_item){return formService.submit_form($scope,form,function(){return spinnerService.start_spinner("#invoice-spinner"),Invoice.update_item({id:$scope.invoice.id,item:invoice_item.editing},function(data){return spinnerService.stop_spinner("#invoice-spinner"),angular.copy(data,$scope.invoice),$scope.close_edit_invoice_item()})})},$scope.remove_invoice_item=function(invoice_item){return invoice_item.header&&!invoice_item.editing.confirm_deletion?invoice_item.editing.confirm_deletion=!0:(spinnerService.start_spinner("#invoice-spinner"),Invoice.delete_item({id:$scope.invoice.id,item:invoice_item,include_children:invoice_item.editing.delete_children},function(data){return spinnerService.stop_spinner("#invoice-spinner"),angular.copy(data,$scope.invoice),$scope.close_edit_invoice_item()}))},$scope.cancel_add_invoice_item=function(){return $scope.new_invoice_item=null},$scope.show_invoice_item_details=function(invoice_item){return invoice_item.show_details=!0},$scope.hide_invoice_item_details=function(invoice_item){return invoice_item.show_details=!1},$scope.edit_invoice_details=function(){return $scope.confirm_edit_finalized_invoice(function(){return formService.edit_fields($scope.invoice,"editing_details","id","details"),formService.focus("#edit-invoice-details"),$scope.invoice.editing_details.auto_save=!0,$scope.auto_save_invoice_details()})},$scope.save_invoice_details=function(terminate){return null==terminate&&(terminate=!0),$scope.invoice.editing_details?($scope.invoice.editing_details.saving=!0,Invoice.update($scope.invoice.editing_details,function(data){return $scope.invoice.editing_details.saving=!1,$scope.invoice.details=data.details,$scope.job&&($scope.job.maintenance_entry_content=data.details),terminate?$scope.invoice.editing_details=void 0:void 0})):void 0},$scope.auto_save_invoice_details=function(){if($scope.invoice.editing_details){if($scope.invoice.editing_details.auto_save)return $scope.invoice.editing_details.auto_save_process=timeService.timeout(function(){return $scope.invoice.editing_details&&$scope.invoice.editing_details.details!==$scope.invoice.details&&$scope.save_invoice_details(!1),$scope.auto_save_invoice_details()},1e4);if($scope.invoice.editing_details.auto_save_process)return timeService.timeout.cancel($scope.invoice.editing_details.auto_save_process)}},$scope.cancel_edit_invoice_details=function(){return $scope.invoice.editing_details=null},$scope.clear_invoice_details=function(){return $scope.invoice.editing_details.details="",Invoice.update($scope.invoice.editing_details,function(data){return angular.copy(data,$scope.invoice),$scope.job?$scope.job.maintenance_entry_content="":void 0})},$scope.edit_invoice_discount=function(){return $scope.confirm_edit_finalized_invoice(function(){return formService.edit_fields($scope.invoice,"editing_discount","id","discount_money","discount_percentage")})},$scope.cancel_edit_invoice_discount=function(){return $scope.invoice.editing_discount=null},$scope.update_invoice_discount=function(){return Invoice.update($scope.invoice.editing_discount,function(data){return angular.copy(data,$scope.invoice)})},$scope.finalize=function(force){return null==force&&(force=!1),permissionService.check_finalize_documents_restriction_before_proceed(function(){return spinnerService.start_spinner("#finalize-invoice-spinner"),Invoice.finalize({id:$scope.invoice.id,force:force},function(data){return spinnerService.stop_spinner("#finalize-invoice-spinner"),data.error?confirmationService.danger_confirm(""+data.error+"\n\nFinalize anyway? (We recommend you check the invoice first)",!0,function(){return $scope.finalize(!0)}):($scope.invoice.finalized=!0,angular.copy(data,$scope.invoice),navbarService.update_unread_notification_count())})})},$scope.select_price_level=function(item,price){return item.unit_price=price},$scope.selected_buyin_items=[],$scope.showing_buyin=!1,$scope.add_invoice_item_buyin=function(){return $scope.confirm_edit_finalized_invoice(function(){return $scope.showing_buyin=!0})},$scope.select_buyin=function(){var selected_items;return selected_items=$scope.selected_buyin_items,$scope.create_invoice_if_not_exists(function(){return $scope.showing_buyin=!1,Invoice.new_items({id:$scope.invoice.id,buyin:selected_items},function(data){return angular.copy(data,$scope.invoice)})})},$scope.add_job_types=function(){return $scope.confirm_edit_finalized_invoice(function(){return $scope.new_job_types=[],popoverService.show("#add-job-types-popover","#add-job-types-button",{placement:"top"})})},$scope.hide_add_job_types=function(){return $scope.new_job_types=[],popoverService.hide("#add-job-types-popover")},$scope.save_new_job_types=function(){var execute;if(!$scope.creating_invoice){if($scope.invoice=$scope.invoice||{},execute=function(){return $scope.invoice.job_id?Job.add_job_types({id:$scope.invoice.job_id,job_types:$scope.new_job_types},function(data){return angular.copy(data,$scope.job),$scope.hide_add_job_types(),spinnerService.stop_spinner("#add-job-types-spinner")
}):Invoice.add_job_types({id:$scope.invoice.id,job_types:$scope.new_job_types},function(data){return angular.copy(data,$scope.invoice),$scope.hide_add_job_types(),spinnerService.stop_spinner("#add-job-types-spinner")})},spinnerService.start_spinner("#add-job-types-spinner"),$scope.invoice.id)return execute();if($scope.job&&$scope.job.id)return $scope.creating_invoice=!0,Job.create_invoice({id:$scope.job.id},function(data){return $scope.creating_invoice=!1,angular.copy(data,$scope.invoice),execute()})}},$scope.show_stock=function(invoice_item){return stockInfoService.show(invoice_item.stock_id,"#invoice-anchor","left")},$scope.select_new_stock=function(){var components,customer,_base;return $scope.new_invoice_item.stock=$scope.new_stock,$scope.new_invoice_item.stock_id=$scope.new_stock.id,(_base=$scope.new_invoice_item).quantity||(_base.quantity=1),components=[$scope.new_stock.stock_number,$scope.new_stock.name].filter(function(item){return item&&""!==item}),$scope.new_invoice_item.description=components.join(" - "),$scope.new_invoice_item.included_gst||($scope.new_invoice_item.included_gst=$scope.new_stock.included_gst),customer=$scope.customer(),$scope.new_invoice_item.unit_price=customer&&customer.price_level&&$scope.new_stock["price"+customer.price_level]>0?$scope.new_stock["price"+customer.price_level]:$scope.new_stock.price,$scope.new_stock.prices?$scope.new_invoice_item.prices=$scope.new_stock.prices:void 0},$scope.not_registered_for_gst=function(){return $scope.invoice?$scope.invoice.not_registered_for_gst:lookupService.configurations().not_registered_for_gst},$scope.new_stock={with_gst:{}}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInvoiceActions",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{invoice:"=ngModel",job:"=",email:"="},templateUrl:template("directives/ad_invoice_actions.html"),controller:function($scope,$window,timeService,spinnerService,formService,popoverService,lookupService,confirmationService,Invoice){return $scope.open_send_email=function(){var confirmation_message;return $scope.job&&$scope.invoice.is_master_invoice?confirmation_message="This will send the job and all its sub jobs' invoices. To send just this invoice, please send it from the invoice details page. Continue anyway?":$scope.invoice.is_master_invoice&&(confirmation_message="This invoice belongs to a master job which might contain sub jobs' invoices, to send them all at once, please send from the job page. Continue anyway?"),confirmationService.confirm(confirmation_message,confirmation_message,function(){return $scope.subject=$scope.invoice.email_preview.subject||$scope.default_email_subject(),$scope.message=$scope.invoice.email_preview.message||"Your invoice is attached",$scope.job?$scope.customer=$scope.job.customer:$scope.invoice&&($scope.customer=$scope.invoice.customer),popoverService.show("#invoice-send-email","#invoice-send-email-button",{placement:"left"})})},$scope.cancel=function(){return popoverService.hide("#invoice-send-email")},$scope.show_print_url=function(){return $scope.invoice&&$scope.invoice.id&&!$scope.show_create_backend_request()},$scope.show_create_backend_request=function(){return $scope.job&&$scope.job.sub_jobs&&$scope.job.sub_jobs.length>6},$scope.email_select_contact=function(contacts){var emails;return emails=contacts.map(function(c){return c.email}),emails&&emails.length>0?$scope.email=emails.join(";"):void 0},$scope.create_bulk_invoice_request=function(){return Invoice.bulk_invoices({ids:[$scope.invoice.id],is_master_job_invoice:!0},function(){return alert("Due to the number of sub invoices to generate, Your document will be processed in the backend and send to your email address soon.")})},$scope.print_url=function(){return $scope.job&&$scope.job&&$scope.job.is_master_job?"/invoices/print_master_job_invoice.pdf?job_id="+$scope.job.id:$scope.invoice?"/invoices/"+$scope.invoice.id+"/print.pdf":void 0},$scope.send_email=function(print){var attached_files,do_print,options;return null==print&&(print=!1),$scope.email&&""!==$scope.email?(spinnerService.start_spinner("#invoice-send-email-spinner"),attached_files=[],$scope.job&&(attached_files=attached_files.concat($scope.job.documents.findAll(function(d){return d.attached})),attached_files=attached_files.concat($scope.job.photos.findAll(function(d){return d.attached}))),$scope.invoice.documents&&(attached_files=attached_files.concat($scope.invoice.documents.findAll(function(d){return d.attached}))),$scope.invoice.photos&&(attached_files=attached_files.concat($scope.invoice.photos.findAll(function(d){return d.attached}))),attached_files=attached_files.map(function(f){return f.id}),options={id:$scope.invoice.id,subject:$scope.subject,email:$scope.email,message:$scope.message,send_me_a_copy:$scope.send_me_a_copy,delivery_notification_required:$scope.delivery_notification_required,attached_files:attached_files,attach_job_card:$scope.attach_job_card},$scope.job&&$scope.job.is_master_job&&(options.send_master_job_invoice=!0),Invoice.send_email(options,function(data){return spinnerService.stop_spinner("#invoice-send-email-spinner"),data.error?alert(data.error.message):(angular.copy(data,$scope.invoice),popoverService.hide("#invoice-send-email"))}),print?(do_print=function(){return $window.open($scope.print_url())},timeService.timeout(do_print,500)):void 0):alert("Please enter an email address")},$scope.send_email_and_print=function(){return $scope.send_email(!0)},$scope.default_email_subject=function(){var subject;return subject=lookupService.configurations().name,$scope.invoice.claim_number&&(subject+=" Claim #"+$scope.invoice.claim_number),subject+=", Invoice #"+$scope.invoice.number,$scope.invoice.description&&(subject+=" - "+$scope.invoice.description),subject}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInvoiceBills",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{invoice:"=ngModel"},templateUrl:template("directives/ad_invoice_bills"),controller:function(){}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInvoiceCogs",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{invoice:"=ngModel",job:"="},templateUrl:template("directives/ad_invoice_cogs"),controller:function($scope,navbarService,formService,lookupService,spinnerService,popoverService,AutoWorkshop,Job,Invoice){return $scope.$watch("invoice",function(){return $scope.invoice||($scope.invoice={items:[]}),$scope.invoice.id?void 0:$scope.invoice.not_registered_for_gst=lookupService.configurations().not_registered_for_gst}),$scope.invoice_item_total=function(invoice_item){return invoice_item&&invoice_item.cost_quantity&&invoice_item.buy_price?invoice_item.cost_quantity*invoice_item.buy_price:0},$scope.profit_margin=function(){return $scope.invoice?($scope.invoice.net_amount-$scope.total_cost()).toFixed(2):0},$scope.profit_margin_percentage=function(){return $scope.invoice?(100*($scope.profit_margin()/$scope.invoice.net_amount)).toFixed(2):0},$scope.total_cost=function(){var total;return total=0,$scope.invoice&&$scope.invoice.items&&$scope.invoice.items.length>0&&$scope.invoice.items.each(function(i){return total+=i.total_cost}),total},$scope.edit_cogs=function(invoice_item){var editing,element;return $scope.editing_invoice_item=invoice_item,formService.edit_fields(invoice_item,"editing_cogs","id","buy_price"),editing=document.getElementById("editing-invoice-item-cogs"),element=document.getElementById("invoice-item-cogs-"+invoice_item.id),document.getElementById("invoice-item-cogs").insertBefore(editing,element)},$scope.cancel_edit_cogs=function(invoice_item){return invoice_item===$scope.new_cogs?$scope.new_cogs=void 0:invoice_item.editing_cogs=void 0},$scope.add_cogs=function(){return $scope.new_cogs={}},$scope.show_item=function(invoice_item){return invoice_item.stock_id||invoice_item.bill_item_id||invoice_item.purchase_item_id||invoice_item.cost_quantity>0||invoice_item.buy_price>0},$scope.select_cogs=function(){var item;return $scope.new_cogs.id?(item=$scope.invoice.items.find(function(item){return item.id===$scope.new_cogs.id}),$scope.new_cogs.cost_quantity=item.cost_quantity):void 0},$scope.save_cogs=function(invoice_item){var item;return item=invoice_item===$scope.new_cogs?$scope.new_cogs:invoice_item.editing_cogs,Invoice.update_item({id:$scope.invoice.id,item:item},function(data){return angular.copy(data,$scope.invoice),$scope.new_cogs=void 0,$scope.editing_invoice_item=void 0})},$scope.selectable_items=function(){return $scope.invoice&&$scope.invoice.items?$scope.invoice.items.findAll(function(item){return!item.header&&!$scope.show_item(item)}):[]}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInvoiceDetails",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{invoice:"=ngModel",email:"="},templateUrl:template("directives/ad_invoice_details"),controller:function($scope,formService,permissionService,lookupService,Invoice){return $scope.edit=function(){return permissionService.check_update_finalized_documents_restriction_before_proceed(function(){return formService.edit_fields($scope.invoice,"editing_info","id","number","issue_date","due_date","order_number","tracking_categories")})},$scope.save=function(){return Invoice.update($scope.invoice.editing_info,function(data){return angular.copy(data,$scope.invoice)})},$scope.cancel_edit=function(){return $scope.invoice.editing_info=void 0},$scope.edit_salesperson=function(){var session;return session=lookupService.session(),session.is_admin||session.employee_id===$scope.invoice.employee_id||!$scope.invoice.employee_id&&session.is_staff?formService.edit_fields($scope.invoice,"editing_salesperson","id","employee_id"):alert("Only admin and the invoice current salesperson can change salesperson")},$scope.cancel_edit_salesperson=function(){return $scope.invoice.editing_salesperson=void 0},$scope.save_salesperson=function(){return Invoice.update_salesperson($scope.invoice.editing_salesperson,function(data){return angular.copy(data,$scope.invoice)})},$scope.edit_royalty=function(){return formService.edit_fields($scope.invoice,"editing_royalty","id","royalty_account_number","royalty_auto_club","royalty_integration_account_id")},$scope.cancel_edit_royalty=function(){return $scope.invoice.editing_royalty=void 0},$scope.save_royalty=function(){return Invoice.update($scope.invoice.editing_royalty,function(data){return angular.copy(data,$scope.invoice)})},$scope.enable_tracking_category_selection=function(){return lookupService.configurations().enable_tracking_category_selection},$scope.employees=function(){return lookupService.assignable_employees()},$scope.royalty_integration_accounts=function(){return lookupService.royalty_integration_accounts()}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInvoiceItemInput",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{invoice_item:"=ngModel",customer:"=customer",input_id:"@inputId",bill:"=",purchase:"=",descriptionAttr:"@"},templateUrl:template("directives/ad_invoice_item_input"),controller:function($scope,$http,$filter,lookupService){return $scope.lookup=function(term){return lookupService.lookup_invoice_items(term)},$scope.select=function(selected_item){var customer;return $scope.invoice_item.description=$scope.descriptionAttr?selected_item[$scope.descriptionAttr]:selected_item.description,$scope.invoice_item.details=selected_item.details,$scope.invoice_item.quantity&&1!==$scope.invoice_item.quantity||($scope.invoice_item.quantity=selected_item.default_quantity&&0!==selected_item.default_quantity?selected_item.default_quantity:1),$scope.invoice_item.included_gst||($scope.invoice_item.included_gst=selected_item.included_gst),$scope.invoice_item.gst_free=selected_item.gst_free,customer=$scope.customer,$scope.invoice_item.unit_price=selected_item.unit_price,$scope.invoice_item.markup_percentages=selected_item.markup_percentages,$scope.invoice_item.unit_price=customer&&customer.price_level&&selected_item["price"+customer.price_level]>0?selected_item["price"+customer.price_level]:$scope.bill?selected_item.buy_price:$scope.purchase?lookupService.configurations().disable_purchase_order_item_price?0:selected_item.buy_price:selected_item.unit_price,$scope.invoice_item.stock_id=selected_item.stock_id,selected_item.prices?$scope.invoice_item.prices=selected_item.prices:void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInvoiceItemSelection",function(){return{restrict:"AE",restrict:"AE",require:"customer,showing",scope:{showing:"=",title:"@",anchorElement:"@",placement:"@",selection:"=",onSelect:"&"},templateUrl:template("directives/ad_invoice_item_selection"),controller:function($scope,lookupService,spinnerService,popoverService,Invoice){return $scope.tax_name=function(){return lookupService.tax_name()},$scope.search=function(page){return null==page&&(page=1),spinnerService.start_spinner("#invoice-item-selection-spinner"),Invoice.search({view:"basic",query:$scope.query,page:page,per_page:10},function(data){return $scope.keyword=$scope.query.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.invoices=data.invoices,spinnerService.stop_spinner("#invoice-item-selection-spinner")})},$scope.toggle_select=function(invoice){return invoice.selected?$scope.deselect(invoice):$scope.select(invoice)},$scope.toggle_select_invoice_item=function(item){return item.selected?$scope.deselect_invoice_item(item):$scope.select_invoice_item(item)},$scope.show=function(){return $scope.search(),popoverService.show("#invoice-selection",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#invoice-selection")},$scope.show_items=function(invoice){return invoice.show_items=!0},$scope.hide_items=function(invoice){return invoice.show_items=!1},$scope.select_invoice_item=function(invoice_item){return invoice_item.selected=!0},$scope.deselect_invoice_item=function(invoice_item){return invoice_item.selected=!1},$scope.select=function(invoice){return $scope.invoices.each(function(i){return $scope.deselect(i)}),invoice.selected=!0,$scope.selection=invoice,$scope.show_items(invoice)},$scope.deselect=function(invoice){return $scope.selection=void 0,invoice.selected=!1,$scope.hide_items(invoice)},$scope.do_select=function(){return $scope.onSelect?$scope.onSelect.call():void 0},$scope.query={statuses:[]},$scope.invoices=[],$scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()})}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInvoicePayments",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{invoice:"=ngModel"},templateUrl:template("directives/ad_invoice_payments"),controller:function($scope){return $scope.toggle_payment=function(payment){return payment.open=!payment.open},$scope.payment_status=function(){return $scope.invoice?$scope.invoice.paid?"Paid":$scope.invoice.paid_amount&&0!==$scope.invoice.paid_amount?"Partially Paid":"Unpaid":void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInvoiceRestricted",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{invoice:"=ngModel",job:"=",onRepcoSuccess:"&",onOscarSuccess:"&"},templateUrl:template("directives/ad_invoice_restricted"),controller:function($scope,timeService,navbarService,formService,lookupService,spinnerService,stockInfoService,popoverService,confirmationService,repcoNavigatorService,AutoWorkshop,Job,Invoice){return $scope.tax_name=function(){return lookupService.tax_name()},$scope.$watch("invoice",function(){return $scope.invoice||($scope.invoice={}),$scope.invoice.id?void 0:$scope.invoice.not_registered_for_gst=lookupService.configurations().not_registered_for_gst}),$scope.invoice_item_sortable_options={helper:"clone",stop:function(){return $scope.reorder_invoice_items()}},$scope.reorder_invoice_items=function(){return Invoice.reorder_items({id:$scope.invoice.id,items:$scope.invoice.items},function(data){return angular.copy(data,$scope.invoice)})},$scope.customer=function(){return $scope.job&&$scope.job.insurer?$scope.job.insurer:$scope.job&&$scope.job.customer?$scope.job.customer:$scope.invoice&&$scope.invoice.customer?$scope.invoice.customer:void 0},$scope.edit_invoice_item_details=function(invoice_item){return invoice_item.edit_details=!0},$scope.invoice_item_total=function(invoice_item){return invoice_item&&invoice_item.quantity&&invoice_item.unit_price?invoice_item.quantity*invoice_item.unit_price*(1-invoice_item.discount_percentage/100):0},$scope.add_invoice_item=function(){return $scope.invoice.finalized?alert("The invoice has been finalized, Please contact System Administrator for any modification you want to make"):($scope.new_invoice_item={description:"code/description",quantity:1,unit_price:0,included_gst:lookupService.configurations().prices_include_gst,discount_percentage:0},formService.select_text("#new-invoice-item-description"))},$scope.add_invoice_item_header=function(){return $scope.invoice.finalized?alert("The invoice has been finalized, Please contact System Administrator for any modification you want to make"):($scope.new_invoice_item={details:"description",header:!0},formService.select_text("#new-invoice-item-header-description"))},$scope.create_invoice_if_not_exists=function(callback){if(!$scope.creating_invoice){if($scope.invoice=$scope.invoice||{},$scope.invoice.id)return callback();if($scope.job&&$scope.job.id)return $scope.creating_invoice=!0,Job.create_invoice({id:$scope.job.id},function(data){return $scope.creating_invoice=!1,angular.copy(data,$scope.invoice),callback()})}},$scope.save_and_new_invoice_item=function(){return $scope.save_new_invoice_item(),$scope.add_invoice_item()},$scope.save_new_invoice_item=function(){return $scope.create_invoice_if_not_exists(function(){var form;if($scope.new_invoice_item.header)form=$scope.new_invoice_item_header_form;else{if(lookupService.disable_arbitrary_line_items()&&!$scope.new_invoice_item.stock_id)return alert("Please select an item from the dropdown or click 'Create Stock' button to create one"),void 0;form=$scope.new_invoice_item_form}return formService.submit_form($scope,form,function(){var saving_item;return saving_item=$scope.new_invoice_item,saving_item.saving=!0,$scope.invoice.items.push(saving_item),$scope.new_invoice_item=null,timeService.timeout(function(){return document.getElementById("add-item-button").focus()}),Invoice.new_item({id:$scope.invoice.id,item:saving_item},function(data){return angular.copy(data,$scope.invoice),$scope.invoice.finalized?alert("The invoice has been finalized, Please contact System Administrator for any modification you want to make"):void 0})})})},$scope.edit_invoice_item=function(invoice_item){return $scope.invoice.finalized?alert("The invoice has been finalized, Please contact System Adminstrator for any modification you want to make"):formService.edit_fields(invoice_item,"editing")},$scope.cancel_edit_invoice_item=function(invoice_item){return invoice_item.editing=null},$scope.save_invoice_item=function(form,invoice_item){return formService.submit_form($scope,form,function(){return spinnerService.start_spinner("#invoice-spinner"),Invoice.update_item({id:$scope.invoice.id,item:invoice_item.editing},function(data){return spinnerService.stop_spinner("#invoice-spinner"),angular.copy(data,$scope.invoice),$scope.invoice.finalized?alert("The invoice has been finalized, Please contact System Administrator for any modification you want to make"):void 0})})},$scope.remove_invoice_item=function(invoice_item){return invoice_item.header&&!invoice_item.editing.confirm_deletion?invoice_item.editing.confirm_deletion=!0:(spinnerService.start_spinner("#invoice-spinner"),Invoice.delete_item({id:$scope.invoice.id,item:invoice_item,include_children:invoice_item.editing.delete_children},function(data){return spinnerService.stop_spinner("#invoice-spinner"),angular.copy(data,$scope.invoice),$scope.invoice.finalized?alert("The invoice has been finalized, Please contact System Administrator for any modification you want to make"):void 0}))},$scope.cancel_add_invoice_item=function(){return $scope.new_invoice_item=null},$scope.show_invoice_item_details=function(invoice_item){return invoice_item.show_details=!0},$scope.hide_invoice_item_details=function(invoice_item){return invoice_item.show_details=!1},$scope.edit_invoice_details=function(){return $scope.invoice&&($scope.invoice_editing_details={details:$scope.invoice.details}),formService.focus("#edit-invoice-details"),$scope.invoice_editing_details.auto_save=!0,$scope.auto_save_invoice_details()},$scope.save_invoice_details=function(terminate){return null==terminate&&(terminate=!0),$scope.create_invoice_if_not_exists(function(){return $scope.invoice_editing_details?($scope.invoice_editing_details.saving=!0,Invoice.update({id:$scope.invoice.id},$scope.invoice_editing_details,function(data){return $scope.invoice_editing_details.saving=!1,$scope.invoice.details=data.details,$scope.job&&($scope.job.maintenance_entry_content=data.details),terminate?$scope.invoice_editing_details=void 0:void 0})):void 0})},$scope.auto_save_invoice_details=function(){if($scope.invoice_editing_details){if($scope.invoice_editing_details.auto_save)return $scope.invoice_editing_details.auto_save_process=timeService.timeout(function(){return $scope.invoice_editing_details&&$scope.invoice_editing_details.details!==$scope.invoice.details&&$scope.save_invoice_details(!1),$scope.auto_save_invoice_details()},1e4);if($scope.invoice_editing_details.auto_save_process)return timeService.timeout.cancel($scope.invoice_editing_details.auto_save_process)}},$scope.cancel_edit_invoice_details=function(){return $scope.invoice_editing_details=null},$scope.clear_invoice_details=function(){return $scope.invoice_editing_details.details="",Invoice.update($scope.invoice_editing_details,function(data){return angular.copy(data,$scope.invoice),$scope.job?$scope.job.maintenance_entry_content="":void 0})},$scope.show_stock=function(invoice_item){return stockInfoService.show(invoice_item.stock_id,"#invoice-anchor","left")},$scope.select_new_stock=function(){var components,customer,_base;return $scope.new_invoice_item.stock=$scope.new_stock,$scope.new_invoice_item.stock_id=$scope.new_stock.id,(_base=$scope.new_invoice_item).quantity||(_base.quantity=1),components=[$scope.new_stock.stock_number,$scope.new_stock.name].filter(function(item){return item&&""!==item}),$scope.new_invoice_item.description=components.join(" - "),$scope.new_invoice_item.included_gst||($scope.new_invoice_item.included_gst=$scope.new_stock.included_gst),customer=$scope.customer(),$scope.new_invoice_item.unit_price=customer&&customer.price_level&&$scope.new_stock["price"+customer.price_level]>0?$scope.new_stock["price"+customer.price_level]:$scope.new_stock.price,$scope.new_stock.prices?$scope.new_invoice_item.prices=$scope.new_stock.prices:void 0},$scope.new_stock={with_gst:{}}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInvoiceSelection",function(){return{restrict:"AE",restrict:"AE",require:"customer,showing",scope:{customer:"=",showing:"=",title:"@",anchorElement:"@",placement:"@",selection:"=",available_amount:"=availableAmount",onSelect:"&",single_selection:"@"},templateUrl:template("directives/ad_invoice_selection"),controller:function($scope,lookupService,spinnerService,popoverService,confirmationService,Invoice){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.tax_name=function(){return lookupService.tax_name()},$scope.finalized_only=!0,$scope.search=function(){var params;return spinnerService.start_spinner("#loading-invoices-spinner"),params={customer_id:$scope.customer.id},$scope.finalized_only&&(params.finalized=!0),Invoice.unpaid(params,function(data){return $scope.invoices=data,spinnerService.stop_spinner("#loading-invoices-spinner")})},$scope.show=function(){return spinnerService.stop_spinner("#select-invoices-spinner"),$scope.search(),popoverService.show("#invoice-selection",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.showing=!1,spinnerService.stop_spinner("#select-invoices-spinner"),popoverService.hide("#invoice-selection")},$scope.show_items=function(invoice){return invoice.show_items=!0},$scope.hide_items=function(invoice){return invoice.show_items=!1},$scope.total_allocated_amount=function(){return $scope.invoices?$scope.invoices.sum(function(invoice){return invoice.selected?parseFloat(invoice.allocated_amount):0}):0},$scope.allocatable_amount=function(){return $scope.available_amount&&$scope.invoices?($scope.available_amount-$scope.total_allocated_amount()).round(2):0},$scope.unallocate=function(){return confirmationService.confirm("Remove all allocations?",!0,function(){return $scope.invoices.each(function(invoice){return $scope.deselect(invoice)})})},$scope.automatic_allocate=function(){return $scope.auto_allocating?void 0:confirmationService.confirm("Automatically allocate until the payment is full allocated?",!0,function(){var remaining;return $scope.auto_allocating=!0,spinnerService.start_spinner("#auto-allocate-spinner"),remaining=$scope.allocatable_amount(),$scope.invoices.each(function(invoice){return remaining>0?($scope.select(invoice),remaining-=invoice.allocated_amount):void 0}),$scope.auto_allocating=!1,spinnerService.stop_spinner("#auto-allocate-spinner")})},$scope.select=function(invoice){return $scope.available_amount&&(invoice.allocated_amount=Math.min(invoice.unpaid_amount,$scope.allocatable_amount())),invoice.selected=!0,$scope.selection?$scope.selection.add(invoice):void 0},$scope.deselect=function(invoice){return $scope.selection&&$scope.selection.remove(invoice),invoice.selected=!1,invoice.allocated_amount=0},$scope.do_select=function(){return $scope.onSelect?(spinnerService.start_spinner("#select-invoices-spinner"),$scope.onSelect.call()):void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInvoiceViewer",function(){return{restrict:"AE",restrict:"AE",require:"showing",scope:{invoice:"=",anchorElement:"=",placement:"@",showing:"="},templateUrl:template("directives/ad_invoice_viewer"),controller:function($scope,lookupService,spinnerService,popoverService,Invoice,CreditNote){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){var resource,type;return spinnerService.start_spinner("#invoice-viewer-spinner"),$scope.invoice&&"credit note"===$scope.invoice.type?(resource=CreditNote,type="credit note"):(resource=Invoice,type="invoice"),resource.get({id:$scope.invoice.id},function(data){return angular.copy(data,$scope.invoice),$scope.invoice.type=type,spinnerService.stop_spinner("#invoice-viewer-spinner")}),$scope.placement||($scope.placement="left"),popoverService.show("#invoice-viewer-popover",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.showing=!1,spinnerService.stop_spinner("#invoice-viewer-spinner"),popoverService.hide("#invoice-viewer-popover")},$scope.tax_name=function(){return lookupService.tax_name()},$scope.invoice_path=function(){return $scope.invoice?"credit note"===$scope.invoice.type?"#/credit_notes/"+$scope.invoice.id:$scope.invoice.job_id?"#/jobs/"+$scope.invoice.job_id:"#/invoices/"+$scope.invoice.id:void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adInvoicepicker",function(){return{restrict:"AE",restrict:"AE",scope:{invoiceId:"=ngModel",invoice:"=",customerId:"=",onSelect:"&",input_id:"@inputId",readonly:"="},templateUrl:template("directives/ad_invoicepicker"),controller:function($scope,lookupService){return $scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.lookup=function(term){return lookupService.lookup_invoices({term:term,customer_id:$scope.customerId},"#lookup-invoice-spinner-"+$scope.spinner_id,"#lookup-invoice-icon-"+$scope.spinner_id)},$scope.select=function(selected_invoice){return $scope.invoice.id=selected_invoice.id,$scope.invoice.title=selected_invoice.title,$scope.invoice.customer_id=selected_invoice.customer_id,$scope.invoiceId=selected_invoice.id,$scope.onSelect?$scope.onSelect():void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adJobTypeSelection",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{job_type_ids:"=ngModel",onChange:"&"},templateUrl:template("directives/ad_job_type_selection"),controller:function($scope,timeService,popoverService,lookupService,formService,JobType){return $scope.job_type={},$scope.fetched_job_types=[],$scope.selectizeConfigs={maxItems:100,openOnFocus:!0,hideSelected:!0,closeAfterSelect:!0,plugins:["remove_button"],onChange:$scope.onChange},$scope.job_types=function(){return $scope.fetched_job_types.length>0?$scope.fetched_job_types:lookupService.job_types().length>0?($scope.fetched_job_types=lookupService.job_types().map(function(i){return{value:i.id,text:i.title}}),$scope.fetched_job_types):void 0},$scope.new_job_type=function(){return popoverService.show("#create-job-type","#create-job-type-button",{placement:"bottom"}),formService.select_text("#new-job-type-title")},$scope.save_job_type=function(){return $scope.job_type.title?JobType.save($scope.job_type,function(data){return lookupService.fetch_job_types(),$scope.fetched_job_types.push({value:data.id,text:data.title}),timeService.timeout(function(){return $scope.job_type_ids.push(data.id)}),popoverService.hide("#create-job-type")}):void 0},$scope.cancel_new_job_type=function(){return popoverService.hide("#create-job-type")}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adJobpicker",function(){return{restrict:"AE",restrict:"AE",scope:{jobId:"=ngModel",job:"=",onSelect:"&",input_id:"@inputId",readonly:"="},templateUrl:template("directives/ad_jobpicker"),controller:function($scope,lookupService){return $scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.lookup=function(term){return lookupService.lookup_jobs({term:term},"#lookup-job-spinner-"+$scope.spinner_id,"#lookup-job-icon-"+$scope.spinner_id)},$scope.select=function(selected_job){return $scope.job.id=selected_job.id,$scope.job.title=selected_job.title,$scope.jobId=selected_job.id,$scope.onSelect?$scope.onSelect():void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adMergeCustomer",function(){return{restrict:"AE",restrict:"AE",scope:{customer:"=",showing:"=",anchorElement:"@",placement:"@",onSelect:"&"},templateUrl:template("directives/ad_merge_customer"),controller:function($scope,$window,popoverService,Customer){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.merging=!1,popoverService.show("#merge-customer-popover",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return popoverService.hide("#merge-customer-popover")},$scope.select_customer=function(){return $scope.selected_customer.id===$scope.customer.id?($scope.selected_customer=null,alert("Please select different customer account from the current one (account Number "+$scope.customer.number+") to merge")):void 0},$scope.merge=function(){if($scope.selected_customer){if($scope.selected_customer.id===$scope.customer.id)return $scope.selected_customer=null,alert("Please select different customer account from the current one (account Number "+$scope.customer.number+") to merge");if($scope.merging)return;return $scope.merging=!0,Customer.merge({id:$scope.customer.id,customer_id:$scope.selected_customer.id},function(data){return $scope.merging=!1,angular.copy(data,$scope.customer),$scope.hide(),$scope.onSelect?$scope.onSelect():void 0})}return alert("Please select a customer to merge to")}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adMergeSupplier",function(){return{restrict:"AE",restrict:"AE",scope:{supplier:"=",showing:"=",anchorElement:"@",placement:"@",onSelect:"&"},templateUrl:template("directives/ad_merge_supplier"),controller:function($scope,$window,popoverService,Supplier){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.merging=!1,popoverService.show("#merge-supplier-popover",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return popoverService.hide("#merge-supplier-popover")},$scope.select_supplier=function(){return $scope.selected_supplier.id===$scope.supplier.id?($scope.selected_supplier=null,alert("Please select different supplier account from the current one (account Number "+$scope.supplier.number+") to merge")):void 0},$scope.merge=function(){if($scope.selected_supplier){if($scope.selected_supplier.id===$scope.supplier.id)return $scope.selected_supplier=null,alert("Please select different supplier account from the current one (account Number "+$scope.supplier.number+") to merge");
if($scope.merging)return;return $scope.merging=!0,Supplier.merge({id:$scope.supplier.id,supplier_id:$scope.selected_supplier.id},function(data){return $scope.merging=!1,angular.copy(data,$scope.supplier),$scope.hide(),$scope.onSelect?$scope.onSelect():void 0})}return alert("Please select a supplier to merge to")}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adMergeVehicle",function(){return{restrict:"AE",restrict:"AE",scope:{customer:"=",showing:"=",anchorElement:"@",placement:"@",onSelect:"&"},templateUrl:template("directives/ad_merge_vehicle"),controller:function($scope,$window,popoverService,lookupService,Vehicle){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.merging=!1,$scope.merged_vehicle=void 0,$scope.selected_vehicle=void 0,popoverService.show("#vehicle-merge-popover",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#vehicle-merge-popover")},$scope.merge=function(){if($scope.merged_vehicle&&$scope.merged_vehicle.id){if($scope.selected_vehicle&&$scope.selected_vehicle.id){if($scope.merged_vehicle.id===$scope.selected_vehicle.id)return alert("Merged vehicle and vehicle to merged into are the same");if($scope.merging)return;return $scope.merging=!0,Vehicle.merge({id:$scope.merged_vehicle.id,vehicle_id:$scope.selected_vehicle.id},function(){return $scope.merging=!1,$scope.hide(),$scope.onSelect?$scope.onSelect():void 0})}return alert("Please select a vehicle to merge into from the dropdown")}return alert("Please select a vehicle to merge from the dropdown")},$scope.asset_name=function(){return lookupService.asset_name()},$scope.asset_name_plural=function(){return lookupService.asset_name_plural()}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adNewStock",function(){return{restrict:"AE",restrict:"AE",scope:{stock:"=ngModel",anchorElement:"@",placement:"@",onSave:"&",newStock:"=genericItem",isAPurchase:"="},templateUrl:template("directives/ad_new_stock"),controller:function($scope,popoverService,lookupService,$filter,Stock){return $scope.stock||($scope.stock={with_gst:{}}),$scope.create_stock=function(){return $scope.stock={with_gst:{}},$scope.newStock&&($scope.isAPurchase?$scope.stock.buy_price=$scope.newStock.unit_price:$scope.stock.price=$scope.newStock.unit_price,"code/description"!==$scope.newStock.description&&($scope.stock.stock_number=$scope.newStock.description,$scope.stock.name=$scope.newStock.description)),$scope.placement="left",popoverService.show("#create-stock","#create-stock-button",{placement:"top"})},$scope.cancel=function(){return popoverService.hide("#create-stock")},$scope.save_stock=function(){return Stock.save($scope.stock,function(data){return angular.copy(data,$scope.stock),data.errors?void 0:(lookupService.fetch_invoice_items(),$scope.onSave&&$scope.onSave(data),popoverService.hide("#create-stock"))})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adNotes",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{owner:"=ngModel",onSave:"&",owner_type:"@modelType",enable_workshop_only:"@enableWorkshopOnly"},templateUrl:template("directives/ad_notes"),controller:function($scope,$window,formService,lookupService,spinnerService,Payment,Quote,Job,Customer,Vehicle,Supplier,ServiceSchedule,Stocktake){return $scope.resource=function(){return"payment"===$scope.owner_type?Payment:"quote"===$scope.owner_type?Quote:"job"===$scope.owner_type?Job:"customer"===$scope.owner_type?Customer:"vehicle"===$scope.owner_type?Vehicle:"supplier"===$scope.owner_type?Supplier:"service_schedule"===$scope.owner_type?ServiceSchedule:"stocktake"===$scope.owner_type?Stocktake:void 0},$scope.cancel_edit_note=function(note){return $scope.$parent.cancel(note,"editing")},$scope.edit_note=function(note){return formService.edit_fields(note,"editing","id","content","office_only","workshop_only")},$scope.add_note=function(){return $scope.new_note={content:"content"},formService.select_text("#new-note-content-"+$scope.new_note_content_id)},$scope.save_new_note=function(form){return formService.submit_form($scope,form,function(){return $scope.resource().create_note({id:$scope.owner.id,note:$scope.new_note},function(data){return $scope.owner.notes.push(data),$scope.new_note=null})})},$scope.cancel_add_note=function(){return $scope.new_note=void 0},$scope.save_note=function(form,note){return formService.submit_form($scope,form,function(){return $scope.resource().update_note({id:$scope.owner.id,note:note.editing},function(data){return angular.copy(data,note)})})},$scope.remove_note=function(note){return $scope.resource().destroy_note({id:$scope.owner.id,note:note},function(){return $scope.owner.notes.remove(note)})},$scope.notes=function(){return lookupService.session()&&$scope.owner&&$scope.owner.notes?lookupService.session().is_restricted_mechanic||lookupService.session().is_mechanic?$scope.owner.notes.filter(function(note){return!note.office_only}):$scope.owner.notes:[]},$scope.new_note_content_id=Math.floor(1e10*Math.random()+1)}}})}.call(this),function(){this.AutoWorkshopApp.directive("adPayInvoice",function(){return{restrict:"AE",restrict:"AE",require:"ngModel,showing,title",scope:{invoice:"=ngModel",showing:"=",title:"@",anchorElement:"@"},templateUrl:template("directives/ad_pay_invoice"),controller:function($scope,$timeout,confirmationService,lookupService,formService,popoverService,spinnerService,tyroService,paymentExpressService,currencyFilter,Invoice,Payment){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.payment={},$scope.payment_methods=function(){return lookupService.payment_methods()},$scope.tyro_ready=function(){return lookupService.tyro_account()?!0:void 0},$scope.payment_express_ready=function(){return lookupService.payment_express_account()?!0:void 0},$scope.surcharge=function(){return lookupService.configurations().surcharge},$scope.show=function(){return $scope.send_email=!1,$scope.print=!1,$scope.payment={invoice_id:$scope.invoice.id,job_id:$scope.invoice.job_id,reference:"Invoice# "+$scope.invoice.number,waive_surcharge:!1,date:new Date},$scope.payment_methods().forEach(function(method){return $scope.payment[method.value]={amount:0,id:method.id}}),popoverService.show("#pay-popover",$scope.anchorElement,{placement:"left"})},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#pay-popover"),popoverService.hide("#overpay-popover")},$scope.pay_fully_in=function(type){var method,_i,_len,_ref;for(_ref=$scope.payment_methods(),_i=0,_len=_ref.length;_len>_i;_i++)method=_ref[_i],$scope.payment[method.value].amount=0;return $scope.payment[type].amount=$scope.invoice.unpaid_amount},$scope.payment_total=function(){var total;return total=0,$scope.payment&&$scope.payment_methods().length>0?($scope.payment_methods().forEach(function(method){return $scope.payment[method.value]?total+=$scope.payment[method.value].amount:void 0}),total+=$scope.surcharge_charge()):void 0},$scope.surcharge_amount=function(){return $scope.surcharge()&&$scope.surcharge()>0?$scope.payment.credit&&$scope.payment.credit.amount>0?($scope.payment.credit.amount*$scope.surcharge()/100).round(2):0:0},$scope.surcharge_charge=function(){return $scope.surcharge_amount()>0&&!$scope.payment.waive_surcharge?$scope.surcharge_amount():0},$scope.pay=function(print){var overpayment;return null==print&&(print=!1),$scope.pay_and_print=print,overpayment=$scope.payment_total()>$scope.invoice.unpaid_amount+$scope.surcharge_charge(),overpayment?popoverService.show("#overpay-popover","#pay",{placement:"left"}):$scope.do_pay()},$scope.pay_and_give_change=function(){var change_amount;return change_amount=($scope.payment_total()-($scope.invoice.unpaid_amount+$scope.surcharge_charge())).toFixed(2),$scope.payment_methods().forEach(function(method){return"cash"===method.value?($scope.payment[method.value].amount-=change_amount,$scope.do_pay(function(){return $timeout(function(){return alert("Please issue the customer change of "+currencyFilter(change_amount))})})):void 0})},$scope.eftpos_machine=function(){return tyroService.enabled()?tyroService:paymentExpressService.enabled()?paymentExpressService:void 0},$scope.do_pay=function(callback){var eftpos_amount,eftpos_machine,finish_transaction;return finish_transaction=function(){return formService.submit_form($scope,$scope.pay_form,function(){return spinnerService.start_spinner("#pay-invoice-spinner"),Payment.create_invoice_payment($scope.payment,function(data){return angular.copy(data,$scope.invoice),spinnerService.stop_spinner("#pay-invoice-spinner"),$scope.hide(),$scope.pay_and_print&&window.open("/invoices/"+$scope.invoice.id+"/print.pdf"),callback?callback():void 0})})},eftpos_machine=$scope.eftpos_machine(),eftpos_amount=$scope.payment.eftpos.amount>0?$scope.payment.eftpos.amount:$scope.payment.credit.amount+$scope.surcharge_charge(),eftpos_amount>0&&eftpos_machine?eftpos_machine.start_purchase_transaction(eftpos_amount,finish_transaction):finish_transaction()},$scope.bank_accounts=function(){return lookupService.bank_accounts()},$scope.show_select_bank_account=function(){return $scope.bank_accounts()&&$scope.bank_accounts().length>1&&$scope.payment_total()!==$scope.payment.cash_amount,Object.keys($scope.payment).length>6?$scope.bank_accounts()&&$scope.bank_accounts().length>1&&$scope.payment_total()!==$scope.payment.cash.amount:void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adPaymentExpress",function(){return{restrict:"AE",restrict:"AE",scope:{showing:"=",anchorElement:"@",placement:"@",onSelect:"&"},templateUrl:template("directives/ad_payment_express"),controller:function($scope,$window,paymentExpressService,popoverService,lookupService){return $scope.enabled=function(){return paymentExpressService.enabled()},$scope.enable=function(){return paymentExpressService.enable()},$scope.payment_express_account=function(){return lookupService.payment_express_account()},$scope.payment_express_cancel=function(){return paymentExpressService.cancel_transaction()},$scope.payment_express_terminals=function(){return $scope.payment_express_account()?$scope.payment_express_account().terminals:void 0},$scope.transaction_status=function(){return paymentExpressService.transaction_status()},$scope.payment_express_tid=function(){return paymentExpressService.tid()},$scope.amount=function(){return paymentExpressService.amount()},$scope.select_terminal=function(){return paymentExpressService.set_tid($scope.payment_express_pairing_tid),$scope.close_payment_express_pairing()},$scope.payment_express_paired=function(){return paymentExpressService.tid()},$scope.display1=function(){return paymentExpressService.display1()},$scope.display2=function(){return paymentExpressService.display2()},$scope.button1=function(){return paymentExpressService.button1()},$scope.button2=function(){return paymentExpressService.button2()},$scope.response_code=function(){return paymentExpressService.response_code()},$scope.click_button=function(button,value){return paymentExpressService.click_button(button,value)},$scope.start_payment_express_pairing=function(){return popoverService.show("#pos-payment-express-pairing","#payment-express-pairing-button",{placement:"top"})},$scope.disable=function(){return paymentExpressService.disable()},$scope.close_payment_express_pairing=function(){return popoverService.hide("#pos-payment-express-pairing")},paymentExpressService.init()}}})}.call(this),function(){this.AutoWorkshopApp.directive("adPreference",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{preference:"="},templateUrl:template("directives/ad_preference"),controller:function($scope,$timeout,confirmationService,lookupService,formService,popoverService,spinnerService,AutoWorkshop){return $scope.value=function(){return lookupService.preference($scope.preference)},$scope.edit=function(){return $scope.editing={preference:$scope.preference,value:$scope.value()}},$scope.cancel_edit=function(){return $scope.editing=void 0},$scope.save=function(){return AutoWorkshop.set_preference($scope.editing,function(){return lookupService.set_preference($scope.preference,$scope.editing.value),$scope.cancel_edit()})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adPriceGroupForm",function(){return{restrict:"AE",restrict:"AE",scope:{price_group:"=ngModel",onSave:"&",onCancel:"&"},templateUrl:template("directives/ad_price_group_form"),controller:function($scope,lookupService,spinnerService,priceGroupService){return $scope.recalculate_markup_percentages=function(){return $scope.price_group.markup_percentage=priceGroupService.calculate_markup_percentage($scope.price_group.margin_percentage),$scope.price_group.markup_percentage2=priceGroupService.calculate_markup_percentage($scope.price_group.margin_percentage2),$scope.price_group.markup_percentage3=priceGroupService.calculate_markup_percentage($scope.price_group.margin_percentage3),$scope.price_group.markup_percentage4=priceGroupService.calculate_markup_percentage($scope.price_group.margin_percentage4),$scope.price_group.markup_percentage5=priceGroupService.calculate_markup_percentage($scope.price_group.margin_percentage5),$scope.price_group.markup_percentage6=priceGroupService.calculate_markup_percentage($scope.price_group.margin_percentage6),$scope.price_group.markup_percentage7=priceGroupService.calculate_markup_percentage($scope.price_group.margin_percentage7)},$scope.recalculate_margin_percentages=function(){return $scope.price_group.margin_percentage=priceGroupService.calculate_margin_percentage($scope.price_group.markup_percentage),$scope.price_group.margin_percentage2=priceGroupService.calculate_margin_percentage($scope.price_group.markup_percentage2),$scope.price_group.margin_percentage3=priceGroupService.calculate_margin_percentage($scope.price_group.markup_percentage3),$scope.price_group.margin_percentage4=priceGroupService.calculate_margin_percentage($scope.price_group.markup_percentage4),$scope.price_group.margin_percentage5=priceGroupService.calculate_margin_percentage($scope.price_group.markup_percentage5),$scope.price_group.margin_percentage6=priceGroupService.calculate_margin_percentage($scope.price_group.markup_percentage6),$scope.price_group.margin_percentage7=priceGroupService.calculate_margin_percentage($scope.price_group.markup_percentage7)},$scope.save_price_group=function(){return $scope.onSave?$scope.onSave():void 0},$scope.cancel_price_group=function(){return $scope.onCancel?$scope.onCancel():void 0},$scope.$watch("price_group",function(){return $scope.price_group?$scope.recalculate_margin_percentages():void 0})}}})}.call(this),function(){this.AutoWorkshopApp.directive("adPricingPlan",function(){return{restrict:"AE",restrict:"AE",require:"ngModel,showing",scope:{auto_workshop:"=ngModel",showing:"=",anchorElement:"@",placement:"@"},templateUrl:template("directives/ad_pricing_plans"),controller:function($scope,lookupService,popoverService,spinnerService,AutoWorkshop,navbarService){return $scope.pricing_plans=function(){return lookupService.available_pricing_packages()},$scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return popoverService.show("#change-pricing-plan",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#change-pricing-plan")},$scope.show_users=function(plan){var users;return users=plan.number_of_users_allowed,users?"<b>"+users+"</b> users/employees":"<b>Unlimited</b> users/employees"},$scope.show_stock_limit=function(plan){var stock_limit;return stock_limit=plan.stock_limit,stock_limit>0?"<b>"+stock_limit+"</b> stock items":"<b>Unlimited</b> stock items"},$scope.select_plan=function(plan){return AutoWorkshop.change_plan({plan:plan},function(data){return angular.copy(data,$scope.auto_workshop),navbarService.update_subscription_notification(),$scope.hide()})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adProcessPurchaseOrder",function(){return{restrict:"AE",restrict:"AE",require:"ngModel,showing",scope:{purchase:"=ngModel",showing:"=",onProcessed:"&",anchorElement:"@"},templateUrl:template("directives/ad_process_purchase_order"),controller:function($scope,formService,popoverService,spinnerService,lookupService,Purchase){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.purchase_items=[],angular.copy($scope.purchase.purchase_items,$scope.purchase_items),popoverService.show("#process-purchase-order-popover",$scope.anchorElement,{placement:"left"})},$scope.process=function(){return spinnerService.start_spinner("#process-purchase-order-spinner"),Purchase.processes({id:$scope.purchase.id,purchase_items:$scope.purchase_items},function(data){return spinnerService.stop_spinner("#process-purchase-order-spinner"),angular.copy(data,$scope.purchase),$scope.onProcessed&&$scope.onProcessed(),$scope.hide()})},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#process-purchase-order-popover")}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adPurchase",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{purchase:"=ngModel",job:"=job"},templateUrl:template("directives/ad_purchase"),controller:function($scope,$location,popoverService,permissionService,timeService,formService,lookupService,confirmationService,spinnerService,repcoNavigatorService,Purchase,PurchaseItem,RepcoNavigator){return $scope.confirm_edit_processed_purchase_order=function(callback){return $scope.purchase.processed?permissionService.check_finalize_documents_restriction_before_proceed(function(){return confirmationService.confirm($scope.edit_processed_purchase_order_warning(),!$scope.edit_processed_purchase_order_confirmed,function(){return $scope.edit_processed_purchase_order_confirmed=!0,callback()})}):callback()},$scope.edit_processed_purchase_order_warning=function(){return"You're editing an purchase order that has been processed.\n\nAre you sure you want to proceed?.\n\nIMPORTANT! Editing a processed purchase order requires:\n\n1. Manually updating the stock items' quantity on hand\n2. Manually placing the item on the invoice(if applicable)"},$scope.edit_purchase=function(){return $scope.confirm_edit_processed_purchase_order(function(){return formService.edit_fields($scope.purchase,"editing","id","supplier_id","date","due_date","reference","creditor_id","supplier","tracking_categories","title")})},$scope.save_purchase=function(){var updated;return updated=new Purchase($scope.purchase.editing),updated.$update(function(data){return angular.copy(data,$scope.purchase)})},$scope.tax_name=function(){return lookupService.tax_name()},$scope.cancel_edit_purchase=function(){return $scope.purchase.editing=void 0},$scope.purchase_item_total=function(purchase_item){return purchase_item&&purchase_item.unit_price&&purchase_item.quantity?purchase_item.unit_price*purchase_item.quantity:0},$scope.edit_purchase_item=function(purchase_item){return $scope.confirm_edit_processed_purchase_order(function(){var editing,element;return $scope.editing_purchase_item&&$scope.close_edit_purchase_item(),$scope.editing_purchase_item=purchase_item,formService.edit_fields($scope.editing_purchase_item,"editing"),editing=document.getElementById("editing-purchase-item"),element=document.getElementById("purchase-item-"+purchase_item.id),document.getElementById("purchase-item-list").insertBefore(editing,element)})},$scope.cancel_edit_purchase_item=function(){return $scope.close_edit_purchase_item()},$scope.close_edit_purchase_item=function(){return $scope.editing_purchase_item.editing=void 0,$scope.editing_purchase_item=void 0},$scope.save_purchase_item=function(form,purchase_item){return formService.submit_form($scope,form,function(){return Purchase.update_item({id:$scope.purchase.id,item:purchase_item.editing},function(data){return angular.copy(data,$scope.purchase),$scope.close_edit_purchase_item()})})},$scope.remove_purchase_item=function(purchase_item){return Purchase.delete_item({id:$scope.purchase.id,item:purchase_item},function(data){return angular.copy(data,$scope.purchase),$scope.close_edit_purchase_item()})},$scope.add_purchase_item=function(){return $scope.confirm_edit_processed_purchase_order(function(){var job;return $scope.new_purchase_item={unit_price:0,quantity:1,description:"code/description",note:""},job=$scope.job||$scope.purchase.job,job&&($scope.new_purchase_item.is_buyin=!0,$scope.new_purchase_item.job_id=job.id,$scope.new_purchase_item.job={id:job.id,title:job.title}),formService.select_text("#new-purchase-item-description")})},$scope.cancel_add_purchase_item=function(){return $scope.new_purchase_item=void 0},$scope.save_new_purchase_item=function(){var saving_item;return lookupService.disable_arbitrary_line_items()&&!$scope.new_purchase_item.stock_id?(alert("Please select an item from the dropdown or click 'Create Stock' button to create one"),void 0):(saving_item=$scope.new_purchase_item,$scope.new_purchase_item=void 0,$scope.purchase.purchase_items.push(saving_item),formService.focus("#new-purchase-item-button"),Purchase.new_item({id:$scope.purchase.id,item:saving_item},function(data){return angular.copy(data,$scope.purchase)}))},$scope.edit_purchase_description=function(){return formService.edit_fields($scope.purchase,"editing_description","id","description"),formService.select_text("#edit-purchase-description")},$scope.save_purchase_description=function(){return Purchase.update($scope.purchase.editing_description,function(data){return angular.copy(data,$scope.purchase)})},$scope.cancel_edit_purchase_description=function(){return $scope.purchase.editing_description=null},$scope.clear_purchase_description=function(){return $scope.purchase.editing_description.description="",Purchase.update($scope.purchase.editing_description,function(data){return angular.copy(data,$scope.purchase)})},$scope.open_delete_dialog=function(){return $scope.showing_delete_purchase_dialog=!0},$scope.do_delete_purchase=function(){return $scope.purchase=Purchase["delete"]({id:$scope.purchase.id}),$scope.showing_delete_purchase_dialog=!1},$scope.cancel_delete_purchase=function(){return $scope.showing_delete_purchase_dialog=!1},$scope.send_purchase_order=function(){return $scope.show_send_purchase_order=!0},$scope.process_purchase_order=function(){return Purchase.processes($scope.purchase,function(data){return angular.copy(data,$scope.purchase)})},$scope.reset_markup_percentage=function(item){return item.markup_percentage=void 0},$scope.unset_sell_price=function(item){return $scope.reset_markup_percentage(item),item.sell_price=void 0},$scope.default_markup_percentage=function(item){var customer,price_level;return $scope.job?customer=$scope.job.invoice&&$scope.job.invoice.customer?$scope.job.invoice.customer:$scope.job.insurer||$scope.job.customer:$scope.purchase.customer&&(customer=$scope.purchase.customer),customer?(price_level=customer.price_level||1,$scope.markup_percentages(item)[price_level-1]):$scope.markup_percentages(item)[0]},$scope.update_buyin_price=function(item,markup_percentage){return timeService.timeout(function(){return!item.is_buyin||item.is_non_charge?item.sell_price=0:(markup_percentage||0===markup_percentage?item.markup_percentage=markup_percentage:!item.markup_percentage&&$scope.markup_percentages(item).length>0&&(item.markup_percentage=$scope.default_markup_percentage(item)),(item.markup_percentage||0===item.markup_percentage)&&(item.sell_price=(item.unit_price*(1+item.markup_percentage/100)).round(4)),!item.included_gst&&lookupService.configurations().prices_include_gst?item.sell_price=(item.sell_price*(1+lookupService.configurations().tax_rate)).round(2):void 0)})},$scope.markup_percentages=function(item,unique){var markups;return null==unique&&(unique=!1),markups=item&&item.markup_percentages?item.markup_percentages:lookupService.configurations()&&lookupService.configurations().markup_percentages?lookupService.configurations().markup_percentages:[],unique&&(markups=markups.filter(function(el){return null!==el&&void 0!==el}),markups=markups.unique()),markups},$scope.template||($scope.template="full"),$scope.new_stock={with_gst:{}},$scope.select_new_stock=function(){var _base,_base1;return $scope.new_purchase_item.stock_id=$scope.new_stock.id,(_base=$scope.new_purchase_item).quantity||(_base.quantity=1),lookupService.configurations().disable_purchase_order_item_price?$scope.new_purchase_item.unit_price=0:(_base1=$scope.new_purchase_item).unit_price||(_base1.unit_price=$scope.new_stock.buy_price),$scope.new_purchase_item.description=""+$scope.new_stock.stock_number+" - "+($scope.new_stock.name||""),$scope.new_purchase_item.included_gst?void 0:$scope.new_purchase_item.included_gst=$scope.new_stock.included_gst},$scope.select_from_invoice_items=function(){return $scope.invoice_items=[],angular.copy($scope.job.invoice.items,$scope.invoice_items),popoverService.show("#purchase-invoice-items-selection","#select-invoice-items-button",{placement:"bottom"})},$scope.select_all_invoice_items=function(){return $scope.invoice_items.each(function(i){return i.selected=!0})},$scope.toggle_select_invoice_item=function(item){return item.selected=item.selected?!1:!0},$scope.close_select_from_invoice_items=function(){return popoverService.hide("#purchase-invoice-items-selection"),popoverService.hide("#purchase-invoice-items-confirmation")},$scope.confirm_invoice_item_selection=function(){return $scope.purchase.from_invoice_items=[],$scope.invoice_items.each(function(item){return item.selected?$scope.purchase.from_invoice_items.push({description:item.description,quantity:item.quantity,unit_price:item.buy_price,sku:item.sku,supplier_stock_number:item.supplier_stock_number,is_buyin:!0,sell_price:item.unit_price,stock_id:item.stock_id,invoice_item:item}):void 0}),popoverService.hide("#purchase-invoice-items-selection"),popoverService.show("#purchase-invoice-items-confirmation","#select-invoice-items-button",{placement:"bottom"})},$scope.add_invoice_item_selection=function(){return spinnerService.start_spinner("#add-invoice-item-spinner"),Purchase.new_items({id:$scope.purchase.id,purchase_items:$scope.purchase.from_invoice_items},function(data){return spinnerService.stop_spinner("#add-invoice-item-spinner"),angular.copy(data,$scope.purchase),$scope.close_select_from_invoice_items()})},$scope.repco_account=function(){return lookupService.repco_account()},$scope.quantum_account=function(){return lookupService.quantum_account()},$scope.pro_link_account=function(){return lookupService.pro_link_account()},$scope.motospecs_account=function(){return lookupService.motospecs_account()},$scope.add_items_from_repco=function(account){return RepcoNavigator.purchase_order_access({id:$scope.purchase.id,parts:!0,account_id:account.id},function(data){return window.$repco_scope=$scope,repcoNavigatorService.inquiry(data.url,account)})},$scope.repco_success=function(){return $scope.onRepcoSuccess?$scope.onRepcoSuccess():Purchase.get({id:$scope.purchase.id},function(data){return angular.copy(data,$scope.purchase)})},$scope.oscar_success=function(){return $scope.onOscarSuccess?$scope.onOscarSuccess():Purchase.get({id:$scope.purchase.id},function(data){return angular.copy(data,$scope.purchase)})},$scope.open=function(bo){return $location.path("/purchases/"+bo.id)},$scope.enable_tracking_category_selection=function(){return lookupService.configurations().enable_tracking_category_selection},$scope.$watch("purchase.open_invoice_items",function(){return $scope.purchase&&$scope.purchase.open_invoice_items?($scope.select_from_invoice_items(),$scope.purchase.open_invoice_items=!1):void 0})}}})}.call(this),function(){this.AutoWorkshopApp.directive("adPurchaseHistory",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{stock:"=ngModel"},templateUrl:template("directives/ad_purchase_history"),controller:function($scope,$location,$window,spinnerService,Stock){return $scope.$watch("stock",function(){return $scope.search()}),$scope.goto=function(item){return item.bill?$window.open("#/bills/"+item.bill.id):item.supplier_credit_note?$window.open("#/supplier_credit_notes/"+item.supplier_credit_note.id):void 0},$scope.search=function(number){return null==number&&(number=1),$scope.stock&&$scope.stock.id?(spinnerService.start_spinner("#purchase-history-spinner"),Stock.purchase_history({id:$scope.stock.id,page:number},function(data){return $scope.keyword=$scope.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.bill_items=data.bill_items,spinnerService.stop_spinner("#purchase-history-spinner")})):void 0},$scope.search()}}})}.call(this),function(){this.AutoWorkshopApp.directive("adPurchaseOrderBillForm",function(){return{restrict:"AE",restrict:"AE",scope:{purchase:"=ngModel",showing:"=",anchorElement:"@",placement:"@",onSave:"&",onCancel:"&"},templateUrl:template("directives/ad_purchase_order_bill_form"),controller:function($scope,lookupService,popoverService,timeService,permissionService,paymentTermService,Bill,Purchase){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.$watch("bill.date",function(){return $scope.populate_due_date()}),$scope.show=function(){return $scope.input_accounts=lookupService.input_accounts(),$scope.bill={supplier_id:$scope.purchase.supplier_id,supplier:$scope.purchase.supplier,total_amount:$scope.purchase.total_amount,date:timeService.current(),due_date:timeService.current(),billing_supplier_id:$scope.purchase.creditor_id,tracking_categories:$scope.purchase.tracking_categories},$scope.placement||($scope.placement="bottom"),popoverService.show("#purchase-bill-popover",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return popoverService.hide("#purchase-bill-popover")},$scope.save=function(){return $scope.bill.purchase_id=$scope.purchase.id,Bill.save($scope.bill,function(data){return $scope.purchase&&Purchase.get({id:$scope.purchase.id},function(data){return angular.copy(data,$scope.purchase)}),$scope.onSave?($scope.onSave(data),$scope.hide()):void 0})},$scope.cancel=function(){return $scope.showing=void 0,$scope.onCancel?$scope.onCancel():void 0},$scope.populate_due_date=function(){var supplier;return $scope.bill&&$scope.bill.date?(supplier=$scope.bill.supplier,$scope.bill.due_date=supplier&&supplier.payment_term?paymentTermService.due_date($scope.bill.date,supplier.payment_term):$scope.bill.date):void 0},$scope.restricted_to_finalize_documents=function(){return permissionService.restricted_to_finalize_documents()},$scope.enable_tracking_category_selection=function(){return lookupService.configurations().enable_tracking_category_selection}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adPurchaseOrderForm",function(){return{restrict:"AE",restrict:"AE",scope:{purchase:"=ngModel",invoice:"=",job:"=",onSave:"&",onSaveAndSend:"&",onCancel:"&"},templateUrl:template("directives/ad_purchase_order_form"),controller:function($scope,timeService,lookupService,popoverService,spinnerService,Purchase){return $scope.save=function(){return $scope.purchase.supplier_id?(spinnerService.start_spinner("#create-purchase-order-spinner"),Purchase.save($scope.purchase,function(data){var open_invoice_items;return spinnerService.stop_spinner("#create-purchase-order-spinner"),open_invoice_items=$scope.purchase.open_invoice_items,angular.copy(data,$scope.purchase),$scope.purchase.open_invoice_items=open_invoice_items,$scope.onSave?$scope.onSave(data):void 0})):alert("Please select a supplier or click New to create one")},$scope.cancel=function(){return $scope.onCancel?$scope.onCancel():void 0},$scope.$watch("purchase.supplier_id",function(){return $scope.purchase&&$scope.purchase.supplier_id&&$scope.purchase.supplier&&$scope.purchase.supplier.creditor_id?$scope.purchase.creditor_id=$scope.purchase.supplier.creditor_id:void 0}),$scope.enable_tracking_category_selection=function(){return lookupService.configurations().enable_tracking_category_selection}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adPurchaseOrderSelection",function(){return{restrict:"AE",restrict:"AE",require:"supplier,showing,title",scope:{supplier:"=",showing:"=",title:"@",anchorElement:"@",placement:"@",selection:"=",onSelect:"&"},templateUrl:template("directives/ad_purchase_order_selection"),controller:function($scope,popoverService,spinnerService,Purchase){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.payment={},$scope.show=function(){return spinnerService.start_spinner("#purchase-order-selection-spinner"),Purchase.not_billed({supplier_id:$scope.supplier.id},function(data){return spinnerService.stop_spinner("#purchase-order-selection-spinner"),$scope.purchases=data
}),popoverService.show("#purchase-order-selection",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#purchase-order-selection")},$scope.show_items=function(purchase){return purchase.show_items=!0},$scope.hide_items=function(purchase){return purchase.show_items=!1},$scope.select=function(purchase){return $scope.selection&&$scope.selection.add(purchase),purchase.selected=!0},$scope.deselect=function(purchase){return $scope.selection&&$scope.selection.remove(purchase),purchase.selected=!1},$scope.do_select=function(){return $scope.onSelect?$scope.onSelect.call():void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adPutOnHold",function(){return{restrict:"AE",restrict:"AE",scope:{job:"=ngModel",showing:"=",anchorElement:"=",placement:"@",onSuccess:"&"},templateUrl:template("directives/ad_put_on_hold"),controller:function($scope,popoverService,lookupService,formService,Job){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return popoverService.show("#put-on-hold-dialog",$scope.anchorElement,{placement:$scope.placement,fixed_position:!0}),formService.focus("#put-on-hold-reason")},$scope.hide=function(){return popoverService.hide("#put-on-hold-dialog")},$scope.set_on_hold_reason=function(reason){return $scope.on_hold_reason=reason,formService.focus("#put-on-hold-reason")},$scope.put_on_hold=function(){return Job.put_on_hold({id:$scope.job.id,on_hold_reason:$scope.on_hold_reason},function(){return $scope.job.on_hold=!0,popoverService.hide("#put-on-hold-dialog"),$scope.onSuccess&&$scope.onSuccess(),$scope.showing=!1})},$scope.cancel=function(){return $scope.on_hold_reason=void 0,$scope.showing=!1}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adQuote",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{quote:"=ngModel",job:"="},templateUrl:template("directives/ad_quote"),controller:function($scope,formService,spinnerService,popoverService,lookupService,repcoNavigatorService,stockInfoService,timeService,Quote,Stock,Customer,RepcoNavigator){return $scope.tax_name=function(){return lookupService.tax_name()},$scope.repco_account=function(){return lookupService.repco_account()},$scope.quantum_account=function(){return lookupService.quantum_account()},$scope.pro_link_account=function(){return lookupService.pro_link_account()},$scope.motospecs_account=function(){return lookupService.motospecs_account()},$scope.edit_quote_description=function(){return formService.edit_fields($scope.quote,"editing_description","id","description")},$scope.cancel_edit_quote_description=function(){return $scope.quote.editing_description=void 0},$scope.save_quote_description=function(){return Quote.update($scope.quote.editing_description,function(data){return angular.copy(data,$scope.quote)})},$scope.edit_issue_date=function(){return formService.edit_fields($scope.quote,"editing_issue_date","id","issue_date")},$scope.save_issue_date=function(){return formService.submit_form($scope,$scope.edit_issue_date_form,function(){return Quote.update($scope.quote.editing_issue_date,function(data){return angular.copy(data,$scope.quote)})})},$scope.edit_item_details=function(item){return item.edit_details=!0},$scope.show_item_details=function(item){return item.show_details=!0},$scope.hide_item_details=function(item){return item.show_details=!1},$scope.show_stock=function(item){return stockInfoService.show(item.stock_id,"#ad-quote","top")},$scope.add_item=function(){return formService.select_text("#new-item-description"),$scope.new_item={quote_id:$scope.quote.id,description:"description",quantity:1,unit_price:0,included_gst:lookupService.configurations().prices_include_gst,discount_percentage:0}},$scope.add_header=function(){return formService.select_text("#new-item-header-description"),$scope.new_item={quote_id:$scope.quote.id,description:"description",header:!0}},$scope.save_new_item=function(){var form;if($scope.new_item.header)form=$scope.new_item_header_form;else{if(lookupService.disable_arbitrary_line_items()&&!$scope.new_item.stock_id)return alert("Please select an item from the dropdown or click 'Create Stock' button to create one"),void 0;form=$scope.new_item_form}return formService.submit_form($scope,form,function(){var saving_item;return saving_item=$scope.new_item,saving_item.saving=!0,$scope.quote.quote_items.push(saving_item),$scope.new_item=null,timeService.timeout(function(){return document.getElementById("add-item-button").focus()}),Quote.new_item({id:$scope.quote.id,item:saving_item},function(data){return angular.copy(data,$scope.quote)})})},$scope.edit_item=function(item){var editing,element;return $scope.editing_quote_item&&$scope.close_edit_item(),$scope.editing_quote_item=item,formService.edit_fields($scope.editing_quote_item,"editing"),editing=document.getElementById("editing-quote-item"),element=document.getElementById("quote-item-"+item.id),document.getElementById("quote-item-list").insertBefore(editing,element)},$scope.cancel_edit_item=function(){return $scope.editing_quote_item.editing=null,$scope.close_edit_item()},$scope.save_item=function(form,item){return formService.submit_form($scope,form,function(){return Quote.update_item({id:$scope.quote.id,item:item.editing},function(data){return angular.copy(data,$scope.quote),$scope.close_edit_item()})})},$scope.remove_item=function(item){return item.header&&!item.editing.confirm_deletion?item.editing.confirm_deletion=!0:Quote.delete_item({id:$scope.quote.id,item:item,include_children:item.editing.delete_children},function(data){return angular.copy(data,$scope.quote),$scope.close_edit_item()})},$scope.close_edit_item=function(){return $scope.editing_quote_item.editing=void 0,$scope.editing_quote_item=void 0},$scope.cancel_add_item=function(){return $scope.new_item=null},$scope.item_total=function(item){return item&&item.quantity&&item.unit_price?item.quantity*item.unit_price*(1-item.discount_percentage/100):0},$scope.edit_quote_details=function(){return formService.edit_fields($scope.quote,"editing_details","id","details"),formService.focus("#edit-quote-details"),$scope.quote.editing_details.auto_save=!0,$scope.auto_save_quote_details()},$scope.save_quote_details=function(terminate){return null==terminate&&(terminate=!0),$scope.quote.editing_details?($scope.quote.editing_details.saving=!0,Quote.update($scope.quote.editing_details,function(data){return $scope.quote.editing_details.saving=!1,$scope.quote.details=data.details,terminate?$scope.quote.editing_details=void 0:void 0})):void 0},$scope.cancel_edit_quote_details=function(){return $scope.quote.editing_details=null},$scope.auto_save_quote_details=function(){if($scope.quote.editing_details){if($scope.quote.editing_details.auto_save)return $scope.quote.editing_details.auto_save_process=timeService.timeout(function(){return $scope.quote.editing_details&&$scope.quote.editing_details.details!==$scope.quote.details&&$scope.save_quote_details(!1),$scope.auto_save_quote_details()},1e4);if($scope.quote.editing_details.auto_save_process)return timeService.timeout.cancel($scope.quote.editing_details.auto_save_process)}},$scope.clear_quote_details=function(){return $scope.quote.editing_details.details="",Quote.update($scope.quote.editing_details,function(data){return angular.copy(data,$scope.quote)})},$scope.add_job_types=function(){return $scope.new_job_types=[],popoverService.show("#add-job-types-popover","#add-job-types-button",{placement:"top"})},$scope.hide_add_job_types=function(){return $scope.new_job_types=[],popoverService.hide("#add-job-types-popover")},$scope.save_new_job_types=function(){return spinnerService.start_spinner("#add-quote-job-types-spinner"),Quote.add_job_types({id:$scope.quote.id,job_types:$scope.new_job_types},function(data){return angular.copy(data,$scope.quote),$scope.hide_add_job_types(),spinnerService.stop_spinner("#add-quote-job-types-spinner")})},$scope.select_price_level=function(item,price){return item.unit_price=price},$scope.quote_item_sortable_options={handle:".dragable-handle",helper:"clone",stop:function(){return $scope.reorder_quote_items()}},$scope.reorder_quote_items=function(){return Quote.reorder_items({id:$scope.quote.id,items:$scope.quote.quote_items},function(data){return angular.copy(data,$scope.quote)})},$scope.add_items_from_repco=function(account){return RepcoNavigator.quote_access({id:$scope.quote.id,account_id:account.id},function(data){return window.$repco_scope=$scope,repcoNavigatorService.open_smart_quote($scope.quote,data.url,account)})},$scope.repco_success=function(){return Quote.get({id:$scope.quote.id},function(data){return angular.copy(data,$scope.quote)})},$scope.customer=function(){return $scope.quote?$scope.quote.paying_customer:void 0},$scope.not_registered_for_gst=function(){return $scope.quote?$scope.quote.not_registered_for_gst:lookupService.configurations().not_registered_for_gst},$scope.edit_quote_discount=function(){return formService.edit_fields($scope.quote,"editing_discount","id","discount_money","discount_percentage")},$scope.cancel_edit_quote_discount=function(){return $scope.quote.editing_discount=null},$scope.update_quote_discount=function(){return Quote.update($scope.quote.editing_discount,function(data){return angular.copy(data,$scope.quote)})},$scope.new_stock={with_gst:{}},$scope.select_new_stock=function(){var customer,_base;return $scope.new_item.stock_id=$scope.new_stock.id,(_base=$scope.new_item).quantity||(_base.quantity=1),$scope.new_item.description=""+$scope.new_stock.stock_number+" - "+($scope.new_stock.name||""),$scope.new_item.included_gst||($scope.new_item.included_gst=$scope.new_stock.included_gst),customer=$scope.customer(),$scope.new_item.unit_price=customer&&customer.price_level&&$scope.new_stock["price"+customer.price_level]>0?$scope.new_stock["price"+customer.price_level]:$scope.new_stock.price,$scope.new_stock.prices?$scope.new_item.prices=$scope.new_stock.prices:void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adQuoteCogs",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{quote:"=ngModel",job:"="},templateUrl:template("directives/ad_quote_cogs"),controller:function($scope,navbarService,formService,lookupService,spinnerService,popoverService,AutoWorkshop,Job,Quote){return $scope.$watch("quote",function(){return $scope.quote||($scope.quote={quote_items:[]}),$scope.quote.id?void 0:$scope.quote.not_registered_for_gst=lookupService.configurations().not_registered_for_gst}),$scope.quote_item_total=function(quote_item){return quote_item&&quote_item.cost_quantity&&quote_item.buy_price?quote_item.cost_quantity*quote_item.buy_price:0},$scope.profit_margin=function(){return $scope.quote?($scope.quote.net_amount-$scope.total_cost()).toFixed(2):0},$scope.profit_margin_percentage=function(){return $scope.quote?(100*($scope.profit_margin()/$scope.quote.net_amount)).toFixed(2):0},$scope.total_cost=function(){var total;return total=0,$scope.quote&&$scope.quote.quote_items&&$scope.quote.quote_items.length>0&&$scope.quote.quote_items.each(function(i){return total+=i.total_cost}),total},$scope.edit_cogs=function(quote_item){var editing,element;return $scope.editing_quote_item=quote_item,formService.edit_fields(quote_item,"editing_cogs","id","buy_price"),editing=document.getElementById("editing-quote-item-cogs"),element=document.getElementById("quote-item-cogs-"+quote_item.id),document.getElementById("quote-item-cogs").insertBefore(editing,element)},$scope.cancel_edit_cogs=function(quote_item){return quote_item===$scope.new_cogs?$scope.new_cogs=void 0:quote_item.editing_cogs=void 0},$scope.add_cogs=function(){return $scope.new_cogs={}},$scope.show_item=function(quote_item){return quote_item.stock_id||quote_item.bill_item_id||quote_item.purchase_item_id||quote_item.cost_quantity>0||quote_item.buy_price>0},$scope.select_cogs=function(){var item;return $scope.new_cogs.id?(item=$scope.quote.quote_items.find(function(item){return item.id===$scope.new_cogs.id}),$scope.new_cogs.cost_quantity=item.cost_quantity):void 0},$scope.save_cogs=function(quote_item){var item;return item=quote_item===$scope.new_cogs?$scope.new_cogs:quote_item.editing_cogs,Quote.update_item({id:$scope.quote.id,item:item},function(data){return angular.copy(data,$scope.quote),$scope.new_cogs=void 0,$scope.editing_quote_item=void 0})},$scope.selectable_items=function(){return $scope.quote&&$scope.quote.quote_items?$scope.quote.quote_items.findAll(function(item){return!item.header&&!$scope.show_item(item)}):[]}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adQuotepicker",function(){return{restrict:"AE",restrict:"AE",scope:{quoteId:"=ngModel",quote:"=",customerId:"=",onSelect:"&",input_id:"@inputId",readonly:"="},templateUrl:template("directives/ad_quotepicker"),controller:function($scope,lookupService){return $scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.lookup=function(term){return lookupService.lookup_quotes({term:term,customer_id:$scope.customerId},"#lookup-quote-spinner-"+$scope.spinner_id,"#lookup-quote-icon-"+$scope.spinner_id)},$scope.select=function(selected_quote){return $scope.quote.id=selected_quote.id,$scope.quote.title=selected_quote.title,$scope.quote.customer_id=selected_quote.customer_id,$scope.quoteId=selected_quote.id,$scope.onSelect?$scope.onSelect():void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adRepcoNavigator",function(){return{restrict:"AE",restrict:"AE",templateUrl:template("directives/ad_repco_navigator"),controller:function($scope,lookupService,popoverService,repcoNavigatorService){return $scope.repco_account=function(){return lookupService.repco_account()},$scope.repco_purchase=function(){return repcoNavigatorService.purchase()},$scope.purchase_item_index=function(item){return $scope.accepted_purchase_items().indexOf(item)+1},$scope.repco_vehicle=function(){return repcoNavigatorService.vehicle()},$scope.repco_vehicle_year=function(){var value,vehicle;return vehicle=$scope.repco_vehicle(),vehicle&&vehicle.year?(value=vehicle.year.match(/\d\d\d\d\s*$/),value&&value.length>0?value[0]:vehicle.year):""},$scope.repco_vehicle_vin_or_registration_number=function(){var country,vehicle;return country=lookupService.country(),vehicle=$scope.repco_vehicle(),"au"===country&&vehicle&&vehicle.vin&&vehicle.vin.length>0?vehicle.vin:"nz"===country&&vehicle&&vehicle.registration_number?vehicle.registration_number:""},$scope.accepted_purchase_items=function(){return $scope.repco_purchase()?$scope.repco_purchase().purchase_items.findAll(function(i){return i.sku}):[]},$scope.hooked_url=function(){return repcoNavigatorService.hooked_url()},$scope.section=function(){return repcoNavigatorService.section()},$scope.purchase_item_price=function(item){return item.unit_price_include_gst>0?item.unit_price_include_gst:1}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adSaleHistory",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{stock:"=ngModel"},templateUrl:template("directives/ad_sale_history"),controller:function($scope,$location,$window,spinnerService,Stock){return $scope.$watch("stock",function(){return $scope.search()}),$scope.goto=function(item){return item.invoice?$window.open("#/invoices/"+item.invoice.id):item.credit_note?$window.open("#/credit_notes/"+item.credit_note.id):void 0},$scope.search=function(number){return null==number&&(number=1),$scope.stock&&$scope.stock.id?(spinnerService.start_spinner("#sale-history-spinner"),Stock.sale_history({id:$scope.stock.id,page:number},function(data){return $scope.keyword=$scope.query,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,$scope.invoice_items=data.invoice_items,spinnerService.stop_spinner("#sale-history-spinner")})):void 0},$scope.search()}}})}.call(this),function(){this.AutoWorkshopApp.directive("adSavedTexts",function(){return{restrict:"AE",restrict:"AE",scope:{},templateUrl:template("directives/ad_saved_texts"),controller:function($scope,$timeout,lookupService,timeService,savedTextsService,spinnerService,popoverService,confirmationService,formService,dateFilter,CommunicationTemplate){return $scope.hide=function(){return popoverService.hide("#saved-texts-popover")},$scope.create_saved_text=function(){return $scope.editing_saved_text={},$scope.saved_text_template?(angular.copy($scope.saved_text_template,$scope.editing_saved_text),formService.select_text("#editing-saved-text-input")):CommunicationTemplate.new_saved_text(function(data){return $scope.saved_text_template=data,angular.copy(data,$scope.editing_saved_text),$scope.editing_saved_text.name="",formService.select_text("#editing-saved-text-input")})},$scope.edit=function(template){return formService.edit_fields(template,"editing","id","name","message","subject","variables"),$scope.editing_saved_text=template.editing},$scope.save=function(form){return $scope.editing_saved_text.id?formService.submit_form($scope,form,function(){return CommunicationTemplate.update($scope.editing_saved_text,function(data){return data.errors?angular.copy(data,$scope.editing_saved_text):($scope.search(),$scope.editing_saved_text=void 0)})}):formService.submit_form($scope,form,function(){return CommunicationTemplate.save($scope.editing_saved_text,function(data){return angular.copy(data,$scope.editing_saved_text),data.errors&&0!==data.errors.length?void 0:($scope.search(),$scope.editing_saved_text=void 0)})})},$scope.remove=function(){return confirmationService.danger_confirm("Delete this saved text?",!0,function(){return CommunicationTemplate["delete"]($scope.editing_saved_text,function(){return $scope.search(),$scope.editing_saved_text=void 0})})},$scope.cancel_editing=function(){return $scope.editing_saved_text=void 0},$scope.context=function(){return savedTextsService.context()},$scope.attribute=function(){return savedTextsService.attribute()},$scope.subject=function(){return savedTextsService.subject()},$scope.process_values=function(){var _ref,_ref1,_ref10,_ref11,_ref12,_ref13,_ref14,_ref15,_ref16,_ref17,_ref18,_ref19,_ref2,_ref20,_ref21,_ref22,_ref23,_ref24,_ref25,_ref26,_ref27,_ref28,_ref29,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8,_ref9;return{date:dateFilter(null!=(_ref=savedTextsService.invoice())?_ref.issue_date:void 0,"medium"),customer_name:null!=(_ref1=savedTextsService.customer())?_ref1.name:void 0,customer_first_name:null!=(_ref2=savedTextsService.customer())?_ref2.first_name:void 0,driver_name:null!=(_ref3=savedTextsService.vehicle())?_ref3.driver_name:void 0,vehicle_title:null!=(_ref4=savedTextsService.vehicle())?_ref4.title:void 0,vehicle_make:null!=(_ref5=savedTextsService.vehicle())?_ref5.make:void 0,vehicle_model:null!=(_ref6=savedTextsService.vehicle())?_ref6.model:void 0,vehicle_vin:null!=(_ref7=savedTextsService.vehicle())?_ref7.vin:void 0,vehicle_engine_number:null!=(_ref8=savedTextsService.vehicle())?_ref8.engine_number:void 0,service_item:null!=(_ref9=savedTextsService.vehicle())?_ref9.title:void 0,registration_number:null!=(_ref10=savedTextsService.vehicle())?_ref10.registration_number:void 0,fleet_number:null!=(_ref11=savedTextsService.vehicle())?_ref11.fleet_number:void 0,registration_due_date:dateFilter(null!=(_ref12=savedTextsService.vehicle())?_ref12.registration_due_date:void 0,"mediumDate"),odometer:(null!=(_ref13=savedTextsService.job())?_ref13.odometer:void 0)||(null!=(_ref14=savedTextsService.invoice())?_ref14.odometer:void 0)||(null!=(_ref15=savedTextsService.quote())?_ref15.odometer:void 0),description:(null!=(_ref16=savedTextsService.job())?_ref16.description:void 0)||(null!=(_ref17=savedTextsService.invoice())?_ref17.description:void 0)||(null!=(_ref18=savedTextsService.quote())?_ref18.description:void 0),number:(null!=(_ref19=savedTextsService.invoice())?_ref19.number:void 0)||(null!=(_ref20=savedTextsService.quote())?_ref20.number:void 0),total_amount:(null!=(_ref21=savedTextsService.invoice())?_ref21.total_amount:void 0)||(null!=(_ref22=savedTextsService.quote())?_ref22.total_amount:void 0),unpaid_amount:null!=(_ref23=savedTextsService.invoice())?_ref23.unpaid_amount:void 0,claim_number:(null!=(_ref24=savedTextsService.job())?_ref24.claim_number:void 0)||(null!=(_ref25=savedTextsService.invoice())?_ref25.claim_number:void 0)||(null!=(_ref26=savedTextsService.quote())?_ref26.claim_number:void 0),order_number:(null!=(_ref27=savedTextsService.job())?_ref27.order_number:void 0)||(null!=(_ref28=savedTextsService.invoice())?_ref28.order_number:void 0)||(null!=(_ref29=savedTextsService.quote())?_ref29.order_number:void 0)}},$scope.process=function(saved_text){var values;return values=$scope.process_values(saved_text),saved_text.message.replace(/%\{([\w,\s,-]*)\}/gi,function(match){var variable;return variable=match.replace(/%{\s*/,"").replace(/\s*}/,""),values[variable]?values[variable]:match})},$scope.process_subject=function(saved_text){var values;return values=$scope.process_values(saved_text),saved_text.subject&&saved_text.subject.length>0?saved_text.subject.replace(/%\{([\w,\s,-]*)\}/gi,function(match){var variable;return variable=match.replace(/%{\s*/,"").replace(/\s*}/,""),values[variable]?values[variable]:match}):""},$scope.insert=function(saved_text){var attribute,context,subject;return saved_text&&$scope.context()&&(context=$scope.context(),attribute=$scope.attribute(),subject=$scope.subject(),context[attribute]=context[attribute]&&0!==context[attribute].length?context[attribute].concat("\n"+$scope.process(saved_text)):$scope.process(saved_text),subject&&subject.length>0&&(context[subject]=context[subject]&&0!==context[subject].length?context[subject].concat("\n"+$scope.process_subject(saved_text)):$scope.process_subject(saved_text))),$scope.hide()},$scope.replace=function(saved_text){var attribute,context,subject;return saved_text&&$scope.context()&&(context=$scope.context(),attribute=$scope.attribute(),subject=$scope.subject(),context[attribute]=$scope.process(saved_text),subject&&subject.length>0&&(context[subject]=$scope.process_subject(saved_text))),$scope.hide()},$scope.search=function(page){return null==page&&(page=1),timeService.cancel_timeout($scope.searching),$scope.searching=$timeout($scope.looking_up(page),1e3)},$scope.$on("$destroy",function(){return $timeout.cancel($scope.searching)}),$scope.looking_up=function(page){return null==page&&(page=1),spinnerService.start_spinner("#saved-text-search-spinner"),CommunicationTemplate.saved_text_search({query:$scope.query,page:page,per_page:8},function(data){return spinnerService.stop_spinner("#saved-text-search-spinner"),$scope.saved_texts=data.saved_texts,$scope.page_number=data.meta.page,$scope.total_pages=data.meta.total_pages,timeService.timeout(function(){var clipboard;return clipboard=new Clipboard(".copy-to-clipboard"),clipboard.on("success",function(event){return event.clearSelection(),$scope.hide()})})}),null},$scope.search()}}})}.call(this),function(){this.AutoWorkshopApp.directive("adSavedTextsButton",function(){return{restrict:"AE",restrict:"AE",scope:{job:"=",customer:"=",invoice:"=",vehicle:"=",quote:"=",ngModel:"=",subject:"=",populateSubject:"@",anchorElement:"@",placement:"@"},templateUrl:template("directives/ad_saved_texts_button"),controller:function($scope,savedTextsService){return $scope.show=function(){var options;return options={job:$scope.job,anchor:$scope.anchorElement,placement:$scope.placement,customer:$scope.customer,vehicle:$scope.vehicle,invoice:$scope.invoice,quote:$scope.quote,context:$scope,attribute:"ngModel"},$scope.populateSubject&&(options.subject="subject"),savedTextsService.show(options)},$scope.hide=function(){return savedTextsService.hide()}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adScheduler",function(){return{restrict:"AE",restrict:"AE",scope:{eventView:"@",showing:"=",date:"=",calendarHeight:"@",showingEmployees:"=",showingEmployeeList:"="},templateUrl:template("directives/ad_scheduler"),controller:function($routeParams,$location,$timeout,$window,$cookies,lookupService,spinnerService,popoverService,formService,confirmationService,dateFilter,$scope,timeService,Booking,Job,navbarService,Session,Employee,Day,AutoWorkshop){var header,today;return today=new Date,$scope.showing_employees=[],$scope.showing_employee_list=$scope.showingEmployeeList,$scope.showing_events=["booked","started","finished","on_hold"],lookupService.configurations()&&lookupService.configurations().hide_finished_job_on_diary_by_default&&$scope.showing_events.remove("finished"),$scope.days=[],$scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.close_all_action_dialogs=function(){return $scope.putting_on_hold=!1,$scope.sending_email=!1,$scope.sending_sms=!1,$scope.tagging_job=!1,$scope.tagging_booking=!1,$scope.assigning_job=!1,$scope.adjusting_job_time=!1},$scope.day_view_with_time=function(){return"true"===$cookies.day_view_with_time?!0:!1},$scope.toggle_day_view_with_time=function(){return $cookies.day_view_with_time=$scope.day_view_with_time()?"false":"true",timeService.timeout(function(){return $scope.bookingCalendar.fullCalendar("render",!1)})},$scope.adjust_day_view_css=function(){return $scope.day_view_with_time()?(jQuery(".fc-agenda-slots").show(),jQuery(".fc-agenda-divider").show(),jQuery(".fc-agenda-axis").show()):(jQuery(".fc-agenda-slots").hide(),jQuery(".fc-agenda-divider").hide(),jQuery(".fc-agenda-axis").hide())},$scope.rerender=function(){return"resourceDay"===$scope.view?($scope.refresh(),$scope.hide_event_dialog()):$scope.bookingCalendar.fullCalendar("render",!1)},$scope.show=function(){return $scope.bookingCalendar.fullCalendar("render"),$scope.showing_employee_list?$scope.show_employee_list():void 0},$scope.restricted_to_create_jobs=function(){return lookupService.restricted_to_create_jobs()},$scope.display_address=function(customer){return customer?customer.street_address&&customer.street_address.street_line&&customer.street_address.street_line.length>0?customer.street_address:customer.address:{}},$scope.hide=function(){},$scope.toggle_all_employees=function(){return $scope.showing_all_employees?($scope.showing_all_employees=!1,$scope.showing_employees=[]):($scope.showing_all_employees=!0,$scope.showing_employees=$scope.employees.map(function(e){return e.id.toString()}),$scope.showing_employees.add("0")),$scope.refresh()},$scope.toggle_auto_refresh=function(){return $scope.auto_refreshing?$scope.auto_refresh(!1):$scope.auto_refresh(!0)},$scope.refreshing=function(){var rate;return $scope.bookingCalendar&&$scope.refresh(),rate=lookupService.preference("diary_auto_refresh_rate")||120,rate=1e3*rate,$scope.auto_refreshing=$timeout($scope.refreshing,rate)},$scope.refresh_rate=function(){var rate;return rate=lookupService.preference("diary_auto_refresh_rate")||120,60>rate?""+rate+" seconds":""+rate/60+" minutes"},$scope.auto_refresh=function(value){return value?($scope.auto_refresh_status=!0,$scope.refreshing(),$scope.$on("$destroy",function(){return $scope.auto_refresh(!1)})):($scope.auto_refresh_status=!1,$scope.auto_refreshing?($timeout.cancel($scope.auto_refreshing),$scope.auto_refreshing=void 0):void 0)},$scope.edit_diary=function(){return $scope.showing_diary_workload=!0},$scope.overloaded=function(day){return day||(day=$scope.selected_date),day?$scope.days.find(function(date){return moment(date.date).isSame(moment(day))&&"overloaded"===date.status}):void 0},$scope.available=function(day){return day||(day=$scope.selected_date),day?$scope.days.find(function(date){return moment(date.date).isSame(moment(day))&&"available"===date.status}):void 0},$scope.diary_day=function(day){return day?$scope.days.find(function(date){return moment(date.date).isSame(moment(day))}):void 0},$scope.fully_booked=function(day){return day||(day=$scope.selected_date),day?$scope.days.find(function(date){return moment(date.date).isSame(moment(day))&&date.fully_booked}):void 0},$scope.new_booking=function(){var view_date;return view_date=$scope.selected_date||new Date,$location.path("/bookings/new").search({booking_date:$scope.selected_date,bookingView:$scope.view,year:view_date.getFullYear(),month:view_date.getMonth(),date:view_date.getDate()})},$scope.new_job=function(){return $location.path("/jobs/new").search({time:$scope.selected_date})},$scope.mark_as_fully_booked=function(){var day;return day=$scope.days.find(function(date){return moment(date.date).isSame($scope.selected_date)}),day||(day={date:$scope.selected_date.toString()}),day.fully_booked=!0,Day.update(day,function(data){return angular.copy(data,day),$scope.refresh(),$scope.close_actions()})},$scope.day_resource_view=function(){var day;return day=$scope.selected_date,$scope.bookingCalendar.fullCalendar("gotoDate",day.getFullYear(),day.getMonth(),day.getDate()),lookupService.session()&&lookupService.session().is_restricted_mechanic||lookupService.session().is_mechanic?$scope.bookingCalendar.fullCalendar("changeView","basicDay"):$scope.bookingCalendar.fullCalendar("changeView","resourceDay"),$scope.refresh(),timeService.timeout(function(){return $scope.bookingCalendar.fullCalendar("render",!1)}),$scope.close_actions()},$scope.unmark_as_fully_booked=function(){var day;return day=$scope.days.find(function(date){return moment(date.date).isSame($scope.selected_date)}),day||(day={date:$scope.selected_date.toString()}),day.fully_booked=!1,Day.update(day,function(data){return angular.copy(data,day),$scope.refresh()})},$scope.new_booking_popover=function(date,allDay,jsEvent){return $scope.selected_date=date,timeService.timeout(function(){return popoverService.show_in_position("#new-booking-popover",jsEvent.clientX,jsEvent.clientY,{placement:"bottom",fixed_position:!0})})},$scope.close_actions=function(){return popoverService.hide("#new-booking-popover")},$scope.resize_event=function(event){return"resourceDay"===$scope.view&&$scope.day_view_with_time()?Job.resize({type:event.type,id:event.id,finished_time:event.end},function(data){return event.time=data.time,event.total_hours=data.total_hours,data.finished_time&&(event.finished_time=data.finished_time),$scope.build_event(event),$scope.bookingCalendar.fullCalendar("render",!1)}):void 0},$scope.move_event=function(event,delta,minuteDelta,isAllDay,revertFunc,jsEvent){var from_employee,resources,to_employee;return"resourceDay"===$scope.view?$scope.day_view_with_time()?Job.reassign({type:event.type,id:event.id,employee_ids:event.resources,delta:minuteDelta/1440},function(data){return event.employees=data.employees,event.time=data.time,event.total_hours=data.total_hours,data.finished_time&&(event.finished_time=data.finished_time),$scope.build_event(event),$scope.bookingCalendar.fullCalendar("render",!1)}):(resources=$scope.resources(),from_employee=resources[jsEvent.srcCell.col],to_employee=resources[jsEvent.srcCell.col+delta],"unassigned"!==to_employee.id&&event.employees.push(to_employee),jsEvent.shiftKey||event.employees.forEach(function(e){return e.id.toString()===from_employee.id.toString()?event.employees.remove(e):void 0}),event.resources=event.employees.map(function(e){return e.id.toString()}),Job.reassign({type:event.type,id:event.id,employee_ids:event.resources},function(){return $scope.refresh()})):"note"===event.type?AutoWorkshop.move_note({note:{id:event.id},delta:delta}):Job.move({type:event.type,id:event.id,delta:delta})},$scope.resources=function(){var resources;return resources=lookupService.assignable_employees().map(function(e){return{id:e.id.toString(),name:e.name}}),resources=resources.concat([{id:"unassigned",name:"Unassigned"}])},$scope.show_event_dialog=function(event,jsEvent){return $scope.close_all_action_dialogs(),"note"===event.type?$scope.edit_note(event.note):$timeout(function(){return $scope.hide_event_dialog(),$scope.selected_event=event,popoverService.show_in_position("#event-dialog",jsEvent.clientX,jsEvent.clientY,{placement:"top",fixed_position:!0})})},$scope.hide_event_dialog=function(){return popoverService.hide("#event-dialog")},header=lookupService.session()&&lookupService.session().is_restricted_mechanic?{right:"today basicDay basicWeek month prev,next"}:{right:"today resourceDay basicWeek extended month prev,next"},$scope.calendar_options={year:$routeParams.year||today.getFullYear(),month:$routeParams.month||today.getMonth(),date:$routeParams.date||today.getDate(),height:800,header:header,slotMinutes:lookupService.preference("day_view_slot_minutes")||15,minTime:lookupService.preference("day_view_min_time")||7,maxTime:lookupService.preference("day_view_max_time")||19,contentHeight:1400,firstHour:lookupService.preference("day_view_first_hour")||7,defaultView:lookupService.configurations().default_diary_view||"basicWeek",resources:$scope.resources(),eventStartEditable:!0,editable:!0,dayClick:$scope.new_booking_popover,eventDrop:$scope.move_event,eventResize:$scope.resize_event,eventClick:$scope.show_event_dialog,columnFormat:{week:"ddd d/M",day:"dddd d/M"},dayRender:function(day,element){var content,diary_day;
return $scope.fully_booked(day)&&element.addClass("fully-booked"),$scope.overloaded(day)&&element.addClass("day-overloaded"),content=element.find(".fc-day-content"),$scope.summary_view&&(diary_day=$scope.diary_day(day),diary_day&&(diary_day.total_hours>0||diary_day.total_jobs>0)&&(content.append("<div class='day-jobs'><center>"+diary_day.total_jobs+" Jobs</center></div>"),content.append("<div class='day-work-hours'><center>"+diary_day.total_hours+" Hours</center></div>"),diary_day.workload_percentage&&(content.append("<br/><div class='progress calendar-progress'><div class='bar calendar-progress-bar' style='width: "+diary_day.workload_percentage+"%;'>"+diary_day.workload_percentage+"%</div></div>"),content.append("<div class='day-work-hours-available'><center>"+diary_day.workload_available+" Hours Available</center></div>"))),diary_day&&diary_day.tags&&diary_day.tags.length>0&&(content.append("<hr/>"),diary_day.tags.forEach(function(tag){return content.append("<div style='color: "+tag.color_code+"'><center>"+tag.name+": "+tag.total_hours+" Hours</center></div><br/>")})),diary_day&&diary_day.employees&&diary_day.employees.length>0)?(content.append("<hr/>"),diary_day.employees.forEach(function(employee){return content.append("<div style='color: "+employee.color_code+"'><center>"+employee.name+": "+employee.total_hours+" Hours</center></div><br/>")})):void 0},viewRender:function(){return $scope.view=$scope.bookingCalendar.fullCalendar("getView").name,$scope.adjust_day_view_css(),timeService.timeout(function(){return $scope.$apply()}),"resourceDay"===$scope.view&&$scope.day_view_with_time()?$scope.events.forEach(function(event){return event.allDay=!1}):$scope.events.forEach(function(event){return event.allDay=!0})},eventRender:function(event,element){var address,innerContent;return"note"===event.type&&element.addClass("event-note"),"job"===event.type&&"finished"===event.status?element.addClass("event-finished"):"job"===event.type&&event.on_hold?element.addClass("event-on-hold"):"job"===event.type?element.addClass("event-started"):element.addClass("event-new"),innerContent=element.find(".fc-event-inner"),$scope.use_full_event_view()&&("booking"===event.type&&event.job_id&&innerContent.append("<div class='row-fluid'><div class='pull-right'><span title='Preparing' class='badge badge-success'>P</span></div></div>"),event.customer_title&&innerContent.append("<hr class='thin-hr'><div class='bold'>"+event.customer_title+"</div>")),event.replacement_provided&&innerContent.append("<div class='row-fluid'><div class='pull-right'><span title='Courtesy Vehicle Provided' class='badge badge-info'>R</span></div></div>"),event.deadline_missed&&innerContent.append("<div class='row-fluid'><div class='pull-right'><span title='Deadline missed' class='badge badge-warning'>!</span></div></div>"),event.tags&&event.tags.length>0&&(innerContent.append("<br/>"),event.tags.forEach(function(tag){return"resourceDay"===$scope.view?innerContent.append("<div class='inline' style='background-color: "+tag.color_code+"; vertical-align: top; padding-right: 5px; padding-left: 5px; height: 18px'>"+tag.name+"</div>"):innerContent.append("<div class='inline' title='"+tag.name+"' style='background-color: "+tag.color_code+"; vertical-align: top; padding-right: 5px; width: 18px; height: 18px' />")})),event.employees&&event.employees.each(function(e){return innerContent.append("<span class='label' style='padding: 0px; width: 100%; background-color: "+e.color_code+"'><i class='icon icon-wrench'/>&nbsp;"+e.name+"</span>")}),lookupService.configuration("provide_mobile_service")&&(address=$scope.display_address(event.customer),address&&address.suburb&&innerContent.append("<hr class='thin-hr'><div class='bold'>"+address.suburb+"</div>")),element}},$scope.show_employee_list=function(){return $scope.filtering_started||($scope.employees=lookupService.assignable_employees(),$scope.showing_employees=$scope.employees.map(function(e){return e.id.toString()}),$scope.showing_employees.add("0"),$scope.showing_all_employees=!0,$scope.filtering_started=!0),$scope.showing_employee_list=!0,popoverService.hide(".popover-container"),timeService.timeout(function(){return $scope.bookingCalendar.fullCalendar("render",!1)})},$scope.hide_employee_list=function(){return $scope.showing_employee_list=!1,popoverService.hide(".popover-container"),timeService.timeout(function(){return $scope.bookingCalendar.fullCalendar("render",!1)})},$scope.showing_side_view=function(){return $scope.showing_employee_list||$scope.pinned_notes()&&$scope.pinned_notes().length>0},$scope.pinned_notes=function(){return $scope.notes?$scope.notes.filter(function(note){return!note.start_time}):[]},$scope.day_notes=function(){var day,end_of_day,start_of_day;return $scope.notes&&"resourceDay"===$scope.view?($scope.selected_date=$scope.bookingCalendar.fullCalendar("getView").visStart,day=$scope.selected_date?new Date($scope.selected_date):new Date,start_of_day=moment(day).startOf("day").toDate(),end_of_day=moment(day).endOf("day").toDate(),$scope.notes.filter(function(note){var end_time,later,past,start_time;return note.start_time&&(start_time=moment(new Date(note.start_time)).startOf("day").toDate(),end_time=moment(note.end_time||start_time).endOf("day").toDate()),later=start_time&&start_time>end_of_day,past=end_time&&start_of_day>end_time,start_time&&!later&&!past})):[]},$scope.refresh=function(){return $scope.bookingCalendar.fullCalendar("refetchEvents")},$scope.show_details=function(){return $scope.summary_view=!1,$scope.refresh()},$scope.show_summary=function(){return $scope.summary_view=!0,$scope.refresh()},$scope.show_event=function(event){var showing_employee,showing_event;return $scope.summary_view?!1:(showing_employee=!1,showing_event=!1,event.employees.each(function(e){var string;return string=e.id.toString(),$scope.showing_employees.each(function(id){return id===string?showing_employee=!0:void 0})}),$scope.show_unassigned()&&event.employees.isEmpty()&&(showing_employee=!0),$scope.showing_employee_list||(showing_employee=!0),$scope.showing_events.each(function(event_type){return"booked"===event_type&&"booking"===event.type&&(showing_event=!0),"started"!==event_type||"job"!==event.type||"finished"===event.status||event.on_hold||(showing_event=!0),"finished"===event_type&&"job"===event.type&&"finished"===event.status&&(showing_event=!0),"on_hold"===event_type&&"job"===event.type&&event.on_hold?showing_event=!0:void 0}),showing_employee&&showing_event)},$scope.show_unassigned=function(){return $scope.showing_employees.find(function(e){return"0"===e})},$scope.edit_booking=function(booking){return $window.open("#/bookings/"+booking.id+"/edit?"+$.param(formService.params({bookingView:$scope.view,year:$scope.date.getFullYear(),month:$scope.date.getMonth(),date:$scope.date.getDate()})),"_self")},$scope.create_note=function(){return $scope.editing_note={content:""},$scope.editing_note.start_time=$scope.selected_date||new Date,$scope.open_editing_note_dialog()},$scope.open_editing_note_dialog=function(){return popoverService.show("#editing-note","#editing-note-button",{placement:"left"}),formService.select_text("#editing-note-content"),$scope.close_actions()},$scope.cancel_editing_note=function(){return $scope.editing_note=void 0,popoverService.hide("#editing-note")},$scope.save_note=function(note){return note.id?AutoWorkshop.update_note({note:note},function(data){return angular.copy(data,note),$scope.refresh(),popoverService.hide("#editing-note")}):AutoWorkshop.create_note({note:note},function(data){return $scope.notes.push(data),$scope.refresh(),popoverService.hide("#editing-note")})},$scope.delete_note=function(note){return confirmationService.confirm("Delete this note?",!0,function(){return AutoWorkshop.destroy_note({note:note},function(){return $scope.notes.remove(note),popoverService.hide("#editing-note"),$scope.refresh()})})},$scope.edit_note=function(note){return formService.edit_fields(note,"editing","id","content","start_time","end_time","office_only"),$scope.editing_note=note.editing,$scope.open_editing_note_dialog()},$scope.bookings_and_jobs=function(){return $scope.events.filter(function(e){return"note"!==e.type})},$scope.delete_booking=function(){return $scope.deleted_reason=void 0,$scope.showing_delete_booking_dialog=!0},$scope.do_delete_booking=function(){var deleted_booking;return deleted_booking=new Booking($scope.selected_event),Booking["delete"]({id:$scope.selected_event.id,deleted_reason:$scope.deleted_reason},function(){return $scope.showing_delete_booking_dialog=!1,$scope.hide_event_dialog(),$scope.refresh()})},$scope.put_on_hold=function(){return $scope.putting_on_hold=!0},$scope["continue"]=function(){return Job["continue"]({id:$scope.selected_event.id},function(){return $scope.selected_event.on_hold=!1,$scope.rerender()})},$scope.send_sms=function(){return $scope.sending_sms=!0},$scope.send_email=function(){return $scope.sending_email=!0},$scope.tag=function(){return"booking"===$scope.selected_event.type?$scope.tagging_booking=!0:"job"===$scope.selected_event.type?$scope.tagging_job=!0:void 0},$scope.assign=function(){return $scope.assigning_job=!0},$scope.adjust_time=function(){return $scope.adjusting_job_time=!0},$scope.time_adjusted=function(){return $scope.build_event($scope.selected_event),$scope.rerender()},$scope.build_event=function(event){var description,title;return event.resources=event.employees.length>0?event.employees.map(function(e){return e.id.toString()}):["unassigned"],event.priority="2",event.color=void 0,event.event_id=""+event.type+"-"+event.id,title=dateFilter(event.start,"shortTime"),event.end&&(title+=" - "+dateFilter(event.end,"shortTime"),dateFilter(event.end,"shortDate")!==dateFilter(event.start,"shortDate")&&(title+=" ("+dateFilter(event.end,"dd/MM")+")")),event.vehicle_title&&(title=""+title+"\n"+event.vehicle_title),description="",event.job_number&&(description="#"+event.job_number+" "),event.full_description&&event.full_description.length>0&&(description=""+description+event.full_description),description.length>0&&(title=""+title+"\n"+description),event.title=title,event.allDay="resourceDay"===$scope.view&&$scope.day_view_with_time()?!1:!0},$scope.use_full_event_view=function(){return"simple"!==$scope.eventView&&!lookupService.preference("diary_use_simple_view")},lookupService.auto_refresh_diary()&&$scope.auto_refresh(!0),$scope.events=[{events:function(start,end,callback){var options;return $scope.date=start,spinnerService.start_spinner("#calendar-spinner"),options={start:start,end:end},$scope.summary_view&&(options.summary=!0),AutoWorkshop.diary(options,function(data){var event,item,list,_fn,_i,_j,_len,_len1,_ref;for(spinnerService.stop_spinner("#calendar-spinner"),$scope.diary=data,$scope.days=data.all_days,$scope.events=[],$scope.notes=data.notes,list=data.bookings.concat(data.jobs),_ref=$scope.notes,_i=0,_len=_ref.length;_len>_i;_i++)item=_ref[_i],item.start_time&&(event={note:item,id:item.id,title:item.content,start:item.start,end:item.end,type:"note",priority:"1",allDay:!0},$scope.events.push(event));for(_fn=function(){return event={},angular.copy(item,event),$scope.build_event(event),$scope.show_event(event)?$scope.events.push(event):void 0},_j=0,_len1=list.length;_len1>_j;_j++)item=list[_j],_fn();return timeService.timeout(function(){return $scope.bookingCalendar.fullCalendar("render",!1),callback($scope.events)})})}}]}}})}.call(this),function(){this.AutoWorkshopApp.directive("adSelectInvoiceTemplate",function(){return{restrict:"AE",restrict:"AE",require:"ngModel,showing,title",scope:{workshop:"=ngModel",templates:"=",showing:"=",title:"@",anchorElement:"@"},templateUrl:template("directives/ad_select_invoice_template"),controller:function($scope,formService,popoverService,spinnerService,AutoWorkshop){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.payment={},$scope.show=function(){return $scope.template_index=$scope.templates.findIndex(function(template){return template.id===$scope.workshop.invoice_template}),popoverService.show("#select-invoice-template",$scope.anchorElement),document.getElementById("preview").src="/assets/invoices/"+$scope.template().id+".pdf"},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#select-invoice-template")},$scope.select=function(){return AutoWorkshop.update({id:$scope.workshop.id,invoice_template:$scope.template().id},function(data){return $scope.workshop.invoice_template=data.invoice_template,$scope.hide()})},$scope.next=function(){return $scope.template_index===$scope.templates.length-1?$scope.template_index=0:$scope.template_index+=1,document.getElementById("preview").src="/assets/invoices/"+$scope.template().id+".pdf"},$scope.previous=function(){return 0===$scope.template_index?$scope.template_index=$scope.templates.length-1:$scope.template_index-=1,document.getElementById("preview").src="/assets/invoices/"+$scope.template().id+".pdf"},$scope.template=function(){return $scope.templates[$scope.template_index]},$scope["default"]=function(){return $scope.workshop.invoice_template}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adSendEmail",function(){return{restrict:"AE",restrict:"AE",require:"showing",scope:{vehicle:"=",job:"=",showing:"=",anchorElement:"=",placement:"@",customer:"="},templateUrl:template("directives/ad_send_email"),controller:function($scope,formService,popoverService,spinnerService,Email){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.email={customer_id:$scope.customer.id,to:$scope.customer.email,subject:"",message:""},popoverService.show("#send-email",$scope.anchorElement,{placement:$scope.placement,fixed_position:!0})},$scope.hide=function(){return popoverService.hide("#send-email"),$scope.showing=!1},$scope.email_select_contact=function(contacts){var emails;return emails=contacts.map(function(c){return c.email}),emails&&emails.length>0?$scope.email.to=emails.join(";"):void 0},$scope.send=function(){var attached_files;return spinnerService.start_spinner("#send-email-spinner"),attached_files=[],$scope.customer&&($scope.customer.documents&&(attached_files=attached_files.concat($scope.customer.documents.findAll(function(d){return d.attached}))),$scope.customer.photos&&(attached_files=attached_files.concat($scope.customer.photos.findAll(function(d){return d.attached})))),$scope.job&&($scope.job.documents&&(attached_files=attached_files.concat($scope.job.documents.findAll(function(d){return d.attached}))),$scope.job.photos&&(attached_files=attached_files.concat($scope.job.photos.findAll(function(d){return d.attached})))),attached_files=attached_files.map(function(f){return f.id}),Email.send_to_customer($scope.email,{attachments:attached_files},function(){return spinnerService.stop_spinner("#send-email-spinner"),$scope.hide()})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adSendSms",function(){return{restrict:"AE",restrict:"AE",require:"ngModel,showing",scope:{job:"=ngModel",vehicle:"=",showing:"=",anchorElement:"=",placement:"@",customer:"="},templateUrl:template("directives/ad_send_sms"),controller:function($scope,formService,popoverService,spinnerService,Sms){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.sms={customer_id:$scope.customer.id,to:$scope.customer.mobile,subject:"",message:""},popoverService.show("#send-sms",$scope.anchorElement,{placement:$scope.placement,fixed_position:!0})},$scope.hide=function(){return popoverService.hide("#send-sms"),$scope.showing=!1},$scope.send=function(){return spinnerService.start_spinner("#send-sms-spinner"),Sms.send_to_customer($scope.sms,function(){return spinnerService.stop_spinner("#send-sms-spinner"),$scope.hide()})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adServiceSchedule",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{service_schedule:"=ngModel",customer:"=",vehicle:"="},templateUrl:template("directives/ad_service_schedule"),controller:function($scope,$location,formService,lookupService,Vehicle,ServiceSchedule,Customer){return $scope.vehicle_detail_tab="service_reminder",$scope.update_service_schedule=function(){return ServiceSchedule.update($scope.service_schedule,function(data){return angular.copy(data,$scope.service_schedule)})},$scope.back_to_service_schedule=function(){return $scope.showing_customer=void 0},$scope.show_customer=function(){return $scope.showing_customer=!0,Customer.get({id:$scope.customer.id},function(data){return angular.copy(data,$scope.customer)})},$scope.disable_service_schedule=function(){return $scope.service_schedule.enable=!1,$scope.update_service_schedule()},$scope.enable_service_schedule=function(){return $scope.service_schedule.enable=!0,$scope.update_service_schedule()},$scope.goto_vehicle=function(vehicle){return $location.path("/customers/"+$scope.customer.id+"/vehicles/"+vehicle.id)},$scope.edit_reminder_date=function(){return formService.edit_fields($scope.service_schedule,"editing_reminder_date","id","reminder_date")},$scope.save_reminder_date=function(){return ServiceSchedule.update($scope.service_schedule.editing_reminder_date,function(data){return angular.copy(data,$scope.service_schedule)})},$scope.cancel_edit_reminder_date=function(){return formService.cancel($scope.service_schedule,"editing_reminder_date")},$scope.edit_next_service_date=function(){return formService.edit_fields($scope.service_schedule,"editing_next_service_date","id","next_service_date")},$scope.save_next_service_date=function(){return ServiceSchedule.update($scope.service_schedule.editing_next_service_date,function(data){return angular.copy(data,$scope.service_schedule)})},$scope.cancel_edit_next_service_date=function(){return formService.cancel($scope.service_schedule,"editing_next_service_date")},$scope.edit_last_service_date=function(){return formService.edit_fields($scope.service_schedule,"editing_last_service_date","id","last_service_date")},$scope.save_last_service_date=function(){return ServiceSchedule.update($scope.service_schedule.editing_last_service_date,function(data){return angular.copy(data,$scope.service_schedule)})},$scope.cancel_edit_last_service_date=function(){return formService.cancel($scope.service_schedule,"editing_last_service_date")},$scope.edit_wof_date=function(){return formService.edit_fields($scope.service_schedule,"editing_wof_date","id","wof_date")},$scope.save_wof_date=function(){return ServiceSchedule.update($scope.service_schedule.editing_wof_date,function(data){return angular.copy(data,$scope.service_schedule)})},$scope.cancel_edit_wof_date=function(){return formService.cancel($scope.service_schedule,"editing_wof_date")},$scope.country=function(){return lookupService.configurations()?lookupService.configurations().country:void 0},$scope.no_wof=function(){return lookupService.configurations()?lookupService.configurations().no_wof:void 0},$scope.wof_name=function(){return lookupService.configurations()?lookupService.wof_name():void 0},$scope.show_vehicle_detail_tab=function(tab){return $scope.vehicle_detail_tab=tab,"vehicle"===tab?Vehicle.get({id:$scope.service_schedule.vehicle.id},function(data){return angular.copy(data,$scope.service_schedule.vehicle)}):void 0},$scope.edit_registration_due_date=function(){return formService.edit_fields($scope.service_schedule,"editing_registration_due_date","id","registration_due_date")},$scope.save_registration_due_date=function(){return ServiceSchedule.update($scope.service_schedule.editing_registration_due_date,function(data){return angular.copy(data,$scope.service_schedule)})},$scope.cancel_edit_registration_due_date=function(){return formService.cancel($scope.service_schedule,"editing_registration_due_date")}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adServiceScheduleList",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{service_schedules:"=ngModel",selected_service_schedule_ids:"=selectedServiceScheduleIds",service_type:"@serviceType"},templateUrl:template("directives/ad_service_schedule_list"),controller:function($scope,popoverService,lookupService){return $scope.service_type||($scope.service_type="service"),$scope.show_send_service_reminder_popover=function(){return 0===$scope.selected_service_schedule_ids.length?alert("Please make at least one selection"):$scope.showing_service_reminder_dialog=!0},$scope.show_service_schedule=function(service_schedule,$event){return $scope.showing_service_schedule=service_schedule,popoverService.show("#service-schedule-popover",$event.target,{placement:"bottom"})},$scope.service_schedule_status=function(service_schedule){return service_schedule?service_schedule.servicing?"Servicing":service_schedule.booked?service_schedule.reminder_status:service_schedule.enable?service_schedule.reminder_status:"Disable":void 0},$scope.service_schedule_active=function(service_schedule){var enable;if(service_schedule)return enable=service_schedule.enable&&!service_schedule.servicing},$scope.postal_only=function(service_schedule){return!(service_schedule.enable_sms&&service_schedule.contact_mobile||service_schedule.enable_email&&service_schedule.contact_email||!service_schedule.enable_postal_mail)},$scope.close_popup=function(){return $scope.showing_customer=void 0,popoverService.hide("#service-schedule-popover")},$scope.toggle_select_all=function(){return $scope.all_selected?($scope.selected_service_schedule_ids=[],$scope.all_selected=!1):($scope.all_selected=!0,$scope.selected_service_schedule_ids=$scope.selectables().map(function(s){return s.id.toString()}))},$scope.selectables=function(){return $scope.service_schedules?$scope.service_schedules.findAll(function(s){return $scope.service_schedule_active(s)}):void 0},$scope.asset_name=function(){return lookupService.asset_name()},$scope.asset_name_plural=function(){return lookupService.asset_name_plural()},$scope.wof_name=lookupService.wof_name()}}})}.call(this),function(){this.AutoWorkshopApp.directive("adSpWorkshopFinder",function(){return{restrict:"AE",scope:{auto_workshop:"=autoWorkshop",search_result:"=searchResult",current_auto_workshop:"=currentAutoWorkshop",error:"=",get_auto_workshop:"&",show_adv_search:"=showAdvSearch"},templateUrl:template("directives/ad_sp_workshop_finder"),controller:function($scope,$window,$cookies,spinnerService,SupportPortal){return $scope.get_time_difference=function(time_zone){var time_table;return time_table={Melbourne:0,Perth:-2,Auckland:2,Wellington:2,"Abu Dhabi":-6,Ghana:-10,Nairobi:-7,"La Paz":-14,"West Central Africa":-9,"Hong Kong":-2,Singapore:-2,London:-10,"Pacific Time (US & Canada)":-17,Pretoria:-8},$scope.auto_workshop.time_difference=time_table[time_zone]},$scope.go_to_auto_workshop=function(){return $window.open("https://mechanicdesk.com.au/auto_workshop/login?auto_workshop_id="+$scope.current_auto_workshop.id+"&username="+$cookies.username)},$scope.clear_auto_workshop=function(){return $scope.auto_workshop={id:null,name:null,phone:null,email:null},$scope.current_auto_workshop={},$scope.search_term="search term"},$scope.copy_data=function(data){return angular.copy(data.auto_workshop,$scope.auto_workshop),Object.assign($scope.auto_workshop,data.meta),$scope.current_auto_workshop.id=data.auto_workshop.id,$scope.get_time_difference($scope.auto_workshop.time_zone),$window.localStorage.setItem("selected_workshop_id",data.auto_workshop.id)},$scope.get_auto_workshop=function(id){return spinnerService.start_spinner("#support-spinner"),id&&($scope.auto_workshop.id=id),SupportPortal.get({id:$scope.auto_workshop.id},function(data){return data.error||$scope.copy_data(data),data.error&&($scope.error.message=data.error),$scope.search_result=[],spinnerService.stop_spinner("#support-spinner")})},$scope.show_follow_up=function(){return spinnerService.start_spinner("#support-spinner"),SupportPortal.show_report({type:"follow_up"},function(data){return $scope.auto_workshop.follow_up_workshops=data.result,data.error&&($scope.error.message=data.error),spinnerService.stop_spinner("#support-spinner")})},$scope.show_owing=function(){return spinnerService.start_spinner("#support-spinner"),SupportPortal.show_report({type:"owing"},function(data){return $scope.auto_workshop.owing_workshops=data.result,data.error&&($scope.error.message=data.error),spinnerService.stop_spinner("#support-spinner")})},$scope.adv_get_auto_workshop=function(){return spinnerService.start_spinner("#support-spinner"),SupportPortal.adv_get({search_term:$scope.search_term},function(data){return data.error||($scope.search_result=data),data.error&&($scope.error.message=data.error),spinnerService.stop_spinner("#support-spinner")})},$scope.toggle_help_dialogue=function(){return $scope.show_help_dialogue=$scope.show_help_dialogue?!1:!0},$scope.$on("getWorkshopChannel",function(event,data){return $scope.get_auto_workshop(data.id)}),$scope.show_help_dialogue=!1}}})}.call(this),function(){this.AutoWorkshopApp.directive("adStock",function(){return{restrict:"AE",restrict:"AE",scope:{stock:"=ngModel",onSave:"&"},templateUrl:template("directives/ad_stock"),controller:function($scope,lookupService,calculatorService,Stock,formService){return $scope.edit_stock=function(){return lookupService.session()&&lookupService.session().restrictions.any("update_inventory")?alert("Your account do not have permission to update stock inventory"):($scope.editing_stock_info=!0,$scope.start_editing())},$scope.start_editing=function(){return $scope.auto_calculate_sell_prices=!1,formService.edit_fields($scope.stock,"editing"),delete $scope.stock.editing.quantity,$scope.stock.editing.with_gst={},$scope.prices_include_gst()?void 0:["buy_price","custom_and_duty","price","price2","price3","price4","price5","price6","price7"].forEach(function(x){return $scope.price_with_gst(x)})},$scope.cancel_edit_stock=function(){return $scope.editing_stock_info=!1,$scope.stock.editing=!1},$scope.save_stock=function(){return Stock.update($scope.stock.editing,function(data){return angular.copy(data,$scope.stock.editing),!data.errors&&(lookupService.fetch_invoice_items(),angular.copy(data,$scope.stock),$scope.stock.editing=void 0,$scope.editing_stock_info=!1,$scope.onSave)?$scope.onSave():void 0})},$scope.price_with_gst=function(attribute){return $scope.stock.editing[attribute]?$scope.stock.editing.with_gst[attribute]=($scope.stock.editing[attribute]*(1+$scope.tax_rate())).round(2):void 0},$scope.price_without_gst=function(attribute){return $scope.stock.editing.with_gst[attribute]?$scope.stock.editing[attribute]=($scope.stock.editing.with_gst[attribute]/(1+$scope.tax_rate())).round(4):void 0},$scope.tax_name=function(){return lookupService.tax_name()},$scope.tax_rate=function(){return lookupService.configurations().tax_rate},$scope.configurations=function(){return lookupService.configurations()},$scope.price_groups=function(){return lookupService.price_groups()},$scope.markup_percentages=function(){var configurations,markup_percentages,price_group;return configurations=lookupService.configurations(),$scope.stock.editing.price_group_id&&(price_group=lookupService.price_groups().find(function(p){return p.id===$scope.stock.editing.price_group_id}),markup_percentages={markup_percentage:price_group.markup_percentage,markup_percentage2:price_group.markup_percentage2,markup_percentage3:price_group.markup_percentage3,markup_percentage4:price_group.markup_percentage4,markup_percentage5:price_group.markup_percentage5,markup_percentage6:price_group.markup_percentage6,markup_percentage7:price_group.markup_percentage7}),!markup_percentages&&configurations&&(markup_percentages={markup_percentage:configurations.buyin_markup_percentage,markup_percentage2:configurations.buyin_markup_percentage2,markup_percentage3:configurations.buyin_markup_percentage3,markup_percentage4:configurations.buyin_markup_percentage4,markup_percentage5:configurations.buyin_markup_percentage5,markup_percentage6:configurations.buyin_markup_percentage6,markup_percentage7:configurations.buyin_markup_percentage7}),markup_percentages},$scope.new_sell_price=function(buy_price,current_price,markup_percentage){var new_price;return buy_price&&markup_percentage&&markup_percentage>0&&(new_price=(buy_price*(1+markup_percentage/100)).round(4)),!current_price||new_price&&new_price>0?new_price:current_price},$scope.automatic_price_update=function(){return lookupService.configurations()&&lookupService.configurations().automatic_price_update},$scope.calculate_sell_prices=function(){var markup_percentages,stock;if($scope.stock&&$scope.stock.editing)return stock=$scope.stock.editing,markup_percentages=$scope.markup_percentages(),$scope.stock&&$scope.stock.editing&&$scope.auto_calculate_sell_prices&&($scope.automatic_price_update()||$scope.stock.editing.price_group_id)?(stock.price=$scope.new_sell_price(stock.buy_price,$scope.stock.price,markup_percentages.markup_percentage),$scope.price_with_gst("price"),stock.price2=$scope.new_sell_price(stock.buy_price,$scope.stock.price2,markup_percentages.markup_percentage2),$scope.price_with_gst("price2"),stock.price3=$scope.new_sell_price(stock.buy_price,$scope.stock.price3,markup_percentages.markup_percentage3),$scope.price_with_gst("price3"),stock.price4=$scope.new_sell_price(stock.buy_price,$scope.stock.price4,markup_percentages.markup_percentage4),$scope.price_with_gst("price4"),stock.price5=$scope.new_sell_price(stock.buy_price,$scope.stock.price5,markup_percentages.markup_percentage5),$scope.price_with_gst("price5"),stock.price6=$scope.new_sell_price(stock.buy_price,$scope.stock.price6,markup_percentages.markup_percentage6),$scope.price_with_gst("price6"),stock.price7=$scope.new_sell_price(stock.buy_price,$scope.stock.price7,markup_percentages.markup_percentage7),$scope.price_with_gst("price7")):void 0},$scope.calculate_margin=function(buy,sell){return calculatorService.calculate_margin(buy,sell)},$scope.show_margin=function(){return lookupService.preference("show_stock_price_margin")},$scope.$watch("stock.editing.buy_price",function(){return $scope.calculate_sell_prices()}),$scope.prices_include_gst=function(){return lookupService.configurations().prices_include_gst},$scope.stock_categories=lookupService.stock_categories()}}})}.call(this),function(){this.AutoWorkshopApp.directive("adStockCategorySelection",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{stock_category_id:"=ngModel",disable_new:"=disableNew",options:"="},templateUrl:template("directives/ad_stock_category_selection"),controller:function($scope,lookupService,popoverService,formService,StockCategory){return $scope.stock_category={},$scope.stock_categories=lookupService.stock_categories(),$scope.create_stock_category_id=Math.floor(1e10*Math.random()+1),$scope.create_stock_category_button_id=Math.floor(1e10*Math.random()+1),$scope.new_stock_category_name_input_id=Math.floor(1e10*Math.random()+1),$scope.new_stock_category=function(){return popoverService.show("#"+$scope.create_stock_category_id,"#"+$scope.create_stock_category_button_id,{placement:"bottom"}),formService.select_text("#"+$scope.new_stock_category_name_input_id)},$scope.save_stock_category=function(){return $scope.stock_category.name?StockCategory.save($scope.stock_category,function(data){return lookupService.stock_categories().push(data),$scope.stock_category_id=data.id,popoverService.hide("#"+$scope.create_stock_category_id)}):void 0},$scope.cancel_new_stock_category=function(){return popoverService.hide("#"+$scope.create_stock_category_id)}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adStockForm",function(){return{restrict:"AE",restrict:"AE",scope:{stock:"=ngModel"},templateUrl:template("directives/ad_stock_form"),controller:function($scope,lookupService,calculatorService){return $scope.tax_rate=function(){return lookupService.configurations().tax_rate},$scope.configurations=function(){return lookupService.configurations()},$scope.tax_name=function(){return lookupService.tax_name()},$scope.create_new_category=function(){return $scope.show_popover("#new-category","#new-category-button",{placement:"bottom"})},$scope.price_with_gst=function(attribute){var _base;return $scope.stock[attribute]?((_base=$scope.stock).with_gst||(_base.with_gst={}),$scope.stock.with_gst[attribute]=($scope.stock[attribute]*(1+$scope.tax_rate())).round(2)):void 0},$scope.price_without_gst=function(attribute){var _base;return(_base=$scope.stock).with_gst||(_base.with_gst={}),$scope.stock.with_gst[attribute]?$scope.stock[attribute]=($scope.stock.with_gst[attribute]/(1+$scope.tax_rate())).round(4):void 0},$scope.prices_include_gst=function(){return lookupService.configurations().prices_include_gst},$scope.input_accounts=function(){return lookupService.input_accounts()
},$scope.output_accounts=function(){return lookupService.output_accounts()},$scope.inventory_accounts=function(){return lookupService.inventory_accounts()},$scope.price_groups=function(){return lookupService.price_groups()},$scope.calculate_margin=function(buy,sell){return calculatorService.calculate_margin(buy,sell)},$scope.show_margin=function(){return lookupService.preference("show_stock_price_margin")},$scope.automatic_price_update=function(){return lookupService.configurations()&&lookupService.configurations().automatic_price_update},$scope.markup_percentages=function(){var configurations,markup_percentages,price_group;return configurations=lookupService.configurations(),$scope.stock.price_group_id&&(price_group=lookupService.price_groups().find(function(p){return p.id===$scope.stock.price_group_id}),markup_percentages={markup_percentage:price_group.markup_percentage,markup_percentage2:price_group.markup_percentage2,markup_percentage3:price_group.markup_percentage3,markup_percentage4:price_group.markup_percentage4,markup_percentage5:price_group.markup_percentage5,markup_percentage6:price_group.markup_percentage6,markup_percentage7:price_group.markup_percentage7}),!markup_percentages&&configurations&&(markup_percentages={markup_percentage:configurations.buyin_markup_percentage,markup_percentage2:configurations.buyin_markup_percentage2,markup_percentage3:configurations.buyin_markup_percentage3,markup_percentage4:configurations.buyin_markup_percentage4,markup_percentage5:configurations.buyin_markup_percentage5,markup_percentage6:configurations.buyin_markup_percentage6,markup_percentage7:configurations.buyin_markup_percentage7}),markup_percentages},$scope.stock_categories=lookupService.stock_categories(),$scope.accounting_accounts=lookupService.accounting_accounts(),$scope.$watch("stock.buy_price",function(){var markup_percentages,stock;return $scope.stock&&($scope.automatic_price_update()||$scope.stock.price_group_id)?(stock=$scope.stock,markup_percentages=$scope.markup_percentages(),stock.price=$scope.new_sell_price(stock.buy_price,0,markup_percentages.markup_percentage),$scope.price_with_gst("price"),stock.price2=$scope.new_sell_price(stock.buy_price,0,markup_percentages.markup_percentage2),$scope.price_with_gst("price2"),stock.price3=$scope.new_sell_price(stock.buy_price,0,markup_percentages.markup_percentage3),$scope.price_with_gst("price3"),stock.price4=$scope.new_sell_price(stock.buy_price,0,markup_percentages.markup_percentage4),$scope.price_with_gst("price4"),stock.price5=$scope.new_sell_price(stock.buy_price,0,markup_percentages.markup_percentage5),$scope.price_with_gst("price5"),stock.price6=$scope.new_sell_price(stock.buy_price,0,markup_percentages.markup_percentage6),$scope.price_with_gst("price6"),stock.price7=$scope.new_sell_price(stock.buy_price,0,markup_percentages.markup_percentage7),$scope.price_with_gst("price7")):void 0}),$scope.new_sell_price=function(buy_price,current_price,markup_percentage){var new_price;return buy_price&&markup_percentage&&markup_percentage>0&&(new_price=(buy_price*(1+markup_percentage/100)).round(4)),!current_price||new_price&&new_price>current_price?new_price:current_price}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adStockInfo",function(){return{restrict:"AE",restrict:"AE",templateUrl:template("directives/ad_stock_info"),controller:function($scope,lookupService,Stock,stockInfoService){return $scope.stock=stockInfoService.stock(),$scope.hide=function(){return stockInfoService.hide()}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adStockNumberWarning",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{stock:"=ngModel",message:"@"},templateUrl:template("directives/ad_stock_number_warning"),controller:function($scope,lookupService,$timeout,Stock){return $scope.$watch("stock.stock_number",function(){return $scope.stock&&$scope.stock.stock_number?($scope.lookup&&$timeout.cancel($scope.lookup),$scope.lookup=$timeout($scope.search,500)):void 0}),$scope.search=function(){return $scope.matches=[],Stock.find_by_stock_number({stock_number:$scope.stock.stock_number},function(data){return $scope.matches=data}),null},$scope.$on("$destroy",function(){return $timeout.cancel($scope.lookup)})}}})}.call(this),function(){this.AutoWorkshopApp.directive("adStockpicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{item:"=ngModel",onSelect:"&",input_id:"@inputId"},templateUrl:template("directives/ad_stockpicker"),controller:function($scope,lookupService,Stock){return $scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.lookup=function(term){return lookupService.lookup_stocks(term,"#lookup-stock-spinner-"+$scope.spinner_id,"#lookup-stock-icon-"+$scope.spinner_id)},$scope.select=function(stock,model,label,item){return item.stock_id=stock.stock_id,Stock.get({id:stock.stock_id},function(data){return item.quantity=data.quantity,item.allocated_quantity=data.allocated_quantity}),$scope.onSelect?$scope.onSelect():void 0},$scope.input_id&&0!==$scope.input_id.length?void 0:$scope.input_id="stockpicker-input"}}})}.call(this),function(){this.AutoWorkshopApp.directive("adSupplierForm",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{supplier:"=ngModel",onSave:"&",onCancel:"&"},templateUrl:template("directives/ad_supplier_form"),controller:function($scope,lookupService,spinnerService,Supplier){return $scope.payment_terms=lookupService.payment_terms(),$scope.cancel=function(){return $scope.onCancel?$scope.onCancel():void 0},$scope.country=function(){return lookupService.configurations()?lookupService.configurations().country:void 0},$scope.add_street_address=function(){return $scope.supplier.street_address={}},$scope.save=function(){return $scope.do_save(function(data){return angular.copy(data,$scope.supplier),$scope.onSave?$scope.onSave(data):void 0})},$scope.show_more_supplier_fields=function(){return $scope.showing_more_supplier_fields=!0},$scope.do_save=function(callback){return $scope.supplier&&$scope.supplier.name?(spinnerService.start_spinner("#create-supplier-spinner"),$scope.supplier.id?Supplier.update($scope.supplier,function(data){return spinnerService.stop_spinner("#create-supplier-spinner"),lookupService.fetch_creditors(),callback(data)}):Supplier.save($scope.supplier,function(data){return spinnerService.stop_spinner("#create-supplier-spinner"),lookupService.fetch_creditors(),callback(data)})):$scope.cancel()}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adSupplierTransactionHistory",function(){return{restrict:"AE",restrict:"AE",scope:{supplier:"="},templateUrl:template("directives/ad_supplier_transaction_history"),controller:function($scope,$window,spinnerService,Supplier){return $scope.show_unpaid_only=!0,$scope.original_supplier={},$scope.$watch("supplier",function(){return $scope.supplier&&$scope.supplier.id?$scope.fetch_supplier_history(1):void 0}),$scope.fetch_supplier_history=function(page){var options;if($scope.supplier&&$scope.supplier.id)return options={id:$scope.supplier.id,page:page},$scope.original_supplier&&$scope.original_supplier.id&&(options.supplier_id=$scope.original_supplier.id),$scope.date&&(options.date=$scope.date),$scope.show_unpaid_only&&(options.unpaid_only=!0),spinnerService.start_spinner("#supplier-transaction-history-spinner"),Supplier.transactions(options,function(data){return spinnerService.stop_spinner("#supplier-transaction-history-spinner"),$scope.credit_balance=data.meta.credit_balance,$scope.balance=data.meta.balance,$scope.bill_balance=data.meta.bill_balance,$scope.total_pages=data.meta.total_pages,$scope.current_page=data.meta.page,$scope.transactions=data.transactions})},$scope.get_transaction_page=function(page){return $scope.fetch_supplier_history(page)},$scope.reset_original_supplier=function(){return $scope.original_supplier={}},$scope.select=function(transaction){return"bill"===transaction.type?$window.open("#/bills/"+transaction.id):"credit note"===transaction.type?$window.open("#/supplier_credit_notes/"+transaction.id):void 0},$scope.preview=function(transaction){return $scope.previewed_bill=transaction},$scope.$watch("original_supplier.id",function(){return $scope.fetch_supplier_history(1)}),$scope.$watch("date",function(){return $scope.fetch_supplier_history(1)})}}})}.call(this),function(){this.AutoWorkshopApp.directive("adTagIcons",function(){return{restrict:"AE",restrict:"AE",scope:{owner:"=",resource:"@",view:"@"},templateUrl:template("directives/ad_tag_icons"),controller:function(){}}})}.call(this),function(){this.AutoWorkshopApp.directive("adTagLabels",function(){return{restrict:"AE",restrict:"AE",scope:{owner:"=",resource:"@",view:"@"},templateUrl:template("directives/ad_tag_labels"),controller:function(){}}})}.call(this),function(){this.AutoWorkshopApp.directive("adTags",function(){return{restrict:"AE",restrict:"AE",scope:{owner:"=",resource:"@",showing:"=",anchorElement:"=",placement:"@",onSuccess:"&"},templateUrl:template("directives/ad_tags"),controller:function($scope,popoverService,lookupService,spinnerService,Invoice,Bill,Job,Customer,Quote,Supplier,Purchase,Stock,Booking,CreditNote){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.new_tag={color_code:"#000"},$scope.tag_popover_id=Math.floor(1e10*Math.random()+1),$scope.show=function(){return popoverService.show("#"+$scope.tag_popover_id,$scope.anchorElement,{placement:$scope.placement,fixed_position:!0})},$scope.has_tag=function(tag){return $scope.owner&&$scope.owner.tags?$scope.owner.tags.find(function(t){return t.name===tag.name}):void 0},$scope.toggle_selection=function(tag){return $scope.has_tag(tag)?$scope.remove_tag(tag):$scope.add_tag(tag)},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#"+$scope.tag_popover_id)},$scope.add_tag=function(tag,close){var _base;return null==close&&(close=!0),spinnerService.start_spinner("#ad-tags-spinner"),"Invoice"===$scope.resource?Invoice.add_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Bill"===$scope.resource?Bill.add_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Job"===$scope.resource?Job.add_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Customer"===$scope.resource?Customer.add_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Quote"===$scope.resource?Quote.add_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Supplier"===$scope.resource?Supplier.add_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Purchase"===$scope.resource?Purchase.add_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Stock"===$scope.resource?Stock.add_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Booking"===$scope.resource?Booking.add_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"CreditNote"===$scope.resource?CreditNote.add_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):(spinnerService.stop_spinner("#ad-tags-spinner"),(_base=$scope.owner).tags||(_base.tags=[]),$scope.owner.tags.push(tag),close&&$scope.hide(),tag===$scope.new_tag?$scope.new_tag={color_code:"#000"}:void 0)},$scope.tags=function(){var owner_tags,tags;return tags=[],owner_tags=$scope.owner?$scope.owner.tags||[]:[],tags=$scope.resource?lookupService.tags_of_type($scope.resource):lookupService.tags_of_type("Job","Booking"),tags.concat(owner_tags).unique(function(t){return t.name})},$scope.switch_tag=function(tag,close){return null==close&&(close=!0),spinnerService.start_spinner("#ad-tags-spinner"),"Invoice"===$scope.resource?Invoice.switch_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Bill"===$scope.resource?Bill.switch_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Job"===$scope.resource?Job.switch_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Customer"===$scope.resource?Customer.switch_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Quote"===$scope.resource?Quote.switch_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Supplier"===$scope.resource?Supplier.switch_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Purchase"===$scope.resource?Purchase.switch_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Stock"===$scope.resource?Stock.switch_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Booking"===$scope.resource?Booking.switch_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"CreditNote"===$scope.resource?CreditNote.switch_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):(spinnerService.stop_spinner("#ad-tags-spinner"),$scope.owner.tags=[],$scope.owner.tags.push(tag),close&&$scope.hide(),tag===$scope.new_tag?$scope.new_tag={color_code:"#000"}:void 0)},$scope.remove_tag=function(tag,close){return null==close&&(close=!0),spinnerService.start_spinner("#ad-tags-spinner"),"Invoice"===$scope.resource?Invoice.remove_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Bill"===$scope.resource?Bill.remove_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Job"===$scope.resource?Job.remove_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Customer"===$scope.resource?Customer.remove_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Quote"===$scope.resource?Quote.remove_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Supplier"===$scope.resource?Supplier.remove_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Purchase"===$scope.resource?Purchase.remove_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Stock"===$scope.resource?Stock.remove_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"Booking"===$scope.resource?Booking.remove_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):"CreditNote"===$scope.resource?CreditNote.remove_tag({id:$scope.owner.id,tag:tag},function(data){return $scope.finish_save(data,close)}):(spinnerService.stop_spinner("#ad-tags-spinner"),$scope.owner.tags.forEach(function(t){return t.name===tag.name?$scope.owner.tags.remove(t):void 0}))},$scope.finish_save=function(data,close){return null==close&&(close=!0),$scope.owner.tags=data,spinnerService.stop_spinner("#ad-tags-spinner"),$scope.new_tag={color_code:"#000"},close&&$scope.hide(),lookupService.fetch_tags(),$scope.onSuccess?$scope.onSuccess():void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adTimepicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{time:"=ngModel",error:"@error",onSelect:"&"},link:function(scope,elem,attrs){return void 0===attrs.error?attrs.error="right":void 0},templateUrl:template("directives/ad_timepicker"),controller:function($scope,timeService){return $scope.selected_time="",$scope.set_time=function(){var components,hour,minute;return $scope.selected_time&&""!==$scope.selected_time&&($scope.time||($scope.time=new Date),components=$scope.selected_time.split(":"),hour=parseInt(components[0]),minute=parseInt(components[1]),$scope.time.setHours(hour),$scope.time.setMinutes(minute),$scope.onSelect)?timeService.timeout(function(){return $scope.onSelect()}):void 0},$scope.time_change=function(){return $scope.selected_time!==$scope.time_string($scope.time)},$scope.time_string=function(time){var hour,minute;return time?(time.setMinutes(timeService.round_to_five_minutes(time)),hour=time.getHours(),minute=time.getMinutes(),""+hour+":"+minute):""},$scope.$watch("time",function(){return $scope.time?($scope.time instanceof Date||($scope.time=new Date($scope.time)),timeService.timeout(function(){return $scope.time_change()?$scope.selected_time=$scope.time_string($scope.time):void 0})):void 0})}}})}.call(this),function(){this.AutoWorkshopApp.directive("adTrackingCategorySelection",function(){return{restrict:"AE",restrict:"AE",scope:{document:"=ngModel"},templateUrl:template("directives/ad_tracking_category_selection"),controller:function($scope,popoverService,lookupService){return $scope.categories=void 0,$scope.tracking_categories=function(){return $scope.categories||lookupService.tracking_categories()&&lookupService.tracking_categories().length>0&&($scope.categories=[],angular.copy(lookupService.tracking_categories(),$scope.categories),$scope.document&&$scope.document.tracking_categories&&$scope.init_categories_from_document()),$scope.categories},$scope.$watch("document.tracking_categories",function(newValue){return $scope.categories&&newValue?$scope.init_categories_from_document():void 0}),$scope.init_categories_from_document=function(){return $scope.categories.forEach(function(category){var selected_category;return selected_category=$scope.document.tracking_categories.find(function(x){return x.name===category.name}),selected_category?category.options.forEach(function(o){return o.name===selected_category.option?category.selected_option=o.name:void 0}):void 0})},$scope.toggle_selection=function(category){var option;return option=category.selected_option,$scope.selected(category,option)?$scope.unselect(category,option):$scope.select(category,option)},$scope.selected=function(category,option){return $scope.document&&$scope.document.tracking_categories?$scope.document.tracking_categories.forEach(function(c){return c.name===category.name&&c.option===option?!0:void 0}):void 0},$scope.select=function(category,option){var found,_base;return option||(option=""),$scope.document&&(found=!1,(_base=$scope.document).tracking_categories||(_base.tracking_categories=[]),$scope.document.tracking_categories.forEach(function(c){return c.name===category.name?(found=!0,c.option=option):void 0}),found||$scope.document.tracking_categories.push({name:category.name,option:option})),0===option.length?$scope.unselect(category):void 0},$scope.unselect=function(category){return $scope.document.tracking_categories?$scope.document.tracking_categories.forEach(function(c){return c.name===category.name?$scope.document.tracking_categories.remove(c):void 0}):void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adTransactionHistory",function(){return{restrict:"AE",restrict:"AE",scope:{customer:"="},templateUrl:template("directives/ad_transaction_history"),controller:function($scope,$window,spinnerService,Customer){return $scope.show_unpaid_only=!1,$scope.show_unfinalized_only=!1,$scope.show_unallocated_only=!1,$scope.content="invoices",$scope.$watch("customer",function(){return $scope.customer&&$scope.customer.id?($scope.fetch_customer_transactions(),$scope.fetch_customer_payments(),$scope.fetch_customer_quotes()):void 0}),$scope.fetch_customer_transactions=function(page){var options;return null==page&&(page=1),options={id:$scope.customer.id,page:page},$scope.show_unpaid_only&&(options.unpaid_only=!0),$scope.show_unfinalized_only&&(options.unfinalized_only=!0),spinnerService.start_spinner("#transaction-history-spinner"),Customer.transactions(options,function(data){return spinnerService.stop_spinner("#transaction-history-spinner"),$scope.credit_balance=data.meta.credit_balance,$scope.balance=data.meta.balance,$scope.invoice_balance=data.meta.invoice_balance,$scope.total_txn_pages=data.meta.total_pages,$scope.current_txn_page=page,$scope.transactions=data.transactions})},$scope.fetch_customer_payments=function(page){var options;return null==page&&(page=1),options={id:$scope.customer.id,page:page},$scope.show_unallocated_only&&(options.unallocated_only=!0),Customer.payments(options,function(data){return $scope.total_payment_pages=data.meta.total_pages,$scope.current_payment_page=page,$scope.payments=data.payments})},$scope.fetch_customer_quotes=function(page){var options;return null==page&&(page=1),options={id:$scope.customer.id},$scope.show_active_quotes_only&&(options.active=!0),Customer.quotes(options,function(data){return $scope.total_quote_pages=data.meta.total_pages,$scope.current_quote_page=page,$scope.quotes=data.quotes})},$scope.get_transaction_page=function(page){return $scope.fetch_customer_transactions(page)},$scope.get_payment_page=function(page){return $scope.fetch_customer_payments(page)},$scope.get_quote_page=function(page){return $scope.fetch_customer_quotes(page)},$scope.select=function(transaction){return"invoice"===transaction.type&&transaction.job_id?$window.open("#/jobs/"+transaction.job_id):"invoice"===transaction.type?$window.open("#/invoices/"+transaction.id):"credit note"===transaction.type?$window.open("#/credit_notes/"+transaction.id):void 0},$scope.select_payment=function(payment){return $window.open("#/payments/"+payment.id)},$scope.select_quote=function(quote){return $window.open("#/quotes/"+quote.id)},$scope.preview=function(document){return $scope.previewed_invoice={id:document.id,type:document.type}},$scope.show_content=function(content_name){return $scope.content=content_name}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adTransferVehicle",function(){return{restrict:"AE",restrict:"AE",scope:{customer:"=",showing:"=",anchorElement:"@",placement:"@",onSelect:"&"},templateUrl:template("directives/ad_transfer_vehicle"),controller:function($scope,$window,popoverService,lookupService,Vehicle){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.selected_vehicle=void 0,$scope.selected_customer=void 0,popoverService.show("#vehicle-transfer-popover",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#vehicle-transfer-popover")},$scope.transfer=function(){return $scope.selected_vehicle?$scope.selected_customer&&$scope.selected_customer.id?Vehicle.transfer({id:$scope.selected_vehicle.id,customer_id:$scope.selected_customer.id},function(){return $scope.hide(),$scope.onSelect?$scope.onSelect():void 0}):alert("Please select a customer"):alert("Please select a vehicle to transfer")},$scope.asset_name=function(){return lookupService.asset_name()},$scope.asset_name_plural=function(){return lookupService.asset_name_plural()}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adTyroPayment",function(){return{restrict:"AE",restrict:"AE",scope:{showing:"=",anchorElement:"@",placement:"@",onSelect:"&"},templateUrl:template("directives/ad_tyro_payment"),controller:function($scope,$window,tyroService,popoverService,lookupService,spinnerService){return $scope.iclient=tyroService.init($scope,"#tyro-status-spinner"),$scope.enabled=function(){return tyroService.enabled()},$scope.enable=function(){return tyroService.enable(),tyroService.paired()?$scope.iclient=tyroService.init($scope):$scope.tyro_initiate_pair()},$scope.unavailable_reason=function(){return tyroService.paired()?tyroService.available()?tyroService.disabled()?"Connection Is Disabled":void 0:"Terminal Is Not Available":"Currently Not Paired With Any Terminal"},$scope.tyro_account=function(){return lookupService.tyro_account()},$scope.tyro_terminals=function(){return $scope.tyro_account()?$scope.tyro_account().terminals:void 0},$scope.tyro_tid=function(){return tyroService.tid()},$scope.tyro_paired=function(){return tyroService.paired()},$scope.start_tyro_pairing=function(){return $scope.tyro_pairing_tid=$scope.tyro_tid(),$scope.tyro_pairing_message=null,popoverService.show("#pos-tyro-pairing","#tyro-pairing-button",{placement:"top"})},$scope.disable=function(){return tyroService.disable()},$scope.cancel_tyro_pairing=function(){return popoverService.hide("#pos-tyro-pairing")},$scope.tyro_initiate_pair=function(){return tyroService.enable(),$scope.tyro_pairing_message="Please intialize the pairing process from the Terminal",spinnerService.start_spinner("#tyro-pairing-spinner"),$scope.iclient.pairTerminal($scope.tyro_account().merchant_id,$scope.tyro_pairing_tid,$scope.on_pair_status)},$scope.on_pair_status=function(response){return"success"===response.status?($scope.tyro_integrationKey=response.integrationKey,spinnerService.stop_spinner("#tyro-pairing-spinner"),$scope.tyro_pairing_status=response.status,tyroService.set_tid($scope.tyro_pairing_tid),tyroService.set_paired(!0),tyroService.set_available(!0),tyroService.enable(),popoverService.hide("#pos-tyro-pairing")):"failure"===response.status?(spinnerService.stop_spinner("#tyro-pairing-spinner"),$scope.tyro_pairing_status=response.status,response.message&&($scope.tyro_pairing_message=response.message)):"inProgress"===response.status&&($scope.tyro_pairing_message=response.message||"Please complete the transaction from the terminal"),$scope.$apply()},$scope.tyro_reset_decide=function(value){return $scope.tyro_reset_trigger=!0,"NO"===value&&$scope.tyro_reset_trigger===!0?$scope.tyro_reset_trigger=!1:void 0},$scope.tyro_reset=function(value){return"YES"===value?(spinnerService.start_spinner("#create-tyro-invoice-spinner"),$window.open("https://integration.tyro.com/terminals/"+$scope.tyro_mid+"/"+$scope.tyro_tid()+"/reset"),timeService.timeout($route.reload,5e3)):void 0},$scope.tyro_cancel=function(){return $scope.transaction_status?$scope.$apply($scope.tyro_non_success="No transaction in progress"):$scope.iclient.cancelCurrentTransaction()},$scope.tyro_status_purge=function(){return $scope.transaction_status=void 0,$scope.question_text=void 0,$scope.label_list=void 0,$scope.tyro_non_success=void 0,$scope.card_type=void 0,$scope.transaction_ref=void 0,$scope.auth_code=void 0,$scope.issuer_code=void 0},$scope.tyro_answer_controller=function(value){return $scope.label_list=void 0,$scope.answer(value)},$scope.close_dialogue=function(){return $scope.tyro_status_purge(),popoverService.hide("#pos-tyro-dialogue")},$scope.tyro_initiate_transaction=function(transaction_param,transaction_type,success_callback){var question_controller,receipt_controller,status_message_controller,transaction_complete_controller,transaction_controls;return $scope.amount=transaction_param.amount,transaction_param.amount=(100*$scope.amount).round(2).toString(),question_controller=function(question,answerCallback){return $scope.question_text=question.text,$scope.label_list=question.options,$scope.answer=answerCallback,$scope.$apply()},status_message_controller=function(status){return $scope.tyro_status=status},receipt_controller=function(receipt){return receipt.signatureRequired===!0?console.log(receipt.signatureRequired):void 0},transaction_complete_controller=function(response){return $scope.transaction_status=response.result,$scope.card_type=response.cardType,$scope.transaction_ref=response.transactionReference,$scope.auth_code=response.authorisationCode,$scope.issuer_code=response.issuerActionCode,"APPROVED"===$scope.transaction_status&&"REFUND"!==$scope.transaction_type?(spinnerService.start_spinner("#create-tyro-invoice-spinner"),$scope.close_dialogue(),success_callback({merchant_id:tyroService.mid(),card_number:response.elidedPan,transaction_ref:response.transactionReference,authorization_number:response.authorisationCode,terminal_brand:"tyro",terminal_id:tyroService.tid(),card_type:response.cardType})):"APPROVED"!==$scope.transaction_status&&"PURCHASE"===$scope.transaction_type?$scope.$apply($scope.tyro_non_success=$scope.transaction_status):$scope.close_dialogue()},transaction_controls={questionCallback:question_controller,statusMessageCallback:status_message_controller,receiptCallback:receipt_controller,transactionCompleteCallback:transaction_complete_controller},$scope.$apply($scope.tyro_status_purge()),"PURCHASE"===transaction_type&&$scope.iclient.initiatePurchase(transaction_param,transaction_controls),"REFUND"===transaction_type&&$scope.iclient.initiateRefund(transaction_param,transaction_controls),popoverService.show_in_position("#pos-tyro-dialogue",200,100)}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adVehicle",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{vehicle:"=ngModel",onSave:"&",customer:"=",actions:"="},templateUrl:template("directives/ad_vehicle"),controller:function($scope,$window,formService,lookupService,spinnerService,Vehicle,ServiceSchedule){return $scope.vehicle_body_types=lookupService.vehicle_body_types(),$scope.vehicle_transmission_types=lookupService.vehicle_transmission_types(),$scope.vehicle_drive_types=lookupService.vehicle_drive_types(),$scope.edit_vehicle=function(){return formService.edit_fields($scope.vehicle,"editing"),delete $scope.vehicle.editing.customer,delete $scope.vehicle.editing.service_history,delete $scope.vehicle.editing.service_schedule,delete $scope.vehicle.editing.notes},$scope.cancel_edit=function(){return $scope.$parent.cancel($scope.vehicle,"editing")},$scope.asset_property_set=function(){return lookupService.asset_property_set()},$scope.cancel_edit_note=function(note){return $scope.$parent.cancel(note,"editing")},$scope.country=function(){return lookupService.configurations()?lookupService.configurations().country:void 0},$scope.no_wof=function(){return lookupService.configurations()?lookupService.configurations().no_wof:void 0},$scope.save_vehicle=function(){return $scope.vehicle.editing.registration_due_date&&($scope.vehicle.editing.registration_due_date=moment($scope.vehicle.editing.registration_due_date).format("DD/MM/YYYY")),spinnerService.start_spinner("#update-vehicle-spinner"),Vehicle.update($scope.vehicle.editing,function(data){return spinnerService.stop_spinner("#update-vehicle-spinner"),angular.copy(data,$scope.vehicle),$scope.onSave?$scope.onSave(data):void 0})},$scope.edit_note=function(note){return formService.edit_fields(note,"editing","id","content")},$scope.edit_service_note=function(){return formService.edit_fields($scope.vehicle,"editing_service_note","id","service_note"),formService.select_text("#edit-service-note")},$scope.clear_service_note=function(){return $scope.vehicle.editing_service_note.service_note=""},$scope.save_service_note=function(){return Vehicle.update($scope.vehicle.editing_service_note,function(data){return spinnerService.stop_spinner("#update-vehicle-spinner"),angular.copy(data,$scope.vehicle),$scope.onSave?$scope.onSave(data):void 0})},$scope.cancel_edit_service_note=function(){return formService.cancel($scope.vehicle,"editing_service_note")},$scope.select_service_history_item=function(item){return"Job"===item.type?$window.open("#/jobs/"+item.job_id):"Invoice"===item.type?$window.open("#/invoices/"+item.invoice_id):void 0},$scope.edit_next_service_date=function(){return formService.edit_fields($scope.vehicle.service_schedule,"editing_next_service_date","id","next_service_date")},$scope.cancel_edit_next_service_date=function(){return formService.cancel($scope.vehicle.service_schedule,"editing_next_service_date")},$scope.save_next_service_date=function(){return ServiceSchedule.update($scope.vehicle.service_schedule.editing_next_service_date,function(data){return angular.copy(data,$scope.vehicle.service_schedule)})},$scope.edit_last_service_date=function(){return formService.edit_fields($scope.vehicle.service_schedule,"editing_last_service_date","id","last_service_date")},$scope.cancel_edit_last_service_date=function(){return formService.cancel($scope.vehicle.service_schedule,"editing_last_service_date")},$scope.save_last_service_date=function(){return ServiceSchedule.update($scope.vehicle.service_schedule.editing_last_service_date,function(data){return angular.copy(data,$scope.vehicle.service_schedule)})},$scope.edit_wof_date=function(){return formService.edit_fields($scope.vehicle.service_schedule,"editing_wof_date","id","wof_date")},$scope.cancel_edit_wof_date=function(){return formService.cancel($scope.vehicle.service_schedule,"editing_wof_date")},$scope.save_wof_date=function(){return ServiceSchedule.update($scope.vehicle.service_schedule.editing_wof_date,function(data){return angular.copy(data,$scope.vehicle.service_schedule)})},$scope.wof_name=function(){return lookupService.configurations()?lookupService.wof_name():void 0},$scope.edit_registration_due_date=function(){return formService.edit_fields($scope.vehicle,"editing_registration_due_date","id","registration_due_date")},$scope.cancel_edit_registration_due_date=function(){return formService.cancel($scope.vehicle,"editing_registration_due_date")
},$scope.show_history_item_price=function(){return lookupService.session()&&!lookupService.session().is_restricted_mechanic},$scope.save_registration_due_date=function(){return Vehicle.update($scope.vehicle.editing_registration_due_date,function(data){return angular.copy(data,$scope.vehicle)})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adVehicleForm",function(){return{restrict:"AE",restrict:"AE",scope:{vehicle:"=ngModel"},templateUrl:template("directives/ad_vehicle_form"),controller:function($scope,lookupService,VehicleModel){return $scope.asset_property_set=function(){return lookupService.asset_property_set()},$scope.makes=lookupService.makes(),$scope.vehicle_models=[],$scope.vehicle_body_types=lookupService.vehicle_body_types(),$scope.vehicle_transmission_types=lookupService.vehicle_transmission_types(),$scope.vehicle_drive_types=lookupService.vehicle_drive_types(),$scope.fuel_types=lookupService.fuel_types(),$scope.exhaust_systems=lookupService.exhaust_systems(),$scope.exhaust_headers=lookupService.exhaust_headers(),$scope.air_intakes=lookupService.air_intakes(),$scope.odometer_units=lookupService.odometer_units(),$scope.update_models=function(){return $scope.vehicle_models=VehicleModel.models({make:$scope.vehicle.make})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adVehicleLookUpButton",function(){return{restrict:"AE",restrict:"AE",scope:{vehicle:"=ngModel",actions:"="},templateUrl:template("directives/ad_vehicle_look_up_button"),controller:function($scope,spinnerService,lookupService,popoverService,VehicleModel,VehicleLookUpRequest){return $scope.enabled=function(){var account;return account=lookupService.vehicle_look_up_integration_account(),account&&account.enabled},$scope.show_error_message=function(){return popoverService.show("#error-message","#look-up-button")},$scope.close_error_message=function(){return popoverService.hide("#error-message")},$scope.look_up_plate_or_vin=function(){return spinnerService.start_spinner(".vehicle-lookup-spinner","small"),$scope.vehicle?($scope.plate_or_vin=$scope.vehicle.registration_number&&$scope.vehicle.registration_number.length>0?$scope.vehicle.registration_number:$scope.vehicle.vin&&$scope.vehicle.vin.length>0?$scope.vehicle.vin:"",VehicleLookUpRequest.create_request({plate_or_vin:$scope.plate_or_vin,motfuel:1},function(data){var _base,_base1,_base10,_base11,_base12,_base13,_base14,_base15,_base16,_base17,_base18,_base19,_base2,_base20,_base21,_base3,_base4,_base5,_base6,_base7,_base8,_base9;return spinnerService.stop_spinner(".vehicle-lookup-spinner"),data.error?$scope.error_message=data.error.message:($scope.error_message=void 0,(_base=$scope.vehicle).make||(_base.make=data.make),(_base1=$scope.vehicle).model||(_base1.model=data.model),(_base2=$scope.vehicle).year||(_base2.year=data.year_of_manufacture||data.date_manufactured),(_base3=$scope.vehicle).color||(_base3.color=data.main_colour||data.colour),(_base4=$scope.vehicle).body||(_base4.body=data.body_style||data.body_description||data.body),(_base5=$scope.vehicle).gears||(_base5.gears=data.gears||data.smmt_no_of_gears),(_base6=$scope.vehicle).transmission||(_base6.transmission=data.transmission||data.gearbox_type||data.smmt_transmission),(_base7=$scope.vehicle).vin||(_base7.vin=data.vin),(_base8=$scope.vehicle).engine_number||(_base8.engine_number=data.engine_no||data.engine_number),(_base9=$scope.vehicle).engine_size||(_base9.engine_size=data.engine_size||data.published_engine_size),(_base10=$scope.vehicle).engine_type||(_base10.engine_type=data.engine_valves),(_base11=$scope.vehicle).cylinders||(_base11.cylinders=data.engine_cylinders||data.smmt_no_of_cylinders),(_base12=$scope.vehicle).drive_type||(_base12.drive_type=data.drive||data.drive_type),(_base13=$scope.vehicle).doors||(_base13.doors=data.doors||data.smmt_no_of_doors),(_base14=$scope.vehicle).model_code||(_base14.model_code=data.smmt_dvla_model_code),(_base15=$scope.vehicle).seats||(_base15.seats=data.seats||data.smmt_no_of_seats_mv),(_base16=$scope.vehicle).fuel_type||(_base16.fuel_type=data.fuel_type||data.fuel||data.smmt_fuel_type),(_base17=$scope.vehicle).registration_due_date||(_base17.registration_due_date=data.licence_expiry_date||data.date_of_last_registration),(_base18=$scope.vehicle).warranty_expiry_date||(_base18.warranty_expiry_date=data.expiry_date_of_last_successful_wof),(_base19=$scope.vehicle).odometer_unit||(_base19.odometer_unit=data.current_vehicle_odometer_unit),(_base20=$scope.vehicle).chassis_number||(_base20.chassis_number=data.chassis),(_base21=$scope.vehicle).horsepower||(_base21.horsepower=data.power))})):void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adVehicleVisual",function(){return{restrict:"AE",restrict:"AE",scope:{},templateUrl:template("directives/ad_vehicle_visual"),controller:function($scope,$timeout,$window,$document,formService,spinnerService,timeService,vehicleVisualService,popoverService,VehicleVisual){return $scope.hide=function(){return popoverService.hide("#vehicle-visual-popover")},$scope.search=function(page){return null==page&&(page=1),timeService.cancel_timeout($scope.searching),$scope.searching=$timeout($scope.looking_up,500)},$scope.looking_up=function(){return spinnerService.start_spinner("#vehicle-visual-search-spinner"),VehicleVisual.search({term:$scope.term},function(data){return spinnerService.stop_spinner("#vehicle-visual-search-spinner"),$scope.videos=data}),null},$scope.context=function(){return vehicleVisualService.context()},$scope.attribute=function(){return vehicleVisualService.attribute()},$scope.get_video=function(video,callback){return video.url&&video.url.length>0?callback.call():(spinnerService.start_spinner("#vehicle-visual-search-spinner"),VehicleVisual.get({id:video.part_id},function(data){return angular.extend(video,data),spinnerService.stop_spinner("#vehicle-visual-search-spinner"),callback.call()}))},$scope.play=function(video){return $scope.get_video(video,function(){return $window.open(video.url)})},$scope.insert=function(video){return $scope.get_video(video,function(){var attribute,context;return video&&$scope.context()&&(context=$scope.context(),attribute=$scope.attribute(),context[attribute]=context[attribute]&&0!==context[attribute].length?context[attribute].concat("\n"+video.url):video.url),$scope.hide()})},$scope.copy=function(video){return $scope.get_video(video,function(){return $timeout(function(){return $("#video-"+video.part_id).select(),$document[0].execCommand("copy")})})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adVehicleVisualButton",function(){return{restrict:"AE",restrict:"AE",scope:{ngModel:"=",anchorElement:"@",placement:"@"},templateUrl:template("directives/ad_vehicle_visual_button"),controller:function($scope,lookupService,vehicleVisualService){return $scope.show=function(){var options;return options={context:$scope,attribute:"ngModel"},vehicleVisualService.show(options)},$scope.hide=function(){return vehicleVisualService.hide()},$scope.vehicle_visual_enabled=function(){var account;return account=lookupService.vehicle_visual_account(),account&&account.enabled}}}})}.call(this),function(){this.AutoWorkshopApp.directive("adWorkHourForm",function(Job,WorkHour){return{restrict:"AE",restrict:"AE",scope:{work_hour:"=workHour",date:"=",job:"=",employees:"=",showing:"=",anchorElement:"@",placement:"@",onSave:"&",onDelete:"&"},templateUrl:template("directives/ad_work_hour_form"),controller:function($scope,formService,lookupService,popoverService){return $scope.$watch("showing",function(){return $scope.showing?$scope.show():$scope.hide()}),$scope.show=function(){return $scope.anchorElement||($scope.anchorElement="#work-hour-"+$scope.work_hour.id),$scope.work_hour.started_at=new Date($scope.work_hour.started_at),$scope.work_hour.ended_at=new Date($scope.work_hour.ended_at),$scope.placement||($scope.placement="top"),popoverService.show("#work-hour-form",$scope.anchorElement,{placement:$scope.placement})},$scope.hide=function(){return $scope.showing=!1,popoverService.hide("#work-hour-form")},$scope.save=function(){},$scope.cancel_edit_work_hour=function(){return $scope.hide()},$scope.save_work_hour=function(form){return formService.submit_form($scope,form,function(){return $scope.work_hour.id?WorkHour.update($scope.work_hour,function(data){return angular.copy(data,$scope.work_hour),$scope.hide(),$scope.onSave?$scope.onSave():void 0}):WorkHour.save($scope.work_hour,function(data){return angular.copy(data,$scope.work_hour),$scope.hide(),$scope.onSave?$scope.onSave():void 0})})},$scope.remove_work_hour=function(){return WorkHour["delete"]($scope.work_hour,function(){return $scope.hide(),$scope.onDelete?$scope.onDelete():void 0})},$scope.update_duration=function(work_hour){var cloned;return work_hour&&work_hour.started_at&&work_hour.ended_at?(cloned=work_hour.ended_at,work_hour.ended_at=work_hour.started_at.clone(),work_hour.ended_at.setHours(cloned.getHours()),work_hour.ended_at.setMinutes(cloned.getMinutes()),work_hour.hour=Math.round(10*work_hour.ended_at.minutesSince(work_hour.started_at)/6)/100):work_hour?work_hour.hour=0:void 0},$scope.update_ended_at=function(work_hour){return work_hour&&work_hour.started_at&&work_hour.hour?work_hour.ended_at=new moment(work_hour.started_at).add(work_hour.hour,"h").toDate():void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("autoRows",function(){return{restrict:"A",link:function(scope,element){return element.on("input focus",function(){var auto_rows,rows,val,val_rows;return val=element.val(),val&&(val.split("\n").length>=2||val.length>80)?(val_rows=val.split("\n").length,rows=$(element).attr("rows"),auto_rows=$(element).attr("auto-rows"),!rows||val_rows+3>rows?$(element).attr("rows",Math.max(val_rows+10,auto_rows)):void 0):$(element).attr("rows",2)})}}})}.call(this),function(){this.AutoWorkshopApp.directive("businesssourcepicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{business_source:"=ngModel",placement:"@"},templateUrl:template("directives/business_source_picker"),controller:function($scope,lookupService,popoverService,formService,BusinessSource){return $scope.business_sources=lookupService.business_sources(),$scope.create_business_source=function(){var placement;return $scope.new_business_source={},placement=$scope.placement||"top",popoverService.show("#create-business-source","#new-business-source-button",{placement:placement}),formService.focus("#new-business-source-input")},$scope.hide_create_business_source=function(){return $scope.new_business_source=void 0,popoverService.hide("#create-business-source")},$scope.save_new_business_source=function(){return BusinessSource.save($scope.new_business_source,function(data){return angular.copy(data,$scope.new_business_source),$scope.select_new_business_source(),$scope.new_business_source=void 0,popoverService.hide("#create-business-source"),lookupService.fetch_business_sources()})},$scope.select_new_business_source=function(){return $scope.business_sources.push($scope.new_business_source),$scope.business_source=$scope.new_business_source.id,$scope.hide_create_business_source()}}}})}.call(this),function(){this.AutoWorkshopApp.directive("checkList",function(){return{scope:{list:"=checkList",value:"@"},link:function(scope,elem){var changeHandler,handler,setupHandler;return handler=function(setup){var checked,index;if(scope.list){if(checked=elem.prop("checked"),index=scope.list.indexOf(scope.value),checked&&-1===index)return setup?elem.prop("checked",!1):scope.list.push(scope.value);if(!checked&&-1!==index)return setup?elem.prop("checked",!0):scope.list.splice(index,1)}},setupHandler=handler.bind(null,!0),changeHandler=handler.bind(null,!1),elem.bind("change",function(){return scope.$apply(changeHandler)}),scope.$watch("list",setupHandler,!0)}}})}.call(this),function(){this.AutoWorkshopApp.directive("contactpicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{owner:"=ngModel",owner_type:"@modelType",onSelect:"&",show_email:"=showEmail",show_mobile:"=showMobile"},templateUrl:template("directives/contactpicker"),controller:function($scope,lookupService,popoverService){return $scope.employees=lookupService.employees()||[],$scope.selected=[],$scope.show_contacts=function(){var show_employee_contacts;return show_employee_contacts=lookupService.configurations()&&lookupService.configurations().show_employees_on_contact_list,$scope.owner&&$scope.owner.contacts&&$scope.owner.contacts.length>0?!0:show_employee_contacts&&$scope.employees.length>0?!0:void 0},$scope.show_employees_on_contact_list=function(){return lookupService.configurations()&&lookupService.configurations().show_employees_on_contact_list},$scope.select_contact=function(contact,added){return null==added&&(added=!1),added?$scope.selected.push(contact):$scope.selected=[contact]},$scope.select=function(){return $scope.employees.each(function(e){return e.selected=!1}),$scope.close_list(),$scope.onSelect?$scope.onSelect({contacts:$scope.selected}):void 0},$scope.contact_selected=function(contact){return $scope.selected.indexOf(contact)>=0},$scope.close_list=function(){return popoverService.hide("#contactpicker-list")},$scope.remove_contact=function(contact){return $scope.selected.remove(contact)},$scope.cancel=function(){return $scope.selected=[],$scope.close_list()},$scope.list_contact=function(){return popoverService.show("#contactpicker-list","#contactpicker-button",{placement:"left"})}}}})}.call(this),function(){this.AutoWorkshopApp.directive("creditorpicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{creditor:"=ngModel",placement:"@"},templateUrl:template("directives/creditorpicker"),controller:function($scope,lookupService,popoverService,Supplier){return $scope.creditors=lookupService.creditors(),$scope.add_street_address=function(){return $scope.new_creditor.street_address={}},$scope.create_creditor=function(){var placement;return $scope.new_creditor={is_creditor:!0},placement=$scope.placement||"top",popoverService.show("#create-creditor","#new-creditor-button",{placement:placement})},$scope.hide_create_creditor=function(){return $scope.new_creditor=void 0,popoverService.hide("#create-creditor")},$scope.save_new_creditor=function(){return Supplier.save($scope.new_creditor,function(data){return angular.copy(data,$scope.new_creditor),$scope.select_new_creditor(),$scope.new_creditor=void 0,popoverService.hide("#create-creditor"),lookupService.fetch_creditors()})},$scope.select_new_creditor=function(){return $scope.creditors.push($scope.new_creditor),$scope.creditor=$scope.new_creditor.id,$scope.hide_create_creditor()},$scope.country=function(){return lookupService.configurations()?lookupService.configurations().country:void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("customerpicker",function(){return{restrict:"AE",restrict:"AE",scope:{customer:"=",with_balances:"@withBalances",onSelect:"&",input_id:"@inputId"},templateUrl:template("directives/customerpicker"),controller:function($scope,lookupService,spinnerService,popoverService,Customer){return $scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.lookup=function(term){return lookupService.lookup_customers(term,"#lookup-customer-spinner-"+$scope.spinner_id,"#lookup-customer-icon-"+$scope.spinner_id)},$scope.select=function(selected_customer){return $scope.customer.name=selected_customer.name,$scope.customer.id=selected_customer.id,$scope.customer.address=selected_customer.address,$scope.customer.phone=selected_customer.phone,$scope.customer.mobile=selected_customer.mobile,$scope.customer.fax=selected_customer.fax,$scope.customer.is_insurer=selected_customer.is_insurer,$scope.customer.price_level=selected_customer.price_level,$scope.onSelect?$scope.onSelect():void 0},$scope.show_balances=function(){return popoverService.show("#customer-balances-popover","#show-customer-balances-button",{placement:"bottom"}),spinnerService.start_spinner("#customer-balances-spinner"),Customer.customer_account({id:$scope.customer.id,summary:!0},function(data){return spinnerService.stop_spinner("#customer-balances-spinner"),$scope.customer_account=data})},$scope.close_balances=function(){return popoverService.hide("#customer-balances-popover")}}}})}.call(this),function(){this.AutoWorkshopApp.directive("insurerpicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{insurer:"=ngModel",placement:"@"},templateUrl:template("directives/insurerpicker"),controller:function($scope,lookupService,popoverService){return $scope.insurers=lookupService.insurers(),$scope.create_insurer=function(){var placement;return $scope.new_insurer={is_insurer:!0},placement=$scope.placement||"top",popoverService.show("#create-insurer","#new-insurer-button",{placement:placement})},$scope.hide_create_insurer=function(){return $scope.new_insurer=void 0,popoverService.hide("#create-insurer")},$scope.select_new_insurer=function(){return lookupService.fetch_insurers(),$scope.insurers.push($scope.new_insurer),$scope.insurer=$scope.new_insurer.id,$scope.hide_create_insurer()}}}})}.call(this),function(){this.AutoWorkshopApp.directive("locationpicker",function(){return{restrict:"AE",restrict:"AE",scope:{location:"=ngModel",onSelect:"&",input_id:"@inputId"},templateUrl:template("directives/locationpicker"),controller:function($scope,lookupService){return $scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.lookup=function(term){return lookupService.lookup_locations(term,"#lookup-location-spinner-"+$scope.spinner_id,"#lookup-location-icon-"+$scope.spinner_id)},$scope.select=function(selected_location){return $scope.location=selected_location,$scope.onSelect?$scope.onSelect():void 0}}}})}.call(this),function(){this.AutoWorkshopApp.directive("makepicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{make:"=ngModel"},templateUrl:template("directives/makepicker"),controller:function($scope,lookupService){return $scope.makes=lookupService.makes()}}})}.call(this),function(){this.AutoWorkshopApp.directive("modelpicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{model:"=ngModel"},templateUrl:template("directives/modelpicker"),controller:function($scope,VehicleModel){return $scope.models=VehicleModel.models()}}})}.call(this),function(){this.AutoWorkshopApp.directive("pricegrouppicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{price_group:"=ngModel",placement:"@"},templateUrl:template("directives/price_group_picker"),controller:function($scope,lookupService){return $scope.price_groups=lookupService.price_groups()}}})}.call(this),function(){this.AutoWorkshopApp.directive("royaltypicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{model:"=ngModel",placement:"@"},templateUrl:template("directives/royaltypicker"),controller:function($scope,lookupService){return $scope.auto_club_options=[],$scope.royalty_integration_accounts=function(){return lookupService.royalty_integration_accounts()},$scope.auto_club_options=function(){var account;return $scope.model&&$scope.model.royalty_integration_account_id?(account=lookupService.royalty_integration_accounts().find(function(a){return a.id===$scope.model.royalty_integration_account_id}),account?account.auto_clubs:[]):[]},$scope.select=function(){var account;return $scope.model.royalty_integration_account_id?(account=lookupService.royalty_integration_accounts().find(function(a){return a.id===$scope.model.royalty_integration_account_id}),account&&($scope.model.royalty_auto_club||($scope.model.royalty_auto_club=account.auto_club),!$scope.model.discount_percentage)?$scope.model.discount_percentage=account.discount_percentage:void 0):(delete $scope.model.royalty_auto_club,delete $scope.model.royalty_account_number,delete $scope.model.discount_percentage)}}}})}.call(this),function(){this.AutoWorkshopApp.directive("selectText",function(){return{link:function(scope,elem){return elem.bind("click",function(){return elem.select()})}}})}.call(this),function(){this.AutoWorkshopApp.directive("stopEvent",function(){return{restrict:"A",link:function(scope,element,attr){return element.bind(attr.stopEvent,function(e){return e.stopPropagation()})}}})}.call(this),function(){this.AutoWorkshopApp.directive("stopFollow",function(){return{restrict:"A",link:function(scope,element,attr){return element.bind(attr.stopFollow,function(e){return e.stopPropagation(),!1})}}})}.call(this),function(){this.AutoWorkshopApp.directive("supplierpicker",function(){return{restrict:"AE",restrict:"AE",require:"ngModel",scope:{supplierId:"=ngModel",placement:"@",onSelect:"&",supplier:"=",disableNew:"@"},templateUrl:template("directives/supplierpicker"),controller:function($scope,$timeout,lookupService,popoverService){return $scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.lookup=function(term){return lookupService.lookup_suppliers(term,"#lookup-supplier-spinner-"+$scope.spinner_id,"#lookup-supplier-icon-"+$scope.spinner_id)},$scope.select=function(selected_supplier){return $scope.supplier||($scope.supplier={}),$scope.supplier.name=selected_supplier.name,$scope.supplier.id=selected_supplier.id,$scope.supplier.address=selected_supplier.address,$scope.supplier.phone=selected_supplier.phone,$scope.supplier.mobile=selected_supplier.mobile,$scope.supplier.fax=selected_supplier.fax,$scope.supplier.lookup=selected_supplier.lookup,$scope.supplier.payment_term=selected_supplier.payment_term,$scope.supplier.creditor_id=selected_supplier.creditor_id,$scope.supplierId=selected_supplier.id,$scope.onSelect?$timeout(function(){return $scope.onSelect()}):void 0},$scope.create_supplier=function(){var placement;return $scope.new_supplier={},placement=$scope.placement||"bottom",popoverService.show("#create-supplier","#new-supplier-button",{placement:placement})},$scope.hide_create_supplier=function(){return $scope.new_supplier=void 0,popoverService.hide("#create-supplier")},$scope.select_new_supplier=function(){return $scope.select($scope.new_supplier),$scope.hide_create_supplier()}}}})}.call(this),function(){this.AutoWorkshopApp.directive("vehiclepicker",function(){return{restrict:"AE",restrict:"AE",scope:{vehicle:"=",customer:"=",onSelect:"&",input_id:"@inputId"},templateUrl:template("directives/vehiclepicker"),controller:function($scope,lookupService){return $scope.spinner_id=Math.floor(1e10*Math.random()+1),$scope.lookup=function(term){return lookupService.lookup_vehicles({term:term,customer:$scope.customer},"#lookup-vehicle-spinner-"+$scope.spinner_id,"#lookup-vehicle-icon-"+$scope.spinner_id)},$scope.select=function(selected_vehicle){return $scope.vehicle.name=selected_vehicle.name,$scope.vehicle.id=selected_vehicle.id,$scope.vehicle.address=selected_vehicle.address,$scope.vehicle.phone=selected_vehicle.phone,$scope.vehicle.mobile=selected_vehicle.mobile,$scope.vehicle.fax=selected_vehicle.fax,$scope.onSelect?$scope.onSelect():void 0}}}})}.call(this),function(){this.AutoWorkshopFilters.filter("address",function(){return function(address,format){var address_line,state_line,suburb_line;return address?"short"===format?(suburb_line=[address.suburb,address.state,address.postcode].join(" "),address_line=address.street_line,[address_line,suburb_line].join(", ")):(state_line=[address.state,address.postcode].join(" "),suburb_line=[address.suburb,state_line].join(", "),address_line=address.street_line,[address_line,suburb_line].join("<br/>")):void 0}})}.call(this),function(){this.AutoWorkshopFilters.filter("comma_seperated",function(){return function(array,attribute){var display_values;return null==attribute&&(attribute=null),array?(display_values=attribute?array.map(function(e){return e[attribute]}):array,display_values.join(", ")):void 0}})}.call(this),function(){this.AutoWorkshopFilters.filter("customer_name",function(){return function(customer){var values;return customer?(values=[customer.first_name,customer.middle_name,customer.last_name].filter(function(element){return null!==element&&""!==element&&void 0!==element}),values.join(" ")):void 0}})}.call(this),function(){this.AutoWorkshopFilters.filter("percentage",function(){return function(value){return value?""+value+"%":""}})}.call(this),function(){this.AutoWorkshopFilters.filter("phone_number",function(){return function(owner){return owner&&owner.mobile?owner.mobile:owner&&owner.phone?owner.phone:"(unavailable)"}})}.call(this),function(){this.AutoWorkshopFilters.filter("price_list",function($filter){return function(prices){var prices_with_currency;return prices?(prices_with_currency=prices.map(function(p){return $filter("currency")(p)}),prices_with_currency.join(", ")):void 0}})}.call(this),function(){this.AutoWorkshopFilters.filter("round_currency",function($filter){return function(amount){return amount||(amount=0),isNaN(amount)||!amount.toFixed?$filter("currency")(amount):$filter("currency")(amount.toFixed(2))}})}.call(this),function(){this.AutoWorkshopFilters.filter("servicing_vehicles",function(){return function(auto_workshop){var display;return display=[],auto_workshop&&(auto_workshop.servicings.any("car")&&display.push("Cars"),auto_workshop.servicings.any("motorcycle")&&display.push("Motorcycles"),auto_workshop.servicings.any("bicycle")&&display.push("Bicycle"),auto_workshop.servicings.any("tractor")&&display.push("Tractors"),auto_workshop.servicings.any("truck")&&display.push("Trucks"),auto_workshop.servicings.any("bus")&&display.push("Buses"),auto_workshop.servicings.any("boat")&&display.push("Boat")),display.join(", ")}})}.call(this),function(){this.AutoWorkshopFilters.filter("vehicle_title",function(){return function(vehicle,format){var values;return null==format&&(format=""),vehicle&&vehicle.vehicle&&(vehicle=vehicle.vehicle),vehicle?vehicle.boat_name&&vehicle.boat_name.length>0?vehicle.boat_name:(values=[vehicle.year,vehicle.color,vehicle.make,vehicle.model,vehicle.registration_number],"withoutRego"===format&&values.pop(),values.filter(function(element){return null!==element&&""!==element&&void 0!==element}),values.join(" ")):void 0}})}.call(this),function(){this.AutoWorkshopFilters.filter("yes_no",function(){return function(value,true_text,false_text){return null==true_text&&(true_text="yes"),null==false_text&&(false_text="no"),value?true_text:false_text}})}.call(this),function(){this.AutoWorkshopModels.factory("AccountingAccount",function($resource){return $resource("/accounting_accounts/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},get:{method:"GET"},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("AccountingIntegrationAccount",function($resource){return $resource("/accounting_integration_accounts/:id/:action",{id:"@id"},{get:{method:"GET"},update:{method:"PUT"},update_accounts:{method:"PUT",params:{action:"update_accounts"}},unauthorize:{method:"PUT",params:{action:"unauthorize"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("AccountingSyncRequest",function($resource){return $resource("/accounting_sync_requests/:id/:action",{id:"@id"},{get:{method:"GET"},current:{method:"GET",isArray:!0,params:{action:"current"}},update:{method:"PUT"},cancel:{method:"PUT",params:{action:"cancel"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("AssetPropertySet",function($resource){return $resource("/asset_property_sets/:id/:action",{id:"@id"},{update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("AutoWorkshop",function($resource){return $resource("/auto_workshop/:action",{},{get:{method:"GET"},options:{method:"GET",params:{action:"options"}},sms:{method:"GET",params:{action:"sms"}},emails:{method:"GET",params:{action:"emails"}},accounting_integration_account:{method:"GET",params:{action:"accounting_integration_account"}},marketing_integration_account:{method:"GET",params:{action:"marketing_integration_account"}},vehicle_look_up_integration_account:{method:"GET",params:{action:"vehicle_look_up_integration_account"}},subscription_notification:{method:"GET",params:{action:"subscription_notification"}},update:{method:"PUT"},change_plan:{method:"POST",params:{action:"change_plan"}},charge:{method:"POST",params:{action:"charge"}},update_credit_card:{method:"POST",params:{action:"update_credit_card"}},setup:{method:"PUT",params:{action:"setup"}},update_resource_number:{method:"PUT",params:{action:"update_resource_number"}},delete_logo:{method:"DELETE",params:{action:"logo"}},delete_invoice_ad:{method:"DELETE",params:{action:"invoice_ad"}},configurations:{method:"GET",cache:!0,params:{action:"configurations"}},resources:{method:"GET",cache:!0,params:{action:"resources"}},diary:{method:"GET",cache:!0,params:{action:"diary"}},update_diary:{method:"PUT",cache:!0,params:{action:"update_diary"}},surcharge:{method:"PUT",cache:!0,params:{action:"surcharge"}},enable_online_booking:{method:"PUT",cache:!0,params:{action:"enable_online_booking"}},create_note:{method:"POST",params:{action:"create_note"}},update_note:{method:"PUT",params:{action:"update_note"}},destroy_note:{method:"PUT",params:{action:"destroy_note"}},move_note:{method:"PUT",params:{action:"move_note"}},tags:{method:"GET",isArray:!0,params:{action:"tags"}},booking_requests:{method:"GET",isArray:!0,params:{action:"booking_requests"}},booking_request:{method:"GET",params:{action:"booking_request"}},confirm_booking_request:{method:"PUT",params:{action:"confirm_booking_request"}},cancel_booking_request:{method:"PUT",params:{action:"cancel_booking_request"}},resource_search:{method:"GET",params:{action:"resource_search"}},booking_request_count:{method:"GET",params:{action:"booking_request_count"}},set_preference:{method:"PUT",isArray:!0,params:{action:"set_preference"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Bill",function($resource){return $resource("/bills/:id/:action",{id:"@id"},{all:{method:"GET"},search:{method:"POST",params:{action:"search"}},update:{method:"PUT"},unpaid:{method:"GET",params:{action:"unpaid"},isArray:!0},allocate_payments:{method:"POST",params:{action:"allocate_payments"}},finalize:{method:"PUT",params:{action:"finalize"}},new_item:{method:"POST",params:{action:"new_item"}},update_item:{method:"PUT",params:{action:"update_item"}},delete_item:{method:"PUT",params:{action:"delete_item"}},add_purchase_orders:{method:"POST",params:{action:"add_purchase_orders"}},invoice:{method:"PUT",params:{action:"invoice"}},remove_related_invoice:{method:"PUT",params:{action:"remove_related_invoice"}},add_tag:{method:"POST",isArray:!0,params:{action:"add_tag"}},remove_tag:{method:"POST",isArray:!0,params:{action:"remove_tag"}},switch_tag:{method:"POST",isArray:!0,params:{action:"switch_tag"}},set_prices_include_gst:{method:"PUT",params:{action:"set_prices_include_gst"}},set_gst_free:{method:"PUT",params:{action:"set_gst_free"}},bulk_finalize:{method:"PUT",isArray:!0,params:{action:"bulk_finalize"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("BillPayment",function($resource){return $resource("/bill_payments/:id/:action",{id:"@id"},{all:{method:"GET"},update:{method:"PUT"},finalize:{method:"PUT",params:{action:"finalize"}},allocate_payments:{method:"POST",params:{action:"allocate_payments"}},update_allocation:{method:"PUT",params:{action:"update_allocation"}},remove_allocation:{method:"POST",params:{action:"remove_allocation"}},search:{method:"POST",params:{action:"search"}},send_email:{method:"POST",params:{action:"send_email"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Booking",function($resource){return $resource("/bookings/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},active:{method:"GET",isArray:!0,params:{action:"active"}},update:{method:"PUT"},search:{method:"POST",params:{action:"search"}},add_tag:{method:"POST",isArray:!0,params:{action:"add_tag"}},remove_tag:{method:"POST",isArray:!0,params:{action:"remove_tag"}},switch_tag:{method:"POST",isArray:!0,params:{action:"switch_tag"}},undelete:{method:"POST",params:{action:"undelete"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("BusinessSource",function($resource){return $resource("/business_sources/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("CommunicationTemplate",function($resource){return $resource("/communication_templates/:id/:action",{id:"@id"},{new_saved_text:{method:"GET",params:{action:"new_saved_text"}},all:{method:"GET",isArray:!0},update:{method:"PUT"},saved_text_search:{method:"POST",params:{action:"saved_text_search"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Cost",function($resource){return $resource("/costs/:id",{id:"@id"},{all:{method:"GET",isArray:!0},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("CourtesyVehicleBooking",function($resource){return $resource("/courtesy_vehicle_bookings/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},upcomings:{method:"GET",params:{action:"upcomings"}},pasts:{method:"GET",params:{action:"pasts"}},validate_booking:{method:"GET",params:{action:"validate_booking"}},save_booking:{method:"GET",params:{action:"save_booking"}},fetch_availabilities:{method:"GET",params:{action:"fetch_availabilities"}},fetch_owner:{method:"GET",params:{action:"fetch_owner"}},fetch_date_markers:{method:"GET",params:{action:"fetch_date_markers"}},fetch_booking_via_job_booking:{method:"GET",params:{action:"fetch_booking_via_job_booking"}},update:{method:"PUT"}})
})}.call(this),function(){this.AutoWorkshopModels.factory("CreditNote",function($resource){return $resource("/credit_notes/:id/:action",{id:"@id"},{all:{method:"GET"},update:{method:"PUT"},finalize:{method:"PUT",params:{action:"finalize"}},update_allocation:{method:"PUT",params:{action:"update_allocation"}},remove_allocation:{method:"POST",params:{action:"remove_allocation"}},allocate_payments:{method:"POST",params:{action:"allocate_payments"}},send_email:{method:"POST",params:{action:"send_email"}},new_item:{method:"POST",params:{action:"new_item"}},new_items:{method:"POST",params:{action:"new_items"}},update_item:{method:"PUT",params:{action:"update_item"}},delete_item:{method:"PUT",params:{action:"delete_item"}},refund:{method:"POST",params:{action:"refund"}},tags:{method:"POST",params:{action:"tags"}},add_tag:{method:"POST",isArray:!0,params:{action:"add_tag"}},remove_tag:{method:"POST",isArray:!0,params:{action:"remove_tag"}},switch_tag:{method:"POST",isArray:!0,params:{action:"switch_tag"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Customer",function($resource){return $resource("/customers/:id/:action",{id:"@id"},{all:{method:"GET"},insurers:{method:"GET",isArray:!0,params:{action:"insurers"}},positive_balance:{method:"GET",isArray:!0,params:{action:"positive_balance"}},recommendations:{method:"POST",isArray:!0,params:{action:"recommendations"}},find_by_name:{method:"GET",isArray:!0,params:{action:"find_by_name"}},lookup:{method:"GET",isArray:!0,params:{action:"lookup"}},update:{method:"PUT"},invoices:{method:"GET",isArray:!0,params:{action:"invoices"}},customer_account:{method:"GET",params:{action:"customer_account"}},transactions:{method:"GET",params:{action:"transactions"}},credit_notes:{method:"GET",params:{action:"credit_notes"}},payments:{method:"GET",params:{action:"payments"}},quotes:{method:"GET",params:{action:"quotes"}},recommendation:{method:"GET",params:{action:"recommendation"}},send_statement:{method:"POST",params:{action:"send_statement"}},bulk_statements:{method:"POST",params:{action:"bulk_statements"}},create_note:{method:"POST",params:{action:"create_note"}},update_note:{method:"PUT",params:{action:"update_note"}},destroy_note:{method:"PUT",params:{action:"destroy_note"}},merge:{method:"POST",params:{action:"merge"}},create_contact:{method:"POST",params:{action:"create_contact"}},update_contact:{method:"PUT",params:{action:"update_contact"}},destroy_contact:{method:"PUT",params:{action:"destroy_contact"}},add_tag:{method:"POST",isArray:!0,params:{action:"add_tag"}},remove_tag:{method:"POST",isArray:!0,params:{action:"remove_tag"}},switch_tag:{method:"POST",isArray:!0,params:{action:"switch_tag"}},vehicles:{method:"GET",params:{action:"vehicles"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("CustomerCommunication",function($resource){return $resource("/customer_communications/:id/:action",{id:"@id"},{all:{method:"GET"},update:{method:"PUT"},quote:{method:"POST",params:{action:"quote"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("CustomerCommunicationType",function($resource){return $resource("/customer_communication_types/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},update:{method:"PUT"},service_reminder:{method:"GET",params:{id:"service_reminder"}},wof_reminder:{method:"GET",params:{id:"wof_reminder"}},registration_reminder:{method:"GET",params:{id:"registration_reminder"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("CustomerStatementSendingRequest",function($resource){return $resource("/customer_statement_sending_requests/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("Day",function($resource){return $resource("/days/:date/:action",{date:"@date"},{all:{method:"GET",isArray:!0},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("DbFile",function($resource){return $resource("/db_files/:id/:action",{id:"@id"},{rename:{method:"PUT",params:{action:"rename"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("EftposMachineIntegrationAccount",function($resource){return $resource("/eftpos_machine_integration_account/:action",{},{tyro:{method:"GET",params:{action:"tyro"}},payment_express:{method:"GET",params:{action:"payment_express"}},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("Email",function($resource){return $resource("/emails/:id/:action",{id:"@id"},{send_to_customer:{method:"POST",params:{action:"send_to_customer"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Employee",function($resource){return $resource("/employees/:id/:action",{id:"@id"},{all:{method:"GET",params:{id:""},isArray:!0},current:{method:"GET",params:{id:"current"}},mechanics:{method:"GET",isArray:!0,params:{id:"mechanics"}},update:{method:"PUT"},change_password:{method:"PUT",params:{action:"change_password"}},delete_avatar:{method:"DELETE",params:{action:"avatar"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("ExportRequest",function($resource){return $resource("/export_requests/:id/:action",{id:"@id"},{current:{method:"GET",isArray:!0,params:{action:"current"}},finished:{method:"GET",isArray:!0,params:{action:"finished"}},cancel:{method:"POST",params:{action:"cancel"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("FollowUp",function($resource){return $resource("/follow_ups/:id/:action",{id:"@id"},{current:{method:"POST",params:{action:"current"}},processed:{method:"POST",params:{action:"processed"}},cancel:{method:"POST",params:{action:"cancel"}},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("Help",function($resource){return $resource("/helps/:id/:action",{},{structure:{method:"GET",isArray:!0},send_message:{method:"POST",params:{action:"send_message"}},search:{method:"GET",params:{action:"search"},isArray:!0}})})}.call(this),function(){this.AutoWorkshopModels.factory("Invoice",function($resource){return $resource("/invoices/:id/:action",{id:"@id"},{all:{method:"GET"},unpaid:{method:"GET",params:{action:"unpaid"},isArray:!0},update:{method:"PUT"},update_salesperson:{method:"PUT",params:{action:"update_salesperson"}},finalize:{method:"PUT",params:{action:"finalize"}},bulk_finalize:{method:"PUT",isArray:!0,params:{action:"bulk_finalize"}},bulk_send:{method:"PUT",isArray:!0,params:{action:"bulk_send"}},invoice_items:{method:"GET",isArray:!0,params:{action:"invoice_items"}},reorder_items:{method:"PUT",params:{action:"reorder_items"}},templates:{method:"GET",isArray:!0,params:{action:"templates"}},search:{method:"POST",params:{action:"search"}},download:{method:"GET",params:{action:"download"}},send_email:{method:"POST",params:{action:"send_email"}},pay:{method:"PUT",params:{action:"pay"}},new_item:{method:"POST",params:{action:"new_item"}},new_items:{method:"POST",params:{action:"new_items"}},update_item:{method:"PUT",params:{action:"update_item"}},delete_item:{method:"PUT",params:{action:"delete_item"}},add_job_types:{method:"PUT",params:{action:"add_job_types"}},tags:{method:"POST",params:{action:"tags"}},add_tag:{method:"POST",isArray:!0,params:{action:"add_tag"}},remove_tag:{method:"POST",isArray:!0,params:{action:"remove_tag"}},switch_tag:{method:"POST",isArray:!0,params:{action:"switch_tag"}},change_customer:{method:"PUT",params:{action:"change_customer"}},email_preview:{method:"GET",params:{action:"email_preview"}},change_vehicle:{method:"PUT",params:{action:"change_vehicle"}},bulk_invoices:{method:"POST",params:{action:"bulk_invoices"}},copy:{method:"POST",params:{action:"copy"}},allocate_payments:{method:"POST",params:{action:"allocate_payments"}},undelete:{method:"POST",params:{action:"undelete"}},sign:{method:"POST",params:{action:"sign"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Job",function($resource){return $resource("/jobs/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},events:{method:"GET",isArray:!0,params:{action:"events"}},get_open:{method:"GET",isArray:!0,params:{action:"open"}},current:{method:"GET",isArray:!0,params:{action:"current"}},search:{method:"POST",params:{action:"search"}},finished:{method:"GET",params:{action:"finished"}},finish:{method:"PUT",params:{action:"finish"}},unfinish:{method:"PUT",params:{action:"unfinish"}},done_sms_preview:{method:"GET",params:{action:"done_sms_preview"}},done_email_preview:{method:"GET",params:{action:"done_email_preview"}},create_invoice:{method:"POST",params:{action:"create_invoice"}},update:{method:"PUT"},works:{method:"GET",isArray:!0,params:{action:"works"}},create_note:{method:"POST",params:{action:"create_note"}},create_quote:{method:"POST",params:{action:"create_quote"}},update_note:{method:"PUT",params:{action:"update_note"}},destroy_note:{method:"PUT",params:{action:"destroy_note"}},transfer_quote_to_invoice:{method:"PUT",params:{action:"transfer_quote_to_invoice"}},copy_invoice_to_quote:{method:"PUT",params:{action:"copy_invoice_to_quote"}},update_employees:{method:"PUT",params:{action:"update_employees"}},move:{method:"PUT",params:{action:"move"}},resize:{method:"PUT",params:{action:"resize"}},reassign:{method:"PUT",params:{action:"reassign"}},transfer_work_hours:{method:"PUT",params:{action:"transfer_work_hours"}},transfer_checksheet:{method:"PUT",params:{action:"transfer_checksheet"}},reorder_works:{method:"PUT",params:{action:"reorder_works"}},delete_work:{method:"PUT",isArray:!0,params:{action:"delete_work"}},delete_all_works:{method:"PUT",isArray:!0,params:{action:"delete_all_works"}},check_all_works:{method:"PUT",isArray:!0,params:{action:"check_all_works"}},put_on_hold:{method:"PUT",params:{action:"put_on_hold"}},"continue":{method:"PUT",params:{action:"continue"}},add_job_types:{method:"PUT",params:{action:"add_job_types"}},copy_invoice_items_to_job_card:{method:"POST",params:{action:"copy_invoice_items_to_job_card"}},add_tag:{method:"POST",isArray:!0,params:{action:"add_tag"}},remove_tag:{method:"POST",isArray:!0,params:{action:"remove_tag"}},send_email:{method:"POST",params:{action:"send_email"}},switch_tag:{method:"POST",isArray:!0,params:{action:"switch_tag"}},change_vehicle:{method:"PUT",params:{action:"change_vehicle"}},remove_checksheet_text:{method:"PUT",params:{action:"remove_checksheet_text"}},lookup:{method:"GET",isArray:!0,params:{action:"lookup"}},add_sub_job:{method:"PUT",params:{action:"add_sub_job"}},sign:{method:"POST",params:{action:"sign"}},add_quote:{method:"PUT",params:{action:"add_quote"}},undelete:{method:"POST",params:{action:"undelete"}},promote:{method:"PUT",params:{action:"promote"}},clock_on:{method:"POST",params:{action:"clock_on"}},change_customer:{method:"PUT",params:{action:"change_customer"}},update_job_types:{method:"PUT",params:{action:"update_job_types"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("JobType",function($resource){return $resource("/job_types/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},update:{method:"PUT"},reorder_works:{method:"PUT",params:{action:"reorder_works"}},reorder_costs:{method:"PUT",params:{action:"reorder_costs"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("MarketingIntegrationAccount",function($resource){return $resource("/marketing_integration_accounts/:id/:action",{id:"@id"},{get:{method:"GET"},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("MarketingSyncRequest",function($resource){return $resource("/marketing_sync_requests/:id/:action",{id:"@id"},{get:{method:"GET"},update:{method:"PUT"},cancel:{method:"PUT",params:{action:"cancel"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Notification",function($resource){return $resource("/notifications/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},unread_count:{method:"GET",params:{action:"unread_count"}},read:{method:"PUT",params:{action:"read"}},bulk_read:{method:"PUT",params:{action:"bulk_read"}},bulk_delete:{method:"PUT",params:{action:"bulk_delete"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("OscarSupplierSystems",function($resource){return $resource("/oscar_supplier_systems/:action",{},{inquire:{method:"PUT",params:{action:"inquire"}},check_update:{method:"PUT",params:{action:"check_update"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Password",function($resource){return $resource("/password/:action",{},{reset:{method:"POST",params:{action:"reset"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Payment",function($resource){return $resource("/payments/:id/:action",{id:"@id"},{create_invoice_payment:{method:"POST",params:{action:"create_invoice_payment"}},all:{method:"GET"},search:{method:"POST",params:{action:"search"}},update:{method:"PUT"},finalize:{method:"PUT",params:{action:"finalize"}},allocate_payments:{method:"POST",params:{action:"allocate_payments"}},update_allocation:{method:"PUT",params:{action:"update_allocation"}},remove_allocation:{method:"POST",params:{action:"remove_allocation"}},create_note:{method:"POST",params:{action:"create_note"}},update_note:{method:"PUT",params:{action:"update_note"}},destroy_note:{method:"PUT",params:{action:"destroy_note"}},send_email:{method:"POST",params:{action:"send_email"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("PaymentExpress",function($resource){return $resource("/payment_express/:action",{},{create_transaction:{method:"POST",params:{action:"create_transaction"}},get_transaction:{method:"GET",params:{action:"get_transaction"}},click_button:{method:"PUT",params:{action:"click_button"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Pos",function($resource){return $resource("/pos/:action",{},{create_invoice:{method:"POST",params:{action:"create_invoice"}},return_and_refund:{method:"POST",params:{action:"return_and_refund"}},sales:{method:"GET",isArray:!0,params:{action:"sales"}},use_normal_invoice_for_pos:{method:"GET",params:{action:"use_normal_invoice_for_pos"}},toggle_use_normal_invoice_for_pos:{method:"POST",params:{action:"toggle_use_normal_invoice_for_pos"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("PriceGroup",function($resource){return $resource("/price_groups/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},update:{method:"PUT"},stocks:{method:"GET",params:{action:"stocks"}},update_items:{method:"PUT",params:{action:"update_items"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Purchase",function($resource){return $resource("/purchases/:id/:action",{id:"@id"},{all:{method:"GET"},search:{method:"POST",params:{action:"search"}},unprocessed:{method:"GET",isArray:!0,params:{action:"unprocessed"}},not_billed:{method:"GET",isArray:!0,params:{action:"not_billed"}},update:{method:"PUT"},send_order:{method:"POST",params:{action:"send_order"}},processes:{method:"PUT",params:{action:"processes"}},new_item:{method:"POST",params:{action:"new_item"}},new_items:{method:"POST",params:{action:"new_items"}},update_item:{method:"PUT",params:{action:"update_item"}},delete_item:{method:"PUT",params:{action:"delete_item"}},add_tag:{method:"POST",isArray:!0,params:{action:"add_tag"}},switch_tag:{method:"POST",isArray:!0,params:{action:"switch_tag"}},remove_tag:{method:"POST",isArray:!0,params:{action:"remove_tag"}},undelete:{method:"POST",params:{action:"undelete"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("PurchaseItem",function($resource){return $resource("/purchase_items/:id/:action",{id:"@id"},{all:{method:"GET"},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("Quote",function($resource){return $resource("/quotes/:id/:action",{id:"@id"},{all:{method:"GET"},update:{method:"PUT"},search:{method:"POST",params:{action:"search"}},create_invoice:{method:"POST",params:{action:"create_invoice"}},send_email:{method:"POST",params:{action:"send_email"}},new_item:{method:"POST",params:{action:"new_item"}},update_item:{method:"PUT",params:{action:"update_item"}},delete_item:{method:"PUT",params:{action:"delete_item"}},reorder_items:{method:"PUT",params:{action:"reorder_items"}},add_job_types:{method:"PUT",params:{action:"add_job_types"}},generate_repco_access_token:{method:"PUT",params:{action:"generate_repco_access_token"}},email_preview:{method:"GET",params:{action:"email_preview"}},change_vehicle:{method:"PUT",params:{action:"change_vehicle"}},update_employees:{method:"PUT",params:{action:"update_employees"}},create_note:{method:"POST",params:{action:"create_note"}},update_note:{method:"PUT",params:{action:"update_note"}},destroy_note:{method:"PUT",params:{action:"destroy_note"}},add_tag:{method:"POST",isArray:!0,params:{action:"add_tag"}},remove_tag:{method:"POST",isArray:!0,params:{action:"remove_tag"}},switch_tag:{method:"POST",isArray:!0,params:{action:"switch_tag"}},change_customer:{method:"PUT",params:{action:"change_customer"}},undelete:{method:"POST",params:{action:"undelete"}},cancel:{method:"POST",params:{action:"cancel"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("RepcoNavigator",function($resource){return $resource("/repco_navigator/:action",{},{purchase_order_access:{method:"PUT",params:{action:"purchase_order_access"}},quote_access:{method:"PUT",params:{action:"quote_access"}},invoice_access:{method:"PUT",params:{action:"invoice_access"}},inventory_access:{method:"PUT",params:{action:"inventory_access"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Report",function($resource){return $resource("/reports/:action",{},{income_by_payment_type:{method:"GET",params:{action:"income_by_payment_type"}},income_by_job_type:{method:"GET",params:{action:"income_by_job_type"}},income_by_status:{method:"GET",params:{action:"income_by_status"}},income_by_time:{method:"GET",params:{action:"income_by_time"}},debtors:{method:"GET",params:{action:"debtors"}},suppliers:{method:"GET",params:{action:"suppliers"}},sales:{method:"GET",params:{action:"sales"}},bills:{method:"GET",params:{action:"bills"}},purchases:{method:"GET",params:{action:"purchases"}},wip:{method:"GET",params:{action:"wip"}},wip_invoice:{method:"GET",params:{action:"wip_invoice"}},workshop_efficiency:{method:"GET",params:{action:"workshop_efficiency"}},productivity:{method:"GET",params:{action:"productivity"}},efficiency:{method:"GET",params:{action:"efficiency"}},buyin:{method:"GET",params:{action:"buyin"}},lead:{method:"GET",params:{action:"lead"}},job:{method:"GET",params:{action:"job"}},quote:{method:"GET",params:{action:"quote"}},lead_new_customer:{method:"GET",params:{action:"lead_new_customer"}},stock_value:{method:"GET",params:{action:"stock_value"}},commission:{method:"GET",params:{action:"commission"}},ams:{method:"GET",params:{action:"ams"}},change_logs:{method:"GET",params:{action:"change_logs"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("RoyaltyIntegrationAccount",function($resource){return $resource("/royalty_integration_accounts/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},ams:{method:"GET",params:{action:"ams"}},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("ServiceSchedule",function($resource){return $resource("/service_schedules/:id/:action",{id:"@id"},{overdue:{method:"GET",params:{action:"overdue"}},wof_overdue:{method:"GET",params:{action:"wof_overdue"}},wof_upcomings:{method:"GET",params:{action:"wof_upcomings"}},registration_overdue:{method:"GET",params:{action:"registration_overdue"}},registration_upcomings:{method:"GET",params:{action:"registration_upcomings"}},upcomings:{method:"GET",params:{action:"upcomings"}},update:{method:"PUT"},create_note:{method:"POST",params:{action:"create_note"}},update_note:{method:"PUT",params:{action:"update_note"}},destroy_note:{method:"PUT",params:{action:"destroy_note"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Session",function($resource){return $resource("/session/:action",{},{current:{method:"GET",cache:!0}})})}.call(this),function(){this.AutoWorkshopModels.factory("Sms",function($resource){return $resource("/sms/:id/:action",{id:"@id"},{send_to_customer:{method:"POST",params:{action:"send_to_customer"}},balance:{method:"GET",params:{action:"balance"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Stock",function($resource){return $resource("/stocks/:id/:action",{id:"@id"},{all:{method:"GET"},kits:{method:"GET",isArray:!0,params:{action:"kits"}},business_stocks:{method:"GET",isArray:!0,params:{action:"business_stocks"}},reorder:{method:"GET",isArray:!0,params:{action:"reorder"}},update:{method:"PUT"},lookup:{method:"GET",isArray:!0,params:{action:"lookup"}},purchase_history:{method:"GET",params:{action:"purchase_history"}},sale_history:{method:"GET",params:{action:"sale_history"}},find_by_barcode:{method:"GET",params:{action:"find_by_barcode"}},find_by_stock_number:{method:"GET",isArray:!0,params:{action:"find_by_stock_number"}},merge:{method:"POST",params:{action:"merge"}},reorder_suppliers:{method:"PUT",params:{action:"reorder_suppliers"}},reorder_components:{method:"PUT",params:{action:"reorder_components"}},build:{method:"POST",params:{action:"build"}},transfer:{method:"PUT",params:{action:"transfer"}},new_component:{method:"POST",params:{action:"new_component"}},update_component:{method:"PUT",params:{action:"update_component"}},delete_component:{method:"PUT",params:{action:"delete_component"}},change_logs:{method:"GET",params:{action:"change_logs"}},tags:{method:"POST",params:{action:"tags"}},add_tag:{method:"POST",isArray:!0,params:{action:"add_tag"}},remove_tag:{method:"POST",isArray:!0,params:{action:"remove_tag"}},switch_tag:{method:"POST",isArray:!0,params:{action:"switch_tag"}},undelete:{method:"POST",params:{action:"undelete"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("StockCategory",function($resource){return $resource("/stock_categories/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("StockSupplier",function($resource){return $resource("/stock_suppliers/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("Stocktake",function($resource){return $resource("/stocktakes/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},update:{method:"PUT"},finish:{method:"PUT",params:{action:"finish"}},new_item:{method:"POST",params:{action:"new_item"}},update_item:{method:"PUT",params:{action:"update_item"}},delete_item:{method:"PUT",params:{action:"delete_item"}},add_stock_category:{method:"PUT",params:{action:"add_stock_category"}},add_location:{method:"PUT",params:{action:"add_location"}},create_note:{method:"POST",params:{action:"create_note"}},create_quote:{method:"POST",params:{action:"create_quote"}},update_note:{method:"PUT",params:{action:"update_note"}},destroy_note:{method:"PUT",params:{action:"destroy_note"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Supplier",function($resource){return $resource("/suppliers/:id/:action",{id:"@id"},{all:{method:"GET"},search:{method:"GET",params:{action:"search"}},creditors:{method:"GET",isArray:!0,params:{action:"creditors"}},positive_balance:{method:"GET",isArray:!0,params:{action:"positive_balance"}},lookup:{method:"GET",isArray:!0,params:{action:"lookup"}},transactions:{method:"GET",params:{action:"transactions"}},update:{method:"PUT"},supplier_account:{method:"GET",params:{action:"supplier_account"}},merge:{method:"POST",params:{action:"merge"}},create_note:{method:"POST",params:{action:"create_note"}},update_note:{method:"PUT",params:{action:"update_note"}},destroy_note:{method:"PUT",params:{action:"destroy_note"}},create_contact:{method:"POST",params:{action:"create_contact"}},update_contact:{method:"PUT",params:{action:"update_contact"}},destroy_contact:{method:"PUT",params:{action:"destroy_contact"}},stock_suppliers:{method:"GET",params:{action:"stock_suppliers"}},add_tag:{method:"POST",isArray:!0,params:{action:"add_tag"}},remove_tag:{method:"POST",isArray:!0,params:{action:"remove_tag"}},switch_tag:{method:"POST",isArray:!0,params:{action:"switch_tag"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("SupplierCreditNote",function($resource){return $resource("/supplier_credit_notes/:id/:action",{id:"@id"},{all:{method:"GET"},update:{method:"PUT"},finalize:{method:"PUT",params:{action:"finalize"}},update_allocation:{method:"PUT",params:{action:"update_allocation"}},remove_allocation:{method:"POST",params:{action:"remove_allocation"}},allocate_payments:{method:"POST",params:{action:"allocate_payments"}},new_item:{method:"POST",params:{action:"new_item"}},new_items:{method:"POST",params:{action:"new_items"}},update_item:{method:"PUT",params:{action:"update_item"}},delete_item:{method:"PUT",params:{action:"delete_item"}},refund:{method:"POST",params:{action:"refund"}},send_email:{method:"POST",params:{action:"send_email"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("SupplierIntegrationAccount",function($resource){return $resource("/supplier_integration_account/:action",{},{repco:{method:"GET",params:{action:"repco"}},quantum:{method:"GET",params:{action:"quantum"}},pro_link:{method:"GET",params:{action:"pro_link"}},ezy_parts:{method:"GET",params:{action:"ezy_parts"}},autopro:{method:"GET",params:{action:"autopro"}},motospecs:{method:"GET",params:{action:"motospecs"}},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("SupportPortal",function($resource){return $resource("/support_portals/:id/:action",{id:"@id"},{update:{method:"PUT"},adv_get:{method:"GET",isArray:!0,params:{action:"adv_get"}},lock:{method:"PUT",params:{action:"lock"}},unlock:{method:"PUT",params:{action:"unlock"}},change_password:{method:"PUT",params:{action:"change_password"}},object_search:{method:"GET",params:{action:"object_search"}},reassociate:{method:"PUT",params:{action:"reassociate"}},show_report:{method:"GET",params:{action:"show_report"}},add_workshop_credit:{method:"GET",params:{action:"add_credit"}},delete_mechanic_desk_invoice:{method:"GET",params:{action:"delete_mechanic_desk_invoice"},isArray:!0},add_custom_attribute:{method:"GET",params:{action:"add_custom_attribute"},isArray:!0}})})}.call(this),function(){this.AutoWorkshopModels.factory("Vehicle",function($resource){return $resource("/vehicles/:id/:action",{id:"@id"},{all:{method:"GET"},courtesy_vehicles:{method:"GET",isArray:!0,params:{action:"courtesy_vehicles"}},create_courtesy_vehicle:{method:"POST",params:{action:"courtesy_vehicles"}},update:{method:"PUT"},create_note:{method:"POST",params:{action:"create_note"}},update_note:{method:"PUT",params:{action:"update_note"}},destroy_note:{method:"PUT",params:{action:"destroy_note"}},transfer:{method:"PUT",params:{action:"transfer"}},merge:{method:"PUT",params:{action:"merge"}},lookup:{method:"GET",isArray:!0,params:{action:"lookup"}},find_by:{method:"GET",isArray:!0,params:{action:"find_by"}},current_jobs:{method:"GET",isArray:!0,params:{action:"current_jobs"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("VehicleLookUpIntegrationAccount",function($resource){return $resource("/vehicle_look_up_integration_accounts/:id/:action",{id:"@id"},{carjam:{method:"GET",params:{action:"carjam"}},mycarcheck:{method:"GET",params:{action:"mycarcheck"}},update:{method:"PUT"},generate_auth_url:{method:"GET",params:{action:"generate_auth_url"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("VehicleLookUpRequest",function($resource){return $resource("/vehicle_look_up_requests/:id/:action",{id:"@id"},{create_request:{method:"GET",params:{action:"create_request"}},check_availability:{method:"GET",params:{action:"check_availability"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("VehicleModel",function($resource){return $resource("/vehicle_models/:type",{},{makes:{method:"GET",params:{type:"makes"},isArray:!0,cache:!0},models:{method:"GET",params:{type:"models"},isArray:!0,cache:!0}})})}.call(this),function(){this.AutoWorkshopModels.factory("VehicleVisual",function($resource){return $resource("/vehicle_visuals/:id/:action",{id:"@id"},{search:{method:"GET",isArray:!0,params:{action:"search"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("VehicleVisualIntegrationAccount",function($resource){return $resource("/vehicle_visual_integration_accounts/:id/:action",{id:"@id"},{vehicle_visual:{method:"GET",params:{action:"vehicle_visual"}},update:{method:"PUT"},update_api_key:{method:"POST",params:{action:"update_api_key"}}})})}.call(this),function(){this.AutoWorkshopModels.factory("Work",function($resource){return $resource("/works/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("WorkHour",function($resource){return $resource("/work_hours/:id/:action",{id:"@id"},{all:{method:"GET",params:{id:""},isArray:!0},timesheets:{method:"GET",params:{action:"timesheets"}},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("WorkType",function($resource){return $resource("/work_types/:id/:action",{id:"@id"},{all:{method:"GET",isArray:!0},update:{method:"PUT"}})})}.call(this),function(){this.AutoWorkshopModels.factory("Workstation",function($resource){return $resource("/workstations/:action",{},{switch_to:{method:"POST",params:{action:"switch_to"}},sign_off:{method:"POST",params:{action:"sign_off"}},employees:{method:"GET",isArray:!0,params:{action:"employees"}},avatar:{method:"GET",params:{action:"avatar"}}})})}.call(this),function(){this.AutoWorkshopApp.service("addressify",function($http,limitToFilter){return{search:function(term,limit){return null==limit&&(limit=15),$http.jsonp("/addresses/search?callback=JSON_CALLBACK&term="+term).then(function(response){return limitToFilter(response.data,limit)})},parse:function(term){return $http.get("/addresses/parse?term="+term)}}})}.call(this),function(){this.AutoWorkshopApp.service("calculatorService",function(){return{calculate_margin:function(buy,sell){return buy&&sell&&buy>0&&sell>0?(100*((sell-buy)/sell)).round(2):void 0},calculate_margin_from_markup:function(markup){return markup?(100*(markup/(100+markup))).round(2):void 0},calculate_markup_from_margin:function(margin){return margin?(100*(margin/(100-margin))).round(2):void 0}}})}.call(this),function(){this.AutoWorkshopApp.service("confirmationService",function(popoverService){var _this=this;return{init:function(){return _this.confirm=function(message,condition,reverse,position,callback,cancelCallback){return position||(position={left:600,top:200}),condition?(_this.reverse=reverse,_this.message=message,_this.callback=callback,_this.cancelCallback=cancelCallback,$("#ad-confirmation-message").text(message),_this.reverse?$("#ad-confirmation-danger").show():$("#ad-confirmation-success").show(),position.anchor?popoverService.show("#ad-confirmation",position.anchor,{placement:position.placement}):popoverService.show_in_position("#ad-confirmation",position.left,position.top,{placement:"bottom",fixed_position:!0})):callback()}},confirm:function(message,condition,callback,cancelCallback){return _this.confirm(message,condition,!1,void 0,callback,cancelCallback)},danger_confirm:function(message,condition,callback,cancelCallback){return _this.confirm(message,condition,!0,void 0,callback,cancelCallback)},confirm_in_position:function(message,condition,position,callback,cancelCallback){return _this.confirm(message,condition,!1,position,callback,cancelCallback)},message:function(){return _this.message},ok:function(){return popoverService.hide("#ad-confirmation"),_this.callback()},cancel:function(){return _this.cancelCallback&&_this.cancelCallback(),popoverService.hide("#ad-confirmation"),$("#ad-confirmation-message").text(""),_this.callback=void 0,_this.message=void 0,_this.cancelCallback=void 0}}})}.call(this),function(){var __slice=[].slice;this.AutoWorkshopApp.service("lookupService",function(Supplier,Employee,Cost,Stock,JobType,AutoWorkshop,StockCategory,Customer,AccountingAccount,BusinessSource,Session,Invoice,PriceGroup,Vehicle,RoyaltyIntegrationAccount,$http,$cacheFactory,$filter,$window,limitToFilter,spinnerService){var _this=this;return{invoice_items:function(){return _this.invoice_items},session:function(){return _this.session},address:function(){return _this.address},tax_name:function(){return _this.configurations?_this.configurations.tax_name:"Tax"},hide_unpaid_invoices_for_mechanics:function(){return!_this.preferences.hide_unpaid_invoices_for_mechanics||_this.session.is_admin||_this.session.is_staff?void 0:_this.preferences.hide_unpaid_invoices_for_mechanics.value},allow_salesperson_selection_on_pos:function(){return _this.preferences.allow_salesperson_selection_on_pos?_this.preferences.allow_salesperson_selection_on_pos.value:void 0
},follow_up_days:function(){return _this.preferences.follow_up_days?_this.preferences.follow_up_days.value:void 0},default_job_complete_communication:function(){return _this.preferences.default_job_complete_communication?_this.preferences.default_job_complete_communication.value:void 0},configuration:function(name){return _this.configurations?_this.configurations[name]:void 0},tax_registration_name:function(){return _this.configurations?_this.configurations.tax_registration_name:"Tax Registration Number"},business_source_required:function(){return _this.configurations?_this.configurations.business_source_required:void 0},asset_property_set:function(){return _this.configurations?_this.configurations.asset_property_set:{}},restricted_to_process_purchase_orders:function(){return _this.session&&_this.session.restrictions&&_this.session.restrictions.any("process_purchase_orders")},restricted_to_enter_bills:function(){return _this.session&&!_this.session.is_admin&&!_this.session.is_staff},restricted_to_enter_payment:function(){return _this.session&&_this.session.restrictions&&_this.session.restrictions.any("create_payments")},restricted_to_access_all_jobs:function(){return _this.session&&_this.session.restrictions&&_this.session.restrictions.any("access_all_jobs")},restricted_to_create_jobs:function(){return _this.session&&_this.session.restrictions&&_this.session.restrictions.any("create_jobs")},asset_name:function(){return _this.configurations&&_this.configurations.asset_property_set?_this.configurations.asset_property_set.asset_name:""},wof_name:function(){return _this.configurations?_this.configurations.wof_name:"WOF"},quote_types:function(){return _this.quote_types},preferences:function(){return _this.preferences},set_preferences:function(preferences){return preferences.forEach(function(preference){return _this.preferences[preference.name]=preference})},preference:function(name){return _this.preferences&&_this.preferences[name]?_this.preferences[name].value:void 0},rounding:function(){return _this.configurations?_this.configurations.rounding:null},country:function(){return _this.configurations?_this.configurations.country:void 0},enable_undelete:function(){return _this.configurations?_this.configurations.enable_undelete:void 0},royalty_integration_accounts:function(){return _this.royalty_integration_accounts},available_pricing_packages:function(){return _this.available_pricing_packages},save_search_query:function(id,query){return _this.search_queries||(_this.search_queries={}),_this.search_queries[id]=query},search_query:function(id){return _this.search_queries||(_this.search_queries={}),_this.search_queries[id]},set_quote_types:function(values){return _this.quote_types=values},payment_method:function(payment_type){return _this.payment_methods?_this.payment_methods.filter(function(method){return method.value===payment_type})[0]:void 0},customer_price_level_name:function(price_level){return"Sell Price"===_this.configurations["price_level_"+price_level+"_name"]?price_level:_this.configurations["price_level_"+price_level+"_name"]!=="Price Lvl "+price_level?_this.configurations["price_level_"+price_level+"_name"]:price_level},disable_arbitrary_line_items:function(){return _this.configurations&&_this.configurations.disable_arbitrary_line_items},auto_refresh_diary:function(){return _this.configurations&&_this.configurations.auto_refresh_diary},allow_invoice_item_on_timesheet:function(){return _this.configurations&&_this.configurations.allow_invoice_item_on_timesheet},asset_name_plural:function(){return _this.configurations&&_this.configurations.asset_property_set?_this.configurations.asset_property_set.asset_name_plural:""},servicing:function(){var types,yes_or_no;return types=1<=arguments.length?__slice.call(arguments,0):[],yes_or_no=!1,_this.configurations&&_this.configurations.servicings&&types.forEach(function(type){return _this.configurations.servicings.any(type)?yes_or_no=!0:void 0}),yes_or_no},lookup_customers:function(term,spinner){return null==spinner&&(spinner=null),spinner&&spinnerService.start_spinner(spinner,"small"),$http.jsonp("/customers/lookup?limit=100&callback=JSON_CALLBACK&query="+encodeURIComponent(term)).then(function(response){return spinner&&spinnerService.stop_spinner(spinner),limitToFilter(response.data,100)})},lookup_locations:function(term,spinner){return null==spinner&&(spinner=null),spinner&&spinnerService.start_spinner(spinner,"small"),$http.jsonp("/stocks/lookup_locations?limit=100&callback=JSON_CALLBACK&query="+encodeURIComponent(term)).then(function(response){return spinner&&spinnerService.stop_spinner(spinner),limitToFilter(response.data,100)})},lookup_vehicles:function(query,spinner,icon){return null==spinner&&(spinner=null),null==icon&&(icon=null),spinner&&spinnerService.start_spinner(spinner,"small"),$http.jsonp("/vehicles/lookup?limit=100&customer_id="+encodeURIComponent(query.customer.id)+"&callback=JSON_CALLBACK&term="+encodeURIComponent(query.term)).then(function(response){return spinner&&spinnerService.stop_spinner(spinner),icon&&$(icon).show(),response.data})},lookup_jobs:function(query,spinner,icon){return null==spinner&&(spinner=null),null==icon&&(icon=null),spinner&&spinnerService.start_spinner(spinner,"small"),$http.jsonp("/jobs/lookup?limit=100&callback=JSON_CALLBACK&term="+encodeURIComponent(query.term)).then(function(response){return spinner&&spinnerService.stop_spinner(spinner),icon&&$(icon).show(),limitToFilter(response.data,30)})},lookup_suppliers:function(term,spinner,icon){return null==spinner&&(spinner=null),null==icon&&(icon=null),spinner&&spinnerService.start_spinner(spinner,"small"),icon&&$(icon).hide(),$http.jsonp("/suppliers/lookup?limit=100&callback=JSON_CALLBACK&query="+encodeURIComponent(term)).then(function(response){return spinner&&spinnerService.stop_spinner(spinner),icon&&$(icon).show(),limitToFilter(response.data,100)})},lookup_invoice_items:function(term){return _this.configurations.dynamic_stock_lookup?term.length<2||term.length>30?[]:$http.jsonp("/invoices/invoice_items?limit=100&callback=JSON_CALLBACK&term="+encodeURIComponent(term)).then(function(response){var results;return results=response.data.concat($filter("filter")(_this.invoice_items,{lookup_text:term})),limitToFilter(results,100)}):$filter("filter")(_this.invoice_items,{lookup_text:term})},lookup_invoices:function(query,spinner,icon){return null==spinner&&(spinner=null),null==icon&&(icon=null),query.customer_id||(query.customer_id=""),spinner&&spinnerService.start_spinner(spinner,"small"),$http.jsonp("/invoices/lookup?limit=100&callback=JSON_CALLBACK&term="+encodeURIComponent(query.term)+"&customer_id="+encodeURIComponent(query.customer_id)).then(function(response){return spinner&&spinnerService.stop_spinner(spinner),icon&&$(icon).show(),limitToFilter(response.data,30)})},lookup_quotes:function(query,spinner,icon){return null==spinner&&(spinner=null),null==icon&&(icon=null),query.customer_id||(query.customer_id=""),spinner&&spinnerService.start_spinner(spinner,"small"),$http.jsonp("/quotes/lookup?limit=100&callback=JSON_CALLBACK&term="+encodeURIComponent(query.term)+"&customer_id="+encodeURIComponent(query.customer_id)).then(function(response){return spinner&&spinnerService.stop_spinner(spinner),icon&&$(icon).show(),limitToFilter(response.data,30)})},lookup_bills:function(query,spinner,icon){return null==spinner&&(spinner=null),null==icon&&(icon=null),query.supplier_id||(query.supplier_id=""),spinner&&spinnerService.start_spinner(spinner,"small"),$http.jsonp("/bills/lookup?limit=100&callback=JSON_CALLBACK&term="+encodeURIComponent(query.term)+"&supplier_id="+encodeURIComponent(query.supplier_id)).then(function(response){return spinner&&spinnerService.stop_spinner(spinner),icon&&$(icon).show(),limitToFilter(response.data,30)})},lookup_stocks:function(term,spinner,icon){var stocks;return null==spinner&&(spinner=null),null==icon&&(icon=null),_this.configurations.dynamic_stock_lookup?term.length<2||term.length>30?[]:(term=term.substring(0,10),spinner&&spinnerService.start_spinner(spinner,"small"),icon&&$(icon).hide(),$http.jsonp("/invoices/invoice_items?limit=100&callback=JSON_CALLBACK&term="+term).then(function(response){var stocks;return spinner&&spinnerService.stop_spinner(spinner),icon&&$(icon).show(),stocks=response.data.filter(function(i){return i.stock_id}),limitToFilter(stocks,100)})):(stocks=_this.invoice_items.filter(function(i){return i.stock_id}),$filter("filter")(stocks,{lookup_text:term}))},output_accounts:function(){var types;return types=1<=arguments.length?__slice.call(arguments,0):[],_this.filter_accounts("OUTPUT","OUTPUT2","CURRLIAB","REVENUE","OTHERINCOME","LIABILITY","SALES","CURRENT")},inventory_accounts:function(){var types;return types=1<=arguments.length?__slice.call(arguments,0):[],_this.accounting_accounts},input_accounts:function(){var types;return types=1<=arguments.length?__slice.call(arguments,0):[],_this.filter_accounts("INPUT","INPUT2","DIRECTCOSTS","NONCURRENT","OVERHEADS","FIXED","EXPENSE","CURRLIAB","CURRENT")},output_input_accounts:function(){var types;return types=1<=arguments.length?__slice.call(arguments,0):[],_this.filter_accounts("OUTPUT","OUTPUT2","CURRLIAB","REVENUE","OTHERINCOME","LIABILITY","SALES","CURRENT","INPUT","INPUT2","DIRECTCOSTS","NONCURRENT","OVERHEADS","FIXED","EXPENSE","CURRLIAB")},bank_accounts:function(){var types;return types=1<=arguments.length?__slice.call(arguments,0):[],!_this.bank_accounts&&_this.accounting_accounts&&_this.accounting_accounts.length>0&&(_this.bank_accounts=_this.filter_accounts("BANK")),_this.bank_accounts},tags_of_type:function(){var results,types;return types=1<=arguments.length?__slice.call(arguments,0):[],results=[],types.forEach(function(type){return _this.tags?_this.tags.each(function(tag){return tag.owner_type===type?results.push(tag):void 0}):void 0}),results},configurations:function(){return _this.configurations},tyro_account:function(){return _this.tyro_account},payment_express_account:function(){return _this.payment_express_account},repco_account:function(){return _this.repco_account&&_this.repco_account.active?_this.repco_account:void 0},ezy_parts_account:function(){return _this.ezy_parts_account&&_this.ezy_parts_account.active?_this.ezy_parts_account:void 0},autopro_account:function(){return _this.autopro_account&&_this.autopro_account.active?_this.autopro_account:void 0},motospecs_account:function(){return _this.motospecs_account&&_this.motospecs_account.active?_this.motospecs_account:void 0},quantum_account:function(){return _this.quantum_account&&_this.quantum_account.active?_this.quantum_account:void 0},pro_link_account:function(){return _this.pro_link_account&&_this.pro_link_account.active?_this.pro_link_account:void 0},vehicle_look_up_integration_account:function(){return _this.vehicle_look_up_integration_account},vehicle_visual_account:function(){return _this.vehicle_visual_account},set_vehicle_visual_account:function(data){return _this.vehicle_visual_account=data},set_repco_account:function(data){return _this.repco_account=data},set_tyro_account:function(data){return _this.tyro_account=data},set_payment_express_account:function(data){return _this.payment_express_account=data},set_ezy_parts_account:function(data){return _this.ezy_parts_account=data},set_autopro_account:function(data){return _this.autopro_account=data},set_motospecs_account:function(data){return _this.motospecs_account=data},set_quantum_account:function(data){return _this.quantum_account=data},set_pro_link_account:function(data){return _this.pro_link_account=data},set_vehicle_look_up_integration_account:function(data){return _this.vehicle_look_up_integration_account=data},makes:function(){return _this.makes},employees:function(){return _this.employees},tracking_categories:function(){return _this.tracking_categories},courtesy_vehicles:function(){return _this.courtesy_vehicles},assignable_employees:function(refetch){var employees;return employees=[],refetch?_this.fetch_employees(function(){return employees=_this.employees.filter(function(e){return!e.unassignable})}):_this.employees.filter(function(e){return!e.unassignable})},insurers:function(){return _this.insurers},creditors:function(){return _this.creditors},business_sources:function(){return _this.business_sources},price_groups:function(){return _this.price_groups},stock_categories:function(){return _this.stock_categories},accounting_accounts:function(){return _this.accounting_accounts},fetch_royalty_integration_accounts:function(){return _this.fetch_royalty_integration_accounts()},fetch_stock_categories:function(){return _this.fetch_stock_categories()},fetch_accounting_accounts:function(){return _this.fetch_accounting_accounts()},fetch_employees:function(callback){return _this.fetch_employees(callback)},fetch_insurers:function(){return _this.fetch_insurers()},fetch_creditors:function(){return _this.fetch_creditors()},fetch_business_sources:function(){return _this.fetch_business_sources()},fetch_price_groups:function(){return _this.fetch_price_groups()},fetch_configurations:function(){return _this.fetch_configurations()},fetch_invoice_items:function(){return _this.fetch_invoice_items()},fetch_job_types:function(){return _this.fetch_job_types()},fetch_courtesy_vehicles:function(callback){return _this.fetch_courtesy_vehicles(callback)},fetch_tags:function(){return _this.fetch_tags()},fetch_session:function(){return _this.fetch_session()},job_types:function(){return _this.job_types},payment_terms:function(){return _this.payment_terms},address:function(){return _this.address},phone:function(){return _this.phone},email:function(){return _this.email},website:function(){return _this.website},name:function(){return _this.name},payment_types:function(){return[{name:"Cash",value:"cash"},{name:"EFTPOS",value:"debit"},{name:"Bank Transfer",value:"eft"},{name:"Cheque",value:"cheque"},{name:"Credit Card",value:"credit"},{name:"Direct Debit",value:"direct_debit"},{name:"Paypal",value:"paypal"},{name:"Other",value:"unspecified"}]},payment_methods:function(){return _this.payment_methods},pos_payment_methods:function(){return _this.payment_methods&&_this.payment_methods.length>0?_this.payment_methods.filter(function(method){return!method.disabled_on_pos}):void 0},init:function(){return _this.init_data=function(data){return angular.copy(data.configurations,_this.configurations),angular.copy(data.job_types,_this.job_types),angular.copy(data.employees,_this.employees),angular.copy(data.tracking_categories,_this.tracking_categories),angular.copy(data.courtesy_vehicles,_this.courtesy_vehicles),angular.copy(data.insurers,_this.insurers),angular.copy(data.creditors,_this.creditors),angular.copy(data.stock_categories,_this.stock_categories),angular.copy(data.makes,_this.makes),angular.copy(data.payment_terms,_this.payment_terms),angular.copy(data.tags,_this.tags),angular.copy(data.accounting_accounts,_this.accounting_accounts),angular.copy(data.business_sources,_this.business_sources),angular.copy(data.price_groups,_this.price_groups),angular.copy(data.quote_types,_this.quote_types),angular.copy(data.payment_methods,_this.payment_methods),angular.copy(data.royalty_integration_accounts,_this.royalty_integration_accounts),angular.copy(data.available_pricing_packages,_this.available_pricing_packages),angular.copy(data.address,_this.address),_this.email=data.email,_this.phone=data.phone,_this.website=data.website,_this.name=data.name,_this.repco_account=data.repco_account,_this.quantum_account=data.quantum_account,_this.pro_link_account=data.pro_link_account,_this.ezy_parts_account=data.ezy_parts_account,_this.autopro_account=data.autopro_account,_this.motospecs_account=data.motospecs_account,_this.tyro_account=data.tyro_account,_this.payment_express_account=data.payment_express_account,_this.vehicle_look_up_integration_account=data.vehicle_look_up_integration_account,_this.vehicle_visual_account=data.vehicle_visual_account,_this.preferences=data.preferences},_this.store_local=function(data){var err;try{return $window.localStorage.setItem("resources",JSON.stringify(data))}catch(_error){err=_error}},_this.load_local=function(){var err,local_data;try{if(local_data=$window.localStorage.getItem("resources"))return _this.init_data(JSON.parse(local_data))}catch(_error){err=_error}},_this.fetch_data=function(use_local_data){return null==use_local_data&&(use_local_data=!1),"app"===mechanicDeskPage?(_this.configurations||(_this.configurations={}),_this.job_types||(_this.job_types=[]),_this.employees||(_this.employees=[]),_this.insurers||(_this.insurers=[]),_this.creditors||(_this.creditors=[]),_this.makes||(_this.makes=[]),_this.stock_categories||(_this.stock_categories=[]),_this.invoice_items||(_this.invoice_items=[]),_this.payment_terms||(_this.payment_terms=[]),_this.repco_account||(_this.repco_account=null),_this.quantum_account||(_this.quantum_account=null),_this.pro_link_account||(_this.pro_link_account=null),_this.ezy_parts_account||(_this.ezy_parts_account=null),_this.autopro_account||(_this.autopro_account=null),_this.motospecs_account||(_this.motospecs_account=null),_this.vehicle_look_up_integration_account||(_this.vehicle_look_up_integration_account=null),_this.vehicle_visual_account||(_this.vehicle_visual_account=null),_this.accounting_accounts||(_this.accounting_accounts=[]),_this.business_sources||(_this.business_sources=[]),_this.tracking_categories||(_this.tracking_categories=[]),_this.price_groups||(_this.price_groups=[]),_this.courtesy_vehicles||(_this.courtesy_vehicles=[]),_this.tags||(_this.tags=[]),_this.quote_types||(_this.quote_types=["Quote","Estimate"]),_this.payment_methods||(_this.payment_methods=[]),_this.royalty_integration_accounts||(_this.royalty_integration_accounts=[]),_this.available_pricing_packages||(_this.available_pricing_packages=[]),_this.preferences||(_this.preferences={}),_this.address||(_this.address={}),use_local_data&&_this.load_local(),AutoWorkshop.resources(function(data){return _this.init_data(data),_this.store_local(data),_this.fetch_invoice_items()})):void 0},_this.fetch_configurations=function(){return _this.configurations||(_this.configurations={}),AutoWorkshop.configurations(function(data){return angular.copy(data,_this.configurations)})},_this.fetch_tags=function(){return _this.tags||(_this.tags={}),AutoWorkshop.tags(function(data){return angular.copy(data,_this.tags)})},_this.fetch_courtesy_vehicles=function(callback){return _this.courtesy_vehicles||(_this.courtesy_vehicles=[]),Vehicle.courtesy_vehicles(function(data){return angular.copy(data,_this.courtesy_vehicles),callback?callback():void 0})},_this.fetch_job_types=function(){return _this.job_types||(_this.job_types=[]),JobType.all(function(data){return angular.copy(data,_this.job_types)})},_this.fetch_stock_categories=function(){return _this.stock_categories||(_this.stock_categories=[]),StockCategory.all(function(data){return angular.copy(data,_this.stock_categories)})},_this.fetch_accounting_accounts=function(){return _this.accounting_accounts||(_this.accounting_accounts=[]),AccountingAccount.all(function(data){return angular.copy(data,_this.accounting_accounts),_this.bank_accounts=_this.filter_accounts("BANK")})},_this.fetch_employees=function(callback){return _this.employees||(_this.employees=[]),Employee.all(function(data){return angular.copy(data,_this.employees),callback?callback():void 0})},_this.fetch_insurers=function(){return _this.insurers||(_this.insurers=[]),Customer.insurers(function(data){return angular.copy(data,_this.insurers)})},_this.fetch_creditors=function(){return _this.creditors||(_this.creditors=[]),Supplier.creditors(function(data){return angular.copy(data,_this.creditors)})},_this.fetch_business_sources=function(){return _this.business_sources||(_this.business_sources=[]),BusinessSource.all(function(data){return angular.copy(data,_this.business_sources)})},_this.fetch_price_groups=function(){return _this.price_groups||(_this.price_groups=[]),PriceGroup.all(function(data){return angular.copy(data,_this.price_groups)})},_this.fetch_royalty_integration_accounts=function(){return _this.royalty_integration_accounts||(_this.royalty_integration_accounts=[]),RoyaltyIntegrationAccount.all(function(data){return angular.copy(data,_this.royalty_integration_accounts)})},_this.fetch_session=function(){return _this.session||(_this.session={}),Session.current(function(data){return angular.copy(data,_this.session)})},_this.fetch_invoice_items=function(){return _this.invoice_items=[],Cost.all(function(data){return data.each(function(cost){return _this.invoice_items.push({lookup_text:""+cost.description,description:cost.description,name:cost.title,buy_price:cost.unit_price,unit_price:cost.unit_price,included_gst:cost.included_gst,details:cost.details})})}),_this.configurations.dynamic_stock_lookup?void 0:Stock.lookup(function(data){return data.each(function(item){return _this.invoice_items.push({lookup_text:""+(item.stock_number||"")+" "+(item.name||""),description:item.description,name:item.name,details:item.invoice_details,buy_price:item.buy_price,unit_price:item.price,stock_id:item.id,gst_free:item.gst_free,prices:item.prices,price2:item.price2,price3:item.price3,price4:item.price4,price5:item.price5,price6:item.price6,price7:item.price7})})})},_this.filter_accounts=function(){var result,types;return types=1<=arguments.length?__slice.call(arguments,0):[],result=[],_this.accounting_accounts.each(function(account){return types.each(function(type){return account.tax_type!==type&&account.account_type!==type||!account.active?void 0:result.push(account)})}),result.unique()},_this.fetch_data(!0),_this.fetch_session()},vehicle_transmission_types:function(){var car_transmissions,motorcycle_transmissions,results;return car_transmissions=["Manual","Automatic","Semi-automatic","Semi-automatic/Dual Clutch","Semi-automatic/Sequential","CVT"],motorcycle_transmissions=["Reverse gear","Shift Control","Clutch"],results=[],_this.configurations&&_this.configurations.servicings&&(_this.configurations.servicings.any("car")&&car_transmissions.each(function(i){return results.push(i)}),_this.configurations.servicings.any("motocycle")&&motorcycle_transmissions.each(function(i){return results.push(i)})),results},vehicle_drive_types:function(){var car_drive_types,motorcycle_drive_types,results;return car_drive_types=["Front Wheel Drive","Rear Wheel Drive","Four Wheel Drive","Part-time Four Wheel Drive","All Wheel Drive","Part-time All Wheel Drive"],motorcycle_drive_types=["Shaft Drive","Chain Drive","Belt Drive"],results=[],_this.configurations&&_this.configurations.servicings&&(_this.configurations.servicings.any("car")&&car_drive_types.each(function(i){return results.push(i)}),_this.configurations.servicings.any("motocycle")&&motorcycle_drive_types.each(function(i){return results.push(i)})),results},fuel_types:function(){return["91 octane","95 octane","98 octane","E10","E15","E85","E100","CNG","LPG","LNG","Biogas","Diesel","Biodiesel","Electric","Hybrid Electric","Plug-in Hybrid","Propane","Hydrogen","LN2","Methanol","Petrol","Dual Fuel"]},exhaust_systems:function(){return["Twin 2.5","Twin 3","Standard"]},exhaust_headers:function(){return["Twin 2.5","Twin 3","Standard"]},air_intakes:function(){return["Ramjet 1","Ramjet 2","K&N","OTR","POD"]},odometer_units:function(){return["Kms","Miles","Hours"]},vehicle_body_types:function(){var car_body_types,motorcycle_body_types,results;return car_body_types=["Sedan","Hatchback","Wagon","Station Wagon","MUV","SUV","Convertibles","Coupe","Crossover","Van","Ute","Dual Cab Ute","Coupe","4x4","4DR Hatch","Caravan","Camper","Motorhome"],motorcycle_body_types=["Adventure","Chopper","Classic","Commuter","Cruiser","Custom Cruiser","Dual Purpose","Dual Sport","Enduro","Hyper Sport","Mini Bike","Motorcross","Naked","Pitbike","Quad","Quad Sport","Quad Utility","Roadster/Retro","Scooter","Scrambler","Sports","Sports Tourer","Street","Super Bike","Super Moto","Super Sports","Three Wheeler","Tourer","Trials Bike","Other"],results=[],_this.configurations&&_this.configurations.servicings&&(_this.configurations.servicings.any("car")&&car_body_types.each(function(i){return results.push(i)}),_this.configurations.servicings.any("motocycle")&&motorcycle_body_types.each(function(i){return results.push(i)})),results}}})}.call(this),function(){this.AutoWorkshopApp.service("paymentExpressService",function($cookies,$timeout,lookupService,popoverService,timeService,spinnerService,PaymentExpress){var _this=this;return{tid:function(){return _this.tid()},set_tid:function(tid){return _this.payment_express_tid=tid,$cookies.payment_express_tid=tid},enabled:function(){return lookupService.payment_express_account()&&_this.payment_express_tid&&!_this.disabled},disable:function(){return _this.disabled=!0},disabled:function(){return _this.disabled},amount:function(){return _this.amount},enable:function(){return _this.disabled=!1},transaction_status:function(){return _this.transaction_status},display1:function(){return _this.display1},display2:function(){return _this.display2},button1:function(){return _this.button1},button2:function(){return _this.button2},response_code:function(){return _this.response_code},cancel_transaction:function(){return _this.cancel_callback&&_this.cancel_callback(),$timeout.cancel(_this.monitoring_process),_this.close_payment_express()},click_button:function(button,value){return spinnerService.start_spinner("#payment-express-spinner"),_this.button1=void 0,_this.button2=void 0,PaymentExpress.click_button({button:button,value:value,txn_ref:_this.txn_ref},function(){return spinnerService.stop_spinner("#payment-express-spinner")})},init:function(){return _this.close_payment_express=function(){return popoverService.hide("#pos-payment-express-dialogue")},_this.show_payment_express=function(){return popoverService.show_in_position("#pos-payment-express-dialogue",200,100)},_this.tid=function(){return _this.payment_express_tid||(_this.payment_express_tid=$cookies.payment_express_tid)},_this.start_transaction=function(txn_type,amount,success_callback,cancel_callback){return _this.cancel_callback=cancel_callback,_this.amount=amount,_this.display1="Connecting...",_this.display2=void 0,_this.response_code=void 0,_this.show_payment_express(),PaymentExpress.create_transaction({amount:amount,txn_type:txn_type,terminal_id:_this.tid()},function(data){return _this.transaction_status=data.txn_status,_this.display1=data.display1,_this.display2=data.display2,_this.response_code=data.response_code,_this.button1=data.button1,_this.button2=data.button2,_this.txn_ref=data.txn_ref,_this.monitor_transaction(data,success_callback,cancel_callback)})},_this.monitor_transaction=function(transaction,success_callback,cancel_callback){return PaymentExpress.get_transaction({txn_ref:transaction.txn_ref,terminal_id:_this.tid()},function(data){if(_this.transaction_status=data.txn_status,_this.display1=data.display1,_this.display2=data.display2,_this.button1=data.button1,_this.button2=data.button2,_this.response_code=data.response_code,console.log(data),"Transaction Completed"!==data.request_status)return _this.monitoring_process=$timeout(_this.monitor_transaction(transaction,success_callback,cancel_callback),4e3);if(_this.close_payment_express(),$timeout.cancel(_this.monitoring_process),"APPROVED"===data.txn_result){if(success_callback)return success_callback({authorization_number:data.authorization_code,card_number:data.card_number,transaction_ref:data.stan,terminal_brand:"Payment Express",terminal_id:_this.tid(),card_type:data.card_name})}else if(cancel_callback)return cancel_callback()})}},start_purchase_transaction:function(amount,success_callback,cancel_callback){return _this.start_transaction("Purchase",amount,success_callback,cancel_callback)},start_refund_transaction:function(amount,success_callback,cancel_callback){return _this.start_transaction("Refund",amount,success_callback,cancel_callback)},transaction_status:function(){return _this.transaction_status}}})}.call(this),function(){this.AutoWorkshopApp.service("paymentTermService",function(){return{due_date:function(issue_date,payment_term){return"cash"===payment_term?new Date(issue_date.getTime()):"net7"===payment_term?moment(issue_date).add(7,"days").toDate():"net14"===payment_term?moment(issue_date).add(14,"days").toDate():"net15"===payment_term?moment(issue_date).add(15,"days").toDate():"net30"===payment_term?moment(issue_date).add(30,"days").toDate():"net45"===payment_term?moment(issue_date).add(45,"days").toDate():"net60"===payment_term?moment(issue_date).add(60,"days").toDate():"net90"===payment_term?moment(issue_date).add(90,"days").toDate():"eom"===payment_term?moment(issue_date).endOf("month").toDate():"net45eom"===payment_term?moment(issue_date).endOf("month").add(45,"days").toDate():"eonm15"===payment_term?moment(issue_date).add(1,"month").dates(15).toDate():"eonm07"===payment_term?moment(issue_date).add(1,"month").dates(7).toDate():"eonm20"===payment_term?moment(issue_date).add(1,"month").dates(20).toDate():"eonm"===payment_term?moment(issue_date).add(1,"month").endOf("month").toDate():void 0}}})}.call(this),function(){var __slice=[].slice;this.AutoWorkshopApp.service("permissionService",function(lookupService){var _this=this;return{init:function(){return _this.restricted_to=function(){var restricted,restrictions,session;return restrictions=1<=arguments.length?__slice.call(arguments,0):[],session=lookupService.session(),restricted=!1,session&&session.restrictions&&restrictions.forEach(function(r){return session.restrictions.any(r)?restricted=!0:void 0}),restricted},_this.check_restriction_before_proceed=function(restriction,message,callback){return _this.restricted_to(restriction)?alert(message):callback()}},restricted_to_finalize_documents:function(){return _this.restricted_to("finalize_documents")},restricted_to_access_timesheets:function(){return _this.restricted_to("access_timesheets")},restricted_to_edit_stock:function(){return _this.restricted_to("update_inventory")},check_update_inventory_restriction_before_proceed:function(callback){return _this.check_restriction_before_proceed("update_inventory","Your account does not have the required access level to update inventory",callback)},check_deletion_restriction_before_proceed:function(callback){return _this.check_restriction_before_proceed("deletion","Your account does not have the required access level to delete this document",callback)},check_finalize_documents_restriction_before_proceed:function(callback){return _this.check_restriction_before_proceed("finalize_documents","Your account does not have the required access level to finalize financial documents. Please contact your workshop admininstrator to any necessary changes.",callback)},check_update_finalized_documents_restriction_before_proceed:function(callback){var message;return message="Your account does not have the required access level to update finalized financial documents. Please contact your workshop admininstrator to any necessary changes.",_this.restricted_to("finalize_documents","update_finalized_documents")?alert(message):callback()}}})}.call(this),function(){this.AutoWorkshopApp.service("posService",function(Pos){var _this=this;return{parks:function(){return _this.parks||(_this.parks=[])},sales:function(){return _this.sales?_this.sales:(_this.sales=[],Pos.sales(function(data){return angular.copy(data,_this.sales)}))}}})}.call(this),function(){this.AutoWorkshopApp.service("priceGroupService",function(){return{calculate_margin_percentage:function(markup){return markup?(100*(markup/(100+markup))).round(2):void 0},calculate_markup_percentage:function(margin){return margin?(100*(margin/(100-margin))).round(2):void 0}}})}.call(this),function(){this.AutoWorkshopApp.service("recommendationService",function($filter,Customer){return{recommendations:function(search,callback){return Customer.recommendations(search,function(data){return callback(data)})}}})}.call(this),function(){this.AutoWorkshopApp.service("repcoNavigatorService",function($filter,timeService){var _this=this;return{submit_purchase_order:function(purchase,url,account){return _this.purchase=purchase,_this.hooked_url=url,_this.active_repco_account=account,timeService.timeout(function(){return $("#repco-navigator-purchase-order").submit()})},open_smart_quote:function(quote_or_invoice,url,account){return _this.quote_or_invoice=quote_or_invoice,_this.hooked_url=url,_this.active_repco_account=account,_this.section="SQ",timeService.timeout(function(){return $("#repco-navigator-inquiry").submit()})},inquiry:function(url,account){return _this.hooked_url=url,_this.active_repco_account=account,_this.section="PartList",timeService.timeout(function(){return $("#repco-navigator-inquiry").submit()})},purchase:function(){return _this.purchase
},active_repco_account:function(){return _this.active_repco_account},hooked_url:function(){return _this.hooked_url},quote:function(){return _this.quote},section:function(){return _this.section},vehicle:function(){return _this.quote_or_invoice?_this.quote_or_invoice.vehicle:void 0}}})}.call(this),function(){this.AutoWorkshopApp.service("roundingService",function(){return{apply:function(number,rounding){var remaining,rounding_cents,total_cents;return rounding&&0!==rounding?(total_cents=100*number,remaining=total_cents%rounding,0===remaining?0:(rounding_cents=remaining>=rounding/2?rounding-remaining:-remaining,(rounding_cents/100).round(2))):0}}})}.call(this),function(){this.AutoWorkshopApp.service("savedTextsService",function($filter,formService,popoverService,$routeParams,$location,Job,Invoice,Quote,Customer,Purchase,Vehicle){var _this=this;return{show:function(options){return null==options&&(options={}),_this.show(options)},toggle:function(){return $("#saved-texts-popover").children(".popover").is(":visible")?_this.hide():_this.show()},customer:function(){return _this.find_customer()},vehicle:function(){return _this.find_vehicle()},job:function(){return _this.find_job()},quote:function(){return _this.find_quote()},invoice:function(){return _this.find_invoice()},context:function(){return _this.context},attribute:function(){return _this.attribute},subject:function(){return _this.subject},init:function(){return _this.find_job=function(){return _this.job},_this.find_invoice=function(){var _ref;return _this.invoice||(null!=(_ref=_this.find_job())?_ref.invoice:void 0)},_this.find_quote=function(){var _ref;return _this.quote||(null!=(_ref=_this.find_job())?_ref.quote:void 0)},_this.find_customer=function(){var _ref,_ref1,_ref2;return _this.customer||(null!=(_ref=_this.find_job())?_ref.customer:void 0)||(null!=(_ref1=_this.find_invoice())?_ref1.customer:void 0)||(null!=(_ref2=_this.find_quote())?_ref2.customer:void 0)},_this.find_vehicle=function(){var _ref,_ref1,_ref2;return _this.vehicle||(null!=(_ref=_this.find_job())?_ref.vehicle:void 0)||(null!=(_ref1=_this.find_invoice())?_ref1.vehicle:void 0)||(null!=(_ref2=_this.find_quote())?_ref2.vehicle:void 0)},_this.find_missing_objects=function(){return _this.location=$location.path(),!_this.find_job()&&$routeParams.jobId&&Job.get({id:$routeParams.jobId},function(data){return _this.job=data}),!_this.find_invoice()&&$routeParams.invoiceId&&Invoice.get({id:$routeParams.invoiceId},function(data){return _this.invoice=data}),!_this.find_quote()&&$routeParams.quoteId&&Quote.get({id:$routeParams.quoteId},function(data){return _this.quote=data}),!_this.find_customer()&&$routeParams.customerId&&Customer.get({id:$routeParams.customerId},function(data){return _this.customer=data}),!_this.find_vehicle()&&$routeParams.vehicleId?Vehicle.get({id:$routeParams.vehicleId},function(data){return _this.vehicle=data}):void 0},_this.show=function(options){return null==options&&(options={}),_this.customer=options.customer,_this.vehicle=options.vehicle,_this.job=options.job,_this.quote=options.quote,_this.context=options.context,_this.attribute=options.attribute,_this.subject=options.subject,_this.invoice=options.invoice,_this.anchor=options.anchor||"#global-search-input",_this.placement=options.placement||"bottom",_this.find_missing_objects(),popoverService.show("#saved-texts-popover","#global-search-input",{placement:"bottom"}),formService.select_text("#saved-texts-search-input")},_this.hide=function(){return popoverService.hide("#saved-texts-popover")}}}})}.call(this),function(){this.AutoWorkshopApp.service("stockInfoService",function($filter,$timeout,popoverService,spinnerService,Stock){var _this=this;return{stock:function(){return _this.stock||(_this.stock={})},show:function(id,anchor,placement){return null==placement&&(placement="top"),_this.stock||(_this.stock={}),popoverService.show("#stock-info-popover",anchor,{placement:placement}),spinnerService.start_spinner("#stock-info-spinner"),Stock.get({id:id},function(data){return spinnerService.stop_spinner("#stock-info-spinner"),data.id?angular.copy(data,_this.stock):(popoverService.hide("#stock-info-popover"),$timeout(function(){return alert("Could not find the associated item. It might have been deleted")}))})},hide:function(){return angular.copy({},_this.stock),popoverService.hide("#stock-info-popover")}}})}.call(this),function(){this.AutoWorkshopApp.service("tyroService",function(lookupService,popoverService,timeService,spinnerService){var _this=this;return{paired:function(){return _this.tyro_paired},mid:function(){return _this.tyro_mid},tid:function(){return _this.tyro_tid},set_tid:function(tid){return _this.tyro_tid=tid},set_paired:function(paired){return _this.tyro_paired=paired},set_available:function(available){return _this.available=available},available:function(){return _this.available},enabled:function(){return lookupService.tyro_account()&&_this.tyro_paired&&!_this.disabled&&_this.available},disable:function(){return _this.disabled=!0},disabled:function(){return _this.disabled},enable:function(){return _this.disabled=!1},start_purchase_transaction:function(amount,success_callback){return _this.start_transaction("PURCHASE",amount,success_callback)},start_refund_transaction:function(amount,success_callback){return _this.start_transaction("REFUND",amount,success_callback)},iclient:function(){return _this.iclient||init(),_this.iclient},init:function(scope,spinner){var apiKey,posProductInfo;return _this.controller=scope,apiKey="Ib4hwqxZwgGHhGBeMS9BaOTypWLSowBxccQ5",posProductInfo={posProductVendor:"AutodeckPty",posProductName:"MechanicDesk",posProductVersion:"1.0.0"},_this.iclient=new TYRO.IClient(apiKey,posProductInfo),_this.terminal_info=function(response){return _this.available=response&&"success"===response.status?!0:!1,timeService.timeout(function(){return _this.controller.$apply()}),spinner?spinnerService.stop_spinner(spinner):void 0},_this.paired_or_not=function(response){return response.mid&&response.tid?(_this.tyro_mid=response.mid,_this.tyro_tid=response.tid,_this.tyro_integrationKey=response.integrationKey,_this.tyro_paired=!0,spinner&&spinnerService.start_spinner(spinner),_this.iclient.terminalInfo(_this.terminal_info,{mid:_this.tyro_mid,tid:_this.tyro_tid,integrationKey:_this.tyro_integrationKey})):(_this.tyro_paired=!1,timeService.timeout(function(){return _this.controller.$apply()}),spinner?spinnerService.stop_spinner(spinner):void 0)},_this.start_transaction=function(transaction_type,amount,success_callback){var params;return params={amount:amount,cashout:"0",integratedReceipt:!1,enableSurcharge:!1},_this.controller.tyro_initiate_transaction(params,transaction_type,success_callback)},spinner&&spinnerService.start_spinner(spinner),_this.iclient.getConfiguration(_this.paired_or_not),_this.iclient}}})}.call(this),function(){this.AutoWorkshopApp.service("vehicleVisualService",function($filter,formService,popoverService){var _this=this;return{show:function(options){return null==options&&(options={}),_this.show(options)},toggle:function(){return $("#vehicle-visual-popover").children(".popover").is(":visible")?_this.hide():_this.show()},context:function(){return _this.context},attribute:function(){return _this.attribute},init:function(){return _this.show=function(options){return null==options&&(options={}),_this.context=options.context,_this.attribute=options.attribute,popoverService.show("#vehicle-visual-popover",options.anchor||"#global-search-input",{placement:options.placement||"bottom"}),formService.select_text("#vehicle-visual-search-input")},_this.hide=function(){return popoverService.hide("#vehicle-visual-popover")}}}})}.call(this),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("accounting_accounts/index.html",'<div ng-controller="AccountingAccountsController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="page-header"><span>Chart of accounts</span></div></div><br /><div class="row-fluid"><div class="content-box"><table class="table table-striped"><thead><tr><th>Code</th><th>Name</th><th>Type</th><th>Active</th><th style="width: 40%">Description</th></tr></thead><tbody><tr class="pointer" id="accounting-account-{{account.id}}" ng-click="edit(account)" ng-repeat="account in accounting_accounts"><td>{{account.code}}</td><td>{{account.name}}</td><td>{{account.account_type_name}}</td><td>{{account.active|yes_no}}</td><td>{{account.description}}</td></tr></tbody></table></div></div><div id="accounting-account-popover"><div class="popover fade left in" style="width: 550px"><div class="popover-title"><div class="sub-header">Account {{editing_account.name}}</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form class="form-horizontal" name="accounting_account_form" novalidate="true"><div class="control-group"><label class="control-label">Code</label><div class="controls"><input class="input-small" ng-model="editing_account.code" type="text" /><div class="pull-right"><label class="checkbox"><input ng-model="editing_account.active" type="checkbox" /><span>Active</span></label></div></div></div><div class="control-group"><label class="control-label">Name</label><div class="controls"><input class="span12" ng-model="editing_account.name" type="text" /></div></div><div class="control-group"><label class="control-label">Account Type</label><div class="controls"><select class="span12" ng-model="editing_account.account_type" ui-select2="true"><option value="BANK">Bank</option><option value="REVENUE">Revenue</option><option value="OTHERINCOME">Other Income</option><option value="SALES">Sales</option><option value="EXPENSE">Expense</option><option value="INVENTORY">Inventory</option><option value="DEPRECIATN">Depreciation</option><option value="DIRECTCOSTS">Direct Costs</option><option value="OVERHEAD">Overhead</option><option value="EQUITY">Equity</option><option value="CURRLIAB">Current liability</option><option value="LIABILITY">Liability</option><option value="NONCURRLIAB">Non-current liability</option><option value="CURRENT">Current Asset</option><option value="FIXED">Fixed Asset</option><option value="NONCURRENT">Non-current Asset</option><option value="PREPAYMENT">Prepayment</option><option value="RETEARNING">Retained Earnings</option><option value="CURREARNING">Current Earnings</option></select></div></div><div class="control-group" ng-show="editing_account.account_type == &#39;BANK&#39;"><label class="control-label">Account Number</label><div class="controls"><input class="span12" ng-model="editing_account.bank_account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><textarea class="span12" ng-model="editing_account.description"></textarea></div></div><div class="control-group"><label class="control-label">Enable payment to this account</label><div class="controls"><label class="checkbox"><input ng-model="editing_account.receive_payment" type="checkbox" /></label></div></div></form></div><div><button class="btn btn-primary" ng-click="save()">Save</button><button class="btn" ng-click="cancel_edit()">Cancel</button></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/personal/show.html",'<div ng-controller="PersonalDetailsController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="page-header">{{employee.name}}<div class="pull-right"><button class="btn btn-primary" id="change_password_button" ng-click="show_popover(&#39;#change_password&#39;, &#39;#change_password_button&#39;)">Change Password</button></div></div></div><div class="row-fluid"><div class="content-box"><div class="row-fluid"><div class="column span9"><div class="sub-header">Personal Details</div><div class="editable" ng-click="edit()" ng-hide="employee.editing"><div class="info"><span class="label-name">Username:</span><span>{{employee.username}}</span></div><div class="info"><span class="label-name">Full Name:</span><span>{{employee.name}}</span></div><div class="info"><span class="label-name">Email:</span><span>{{employee.email}}</span></div><div class="info"><span class="label-name">Phone:</span><span>{{employee.phone}}</span></div><div class="info"><span class="label-name">Mobile:</span><span>{{employee.mobile}}</span></div><div class="info"><span class="label-name">Address:</span><span>{{employee.address.full_address}}</span></div></div><div class="editing-item" ng-show="employee.editing"><form class="form-horizontal" name="employee_form" novalidate="true"><div class="control-group"><label class="control-label">Username</label><div class="controls"><input class="input-xlarge" name="username" ng-model="employee.editing.username" required="true" type="text" /><span class="error right" ng-show="employee_form.username.$invalid">username is required</span></div></div><div class="control-group"><label class="control-label">Name</label><div class="controls"><input class="input-xlarge" ng-model="employee.editing.name" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input class="input-xlarge" ng-model="employee.editing.email" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input class="input-xlarge" ng-model="employee.editing.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Mobile</label><div class="controls"><input class="input-xlarge" ng-model="employee.editing.mobile" type="text" /></div></div><addresspicker ng-model="employee.editing.address"></addresspicker><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="save()">Save</button><button class="btn" ng-click="cancel_editing()">Cancel</button></div></div></form></div></div><div class="column span3"><div ad-avatar="true" ng-model="employee" title="Avatar" upload-url="&#39;/employees/&#39; + employee.id +&#39;/avatar&#39;" viewer-placement="left"></div></div></div></div></div><div id="change_password"><div class="popover fade left in" style="width: 500px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">Change Password</div></div><div class="popover-content"><div class="row-fluid"><div class="form-horizontal"><div class="control-group"><label class="control-label">Current Password</label><div class="controls"><div class="error">{{change_password.errors.current_password}}</div><input ng-model="change_password.current_password" type="password" /></div></div><div class="control-group"><label class="control-label">New Password</label><div class="controls"><div class="error">{{change_password.errors.password}}</div><input ng-model="change_password.password" type="password" /></div></div><div class="control-group"><label class="control-label">Password Confirmation</label><div class="controls"><div class="error">{{change_password.errors.password_confirmation}}</div><input ng-model="change_password.password_confirmation" type="password" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="save_password()">Save Password</button><button class="btn" ng-click="hide_popover(&#39;#change_password&#39;)">Cancel</button></div></div></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/tabs.html",'<ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/work_types/edit.html",'<div ng-controller="EditWorkTypeController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span3"></div><div class="column span9"><div class="page-header">Edit {{work_type.title}}</div><form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input class="span8" ng-model="work_type.title" type="text" /></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><textarea class="span8" ng-model="work_type.description"></textarea></div></div><div class="control-group"><label></label><div class="controls"><button class="btn btn-primary" ng-click="save_work_type()">Save </button>&nbsp;<button class="btn" ng-click="cancel_edit_work_type()">Cancel</button></div></div></form></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/work_types/new.html",'<div ng-controller="NewWorkTypeController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span3"></div><div class="column span9"><div class="page-header">New Work Type</div><form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input class="span8" ng-model="work_type.title" type="text" /></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><textarea class="span8" ng-model="work_type.description"></textarea></div></div><div class="control-group"><label></label><div class="controls"><button class="btn btn-primary" ng-click="save_new_work()">Save </button>&nbsp;<button class="btn" ng-click="cancel_new_work()">Cancel</button></div></div></form></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/work_types/show.html",'<div ng-controller="ShowWorkTypeController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span3"></div><div class="column span9"><div class="page-header"><span>{{work_type.title}}</span><div class="pull-right"><a class="btn" href="#/work_types/{{work_type.id}}/edit"><i class="icon-pencil"></i><span>Edit</span></a><button class="btn" ng-click="remove()"><i class="icon-remove"></i><span>Delete</span></button></div></div><div>{{work_type.description}}</div><ul class="work-check-list"><li><label>Check list</label></li><li ng-repeat="item in work_type.work_items"><div ng-hide="item.editing"><i class="icon-check">&nbsp;</i><span>{{item.name}}</span><button class="btn btn-link" ng-click="edit_work_item(item)">Edit</button></div><div ng-show="item.editing"><input class="span5" ng-model="item.name" /><button class="btn btn-link" ng-click="remove_work_item(item)"><i class="icon-remove"></i><span>Remove</span></button><button class="btn btn-link" ng-click="save_work_item(item)"><i class="icon-ok"></i><span>Save</span></button><button class="btn btn-link" ng-click="cancel_edit_work_item(item)">Cancel</button></div></li><li><div class="new-work-item" ng-show="new_work_item"><input class="span5" ng-model="new_work_item.name" type="text" /></div></li><li><button class="btn btn-link new" ng-click="create_new_work_item()" ng-hide="new_work_item">New Item</button><div ng-show="new_work_item"><button class="btn btn-primary" ng-click="save_new_work_item()">Save</button>&nbsp;<button class="btn" ng-click="cancel_new_work_item()">Cancel</button></div></li></ul></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/advertise_on_invoice.html",'<div class="sub-header">Advertising on invoice</div><div class="editable" ng-click="auto_workshop.uploading_invoice_ad = true" ng-hide="auto_workshop.uploading_invoice_ad"><span class="warning" ng-hide="auto_workshop.invoice_ad_url">(No invoice ad)</span><div class="inline" ng-show="auto_workshop.invoice_ad_url"><img class="invoice_ad" ng-src="{{auto_workshop.invoice_ad_url}}" style="width: 350px" /></div></div><div class="editing-item" ng-show="auto_workshop.uploading_invoice_ad"><form action="/auto_workshop/invoice_ad" method="POST" ng-upload="upload_invoice_ad(content)" upload-options-enable-rails-csrf="true"><input name="file" type="file" /><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><br /><br /><button class="btn btn-success" ng-disabled="$isLoading" type="submit">Save</button><button class="btn btn-danger" ng-click="delete_invoice_ad($event)" ng-show="auto_workshop.invoice_ad_url" type="button">Delete</button><button class="btn" ng-click="close_invoice_ad_upload($event)" type="button">Cancel</button></form></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/asset_attributes.html",'<div ng-controller="AssetAttributesController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span2"><ul class="nav nav-list side-nav" ng-controller="AutoWorkshopSettingsNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a href="#/{{link.path}}">{{link.name}}</a></li></ul></div><div class="column span10"><div class="spinner" id="asset-property-set-spinner"></div><div class="content-box"><div class="row-fluid"><div class="column span6"><label><span class="inline" style="width: 170px">Service Item:&nbsp;</span><input ng-change="save(&#39;asset_name&#39;, 500)" ng-model="asset_property_set.asset_name" type="text" /></label><label><span class="inline" style="width: 170px">Service Item(plural):&nbsp;</span><input ng-change="save(&#39;asset_name_plural&#39;, 500)" ng-model="asset_property_set.asset_name_plural" type="text" /></label><label class="checkbox"><input ng-change="save(&#39;registration_number&#39;)" ng-model="asset_property_set.registration_number" type="checkbox" />Registration Number</label><label class="checkbox"><input ng-change="save(&#39;fleet_number&#39;)" ng-model="asset_property_set.fleet_number" type="checkbox" />Fleet Number</label><label class="checkbox"><input ng-change="save(&#39;driver_name&#39;)" ng-model="asset_property_set.driver_name" type="checkbox" />Driver Name</label><label class="checkbox"><input ng-change="save(&#39;driver_phone&#39;)" ng-model="asset_property_set.driver_phone" type="checkbox" />Driver Phone</label><label class="checkbox"><input ng-change="save(&#39;driver_email&#39;)" ng-model="asset_property_set.driver_email" type="checkbox" />Driver Email</label><label class="checkbox"><input ng-change="save(&#39;make&#39;)" ng-model="asset_property_set.make" type="checkbox" />Make</label><label class="checkbox"><input ng-change="save(&#39;series&#39;)" ng-model="asset_property_set.series" type="checkbox" />Series</label><label class="checkbox"><input ng-change="save(&#39;model&#39;)" ng-model="asset_property_set.model" type="checkbox" />Model</label><label class="checkbox"><input ng-change="save(&#39;model_code&#39;)" ng-model="asset_property_set.model_code" type="checkbox" />Model Code</label><label class="checkbox"><input ng-change="save(&#39;year&#39;)" ng-model="asset_property_set.year" type="checkbox" />Year</label><label class="checkbox"><input ng-change="save(&#39;color&#39;)" ng-model="asset_property_set.color" type="checkbox" />Color</label><label class="checkbox"><input ng-change="save(&#39;color_code&#39;)" ng-model="asset_property_set.color_code" type="checkbox" />Color Code</label><label class="checkbox"><input ng-change="save(&#39;size&#39;)" ng-model="asset_property_set.size" type="checkbox" />Size</label><label class="checkbox"><input ng-change="save(&#39;body&#39;)" ng-model="asset_property_set.body" type="checkbox" />Body</label><label class="checkbox"><input ng-change="save(&#39;seats&#39;)" ng-model="asset_property_set.seats" type="checkbox" />Number Of Seats</label><label class="checkbox"><input ng-change="save(&#39;doors&#39;)" ng-model="asset_property_set.doors" type="checkbox" />Number Of Doors</label><label class="checkbox"><input ng-change="save(&#39;engine&#39;)" ng-model="asset_property_set.engine" type="checkbox" />Engine</label><label class="checkbox"><input ng-change="save(&#39;vin&#39;)" ng-model="asset_property_set.vin" type="checkbox" />VIN</label><label class="checkbox"><input ng-change="save(&#39;chassis_number&#39;)" ng-model="asset_property_set.chassis_number" type="checkbox" />Chassis Number</label><label class="checkbox"><input ng-change="save(&#39;transmission&#39;)" ng-model="asset_property_set.transmission" type="checkbox" />Transmission</label><label class="checkbox"><input ng-change="save(&#39;battery&#39;)" ng-model="asset_property_set.battery" type="checkbox" />Battery</label><label class="checkbox"><input ng-change="save(&#39;engine_number&#39;)" ng-model="asset_property_set.engine_number" type="checkbox" />Engine Number</label><label class="checkbox"><input ng-change="save(&#39;injector_pump_number&#39;)" ng-model="asset_property_set.injector_pump_number" type="checkbox" />Injector/Pump Number</label><label class="checkbox"><input ng-change="save(&#39;engine_type&#39;)" ng-model="asset_property_set.engine_type" type="checkbox" />Engine Type</label><label class="checkbox"><input ng-change="save(&#39;engine_size&#39;)" ng-model="asset_property_set.engine_size" type="checkbox" />Engine Size</label><label class="checkbox"><input ng-change="save(&#39;horsepower&#39;)" ng-model="asset_property_set.horsepower" type="checkbox" />Horsepower</label><label class="checkbox"><input ng-change="save(&#39;drive_type&#39;)" ng-model="asset_property_set.drive_type" type="checkbox" />Drive Type</label><label class="checkbox"><input ng-change="save(&#39;gears&#39;)" ng-model="asset_property_set.gears" type="checkbox" />Gears</label><label class="checkbox"><input ng-change="save(&#39;cylinders&#39;)" ng-model="asset_property_set.cylinders" type="checkbox" />Cylinders</label><label class="checkbox"><input ng-change="save(&#39;registration_due_date&#39;)" ng-model="asset_property_set.registration_due_date" type="checkbox" />Registration Due Date</label><label class="checkbox"><input ng-change="save(&#39;registration_billing_number&#39;)" ng-model="asset_property_set.registration_billing_number" type="checkbox" />Registration Billing Number</label><label class="checkbox"><input ng-change="save(&#39;fuel_type&#39;)" ng-model="asset_property_set.fuel_type" type="checkbox" />Fuel Type</label><label class="checkbox"><input ng-change="save(&#39;fuel_tank_expiry_date&#39;)" ng-model="asset_property_set.fuel_tank_expiry_date" type="checkbox" />Fuel Tank Expiry Date</label><label class="checkbox"><input ng-change="save(&#39;odometer_unit&#39;)" ng-model="asset_property_set.odometer_unit" type="checkbox" />Odometer Unit</label><label class="checkbox"><input ng-change="save(&#39;exhaust_system&#39;)" ng-model="asset_property_set.exhaust_system" type="checkbox" />Exhaust System</label><label class="checkbox"><input ng-change="save(&#39;exhaust_header&#39;)" ng-model="asset_property_set.exhaust_header" type="checkbox" />Exhaust Header</label><label class="checkbox"><input ng-change="save(&#39;air_intake_system&#39;)" ng-model="asset_property_set.air_intake_system" type="checkbox" />Air Intake System</label><label class="checkbox"><input ng-change="save(&#39;air_filter&#39;)" ng-model="asset_property_set.air_filter" type="checkbox" />Air Filter</label><label class="checkbox"><input ng-change="save(&#39;air_dryer_filter&#39;)" ng-model="asset_property_set.air_dryer_filter" type="checkbox" />Air Dryer Filter</label><label class="checkbox"><input ng-change="save(&#39;oil_filter&#39;)" ng-model="asset_property_set.oil_filter" type="checkbox" />Oil Filter</label><label class="checkbox"><input ng-change="save(&#39;fuel_filter&#39;)" ng-model="asset_property_set.fuel_filter" type="checkbox" />Fuel Filter</label><label class="checkbox"><input ng-change="save(&#39;transmission_filter&#39;)" ng-model="asset_property_set.transmission_filter" type="checkbox" />Transmission Filter</label><label class="checkbox"><input ng-change="save(&#39;pollen_filter&#39;)" ng-model="asset_property_set.pollen_filter" type="checkbox" />Pollen Filter</label><label class="checkbox"><input ng-change="save(&#39;screen_code&#39;)" ng-model="asset_property_set.screen_code" type="checkbox" />Screen Code</label><label class="checkbox"><input ng-change="save(&#39;tyre_size&#39;)" ng-model="asset_property_set.tyre_size" type="checkbox" />Tyre Size</label><label class="checkbox"><input ng-change="save(&#39;radio_code&#39;)" ng-model="asset_property_set.radio_code" type="checkbox" />Radio Code</label><label class="checkbox"><input ng-change="save(&#39;window_tinted&#39;)" ng-model="asset_property_set.window_tinted" type="checkbox" />Window Tinted?</label><label class="checkbox"><input ng-change="save(&#39;key_number&#39;)" ng-model="asset_property_set.key_number" type="checkbox" />Key Number</label><label class="checkbox"><input ng-change="save(&#39;air_conditioning&#39;)" ng-model="asset_property_set.air_conditioning" type="checkbox" />Air Conditioning</label><label class="checkbox"><input ng-change="save(&#39;engine_oil_type&#39;)" ng-model="asset_property_set.engine_oil_type" type="checkbox" />Engine Oil Type</label><label class="checkbox"><input ng-change="save(&#39;engine_oil_quantity&#39;)" ng-model="asset_property_set.engine_oil_quantity" type="checkbox" />Engine Oil Quantity</label><label class="checkbox"><input ng-change="save(&#39;power_steering_oil_type&#39;)" ng-model="asset_property_set.power_steering_oil_type" type="checkbox" />Power Steering Oil Type</label><label class="checkbox"><input ng-change="save(&#39;power_steering_oil_quantity&#39;)" ng-model="asset_property_set.power_steering_oil_quantity" type="checkbox" />Power Steering Oil Quantity</label><label class="checkbox"><input ng-change="save(&#39;spark_plug&#39;)" ng-model="asset_property_set.spark_plug" type="checkbox" />Spark Plug</label><label class="checkbox"><input ng-change="save(&#39;transmission_oil_type&#39;)" ng-model="asset_property_set.transmission_oil_type" type="checkbox" />Transmission Oil Type</label><label class="checkbox"><input ng-change="save(&#39;transmission_oil_quantity&#39;)" ng-model="asset_property_set.transmission_oil_quantity" type="checkbox" />Transmission Oil Quantity</label><label class="checkbox"><input ng-change="save(&#39;transfer_case_oil_type&#39;)" ng-model="asset_property_set.transfer_case_oil_type" type="checkbox" />Transfer Case Oil Type</label><label class="checkbox"><input ng-change="save(&#39;transfer_case_oil_quantity&#39;)" ng-model="asset_property_set.transfer_case_oil_quantity" type="checkbox" />Transfer Case Oil Quantity</label><label class="checkbox"><input ng-change="save(&#39;coolant_type&#39;)" ng-model="asset_property_set.coolant_type" type="checkbox" />Coolant Type</label><label class="checkbox"><input ng-change="save(&#39;coolant_quantity&#39;)" ng-model="asset_property_set.coolant_quantity" type="checkbox" />Coolant Quantity</label><label class="checkbox"><input ng-change="save(&#39;differential_type&#39;)" ng-model="asset_property_set.differential_type" type="checkbox" />Differential Type</label><label class="checkbox"><input ng-change="save(&#39;front_differential_type&#39;)" ng-model="asset_property_set.front_differential_type" type="checkbox" />Front Differential Type</label><label class="checkbox"><input ng-change="save(&#39;front_differential_quantity&#39;)" ng-model="asset_property_set.front_differential_quantity" type="checkbox" />Front Differential Quantity</label><label class="checkbox"><input ng-change="save(&#39;rear_differential_type&#39;)" ng-model="asset_property_set.rear_differential_type" type="checkbox" />Rear Differential Type</label><label class="checkbox"><input ng-change="save(&#39;rear_differential_quantity&#39;)" ng-model="asset_property_set.rear_differential_quantity" type="checkbox" />Rear Differential Quantity</label><label class="checkbox"><input ng-change="save(&#39;obd_location&#39;)" ng-model="asset_property_set.obd_location" type="checkbox" />OBD Location</label><label class="checkbox"><input ng-change="save(&#39;compliance_plate_date&#39;)" ng-model="asset_property_set.compliance_plate_date" type="checkbox" />Compliance Plate Date</label><label class="checkbox"><input ng-change="save(&#39;gvm&#39;)" ng-model="asset_property_set.gvm" type="checkbox" />GVM</label><label class="checkbox"><input ng-change="save(&#39;gcm&#39;)" ng-model="asset_property_set.gcm" type="checkbox" />GCM</label><label class="checkbox"><input ng-change="save(&#39;tare_weight&#39;)" ng-model="asset_property_set.tare_weight" type="checkbox" />Tare Weight</label><label class="checkbox"><input ng-change="save(&#39;axle_code&#39;)" ng-model="asset_property_set.axle_code" type="checkbox" />Axle Code</label><label class="checkbox"><input ng-change="save(&#39;sleeper_air_serial_number&#39;)" ng-model="asset_property_set.sleeper_air_serial_number" type="checkbox" />Sleeper Air Serial No.</label><label class="checkbox"><input ng-change="save(&#39;sleeper_air_engine_serial_number&#39;)" ng-model="asset_property_set.sleeper_air_engine_serial_number" type="checkbox" />Sleeper Air Engine Serial No.</label><label class="checkbox"><input ng-change="save(&#39;sleeper_air_ecm_serial_number&#39;)" ng-model="asset_property_set.sleeper_air_ecm_serial_number" type="checkbox" />Sleeper Air ECM Serial No.</label><label class="checkbox"><input ng-change="save(&#39;sleeper_air_engine_hours&#39;)" ng-model="asset_property_set.sleeper_air_engine_hours" type="checkbox" />Sleeper Air Engine Hours</label></div><div class="column span6"><label class="checkbox"><input ng-change="save(&#39;groupset&#39;)" ng-model="asset_property_set.groupset" type="checkbox" />Groupset</label><label class="checkbox"><input ng-change="save(&#39;wheels&#39;)" ng-model="asset_property_set.wheels" type="checkbox" />Wheels</label><label class="checkbox"><input ng-change="save(&#39;weight&#39;)" ng-model="asset_property_set.weight" type="checkbox" />Weight</label><label class="checkbox"><input ng-change="save(&#39;seat_height&#39;)" ng-model="asset_property_set.seat_height" type="checkbox" />Seat Height</label><label class="checkbox"><input ng-change="save(&#39;bar_height&#39;)" ng-model="asset_property_set.bar_height" type="checkbox" />Bar Height</label><label class="checkbox"><input ng-change="save(&#39;reach&#39;)" ng-model="asset_property_set.reach" type="checkbox" />Reach</label><label class="checkbox"><input ng-change="save(&#39;stem_length&#39;)" ng-model="asset_property_set.stem_length" type="checkbox" />Stem Length</label><label class="checkbox"><input ng-change="save(&#39;crank_length&#39;)" ng-model="asset_property_set.crank_length" type="checkbox" />Crank Length</label><label class="checkbox"><input ng-change="save(&#39;chain_rings&#39;)" ng-model="asset_property_set.chain_rings" type="checkbox" />Chain Rings</label><label class="checkbox"><input ng-change="save(&#39;handlebar_width&#39;)" ng-model="asset_property_set.handlebar_width" type="checkbox" />Handlebar Width</label><hr /><label class="checkbox"><input ng-change="save(&#39;serial_number&#39;)" ng-model="asset_property_set.serial_number" type="checkbox" />Serial Number</label><label class="checkbox"><input ng-change="save(&#39;product_number&#39;)" ng-model="asset_property_set.product_number" type="checkbox" />Product Number</label><label class="checkbox"><input ng-change="save(&#39;warrant&#39;)" ng-model="asset_property_set.warrant" type="checkbox" />Warrant</label><label class="checkbox"><input ng-change="save(&#39;warranty_expiry_date&#39;)" ng-model="asset_property_set.warranty_expiry_date" type="checkbox" />Warranty Expiry Date</label><label class="checkbox"><input ng-change="save(&#39;registration_date&#39;)" ng-model="asset_property_set.registration_date" type="checkbox" />Registration Date</label><label class="checkbox"><input ng-change="save(&#39;asset_type&#39;)" ng-model="asset_property_set.asset_type" type="checkbox" />Type</label><label class="checkbox"><input ng-change="save(&#39;purchase_date&#39;)" ng-model="asset_property_set.purchase_date" type="checkbox" />Purchase Date</label><label class="checkbox"><input ng-change="save(&#39;service_interval&#39;)" ng-model="asset_property_set.service_interval" type="checkbox" />Service Interval</label><label class="checkbox"><input ng-change="save(&#39;machine_hours&#39;)" ng-model="asset_property_set.machine_hours" type="checkbox" />Machine Hours</label><hr /><label class="checkbox"><input ng-change="save(&#39;hydraulic_filter&#39;)" ng-model="asset_property_set.hydraulic_filter" type="checkbox" />Hydraulic Filter</label><label class="checkbox"><input ng-change="save(&#39;oil_filter_element&#39;)" ng-model="asset_property_set.oil_filter_element" type="checkbox" />Oil Filter Element</label><label class="checkbox"><input ng-change="save(&#39;fan_belt&#39;)" ng-model="asset_property_set.fan_belt" type="checkbox" />Fan Belt</label><label class="checkbox"><input ng-change="save(&#39;aircon_belt&#39;)" ng-model="asset_property_set.aircon_belt" type="checkbox" />Aircon Belt</label><label class="checkbox"><input ng-change="save(&#39;airbag_type&#39;)" ng-model="asset_property_set.airbag_type" type="checkbox" />Airbag Type</label><hr /><label class="checkbox"><input ng-change="save(&#39;engine_brand&#39;)" ng-model="asset_property_set.engine_brand" type="checkbox" />Engine Brand</label><label class="checkbox"><input ng-change="save(&#39;engine_model&#39;)" ng-model="asset_property_set.engine_model" type="checkbox" />Engine Model</label><label class="checkbox"><input ng-change="save(&#39;engine_year&#39;)" ng-model="asset_property_set.engine_year" type="checkbox" />Engine Year</label><label class="checkbox"><input ng-change="save(&#39;engine_hours&#39;)" ng-model="asset_property_set.engine_hours" type="checkbox" />Engine Hours</label><label class="checkbox"><input ng-change="save(&#39;engine_data_dot&#39;)" ng-model="asset_property_set.engine_data_dot" type="checkbox" />Engine Data Dot</label><hr /><label class="checkbox"><input ng-change="save(&#39;trailer_brand&#39;)" ng-model="asset_property_set.trailer_brand" type="checkbox" />Trailer Brand</label><label class="checkbox"><input ng-change="save(&#39;trailer_model&#39;)" ng-model="asset_property_set.trailer_model" type="checkbox" />Trailer Model</label><label class="checkbox"><input ng-change="save(&#39;trailer_year&#39;)" ng-model="asset_property_set.trailer_year" type="checkbox" />Trailer Year</label><label class="checkbox"><input ng-change="save(&#39;trailer_serial_number&#39;)" ng-model="asset_property_set.trailer_serial_number" type="checkbox" />Trailer Serial Number</label><label class="checkbox"><input ng-change="save(&#39;trailer_registration_number&#39;)" ng-model="asset_property_set.trailer_registration_number" type="checkbox" />Trailer Registration Number</label><hr /><label class="checkbox"><input ng-change="save(&#39;boat_name&#39;)" ng-model="asset_property_set.boat_name" type="checkbox" />Boat Name</label><label class="checkbox"><input ng-change="save(&#39;location&#39;)" ng-model="asset_property_set.location" type="checkbox" />Location</label><label class="checkbox"><input ng-change="save(&#39;key_location&#39;)" ng-model="asset_property_set.key_location" type="checkbox" />Key Location</label><label class="checkbox"><input ng-change="save(&#39;key_tag&#39;)" ng-model="asset_property_set.key_tag" type="checkbox" />Key Tag</label><label class="checkbox"><input ng-change="save(&#39;starboard_serial_number&#39;)" ng-model="asset_property_set.starboard_serial_number" type="checkbox" />Starboard Serial Number</label><label class="checkbox"><input ng-change="save(&#39;port_serial_number&#39;)" ng-model="asset_property_set.port_serial_number" type="checkbox" />Port Serial Number</label><label class="checkbox"><input ng-change="save(&#39;starboard_engine_hours&#39;)" ng-model="asset_property_set.starboard_engine_hours" type="checkbox" />Starboard Engine Hours</label><label class="checkbox"><input ng-change="save(&#39;port_engine_hours&#39;)" ng-model="asset_property_set.port_engine_hours" type="checkbox" />Port Engine Hours</label><label class="checkbox"><input ng-change="save(&#39;drive_brand&#39;)" ng-model="asset_property_set.drive_brand" type="checkbox" />Drive Brand</label><label class="checkbox"><input ng-change="save(&#39;drive_model&#39;)" ng-model="asset_property_set.drive_model" type="checkbox" />Drive Model</label><label class="checkbox"><input ng-change="save(&#39;inboard_motor&#39;)" ng-model="asset_property_set.inboard_motor" type="checkbox" />Inboard Motor</label><label class="checkbox"><input ng-change="save(&#39;outboard_motor&#39;)" ng-model="asset_property_set.outboard_motor" type="checkbox" />Outboard Motor</label><label class="checkbox"><input ng-change="save(&#39;generator&#39;)" ng-model="asset_property_set.generator" type="checkbox" />Generator</label><label class="checkbox"><input ng-change="save(&#39;impeller&#39;)" ng-model="asset_property_set.impeller" type="checkbox" />Impeller</label><label class="checkbox"><input ng-change="save(&#39;dive_cylinder&#39;)" ng-model="asset_property_set.dive_cylinder" type="checkbox" />Dive Cylinder</label><label class="checkbox"><input ng-change="save(&#39;hire_equipment&#39;)" ng-model="asset_property_set.hire_equipment" type="checkbox" />Hire Equipment</label><label class="checkbox"><input ng-change="save(&#39;dive_certification&#39;)" ng-model="asset_property_set.dive_certification" type="checkbox" />Dive Certification</label><label class="checkbox"><input ng-change="save(&#39;bcd&#39;)" ng-model="asset_property_set.bcd" type="checkbox" />BCD</label><label class="checkbox"><input ng-change="save(&#39;regulator&#39;)" ng-model="asset_property_set.regulator" type="checkbox" />Regulator</label><br /><br /><div class="div bold">Want extra attributes ? Please send us a email at support@mechanicdesk.com.au</div></div></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/auto_workshop_settings_nav.html",'<ul class="nav nav-list side-nav" ng-controller="AutoWorkshopSettingsNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a href="#/{{link.path}}">{{link.name}}</a></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/contact_details.html",'<div class="sub-header">Contact Details</div><div class="editable" ng-click="edit_workshop_contacts()" ng-hide="auto_workshop.editing_contacts"><div class="info"><span class="label-name-left auto-width">Phone:</span><span>{{auto_workshop.phone}}</span></div><div class="info"><span class="label-name-left auto-width">Fax:</span><span>{{auto_workshop.fax}}</span></div><div class="info"><span class="label-name-left auto-width">Address:</span><span>{{auto_workshop.address.full_address}}</span></div><div class="info"><span class="label-name-left auto-width">Website:</span><span>{{auto_workshop.website}}</span></div><div class="info"><span class="label-name-left auto-width">Email:</span><span>{{auto_workshop.email}}</span></div></div><div class="editing-item" ng-show="auto_workshop.editing_contacts"><form class="form-horizontal" name="edit_contact_form" novalidate="true"><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="auto_workshop.editing_contacts.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Fax</label><div class="controls"><input ng-model="auto_workshop.editing_contacts.fax" type="text" /></div></div><addresspicker ng-model="auto_workshop.editing_contacts.address"></addresspicker><div class="control-group"><label class="control-label">Website</label><div class="controls"><input class="input-xlarge" ng-model="auto_workshop.editing_contacts.website" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input class="input-xlarge" ng-model="auto_workshop.editing_contacts.email" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_auto_workshop_contacts()">Save</button><button class="btn" ng-click="cancel(auto_workshop, &#39;editing_contacts&#39;)">Cancel</button></div></div></form></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/invoice_details.html",'<div class="sub-header">Invoices</div><div class="error" ng-show="invoice_resource_number.editing.errors.next_number">{{invoice_resource_number.editing.errors.next_number | error}}</div><div class="row-fluid"><div class="column span5 label-name-left auto-width">Current Invoice Number:</div><div class="column span6"><div class="editable" ng-click="edit_invoice_number()" ng-hide="invoice_resource_number.editing">{{invoice_resource_number.prefix}} {{invoice_resource_number.next_number}}</div></div></div><div class="row-fluid"><div class="column span12"><form class="inline form-inline" ng-show="invoice_resource_number.editing"><input class="input-small" ng-model="invoice_resource_number.editing.next_number" type="text" />&nbsp;<button class="btn btn-success" ng-click="save_invoice_number()">Save</button><button class="btn" ng-click="cancel_edit_invoice_number()">Cancel</button></form></div></div><div class="row-fluid"><div class="column span4 inline label-name-left auto-width">Invoice Footer:</div><div class="column span7"><pre class="editable value-resource-number inline" ng-click="edit_invoice_thank_you_comment()" ng-hide="auto_workshop.editing_invoice_thank_you_comment">{{auto_workshop.invoice_thank_you_comment}}</pre><form class="form-inline" ng-show="auto_workshop.editing_invoice_thank_you_comment"><textarea class="span12" id="editing-invoice-thank-you-comment" ng-model="auto_workshop.editing_invoice_thank_you_comment.invoice_thank_you_comment" rows="5" type="text"></textarea>&nbsp;<br /><button class="btn btn-success" ng-click="save_invoice_thank_you_comment()">Save</button><button class="btn" ng-click="cancel_edit_invoice_thank_you_comment()">Cancel</button></form></div></div><div class="row-fluid"><div class="column span4 inline label-name-left auto-width">Rounding:</div><div class="column span7"><span class="editable value-resource-number inline" ng-click="edit_rounding()" ng-hide="auto_workshop.editing_rounding"><span ng-show="auto_workshop.rounding">{{auto_workshop.rounding}} cents</span><span ng-hide="auto_workshop.rounding">No rounding</span></span><form class="form-inline" ng-show="auto_workshop.editing_rounding"><select class="input-small inline" ng-model="auto_workshop.editing_rounding.rounding"><option value="">No rounding</option><option value="5">5 cents</option><option value="10">10 cents</option></select>&nbsp;<button class="btn btn-success" ng-click="save_rounding()">Save</button><button class="btn" ng-click="cancel_edit_rounding()">Cancel</button></form></div></div><div class="row-fluid"><div class="column span4 label-name-left auto-width">Invoice template:</div><div class="column span7"><span>{{auto_workshop.invoice_template}}</span><span>&nbsp;</span><a ng-click="select_invoice_template()">Select</a></div></div><hr /><div class="row-fluid"><div class="sub-header">Price Markup Percentages</div><div class="editable" ng-click="edit_buyin_markup_percentage()" ng-hide="auto_workshop.editing_buyin_markup_percentage"><div class="row-fluid"><div class="column span4 label-name-left auto-width">Markup Level 1:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage}}%</div></div><div class="row-fluid" ng-show="auto_workshop.buyin_markup_percentage2 &amp;&amp; auto_workshop.buyin_markup_percentage2 &gt; 0"><div class="column span4 label-name-left auto-width">Markup Level 2:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage2}}%</div></div><div class="row-fluid" ng-show="auto_workshop.buyin_markup_percentage3 &amp;&amp; auto_workshop.buyin_markup_percentage3 &gt; 0"><div class="column span4 label-name-left auto-width">Markup Level 3:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage3}}%</div></div><div class="row-fluid" ng-show="auto_workshop.buyin_markup_percentage4 &amp;&amp; auto_workshop.buyin_markup_percentage4 &gt; 0"><div class="column span4 label-name-left auto-width">Markup Level 4:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage4}}%</div></div><div class="row-fluid" ng-show="auto_workshop.buyin_markup_percentage5 &amp;&amp; auto_workshop.buyin_markup_percentage5 &gt; 0"><div class="column span4 label-name-left auto-width">Markup Level 5:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage5}}%</div></div><div class="row-fluid" ng-show="auto_workshop.buyin_markup_percentage6 &amp;&amp; auto_workshop.buyin_markup_percentage6 &gt; 0"><div class="column span4 label-name-left auto-width">Markup Level 6:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage6}}%</div></div><div class="row-fluid" ng-show="auto_workshop.buyin_markup_percentage7 &amp;&amp; auto_workshop.buyin_markup_percentage7 &gt; 0"><div class="column span4 label-name-left auto-width">Markup Level 7:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage7}}%</div></div></div><div ng-show="auto_workshop.editing_buyin_markup_percentage"><form class="form-horizontal" ng-show="auto_workshop.editing_buyin_markup_percentage"><div class="control-group"><label class="control-label">Markup Level 1</label><div class="controls"><div class="input-append" id="editing-buyin-markup-percentage"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div><div class="control-group"><label class="control-label">Markup Level 2</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage2" step="any" type="number"><span class="add-on">%</span></input></div></div></div><div class="control-group"><label class="control-label">Markup Level 3</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage3" step="any" type="number"><span class="add-on">%</span></input></div></div></div><div class="control-group"><label class="control-label">Markup Level 4</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage4" step="any" type="number"><span class="add-on">%</span></input></div></div></div><div class="control-group"><label class="control-label">Markup Level 5</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage5" step="any" type="number"><span class="add-on">%</span></input></div></div></div><div class="control-group"><label class="control-label">Markup Level 6</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage6" step="any" type="number"><span class="add-on">%</span></input></div></div></div><div class="control-group"><label class="control-label">Markup Level 7</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage7" step="any" type="number"><span class="add-on">%</span></input></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_buyin_markup_percentage()">Save</button><button class="btn" ng-click="cancel_edit_buyin_markup_percentage()">Cancel</button></div></div></form></div></div><div class="row-fluid"><div class="pull-right"><div id="select-invoice-template-link"></div><div ad-select-invoice-template="true" anchor-element="#select-invoice-template-link" ng-model="auto_workshop" showing="selecting_invoice_template" templates="invoice_templates"></div></div></div><hr /><div class="row-fluid"><div class="sub-header">Credit Card Payment Surcharge</div><div ng-hide="auto_workshop.surcharge || editing_surcharge"><a href="javascript:void(0);" ng-click="edit_surcharge()">Add surcharge</a></div><div class="editable" ng-click="edit_surcharge()" ng-show="auto_workshop.surcharge &amp;&amp; !editing_surcharge"><div class="row-fluid"><div class="column span4 label-name-left auto-width">Surcharge:</div><div class="column span7">{{auto_workshop.surcharge.charge_percentage}}%</div></div><div class="row-fluid"><div class="column span4 label-name-left auto-width">Account:</div><div class="column span7">{{auto_workshop.surcharge.accounting_account.title}}</div></div></div><div class="editing-item" ng-show="editing_surcharge"><form class="form-horizontal"><div class="control-group"><label class="control-label">Charge</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="editing_surcharge.charge_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div><div class="control-group"><label class="control-label">Account</label><div class="controls"><div accounts="output_accounts" ad-accounting-account-picker="true" ng-model="editing_surcharge.accounting_account_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_surcharge()">Save</button><button class="btn" ng-click="cancel_edit_surcharge()">Cancel</button></div></div></form></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/logo.html",'<div class="sub-header">Logo</div><div class="editable" ng-click="auto_workshop.uploading_logo = true" ng-hide="auto_workshop.uploading_logo"><span class="warning" ng-hide="auto_workshop.logo_url">(No Logo)</span><div class="inline" ng-show="auto_workshop.logo_url"><img class="logo" ng-src="{{auto_workshop.logo_url}}" /></div></div><div class="editing-item" ng-show="auto_workshop.uploading_logo"><form action="/auto_workshop/logo" method="POST" ng-upload="upload_logo(content)" upload-options-enable-rails-csrf="true"><input name="file" type="file" /><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><br /><br /><button class="btn btn-success" ng-disabled="$isLoading" type="submit">Save</button><button class="btn btn-danger" ng-click="delete_logo($event)" ng-show="auto_workshop.logo_url" type="button">Delete</button><button class="btn" ng-click="close_logo_upload($event)" type="button">Cancel</button></form></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/misc.html",'<div ng-controller="MiscController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span2"><ul class="nav nav-list side-nav" ng-controller="AutoWorkshopSettingsNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a href="#/{{link.path}}">{{link.name}}</a></li></ul></div><div class="column span10"><div class="spinner" id="asset-property-set-spinner"></div><div class="content-box"><span class="bold">Note:&nbsp;</span><p>These settings will customize many aspects of your account. We advise that you should only make changes if you understand the effect of the option, or as instructed by MechanicDesk Support Team. If you have any question please seek advise from our Support Team.</p></div><div class="content-box"><div class="row-fluid"><div class="column span6"><div><span class="label-text-left">Quote Title: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;quote_title&#39;)" ng-hide="auto_workshop.editing_quote_title">{{auto_workshop.quote_title}}</span><span ng-show="auto_workshop.editing_quote_title"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_quote_title.quote_title" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;quote_title&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;quote_title&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Price Level 1 Name: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;price_level_1_name&#39;)" ng-hide="auto_workshop.editing_price_level_1_name">{{auto_workshop.price_level_1_name}}</span><span ng-show="auto_workshop.editing_price_level_1_name"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_price_level_1_name.price_level_1_name" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;price_level_1_name&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;price_level_1_name&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Price Level 2 Name: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;price_level_2_name&#39;)" ng-hide="auto_workshop.editing_price_level_2_name">{{auto_workshop.price_level_2_name}}</span><span ng-show="auto_workshop.editing_price_level_2_name"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_price_level_2_name.price_level_2_name" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;price_level_2_name&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;price_level_2_name&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Price Level 3 Name: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;price_level_3_name&#39;)" ng-hide="auto_workshop.editing_price_level_3_name">{{auto_workshop.price_level_3_name}}</span><span ng-show="auto_workshop.editing_price_level_3_name"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_price_level_3_name.price_level_3_name" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;price_level_3_name&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;price_level_3_name&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Price Level 4 Name: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;price_level_4_name&#39;)" ng-hide="auto_workshop.editing_price_level_4_name">{{auto_workshop.price_level_4_name}}</span><span ng-show="auto_workshop.editing_price_level_4_name"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_price_level_4_name.price_level_4_name" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;price_level_4_name&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;price_level_4_name&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Price Level 5 Name: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;price_level_5_name&#39;)" ng-hide="auto_workshop.editing_price_level_5_name">{{auto_workshop.price_level_5_name}}</span><span ng-show="auto_workshop.editing_price_level_5_name"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_price_level_5_name.price_level_5_name" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;price_level_5_name&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;price_level_5_name&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Price Level 6 Name: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;price_level_6_name&#39;)" ng-hide="auto_workshop.editing_price_level_6_name">{{auto_workshop.price_level_6_name}}</span><span ng-show="auto_workshop.editing_price_level_6_name"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_price_level_6_name.price_level_6_name" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;price_level_6_name&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;price_level_6_name&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Price Level 7 Name: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;price_level_7_name&#39;)" ng-hide="auto_workshop.editing_price_level_7_name">{{auto_workshop.price_level_7_name}}</span><span ng-show="auto_workshop.editing_price_level_7_name"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_price_level_7_name.price_level_7_name" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;price_level_7_name&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;price_level_7_name&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Margin Top: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_margin_top&#39;)" ng-hide="auto_workshop.editing_print_margin_top">{{auto_workshop.print_margin_top}}</span><span ng-show="auto_workshop.editing_print_margin_top"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_margin_top.print_margin_top" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_margin_top&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_margin_top&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Margin Bottom: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_margin_bottom&#39;)" ng-hide="auto_workshop.editing_print_margin_bottom">{{auto_workshop.print_margin_bottom}}</span><span ng-show="auto_workshop.editing_print_margin_bottom"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_margin_bottom.print_margin_bottom" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_margin_bottom&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_margin_bottom&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Margin Left: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_margin_left&#39;)" ng-hide="auto_workshop.editing_print_margin_left">{{auto_workshop.print_margin_left}}</span><span ng-show="auto_workshop.editing_print_margin_left"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_margin_left.print_margin_left" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_margin_left&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_margin_left&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Margin Right: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_margin_right&#39;)" ng-hide="auto_workshop.editing_print_margin_right">{{auto_workshop.print_margin_right}}</span><span ng-show="auto_workshop.editing_print_margin_right"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_margin_right.print_margin_right" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_margin_right&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_margin_right&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Quote Price Include Tax: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_quote_price_include_gst&#39;)" ng-hide="auto_workshop.editing_print_quote_price_include_gst">{{auto_workshop.print_quote_price_include_gst|yes_no}}</span><span ng-show="auto_workshop.editing_print_quote_price_include_gst"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_quote_price_include_gst.print_quote_price_include_gst" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_quote_price_include_gst&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_quote_price_include_gst&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Invoice Price Include Tax: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_invoice_price_include_gst&#39;)" ng-hide="auto_workshop.editing_print_invoice_price_include_gst">{{auto_workshop.print_invoice_price_include_gst|yes_no}}</span><span ng-show="auto_workshop.editing_print_invoice_price_include_gst"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_invoice_price_include_gst.print_invoice_price_include_gst" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_invoice_price_include_gst&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_invoice_price_include_gst&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print GST Amount: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_line_gst&#39;)" ng-hide="auto_workshop.editing_print_line_gst">{{auto_workshop.print_line_gst|yes_no}}</span><span ng-show="auto_workshop.editing_print_line_gst"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_line_gst.print_line_gst" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_line_gst&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_line_gst&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Without Stock Number: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_without_stock_number&#39;)" ng-hide="auto_workshop.editing_print_without_stock_number">{{auto_workshop.print_without_stock_number|yes_no}}</span><span ng-show="auto_workshop.editing_print_without_stock_number"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_without_stock_number.print_without_stock_number" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_without_stock_number&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_without_stock_number&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Fit more on invoice: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;no_template_header&#39;)" ng-hide="auto_workshop.editing_no_template_header">{{auto_workshop.no_template_header|yes_no}}</span><span ng-show="auto_workshop.editing_no_template_header"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_no_template_header.no_template_header" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;no_template_header&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;no_template_header&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Use large logo: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;use_large_logo&#39;)" ng-hide="auto_workshop.editing_use_large_logo">{{auto_workshop.use_large_logo|yes_no}}</span><span ng-show="auto_workshop.editing_use_large_logo"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_use_large_logo.use_large_logo" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;use_large_logo&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;use_large_logo&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Use full size logo: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;use_full_size_logo&#39;)" ng-hide="auto_workshop.editing_use_full_size_logo">{{auto_workshop.use_full_size_logo|yes_no}}</span><span ng-show="auto_workshop.editing_use_full_size_logo"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_use_full_size_logo.use_full_size_logo" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;use_full_size_logo&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;use_full_size_logo&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Calculate Aging Debtors By Invoice Due Date: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;aged_debtor_by_due_date&#39;)" ng-hide="auto_workshop.editing_aged_debtor_by_due_date">{{auto_workshop.aged_debtor_by_due_date|yes_no}}</span><span ng-show="auto_workshop.editing_aged_debtor_by_due_date"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_aged_debtor_by_due_date.aged_debtor_by_due_date" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;aged_debtor_by_due_date&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;aged_debtor_by_due_date&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Unit Price Two Decimal: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_unit_price_two_decimal&#39;)" ng-hide="auto_workshop.editing_print_unit_price_two_decimal">{{auto_workshop.print_unit_price_two_decimal|yes_no}}</span><span ng-show="auto_workshop.editing_print_unit_price_two_decimal"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_unit_price_two_decimal.print_unit_price_two_decimal" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_unit_price_two_decimal&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_unit_price_two_decimal&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Workshop Name When Send SMS: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;sms_name&#39;)" ng-hide="auto_workshop.editing_sms_name">{{auto_workshop.sms_name}}</span><span ng-show="auto_workshop.editing_sms_name"><form class="inline form-inline"><input class="input" maxlength="11" ng-model="auto_workshop.editing_sms_name.sms_name" type="text" /><span>&nbsp;(maximum 11 characters)</span><div><button class="btn btn-inline btn-success" ng-click="save(&#39;sms_name&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;sms_name&#39;)">Cancel</button></div></form></span></div><div><span class="label-text-left">Automatic Price Update: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;automatic_price_update&#39;)" ng-hide="auto_workshop.editing_automatic_price_update">{{auto_workshop.automatic_price_update|yes_no}}</span><span ng-show="auto_workshop.editing_automatic_price_update"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_automatic_price_update.automatic_price_update" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;automatic_price_update&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;automatic_price_update&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Automatic Cost Update: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;automatic_cost_update&#39;)" ng-hide="auto_workshop.editing_automatic_cost_update">{{auto_workshop.automatic_cost_update|yes_no}}</span><span ng-show="auto_workshop.editing_automatic_cost_update"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_automatic_cost_update.automatic_cost_update" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;automatic_cost_update&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;automatic_cost_update&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Set Invoice Issue Date At Finalization: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;issue_date_at_finalization&#39;)" ng-hide="auto_workshop.editing_issue_date_at_finalization">{{auto_workshop.issue_date_at_finalization|yes_no}}</span><span ng-show="auto_workshop.editing_issue_date_at_finalization"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_issue_date_at_finalization.issue_date_at_finalization" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;issue_date_at_finalization&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;issue_date_at_finalization&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Disable Item Price On Purchase Order: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;disable_purchase_order_item_price&#39;)" ng-hide="auto_workshop.editing_disable_purchase_order_item_price">{{auto_workshop.disable_purchase_order_item_price|yes_no}}</span><span ng-show="auto_workshop.editing_disable_purchase_order_item_price"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_disable_purchase_order_item_price.disable_purchase_order_item_price" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;disable_purchase_order_item_price&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;disable_purchase_order_item_price&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Default Customer Payment Term: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;default_payment_term&#39;)" ng-hide="auto_workshop.editing_default_payment_term">{{auto_workshop.default_payment_term_name}}</span><span ng-show="auto_workshop.editing_default_payment_term"><form class="inline form-inline"><select ng-model="auto_workshop.editing_default_payment_term.default_payment_term" ng-options="payment_term.value as payment_term.name for payment_term in payment_terms" type="text"></select><button class="btn btn-inline btn-success" ng-click="save(&#39;default_payment_term&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;default_payment_term&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Default Supplier Payment Term: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;default_supplier_payment_term&#39;)" ng-hide="auto_workshop.editing_default_supplier_payment_term">{{auto_workshop.default_supplier_payment_term_name}}</span><span ng-show="auto_workshop.editing_default_supplier_payment_term"><form class="inline form-inline"><select ng-model="auto_workshop.editing_default_supplier_payment_term.default_supplier_payment_term" ng-options="payment_term.value as payment_term.name for payment_term in payment_terms" type="text"></select><button class="btn btn-inline btn-success" ng-click="save(&#39;default_supplier_payment_term&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;default_supplier_payment_term&#39;)">Cancel</button></form></span></div></div><div class="column span6"><div><span class="label-text-left">Show payments on invoice: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;show_payments_on_invoices&#39;)" ng-hide="auto_workshop.editing_show_payments_on_invoices">{{auto_workshop.show_payments_on_invoices|yes_no}}</span><span ng-show="auto_workshop.editing_show_payments_on_invoices"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_show_payments_on_invoices.show_payments_on_invoices" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;show_payments_on_invoices&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;show_payments_on_invoices&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Default Odometer Unit: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;default_odometer_unit&#39;)" ng-hide="auto_workshop.editing_default_odometer_unit">{{auto_workshop.default_odometer_unit}}</span><span ng-show="auto_workshop.editing_default_odometer_unit"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_default_odometer_unit.default_odometer_unit" type="text" /><button class="btn btn-inline btn-success" ng-click="save(&#39;default_odometer_unit&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;default_odometer_unit&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Invoice Header Item Total: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_price_on_header_item&#39;)" ng-hide="auto_workshop.editing_print_price_on_header_item">{{auto_workshop.print_price_on_header_item|yes_no}}</span><span ng-show="auto_workshop.editing_print_price_on_header_item"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_price_on_header_item.print_price_on_header_item" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_price_on_header_item&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_price_on_header_item&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Use Workshop Name On Job Card(No logo): &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_job_card_name_only&#39;)" ng-hide="auto_workshop.editing_print_job_card_name_only">{{auto_workshop.print_job_card_name_only|yes_no}}</span><span ng-show="auto_workshop.editing_print_job_card_name_only"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_job_card_name_only.print_job_card_name_only" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_job_card_name_only&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_job_card_name_only&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Payment Term On Invoice: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_with_payment_term&#39;)" ng-hide="auto_workshop.editing_print_with_payment_term">{{auto_workshop.print_with_payment_term|yes_no}}</span><span ng-show="auto_workshop.editing_print_with_payment_term"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_with_payment_term.print_with_payment_term" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_with_payment_term&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_with_payment_term&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Hide Invoice Item With Zero Total: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_hide_item_with_zero_price&#39;)" ng-hide="auto_workshop.editing_print_hide_item_with_zero_price">{{auto_workshop.print_hide_item_with_zero_price|yes_no}}</span><span ng-show="auto_workshop.editing_print_hide_item_with_zero_price"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_hide_item_with_zero_price.print_hide_item_with_zero_price" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_hide_item_with_zero_price&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_hide_item_with_zero_price&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Show Customer Number On Invoice And Statement: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_show_customer_number&#39;)" ng-hide="auto_workshop.editing_print_show_customer_number">{{auto_workshop.print_show_customer_number|yes_no}}</span><span ng-show="auto_workshop.editing_print_show_customer_number"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_show_customer_number.print_show_customer_number" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_show_customer_number&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_show_customer_number&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Do Not Print Invoice Description On Statement: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_hide_description&#39;)" ng-hide="auto_workshop.editing_print_hide_description">{{auto_workshop.print_hide_description|yes_no}}</span><span ng-show="auto_workshop.editing_print_hide_description"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_hide_description.print_hide_description" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_hide_description&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_hide_description&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Timesheet Details On Job Card: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_timesheet&#39;)" ng-hide="auto_workshop.editing_print_timesheet">{{auto_workshop.print_timesheet|yes_no}}</span><span ng-show="auto_workshop.editing_print_timesheet"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_timesheet.print_timesheet" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_timesheet&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_timesheet&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Job Start Date On Invoice: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_job_start_date&#39;)" ng-hide="auto_workshop.editing_print_job_start_date">{{auto_workshop.print_job_start_date|yes_no}}</span><span ng-show="auto_workshop.editing_print_job_start_date"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_job_start_date.print_job_start_date" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_job_start_date&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_job_start_date&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Use Letter Head: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_use_letter_head&#39;)" ng-hide="auto_workshop.editing_print_use_letter_head">{{auto_workshop.print_use_letter_head|yes_no}}</span><span ng-show="auto_workshop.editing_print_use_letter_head"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_use_letter_head.print_use_letter_head" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_use_letter_head&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_use_letter_head&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Do Not Print Invoice Details: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_without_invoice_details&#39;)" ng-hide="auto_workshop.editing_print_without_invoice_details">{{auto_workshop.print_without_invoice_details|yes_no}}</span><span ng-show="auto_workshop.editing_print_without_invoice_details"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_without_invoice_details.print_without_invoice_details" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_without_invoice_details&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_without_invoice_details&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Print Customer Address On Job Card: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;print_customer_address_on_job_card&#39;)" ng-hide="auto_workshop.editing_print_customer_address_on_job_card">{{auto_workshop.print_customer_address_on_job_card|yes_no}}</span><span ng-show="auto_workshop.editing_print_customer_address_on_job_card"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_print_customer_address_on_job_card.print_customer_address_on_job_card" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;print_customer_address_on_job_card&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;print_customer_address_on_job_card&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Disable {{wof_name()}} (New Zealand, United Kingdom only): &nbsp;</span><span class="bold editable" ng-click="edit(&#39;no_wof&#39;)" ng-hide="auto_workshop.editing_no_wof">{{auto_workshop.no_wof|yes_no}}</span><span ng-show="auto_workshop.editing_no_wof"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_no_wof.no_wof" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;no_wof&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;no_wof&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Default Diary View: &nbsp;</span><span class="bold editable" ng-click="edit(&#39;default_diary_view&#39;)" ng-hide="auto_workshop.editing_default_diary_view">{{auto_workshop.default_diary_view_name}}</span><span ng-show="auto_workshop.editing_default_diary_view"><form class="inline form-inline"><select ng-model="auto_workshop.editing_default_diary_view.default_diary_view" type="text"><option value="resourceDay">Day</option><option value="basicWeek">Week</option><option value="month">Month</option></select><button class="btn btn-inline btn-success" ng-click="save(&#39;default_diary_view&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;default_diary_view&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Hide Finished Jobs On Diary By Default &nbsp;</span><span class="bold editable" ng-click="edit(&#39;hide_finished_job_on_diary_by_default&#39;)" ng-hide="auto_workshop.editing_hide_finished_job_on_diary_by_default">{{auto_workshop.hide_finished_job_on_diary_by_default|yes_no}}</span><span ng-show="auto_workshop.editing_hide_finished_job_on_diary_by_default"><form class="inline form-inline"><input class="input" ng-model="auto_workshop.editing_hide_finished_job_on_diary_by_default.hide_finished_job_on_diary_by_default" type="checkbox" /><button class="btn btn-inline btn-success" ng-click="save(&#39;hide_finished_job_on_diary_by_default&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;hide_finished_job_on_diary_by_default&#39;)">Cancel</button></form></span></div><div><span class="label-text-left">Default Booking Time &nbsp;</span><span class="bold editable" ng-click="edit(&#39;default_booking_time&#39;)" ng-hide="auto_workshop.editing_default_booking_time"><span ng-show="auto_workshop.default_booking_time">{{auto_workshop.default_booking_time|date: \'shortTime\'}}</span><span ng-hide="auto_workshop.default_booking_time">(Not Available)</span></span><span ng-show="auto_workshop.editing_default_booking_time"><form class="inline form-inline"><ad-timepicker error="top" ng-model="auto_workshop.editing_default_booking_time.default_booking_time"></ad-timepicker><button class="btn btn-inline btn-success" ng-click="save(&#39;default_booking_time&#39;)">Save</button><button class="btn" ng-click="cancel_edit(&#39;default_booking_time&#39;)">Cancel</button></form></span></div></div></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/numbering.html",'<div ng-controller="NumberingController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span2"><ul class="nav nav-list side-nav" ng-controller="AutoWorkshopSettingsNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a href="#/{{link.path}}">{{link.name}}</a></li></ul></div><div class="column span5" ng-show="fetched"><div class="row-fluid" ng-repeat="resource_number_type in resource_number_types_left"><div class="well"><div class="column span4"><div class="sub-header">{{resource_number_type}}</div></div><div class="column span8"><div class="editable" ng-click="edit_resource_number(resource_number_type)" ng-hide="resource_number_list[resource_number_type].editing"><div><span class="label-left-auto-width">Prefix: &nbsp;</span><span>{{resource_number_list[resource_number_type].prefix}}</span></div><div><span class="label-left-auto-width">Next Number: &nbsp;</span><span>{{resource_number_list[resource_number_type].next_number}}</span></div></div><form ng-show="resource_number_list[resource_number_type].editing"><div><div class="inline" style="width: 100px">Prefix: &nbsp;</div><input class="input input-small" ng-model="resource_number_list[resource_number_type].editing.prefix" type="text" /></div><div><div class="inline" style="width: 100px">Next Number: &nbsp;</div><input class="input input-small" ng-model="resource_number_list[resource_number_type].editing.next_number" type="text" /></div><div><div class="inline" style="width: 100px"></div><button class="btn btn-success" ng-click="save_resource_number(resource_number_type)">Save</button><button class="btn" ng-click="cancel_edit_resource_number(resource_number_type)">Cancel</button></div></form></div><div class="row-fluid"><div class="column span12"><div ng-show="error_message" style="color: red">{{error_message[resource_number_type]}} </div></div></div></div></div></div><div class="column span5" ng-show="fetched"><div class="row-fluid" ng-repeat="resource_number_type in resource_number_types_right"><div class="well"><div class="column span4"><div class="sub-header">{{resource_number_type}}</div></div><div class="column span8"><div class="editable" ng-click="edit_resource_number(resource_number_type)" ng-hide="resource_number_list[resource_number_type].editing"><div><span class="label-left-auto-width">Prefix: &nbsp;</span><span>{{resource_number_list[resource_number_type].prefix}}</span></div><div><span class="label-left-auto-width">Next Number: &nbsp;</span><span>{{resource_number_list[resource_number_type].next_number}}</span></div></div><form ng-show="resource_number_list[resource_number_type].editing"><div><div class="inline" style="width: 100px">Prefix: &nbsp;</div><input class="input input-small" ng-model="resource_number_list[resource_number_type].editing.prefix" type="text" /></div><div><div class="inline" style="width: 100px">Next Number: &nbsp;</div><input class="input input-small" ng-model="resource_number_list[resource_number_type].editing.next_number" type="text" /></div><div><div class="inline" style="width: 100px"></div><button class="btn btn-success" ng-click="save_resource_number(resource_number_type)">Save</button><button class="btn" ng-click="cancel_edit_resource_number(resource_number_type)">Cancel</button></div></form></div><div class="row-fluid"><div class="column span12"><div ng-show="error_message" style="color: red">{{error_message[resource_number_type]}} </div></div></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/online_booking.html",'<div ng-controller="OnlineBookingController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span2"><ul class="nav nav-list side-nav" ng-controller="AutoWorkshopSettingsNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a href="#/{{link.path}}">{{link.name}}</a></li></ul></div><div class="column span10"><div class="content-box"><div ng-show="enabled()"><div class="bold">Please put this code snippet on your website for online booking. You can adjust the size of the iframe as you wish, please talk to your website developer for more details.</div><br /><pre>{{url()}}</pre><br /><div>Note: You can also build your own online booking form and use our online booking API to submit the booking request. Please talk to our support team for more details.</div><br /><br /><div class="sub-header">Notification & Confirmation</div><div class="editable" ng-click="edit_online_booking()" ng-hide="editing_online_booking"><div>Online Booking Notification: {{booking_notification() | yes_no}}</div><div>Notification Sent To: {{booking_notification_to() | na}}</div><div>Send Booking Confirmation By: {{booking_confirmation_by()| na}}</div></div><div ng-show="editing_online_booking"><form class="form-horizontal"><div class="control-group"><label class="control-label"><div>Send Notificaton By</div></label><div class="controls"><select ng-model="editing_online_booking.online_booking_notification_by"><option value="email">Email</option><option value="sms">SMS</option></select></div></div><div class="control-group" ng-show="editing_online_booking.online_booking_notification_by == &#39;email&#39;"><label class="control-label"><div>Email</div></label><div class="controls"><input ng-model="editing_online_booking.online_booking_notification_email" type="text" /></div></div><div class="control-group" ng-show="editing_online_booking.online_booking_notification_by == &#39;sms&#39;"><label class="control-label"><div>Mobile Number</div></label><div class="controls"><input ng-model="editing_online_booking.online_booking_notification_number" type="text" /></div></div><div class="control-group"><label class="control-label"><div>Send Booking Confirmation By</div></label><div class="controls"><select ng-model="editing_online_booking.online_booking_confirmation_by"><option value="email_then_sms">Try Email, Then SMS</option><option value="sms_then_email">Try SMS, Then Email</option><option value="email">Email Only</option><option value="sms">SMS Only</option><option value="email_and_sms">Both Email and SMS</option></select></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_online_booking()">Save</button><button class="btn" ng-click="cancel_online_booking()">Cancel</button></div></div></form></div></div><div ng-hide="enabled()"><div>To Enable Online Booking, please click on the button bellow</div><br /><br /><button class="btn btn-primary" ng-click="enable()">Enable Online Booking</button></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/pricing_plans.html",'<div class="sub-header"><span id="current-pricing-plan">Current Pricing Plan</span></div><div class="bold" ng-hide="subscription_notification_code() == &#39;trial_expired&#39;"><br /><div>Free Trial until {{auto_workshop.trial_expired_at|date: \'mediumDate\'}}</div><br /></div><div class="pull-right"><button class="btn btn-primary" id="change-pricing-plan-button" ng-click="change_plan()" style="width: 100px">Select Plan</button><br /><br /><button class="btn" id="update-card-button" ng-click="update_card_details()" ng-show="auto_workshop.credit_card" style="width: 100px">Update Card</button></div><div ng-show="auto_workshop.pricing_plan"><div class="row-fluid"><div class="bold">{{auto_workshop.pricing_plan.name}}</div><div class="info"><span class="label-name pricing-plan-info">Subscription Price:</span><span ng-bind-html-unsafe="auto_workshop.pricing_plan.display_subscription_price"></span></div><div class="info"><span class="label-name pricing-plan-info">SMS Price:</span><span ng-bind-html-unsafe="auto_workshop.pricing_plan.display_sms_price"></span></div><div class="info" ng-show="auto_workshop.pricing_plan.payment_frequency"><span class="label-name pricing-plan-info">Billing Cycle:</span><span>{{auto_workshop.pricing_plan.payment_frequency}} month(s)</span></div><div class="info" ng-show="auto_workshop.pricing_plan.number_of_users_allowed"><span class="label-name pricing-plan-info">Users/Employees:</span><span ng-bind-html-unsafe="auto_workshop.pricing_plan.number_of_users_allowed"></span></div><div class="info" ng-show="auto_workshop.pricing_plan.discount_employee &gt; 0"><span class="label-name pricing-plan-info">Additional Employees (Discounted):</span><span ng-bind-html-unsafe="auto_workshop.pricing_plan.discount_employee"></span></div><div class="info" ng-show="auto_workshop.pricing_plan.additional_user_price"><span class="label-name pricing-plan-info">Additional Employee:</span><span ng-bind-html-unsafe="auto_workshop.pricing_plan.display_additional_user_price"></span></div><div class="info" ng-show="auto_workshop.pricing_plan.end_at"><span class="label-name pricing-plan-info">Plan end date:</span><span>{{auto_workshop.pricing_plan.end_at|date: \'mediumDate\'}}</span></div><div class="info" ng-show="auto_workshop.pricing_plan.template_customization_included"><span class="label-name pricing-plan-info">Template Customization:</span><span ng-bind-html-unsafe="auto_workshop.pricing_plan.display_template_customization_price"></span></div><div class="info" ng-show="auto_workshop.credit &gt; 0"><span class="label-name pricing-plan-info green">Credit:</span><span class="green">{{auto_workshop.credit}}</span></div></div></div><div ad-pricing-plan="true" anchor-element="#change-pricing-plan-button" ng-model="auto_workshop" placement="top" showing="show_pricing_plan"></div><br /><br /><div class="sub-header">Plan Bills</div><div class="label label-warning" ng-show="subscription_notification_code() == &#39;unpaid_bill&#39;">{{subscription_notification()}}</div><div class="row-fluid" ng-show="auto_workshop.mechanic_desk_invoices.length &gt; 0"><table class="table table-striped"><thead><th>Issue Date</th><th>Description</th><th>Total Amount</th><th>Due Date</th><th>Status</th><th class="actions"></th></thead><tbody><tr ng-repeat="invoice in auto_workshop.mechanic_desk_invoices"><td>{{invoice.created_at | date: \'mediumDate\'}}</td><td>{{invoice.description}}</td><td>${{invoice.total_amount}}</td><td>{{invoice.due_date | date: \'mediumDate\'}}</td><td><span class="label label-success" ng-show="invoice.charged_at">Paid</span><span class="label label" ng-show="!invoice.due &amp;&amp; !invoice.charged_at">Unpaid</span><span class="label label-warning" ng-show="invoice.due">Unpaid</span></td><td class="actions"><a ng-href="/mechanic_desk_invoices/{{invoice.id}}.pdf" target="_blank">View</a><span>&nbsp; &nbsp;</span><a href="javascript:void(0);" id="pay-invoice-{{invoice.id}}" ng-click="pay(invoice)" ng-hide="invoice.charged">Pay</a></td></tr></tbody></table></div><div ng-hide="auto_workshop.mechanic_desk_invoices.length &gt; 0"><span>(No invoices)</span></div><div ad-input-credit-card="true" anchor-element="#current-pricing-plan" auto-workshop="auto_workshop" invoice="paying_invoice" on-paying="update_auto_workshop()" placement="right" showing="paying" title="paying_title"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/quote_details.html",'<div class="sub-header">Quotes</div><div class="row-fluid"><div class="column span4 inline label-name-left auto-width">Quote Footer:</div><div class="column span7"><pre class="editable value-resource-number inline" ng-click="edit_quote_footer()" ng-hide="auto_workshop.editing_quote_footer">{{auto_workshop.quote_footer}}</pre><form class="form-inline" ng-show="auto_workshop.editing_quote_footer"><textarea class="span12" id="editing-quote-footer" ng-model="auto_workshop.editing_quote_footer.quote_footer" rows="5" type="text"></textarea>&nbsp;<br /><button class="btn btn-success" ng-click="save_quote_footer()">Save</button><button class="btn" ng-click="cancel_edit_quote_footer()">Cancel</button></form></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/show.html",'<div ng-controller="AutoWorkshopDetailsController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span2"><ul class="nav nav-list side-nav" ng-controller="AutoWorkshopSettingsNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a href="#/{{link.path}}">{{link.name}}</a></li></ul></div><div class="column span10"><div class="row-fluid"><div class="page-header"><span id="workshop-detail-page-header">{{auto_workshop.name}}</span></div></div><div class="row-fluid"><div class="span7"><div class="content-box auto-workshop-details"><div class="sub-header">Logo</div><div class="editable" ng-click="auto_workshop.uploading_logo = true" ng-hide="auto_workshop.uploading_logo"><span class="warning" ng-hide="auto_workshop.logo_url">(No Logo)</span><div class="inline" ng-show="auto_workshop.logo_url"><img class="logo" ng-src="{{auto_workshop.logo_url}}" /></div></div><div class="editing-item" ng-show="auto_workshop.uploading_logo"><form action="/auto_workshop/logo" method="POST" ng-upload="upload_logo(content)" upload-options-enable-rails-csrf="true"><input name="file" type="file" /><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><br /><br /><button class="btn btn-success" ng-disabled="$isLoading" type="submit">Save</button><button class="btn btn-danger" ng-click="delete_logo($event)" ng-show="auto_workshop.logo_url" type="button">Delete</button><button class="btn" ng-click="close_logo_upload($event)" type="button">Cancel</button></form></div><br /><div class="sub-header">Workshop Details</div><div class="editable" ng-click="edit_workshop_details()" ng-hide="auto_workshop.editing_details"><div class="info"><span class="label-name-left auto-width">Name:</span><span>{{auto_workshop.registered_name}}</span></div><div class="info" ng-show="country() == &#39;au&#39;"><span class="label-name-left auto-width">ABN:</span><span>{{auto_workshop.abn}}</span></div><div class="info" ng-show="country() == &#39;au&#39;"><span class="label-name-left auto-width">ACN:</span><span>{{auto_workshop.acn}}</span></div><div class="info" ng-show="country() == &#39;uk&#39;"><span class="label-name-left auto-width">Company Registration No#:</span><span>{{auto_workshop.company_registration_number}}</span></div><div class="info" ng-show="country() != &#39;au&#39;"><span class="label-name-left auto-width">{{tax_name()}} Reg. No#:</span><span>{{auto_workshop.tax_registration_number}}</span></div><div class="info"><span class="label-name-left auto-width">Licence Details:</span><pre class="no-style inline" ng-show="auto_workshop.licence">{{auto_workshop.licence}}</pre></div><div class="info"><span class="label-name-left auto-width">Servicing:</span><span>{{auto_workshop|servicing_vehicles}}</span></div><div class="info"><span class="label-name-left auto-width">Registered for {{tax_name()}}:</span><span>{{!auto_workshop.not_registered_for_gst | yes_no}}</span></div><div class="info"><span class="label-name-left auto-width">Prices include {{tax_name()}}:</span><span>{{auto_workshop.prices_include_gst | yes_no}}</span></div><div class="info"><span class="label-name-left auto-width">Send booking reminder:</span><span>{{auto_workshop.send_booking_reminder | yes_no}}</span></div><div class="info"><span class="label-name-left auto-width">Send booking confirmation:</span><span>{{auto_workshop.send_booking_confirmation | yes_no}}</span></div><div class="info" ng-show="auto_workshop.send_booking_reminder"><span class="label-name-left auto-width">Booking reminder by:</span><span>{{auto_workshop.booking_reminder_by}}</span></div><div class="info"><span class="label-name-left auto-width">Data Export sent to:</span><span>{{auto_workshop.export_email}}</span></div><div class="info" ng-show="auto_workshop.reseller"><span class="label-name-left auto-width">Allow {{auto_workshop.reseller.name}} To Login:</span><span class="badge badge-info">{{auto_workshop.allow_partner_login | yes_no}}</span></div></div><div class="editing-item" ng-show="auto_workshop.editing_details"><form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input class="input-xlarge" ng-model="auto_workshop.editing_details.registered_name" type="text" /></div></div><div class="control-group" ng-show="country() == &#39;au&#39;"><label class="control-label">ABN</label><div class="controls"><input ng-model="auto_workshop.editing_details.abn" type="text" /></div></div><div class="control-group" ng-show="country() == &#39;au&#39;"><label class="control-label">ACN</label><div class="controls"><input ng-model="auto_workshop.editing_details.acn" type="text" /></div></div><div class="control-group" ng-show="country() == &#39;uk&#39;"><label class="control-label">Company Reg. No#</label><div class="controls"><input ng-model="auto_workshop.editing_details.company_registration_number" type="text" /></div></div><div class="control-group" ng-show="country() != &#39;au&#39;"><label class="control-label">{{tax_registration_name()}}</label><div class="controls"><input ng-model="auto_workshop.editing_details.tax_registration_number" type="text" /></div></div><div class="control-group"><label class="control-label">Licence Details</label><div class="controls"><textarea class="span12" id="editing-auto-workshop-licence" ng-model="auto_workshop.editing_details.licence" rows="5" type="text"></textarea></div></div><div class="control-group"><label class="control-label">Opening Hours</label><div class="controls"><button class="btn btn-link" id="edit-diary-button" ng-click="edit_diary()">Edit Opening Hours</button></div></div><div class="control-group"><label class="control-label">Servicing</label><div class="controls"><label class="checkbox"><span>Cars</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="car" /></label><label class="checkbox"><span>Motocycles</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="motorcycle" /></label><label class="checkbox"><span>Tractors</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="tractor" /></label><label class="checkbox"><span>Caravans</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="caravan" /></label><label class="checkbox"><span>Trucks</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="truck" /></label><label class="checkbox"><span>Buses</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="bus" /></label><label class="checkbox"><span>Boats</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="boat" /></label><label class="checkbox"><span>Bicycles</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="bicycle" /></label></div></div><div class="control-group"><label class="control-label">Registered for {{tax_name()}}</label><div class="controls"><label class="checkbox"><input ng-model="auto_workshop.editing_details.registered_for_gst" type="checkbox" /></label></div></div><div class="control-group"><label class="control-label">Prices includes {{tax_name()}}</label><div class="controls"><label class="checkbox"><input ng-model="auto_workshop.editing_details.prices_include_gst" type="checkbox" /></label></div></div><div class="control-group"><label class="control-label">Send booking reminder</label><div class="controls"><label class="checkbox"><input ng-model="auto_workshop.editing_details.send_booking_reminder" type="checkbox" /></label></div></div><div class="control-group"><label class="control-label">Send booking confirmation</label><div class="controls"><label class="checkbox"><input ng-model="auto_workshop.editing_details.send_booking_confirmation" type="checkbox" /></label></div></div><div class="control-group" ng-show="auto_workshop.editing_details.send_booking_reminder"><label class="control-label"> Booking reminder by</label><div class="controls"><label class="radio"><input ng-model="auto_workshop.editing_details.booking_reminder_by" type="radio" value="email" /><span>Email</span></label><label class="radio"><input ng-model="auto_workshop.editing_details.booking_reminder_by" type="radio" value="sms" /><span>SMS</span></label></div></div><div class="control-group" ng-show="auto_workshop.editing_details.send_booking_reminder"><label class="control-label"> Send booking reminder</label><div class="controls"><div class="input-append"><input class="input input-tiny" ng-model="auto_workshop.editing_details.booking_reminder_days_prior" type="number" /><span class="add-on">days</span></div><span>&nbsp;before booking date</span></div></div><div class="control-group"><label class="control-label">Send exported data to</label><div class="controls"><input class="input" ng-model="auto_workshop.editing_details.export_email" type="text" /></div></div><div class="control-group" ng-show="auto_workshop.reseller"><label class="control-label">Allow {{auto_workshop.reseller.name}} To Login:</label><div class="controls"><label class="checkbox"><input ng-model="auto_workshop.editing_details.allow_partner_login" type="checkbox" /></label></div></div><div class="control-group"><label></label><div class="controls"><button class="btn btn-success" ng-click="save_auto_workshop_details()">Save</button><button class="btn" ng-click="cancel(auto_workshop, &#39;editing_details&#39;)">Cancel</button></div></div></form></div><div ad-diary="true" anchor-element="#edit-diary-button" ng-model="auto_workshop.diary" on-save="refresh" placement="bottom" showing="showing_diary"></div><br /><div class="sub-header">Contact Details</div><div class="editable" ng-click="edit_workshop_contacts()" ng-hide="auto_workshop.editing_contacts"><div class="info"><span class="label-name-left auto-width">Phone:</span><span>{{auto_workshop.phone}}</span></div><div class="info"><span class="label-name-left auto-width">Fax:</span><span>{{auto_workshop.fax}}</span></div><div class="info"><span class="label-name-left auto-width">Address:</span><span>{{auto_workshop.address.full_address}}</span></div><div class="info"><span class="label-name-left auto-width">Website:</span><span>{{auto_workshop.website}}</span></div><div class="info"><span class="label-name-left auto-width">Email:</span><span>{{auto_workshop.email}}</span></div></div><div class="editing-item" ng-show="auto_workshop.editing_contacts"><form class="form-horizontal" name="edit_contact_form" novalidate="true"><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="auto_workshop.editing_contacts.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Fax</label><div class="controls"><input ng-model="auto_workshop.editing_contacts.fax" type="text" /></div></div><addresspicker ng-model="auto_workshop.editing_contacts.address"></addresspicker><div class="control-group"><label class="control-label">Website</label><div class="controls"><input class="input-xlarge" ng-model="auto_workshop.editing_contacts.website" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input class="input-xlarge" ng-model="auto_workshop.editing_contacts.email" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_auto_workshop_contacts()">Save</button><button class="btn" ng-click="cancel(auto_workshop, &#39;editing_contacts&#39;)">Cancel</button></div></div></form></div></div><div class="content-box" ng-show="auto_workshop.trial_expired_at"><div class="sub-header"><span id="current-pricing-plan">Current Pricing Plan</span></div><div class="bold" ng-hide="subscription_notification_code() == &#39;trial_expired&#39;"><br /><div>Free Trial until {{auto_workshop.trial_expired_at|date: \'mediumDate\'}}</div><br /></div><div class="pull-right"><button class="btn btn-primary" id="change-pricing-plan-button" ng-click="change_plan()" style="width: 100px">Select Plan</button><br /><br /><button class="btn" id="update-card-button" ng-click="update_card_details()" ng-show="auto_workshop.credit_card" style="width: 100px">Update Card</button></div><div ng-show="auto_workshop.pricing_plan"><div class="row-fluid"><div class="bold">{{auto_workshop.pricing_plan.name}}</div><div class="info"><span class="label-name pricing-plan-info">Subscription Price:</span><span ng-bind-html-unsafe="auto_workshop.pricing_plan.display_subscription_price"></span></div><div class="info"><span class="label-name pricing-plan-info">SMS Price:</span><span ng-bind-html-unsafe="auto_workshop.pricing_plan.display_sms_price"></span></div><div class="info" ng-show="auto_workshop.pricing_plan.payment_frequency"><span class="label-name pricing-plan-info">Billing Cycle:</span><span>{{auto_workshop.pricing_plan.payment_frequency}} month(s)</span></div><div class="info" ng-show="auto_workshop.pricing_plan.number_of_users_allowed"><span class="label-name pricing-plan-info">Users/Employees:</span><span ng-bind-html-unsafe="auto_workshop.pricing_plan.number_of_users_allowed"></span></div><div class="info" ng-show="auto_workshop.pricing_plan.discount_employee &gt; 0"><span class="label-name pricing-plan-info">Additional Employees (Discounted):</span><span ng-bind-html-unsafe="auto_workshop.pricing_plan.discount_employee"></span></div><div class="info" ng-show="auto_workshop.pricing_plan.additional_user_price"><span class="label-name pricing-plan-info">Additional Employee:</span><span ng-bind-html-unsafe="auto_workshop.pricing_plan.display_additional_user_price"></span></div><div class="info" ng-show="auto_workshop.pricing_plan.end_at"><span class="label-name pricing-plan-info">Plan end date:</span><span>{{auto_workshop.pricing_plan.end_at|date: \'mediumDate\'}}</span></div><div class="info" ng-show="auto_workshop.pricing_plan.template_customization_included"><span class="label-name pricing-plan-info">Template Customization:</span><span ng-bind-html-unsafe="auto_workshop.pricing_plan.display_template_customization_price"></span></div><div class="info" ng-show="auto_workshop.credit &gt; 0"><span class="label-name pricing-plan-info green">Credit:</span><span class="green">{{auto_workshop.credit}}</span></div></div></div><div ad-pricing-plan="true" anchor-element="#change-pricing-plan-button" ng-model="auto_workshop" placement="top" showing="show_pricing_plan"></div><br /><br /><div class="sub-header">Plan Bills</div><div class="label label-warning" ng-show="subscription_notification_code() == &#39;unpaid_bill&#39;">{{subscription_notification()}}</div><div class="row-fluid" ng-show="auto_workshop.mechanic_desk_invoices.length &gt; 0"><table class="table table-striped"><thead><th>Issue Date</th><th>Description</th><th>Total Amount</th><th>Due Date</th><th>Status</th><th class="actions"></th></thead><tbody><tr ng-repeat="invoice in auto_workshop.mechanic_desk_invoices"><td>{{invoice.created_at | date: \'mediumDate\'}}</td><td>{{invoice.description}}</td><td>${{invoice.total_amount}}</td><td>{{invoice.due_date | date: \'mediumDate\'}}</td><td><span class="label label-success" ng-show="invoice.charged_at">Paid</span><span class="label label" ng-show="!invoice.due &amp;&amp; !invoice.charged_at">Unpaid</span><span class="label label-warning" ng-show="invoice.due">Unpaid</span></td><td class="actions"><a ng-href="/mechanic_desk_invoices/{{invoice.id}}.pdf" target="_blank">View</a><span>&nbsp; &nbsp;</span><a href="javascript:void(0);" id="pay-invoice-{{invoice.id}}" ng-click="pay(invoice)" ng-hide="invoice.charged">Pay</a></td></tr></tbody></table></div><div ng-hide="auto_workshop.mechanic_desk_invoices.length &gt; 0"><span>(No invoices)</span></div><div ad-input-credit-card="true" anchor-element="#current-pricing-plan" auto-workshop="auto_workshop" invoice="paying_invoice" on-paying="update_auto_workshop()" placement="right" showing="paying" title="paying_title"></div></div></div><div class="span5"><div class="content-box"><div class="sub-header">Invoices</div><div class="error" ng-show="invoice_resource_number.editing.errors.next_number">{{invoice_resource_number.editing.errors.next_number | error}}</div><div class="row-fluid"><div class="column span5 label-name-left auto-width">Current Invoice Number:</div><div class="column span6"><div class="editable" ng-click="edit_invoice_number()" ng-hide="invoice_resource_number.editing">{{invoice_resource_number.prefix}} {{invoice_resource_number.next_number}}</div></div></div><div class="row-fluid"><div class="column span12"><form class="inline form-inline" ng-show="invoice_resource_number.editing"><input class="input-small" ng-model="invoice_resource_number.editing.next_number" type="text" />&nbsp;<button class="btn btn-success" ng-click="save_invoice_number()">Save</button><button class="btn" ng-click="cancel_edit_invoice_number()">Cancel</button></form></div></div><div class="row-fluid"><div class="column span4 inline label-name-left auto-width">Invoice Footer:</div><div class="column span7"><pre class="editable value-resource-number inline" ng-click="edit_invoice_thank_you_comment()" ng-hide="auto_workshop.editing_invoice_thank_you_comment">{{auto_workshop.invoice_thank_you_comment}}</pre><form class="form-inline" ng-show="auto_workshop.editing_invoice_thank_you_comment"><textarea class="span12" id="editing-invoice-thank-you-comment" ng-model="auto_workshop.editing_invoice_thank_you_comment.invoice_thank_you_comment" rows="5" type="text"></textarea>&nbsp;<br /><button class="btn btn-success" ng-click="save_invoice_thank_you_comment()">Save</button><button class="btn" ng-click="cancel_edit_invoice_thank_you_comment()">Cancel</button></form></div></div><div class="row-fluid"><div class="column span4 inline label-name-left auto-width">Rounding:</div><div class="column span7"><span class="editable value-resource-number inline" ng-click="edit_rounding()" ng-hide="auto_workshop.editing_rounding"><span ng-show="auto_workshop.rounding">{{auto_workshop.rounding}} cents</span><span ng-hide="auto_workshop.rounding">No rounding</span></span><form class="form-inline" ng-show="auto_workshop.editing_rounding"><select class="input-small inline" ng-model="auto_workshop.editing_rounding.rounding"><option value="">No rounding</option><option value="5">5 cents</option><option value="10">10 cents</option></select>&nbsp;<button class="btn btn-success" ng-click="save_rounding()">Save</button><button class="btn" ng-click="cancel_edit_rounding()">Cancel</button></form></div></div><div class="row-fluid"><div class="column span4 label-name-left auto-width">Invoice template:</div><div class="column span7"><span>{{auto_workshop.invoice_template}}</span><span>&nbsp;</span><a ng-click="select_invoice_template()">Select</a></div></div><hr /><div class="row-fluid"><div class="sub-header">Price Markup Percentages</div><div class="editable" ng-click="edit_buyin_markup_percentage()" ng-hide="auto_workshop.editing_buyin_markup_percentage"><div class="row-fluid"><div class="column span4 label-name-left auto-width">Markup Level 1:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage}}%</div></div><div class="row-fluid" ng-show="auto_workshop.buyin_markup_percentage2 &amp;&amp; auto_workshop.buyin_markup_percentage2 &gt; 0"><div class="column span4 label-name-left auto-width">Markup Level 2:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage2}}%</div></div><div class="row-fluid" ng-show="auto_workshop.buyin_markup_percentage3 &amp;&amp; auto_workshop.buyin_markup_percentage3 &gt; 0"><div class="column span4 label-name-left auto-width">Markup Level 3:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage3}}%</div></div><div class="row-fluid" ng-show="auto_workshop.buyin_markup_percentage4 &amp;&amp; auto_workshop.buyin_markup_percentage4 &gt; 0"><div class="column span4 label-name-left auto-width">Markup Level 4:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage4}}%</div></div><div class="row-fluid" ng-show="auto_workshop.buyin_markup_percentage5 &amp;&amp; auto_workshop.buyin_markup_percentage5 &gt; 0"><div class="column span4 label-name-left auto-width">Markup Level 5:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage5}}%</div></div><div class="row-fluid" ng-show="auto_workshop.buyin_markup_percentage6 &amp;&amp; auto_workshop.buyin_markup_percentage6 &gt; 0"><div class="column span4 label-name-left auto-width">Markup Level 6:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage6}}%</div></div><div class="row-fluid" ng-show="auto_workshop.buyin_markup_percentage7 &amp;&amp; auto_workshop.buyin_markup_percentage7 &gt; 0"><div class="column span4 label-name-left auto-width">Markup Level 7:</div><div class="column span7">{{auto_workshop.buyin_markup_percentage7}}%</div></div></div><div ng-show="auto_workshop.editing_buyin_markup_percentage"><form class="form-horizontal" ng-show="auto_workshop.editing_buyin_markup_percentage"><div class="control-group"><label class="control-label">Markup Level 1</label><div class="controls"><div class="input-append" id="editing-buyin-markup-percentage"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div><div class="control-group"><label class="control-label">Markup Level 2</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage2" step="any" type="number"><span class="add-on">%</span></input></div></div></div><div class="control-group"><label class="control-label">Markup Level 3</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage3" step="any" type="number"><span class="add-on">%</span></input></div></div></div><div class="control-group"><label class="control-label">Markup Level 4</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage4" step="any" type="number"><span class="add-on">%</span></input></div></div></div><div class="control-group"><label class="control-label">Markup Level 5</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage5" step="any" type="number"><span class="add-on">%</span></input></div></div></div><div class="control-group"><label class="control-label">Markup Level 6</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage6" step="any" type="number"><span class="add-on">%</span></input></div></div></div><div class="control-group"><label class="control-label">Markup Level 7</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="auto_workshop.editing_buyin_markup_percentage.buyin_markup_percentage7" step="any" type="number"><span class="add-on">%</span></input></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_buyin_markup_percentage()">Save</button><button class="btn" ng-click="cancel_edit_buyin_markup_percentage()">Cancel</button></div></div></form></div></div><div class="row-fluid"><div class="pull-right"><div id="select-invoice-template-link"></div><div ad-select-invoice-template="true" anchor-element="#select-invoice-template-link" ng-model="auto_workshop" showing="selecting_invoice_template" templates="invoice_templates"></div></div></div><hr /><div class="row-fluid"><div class="sub-header">Credit Card Payment Surcharge</div><div ng-hide="auto_workshop.surcharge || editing_surcharge"><a href="javascript:void(0);" ng-click="edit_surcharge()">Add surcharge</a></div><div class="editable" ng-click="edit_surcharge()" ng-show="auto_workshop.surcharge &amp;&amp; !editing_surcharge"><div class="row-fluid"><div class="column span4 label-name-left auto-width">Surcharge:</div><div class="column span7">{{auto_workshop.surcharge.charge_percentage}}%</div></div><div class="row-fluid"><div class="column span4 label-name-left auto-width">Account:</div><div class="column span7">{{auto_workshop.surcharge.accounting_account.title}}</div></div></div><div class="editing-item" ng-show="editing_surcharge"><form class="form-horizontal"><div class="control-group"><label class="control-label">Charge</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="editing_surcharge.charge_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div><div class="control-group"><label class="control-label">Account</label><div class="controls"><div accounts="output_accounts" ad-accounting-account-picker="true" ng-model="editing_surcharge.accounting_account_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_surcharge()">Save</button><button class="btn" ng-click="cancel_edit_surcharge()">Cancel</button></div></div></form></div></div><br /><br /><div class="sub-header">Advertising on invoice</div><div class="editable" ng-click="auto_workshop.uploading_invoice_ad = true" ng-hide="auto_workshop.uploading_invoice_ad"><span class="warning" ng-hide="auto_workshop.invoice_ad_url">(No invoice ad)</span><div class="inline" ng-show="auto_workshop.invoice_ad_url"><img class="invoice_ad" ng-src="{{auto_workshop.invoice_ad_url}}" style="width: 350px" /></div></div><div class="editing-item" ng-show="auto_workshop.uploading_invoice_ad"><form action="/auto_workshop/invoice_ad" method="POST" ng-upload="upload_invoice_ad(content)" upload-options-enable-rails-csrf="true"><input name="file" type="file" /><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><br /><br /><button class="btn btn-success" ng-disabled="$isLoading" type="submit">Save</button><button class="btn btn-danger" ng-click="delete_invoice_ad($event)" ng-show="auto_workshop.invoice_ad_url" type="button">Delete</button><button class="btn" ng-click="close_invoice_ad_upload($event)" type="button">Cancel</button></form></div></div><div class="content-box"><div class="sub-header">Quotes</div><div class="row-fluid"><div class="column span4 inline label-name-left auto-width">Quote Footer:</div><div class="column span7"><pre class="editable value-resource-number inline" ng-click="edit_quote_footer()" ng-hide="auto_workshop.editing_quote_footer">{{auto_workshop.quote_footer}}</pre><form class="form-inline" ng-show="auto_workshop.editing_quote_footer"><textarea class="span12" id="editing-quote-footer" ng-model="auto_workshop.editing_quote_footer.quote_footer" rows="5" type="text"></textarea>&nbsp;<br /><button class="btn btn-success" ng-click="save_quote_footer()">Save</button><button class="btn" ng-click="cancel_edit_quote_footer()">Cancel</button></form></div></div></div></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("administration/workshop_details/workshop_details.html",'<div class="sub-header">Workshop Details</div><div class="editable" ng-click="edit_workshop_details()" ng-hide="auto_workshop.editing_details"><div class="info"><span class="label-name-left auto-width">Name:</span><span>{{auto_workshop.registered_name}}</span></div><div class="info" ng-show="country() == &#39;au&#39;"><span class="label-name-left auto-width">ABN:</span><span>{{auto_workshop.abn}}</span></div><div class="info" ng-show="country() == &#39;au&#39;"><span class="label-name-left auto-width">ACN:</span><span>{{auto_workshop.acn}}</span></div><div class="info" ng-show="country() == &#39;uk&#39;"><span class="label-name-left auto-width">Company Registration No#:</span><span>{{auto_workshop.company_registration_number}}</span></div><div class="info" ng-show="country() != &#39;au&#39;"><span class="label-name-left auto-width">{{tax_name()}} Reg. No#:</span><span>{{auto_workshop.tax_registration_number}}</span></div><div class="info"><span class="label-name-left auto-width">Licence Details:</span><pre class="no-style inline" ng-show="auto_workshop.licence">{{auto_workshop.licence}}</pre></div><div class="info"><span class="label-name-left auto-width">Servicing:</span><span>{{auto_workshop|servicing_vehicles}}</span></div><div class="info"><span class="label-name-left auto-width">Registered for {{tax_name()}}:</span><span>{{!auto_workshop.not_registered_for_gst | yes_no}}</span></div><div class="info"><span class="label-name-left auto-width">Prices include {{tax_name()}}:</span><span>{{auto_workshop.prices_include_gst | yes_no}}</span></div><div class="info"><span class="label-name-left auto-width">Send booking reminder:</span><span>{{auto_workshop.send_booking_reminder | yes_no}}</span></div><div class="info"><span class="label-name-left auto-width">Send booking confirmation:</span><span>{{auto_workshop.send_booking_confirmation | yes_no}}</span></div><div class="info" ng-show="auto_workshop.send_booking_reminder"><span class="label-name-left auto-width">Booking reminder by:</span><span>{{auto_workshop.booking_reminder_by}}</span></div><div class="info"><span class="label-name-left auto-width">Data Export sent to:</span><span>{{auto_workshop.export_email}}</span></div><div class="info" ng-show="auto_workshop.reseller"><span class="label-name-left auto-width">Allow {{auto_workshop.reseller.name}} To Login:</span><span class="badge badge-info">{{auto_workshop.allow_partner_login | yes_no}}</span></div></div><div class="editing-item" ng-show="auto_workshop.editing_details"><form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input class="input-xlarge" ng-model="auto_workshop.editing_details.registered_name" type="text" /></div></div><div class="control-group" ng-show="country() == &#39;au&#39;"><label class="control-label">ABN</label><div class="controls"><input ng-model="auto_workshop.editing_details.abn" type="text" /></div></div><div class="control-group" ng-show="country() == &#39;au&#39;"><label class="control-label">ACN</label><div class="controls"><input ng-model="auto_workshop.editing_details.acn" type="text" /></div></div><div class="control-group" ng-show="country() == &#39;uk&#39;"><label class="control-label">Company Reg. No#</label><div class="controls"><input ng-model="auto_workshop.editing_details.company_registration_number" type="text" /></div></div><div class="control-group" ng-show="country() != &#39;au&#39;"><label class="control-label">{{tax_registration_name()}}</label><div class="controls"><input ng-model="auto_workshop.editing_details.tax_registration_number" type="text" /></div></div><div class="control-group"><label class="control-label">Licence Details</label><div class="controls"><textarea class="span12" id="editing-auto-workshop-licence" ng-model="auto_workshop.editing_details.licence" rows="5" type="text"></textarea></div></div><div class="control-group"><label class="control-label">Opening Hours</label><div class="controls"><button class="btn btn-link" id="edit-diary-button" ng-click="edit_diary()">Edit Opening Hours</button></div></div><div class="control-group"><label class="control-label">Servicing</label><div class="controls"><label class="checkbox"><span>Cars</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="car" /></label><label class="checkbox"><span>Motocycles</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="motorcycle" /></label><label class="checkbox"><span>Tractors</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="tractor" /></label><label class="checkbox"><span>Caravans</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="caravan" /></label><label class="checkbox"><span>Trucks</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="truck" /></label><label class="checkbox"><span>Buses</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="bus" /></label><label class="checkbox"><span>Boats</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="boat" /></label><label class="checkbox"><span>Bicycles</span><input check-list="auto_workshop.editing_details.servicings" type="checkbox" value="bicycle" /></label></div></div><div class="control-group"><label class="control-label">Registered for {{tax_name()}}</label><div class="controls"><label class="checkbox"><input ng-model="auto_workshop.editing_details.registered_for_gst" type="checkbox" /></label></div></div><div class="control-group"><label class="control-label">Prices includes {{tax_name()}}</label><div class="controls"><label class="checkbox"><input ng-model="auto_workshop.editing_details.prices_include_gst" type="checkbox" /></label></div></div><div class="control-group"><label class="control-label">Send booking reminder</label><div class="controls"><label class="checkbox"><input ng-model="auto_workshop.editing_details.send_booking_reminder" type="checkbox" /></label></div></div><div class="control-group"><label class="control-label">Send booking confirmation</label><div class="controls"><label class="checkbox"><input ng-model="auto_workshop.editing_details.send_booking_confirmation" type="checkbox" /></label></div></div><div class="control-group" ng-show="auto_workshop.editing_details.send_booking_reminder"><label class="control-label"> Booking reminder by</label><div class="controls"><label class="radio"><input ng-model="auto_workshop.editing_details.booking_reminder_by" type="radio" value="email" /><span>Email</span></label><label class="radio"><input ng-model="auto_workshop.editing_details.booking_reminder_by" type="radio" value="sms" /><span>SMS</span></label></div></div><div class="control-group" ng-show="auto_workshop.editing_details.send_booking_reminder"><label class="control-label"> Send booking reminder</label><div class="controls"><div class="input-append"><input class="input input-tiny" ng-model="auto_workshop.editing_details.booking_reminder_days_prior" type="number" /><span class="add-on">days</span></div><span>&nbsp;before booking date</span></div></div><div class="control-group"><label class="control-label">Send exported data to</label><div class="controls"><input class="input" ng-model="auto_workshop.editing_details.export_email" type="text" /></div></div><div class="control-group" ng-show="auto_workshop.reseller"><label class="control-label">Allow {{auto_workshop.reseller.name}} To Login:</label><div class="controls"><label class="checkbox"><input ng-model="auto_workshop.editing_details.allow_partner_login" type="checkbox" /></label></div></div><div class="control-group"><label></label><div class="controls"><button class="btn btn-success" ng-click="save_auto_workshop_details()">Save</button><button class="btn" ng-click="cancel(auto_workshop, &#39;editing_details&#39;)">Cancel</button></div></div></form></div><div ad-diary="true" anchor-element="#edit-diary-button" ng-model="auto_workshop.diary" on-save="refresh" placement="bottom" showing="showing_diary"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bill_payments/details.html",'<div class="sub-header">Bill Payment Details</div><div class="info" ng-show="bill_payment.original_bill_payment_id"><a ng-href="#/bill_payments/{{bill_payment.original_bill_payment_id}}">Original Payment</a></div><div class="editable" ng-click="edit_bill_payment()" ng-hide="bill_payment.editing"><div class="info"><label class="label-name-left auto-width">Supplier:</label><span>{{bill_payment.supplier.name}}</span></div><div class="info"><label class="label-name-left auto-width">Payment Reference:</label><span>{{bill_payment.reference}}</span></div><div class="info"><label class="label-name-left auto-width">Date:</label><span>{{bill_payment.date | date: \'mediumDate\'}}</span></div><div class="info"><label class="label-name-left auto-width">Amount:</label><span class="bold">{{bill_payment.amount|currency}}</span></div><div class="info"><label class="label-name-left auto-width">Payment Type:</label><span class="bold">{{bill_payment.payment_type_name}}</span></div><div class="info" ng-show="bill_payment.accounting_account_id"><label class="label-name-left auto-width">Account:</label><span class="bold">{{bill_payment.accounting_account.title}}</span></div><div class="info"><label class="label-name-left auto-width">Unallocated:</label><span class="bold">{{bill_payment.unallocated_amount|currency}}</span><div class="inline red" ng-show="bill_payment.unallocated_amount &lt; 0">&nbsp; Total Bill Allocation is more than the payment\'s amount. Please review</div></div></div><div class="editing-item" ng-show="bill_payment.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><supplierpicker ng-model="bill_payment.editing.supplier_id" supplier="bill_payment.editing.supplier"></supplierpicker></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><div class="input-append"><input ng-model="bill_payment.editing.reference" type="text" /></div></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker error="right" ng-model="bill_payment.editing.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><div class="input-append"><input class="input-small" ng-model="bill_payment.editing.amount" type="text" /></div></div></div><div class="control-group"><label class="control-label">Payment Type</label><div class="controls"><select ng-model="bill_payment.editing.payment_method_id" ng-options="pt.id as pt.name for pt in payment_methods" type="text"></select><button class="btn btn-link" ng-click="choose_specific_bank_account = true" ng-show="bank_accounts().length &gt; 1 &amp;&amp; !bill_payment.accounting_account_id">Select specific bank account</button></div></div><div class="control-group" ng-show="show_select_bank_account() || choose_specific_bank_account"><label class="control-label">Payment Account</label><div class="controls"><div accounts="bank_accounts()" ad-accounting-account-picker="true" ng-model="bill_payment.editing.accounting_account_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_bill_payment()">Save</button><button class="btn" ng-click="cancel_edit_bill_payment()">Cancel</button></div></div></form></div><br /><div ng-hide="bill_payment.bill_id"><div ng-hide="bill_payment.finalized"><span class="label label-info">In progress</span><button class="btn btn-link" ng-click="finalize()">Finalize</button></div><div ng-show="bill_payment.finalized"><span class="label label-success">Finalized</span></div><div></div></div><hr /><table class="table table-striped" ng-show="bill_payment.allocated_bill_payments.length &gt; 0"><thead><tr><th>Bill No#</th><th>Reference</th><th>Date</th><th>Amount</th><th>Allocated Amount</th><th class="actions"></th></tr></thead><tbody><tr ng-repeat="bpayment in bill_payment.allocated_bill_payments"><td><div ng-show="bpayment.bill.finalized" style="color: green">{{bpayment.bill.number}}</div><div ng-hide="bpayment.bill.finalized" style="color: blue">{{bpayment.bill.number}}</div></td><td>{{bpayment.bill.reference}}</td><td>{{bpayment.bill.date|date:\'mediumDate\'}}</td><td>{{bpayment.bill.total_amount|currency}}</td><td>{{bpayment.amount|currency}} </td><td><div class="pull-right"><a ng-href="#/bills/{{bpayment.bill.id}}">Bill Details</a><span>&nbsp;::&nbsp;</span><a class="red" href="javascript:void(0);" ng-click="remove_bpayment(bpayment)"><i class="icon icon-remove"></i><span>Remove</span></a></div></td></tr></tbody></table><a href="javascript:void(0);" id="add-bills-button" ng-click="add_bills()" ng-hide="bill_payment.unallocated_amount &lt;= 0">Add Bills Paid By This Payment</a><div ad-bill-selection="true" anchor-element="#add-bills-button" bill-payment="bill_payment" on-select="save_selected_bills()" placement="right" selection="selected_bills" showing="showing_related_bills" supplier="bill_payment.supplier"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bill_payments/index.html",'<div ng-controller="BillPaymentsController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="page-header">Bill Payments<div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="row-fluid"><div class="pull-right"><a class="btn btn-primary" ng-href="#/bill_payments/new"><span>New Bill Payment</span></a></div></div><div class="row-fluid"><div class="column span4"><label class="checkbox"><input ng-click="toggle_unallocated()" ng-model="query.unallocated" type="checkbox" /><span>Show</span> <span class="label label-info">Unallocated</span> <span>Payments Only</span></label><label class="checkbox"><input ng-click="toggle_deleted()" ng-model="query.deleted" type="checkbox" /><span>Show</span> <span class="label">Deleted</span> <span>Payments Only</span></label></div><div class="column span4"><div><label class="checkbox"><input ng-click="toggle_finalized()" ng-model="query.finalized" type="checkbox" /><span>Show</span> <span class="label label-success">Finalized</span> <span>Payments Only</span></label></div><div><label class="checkbox"><input ng-click="toggle_in_progress()" ng-model="query.in_progress" type="checkbox" /><span>Show</span> <span class="label label-info">In Progress</span> <span>Payments Only</span></label></div></div></div><br /></div><div class="search-description" ng-show="keyword">Search "{{keyword}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="content-box"><div class="spinner" id="bill-payments-spinner"></div><table class="table table-striped" ng-show="query.deleted"><thead><tr><th class="column-sortable" ng-click="sort(&#39;number&#39;)">Bill Payment Number</th><th class="column-sortable" ng-click="sort(&#39;reference&#39;)">Reference</th><th class="column-sortable" ng-click="sort(&#39;date&#39;)">Date</th><th>Supplier</th><th>Amount</th><th>Payment Type</th><th>Deleted By</th><th>Delete Reason</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/bill_payments/&#39; + bill_payment.id)" ng-repeat="bill_payment in bill_payments"><td><div>#{{bill_payment.number}}</div> <div class="label label-info" ng-show="bill_payment.original_payment_id || bill_payment.credit_note_id">Payment Allocation</div></td><td>{{bill_payment.reference}}</td><td>{{bill_payment.date |date: \'mediumDate\'}}</td><td>{{bill_payment.supplier.name}}</td><td>{{bill_payment.amount|currency}}</td><td>{{bill_payment.payment_type_name}}</td><td>{{bill_payment.deleted_by.name}}</td><td>{{bill_payment.deleted_reason}}</td></tr></tbody></table><table class="table table-striped" ng-hide="query.deleted"><thead><tr><th class="column-sortable" ng-click="sort(&#39;number&#39;)">Bill Payment Number</th><th class="column-sortable" ng-click="sort(&#39;reference&#39;)">Reference</th><th class="column-sortable" ng-click="sort(&#39;date&#39;)">Date</th><th>Supplier</th><th>Amount</th><th>Payment Type</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/bill_payments/&#39; + bill_payment.id)" ng-repeat="bill_payment in bill_payments"><td><div>#{{bill_payment.number}}</div> <div class="label label-info" ng-show="bill_payment.original_bill_payment_id || bill_payment.supplier_credit_note_id">Payment Allocation</div></td><td>{{bill_payment.reference}}</td><td>{{bill_payment.date |date: \'mediumDate\'}}</td><td>{{bill_payment.supplier.name}}</td><td>{{bill_payment.amount|currency}}</td><td>{{bill_payment.payment_type_name}}</td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bill_payments/new.html",'<div ng-controller="NewBillPaymentController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">New Bill Payment</div><div class="row-fluid"><div class="content-box"><form class="form-horizontal"><div class="control-group"><label class="control-label">Paid To</label><div class="controls"><supplierpicker ng-model="bill_payment.supplier_id" supplier="bill_payment.supplier"></supplierpicker></div></div></form><form class="form-horizontal"><div class="control-group"><label class="control-label">Payment Reference</label><div class="controls"><input ng-model="bill_payment.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="bill_payment.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><div class="input-append"><input class="input-small" ng-model="bill_payment.amount" type="text" /></div></div></div><div class="control-group"><label class="control-label">Payment Type</label><div class="controls"><select ng-model="bill_payment.payment_method_id" ng-options="pt.id as pt.name for pt in payment_methods" type="text"></select><button class="btn btn-link" ng-click="choose_specific_bank_account = true" ng-show="show_select_bank_account()">Select specific bank account</button></div></div><div class="control-group" ng-show="show_select_bank_account() &amp;&amp; choose_specific_bank_account"><label class="control-label">Payment Account</label><div class="controls"><div accounts="bank_accounts()" ad-accounting-account-picker="true" ng-model="bill_payment.accounting_account_id"></div></div></div><div class="control-group" ng-show="bill"><label class="control-label">Bill</label><div class="controls"><div class="goto" ng-click="goto(&#39;#/bills/&#39; + bill.id)" target="_blank"><div>Supplier: {{bill.supplier.name}}</div><div>Reference: #{{bill.reference}}</div><div>Bill Amount: {{bill.total_amount|currency}}</div><div>Date: {{bill.date|date: \'mediumDate\'}}</div></div></div></div><br /><br /><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_bill_payment()">Continue</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="bill-payment-spinner"></div></div></div></form></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bill_payments/show.html",'<div ng-controller="ShowBillPaymentController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div ng-hide="bill_payment &amp;&amp; bill_payment.id"><div class="spinner" id="bill-payment-loading"></div></div><div ng-show="bill_payment &amp;&amp; bill_payment.id"><div class="deleted-sign" ng-show="bill_payment.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><div class="row-fluid"><div class="page-header">Bill Payment #{{bill_payment.number}}</div></div><div class="row-fluid"><div class="pull-right"><a class="btn" ng-hide="bill_payment.deleted" ng-href="/bill_payments/{{bill_payment.id}}/print.pdf" target="_blank"><i class="icon icon-print"></i><span>Print Summary</span></a><button class="btn" id="send-bill-payment" ng-click="open_email_bill_payment()" ng-hide="bill_payment.deleted" target="_blank"><i class="icon icon-envelope"></i><span>Send Payment Advice</span></button><button class="btn btn-danger" ng-click="open_delete_dialog()" ng-hide="bill_payment.deleted">Delete</button></div></div><br /><div class="row-fluid"><div class="content-box"><div class="sub-header">Bill Payment Details</div><div class="info" ng-show="bill_payment.original_bill_payment_id"><a ng-href="#/bill_payments/{{bill_payment.original_bill_payment_id}}">Original Payment</a></div><div class="editable" ng-click="edit_bill_payment()" ng-hide="bill_payment.editing"><div class="info"><label class="label-name-left auto-width">Supplier:</label><span>{{bill_payment.supplier.name}}</span></div><div class="info"><label class="label-name-left auto-width">Payment Reference:</label><span>{{bill_payment.reference}}</span></div><div class="info"><label class="label-name-left auto-width">Date:</label><span>{{bill_payment.date | date: \'mediumDate\'}}</span></div><div class="info"><label class="label-name-left auto-width">Amount:</label><span class="bold">{{bill_payment.amount|currency}}</span></div><div class="info"><label class="label-name-left auto-width">Payment Type:</label><span class="bold">{{bill_payment.payment_type_name}}</span></div><div class="info" ng-show="bill_payment.accounting_account_id"><label class="label-name-left auto-width">Account:</label><span class="bold">{{bill_payment.accounting_account.title}}</span></div><div class="info"><label class="label-name-left auto-width">Unallocated:</label><span class="bold">{{bill_payment.unallocated_amount|currency}}</span><div class="inline red" ng-show="bill_payment.unallocated_amount &lt; 0">&nbsp; Total Bill Allocation is more than the payment\'s amount. Please review</div></div></div><div class="editing-item" ng-show="bill_payment.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><supplierpicker ng-model="bill_payment.editing.supplier_id" supplier="bill_payment.editing.supplier"></supplierpicker></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><div class="input-append"><input ng-model="bill_payment.editing.reference" type="text" /></div></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker error="right" ng-model="bill_payment.editing.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><div class="input-append"><input class="input-small" ng-model="bill_payment.editing.amount" type="text" /></div></div></div><div class="control-group"><label class="control-label">Payment Type</label><div class="controls"><select ng-model="bill_payment.editing.payment_method_id" ng-options="pt.id as pt.name for pt in payment_methods" type="text"></select><button class="btn btn-link" ng-click="choose_specific_bank_account = true" ng-show="bank_accounts().length &gt; 1 &amp;&amp; !bill_payment.accounting_account_id">Select specific bank account</button></div></div><div class="control-group" ng-show="show_select_bank_account() || choose_specific_bank_account"><label class="control-label">Payment Account</label><div class="controls"><div accounts="bank_accounts()" ad-accounting-account-picker="true" ng-model="bill_payment.editing.accounting_account_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_bill_payment()">Save</button><button class="btn" ng-click="cancel_edit_bill_payment()">Cancel</button></div></div></form></div><br /><div ng-hide="bill_payment.bill_id"><div ng-hide="bill_payment.finalized"><span class="label label-info">In progress</span><button class="btn btn-link" ng-click="finalize()">Finalize</button></div><div ng-show="bill_payment.finalized"><span class="label label-success">Finalized</span></div><div></div></div><hr /><table class="table table-striped" ng-show="bill_payment.allocated_bill_payments.length &gt; 0"><thead><tr><th>Bill No#</th><th>Reference</th><th>Date</th><th>Amount</th><th>Allocated Amount</th><th class="actions"></th></tr></thead><tbody><tr ng-repeat="bpayment in bill_payment.allocated_bill_payments"><td><div ng-show="bpayment.bill.finalized" style="color: green">{{bpayment.bill.number}}</div><div ng-hide="bpayment.bill.finalized" style="color: blue">{{bpayment.bill.number}}</div></td><td>{{bpayment.bill.reference}}</td><td>{{bpayment.bill.date|date:\'mediumDate\'}}</td><td>{{bpayment.bill.total_amount|currency}}</td><td>{{bpayment.amount|currency}} </td><td><div class="pull-right"><a ng-href="#/bills/{{bpayment.bill.id}}">Bill Details</a><span>&nbsp;::&nbsp;</span><a class="red" href="javascript:void(0);" ng-click="remove_bpayment(bpayment)"><i class="icon icon-remove"></i><span>Remove</span></a></div></td></tr></tbody></table><a href="javascript:void(0);" id="add-bills-button" ng-click="add_bills()" ng-hide="bill_payment.unallocated_amount &lt;= 0">Add Bills Paid By This Payment</a><div ad-bill-selection="true" anchor-element="#add-bills-button" bill-payment="bill_payment" on-select="save_selected_bills()" placement="right" selection="selected_bills" showing="showing_related_bills" supplier="bill_payment.supplier"></div></div><div class="content-box" ng-show="bill_payment.remote_id"><div class="sub-header">Accounting Integration</div><div>Synced To ID {{bill_payment.remote_id}}</div><div ng-show="bill_payment.remote_url"><span>Please click </span> <a ng-href="{{bill_payment.remote_url}}" target="_blank">Here</a> <span>to access the Payment in Accounting Software</span></div></div></div><div modal="showing_delete_bill_payment_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this Bill Payment</h3></div><div class="modal-body"><div>Are you sure you want to delete this bill payment?</div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_bill_payment()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_bill_payment()">Cancel</button><div class="spinner" id="delete-bill-payment-spinner"></div></div></div></div><div id="bill-payment-send-email"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Send Email</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form><div class="pull-right"><div class="inline" id="bill-payment-send-email-spinner"></div></div><label>Email</label><input class="span12" id="bill-payment-send-email-address" ng-model="email_bill_payment_to" type="text" /><label>Subject</label><input class="span12" id="bill-payment-send-email-address" ng-model="email_bill_payment_subject" type="text" /><label>Message</label><textarea class="span12" id="bill-payment-send-email-message" ng-model="email_bill_payment_message" rows="4" type="text"></textarea><div><button class="btn btn-success" ng-click="email_bill_payment()">Send</button><button class="btn" ng-click="cancel_email_bill_payment()">Cancel</button></div></form></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bills/bill_files.html",'<div class="sub-header"><div class="inline" id="bill-photos">Photos/Documents</div><div class="pull-right" ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_bill_files()">Upload</button></div></div><div class="bill-files" ng-hide="uploading_files"><div class="pull-right"></div><div class="inline bill-photo" ng-repeat="photo in bill.photos" style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><div ng-show="bill.documents.length &gt; 0"><div class="bold">Documents</div><div ng-repeat="document in bill.documents"><div class="editable" ng-click="edit_file(document)" ng-hide="document.editing"><span>{{document.file_name}} &nbsp;</span><a ng-href="{{document.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="document.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="document.editing.file_name" type="text" /></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(document)">Save</button><button class="btn" ng-click="cancel_edit_file(document)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(document)">Remove</button></div></form></div></div></div></div><div id="photo-viewer"><div class="popover fade right in" style="width: 800px; height: 1000px"><div class="popover-title"><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="full_size_photo()">Full Size</button><button class="btn" ng-click="close_photo_viewer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div style="height: 750px"><carousel><slide active="photo.active" ng-repeat="photo in bill.photos"><img ng-src="{{photo.url}}" style="margin:auto; max-width: 100%; max-height:750px;" /></slide></carousel></div></div><div class="row-fluid"><center><div class="inline job-photo" ng-class="{&#39;bill-photo-active&#39;: photo.active}" ng-repeat="photo in bill.photos"><div style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><button class="btn btn-danger" ng-click="remove_photo(photo)" ng-show="photo.active">Remove</button></div></center></div></div></div></div><form action="/bills/{{bill.id}}/upload_files" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /></div><br /><div class="inline" id="upload-photos-spinner"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bills/details.html",'<div class="sub-header">Bill Details</div><div class="editable" ng-click="edit_bill()" ng-hide="bill.editing"><div class="info"><label class="label-name-left auto-width">Supplier:</label><span>{{bill.supplier.name}}</span></div><div class="info" ng-show="bill.billing_supplier &amp;&amp; bill.billing_supplier_id != bill.supplier_id"><label class="label-name-left auto-width">Creditor/Buying Group:</label><span>{{bill.billing_supplier.name}}</span></div><div class="info"><label class="label-name-left auto-width">Reference:</label><span>{{bill.reference}}</span></div><div class="info"><label class="label-name-left auto-width">Date:</label><span>{{bill.date | date: \'mediumDate\'}}</span></div><div class="info"><label class="label-name-left auto-width">Due Date:</label><span>{{bill.due_date | date: \'mediumDate\'}}</span></div><div class="info"><label class="label-name-left auto-width">Amount:</label><span class="bold">{{bill.total_amount|currency}}</span></div><div class="info"><label class="label-name-left auto-width">Paid:</label><span class="bold">{{bill.paid_amount|currency}}</span></div><div class="info"><label class="label-name-left auto-width">Remaining:</label><span class="bold">{{bill.unpaid_amount|currency}}</span></div><div class="info" ng-show="bill.accounting_account"><label class="label-name-left auto-width">Account:</label><span class="bold">{{bill.accounting_account.title}}</span></div><div class="info" ng-show="enable_tracking_category_selection()"><label class="label-name-left auto-width">Tracking Categories</label><div class="inline" style="min-width: 40px;">{{bill.tracking_categories|comma_seperated: \'option\'}}</div></div><div ng-show="!bill.total_amount_match_total_item_amount"><div class="red">Bill amount( {{bill.total_amount|currency}} ) does not match total item amount( {{bill.total_item_amount|currency}} )</div></div></div><div class="editing-item" ng-show="bill.editing"><form autocomplete="off" class="form-horizontal" novalidate="true"><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><supplierpicker ng-model="bill.editing.supplier_id" supplier="bill.editing.supplier"></supplierpicker></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><div class="error" ng-show="bill.editing.errors.reference">{{bill.editing.errors.reference|error}}</div><input ng-model="bill.editing.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker error="right" ng-model="bill.editing.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Due Date</label><div class="controls"><ad-datepicker error="right" ng-model="bill.editing.due_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><div class="input-append"><input class="input-small" ng-model="bill.editing.total_amount" type="text" /></div></div></div><div class="control-group"><label class="control-label">Creditor/Buying Group</label><div class="controls"><div class="input-append"><div creditorpicker="true" ng-model="bill.editing.billing_supplier_id"></div></div></div></div><div class="control-group"><label class="control-label">Expense/Purchase Account</label><div class="controls"><div accounts="input_accounts" ad-accounting-account-picker="true" ng-model="bill.editing.accounting_account_id"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="bill.editing"></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_bill()">Save</button><button class="btn" ng-click="cancel_edit_bill()">Cancel</button></div></div></form></div><div ng-show="bill.id"><div ng-hide="bill.finalized"><span class="label label-info">In progress</span><button class="btn btn-link" ng-click="finalize()">Finalize</button></div><div ng-show="bill.finalized"><span class="label label-success">Finalized</span></div></div><div class="row-fluid"><div class="pull-right"><label class="checkbox"><input ng-click="set_prices_include_gst()" ng-model="bill.supplier.prices_include_gst" type="checkbox" /><span>{{tax_name()}} Inclusive</span></label><label class="checkbox"><input ng-click="set_gst_free()" ng-model="bill.supplier.gst_free" type="checkbox" /><span>{{tax_name()}} Free</span></label><div class="spinner" id="bill-prices-gst-spinner"></div></div></div><hr /><div class="cost-table" id="bill-item-list"><div class="header"><div class="description">Name</div><div class="quantity">Qty.</div><div class="rate">Unit Price</div><div class="total">Total</div></div><div class="cost" id="bill-item-{{bill_item.id}}" ng-hide="bill_item.editing" ng-repeat="bill_item in bill.bill_items"><div class="editable" ng-click="edit_bill_item(bill_item)" ng-hide="bill_item.editing"><div class="description"><span class="label label-info" ng-show="bill_item.is_buyin">B</span><span>&nbsp;</span><span>{{bill_item.description}}</span></div><div class="quantity">{{bill_item.quantity}}</div><div class="rate">{{bill_item.unit_price|currency}}</div><div class="total">{{bill_item_total(bill_item) | currency}}</div><div class="included-gst"><span ng-show="bill_item.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="bill_item.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span><span ng-show="bill_item_total(bill_item) == 0">&nbsp; &nbsp;<i class="icon-warning-sign yellow" tooltip="Line Item total should not be 0"></i></span></div></div></div><div class="cost" id="editing-bill-item" ng-show="editing_bill_item"><div class="editing-item"><form autocomplete="off" name="edit_bill_item_form" novalidate="true"><div class="error" ng-show="edit_bill_item_form.description.$error.required">description is required</div><div class="error" ng-show="edit_bill_item_form.description.$error.maxlength">description\'s max length is 255 characters</div><div class="error" ng-show="edit_bill_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="edit_bill_item_form.unit_price.$invalid">unit price must be a number</div><div class="row-fluid"><div class="description"><div ad-invoice-item-input="true" bill="credit_note" ng-model="editing_bill_item.editing"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="bill_item_total(editing_bill_item.editing)" ng-model="editing_bill_item.editing.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-change="bill_item_total(editing_bill_item.editing)" ng-model="editing_bill_item.editing.unit_price" required="true" step="any" type="number" /></div><div class="total"><input class="input-mini" ng-change="calculate_from_total(editing_bill_item.editing)" ng-model="editing_bill_item.editing.total" step="any" type="number" /></div><div class="pull-right" ng-show="editing_bill_item.stock_id"><a href="javascript:void(0)" ng-click="show_stock(editing_bill_item)"><i class="icon icon-info"></i><span>Item Info</span></a></div></div><div class="row-fluid"><div class="pull-left"><div class="inline"><label class="checkbox"><input ng-click="unset_sell_price(editing_bill_item.editing)" ng-model="editing_bill_item.editing.is_buyin" type="checkbox" /><span>Is Buyin Item</span></label></div><div class="inline" ng-show="editing_bill_item.editing.is_buyin" style="margin-left: 20px"><label class="checkbox"><input ng-click="unset_sell_price(editing_bill_item.editing)" ng-model="editing_bill_item.editing.is_non_charge" type="checkbox" /><span>No charge</span></label></div><div ng-show="editing_bill_item.editing.is_buyin"><div ng-hide="editing_bill_item.editing.is_non_charge"><div><label class="inline" style="width: 120px">Sell Price</label><input class="input-small" ng-change="reset_markup_percentage(editing_bill_item.editing)" ng-model="editing_bill_item.editing.sell_price" step="any" type="number" /><span ng-show="markup_percentages(editing_bill_item.editing, true).length &gt; 0"><span>&nbsp;Markup:</span> <div class="inline" ng-repeat="percentage in markup_percentages(editing_bill_item.editing, true)"><button class="btn btn-link" ng-class="{&#39;selected-percentage&#39;: percentage == editing_bill_item.editing.markup_percentage}" ng-click="update_buyin_price(editing_bill_item.editing, percentage)" style="font-size: 90%" type="button">{{percentage}}%</button><span>&nbsp;::&nbsp;</span></div><button class="btn btn-link" ng-click="unset_sell_price(editing_bill_item.editing)" type="button">Unset</button></span></div><div ng-show="editing_bill_item.unit_price != editing_bill_item.editing.unit_price &amp;&amp; editing_bill_item.sell_price == editing_bill_item.editing.sell_price"><div class="warning inline underline">Buy price is updated, Do you want to update the sell price?</div><button class="btn btn-link" ng-click="update_buyin_price(editing_bill_item.editing)">Update Sell Price</button><br /><br /></div></div><div><label class="inline" style="width: 120px">Warranty</label><ad-datepicker ng-model="editing_bill_item.editing.warranty_expiry_date"></ad-datepicker></div><div><label class="inline" style="width: 120px">Allocate To Job</label><ad-jobpicker job="editing_bill_item.editing.job" ng-model="editing_bill_item.editing.job_id"></ad-jobpicker></div></div></div><div class="pull-right"><div><label class="checkbox"><input ng-model="editing_bill_item.editing.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="editing_bill_item.editing.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><br /><div class="button-panel"><div class="row-fluid"><div class="pull-left"><button class="btn btn-success" ng-click="save_bill_item(edit_bill_item_form, editing_bill_item)">Save</button><button class="btn" ng-click="cancel_edit_bill_item()">Cancel</button></div><div class="pull-right"><button class="btn btn-danger" ng-click="remove_bill_item(editing_bill_item)">Remove</button></div></div></div></form></div></div><div ng-hide="new_bill_item"><div><a href="javascript: void(0);" id="add-bill-item-button" ng-click="add_bill_item()">+ Item</a></div><div><a href="javascript: void(0);" id="add-related-purchase-order-button" ng-click="add_purchase_order()">+ Related supplier\'s purchase orders</a></div></div><div class="bill_item" ng-show="new_bill_item"><form autocomplete="off" name="new_bill_item_form" novalidate="true"><div class="editing-item"><div class="row-fluid"><div class="error" ng-show="new_bill_item_form.description.$error.required">description is required</div><div class="error" ng-show="new_bill_item_form.description.$error.maxlength">description\'s max length is 255 characters</div><div class="error" ng-show="new_bill_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="new_bill_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" bill="bill" input-id="new-bill-item-description" ng-model="new_bill_item"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_bill_item_amount(new_bill_item)" ng-model="new_bill_item.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-change="update_bill_item_amount(new_bill_item)" ng-model="new_bill_item.unit_price" required="true" step="any" type="number" /></div><div class="total"><input class="input-mini" ng-change="calculate_from_total(new_bill_item)" ng-model="new_bill_item.total" step="any" type="number" /></div><div class="pull-right" ng-show="new_bill_item.stock_id"><a href="javascript:void(0)" ng-click="show_stock(new_bill_item)"><i class="icon icon-info"></i><span>Info</span></a></div></div><div class="row-fluid"><div class="pull-left"><div><label class="checkbox"><input ng-click="update_buyin_price(new_bill_item)" ng-model="new_bill_item.is_buyin" type="checkbox" /><span>Is Buyin Item</span></label></div><div class="inline" ng-show="new_bill_item.is_buyin" style="margin-left: 20px"><label class="checkbox"><input ng-click="unset_sell_price(new_bill_item)" ng-model="new_bill_item.is_non_charge" type="checkbox" /><span>No charge</span></label></div><div ng-show="new_bill_item.is_buyin"><div ng-hide="new_bill_item.is_non_charge"><label class="inline" style="width: 120px">Sell Price</label><input class="input-small" ng-change="reset_markup_percentage(new_bill_item)" ng-model="new_bill_item.sell_price" step="any" type="number" /><span ng-show="markup_percentages(new_bill_item, true).length &gt; 0"><span>&nbsp;Markup:</span> <div class="inline" ng-repeat="percentage in markup_percentages(new_bill_item, true)"><button class="btn btn-link" ng-class="{&#39;selected-percentage&#39;: percentage == new_bill_item.markup_percentage}" ng-click="update_buyin_price(new_bill_item, percentage)" style="font-size: 90%" type="button">{{percentage}}%</button><span>&nbsp;::&nbsp;</span></div><button class="btn btn-link" ng-click="unset_sell_price(new_bill_item)" type="button">Unset</button></span></div><div><label class="inline" style="width: 120px">Warranty</label><ad-datepicker ng-model="new_bill_item.warranty_expiry_date"></ad-datepicker></div><div><label class="inline" style="width: 120px">Allocate To Job</label><ad-jobpicker job="new_bill_item.editing.job" ng-model="new_bill_item.job_id"></ad-jobpicker></div></div></div><div class="pull-right"><div><label class="checkbox"><input ng-model="new_bill_item.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="new_bill_item.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><br /><br /><div><button class="btn btn-success" ng-click="save_new_bill_item()" type="submit">Save</button><button class="btn" ng-click="cancel_add_bill_item()">Cancel</button><div class="pull-right"><div ad-new-stock="true" generic-item="new_bill_item" is-a-purchase="true" ng-model="new_stock" on-save="select_new_stock()"></div></div></div></div></form></div><div class="summary"><div><div class="title">Total Excl. {{tax_name()}}</div><div class="value">{{bill.net_amount | currency}}</div></div><div><div class="title">Total {{tax_name()}}</div><div class="value">{{bill.gst_amount | currency}}</div></div><div><div class="title">Total</div><div class="value">{{bill.total_item_amount | currency}}</div></div></div></div><div ad-purchase-order-selection="true" anchor-element="#add-related-purchase-order-button" on-select="save_selected_purchase_orders()" placement="right" selection="selected_purchase_orders" showing="showing_related_purchase_order" supplier="bill.supplier"></div><div ad-stock-info="true"></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bills/index.html",'<div ng-controller="BillsController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="page-header" id="bill-index-list">Bills<div class="pull-right"><form class="form-search form-inline form-search-invoice"><div class="inline"><button class="btn btn-link" ng-click="show_filter()" ng-hide="showing_filter" type="button">More Options</button><button class="btn btn-link" ng-click="hide_filter()" ng-show="showing_filter" type="button">Hide</button><div class="inline" ng-show="showing_filter"><label class="inline">Issued From:</label><ad-datepicker ng-model="query.issued_from"><span class="add-on"><i class="icon-calendar"></i></span></ad-datepicker><label class="inline">To:</label><ad-datepicker ng-model="query.issued_to"></ad-datepicker></div></div><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div></div><div class="search-description" ng-show="keyword">Search "{{keyword}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="row-fluid"><div class="pull-right"><div class="spinner inline" id="bill-bulk-action-spinner"></div><div class="dropdown inline" id="bill-bulk-actions"><a class="btn" dropdown-toggle="true"><i class="icon icon-list-alt"></i><span>Bulk Action...</span></a><ul class="dropdown-menu top-dropdown"><li><a href="javascript:void(0);" ng-click="bulk_finalize()"><i class="icon icon-print"></i><span>Finalize</span></a></li></ul></div><a class="btn btn-primary" ng-href="#/bills/new"><span>New Bill</span></a><a class="btn btn-primary" ng-href="#/bill_payments/new"><span>New Bill Payment</span></a><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="row-fluid"><div class="column span3"><label class="checkbox" ng-click="toggle_unpaid()"><input ng-model="showing_unpaid" type="checkbox" /><span class="label label-info">unpaid</span> <span>bills only</span></label><label class="checkbox" ng-click="toggle_paid()"><input ng-model="showing_paid" type="checkbox" /><span class="label label-success">paid</span> <span>bills only</span></label><label class="checkbox" ng-click="toggle_deleted()"><input ng-model="showing_deleted" type="checkbox" /><span class="label label-important">deleted</span> <span>bills only</span></label></div><div class="column span3"><label class="checkbox" ng-click="toggle_in_progress()"><input ng-model="showing_in_progress" type="checkbox" /><span class="label label-info">in progress</span> <span>bills only</span></label><label class="checkbox" ng-click="toggle_finalized()"><input ng-model="showing_finalized" type="checkbox" /><span class="label label-success">finalized</span> <span>bills only</span></label></div><div class="column span3"><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div></div><div class="spinner" id="bills-spinner"></div><div class="content-box"><table class="table table-striped" ng-show="query.deleted"><thead><tr><th class="column-sortable" ng-click="sort(&#39;number&#39;)">Bill Number</th><th class="column-sortable" ng-click="sort(&#39;reference&#39;)">Reference</th><th class="column-sortable" ng-click="sort(&#39;date&#39;)">Date</th><th>Supplier</th><th>Total</th><th>Deleted By</th><th>Delete Reason</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/bills/&#39; + bill.id)" ng-repeat="bill in bills"><td>#{{bill.number}}</td><td><div>{{bill.reference}}</div><div ad-tag-icons="true" owner="bill"></div></td><td>{{bill.date |date: \'mediumDate\'}}</td><td>{{bill.billing_supplier.name}}</td><td>{{bill.total_amount|currency}}</td><td>{{bill.deleted_by.name}}</td><td>{{bill.deleted_reason}}</td></tr></tbody></table><table class="table table-striped" ng-hide="query.deleted"><thead><tr><th class="column-sortable"><label class="checkbox inline"><input ng-click="toggle_select_all()" type="checkbox" /></label><div class="inline">&nbsp;</div><div class="invoice-list-item inline" ng-click="sort(&#39;number&#39;)">Bill No#</div></th><th class="column-sortable" ng-click="sort(&#39;reference&#39;)">Reference</th><th class="column-sortable" ng-click="sort(&#39;date&#39;)">Date</th><th>Supplier</th><th>Total</th><th>Status</th><th></th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/bills/&#39; + bill.id)" ng-repeat="bill in bills"><td><label class="checkbox"><input ng-model="bill.selected" stop-event="click" type="checkbox" /><div class="invoice-list-item-number">#{{bill.number}}</div></label></td><td><div>{{bill.reference}}</div><div ad-tag-icons="true" owner="bill"></div></td><td>{{bill.date |date: \'mediumDate\'}}</td><td>{{bill.supplier.name}}</td><td>{{bill.total_amount|currency}}</td><td ng-class="{green: bill.status==&#39;paid&#39;, red: bill.status != &#39;paid&#39;}">{{bill.status}}</td><td><span class="green" ng-show="bill.finalized">Finalized</span><span class="blue" ng-show="!bill.finalized">In progress</span><div class="pull-right"><a class="btn btn-link" href="javascript:void(0)" ng-click="preview(bill)" stop-event="click">Preview</a></div></td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination><div ad-bill-viewer="true" anchor-element="#bill-index-list" bill="previewed_bill" placement="bottom" showing="previewed_bill"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bills/new.html",'<div ng-controller="NewBillController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">New Bill</div><div class="row-fluid"><div class="content-box"><form autocomplete="off" class="form-horizontal" novalidate="true"><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><supplierpicker ng-model="bill.supplier_id" supplier="bill.supplier"></supplierpicker></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><div class="error" ng-show="bill.errors.reference">{{bill.errors.reference|error}}</div><input ng-model="bill.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker error="right" ng-model="bill.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Due Date</label><div class="controls"><ad-datepicker error="right" ng-model="bill.due_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><input class="input-small" ng-model="bill.total_amount" type="text" /></div></div><div class="control-group"><label class="control-label">Creditor/Buying Group</label><div class="controls"><div creditorpicker="true" ng-model="bill.billing_supplier_id"></div></div></div><div class="control-group" ng-show="purchase"><label class="control-label">Purchase Order</label><div class="controls"><div>#{{purchase.number}}</div><div><span class="bold">Supplier:</span> <span>{{purchase.supplier.name}}</span></div><div class="bold">Items:</div><div ng-repeat="item in purchase.purchase_items">{{item.description}}</div></div></div><div class="control-group"><label class="control-label">Expense/Purchase Account</label><div class="controls"><div accounts="input_accounts" ad-accounting-account-picker="true" ng-model="bill.accounting_account_id"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="bill"></div></div><br /><br /><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_bill()">Continue</button><button class="btn" ng-click="back()">Cancel</button><div class="inline"><div class="spinner" id="create-bill-spinner"></div></div></div></div></form></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bills/show.html",'<div ng-controller="ShowBillController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div ng-hide="bill &amp;&amp; bill.id"><div class="spinner" id="bill-loading"></div></div><div ng-show="bill &amp;&amp; bill.id"><div class="deleted-sign" ng-show="bill.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><div class="row-fluid"><div class="pull-left"><div class="page-header">Bill #{{bill.number}}</div></div><div class="pull-right"><div ng-show="bill.total_amount &gt; 0 &amp;&amp; bill.unpaid_amount == 0"><img class="paid-sign" ng-src="/assets/paid-d5240fc8cfeec7b14de62c19cf6d9848.gif" /></div><div ad-tag-labels="true" class="inline" owner="bill"></div><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="bill" placement="left" resource="Bill" showing="x_tags"></div></div></div><div class="row-fluid"><div class="pull-right"><a class="btn btn-primary" ng-hide="bill.deleted || bill.paid" ng-href="#/bill_payments/new?bill_id={{bill.id}}">Add Bill Payment</a><a class="btn" ng-href="#/bills/new?supplier_id={{bill.supplier_id}}">Add Bill From Same Supplier</a><button class="btn btn-danger" ng-click="open_delete_dialog()" ng-hide="bill.deleted">Delete</button></div></div><br /><div class="row-fluid"><div class="column span7"><div class="content-box"><div class="sub-header">Bill Details</div><div class="editable" ng-click="edit_bill()" ng-hide="bill.editing"><div class="info"><label class="label-name-left auto-width">Supplier:</label><span>{{bill.supplier.name}}</span></div><div class="info" ng-show="bill.billing_supplier &amp;&amp; bill.billing_supplier_id != bill.supplier_id"><label class="label-name-left auto-width">Creditor/Buying Group:</label><span>{{bill.billing_supplier.name}}</span></div><div class="info"><label class="label-name-left auto-width">Reference:</label><span>{{bill.reference}}</span></div><div class="info"><label class="label-name-left auto-width">Date:</label><span>{{bill.date | date: \'mediumDate\'}}</span></div><div class="info"><label class="label-name-left auto-width">Due Date:</label><span>{{bill.due_date | date: \'mediumDate\'}}</span></div><div class="info"><label class="label-name-left auto-width">Amount:</label><span class="bold">{{bill.total_amount|currency}}</span></div><div class="info"><label class="label-name-left auto-width">Paid:</label><span class="bold">{{bill.paid_amount|currency}}</span></div><div class="info"><label class="label-name-left auto-width">Remaining:</label><span class="bold">{{bill.unpaid_amount|currency}}</span></div><div class="info" ng-show="bill.accounting_account"><label class="label-name-left auto-width">Account:</label><span class="bold">{{bill.accounting_account.title}}</span></div><div class="info" ng-show="enable_tracking_category_selection()"><label class="label-name-left auto-width">Tracking Categories</label><div class="inline" style="min-width: 40px;">{{bill.tracking_categories|comma_seperated: \'option\'}}</div></div><div ng-show="!bill.total_amount_match_total_item_amount"><div class="red">Bill amount( {{bill.total_amount|currency}} ) does not match total item amount( {{bill.total_item_amount|currency}} )</div></div></div><div class="editing-item" ng-show="bill.editing"><form autocomplete="off" class="form-horizontal" novalidate="true"><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><supplierpicker ng-model="bill.editing.supplier_id" supplier="bill.editing.supplier"></supplierpicker></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><div class="error" ng-show="bill.editing.errors.reference">{{bill.editing.errors.reference|error}}</div><input ng-model="bill.editing.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker error="right" ng-model="bill.editing.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Due Date</label><div class="controls"><ad-datepicker error="right" ng-model="bill.editing.due_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><div class="input-append"><input class="input-small" ng-model="bill.editing.total_amount" type="text" /></div></div></div><div class="control-group"><label class="control-label">Creditor/Buying Group</label><div class="controls"><div class="input-append"><div creditorpicker="true" ng-model="bill.editing.billing_supplier_id"></div></div></div></div><div class="control-group"><label class="control-label">Expense/Purchase Account</label><div class="controls"><div accounts="input_accounts" ad-accounting-account-picker="true" ng-model="bill.editing.accounting_account_id"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="bill.editing"></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_bill()">Save</button><button class="btn" ng-click="cancel_edit_bill()">Cancel</button></div></div></form></div><div ng-show="bill.id"><div ng-hide="bill.finalized"><span class="label label-info">In progress</span><button class="btn btn-link" ng-click="finalize()">Finalize</button></div><div ng-show="bill.finalized"><span class="label label-success">Finalized</span></div></div><div class="row-fluid"><div class="pull-right"><label class="checkbox"><input ng-click="set_prices_include_gst()" ng-model="bill.supplier.prices_include_gst" type="checkbox" /><span>{{tax_name()}} Inclusive</span></label><label class="checkbox"><input ng-click="set_gst_free()" ng-model="bill.supplier.gst_free" type="checkbox" /><span>{{tax_name()}} Free</span></label><div class="spinner" id="bill-prices-gst-spinner"></div></div></div><hr /><div class="cost-table" id="bill-item-list"><div class="header"><div class="description">Name</div><div class="quantity">Qty.</div><div class="rate">Unit Price</div><div class="total">Total</div></div><div class="cost" id="bill-item-{{bill_item.id}}" ng-hide="bill_item.editing" ng-repeat="bill_item in bill.bill_items"><div class="editable" ng-click="edit_bill_item(bill_item)" ng-hide="bill_item.editing"><div class="description"><span class="label label-info" ng-show="bill_item.is_buyin">B</span><span>&nbsp;</span><span>{{bill_item.description}}</span></div><div class="quantity">{{bill_item.quantity}}</div><div class="rate">{{bill_item.unit_price|currency}}</div><div class="total">{{bill_item_total(bill_item) | currency}}</div><div class="included-gst"><span ng-show="bill_item.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="bill_item.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span><span ng-show="bill_item_total(bill_item) == 0">&nbsp; &nbsp;<i class="icon-warning-sign yellow" tooltip="Line Item total should not be 0"></i></span></div></div></div><div class="cost" id="editing-bill-item" ng-show="editing_bill_item"><div class="editing-item"><form autocomplete="off" name="edit_bill_item_form" novalidate="true"><div class="error" ng-show="edit_bill_item_form.description.$error.required">description is required</div><div class="error" ng-show="edit_bill_item_form.description.$error.maxlength">description\'s max length is 255 characters</div><div class="error" ng-show="edit_bill_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="edit_bill_item_form.unit_price.$invalid">unit price must be a number</div><div class="row-fluid"><div class="description"><div ad-invoice-item-input="true" bill="credit_note" ng-model="editing_bill_item.editing"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="bill_item_total(editing_bill_item.editing)" ng-model="editing_bill_item.editing.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-change="bill_item_total(editing_bill_item.editing)" ng-model="editing_bill_item.editing.unit_price" required="true" step="any" type="number" /></div><div class="total"><input class="input-mini" ng-change="calculate_from_total(editing_bill_item.editing)" ng-model="editing_bill_item.editing.total" step="any" type="number" /></div><div class="pull-right" ng-show="editing_bill_item.stock_id"><a href="javascript:void(0)" ng-click="show_stock(editing_bill_item)"><i class="icon icon-info"></i><span>Item Info</span></a></div></div><div class="row-fluid"><div class="pull-left"><div class="inline"><label class="checkbox"><input ng-click="unset_sell_price(editing_bill_item.editing)" ng-model="editing_bill_item.editing.is_buyin" type="checkbox" /><span>Is Buyin Item</span></label></div><div class="inline" ng-show="editing_bill_item.editing.is_buyin" style="margin-left: 20px"><label class="checkbox"><input ng-click="unset_sell_price(editing_bill_item.editing)" ng-model="editing_bill_item.editing.is_non_charge" type="checkbox" /><span>No charge</span></label></div><div ng-show="editing_bill_item.editing.is_buyin"><div ng-hide="editing_bill_item.editing.is_non_charge"><div><label class="inline" style="width: 120px">Sell Price</label><input class="input-small" ng-change="reset_markup_percentage(editing_bill_item.editing)" ng-model="editing_bill_item.editing.sell_price" step="any" type="number" /><span ng-show="markup_percentages(editing_bill_item.editing, true).length &gt; 0"><span>&nbsp;Markup:</span> <div class="inline" ng-repeat="percentage in markup_percentages(editing_bill_item.editing, true)"><button class="btn btn-link" ng-class="{&#39;selected-percentage&#39;: percentage == editing_bill_item.editing.markup_percentage}" ng-click="update_buyin_price(editing_bill_item.editing, percentage)" style="font-size: 90%" type="button">{{percentage}}%</button><span>&nbsp;::&nbsp;</span></div><button class="btn btn-link" ng-click="unset_sell_price(editing_bill_item.editing)" type="button">Unset</button></span></div><div ng-show="editing_bill_item.unit_price != editing_bill_item.editing.unit_price &amp;&amp; editing_bill_item.sell_price == editing_bill_item.editing.sell_price"><div class="warning inline underline">Buy price is updated, Do you want to update the sell price?</div><button class="btn btn-link" ng-click="update_buyin_price(editing_bill_item.editing)">Update Sell Price</button><br /><br /></div></div><div><label class="inline" style="width: 120px">Warranty</label><ad-datepicker ng-model="editing_bill_item.editing.warranty_expiry_date"></ad-datepicker></div><div><label class="inline" style="width: 120px">Allocate To Job</label><ad-jobpicker job="editing_bill_item.editing.job" ng-model="editing_bill_item.editing.job_id"></ad-jobpicker></div></div></div><div class="pull-right"><div><label class="checkbox"><input ng-model="editing_bill_item.editing.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="editing_bill_item.editing.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><br /><div class="button-panel"><div class="row-fluid"><div class="pull-left"><button class="btn btn-success" ng-click="save_bill_item(edit_bill_item_form, editing_bill_item)">Save</button><button class="btn" ng-click="cancel_edit_bill_item()">Cancel</button></div><div class="pull-right"><button class="btn btn-danger" ng-click="remove_bill_item(editing_bill_item)">Remove</button></div></div></div></form></div></div><div ng-hide="new_bill_item"><div><a href="javascript: void(0);" id="add-bill-item-button" ng-click="add_bill_item()">+ Item</a></div><div><a href="javascript: void(0);" id="add-related-purchase-order-button" ng-click="add_purchase_order()">+ Related supplier\'s purchase orders</a></div></div><div class="bill_item" ng-show="new_bill_item"><form autocomplete="off" name="new_bill_item_form" novalidate="true"><div class="editing-item"><div class="row-fluid"><div class="error" ng-show="new_bill_item_form.description.$error.required">description is required</div><div class="error" ng-show="new_bill_item_form.description.$error.maxlength">description\'s max length is 255 characters</div><div class="error" ng-show="new_bill_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="new_bill_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" bill="bill" input-id="new-bill-item-description" ng-model="new_bill_item"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_bill_item_amount(new_bill_item)" ng-model="new_bill_item.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-change="update_bill_item_amount(new_bill_item)" ng-model="new_bill_item.unit_price" required="true" step="any" type="number" /></div><div class="total"><input class="input-mini" ng-change="calculate_from_total(new_bill_item)" ng-model="new_bill_item.total" step="any" type="number" /></div><div class="pull-right" ng-show="new_bill_item.stock_id"><a href="javascript:void(0)" ng-click="show_stock(new_bill_item)"><i class="icon icon-info"></i><span>Info</span></a></div></div><div class="row-fluid"><div class="pull-left"><div><label class="checkbox"><input ng-click="update_buyin_price(new_bill_item)" ng-model="new_bill_item.is_buyin" type="checkbox" /><span>Is Buyin Item</span></label></div><div class="inline" ng-show="new_bill_item.is_buyin" style="margin-left: 20px"><label class="checkbox"><input ng-click="unset_sell_price(new_bill_item)" ng-model="new_bill_item.is_non_charge" type="checkbox" /><span>No charge</span></label></div><div ng-show="new_bill_item.is_buyin"><div ng-hide="new_bill_item.is_non_charge"><label class="inline" style="width: 120px">Sell Price</label><input class="input-small" ng-change="reset_markup_percentage(new_bill_item)" ng-model="new_bill_item.sell_price" step="any" type="number" /><span ng-show="markup_percentages(new_bill_item, true).length &gt; 0"><span>&nbsp;Markup:</span> <div class="inline" ng-repeat="percentage in markup_percentages(new_bill_item, true)"><button class="btn btn-link" ng-class="{&#39;selected-percentage&#39;: percentage == new_bill_item.markup_percentage}" ng-click="update_buyin_price(new_bill_item, percentage)" style="font-size: 90%" type="button">{{percentage}}%</button><span>&nbsp;::&nbsp;</span></div><button class="btn btn-link" ng-click="unset_sell_price(new_bill_item)" type="button">Unset</button></span></div><div><label class="inline" style="width: 120px">Warranty</label><ad-datepicker ng-model="new_bill_item.warranty_expiry_date"></ad-datepicker></div><div><label class="inline" style="width: 120px">Allocate To Job</label><ad-jobpicker job="new_bill_item.editing.job" ng-model="new_bill_item.job_id"></ad-jobpicker></div></div></div><div class="pull-right"><div><label class="checkbox"><input ng-model="new_bill_item.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="new_bill_item.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><br /><br /><div><button class="btn btn-success" ng-click="save_new_bill_item()" type="submit">Save</button><button class="btn" ng-click="cancel_add_bill_item()">Cancel</button><div class="pull-right"><div ad-new-stock="true" generic-item="new_bill_item" is-a-purchase="true" ng-model="new_stock" on-save="select_new_stock()"></div></div></div></div></form></div><div class="summary"><div><div class="title">Total Excl. {{tax_name()}}</div><div class="value">{{bill.net_amount | currency}}</div></div><div><div class="title">Total {{tax_name()}}</div><div class="value">{{bill.gst_amount | currency}}</div></div><div><div class="title">Total</div><div class="value">{{bill.total_item_amount | currency}}</div></div></div></div><div ad-purchase-order-selection="true" anchor-element="#add-related-purchase-order-button" on-select="save_selected_purchase_orders()" placement="right" selection="selected_purchase_orders" showing="showing_related_purchase_order" supplier="bill.supplier"></div><div ad-stock-info="true"></div></div></div><div class="column span5"><div class="content-box"><div class="sub-header">Payment</div><div ng-repeat="bill_payment in bill.bill_payments"><span>{{bill_payment.amount | currency}}</span><span>&nbsp; on &nbsp;</span><span>{{bill_payment.date | date: \'mediumDate\'}}</span><div class="pull-right"><a ng-href="#/bill_payments/{{bill_payment.original_bill_payment_id}}" ng-show="bill_payment.original_bill_payment_id">Details</a><a ng-href="#/supplier_credit_notes/{{bill_payment.supplier_credit_note_id}}" ng-show="bill_payment.supplier_credit_note_id">Details</a><a ng-href="#/bill_payments/{{bill_payment.id}}" ng-show="!bill_payment.supplier_credit_note_id &amp;&amp; !bill_payment.original_bill_payment_id">Details</a></div></div></div><div class="content-box"><div class="sub-header">Related Invoice</div><div class="spinner" id="related-invoices-spinner"></div><table class="table table-striped"><tbody><tr ng-repeat="invoice in bill.invoices"><td><a class="goto" ng-href="#/invoices/{{invoice.id}}"><span>Invoice #{{invoice.number}} - {{invoice.description}}</span></a><div class="pull-right"><button class="btn btn-link red" ng-click="remove_related_invoice(invoice)"><i class="icon icon-remove"></i></button></div></td></tr></tbody></table><hr /><a href="javascript:void(0);" id="add-related-invoice" ng-click="add_related_invoice()">+ Related Invoice</a><div ad-invoice-item-selection="true" anchor-element="#add-related-invoice" on-select="invoice_items_selected()" placement="left" selection="selected_invoice" showing="adding_related_invoice"></div></div><div class="content-box"><div class="sub-header">Related Purchase Orders</div><div class="spinner" id="related-purchases-spinner"></div><table class="table table-striped"><tbody><tr ng-repeat="po in bill.purchases"><td><a class="goto" ng-href="#/purchases/{{po.id}}"><span>Purchase Order #{{po.number}} - {{po.description}}</span></a></td></tr></tbody></table></div><div class="content-box invoice"><div class="sub-header"><div class="inline" id="bill-photos">Photos/Documents</div><div class="pull-right" ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_bill_files()">Upload</button></div></div><div class="bill-files" ng-hide="uploading_files"><div class="pull-right"></div><div class="inline bill-photo" ng-repeat="photo in bill.photos" style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><div ng-show="bill.documents.length &gt; 0"><div class="bold">Documents</div><div ng-repeat="document in bill.documents"><div class="editable" ng-click="edit_file(document)" ng-hide="document.editing"><span>{{document.file_name}} &nbsp;</span><a ng-href="{{document.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="document.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="document.editing.file_name" type="text" /></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(document)">Save</button><button class="btn" ng-click="cancel_edit_file(document)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(document)">Remove</button></div></form></div></div></div></div><div id="photo-viewer"><div class="popover fade right in" style="width: 800px; height: 1000px"><div class="popover-title"><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="full_size_photo()">Full Size</button><button class="btn" ng-click="close_photo_viewer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div style="height: 750px"><carousel><slide active="photo.active" ng-repeat="photo in bill.photos"><img ng-src="{{photo.url}}" style="margin:auto; max-width: 100%; max-height:750px;" /></slide></carousel></div></div><div class="row-fluid"><center><div class="inline job-photo" ng-class="{&#39;bill-photo-active&#39;: photo.active}" ng-repeat="photo in bill.photos"><div style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><button class="btn btn-danger" ng-click="remove_photo(photo)" ng-show="photo.active">Remove</button></div></center></div></div></div></div><form action="/bills/{{bill.id}}/upload_files" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /></div><br /><div class="inline" id="upload-photos-spinner"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form></div><div class="content-box" ng-show="bill.remote_id"><div class="sub-header">Accounting Integration</div><div>Synced To ID {{bill.remote_id}}</div><div ng-show="bill.remote_url"><span>Please click </span> <a ng-href="{{bill.remote_url}}" target="_blank">Here</a> <span>to access the bill in Accounting Software</span></div></div></div></div><div modal="showing_delete_bill_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this bill</h3></div><div class="modal-body"><div>Are you sure you want to delete this bill ?</div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_bill()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_bill()">Cancel</button></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("booking_requests/index.html",'<div ng-controller="BookingRequestsController"><ul class="sub-nav" ng-controller="BookingsNavController" ng-hide="links.length == 0"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i><span>{{link.name}}</span><span class="badge badge-notifications" ng-show="link.name == &#39;Online Booking Requests&#39; &amp;&amp; booking_request_count() &gt; 0" style="margin-left: 5px"><span class="red">{{booking_request_count()}}</span></span></a></li></ul><div class="row-fluid"><div class="page-header">Booking Requests</div></div><div class="row-fluid" ng-show="enabled()"><div class="spinner" id="booking-request-spinner"></div><div class="content-box"><table class="table table-striped"><thead><tr><th>Drop Off</th><th>Pick Up</th><th>Customer</th><th>Phone</th><th>Email</th><th>Vehicle</th><th>Note</th><th></th></tr></thead><tbody><tr ng-repeat="request in booking_requests"><td>{{request.drop_off_time | date}}</td><td>{{request.pickup_time | date}}</td><td>{{request.name}}</td><td><span>{{request.phone}}</span><span>{{request.mobile}}</span></td><td>{{request.email}}</td><td>{{request.registration_number}} {{request.make}} {{request.model}} {{request.year}}</td><td><pre class="no-style">{{request.note}}</pre></td><td><div class="pull-right"><div ng-show="request.confirmed"><span class="label label-success">Confirmed</span></div><div ng-hide="request.confirmed"><a class="btn btn-success" ng-href="#bookings/new?booking_request_id={{request.id}}">Confirm</a><button class="btn btn-danger" id="cancel-booking-request-{{request.id}}" ng-click="cancel_booking_request(request)">Cancel</button></div></div></td></tr></tbody></table></div></div><div id="booking-request-cancellation"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="pull-right"><i class="icon icon-remove goto" ng-click="close_booking_cancellation()"></i></div><div class="sub-header">Booking Request Cancellation</div></div><div class="popover-content"><div class="content-box"><span>Are you sure you want to cancel this booking request ?</span></div><div class="row-fluid"><div class="pull-right"><button class="btn btn-danger" ng-click="cancel_booking()">Yes</button><button class="btn" ng-click="close_booking_cancellation()">No</button></div></div></div></div></div><div class="row-fluid"><div class="content-box" ng-hide="enabled()"><div><span>Online Booking allow your customers to make booking directly from your website, the booking requests will go straight into the Online Booking Requests section for you to either Confirm or Reject. To Enable Online Booking Please click the button bellow if you are the workshop adminstrator</span> <br /><br /><br /><a class="btn btn-primary" href="#/online_booking">Enable Online Booking</a></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("booking_requests/list.html",'<div class="row-fluid" ng-show="enabled()"><div class="spinner" id="booking-request-spinner"></div><div class="content-box"><table class="table table-striped"><thead><tr><th>Drop Off</th><th>Pick Up</th><th>Customer</th><th>Phone</th><th>Email</th><th>Vehicle</th><th>Note</th><th></th></tr></thead><tbody><tr ng-repeat="request in booking_requests"><td>{{request.drop_off_time | date}}</td><td>{{request.pickup_time | date}}</td><td>{{request.name}}</td><td><span>{{request.phone}}</span><span>{{request.mobile}}</span></td><td>{{request.email}}</td><td>{{request.registration_number}} {{request.make}} {{request.model}} {{request.year}}</td><td><pre class="no-style">{{request.note}}</pre></td><td><div class="pull-right"><div ng-show="request.confirmed"><span class="label label-success">Confirmed</span></div><div ng-hide="request.confirmed"><a class="btn btn-success" ng-href="#bookings/new?booking_request_id={{request.id}}">Confirm</a><button class="btn btn-danger" id="cancel-booking-request-{{request.id}}" ng-click="cancel_booking_request(request)">Cancel</button></div></div></td></tr></tbody></table></div></div><div id="booking-request-cancellation"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="pull-right"><i class="icon icon-remove goto" ng-click="close_booking_cancellation()"></i></div><div class="sub-header">Booking Request Cancellation</div></div><div class="popover-content"><div class="content-box"><span>Are you sure you want to cancel this booking request ?</span></div><div class="row-fluid"><div class="pull-right"><button class="btn btn-danger" ng-click="cancel_booking()">Yes</button><button class="btn" ng-click="close_booking_cancellation()">No</button></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("booking_requests/setup.html",'<div class="row-fluid"><div class="content-box" ng-hide="enabled()"><div><span>Online Booking allow your customers to make booking directly from your website, the booking requests will go straight into the Online Booking Requests section for you to either Confirm or Reject. To Enable Online Booking Please click the button bellow if you are the workshop adminstrator</span> <br /><br /><br /><a class="btn btn-primary" href="#/online_booking">Enable Online Booking</a></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bookings/booking_list.html",'<div class="row-fluid"><div class="column span4"><div><label class="checkbox"><input ng-click="toggle_active()" ng-model="query.active" type="checkbox" /><span>Show</span> <span class="label label-success">Active </span> <span>Bookings Only</span></label></div><div><label class="checkbox"><input ng-click="toggle_deleted()" ng-model="query.deleted" type="checkbox" /><span>Show</span> <span class="label">Deleted </span> <span>Bookings Only</span></label></div></div><div class="column span4" style="vertical-align: bottom"><div>&nbsp;</div><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div></div><div class="content-box"><div class="spinner" id="bookings-spinner"></div><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span1"><div class="job-list-item">Booking #</div></div><div class="column span1"><div class="job-list-item">Date</div></div><div class="column span2"><div class="job-list-item">Description</div></div><div class="column span2"><div class="job-list-item" ng-hide="query.deleted">Created By</div><div class="job-list-item" ng-show="query.deleted">Deleted By</div></div><div class="column span2"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span1"><div class="job-list-item" ng-show="asset_property_set().fleet_number">Fleet No.</div></div><div class="column span2"><div class="job-list-item">Customer</div></div><div class="column span1"></div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="booking in bookings"><td id="booking-{{booking.id}}" ng-click="preview(booking)"><div class="row-fluid"><div class="column span1"><div class="job-list-item">{{booking.number}}</div></div><div class="column span1"><div class="job-list-item">{{booking.time | date: \'shortDate\'}}</div></div><div class="column span2"><div class="job-list-item-description" ng-show="booking.full_description">{{booking.full_description}}</div><div class="job-list-item-order-number" ng-show="booking.order_number">Order #{{booking.order_number}}</div><div ad-tag-icons="true" class="job-list-item" owner="booking"></div></div><div class="column span2"><div class="job-list-item" ng-hide="booking.deleted">{{booking.created_by}}</div><div class="job-list-item" ng-show="booking.deleted">{{booking.deleted_by.name}}</div></div><div class="column span2"><div class="job-list-item" tooltip="{{booking.vehicle|vehicle_title}}">{{booking.vehicle|vehicle_title}}</div></div><div class="column span1"><div class="job-list-item" ng-show="asset_property_set().fleet_number">{{booking.vehicle.fleet_number}}</div></div><div class="column span2"><div class="job-list-item">{{booking.customer.name}}</div><div class="job-list-item">{{booking.customer.phone || booking.customer.mobile}}</div></div><div class="column span1" ng-show="query.deleted"><button class="btn" ng-click="undelete_booking(booking)" stop-event="click">Undelete</button></div></div></td></tr></tbody></table></div><div id="booking-preview"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Booking {{booking.title}}</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div class="row-fluid"><div class="column span6"><div class="info" ng-show="booking.order_number"><span class="label-name-left auto-width">Order Number:</span>{{booking.order_number}}</div><div class="info" ng-show="booking.quote"><span class="label-name-left auto-width">Quote Number:</span>{{booking.quote.number}}</div><div class="info" ng-show="booking.time"><span class="label-name-left auto-width">Date:</span>{{booking.time | date: \'mediumDate\'}}</div><div class="info" ng-show="booking.total_hours"><span class="label-name-left auto-width">Estimate:</span>{{booking.total_hours}} hours</div><div class="info" ng-show="booking.pickup_time"><span class="label-name-left auto-width">Pickup time:</span>{{booking.pickup_time | date: \'short\'}}</div><div class="info" ng-show="booking.job_types_title.length &gt; 0"><span class="label-name-left auto-width">Job Type:</span><span class="inline" style="max-width: 200px">{{booking.job_types_title}}</span></div><div class="info" ng-show="booking.odometer"><span class="label-name-left auto-width">Odometer:</span><span ng-show="booking.odometer">{{booking.odometer|number}} {{booking.vehicle.odometer_unit}}</span><span ng-hide="booking.odometer">(Not Available)</span></div><div class="info" ng-show="asset_property_set().machine_hours"><span class="label-name-left auto-width">Machine Hours:</span><span ng-show="booking.machine_hours">{{booking.machine_hours|number}} hr(s)</span><span ng-hide="booking.machine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().engine_hours"><span class="label-name-left auto-width">Engine Hours:</span><span ng-show="booking.engine_hours">{{booking.engine_hours|number}} hr(s)</span><span ng-hide="booking.engine_hours">(Not Available)</span></div><div class="info" ng-show="show_hubodometer()"><span class="label-name-left auto-width">Hubodometer:</span><span ng-show="booking.hubodometer">{{booking.hubodometer|number}} {{booking.vehicle.odometer_unit}}</span><span ng-hide="booking.hubodometer">(Not Available)</span></div></div><div class="column span6"><div class="info"><span class="label-name-left auto-width">Customer:</span>{{booking.customer.name}}</div><div class="info"><span class="label-name-left auto-width">Mobile:</span>{{booking.customer.mobile|na}}</div><div class="info"><span class="label-name-left auto-width">Phone:</span>{{booking.customer.phone|na}}</div><div class="info"><span class="label-name-left auto-width">Email:</span>{{booking.customer.email|na}}</div><br /><br /><div class="info"><span class="label-name-left auto-width">Vehicle:</span>{{booking.vehicle.title}}</div><div class="info"><span class="label-name-left auto-width">Registration Number:</span>{{booking.vehicle.registration_number}}</div><div class="info" ng-show="booking.vehicle.fleet_number"><span class="label-name-left auto-width">Fleet Number:</span>{{booking.vehicle.fleet_number}}</div></div></div></div><div class="button-panel"><div class="row-fluid"><div class="inline" ng-hide="booking.deleted"><div class="inline"><a class="btn" href="#/bookings/{{booking.id}}/edit" ng-hide="booking.job_id" target="_blank"><i class="icon-pencil"></i>Edit</a></div><div class="inline" ng-hide="booking.job_id"><a class="btn btn-primary" href="#/jobs/new?booking={{booking.id}}&amp;prepare=true"><i class="icon-pencil"></i>Prepare</a><a class="btn btn-success" href="#/jobs/new?booking={{booking.id}}"><i class="icon-ok"></i>Start</a></div><div class="inline green" ng-show="booking.job_id"><i class="icon-ok"></i><a ng-href="#/jobs/{{booking.job_id}}">Go To Job Page</a></div></div><div class="inline">&nbsp;<button class="btn" ng-click="close_preview()">Close</button><br /></div><div class="pull-right" ng-hide="booking.deleted"><button class="btn btn-small btn-danger remove inline" ng-click="delete_booking()"><i class="icon-remove"></i>Remove</button></div><div class="pull-right" ng-show="booking.deleted"><button class="btn inline" ng-click="undelete_booking()">Undelete</button></div></div><div class="row-fluid"><div class="spinner" id="edit-booking-spinner"></div></div></div></div></div></div></div><div modal="showing_delete_booking_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this booking</h3></div><div class="modal-body"><div>Are you sure you want to delete this Booking?</div><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea><div class="modal-footer"><div class="spinner" id="delete-job-spinner"></div><button class="btn btn-danger" ng-click="do_delete_booking()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_booking()">Cancel</button></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bookings/edit.html",'<div ng-controller="EditBookingController"><div class="row-fluid"><div class="page-header">Edit Booking {{booking.title}}<div class="pull-right"><button class="btn" ng-click="back()"><i class="icon-arrow-left"></i>Back</button></div></div></div><div id="edit-booking-spinner"></div><div class="content-box"><div class="row-fluid" ng-controller="UpdateBookingController"><div class="column span7" ng-show="booking.id"><form class="form-horizontal" name="booking_form" novalidate="true"><input ng-model="booking.customer_id" type="hidden" /><input ng-model="booking.vehicle_id" type="hidden" /><div ad-customer-vehicle-form="true" customer="booking.customer" recommendations="recommendations" selection="selection" vehicle="booking.vehicle"></div><div class="sub-header">Job</div><div class="control-group"><label class="control-label"><div>Invoice To 3rd Party</div><div ad-3rd-party-explain="true"></div></label><div class="controls"><insurerpicker ng-model="booking.insurer_id"></insurerpicker></div></div><div ng-model="booking" royaltypicker="true"></div><div class="control-group"><label class="control-label">Short Description</label><div class="controls"><input class="input span12" maxlength="255" ng-model="booking.description" type="text" /></div></div><div class="control-group"><label class="control-label">Note/More Details</label><div class="controls"><button class="btn btn-link" ng-click="add_note()" ng-hide="show_note">Add a note</button><textarea class="job-note" ng-model="booking.note" ng-show="show_note" type="text"></textarea></div></div><div class="control-group"><label class="control-label">Job Types</label><div class="controls"><div ad-job-type-selection="true" ng-model="booking.job_type_ids" on-change="calculate_estimate_work_hours(old, value)"></div></div></div><div class="control-group" ng-show="booking.insurer_id"><label class="control-label">Claim No.#</label><div class="controls"><input ng-model="booking.claim_number" type="text" /></div></div><div class="control-group" ng-show="booking.insurer_id"><label class="control-label">Account No.#</label><div class="controls"><input ng-model="booking.account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Mechanics</label><div class="controls"><span ad-employee-tag="true" employees="booking.employees" empty=""></span><button class="btn btn-link" ng-click="show_assign_to_mechanics()" ng-hide="showing_assign_to_mechanics">Assign</button><div ng-show="showing_assign_to_mechanics"><button class="btn btn-link" ng-click="show_schedule()">Show Schedule</button><div id="show-schedule-position" style="position: absolute, margin-left: 500px; visibility: hidden"></div><div><label class="label-name-left">Mechanic 1:</label><select ng-model="booking.mechanic_1_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(1)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 2:</label><select ng-model="booking.mechanic_2_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(2)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 3:</label><select ng-model="booking.mechanic_3_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(3)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 4:</label><select ng-model="booking.mechanic_4_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(4)"><div class="icon icon-remove red"></div></a></div></div></div></div><div class="control-group"><label class="control-label">Booking Time</label><div class="controls"><div id="show-courtesy-booking-form-position" style="position: absolute, margin-left: 500px; visibility: hidden"></div><ad-datepicker error="top" ng-model="booking.time"></ad-datepicker><ad-timepicker ng-model="booking.time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimated Finished Time</label><div class="controls"><ad-datepicker error="top" ng-model="booking.finished_time"></ad-datepicker><ad-timepicker ng-model="booking.finished_time"></ad-timepicker></div></div><div class="control-group" ng-hide="provide_mobile_service()"><label class="control-label">Pick up time</label><div class="controls"><ad-datepicker error="top" ng-model="booking.pickup_time"></ad-datepicker><ad-timepicker ng-model="booking.pickup_time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimated Work Hours</label><div class="controls"><input class="input-tiny" ng-model="booking.total_hours" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Order Number</label><div class="controls"><input class="input-small" ng-model="booking.order_number" type="text" /></div></div><div class="control-group"><label class="control-label">Odometer</label><div class="controls"><input class="input-small" ng-model="booking.odometer" step="any" type="number" /></div></div><div class="control-group" ng-show="asset_property_set().machine_hours"><label class="control-label">Machine Hours</label><div class="controls"><input class="input-small" ng-model="booking.machine_hours" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Courtesy {{asset_name()}}</label><div class="controls"><input id="booking-courtesy-vehicle-checkbox" ng-click="toggle_courtesy_vehicle_bookings()" ng-model="booking.replacement_provided" type="checkbox" /><div ng-show="booking.courtesy_vehicle_booking.vehicle_id" style="margin-left: 20px; margin-top: -17px;"><div class="inline">Booking selected for {{booking.courtesy_vehicle_booking.vehicle.title}}</div><a class="inline" href="javascript:void(0)" ng-click="show_courtesy_vehicle_bookings()" style="margin-left: 5px;" target="_blank">Edit</a></div></div></div><div class="control-group"><label class="control-label"><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="booking" placement="top" showing="x_tags"></div></label><div class="controls"><div ad-tag-labels="true" owner="booking"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="booking"></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="save(booking_form)">Save</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="saving-booking"></div><div class="pull-right" ng-show="booking.id"><div class="inline"><div class="inline" ng-hide="booking.job_id"><button class="btn btn-small btn-primary" ng-click="prepare(booking_form)" type="button"><i class="icon-pencil"></i>Prepare</button><button class="btn btn-small btn-success" ng-click="start(booking_form)" type="button"><i class="icon-ok"></i>Start</button></div><div class="inline green" ng-show="booking.job_id"><i class="icon-ok"></i><a ng-href="#/jobs/{{booking.job_id}}">Go To Job Page</a></div><div class="pull-right"><button class="btn btn-small btn-danger remove inline" ng-click="remove_booking(booking)"><i class="icon-remove"></i>Remove</button></div></div></div></div></div></form><div id="courtesy-vehicle-booking-form"><div class="popover fade top in" style="min-width: 900px; width: 50%"><div class="arrow"></div><div class="popover-title"><div class="sub-header">Courtesy Vehicle Booking<div class="pull-right"><button class="btn" ng-click="hide_courtesy_vehicle_bookings()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div class="column span12"><div ad-courtesy-vehicle-availability="true" job="booking" on-select-vehicle="on_book_courtesy_vehicle()"></div></div></div><div class="row-fluid"><button class="btn" ng-click="hide_courtesy_vehicle_bookings()"><i class="icon-remove"></i>Close</button></div></div></div></div></div><div class="column span5" ng-show="booking.id"><div ad-customer-vehicle-recommendations="true" ng-model="recommendations" selection="selection"></div></div><div modal="showing_delete_booking_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this booking</h3></div><div class="modal-body"><div>Are you sure you want to delete this Booking?</div><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea><div class="modal-footer"><div class="spinner" id="delete-job-spinner"></div><button class="btn btn-danger" ng-click="do_delete_booking()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_booking()">Cancel</button></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bookings/filters.html",'<div class="tab-content"><div class="tab-pane active" id="#/all_jobs"><div class="row-fluid"><div class="column span4"><div class="page-header">Bookings</div></div><div class="column span8"><div class="pull-right"><div style="margin-right: 10px"><span class="bold">Showing Bookings From &nbsp;</span><ad-datepicker ng-change="search()" ng-model="query.start"></ad-datepicker></div><form class="form-search"><input class="search-query" id="all-jobs-search-input" ng-model="query.query" type="text" />&nbsp;<button class="btn btn-primary" ng-click="search()" type="submit"><i class="icon-search"></i>Search</button></form></div></div></div><div class="search-description" ng-show="query.query">Search "{{query.query}}"<br />Page {{page_number}} of {{total_pages}}</div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bookings/form.html",'<form class="form-horizontal" name="booking_form" novalidate="true"><input ng-model="booking.customer_id" type="hidden" /><input ng-model="booking.vehicle_id" type="hidden" /><div ad-customer-vehicle-form="true" customer="booking.customer" recommendations="recommendations" selection="selection" vehicle="booking.vehicle"></div><div class="sub-header">Job</div><div class="control-group"><label class="control-label"><div>Invoice To 3rd Party</div><div ad-3rd-party-explain="true"></div></label><div class="controls"><insurerpicker ng-model="booking.insurer_id"></insurerpicker></div></div><div ng-model="booking" royaltypicker="true"></div><div class="control-group"><label class="control-label">Short Description</label><div class="controls"><input class="input span12" maxlength="255" ng-model="booking.description" type="text" /></div></div><div class="control-group"><label class="control-label">Note/More Details</label><div class="controls"><button class="btn btn-link" ng-click="add_note()" ng-hide="show_note">Add a note</button><textarea class="job-note" ng-model="booking.note" ng-show="show_note" type="text"></textarea></div></div><div class="control-group"><label class="control-label">Job Types</label><div class="controls"><div ad-job-type-selection="true" ng-model="booking.job_type_ids" on-change="calculate_estimate_work_hours(old, value)"></div></div></div><div class="control-group" ng-show="booking.insurer_id"><label class="control-label">Claim No.#</label><div class="controls"><input ng-model="booking.claim_number" type="text" /></div></div><div class="control-group" ng-show="booking.insurer_id"><label class="control-label">Account No.#</label><div class="controls"><input ng-model="booking.account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Mechanics</label><div class="controls"><span ad-employee-tag="true" employees="booking.employees" empty=""></span><button class="btn btn-link" ng-click="show_assign_to_mechanics()" ng-hide="showing_assign_to_mechanics">Assign</button><div ng-show="showing_assign_to_mechanics"><button class="btn btn-link" ng-click="show_schedule()">Show Schedule</button><div id="show-schedule-position" style="position: absolute, margin-left: 500px; visibility: hidden"></div><div><label class="label-name-left">Mechanic 1:</label><select ng-model="booking.mechanic_1_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(1)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 2:</label><select ng-model="booking.mechanic_2_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(2)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 3:</label><select ng-model="booking.mechanic_3_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(3)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 4:</label><select ng-model="booking.mechanic_4_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(4)"><div class="icon icon-remove red"></div></a></div></div></div></div><div class="control-group"><label class="control-label">Booking Time</label><div class="controls"><div id="show-courtesy-booking-form-position" style="position: absolute, margin-left: 500px; visibility: hidden"></div><ad-datepicker error="top" ng-model="booking.time"></ad-datepicker><ad-timepicker ng-model="booking.time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimated Finished Time</label><div class="controls"><ad-datepicker error="top" ng-model="booking.finished_time"></ad-datepicker><ad-timepicker ng-model="booking.finished_time"></ad-timepicker></div></div><div class="control-group" ng-hide="provide_mobile_service()"><label class="control-label">Pick up time</label><div class="controls"><ad-datepicker error="top" ng-model="booking.pickup_time"></ad-datepicker><ad-timepicker ng-model="booking.pickup_time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimated Work Hours</label><div class="controls"><input class="input-tiny" ng-model="booking.total_hours" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Order Number</label><div class="controls"><input class="input-small" ng-model="booking.order_number" type="text" /></div></div><div class="control-group"><label class="control-label">Odometer</label><div class="controls"><input class="input-small" ng-model="booking.odometer" step="any" type="number" /></div></div><div class="control-group" ng-show="asset_property_set().machine_hours"><label class="control-label">Machine Hours</label><div class="controls"><input class="input-small" ng-model="booking.machine_hours" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Courtesy {{asset_name()}}</label><div class="controls"><input id="booking-courtesy-vehicle-checkbox" ng-click="toggle_courtesy_vehicle_bookings()" ng-model="booking.replacement_provided" type="checkbox" /><div ng-show="booking.courtesy_vehicle_booking.vehicle_id" style="margin-left: 20px; margin-top: -17px;"><div class="inline">Booking selected for {{booking.courtesy_vehicle_booking.vehicle.title}}</div><a class="inline" href="javascript:void(0)" ng-click="show_courtesy_vehicle_bookings()" style="margin-left: 5px;" target="_blank">Edit</a></div></div></div><div class="control-group"><label class="control-label"><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="booking" placement="top" showing="x_tags"></div></label><div class="controls"><div ad-tag-labels="true" owner="booking"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="booking"></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="save(booking_form)">Save</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="saving-booking"></div><div class="pull-right" ng-show="booking.id"><div class="inline"><div class="inline" ng-hide="booking.job_id"><button class="btn btn-small btn-primary" ng-click="prepare(booking_form)" type="button"><i class="icon-pencil"></i>Prepare</button><button class="btn btn-small btn-success" ng-click="start(booking_form)" type="button"><i class="icon-ok"></i>Start</button></div><div class="inline green" ng-show="booking.job_id"><i class="icon-ok"></i><a ng-href="#/jobs/{{booking.job_id}}">Go To Job Page</a></div><div class="pull-right"><button class="btn btn-small btn-danger remove inline" ng-click="remove_booking(booking)"><i class="icon-remove"></i>Remove</button></div></div></div></div></div></form><div id="courtesy-vehicle-booking-form"><div class="popover fade top in" style="min-width: 900px; width: 50%"><div class="arrow"></div><div class="popover-title"><div class="sub-header">Courtesy Vehicle Booking<div class="pull-right"><button class="btn" ng-click="hide_courtesy_vehicle_bookings()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div class="column span12"><div ad-courtesy-vehicle-availability="true" job="booking" on-select-vehicle="on_book_courtesy_vehicle()"></div></div></div><div class="row-fluid"><button class="btn" ng-click="hide_courtesy_vehicle_bookings()"><i class="icon-remove"></i>Close</button></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bookings/index.html",'<div ng-controller="BookingsController"><ul class="sub-nav" ng-controller="BookingsNavController" ng-hide="links.length == 0"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i><span>{{link.name}}</span><span class="badge badge-notifications" ng-show="link.name == &#39;Online Booking Requests&#39; &amp;&amp; booking_request_count() &gt; 0" style="margin-left: 5px"><span class="red">{{booking_request_count()}}</span></span></a></li></ul><div class="tab-content"><div class="tab-pane active" id="#/all_jobs"><div class="row-fluid"><div class="column span4"><div class="page-header">Bookings</div></div><div class="column span8"><div class="pull-right"><div style="margin-right: 10px"><span class="bold">Showing Bookings From &nbsp;</span><ad-datepicker ng-change="search()" ng-model="query.start"></ad-datepicker></div><form class="form-search"><input class="search-query" id="all-jobs-search-input" ng-model="query.query" type="text" />&nbsp;<button class="btn btn-primary" ng-click="search()" type="submit"><i class="icon-search"></i>Search</button></form></div></div></div><div class="search-description" ng-show="query.query">Search "{{query.query}}"<br />Page {{page_number}} of {{total_pages}}</div></div></div><div class="row-fluid"><div class="column span4"><div><label class="checkbox"><input ng-click="toggle_active()" ng-model="query.active" type="checkbox" /><span>Show</span> <span class="label label-success">Active </span> <span>Bookings Only</span></label></div><div><label class="checkbox"><input ng-click="toggle_deleted()" ng-model="query.deleted" type="checkbox" /><span>Show</span> <span class="label">Deleted </span> <span>Bookings Only</span></label></div></div><div class="column span4" style="vertical-align: bottom"><div>&nbsp;</div><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div></div><div class="content-box"><div class="spinner" id="bookings-spinner"></div><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span1"><div class="job-list-item">Booking #</div></div><div class="column span1"><div class="job-list-item">Date</div></div><div class="column span2"><div class="job-list-item">Description</div></div><div class="column span2"><div class="job-list-item" ng-hide="query.deleted">Created By</div><div class="job-list-item" ng-show="query.deleted">Deleted By</div></div><div class="column span2"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span1"><div class="job-list-item" ng-show="asset_property_set().fleet_number">Fleet No.</div></div><div class="column span2"><div class="job-list-item">Customer</div></div><div class="column span1"></div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="booking in bookings"><td id="booking-{{booking.id}}" ng-click="preview(booking)"><div class="row-fluid"><div class="column span1"><div class="job-list-item">{{booking.number}}</div></div><div class="column span1"><div class="job-list-item">{{booking.time | date: \'shortDate\'}}</div></div><div class="column span2"><div class="job-list-item-description" ng-show="booking.full_description">{{booking.full_description}}</div><div class="job-list-item-order-number" ng-show="booking.order_number">Order #{{booking.order_number}}</div><div ad-tag-icons="true" class="job-list-item" owner="booking"></div></div><div class="column span2"><div class="job-list-item" ng-hide="booking.deleted">{{booking.created_by}}</div><div class="job-list-item" ng-show="booking.deleted">{{booking.deleted_by.name}}</div></div><div class="column span2"><div class="job-list-item" tooltip="{{booking.vehicle|vehicle_title}}">{{booking.vehicle|vehicle_title}}</div></div><div class="column span1"><div class="job-list-item" ng-show="asset_property_set().fleet_number">{{booking.vehicle.fleet_number}}</div></div><div class="column span2"><div class="job-list-item">{{booking.customer.name}}</div><div class="job-list-item">{{booking.customer.phone || booking.customer.mobile}}</div></div><div class="column span1" ng-show="query.deleted"><button class="btn" ng-click="undelete_booking(booking)" stop-event="click">Undelete</button></div></div></td></tr></tbody></table></div><div id="booking-preview"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Booking {{booking.title}}</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div class="row-fluid"><div class="column span6"><div class="info" ng-show="booking.order_number"><span class="label-name-left auto-width">Order Number:</span>{{booking.order_number}}</div><div class="info" ng-show="booking.quote"><span class="label-name-left auto-width">Quote Number:</span>{{booking.quote.number}}</div><div class="info" ng-show="booking.time"><span class="label-name-left auto-width">Date:</span>{{booking.time | date: \'mediumDate\'}}</div><div class="info" ng-show="booking.total_hours"><span class="label-name-left auto-width">Estimate:</span>{{booking.total_hours}} hours</div><div class="info" ng-show="booking.pickup_time"><span class="label-name-left auto-width">Pickup time:</span>{{booking.pickup_time | date: \'short\'}}</div><div class="info" ng-show="booking.job_types_title.length &gt; 0"><span class="label-name-left auto-width">Job Type:</span><span class="inline" style="max-width: 200px">{{booking.job_types_title}}</span></div><div class="info" ng-show="booking.odometer"><span class="label-name-left auto-width">Odometer:</span><span ng-show="booking.odometer">{{booking.odometer|number}} {{booking.vehicle.odometer_unit}}</span><span ng-hide="booking.odometer">(Not Available)</span></div><div class="info" ng-show="asset_property_set().machine_hours"><span class="label-name-left auto-width">Machine Hours:</span><span ng-show="booking.machine_hours">{{booking.machine_hours|number}} hr(s)</span><span ng-hide="booking.machine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().engine_hours"><span class="label-name-left auto-width">Engine Hours:</span><span ng-show="booking.engine_hours">{{booking.engine_hours|number}} hr(s)</span><span ng-hide="booking.engine_hours">(Not Available)</span></div><div class="info" ng-show="show_hubodometer()"><span class="label-name-left auto-width">Hubodometer:</span><span ng-show="booking.hubodometer">{{booking.hubodometer|number}} {{booking.vehicle.odometer_unit}}</span><span ng-hide="booking.hubodometer">(Not Available)</span></div></div><div class="column span6"><div class="info"><span class="label-name-left auto-width">Customer:</span>{{booking.customer.name}}</div><div class="info"><span class="label-name-left auto-width">Mobile:</span>{{booking.customer.mobile|na}}</div><div class="info"><span class="label-name-left auto-width">Phone:</span>{{booking.customer.phone|na}}</div><div class="info"><span class="label-name-left auto-width">Email:</span>{{booking.customer.email|na}}</div><br /><br /><div class="info"><span class="label-name-left auto-width">Vehicle:</span>{{booking.vehicle.title}}</div><div class="info"><span class="label-name-left auto-width">Registration Number:</span>{{booking.vehicle.registration_number}}</div><div class="info" ng-show="booking.vehicle.fleet_number"><span class="label-name-left auto-width">Fleet Number:</span>{{booking.vehicle.fleet_number}}</div></div></div></div><div class="button-panel"><div class="row-fluid"><div class="inline" ng-hide="booking.deleted"><div class="inline"><a class="btn" href="#/bookings/{{booking.id}}/edit" ng-hide="booking.job_id" target="_blank"><i class="icon-pencil"></i>Edit</a></div><div class="inline" ng-hide="booking.job_id"><a class="btn btn-primary" href="#/jobs/new?booking={{booking.id}}&amp;prepare=true"><i class="icon-pencil"></i>Prepare</a><a class="btn btn-success" href="#/jobs/new?booking={{booking.id}}"><i class="icon-ok"></i>Start</a></div><div class="inline green" ng-show="booking.job_id"><i class="icon-ok"></i><a ng-href="#/jobs/{{booking.job_id}}">Go To Job Page</a></div></div><div class="inline">&nbsp;<button class="btn" ng-click="close_preview()">Close</button><br /></div><div class="pull-right" ng-hide="booking.deleted"><button class="btn btn-small btn-danger remove inline" ng-click="delete_booking()"><i class="icon-remove"></i>Remove</button></div><div class="pull-right" ng-show="booking.deleted"><button class="btn inline" ng-click="undelete_booking()">Undelete</button></div></div><div class="row-fluid"><div class="spinner" id="edit-booking-spinner"></div></div></div></div></div></div></div><div modal="showing_delete_booking_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this booking</h3></div><div class="modal-body"><div>Are you sure you want to delete this Booking?</div><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea><div class="modal-footer"><div class="spinner" id="delete-job-spinner"></div><button class="btn btn-danger" ng-click="do_delete_booking()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_booking()">Cancel</button></div></div></div><div ng-show="total_pages &gt; 1"><pagination boundary-links="true" current-page="page_number" max-size="20" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bookings/new.html",'<div ng-controller="NewBookingController"><div class="row-fluid"><div class="page-header">New Booking<div class="pull-right"><button class="btn" ng-click="back()"><i class="icon-arrow-left"></i>Back</button></div></div></div><div class="content-box"><div class="row-fluid" ng-controller="UpdateBookingController"><div class="column span7"><form class="form-horizontal" name="booking_form" novalidate="true"><input ng-model="booking.customer_id" type="hidden" /><input ng-model="booking.vehicle_id" type="hidden" /><div ad-customer-vehicle-form="true" customer="booking.customer" recommendations="recommendations" selection="selection" vehicle="booking.vehicle"></div><div class="sub-header">Job</div><div class="control-group"><label class="control-label"><div>Invoice To 3rd Party</div><div ad-3rd-party-explain="true"></div></label><div class="controls"><insurerpicker ng-model="booking.insurer_id"></insurerpicker></div></div><div ng-model="booking" royaltypicker="true"></div><div class="control-group"><label class="control-label">Short Description</label><div class="controls"><input class="input span12" maxlength="255" ng-model="booking.description" type="text" /></div></div><div class="control-group"><label class="control-label">Note/More Details</label><div class="controls"><button class="btn btn-link" ng-click="add_note()" ng-hide="show_note">Add a note</button><textarea class="job-note" ng-model="booking.note" ng-show="show_note" type="text"></textarea></div></div><div class="control-group"><label class="control-label">Job Types</label><div class="controls"><div ad-job-type-selection="true" ng-model="booking.job_type_ids" on-change="calculate_estimate_work_hours(old, value)"></div></div></div><div class="control-group" ng-show="booking.insurer_id"><label class="control-label">Claim No.#</label><div class="controls"><input ng-model="booking.claim_number" type="text" /></div></div><div class="control-group" ng-show="booking.insurer_id"><label class="control-label">Account No.#</label><div class="controls"><input ng-model="booking.account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Mechanics</label><div class="controls"><span ad-employee-tag="true" employees="booking.employees" empty=""></span><button class="btn btn-link" ng-click="show_assign_to_mechanics()" ng-hide="showing_assign_to_mechanics">Assign</button><div ng-show="showing_assign_to_mechanics"><button class="btn btn-link" ng-click="show_schedule()">Show Schedule</button><div id="show-schedule-position" style="position: absolute, margin-left: 500px; visibility: hidden"></div><div><label class="label-name-left">Mechanic 1:</label><select ng-model="booking.mechanic_1_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(1)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 2:</label><select ng-model="booking.mechanic_2_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(2)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 3:</label><select ng-model="booking.mechanic_3_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(3)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 4:</label><select ng-model="booking.mechanic_4_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(4)"><div class="icon icon-remove red"></div></a></div></div></div></div><div class="control-group"><label class="control-label">Booking Time</label><div class="controls"><div id="show-courtesy-booking-form-position" style="position: absolute, margin-left: 500px; visibility: hidden"></div><ad-datepicker error="top" ng-model="booking.time"></ad-datepicker><ad-timepicker ng-model="booking.time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimated Finished Time</label><div class="controls"><ad-datepicker error="top" ng-model="booking.finished_time"></ad-datepicker><ad-timepicker ng-model="booking.finished_time"></ad-timepicker></div></div><div class="control-group" ng-hide="provide_mobile_service()"><label class="control-label">Pick up time</label><div class="controls"><ad-datepicker error="top" ng-model="booking.pickup_time"></ad-datepicker><ad-timepicker ng-model="booking.pickup_time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimated Work Hours</label><div class="controls"><input class="input-tiny" ng-model="booking.total_hours" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Order Number</label><div class="controls"><input class="input-small" ng-model="booking.order_number" type="text" /></div></div><div class="control-group"><label class="control-label">Odometer</label><div class="controls"><input class="input-small" ng-model="booking.odometer" step="any" type="number" /></div></div><div class="control-group" ng-show="asset_property_set().machine_hours"><label class="control-label">Machine Hours</label><div class="controls"><input class="input-small" ng-model="booking.machine_hours" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Courtesy {{asset_name()}}</label><div class="controls"><input id="booking-courtesy-vehicle-checkbox" ng-click="toggle_courtesy_vehicle_bookings()" ng-model="booking.replacement_provided" type="checkbox" /><div ng-show="booking.courtesy_vehicle_booking.vehicle_id" style="margin-left: 20px; margin-top: -17px;"><div class="inline">Booking selected for {{booking.courtesy_vehicle_booking.vehicle.title}}</div><a class="inline" href="javascript:void(0)" ng-click="show_courtesy_vehicle_bookings()" style="margin-left: 5px;" target="_blank">Edit</a></div></div></div><div class="control-group"><label class="control-label"><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="booking" placement="top" showing="x_tags"></div></label><div class="controls"><div ad-tag-labels="true" owner="booking"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="booking"></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="save(booking_form)">Save</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="saving-booking"></div><div class="pull-right" ng-show="booking.id"><div class="inline"><div class="inline" ng-hide="booking.job_id"><button class="btn btn-small btn-primary" ng-click="prepare(booking_form)" type="button"><i class="icon-pencil"></i>Prepare</button><button class="btn btn-small btn-success" ng-click="start(booking_form)" type="button"><i class="icon-ok"></i>Start</button></div><div class="inline green" ng-show="booking.job_id"><i class="icon-ok"></i><a ng-href="#/jobs/{{booking.job_id}}">Go To Job Page</a></div><div class="pull-right"><button class="btn btn-small btn-danger remove inline" ng-click="remove_booking(booking)"><i class="icon-remove"></i>Remove</button></div></div></div></div></div></form><div id="courtesy-vehicle-booking-form"><div class="popover fade top in" style="min-width: 900px; width: 50%"><div class="arrow"></div><div class="popover-title"><div class="sub-header">Courtesy Vehicle Booking<div class="pull-right"><button class="btn" ng-click="hide_courtesy_vehicle_bookings()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div class="column span12"><div ad-courtesy-vehicle-availability="true" job="booking" on-select-vehicle="on_book_courtesy_vehicle()"></div></div></div><div class="row-fluid"><button class="btn" ng-click="hide_courtesy_vehicle_bookings()"><i class="icon-remove"></i>Close</button></div></div></div></div></div><div class="column span5"><div ad-customer-vehicle-recommendations="true" ng-model="recommendations" owner="booking" selection="selection"></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("bookings/recommendations.html",'<div class="spinner" id="recommendation-spinner"></div><div class="page-header">Recommendations that match your inputs</div><ul class="recommendations"><li ng-class="{selected: customer == selected_customer}" ng-click="select_customer(customer)" ng-repeat="customer in recommendations"><div class="customer"><div class="title"><i class="icon-user"></i><span class="model">{{customer.name}}</span><div class="pull-right"><div ng-show="customer.phone"><i class="icon-phone"></i><span>{{customer.phone}}</span></div></div></div><div class="row" ng-show="customer.vehicles.length &gt; 10"><div class="pull-right"><span class="bold">{{asset_name()}}:&nbsp;</span><div class="input-append"><input class="input" ng-model="customer.vehicle_search_text" stop-event="click" type="text" /><span class="add-on"><i class="icon icon-search"></i></span></div></div></div><div class="vehicle" ng-class="{selected: vehicle==selected_vehicle}" ng-click="select_customer(customer); select_vehicle(vehicle)" ng-repeat="vehicle in customer.vehicles|filter:customer.vehicle_search_text" stop-event="click"><span>{{vehicle.title}}</span><span ng-show="vehicle == selected_vehicle"><i class="icon-ok icon-right green"></i></span><div class="pull-right">Plate:<span class="registration-number">{{vehicle.registration_number}}</span></div></div></div><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="unselect_customer()" ng-show="customer == selected_customer">Unselect</button></div></div></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("costs/index.html",'<div ng-controller="CostsController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="spinner" id="costs-spinner"></div><div class="page-header"><span>Invoice Items</span><div class="pull-right"><form class="form-search form-inline form-search-invoice"><div class="inline"></div></form></div></div><div class="row-fluid"><div class="column span12"><div class="pull-right"><button class="btn btn-primary" id="new-cost-button" ng-click="new_cost_dialog()">New Invoice Item</button></div></div></div><br /><div class="content-box"><table class="table table-striped"><thead><tr><th>Description</th><th>Price</th></tr></thead><tbody><tr ng-repeat="cost in costs"><td style="width: 60%;"><div class="row-fluid"><div class="span12 editable" ng-click="edit_cost(cost)" ng-hide="cost.editing"><div>{{cost.description}}</div><div ng-show="cost.details"><br /><pre class="no-style">{{cost.details}}</pre></div></div><div ng-show="cost.editing"><input class="span12" ng-model="cost.editing.description" type="text" /><div class="bold">Details</div><textarea class="span12" ng-model="cost.editing.details" ng-show="cost.editing" type="text"></textarea></div><div ng-show="cost.editing"><button class="btn btn-success" ng-click="save_cost(cost)" stopevent="click">Save</button><button class="btn" ng-click="cancel_edit_cost(cost)" stopevent="click">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="remove_cost(cost)">Remove</button></div></div></div></td><td><div class="row-fluid"><span class="span12 editable" ng-click="edit_cost(cost)" ng-hide="cost.editing"><span>{{cost.unit_price|currency}}</span><span ng-show="cost.included_gst">&nbsp;(incl. {{tax_name()}})</span></span><span ng-show="cost.editing"><input class="input-small" ng-change="price_with_gst(cost.editing)" ng-model="cost.editing.unit_price" ng-show="cost.editing" step="any" type="number" /><br /><div ng-show="!prices_include_gst"><input class="input-small" ng-change="price_without_gst(cost.editing)" ng-model="cost.editing.with_gst.unit_price" ng-show="cost.editing" type="number">&nbsp; (Incl. {{tax_name()}})</input></div></span></div></td></tr></tbody></table></div><div id="new-cost"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">New Cost</div></div><div class="popover-content"><div class="row-fluid"><form class="form-horizontal" name="new_cost_form" novalidate="true"><div class="content-box"><div class="control-group"><label class="control-label">Description</label><div class="controls"><input class="span12" id="new-cost-description" ng-model="new_cost.description" type="text" /></div></div><div class="control-group"><label class="control-label">Details</label><div class="controls"><textarea class="span12" ng-model="new_cost.details" type="text"></textarea></div></div><div class="control-group"><label class="control-label">Unit Price</label><div class="controls"><input class="input-small" ng-change="price_with_gst(new_cost)" ng-model="new_cost.unit_price" type="number" /></div></div><div class="control-group" ng-show="!prices_include_gst"><label class="control-label">(Incl. {{tax_name()}})</label><div class="controls"><input class="input-small" ng-change="price_without_gst(new_cost)" ng-model="new_cost.with_gst.unit_price" type="number" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_new_cost()">Save</button><button class="btn" ng-click="cancel_new_cost()">Cancel</button></div></div></div></form></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("courtesy_vehicle_bookings/index.html",'<div ng-controller="CourtesyVehicleBookingsController"><ul class="sub-nav" ng-controller="BookingsNavController" ng-hide="links.length == 0"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i><span>{{link.name}}</span><span class="badge badge-notifications" ng-show="link.name == &#39;Online Booking Requests&#39; &amp;&amp; booking_request_count() &gt; 0" style="margin-left: 5px"><span class="red">{{booking_request_count()}}</span></span></a></li></ul><div ad-courtesy-vehicle-availability="true" on-update="update()" showing="true"></div><div class="content-nav"><ul><li ng-class="{active: left_side==&#39;pasts&#39;}" ng-click="show_left_side(&#39;pasts&#39;)"><a>Past Bookings</a></li><li ng-class="{active: left_side==&#39;upcomings&#39;}" ng-click="show_left_side(&#39;upcomings&#39;)"><a>Upcoming Bookings</a></li></ul></div><div ng-show="left_side==&#39;pasts&#39;"><div class="content-box"><div class="row-fluid"><div class="column span12"><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span1"><div>Start Date</div></div><div class="column span1"><div>Return Date</div></div><div class="column span2"><div>Vehicle</div></div><div class="column span2"><div>Customer</div></div><div class="column span2"><div>Booking</div></div><div class="column span2"><div>Job</div></div><div class="column span2"><div>Note</div></div></div></th></tr></thead><tbody><tr ng-repeat="booking in pasts.bookings"><td><div class="row-fluid"><div class="column span1"><div>{{booking.check_out_time | date}}</div></div><div class="column span1"><div>{{booking.return_time | date}}</div></div><div class="column span2"><div>{{booking.vehicle.title}}</div></div><div class="column span2"><div>{{booking.customer.name}}</div></div><div class="column span2"><div ng-show="booking.booking">{{booking.booking.full_description}}</div></div><div class="column span2"><div ng-show="booking.job">{{booking.job.full_description}}</div></div><div class="column span2"><div>{{booking.note | na}}</div></div></div></td></tr></tbody></table><pagination boundary-links="true" current-page="pasts.meta.page" max-size="20" num-pages="pasts.meta.total_pages" on-select-page="fetch_pasts(page)" rotate="false"></pagination></div></div></div></div><div ng-show="left_side==&#39;upcomings&#39;"><div class="content-box"><div class="row-fluid"><div class="column span12"><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span1"><div>Start Date</div></div><div class="column span1"><div>Return Date</div></div><div class="column span2"><div>Vehicle</div></div><div class="column span2"><div>Customer</div></div><div class="column span2"><div>Booking</div></div><div class="column span2"><div>Job</div></div><div class="column span2"><div>Note</div></div></div></th></tr></thead><tbody><tr ng-repeat="booking in upcomings.bookings"><td><div class="row-fluid"><div class="column span1"><div>{{booking.check_out_time | date}}</div></div><div class="column span1"><div>{{booking.return_time | date}}</div></div><div class="column span2"><div>{{booking.vehicle.title}}</div></div><div class="column span2"><div>{{booking.customer.name}}</div></div><div class="column span2"><div ng-show="booking.booking">{{booking.booking.description}}</div></div><div class="column span2"><div ng-show="booking.job">{{booking.job.description}}</div></div><div class="column span2"><div>{{booking.note}}</div></div></div></td></tr></tbody></table><pagination boundary-links="true" current-page="upcomings.meta.page" max-size="20" num-pages="upcomings.meta.total_pages" on-select-page="fetch_upcomings(page)" rotate="false"></pagination></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("credit_notes/allocations.html",'<div ng-show="credit_note.refunds.length &gt; 0"><div class="sub-header">Refunds</div><table class="table table-striped"><thead><tr><th>Date</th><th>Amount</th><th>Payment Type</th><th>Refunded By</th></tr></thead><tbody><tr ng-repeat="refund in credit_note.refunds"><td>{{refund.date|date: \'mediumDate\'}}</td><td>{{refund.amount|currency}}</td><td>{{refund.payment_type_name}}</td><td>{{refund.created_by.name}}</td></tr></tbody></table><hr /></div><div class="sub-header">Allocations</div><table class="table table-striped" ng-show="credit_note.allocated_payments.length &gt; 0"><thead><tr><th>Invoice No#</th><th>Date</th><th>Amount</th><th>Allocated</th><th class="actions"></th></tr></thead><tbody><tr ng-repeat="bpayment in credit_note.allocated_payments"><td>{{bpayment.invoice.number}}</td><td>{{bpayment.invoice.issue_date|date:\'mediumDate\'}}</td><td>{{bpayment.invoice.total_amount|currency}}</td><td>{{bpayment.amount|currency}} </td><td><div class="pull-right"><a ng-href="#/invoices/{{bpayment.invoice.id}}" stop-event="click">Invoice details</a><span>&nbsp;::&nbsp;</span><a class="red" href="javascript:void(0);" ng-click="remove_bpayment(bpayment)"><i class="icon icon-remove"></i><span>Remove</span></a></div></td></tr></tbody></table><a href="javascript:void(0);" id="add-invoices-button" ng-click="add_invoices()" ng-show="credit_note.unallocated_amount &gt; 0">Allocate to invoices</a><div ad-invoice-selection="true" anchor-element="#add-invoices-button" available-amount="credit_note.unallocated_amount" customer="credit_note.customer" on-select="save_selected_invoices()" placement="right" selection="selected_invoices" showing="showing_related_invoices"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("credit_notes/details.html",'<div class="invoice"><div class="spinner" id="credit_note-spinner" style="z-index: 1000"></div><div class="row-fluid" ng-hide="credit_note.editing"><div class="column span6"><div class="editable" ng-click="edit_credit_note()"><div class="info" ng-show="credit_note.royalty_auto_club"><span class="label-name-left auto-width">Customer Auto Club:</span>{{credit_note.royalty_auto_club}}</div><div class="info" ng-show="credit_note.royalty_account_number"><span class="label-name-left auto-width">Auto Club Card Number:</span>{{credit_note.royalty_account_number}}</div><div class="info" ng-show="credit_note.reference"><span class="label-name-left auto-width">Number:</span>{{credit_note.number}}</div><div class="info" ng-show="credit_note.reference"><span class="label-name-left auto-width">Reference:</span>{{credit_note.reference}}</div><div class="info" ng-show="credit_note.raised_by"><span class="label-name-left auto-width">Raised by:</span>{{credit_note.raised_by.name}}</div><div class="info"><span class="label-name-left auto-width">Date:</span>{{credit_note.date | date: \'mediumDate\'}}</div><div class="info"><span class="label-name-left auto-width">Description:</span>{{credit_note.description}}</div><div class="info"><span class="label-name-left auto-width">Unallocate amount:</span>{{credit_note.unallocated_amount | currency}}</div><div class="info" ng-show="enable_tracking_category_selection()"><span class="label-name-left auto-width">Tracking Categories</span><div class="inline" style="min-width: 40px;">{{credit_note.tracking_categories|comma_seperated: \'option\'}}</div></div></div><div class="info" ng-show="credit_note.original_invoice_id"><span class="label-name-left auto-width">Credit From Invoice:</span><a ng-href="#invoices/{{credit_note.original_invoice_id}}">Invoice #{{credit_note.original_invoice.number}}</a></div></div><div class="column span6"><div class="pull-right pointer" ng-click="show_customer()"><div id="vehicle-owner-details"></div><div class="info"><span class="label-name-left auto-width">Customer:</span>{{credit_note.customer.name | na}}</div><div class="info"><span class="label-name-left auto-width">Email:</span>{{credit_note.customer.email | na}}</div><div class="info"><span class="label-name-left auto-width">Mobile:</span>{{credit_note.customer.mobile | na}}</div><div class="info" ng-show="customer.phone"><span class="label-name-left auto-width">Phone:</span>{{credit_note.customer.phone | na}}</div></div></div></div><div class="editing-item" ng-show="credit_note.editing"><form autocomplete="off" class="form-horizontal"><div ng-model="credit_note.editing" royaltypicker="true"></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><input class="input-small" ng-model="credit_note.editing.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="credit_note.editing.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><input ng-model="credit_note.editing.description" type="text" /></div></div><div class="control-group"><label class="control-label">Credit From Invoice</label><div class="controls"><div ad-invoicepicker="true" customer="credit_note.customer" customer-id="credit_note.customer_id" invoice="credit_note.editing.original_invoice" ng-model="credit_note.editing.original_invoice_id"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="credit_note.editing"></div></div><br /><br /><div class="action-buttons"><button class="btn btn-success" ng-click="save_credit_note()">Save</button><button class="btn" ng-click="cancel_edit_credit_card()">Cancel</button></div></form></div><br /></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("credit_notes/index.html",'<div ng-controller="CreditNotesController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="page-header">Customer Credit Notes<div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="row-fluid"><div class="column span4"><label class="checkbox"><input ng-click="search()" ng-model="query.unallocated" type="checkbox" /><span>Show</span> <span class="label label-info">Unallocated</span> <span>Credit Notes Only</span></label><label class="checkbox"><input ng-change="search()" ng-model="query.deleted" type="checkbox" /><span>Show</span> <span class="label">Deleted</span> <span>Credit Notes Only</span></label></div><div class="column span4" style="vertical-align: bottom"><div>&nbsp;</div><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div><div class="column span4"><div class="pull-right"><a class="btn btn-primary" ng-href="#/credit_notes/new"><span>New Credit Note</span></a></div></div></div><br /></div><div class="search-description" ng-show="keyword">Search "{{keyword}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="spinner" id="credit-notes-spinner"></div><div class="content-box"><table class="table table-striped invoice-list" ng-show="showing_deleted"><thead><tr><th>Number</th><th>Date</th><th>Customer</th><th>Description</th><th>Amount</th><th>Unallocated amount</th><th>Reference</th><th>Raised by</th><th>Deleted By</th><th>Deleted Reason</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/credit_notes/&#39; + credit_note.id)" ng-repeat=" credit_note in credit_notes"><td>{{credit_note.number}}</td><td>{{credit_note.date |date: \'mediumDate\'}}</td><td>{{credit_note.customer.name}}</td><td><div>{{credit_note.description}}</div><div ad-tag-icons="true" class="invoice-list-item" owner="credit_note"></div></td><td>{{credit_note.total_amount|currency}}</td><td>{{credit_note.unallocated_amount|currency}}</td><td>{{credit_note.reference}}</td><td>{{credit_note.raised_by.name}}</td><td>{{credit_note.deleted_by.name}}</td><td>{{credit_note.deleted_reason}}</td></tr></tbody></table><table class="table table-striped invoice-list" ng-hide="showing_deleted"><thead><tr><th>Number</th><th>Date</th><th>Customer</th><th>Description</th><th>Amount</th><th>Unallocated amount</th><th>Raised by</th><th>Reference</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/credit_notes/&#39; + credit_note.id)" ng-repeat=" credit_note in credit_notes"><td>{{credit_note.number}}</td><td>{{credit_note.date |date: \'mediumDate\'}}</td><td>{{credit_note.customer.name}}</td><td><div>{{credit_note.description}}</div><div ad-tag-icons="true" class="invoice-list-item" owner="credit_note"></div></td><td>{{credit_note.total_amount|currency}}</td><td>{{credit_note.unallocated_amount|currency}}</td><td>{{credit_note.raised_by.name}}</td><td>{{credit_note.reference}}</td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("credit_notes/invoice_items.html",'<div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Rate</div><div class="total">Total</div><div class="included-gst"></div></div><div class="cost" ng-repeat="invoice_item in credit_note.items"><div class="editable" ng-click="edit_invoice_item(invoice_item)" ng-hide="invoice_item.editing"><div class="description">{{invoice_item.description}}<button class="btn btn-link" ng-click="show_invoice_item_details(invoice_item)" ng-show="invoice_item.details &amp;&amp; !invoice_item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button><button class="btn btn-link" ng-click="hide_invoice_item_details(invoice_item)" ng-show="invoice_item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button></div><div class="quantity">{{invoice_item.quantity}}</div><div class="rate">{{invoice_item.unit_price|currency}}</div><div class="total">{{invoice_item_total(invoice_item) | currency}}</div><div class="included-gst" ng-hide="credit_note.not_registered_for_gst"><span ng-show="invoice_item.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="invoice_item.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span></div><div class="details" ng-show="invoice_item.show_details"><pre class="no-style">{{invoice_item.details}}</pre></div></div><div class="editing-item" ng-show="invoice_item.editing"><form autocomplete="off" name="edit_invoice_item_form" novalidate="true"><div class="error" ng-show="edit_invoice_item_form.description.$error.required">description is required</div><div class="error" ng-show="edit_invoice_item_form.description.$error.maxlength">description\'s max length is 225 characters, click on "More Details" to add detailed description. </div><div class="error" ng-show="edit_invoice_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="edit_invoice_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" customer="customer()" ng-model="invoice_item.editing"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_invoice_item_amount(invoice_item.editing)" ng-model="invoice_item.editing.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-change="update_invoice_item_amount(invoice_item.editing)" ng-model="invoice_item.editing.unit_price" required="true" step="any" type="number" /><div ng-show="invoice_item.editing.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices  </span> <i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in invoice_item.editing.prices"><a href="javascript:void(0);" ng-click="select_price_level(invoice_item.editing, price)"><span>{{price|currency}}</span></a></li></ul></div></div></div><div class="total"><input class="input-mini" readonly="true" step="any" type="number" value="{{invoice_item_total(invoice_item.editing)}}" /></div><br /><div><div class="row-fluid"><a ng-click="edit_invoice_item_details(invoice_item.editing)" ng-hide="invoice_item.details || invoice_item.editing.edit_details">More Details</a><div class="pull-right" ng-hide="credit_note.not_registered_for_gst"><div><label class="checkbox"><input ng-model="invoice_item.editing.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="invoice_item.editing.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><div class="details" ng-show="invoice_item.details || invoice_item.editing.edit_details"><textarea ng-model="invoice_item.editing.details" style="width: 97%; height: 150px;"></textarea></div></div><div class="button-panel"><button class="btn btn-success" ng-click="save_invoice_item(edit_invoice_item_form, invoice_item)">Save</button><button class="btn btn-danger" ng-click="remove_invoice_item(invoice_item)">Remove</button><button class="btn" ng-click="cancel_edit_invoice_item(invoice_item)">Cancel</button></div></form></div></div><div ng-hide="new_invoice_item"><a href="javascript: void(0);" id="add-item-button" ng-click="add_invoice_item()">Add Item/Stock</a><span ng-show="credit_note.original_invoice"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-invoice-item-button" ng-click="add_item_from_invoice()">From Invoice</a></span></div><div class="invoice_item" ng-show="new_invoice_item"><form autocomplete="off" name="new_invoice_item_form" novalidate="true"><div class="editing-item"><div class="error" ng-show="new_invoice_item_form.description.$error.required">description is required</div><div class="error" ng-show="new_invoice_item_form.description.$error.maxlength">description\'s max length is 225 characters, click on "More Details" to add detailed description. </div><div class="error" ng-show="new_invoice_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="new_invoice_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" customer="customer()" input-id="new-credit-note-item-description" ng-model="new_invoice_item"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_invoice_item_amount(new_invoice_item)" ng-model="new_invoice_item.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini inline" name="unit_price" ng-change="update_invoice_item_amount(new_invoice_item)" ng-model="new_invoice_item.unit_price" required="true" step="any" type="number" /><div ng-show="new_invoice_item.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices&nbsp;  </span><i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in new_invoice_item.prices"><a href="javascript:void(0);" ng-click="select_price_level(new_invoice_item, price)"><span>{{price|currency}}</span></a></li></ul></div></div></div><div class="total"><input class="input-mini" readonly="true" step="any" type="number" value="{{invoice_item_total(new_invoice_item)}}" /></div><br /><div><div class="row-fluid"><a ng-click="edit_invoice_item_details(new_invoice_item)" ng-hide="new_invoice_item.details || new_invoice_item.edit_details">More Details</a><div class="pull-right" ng-hide="credit_note.not_registered_for_gst"><div><label class="checkbox inline"><input ng-model="new_invoice_item.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="new_invoice_item.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><div class="details" ng-show="new_invoice_item.details || new_invoice_item.edit_details"><textarea ng-model="new_invoice_item.details" style="width: 95%; height: 150px;"></textarea></div></div><br /><br /><div><button class="btn btn-success" ng-click="save_new_invoice_item()">Save</button><button class="btn" ng-click="cancel_add_invoice_item()">Cancel</button><div class="pull-right"><div ad-new-stock="true" generic-item="new_invoice_item" ng-model="new_stock" on-save="select_new_stock()"></div></div></div></div></form></div><div class="summary"><div><div class="title">Total Excl. {{tax_name()}}:</div> <div class="value">{{credit_note.net_amount | currency}}</div></div><div><div class="title">{{tax_name()}}:&nbsp;</div><div class="value">{{credit_note.gst_amount | currency}}</div></div><div ng-show="credit_note.discount_amount"><div class="title">Discount:</div> <div class="value">- {{credit_note.discount_amount | currency}}</div></div><div><div class="title">Total Incl. {{tax_name()}}:</div> <div class="value">{{credit_note.total_amount | currency}}</div></div><hr class="divider" /><div class="sub-header">Note<div class="pull-right"><button class="btn btn-link" ng-click="edit_credit_note_details()">Add Note</button></div></div><div class="editable note" ng-click="edit_credit_note_details()" ng-hide="credit_note.editing_details"><pre class="no-style" ng-show="credit_note.details">{{credit_note.details}}</pre></div><div class="editing-item" ng-show="credit_note.editing_details"><textarea class="span12" id="edit-credit_note-details" ng-model="credit_note.editing_details.details"></textarea><button class="btn btn-primary" ng-click="save_credit_note_details()">Save</button><button class="btn btn-danger" ng-click="clear_credit_note_details()">Remove</button><button class="btn" ng-click="cancel_edit_credit_note_details()">Cancel</button></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("credit_notes/new.html",'<div ng-controller="NewCreditNoteController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">New Customer Credit Note</div><div class="content-box"><div class="row-fluid"><div class="column span7"><form autocomplete="off" class="form-horizontal"><div class="control-group"><label class="control-label">Customer</label><div class="controls"><div customer="selected_customer" customerpicker="true" on-select="select_customer()"></div></div></div><div ng-model="credit_note" royaltypicker="true"></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><input ng-model="credit_note.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Credit From Invoice</label><div class="controls"><div ad-invoicepicker="true" customer="credit_note.customer" customer-id="credit_note.customer_id" invoice="credit_note.original_invoice" ng-model="credit_note.original_invoice_id"></div></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker error="top" ng-model="credit_note.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><input class="span8" ng-model="credit_note.description" type="text" /></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="credit_note"></div></div><br /><br /><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_credit_note()">Continue</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="new-credit-note-spinner"></div></div></div></form></div><div class="column span5"><div class="sub-header">Selected Customer</div><div ng-show="selected_customer"><div><span class="label-text-left auto-width">Name:</span> <span>{{selected_customer.name}}</span></div><div ng-show="selected_customer.phone"><span class="label-text-left auto-width">Phone:</span> <span>{{selected_customer.phone}}</span></div><div ng-show="selected_customer.mobile"><span class="label-text-left auto-width">Mobile:</span> <span>{{selected_customer.mobile}}</span></div><div ng-show="selected_customer.fax"><span class="label-text-left auto-width">Fax:</span> <span>{{selected_customer.fax}}</span></div><div ng-show="selected_customer.address.full_address"><span class="label-text-left auto-width">Address:</span> <span>{{selected_customer.address.full_address}}</span></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("credit_notes/show.html",'<div ng-controller="CreditNoteController"><div class="deleted-sign" ng-show="credit_note.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="pull-left"><div class="page-header">Credit Note #{{credit_note.number}}</div></div><div class="pull-right"><div ad-tag-labels="true" class="inline" owner="credit_note"></div><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="credit_note" placement="left" resource="CreditNote" showing="x_tags"></div></div></div><div class="row-fluid"><div class="pull-right"><a class="btn" ng-href="/credit_notes/{{credit_note.id}}/print.pdf" target="_blank"><i class="icon-print"></i><span>Print</span></a><button class="btn" id="credit-note-send-email-button" ng-click="open_send_email()" ng-hide="credit_note.deleted"><i class="icon-print"></i>Email Credit Note</button><button class="btn" id="create-refund-button" ng-click="open_refund()" ng-hide="credit_note.deleted || credit_note.unallocated_amount &lt;= 0 || restricted_to(&#39;create_payments&#39;)"><i class="icon icon-dollar"></i><span>Refund</span></button><button class="btn btn-danger" ng-click="open_delete_dialog()" ng-hide="credit_note.deleted || restricted_to(&#39;create_payments&#39;, &#39;deletion&#39;)">Delete</button></div></div><br /><div class="row-fluid"><div class="column span6"><div class="content-box"><div class="invoice"><div class="spinner" id="credit_note-spinner" style="z-index: 1000"></div><div class="row-fluid" ng-hide="credit_note.editing"><div class="column span6"><div class="editable" ng-click="edit_credit_note()"><div class="info" ng-show="credit_note.royalty_auto_club"><span class="label-name-left auto-width">Customer Auto Club:</span>{{credit_note.royalty_auto_club}}</div><div class="info" ng-show="credit_note.royalty_account_number"><span class="label-name-left auto-width">Auto Club Card Number:</span>{{credit_note.royalty_account_number}}</div><div class="info" ng-show="credit_note.reference"><span class="label-name-left auto-width">Number:</span>{{credit_note.number}}</div><div class="info" ng-show="credit_note.reference"><span class="label-name-left auto-width">Reference:</span>{{credit_note.reference}}</div><div class="info" ng-show="credit_note.raised_by"><span class="label-name-left auto-width">Raised by:</span>{{credit_note.raised_by.name}}</div><div class="info"><span class="label-name-left auto-width">Date:</span>{{credit_note.date | date: \'mediumDate\'}}</div><div class="info"><span class="label-name-left auto-width">Description:</span>{{credit_note.description}}</div><div class="info"><span class="label-name-left auto-width">Unallocate amount:</span>{{credit_note.unallocated_amount | currency}}</div><div class="info" ng-show="enable_tracking_category_selection()"><span class="label-name-left auto-width">Tracking Categories</span><div class="inline" style="min-width: 40px;">{{credit_note.tracking_categories|comma_seperated: \'option\'}}</div></div></div><div class="info" ng-show="credit_note.original_invoice_id"><span class="label-name-left auto-width">Credit From Invoice:</span><a ng-href="#invoices/{{credit_note.original_invoice_id}}">Invoice #{{credit_note.original_invoice.number}}</a></div></div><div class="column span6"><div class="pull-right pointer" ng-click="show_customer()"><div id="vehicle-owner-details"></div><div class="info"><span class="label-name-left auto-width">Customer:</span>{{credit_note.customer.name | na}}</div><div class="info"><span class="label-name-left auto-width">Email:</span>{{credit_note.customer.email | na}}</div><div class="info"><span class="label-name-left auto-width">Mobile:</span>{{credit_note.customer.mobile | na}}</div><div class="info" ng-show="customer.phone"><span class="label-name-left auto-width">Phone:</span>{{credit_note.customer.phone | na}}</div></div></div></div><div class="editing-item" ng-show="credit_note.editing"><form autocomplete="off" class="form-horizontal"><div ng-model="credit_note.editing" royaltypicker="true"></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><input class="input-small" ng-model="credit_note.editing.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="credit_note.editing.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><input ng-model="credit_note.editing.description" type="text" /></div></div><div class="control-group"><label class="control-label">Credit From Invoice</label><div class="controls"><div ad-invoicepicker="true" customer="credit_note.customer" customer-id="credit_note.customer_id" invoice="credit_note.editing.original_invoice" ng-model="credit_note.editing.original_invoice_id"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="credit_note.editing"></div></div><br /><br /><div class="action-buttons"><button class="btn btn-success" ng-click="save_credit_note()">Save</button><button class="btn" ng-click="cancel_edit_credit_card()">Cancel</button></div></form></div><br /></div><hr /><div ng-show="credit_note.refunds.length &gt; 0"><div class="sub-header">Refunds</div><table class="table table-striped"><thead><tr><th>Date</th><th>Amount</th><th>Payment Type</th><th>Refunded By</th></tr></thead><tbody><tr ng-repeat="refund in credit_note.refunds"><td>{{refund.date|date: \'mediumDate\'}}</td><td>{{refund.amount|currency}}</td><td>{{refund.payment_type_name}}</td><td>{{refund.created_by.name}}</td></tr></tbody></table><hr /></div><div class="sub-header">Allocations</div><table class="table table-striped" ng-show="credit_note.allocated_payments.length &gt; 0"><thead><tr><th>Invoice No#</th><th>Date</th><th>Amount</th><th>Allocated</th><th class="actions"></th></tr></thead><tbody><tr ng-repeat="bpayment in credit_note.allocated_payments"><td>{{bpayment.invoice.number}}</td><td>{{bpayment.invoice.issue_date|date:\'mediumDate\'}}</td><td>{{bpayment.invoice.total_amount|currency}}</td><td>{{bpayment.amount|currency}} </td><td><div class="pull-right"><a ng-href="#/invoices/{{bpayment.invoice.id}}" stop-event="click">Invoice details</a><span>&nbsp;::&nbsp;</span><a class="red" href="javascript:void(0);" ng-click="remove_bpayment(bpayment)"><i class="icon icon-remove"></i><span>Remove</span></a></div></td></tr></tbody></table><a href="javascript:void(0);" id="add-invoices-button" ng-click="add_invoices()" ng-show="credit_note.unallocated_amount &gt; 0">Allocate to invoices</a><div ad-invoice-selection="true" anchor-element="#add-invoices-button" available-amount="credit_note.unallocated_amount" customer="credit_note.customer" on-select="save_selected_invoices()" placement="right" selection="selected_invoices" showing="showing_related_invoices"></div></div></div><div class="column span6"><div class="content-box"><div ng-show="credit_note.id"><div ng-hide="credit_note.finalized"><span class="label label-info">In progress</span><button class="btn btn-link" ng-click="finalize()">Finalize</button></div><div ng-show="credit_note.finalized"><span class="label label-success">Finalized</span></div></div><br /><hr /><div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Rate</div><div class="total">Total</div><div class="included-gst"></div></div><div class="cost" ng-repeat="invoice_item in credit_note.items"><div class="editable" ng-click="edit_invoice_item(invoice_item)" ng-hide="invoice_item.editing"><div class="description">{{invoice_item.description}}<button class="btn btn-link" ng-click="show_invoice_item_details(invoice_item)" ng-show="invoice_item.details &amp;&amp; !invoice_item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button><button class="btn btn-link" ng-click="hide_invoice_item_details(invoice_item)" ng-show="invoice_item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button></div><div class="quantity">{{invoice_item.quantity}}</div><div class="rate">{{invoice_item.unit_price|currency}}</div><div class="total">{{invoice_item_total(invoice_item) | currency}}</div><div class="included-gst" ng-hide="credit_note.not_registered_for_gst"><span ng-show="invoice_item.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="invoice_item.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span></div><div class="details" ng-show="invoice_item.show_details"><pre class="no-style">{{invoice_item.details}}</pre></div></div><div class="editing-item" ng-show="invoice_item.editing"><form autocomplete="off" name="edit_invoice_item_form" novalidate="true"><div class="error" ng-show="edit_invoice_item_form.description.$error.required">description is required</div><div class="error" ng-show="edit_invoice_item_form.description.$error.maxlength">description\'s max length is 225 characters, click on "More Details" to add detailed description. </div><div class="error" ng-show="edit_invoice_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="edit_invoice_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" customer="customer()" ng-model="invoice_item.editing"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_invoice_item_amount(invoice_item.editing)" ng-model="invoice_item.editing.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-change="update_invoice_item_amount(invoice_item.editing)" ng-model="invoice_item.editing.unit_price" required="true" step="any" type="number" /><div ng-show="invoice_item.editing.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices  </span> <i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in invoice_item.editing.prices"><a href="javascript:void(0);" ng-click="select_price_level(invoice_item.editing, price)"><span>{{price|currency}}</span></a></li></ul></div></div></div><div class="total"><input class="input-mini" readonly="true" step="any" type="number" value="{{invoice_item_total(invoice_item.editing)}}" /></div><br /><div><div class="row-fluid"><a ng-click="edit_invoice_item_details(invoice_item.editing)" ng-hide="invoice_item.details || invoice_item.editing.edit_details">More Details</a><div class="pull-right" ng-hide="credit_note.not_registered_for_gst"><div><label class="checkbox"><input ng-model="invoice_item.editing.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="invoice_item.editing.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><div class="details" ng-show="invoice_item.details || invoice_item.editing.edit_details"><textarea ng-model="invoice_item.editing.details" style="width: 97%; height: 150px;"></textarea></div></div><div class="button-panel"><button class="btn btn-success" ng-click="save_invoice_item(edit_invoice_item_form, invoice_item)">Save</button><button class="btn btn-danger" ng-click="remove_invoice_item(invoice_item)">Remove</button><button class="btn" ng-click="cancel_edit_invoice_item(invoice_item)">Cancel</button></div></form></div></div><div ng-hide="new_invoice_item"><a href="javascript: void(0);" id="add-item-button" ng-click="add_invoice_item()">Add Item/Stock</a><span ng-show="credit_note.original_invoice"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-invoice-item-button" ng-click="add_item_from_invoice()">From Invoice</a></span></div><div class="invoice_item" ng-show="new_invoice_item"><form autocomplete="off" name="new_invoice_item_form" novalidate="true"><div class="editing-item"><div class="error" ng-show="new_invoice_item_form.description.$error.required">description is required</div><div class="error" ng-show="new_invoice_item_form.description.$error.maxlength">description\'s max length is 225 characters, click on "More Details" to add detailed description. </div><div class="error" ng-show="new_invoice_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="new_invoice_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" customer="customer()" input-id="new-credit-note-item-description" ng-model="new_invoice_item"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_invoice_item_amount(new_invoice_item)" ng-model="new_invoice_item.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini inline" name="unit_price" ng-change="update_invoice_item_amount(new_invoice_item)" ng-model="new_invoice_item.unit_price" required="true" step="any" type="number" /><div ng-show="new_invoice_item.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices&nbsp;  </span><i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in new_invoice_item.prices"><a href="javascript:void(0);" ng-click="select_price_level(new_invoice_item, price)"><span>{{price|currency}}</span></a></li></ul></div></div></div><div class="total"><input class="input-mini" readonly="true" step="any" type="number" value="{{invoice_item_total(new_invoice_item)}}" /></div><br /><div><div class="row-fluid"><a ng-click="edit_invoice_item_details(new_invoice_item)" ng-hide="new_invoice_item.details || new_invoice_item.edit_details">More Details</a><div class="pull-right" ng-hide="credit_note.not_registered_for_gst"><div><label class="checkbox inline"><input ng-model="new_invoice_item.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="new_invoice_item.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><div class="details" ng-show="new_invoice_item.details || new_invoice_item.edit_details"><textarea ng-model="new_invoice_item.details" style="width: 95%; height: 150px;"></textarea></div></div><br /><br /><div><button class="btn btn-success" ng-click="save_new_invoice_item()">Save</button><button class="btn" ng-click="cancel_add_invoice_item()">Cancel</button><div class="pull-right"><div ad-new-stock="true" generic-item="new_invoice_item" ng-model="new_stock" on-save="select_new_stock()"></div></div></div></div></form></div><div class="summary"><div><div class="title">Total Excl. {{tax_name()}}:</div> <div class="value">{{credit_note.net_amount | currency}}</div></div><div><div class="title">{{tax_name()}}:&nbsp;</div><div class="value">{{credit_note.gst_amount | currency}}</div></div><div ng-show="credit_note.discount_amount"><div class="title">Discount:</div> <div class="value">- {{credit_note.discount_amount | currency}}</div></div><div><div class="title">Total Incl. {{tax_name()}}:</div> <div class="value">{{credit_note.total_amount | currency}}</div></div><hr class="divider" /><div class="sub-header">Note<div class="pull-right"><button class="btn btn-link" ng-click="edit_credit_note_details()">Add Note</button></div></div><div class="editable note" ng-click="edit_credit_note_details()" ng-hide="credit_note.editing_details"><pre class="no-style" ng-show="credit_note.details">{{credit_note.details}}</pre></div><div class="editing-item" ng-show="credit_note.editing_details"><textarea class="span12" id="edit-credit_note-details" ng-model="credit_note.editing_details.details"></textarea><button class="btn btn-primary" ng-click="save_credit_note_details()">Save</button><button class="btn btn-danger" ng-click="clear_credit_note_details()">Remove</button><button class="btn" ng-click="cancel_edit_credit_note_details()">Cancel</button></div></div></div></div><div class="content-box" ng-show="credit_note.remote_id"><div class="sub-header">Accounting Integration</div><div>Synced To ID {{credit_note.remote_id}}</div><div ng-show="credit_note.remote_url"><span>Please click </span> <a ng-href="{{credit_note.remote_url}}" target="_blank">Here</a> <span>to access the Credit Note in Accounting Software</span></div></div></div></div><div modal="showing_delete_credit_note_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete This Credit Note</h3></div><div class="modal-body"><div>Are you sure you want to delete this credit note?</div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_credit_note()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_credit_note()">Cancel</button></div></div><div id="credit-note-send-email"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">Send Email</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form><div class="pull-right"><div class="inline" id="credit-note-send-email-spinner"></div></div><label>Email</label><input class="span9" id="credit-note-send-email-address" ng-model="email" type="text" /><div class="inline" contactpicker="true" model-type="customer" ng-model="credit_note.customer" on-select="email_select_contact(contacts)" show-email="true"></div><label>Message</label><textarea class="span12" id="credit-note-send-email-message" ng-model="message" rows="6" type="text"></textarea><div><button class="btn btn-success" ng-click="send_email()">Send</button><button class="btn" ng-click="cancel()">Cancel</button></div></form></div></div></div></div></div><div id="create-refund"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">Refund</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form class="form-horizontal"><div class="control-group"><label class="control-label">Payment Type</label><div class="controls"><div class="input-append"><select ng-model="refund.payment_method_id" ng-options="pt.id as pt.name for pt in payment_methods" type="text"></select></div></div></div></form><form class="form-horizontal"><div class="control-group"><label class="control-label">Reference</label><div class="controls"><input ng-model="refund.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="refund.date"><span class="add-on"><i class="icon-calendar"></i></span></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><div class="input-append"><input class="input-small" ng-model="refund.amount" type="text" /></div></div></div><div class="control-group" ng-show="show_select_bank_account()"><label class="control-label">Refund From Account</label><div class="controls"><button class="btn btn-link" ng-click="choose_specific_bank_account = true" ng-hide="choose_specific_bank_account">Choose specific bank account</button><div ng-show="choose_specific_bank_account"><div accounts="bank_accounts()" ad-accounting-account-picker="true" ng-model="refund.accounting_account_id"></div></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="do_refund()">Refund</button><button class="btn" ng-click="close_refund()">Cancel</button><div class="spinner" id="create-refund-spinner"></div></div></div></form></div></div></div></div></div><div id="customer"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{credit_note.customer.name}}<div class="pull-right"><a class="btn" ng-href="#/customers/{{credit_note.customer.id}}"><i class="icon-external-link"></i><span>Full Details</span></a><button class="btn" ng-click="close_customer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-customer="true" ng-model="credit_note.customer" on-save="close_customer()"></div></div></div></div></div><div id="return-item-selection"><div class="popover fade left in" style="width: 750px"><div class="popover-title"><div class="sub-header">Returning items...</div></div><div class="popover-content"><div class="content-box"><table class="table"><thead><tr><td class="bold">Description</td><td class="bold">Quantity</td><td class="bold">Unit Price</td><td class="bold">Returning</td></tr></thead><tbody><tr class="goto" ng-click="toggle_item_from_invoice(item)" ng-hide="item.header" ng-repeat="item in credit_note.original_invoice.items"><td>{{item.description}}</td><td>{{item.quantity}}</td><td><div>{{item.unit_price|currency}}</div><div ng-show="item.discount_percentage">Discount {{item.discount_percentage}}%</div></td><td><span ng-show="item.selected"><input class="input input-tiny" ng-model="item.returning_quantity" step="any" stop-event="click" type="number" /><span class="red" ng-show="item.returning_quantity &gt; item.quantity">Cannot > invoice quantity</span></span></td></tr></tbody></table><br /></div><div class="buttons"><button class="btn btn-success" ng-click="do_select_item_from_invoice()">Select</button><button class="btn" ng-click="close_add_item_from_invoice()">Cancel</button><div class="spinner" id="returning-items-spinner"></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("customer_communications/show.html",'<div close="close()" modal="showing_customer_communication" options="{&#39;dialogClass&#39;: &#39;modal customer-communication-dialog&#39;}"><div class="modal-header"><div class="page-header">{{showing_customer_communication.type_name}} &nbsp;<span class="label label-info" ng-show="showing_customer_communication.status != &#39;processed&#39;">{{showing_customer_communication.status}}</span><span class="label label-success" ng-show="showing_customer_communication.status == &#39;processed&#39;">{{showing_customer_communication.status}}</span></div></div><div class="modal-body"><div class="content-box"><div class="sub-header">Details</div><div class="pull-right"><div class="info" ng-show="showing_customer_communication.status == &#39;processed&#39; || showing_customer_communication.status == &#39;sending&#39;"><label class="label-name">Start:</label><span>{{showing_customer_communication.start_time|date:\'short\'}}</span></div><div class="info" ng-show="showing_customer_communication.status == &#39;processed&#39;"><label class="label-name">Finished:</label><span>{{showing_customer_communication.finished_time|date:\'short\'}}</span></div><div class="info" ng-hide="showing_customer_communication.status == &#39;processed&#39;"><label class="label-name">Status:</label><span>{{showing_customer_communication.status}}</span></div><div class="info"><label class="label-name">Estimate Total:</label><span>{{showing_customer_communication.estimate_total}}</span></div><div class="info"><label class="label-name">Total Sent:</label><span>{{showing_customer_communication.total}}</span></div></div><div class="info"><label class="label-name">Created At:</label><span>{{showing_customer_communication.created_at|date:\'short\'}}</span></div><div class="info"><label class="label-name">Sent By:</label><span>{{showing_customer_communication.communication_methods}}</span></div><div class="info"><label class="label-name">Service Over Due:</label><span>{{showing_customer_communication.over_due_days}} days ago</span></div><div class="info"><label class="label-name">Last Reminder:</label><span>{{showing_customer_communication.last_reminder_days}} days ago</span></div><br /><br /><div class="row-fluid"><div class="sub-header">Message</div><pre>{{showing_customer_communication.communication_template.message}}</pre></div></div><div class="content-box"><div class="sub-header">Receivers ({{showing_customer_communication.emails.length}}) &nbsp;<a ng-click="show_receivers()" ng-hide="showing_receivers">Show</a><a ng-click="hide_receivers()" ng-show="showing_receivers">Hide</a></div><table class="table table-striped" ng-show="showing_receivers"><thead><tr><th>{{asset_name()}}</th><th>Customer</th><th>Sent At</th></tr></thead><tbody><tr ng-repeat="email in showing_customer_communication.emails"><td>{{email.vehicle.title}}</td><td>{{email.customer.name}}</td><td>{{email.sent_time|date:\'short\'}}</td></tr></tbody></table></div><div ng-show="showing_customer_communication.uncommunicated_attempts.length &gt; 0"><div class="content-box"><div class="sub-header">Failed to send ({{showing_customer_communication.uncommunicated_attempts.length}}) &nbsp;<a ng-click="show_uncommunicated_attempts()" ng-hide="showing_uncommunicated_attempts">Show</a><a ng-click="hide_uncommunicated_attempts()" ng-show="showing_uncommunicated_attempts">Hide</a></div><table class="table table-striped" ng-show="showing_uncommunicated_attempts"><thead><tr><th>{{asset_name()}}</th><th>Customer</th><th>Reason</th></tr></thead><tbody><tr ng-repeat="uncommunicated_attempt in showing_customer_communication.uncommunicated_attempts"><td>{{uncommunicated_attempt.vehicle.title}}</td><td>{{uncommunicated_attempt.vehicle.customer.name}}</td><td>{{uncommunicated_attempt.reason}}</td></tr></tbody></table></div></div></div><div class="modal-footer"><button class="btn" ng-click="close()">Close</button></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("customers/index.html",'<div ng-controller="CustomersController"><ul class="sub-nav" ng-controller="CustomersNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">Customers<div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="search-description" ng-show="keyword">Search "{{query}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="row-fluid"><div class="pull-right"><a class="btn btn-primary" ng-href="#/customers/new">New Customer</a><button class="btn" ng-click="download()" ng-show="show_download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="row-fluid"><div class="column span4"><label class="checkbox" ng-click="toggle_positive_balances()"><input ng-model="showing_positive_balances" type="checkbox" /><span>Customers with positive balances only</span></label></div><div class="column span4"><label class="checkbox" ng-click="search()"><input ng-model="query.is_company" type="checkbox" /><span>Customers who are companies</span></label></div><div class="column span4"><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div></div><div class="row-fluid"><div class="content-box"><div class="spinner" id="customer-list-spinner"></div><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span1 column-sortable" ng-click="sort(&#39;number&#39;)">Cust. No#</div><div class="column span3 column-sortable" ng-click="sort(&#39;name&#39;)">Name</div><div class="column span2">Phone</div><div class="column span2">Email</div><div class="column span2">Address</div><div class="column span2 text-align-right column-sortable" ng-click="sort(&#39;balance&#39;)">Balance</div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="customer in customers"><td><a class="goto" ng-href="#/customers/{{customer.id}}"><div class="row-fluid"><div class="column span1"><div>{{customer.number}}</div></div><div class="column span3"><div>{{customer.name}}</div></div><div class="column span2"><div><div ng-show="customer.phone">{{customer.phone}}</div><div ng-show="customer.mobile &amp;&amp; customer.mobile != customer.phone">{{customer.mobile}}</div></div></div><div class="column span2"><div>{{customer.email}}</div></div><div class="column span2"><div>{{customer.address.full_address}}</div></div><div class="column span2 text-align-right"><div ng-class="{red: customer.balance &gt; 0, green: customer.balance == 0}">{{customer.balance|currency}}</div></div></div></a></td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("customers/insurers.html",'<div ng-controller="InsurersController"><ul class="sub-nav" ng-controller="CustomersNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">3rd Parties<div class="pull-right"></div></div><div class="row-fluid"><div class="pull-right"><a class="btn btn-primary" ng-href="#/customers/new?is_insurer=true">New 3rd Party</a></div></div><br /><div class="row-fluid"><div class="content-box"><div class="spinner" id="insurer-list-spinner"></div><table class="table table-striped"><thead><tr><th class="column-sortable" ng-click="sort(&#39;number&#39;)">Customer No#</th><th class="column-sortable" ng-click="sort(&#39;name&#39;)">Name</th><th>Phone</th><th>Email</th><th>Address</th><th class="column-sortable" ng-click="sort(&#39;balance&#39;)">Balance</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/customers/&#39; + customer.id)" ng-repeat="customer in customers"><td>{{customer.number}}</td><td>{{customer.name}}</td><td><div ng-show="customer.phone">{{customer.phone}}</div><div ng-show="customer.mobile &amp;&amp; customer.mobile != customer.phone">{{customer.mobile}}</div></td><td>{{customer.email}}</td><td>{{customer.address.full_address}}</td><td ng-class="{red: customer.balance &gt; 0, green: customer.balance == 0}">{{customer.balance|currency}}</td></tr></tbody></table></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("customers/new.html",'<div ng-controller="NewCustomerController"><ul class="sub-nav" ng-controller="CustomersNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">New Customer</div><div class="content-box"><div ad-customer-form="true" allow-rename="true" ng-model="customer" on-cancel="cancel_new_customer()" on-save="save_new_customer()"></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("customers/new_vehicle_form.html",'<div id="new-vehicle"><div class="popover fade left in" style="width: 550px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">Add New {{asset_name()}}</div></div><div class="popover-content"><div class="content-box"><form class="form-horizontal"><div ad-vehicle-form="true" ng-model="new_vehicle"></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_new_vehicle()">Save</button><button class="btn" ng-click="cancel_create_new_vehicle()">Cancel</button><div class="spinner" id="save-vehicle-spinner"></div></div></div></form></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("customers/show.html",'<div ng-controller="ShowCustomerController"><ul class="sub-nav" ng-controller="CustomersNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div ng-hide="customer &amp;&amp; customer.id"><div class="spinner" id="customer-spinner"></div></div><div ng-show="customer &amp;&amp; customer.id"><div class="deleted-sign" ng-show="customer.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><div class="row-fluid"><div class="pull-left"><div class="page-header"><span>#{{customer.number}} - {{customer.name}}</span><span ng-show="vehicle">- {{vehicle.title}}</span></div></div><div class="pull-right"><div ad-tag-labels="true" class="inline" owner="customer"></div><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="customer" placement="left" resource="Customer" showing="x_tags"></div></div></div><div class="row-fluid"><div class="pull-right"><div class="dropdown inline" id="customer-statement-actions"><a class="btn" dropdown-toggle="true"><i class="icon icon-list-alt"></i><span>Statement</span></a><ul class="dropdown-menu top-dropdown"><li><a href="javascript:void(0);" id="email-customer-statement-button" ng-click="send_customer_statement()"><i class="icon icon-envelope"></i><span>Send Email</span></a></li><li><a href="javascript:void(0);" id="print-customer-statement-button" ng-click="print_customer_statement()"><i class="icon icon-print"></i><span>Print</span></a></li></ul></div><div class="dropdown inline" id="communication-actions"><a class="btn" dropdown-toggle="true"><i class="icon icon-share-alt"></i><span>Send...</span></a><ul class="dropdown-menu top-dropdown"><li><a href="javascript:void(0);" id="send-sms-button" ng-click="send_sms()"><i class="icon icon-mobile-phone"></i><span>Send SMS</span></a></li><li><a href="javascript:void(0);" id="send-email-button" ng-click="send_email()"><i class="icon icon-envelope"></i><span>Send Email</span></a></li></ul></div><a class="btn btn-primary" ng-href="#/jobs/new?customer_id={{customer.id}}"><i class="icon icon-wrench"></i><span>New Job</span></a><a class="btn btn-primary" ng-href="#/invoices/new?customer_id={{customer.id}}"><i class="icon icon-dollar"></i><span>New Invoice</span></a><button class="btn" id="new-vehicle-button" ng-click="open_new_vehicle_form()">New {{asset_name()}}</button><div class="dropdown inline" id="merge-actions" ng-hide="restricted_to(&#39;deletion&#39;)"><a class="btn btn-danger" dropdown-toggle="true"><span>Merge/Transfer</span></a><ul class="dropdown-menu top-dropdown"><li ng-show="vehicle"><a href="javascript:void(0);" id="send-sms-button" ng-click="transfer_vehicle()"><span>Transfer {{asset_name()}}</span></a></li><li ng-show="vehicle"><a href="javascript:void(0);" id="merge-vehicle-button" ng-click="merge_vehicle()"><span>Merge {{asset_name()}}</span></a></li><li><a href="javascript:void(0);" id="merge-customer-button" ng-click="merge_customer()"><span>Merge Customer</span></a></li></ul></div><button class="btn btn-danger" id="remove-vehicle-button" ng-click="open_delete_vehicle_form()" ng-hide="customer.deleted || !vehicle || restricted_to(&#39;deletion&#39;)"><i class="icon icon-remove"></i><span>Delete {{asset_name()}}</span></button><button class="btn btn-danger" id="remove-customer-button" ng-click="open_delete_customer_form()" ng-hide="customer.deleted || restricted_to(&#39;deletion&#39;)"><i class="icon icon-remove"></i><span>Delete Customer</span></button></div></div><br /><div class="row-fluid"><div class="column span6"><div ad-customer="true" allow-rename="true" ng-model="customer" on-save="customer_updated(data)" on-select-vehicle="show_vehicle(vehicle)" show-invoices="true"></div><div class="content-box"><div ad-files="true" ng-model="customer" title="Customer&#39;s Documents/Photos" upload-url="&#39;/customers/&#39; + customer.id +&#39;/upload_files&#39;"></div></div><div ad-transaction-history="true" customer="customer"></div></div><div class="column span6"><div class="spinner" id="vehicle-spinner"></div><div ng-show="vehicle"><div actions="true" ad-vehicle="true" customer="customer" ng-model="vehicle"></div><div ad-service-schedule="true" customer="vehicle.customer" ng-model="vehicle.service_schedule"></div><div class="content-box"><div ad-files="true" ng-model="vehicle" title="Vehicle&#39;s Photos/Documents" upload-url="&#39;/vehicles/&#39; + vehicle.id +&#39;/upload_files&#39;"></div></div></div><div ng-show="customer.vehicles.length == 0"><span>The customer currently has no vehicle. Please click</span><button class="btn btn-link" ng-click="open_new_vehicle_form()">Here</button><span>to add a vehicle</span></div></div></div><div id="new-vehicle"><div class="popover fade left in" style="width: 550px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">Add New {{asset_name()}}</div></div><div class="popover-content"><div class="content-box"><form class="form-horizontal"><div ad-vehicle-form="true" ng-model="new_vehicle"></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_new_vehicle()">Save</button><button class="btn" ng-click="cancel_create_new_vehicle()">Cancel</button><div class="spinner" id="save-vehicle-spinner"></div></div></div></form></div></div></div></div><div ad-send-email="true" anchor-element="&#39;#communication-actions&#39;" customer="customer" placement="bottom" showing="show_send_email"></div><div ad-send-sms="true" anchor-element="&#39;#communication-actions&#39;" customer="customer" placement="bottom" showing="show_send_sms"></div><div ad-email-statement="true" anchor-element="#customer-statement-actions" customer="customer" default-email="customer.email" placement="bottom" showing="show_send_statement" title="Send Statement"></div><div modal="showing_delete_vehicle_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this vehicle</h3></div><div class="modal-body"><div>Are you sure you want to delete this vehicle ?</div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_vehicle_reason" style="width: 90%"></textarea></div><div class="modal-footer"><div class="spinner" id="delete-vehicle-spinner"></div><button class="btn btn-danger" ng-click="do_delete_vehicle()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_vehicle()">Cancel</button></div></div><div modal="showing_delete_customer_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this customer</h3></div><div class="modal-body"><div>Are you sure you want to delete this customer ?</div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_customer_reason" style="width: 90%"></textarea></div><div class="modal-footer"><div class="spinner" id="delete-customer-spinner"></div><button class="btn btn-danger" ng-click="do_delete_customer()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_customer()">Cancel</button></div></div><div ad-transfer-vehicle="true" anchor-element="#merge-actions" customer="customer" on-select="refresh()" placement="bottom" showing="showing_transfer_vehicle"></div><div ad-merge-vehicle="true" anchor-element="#merge-actions" customer="customer" on-select="refresh()" placement="bottom" showing="showing_merge_vehicle"></div><div ad-merge-customer="true" anchor-element="#merge-actions" customer="customer" placement="bottom" showing="showing_merge_customer"></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("customers/tabs.html",'<ul class="sub-nav" ng-controller="CustomersNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("dashboard.html","")}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("data_export/index.html",'<div ng-controller="DataExportController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="page-header"><span>Data Export/Import</span></div></div><div class="row-fluid"><div class="alert alert-info" ng-show="current_requests.length &gt; 0"><span>Your data is being export and will be sent to your workshop email upon completion.</span></div></div><div class="row-fluid"><div class="column span8"><div class="content-box"><div class="sub-header">Data Export</div><br /><div class="well">Please select the resources to export. Your data will be extracted by a background process and send to your workshop email address upon completion. You can check the status of your request on the right hand side panel under <b>Current Export Requests</b>.</div><label class="checkbox"><input ng-checked="all_selected()" ng-click="toggle_select_all()" type="checkbox" /><span>All</span></label><label class="checkbox" ng-repeat="resource in all_resources"><input check-list="selected_resources" type="checkbox" value="{{resource.value}}" /><span>{{resource.name}}</span></label><br /><div><div>Export From Date (Leave blank if you want to export all data)</div><div ad-datepicker="true" ng-model="from_date"></div></div><br /><div><div>Password</div><input ng-model="password" type="password" /> <span class="red" ng-show="error">{{error}}</span></div><br /><div class="action-buttons"><button class="btn btn-primary" ng-click="export()">Export</button></div></div><br /><div class="content-box"><div class="sub-header">Data Import</div><br /><div class="well">To import data, please download the template spreadsheet below and <b>match the headers</b> of your import file with the ones in the template. Finally, send the header matched data file to us at import@mechanicdesk.com.au quoting the workshop ID, a contact number we can reach you on and any special requirements you may have. We will try and accomodate your request to the best of our abilities.</div><br /><a ng-href="/images/import_template.xls" target="_blank">Download import template spreadsheet</a></div></div><div class="column span4 content-box"><div class="sub-header">Current Export Requests</div><br /><div class="row-fluid" ng-repeat="request in current_requests"><div class="column span6"><img ng-show="request.status == &#39;started&#39;" ng-src="/assets/littlespinner-b053f26fde4de42a09c6c20272ce08ba.gif" /><span>&nbsp;</span><span>{{request.time|date}} by {{request.created_by.name}}</span></div><div class="column span4"><button class="btn btn-link" ng-click="cancel(request)">Cancel</button></div><div class="column span2"><div class="pull-right"><span ng-class="{red: request.status == &#39;failed&#39;, green: request.status == &#39;finished&#39;}">{{request.status}}</span></div></div></div><br /><br /><div class="sub-header">Previous Export Requests</div><br /><div class="row-fluid" ng-repeat="request in previous_requests"><span>{{request.time|date}}</span><div class="pull-right"><span ng-class="{red: request.status == &#39;failed&#39;, green: request.status == &#39;finished&#39;}">{{request.status}}</span></div><div ng-show="request.error"><pre class="no-style">{{request.error}}</pre></div><hr /></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("dialogs/form_validation.html",'<div modal="show_form_validation" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Invalid Input</h3></div><div class="modal-body"><div>Please correct input error before proceed</div></div><div class="modal-footer"><button class="btn" ng-click="show_form_validation = false">Close</button></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("diary/index.html",'<div ng-controller="DiaryController"><ul class="sub-nav" ng-controller="BookingsNavController" ng-hide="links.length == 0"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i><span>{{link.name}}</span><span class="badge badge-notifications" ng-show="link.name == &#39;Online Booking Requests&#39; &amp;&amp; booking_request_count() &gt; 0" style="margin-left: 5px"><span class="red">{{booking_request_count()}}</span></span></a></li></ul><div class="row-fluid"><div class="page-header">Workshop Diary</div></div><div class="row-fluid"><div class="pull-right"><div class="dropdown inline" id="print-run-sheet-button" ng-hide="restricted_to_create_jobs()"><a class="btn" dropdown-toggle="true"><i class="icon icon-print"></i><span>Print Run Sheet</span></a><ul class="dropdown-menu top-dropdown"><li><a href="javascript:void(0);" ng-click="print_day_run_sheet()"><span>Print today run sheet</span></a></li><li><a href="javascript:void(0);" ng-click="print_week_run_sheet()"><span>Print this week run sheet</span></a></li><li><a href="javascript:void(0);" ng-click="print_run_sheet_options()"><span>More Options</span></a></li></ul><a class="btn btn-primary" ng-click="new_booking()"><i class="icon-calendar"></i>New Booking</a><a class="btn btn-primary" ng-click="new_job()"><i class="icon-wrench"></i>New Job</a></div></div></div><br /><div class="row-fluid"><div ad-scheduler="true" date="date"></div></div><div id="print-run-sheet-popover"><div class="popover fade left in" style="width: 550px"><div class="popover-title"><div class="sub-header">Print Run Sheet</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form class="form form-horizontal"><div class="control-group"><label class="control-label">Start Date</label><div class="controls"><ad-datepicker ng-model="run_sheet.start_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">End Date</label><div class="controls"><ad-datepicker ng-model="run_sheet.end_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox"><input ng-model="run_sheet.without_on_hold" type="checkbox" />Print Without On Hold Jobs</label></div></div><hr /><div class="control-group"><label class="control-label">Employees</label><div class="controls"><label class="checkbox"><input checked="true" ng-click="run_sheet_toggle_all_employees()" type="checkbox" />All</label><label class="checkbox" ng-repeat="employee in employees()"><input check-list="run_sheet.employee_ids" type="checkbox" value="{{employee.id}}">{{employee.name}}</input></label></div></div><br /><div class="control-group"><label class="control-label">&nbsp;</label><div class="controls"><div class="button-panel"><button class="btn btn-success" ng-click="print_run_sheet()" type="button">Print</button><button class="btn" ng-click="cancel_print_run_sheet()" type="button">Cancel</button></div></div></div></form></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("diary/map.html",'<div ng-controller="MapController"><ul class="sub-nav" ng-controller="BookingsNavController" ng-hide="links.length == 0"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i><span>{{link.name}}</span><span class="badge badge-notifications" ng-show="link.name == &#39;Online Booking Requests&#39; &amp;&amp; booking_request_count() &gt; 0" style="margin-left: 5px"><span class="red">{{booking_request_count()}}</span></span></a></li></ul><div class="row-fluid"><div class="page-header">Map</div></div><div class="row-fluid"><div class="column span4"></div><div class="column span8"><div class="row-fluid"><div class="column span4"><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="filter()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div><div class="column span4"><select class="inline" ng-change="filter()" ng-model="query.employee_id" ng-options="employee.id as employee.name for employee in employees()"><option value="">Assigned To</option></select></div><div class="column span4"><div ad-job-type-selection="true" ng-model="query.job_type_ids"></div></div></div></div></div><div class="row-fluid"><div class="column span4"><table class="table table-striped"><tbody><tr ng-repeat="job in filtered_jobs"><td><div>{{job.time|date: \'shortTime\'}}</div><br /><div>{{street_address(job.customer).full_address}}</div></td></tr></tbody></table></div><div class="column span8"><div id="jobs-map"></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("diary/tabs.html",'<ul class="sub-nav" ng-controller="BookingsNavController" ng-hide="links.length == 0"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i><span>{{link.name}}</span><span class="badge badge-notifications" ng-show="link.name == &#39;Online Booking Requests&#39; &amp;&amp; booking_request_count() &gt; 0" style="margin-left: 5px"><span class="red">{{booking_request_count()}}</span></span></a></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_3rd_party_explain.html",'<a href="javascript:void(0)" id="3rd-party-explain-link" ng-click="show()">What\'s this?</a><div id="3rd-party-popover"><div class="popover fade top in" style="width: 600px"><div class="popover-title"><div class="sub-header">3rd Party<div class="pull-right"><button class="btn" ng-click="hide()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid" style="height: 250px; overflow-x: auto; overflow-y: auto"><div class="content-box"><div>A 3rd Party can be an Insurance company, a co-operative group etc..</div><br /><div>When you invoice a 3rd party, the job is done on the vehicle for the vehicle owner, but It is the 3rd party that will be invoiced to and will pay for the job.</div><br /><div><button class="btn-link" ng-click="hide()"><i class="icon-remove"></i>Close</button></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_accounting_account_picker.html",'<select ng-model="accounting_account" ng-options="account.id as account.title for account in filtered_accounts()"><option value=""></option></select>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_accounting_sync_result.html",'<div ng-show="sync_result &amp;&amp; sync_result.available"><div class="inline" style="vertical-align: top"><i class="icon icon-check green" ng-show="sync_result.finished"></i><i class="icon icon-check-empty" ng-show="!sync_result.finished &amp;&amp; !sync_result.failed"></i><i class="icon icon-remove red" ng-show="sync_result.failed"></i></div><div class="inline"><img ng-show="sync_result.syncing" src="/assets/littlespinner-b053f26fde4de42a09c6c20272ce08ba.gif" /><span class="bold">&nbsp; {{name}}</span><span ng-show="sync_result.status">&nbsp- {{sync_result.status}}</span><pre class="no-style italic" ng-show="sync_result.description" style="word-break: normal">&nbsp;{{sync_result.description}}</pre></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_adjust_time.html",'<div id="adjust-time"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">Employees</div></div><div class="popover-content"><form class="form form-horizontal"><div class="content-box"><div class="control-group"><label class="control-label">{{time_label()}}</label><div class="controls"><div id="show-courtesy-booking-form-position" style="position: absolute, margin-left: 500px; visibility: hidden"></div><ad-datepicker error="top" ng-model="time"></ad-datepicker><ad-timepicker ng-model="time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimated Finished Time</label><div class="controls"><ad-datepicker error="top" ng-model="finished_time"></ad-datepicker><ad-timepicker ng-model="finished_time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimated work hours</label><div class="controls"><input class="input-small" ng-model="total_hours" step="any" type="number" /></div></div><div class="control-group" ng-hide="provide_mobile_service()"><label class="control-label">Pick up time</label><div class="controls"><ad-datepicker error="top" ng-model="pickup_time"></ad-datepicker><ad-timepicker ng-model="pickup_time"></ad-timepicker></div></div></div><div><label class="label-name-left"></label><div><button class="btn btn-success" ng-click="save()">Save</button><button class="btn" ng-click="hide()">Cancel</button><div class="spinner" id="adjust-time-spinner"></div></div></div></form></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_assign_employees.html",'<div id="assign-employees"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">Employees</div></div><div class="popover-content"><div class="row-fluid"><form><div class="content-box"><div><label class="label-name-left">Mechanic 1:</label><select ng-model="mechanic_1_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(1)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 2:</label><select ng-model="mechanic_2_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(2)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 3:</label><select ng-model="mechanic_3_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(3)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 4:</label><select ng-model="mechanic_4_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(4)"><div class="icon icon-remove red"></div></a></div></div><div><label class="label-name-left"></label><div><button class="btn btn-success" ng-click="save()">Save</button><button class="btn" ng-click="hide()">Cancel</button><div class="spinner" id="assign-employees-spinner"></div></div></div></form></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_avatar.html",'<div class="sub-header"><div class="inline"><div class="inline" id="photo-list">{{title}}</div></div><div class="inline" ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_files()">Upload</button></div></div><div ng-click="uploading_files()" ng-hide="uploading_files"><img class="avatar" ng-show="employee.avatar" ng-src="{{employee.avatar.url}}" /><form><div id="nothing"></div></form></div><form action="{{upload_url}}" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><input name="employee_id" type="hidden" value="{{employee.id}}" /><div><label class="inline">Please Note *: file size should be maximum 1 Mb</label></div><br /><div><input id="upload-avatar" name="file" type="file" /></div><br /><div class="spinner inline" id="upload-photos-spinner-{{spinner_id}}"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_bill_selection.html",'<div id="bill-selection"><div class="popover fade left in" style="width: 800px"><div class="popover-title"><div class="sub-header">{{supplier.name}}\'s unpaid bills</div></div><div class="popover-content"><div class="row-fluid"><div class="pull-right"><div class="input-append"><input class="input" ng-model="bill_search" type="text" /><span class="add-on"><i class="icon icon-search"></i></span></div></div></div><br /><div class="content-box"><div class="spinner" id="loading-bills-spinner"></div><div class="row-fluid"><div class="column span4"><div class="bold">Available Amount: {{allocatable_amount()|currency}}</div></div><div class="column span4"><div class="bold">Allocated Amount: {{total_allocated_amount()|currency}}</div></div><div class="column span4"><div class="pull-right"><button class="btn btn-warning" ng-click="automatic_allocate()" ng-hide="total_allocated_amount() &gt; 0">Auto-Allocate</button><button class="btn" ng-click="unallocate()" ng-show="total_allocated_amount() &gt; 0">Unallocate</button><div class="spinner" id="auto-allocate-spinner"></div></div></div></div><br /><table class="table table-striped" style="max-height: 600px; overflow-y: auto"><thead></thead><tbody><tr ng-repeat="bill in bills | filter: bill_search"><td><div ng-class="{&#39;bill-selected&#39;: bill.selected}"><div class="row-fluid"><div class="column span2"><div class="buttons"><button class="btn btn-link" ng-click="select(bill)" ng-disabled="auto_allocating" ng-hide="bill.selected || auto_allocating"> Select</button><button class="btn btn-link" ng-click="deselect(bill)" ng-disabled="auto_allocating" ng-show="bill.selected &amp;&amp; !auto_allocating">Unselect</button></div></div><div class="column span4"><div><span class="label-name-left auto-width">Bill Ref#:</span><span>{{bill.reference}}</span></div><div><span class="label-name-left auto-width">Supplier:</span><span>{{bill.supplier_name}}</span></div><div></div><span class="label-name-left auto-width">Date:</span><span>{{bill.date|date: \'mediumDate\'}}</span></div><div class="column span6"><div class="pull-right"><button class="btn btn-link" ng-click="show_items(bill)" ng-hide="bill.show_items">Show Items</button><button class="btn btn-link" ng-click="hide_items(bill)" ng-show="bill.show_items">Hide Items</button></div><div><span class="label-name-left auto-width">Total:</span><span class="bold">{{bill.total_amount|currency}}</span></div><div><span class="label-name-left auto-width">Remaining:</span><span class="bold">{{bill.unpaid_amount|currency}}</span></div></div></div><div class="row-fluid" ng-show="bill.selected"><br /><div class="column span12"><span class="label-name-left auto-width">Amount:</span><input class="input-small" ng-model="bill.allocated_amount" type="text" /></div></div><div class="row-fluid" ng-show="bill.show_items"><br /><table class="table"><thead><tr><td class="bold">Description</td><td class="bold">Quantity</td><td class="bold">Price</td><td class="bold">Total</td></tr></thead><tbody><tr ng-repeat="item in bill.bill_items"><td>{{item.description}}</td><td>{{item.quantity}}</td><td>{{item.unit_price|currency}}</td><td>{{item.total_amount|currency}}</td></tr></tbody></table></div></div></td></tr></tbody></table><br /></div><div class="buttons"><button class="btn btn-success" ng-click="do_select()">Select</button><button class="btn" ng-click="hide()">Cancel</button><div class="spinner" id="select-bills-spinner"></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_bill_viewer.html",'<div id="bill-viewer-popover"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="row-fluid"><div class="sub-header"><span ng-hide="bill.type == &#39;credit note&#39;">Bill #{{bill.reference}}</span><span ng-show="bill.type == &#39;credit note&#39;">Supplier Credit Note #{{bill.reference}}</span></div><div class="pull-right"><a class="btn btn-primary" ng-href="{{bill_path()}}" target="_blank">Full Details</a></div></div></div><div class="popover-content"><div class="content-box"><div class="spinner" id="bill-viewer-spinner"></div><div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Rate</div><div class="total">Total</div><div class="included-gst"></div></div><div class="cost" ng-repeat="bill_item in bill.bill_items"><div><div class="description"><span>{{bill_item.description}}</span></div><div class="quantity">{{bill_item.quantity}}</div><div class="rate">{{bill_item.unit_price|currency}}</div><div class="total">{{bill_item.total_amount | currency}}</div><div class="included-gst"><div ng-hide="bill.not_registered_for_gst"><span ng-show="bill_item.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="bill_item.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span></div></div></div></div><div class="summary"><div ng-hide="not_registered_for_gst()"><div><div class="title">Total Excl. {{tax_name()}}:</div> <div class="value">{{bill.net_amount | currency}}</div></div><div><div class="title">{{tax_name()}}:&nbsp;</div><div class="value">{{bill.gst_amount | currency}}</div></div></div><div><div class="title">Total:</div> <div class="value">{{bill.total_amount | currency}}</div></div></div></div></div><button class="btn btn-primary" ng-click="hide()">Close</button></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_billpicker.html",'<div class="inline"><div class="input-append"><input autocomplete="off" class="span12" id="{{input_id}}" ng-maxlength="255" ng-model="bill.lookup_text" ng-readonly="readonly" style="min-width: 200px; max-width: 300px" type="text" typeahead="item.lookup_text for item in lookup($viewValue)" typeahead-on-select="select($item, $model, $label, selected_bill)" typeahead-wait-ms="200" /><span class="add-on"><div class="spinner spinner-small" id="lookup-bill-spinner-{{spinner_id}}"></div><i class="icon icon-search" id="lookup-bill-icon-{{spinner_id}}"></i></span><span>&nbsp; {{bill.supplier_name}}</span></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_buyin_selection.html",'<div id="buyin-selection"><div class="popover fade left in" style="width: 800px"><div class="popover-title"><div class="sub-header">Bills</div></div><div class="popover-content"><form class="form-search"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form><div class="content-box"><div id="bill-list-spinner"></div><table class="table table-striped"><thead></thead><tbody><tr ng-repeat="bill in bills"><td><div><div class="row-fluid"><div class="column span4"><span class="label-name-left auto-width">Supplier:</span><span>{{bill.supplier.name}}</span></div><div class="column span4"><div><span class="label-name-left auto-width">Reference:</span><span>{{bill.reference}}</span></div><div></div><span class="label-name-left auto-width">Date:</span><span>{{bill.date|date: \'mediumDate\'}}</span></div><div class="column span4"><div class="pull-right"><button class="btn btn-link" ng-click="show_items(bill)" ng-hide="bill.show_items">Show Items</button><button class="btn btn-link" ng-click="hide_items(bill)" ng-show="bill.show_items">Hide Items</button></div><div><span class="label-name-left auto-width">Total:</span><span class="bold">{{bill.total_amount|currency}}</span></div></div></div><div class="row-fluid" ng-show="bill.show_items"><br /><table class="table"><thead><tr><td class="bold">Description</td><td class="bold">Quantity</td><td class="bold">Price</td><td class="bold" style="width: 150px">Total</td></tr></thead><tbody><tr class="pointer" ng-class="{&#39;bill-item-selected&#39;: item.selected}" ng-click="select(item)" ng-repeat="item in bill.bill_items"><td><span class="label label-info" ng-show="item.is_buyin">B</span><span>&nbsp;</span><span>{{item.description}}</span></td><td>{{item.quantity}}</td><td>{{item.unit_price|currency}}</td><td><div class="inline">{{item.total_amount|currency}}</div><div class="pull-right" ng-show="item.selected" style="margin-left: 5px;"><button class="btn btn-link" ng-click="deselect(item)" stop-event="click">Unselect</button></div></td></tr></tbody></table></div></div></td></tr></tbody></table><br /><pagination boundary-links="true" current-page="page_number" max-size="8" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div><div class="buttons"><button class="btn btn-success" ng-click="do_select()">Select</button><button class="btn" ng-click="hide()">Cancel</button></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_change_customer.html",'<div id="change-customer"></div><div id="{{popover_id}}"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header"><Change>Customer</Change></div></div><div class="popover-content"><div class="row-fluid"><form autocomplete="off" class="form-horizontal" novalidate="true"><div class="control-group"><label class="control-label bold" ng-show="invoice">Bill To:</label><label class="control-label bold" ng-show="quote">Prepared For:</label><div class="controls"><div customer="editing_customer.customer" customerpicker="true" input-id="{{input_id}}"></div><div ng-show="job"><label class="checkbox"><input ng-model="editing_customer.transfer_vehicle" type="checkbox" /><span>Transfer the vehicle as well</span></label><label class="checkbox" ng-show="job.sub_jobs"><input ng-model="editing_customer.change_sub_jobs_customer" type="checkbox" /><span>Change the sub jobs\' customer as well</span></label><label class="checkb_x" ng-show="job.customer.id == job.invoice.customer.id"><input ng-model="editing_customer.change_invoice_customer" type="checkbox" /><span>Change the invoice as well</span></label><label class="checkbox" ng-show="job.customer.id == job.quote.customer.id"><input ng-model="editing_customer.change_quote_customer" type="checkbox" /><span>Change the quote as well</span></label></div></div></div><div class="control-group" ng-show="quote"><label class="control-label bold" ng-show="quote">Third Party:</label><div class="controls"><insurerpicker ng-model="editing_customer.insurer_id"></insurerpicker></div></div><div class="control-group" ng-show="editing_customer.customer.is_insurer"><label class="control-label">Claim No.:</label><div class="controls"><input class="input" ng-model="editing_customer.claim_number" type="text" /></div></div><div class="control-group" ng-show="editing_customer.customer.is_insurer"><label class="control-label">Account No.:</label><div class="controls"><input class="input" ng-model="editing_customer.account_number" type="text" /></div></div><div class="control-group" ng-show="editing_customer.customer.is_insurer"><label class="control-label">Excess:</label><div class="controls"><input class="input" ng-model="editing_customer.excess" type="text" /></div></div><div class="control-group"><label class="control-label"><span class="bold"></span></label><div class="controls"><button class="btn btn-primary" ng-click="change_customer()">Change</button><button class="btn" ng-click="hide()">Cancel</button><div class="spinner" id="{{spinner_id}}"></div></div></div></form></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_change_vehicle.html",'<div class="row-fluid"><span class="bold">Change {{asset_name()}} To:</span><form autocomplete="off" novalidate="true"><div customer="customer" input-id="vehicle-picker-input" vehicle="editing_vehicle.vehicle" vehiclepicker="true"></div><br /><button class="btn btn-primary" ng-click="change_vehicle()">Change</button><button class="btn" ng-click="cancel()">Cancel</button></form><div class="spinner" id="change-vehicle-spinner"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_confirmation.html",'<div id="ad-confirmation"><div class="popover fade left in" style="width: 600px; z-index: 9999"><div class="popover-title"><div class="sub-header">Please confirm...</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><pre class="no-style word-wrap" id="ad-confirmation-message"></pre></div><center><button class="btn btn-success hide" id="ad-confirmation-success" ng-click="ok()">Yes, Continue</button><button class="btn btn-danger hide" id="ad-confirmation-danger" ng-click="ok()">Yes, Continue</button><button class="btn" ng-click="cancel()">No, Cancel</button></center></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_contact_name_warning.html",'<div ng-show="matches.length &gt; 0 &amp;&amp; !contact.id"><span class="red">{{message}}</span><br /></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_courtesy_vehicle_availability.html",'<div class="row-fluid"><div class="column span12"><div class="inline">From: &nbsp;</div><div ad-datepicker="true" class="inline" error="top" ng-change="fetch_availabilities()" ng-model="start_time" style="margin-top: 10px"></div><div class="inline">&nbsp; showing &nbsp;</div><label class="label label-info">{{time_frame}}</label>  <div class="inline">days ahead</div><div class="pull-right"><button class="inline btn" ng-click="fetch_availabilities()" style="margin-top: 10px;">Refresh</button><button class="inline btn btn-primary" ng-click="add_new_vehicle()" style="margin-top: 10px;">New vehicle</button></div></div></div><div class="row-fluid"><div class="column span12"><div class="content-box"><div class="spinner" id="bookings-spinner"></div><table class="table"><thead><tr><th><div class="row-fluid"><div class="column span4"><div ng-show="error" style="color: red">{{error}}</div><div><a class="inline" href="javascript:void(0)" ng-click="jump_back_seven_days()" target="_blank">{{"<<"}} &nbsp;</a><a class="inline" href="javascript:void(0)" ng-click="jump_to_today()" target="_blank">Today &nbsp;</a><a class="inline" href="javascript:void(0)" ng-click="jump_forward_seven_days()" target="_blank">{{">>"}} &nbsp;</a></div></div><div class="column span8"><div class="inline" style="background-color: green; width: 20px; margin-right: 3px; border-radius: 20px;">&nbsp;</div><div class="inline" style="margin-right: 6px;">Available</div><div class="inline" style="background-color: red; width: 20px; margin-right: 3px; border-radius: 20px;">&nbsp;</div><div class="inline" style="margin-right: 6px;">Booked</div><div class="inline" ng-show="job" style="background-color: yellow; width: 20px; margin-right: 3px; border-radius: 20px;">&nbsp;</div><div class="inline" ng-show="job" style="margin-right: 6px;">Booked for current job or booking</div></div></div><div class="row-fluid"><div class="column span3"><div id="vehicle-form-anchor">Vehicle</div></div><div class="column span9"><div>Availability</div><div class="row-fluid" style="margin-bottom: -10px"><div class="column span12"><div class="inline" style="margin-left: 10px;">| {{date_1 | date:"dd/MM"}}</div><div class="inline" ng-repeat="x in date_marker_padding" style="width: 20px">&nbsp;</div><div class="inline" style="margin-left: 14px;">| {{date_2 | date:"dd/MM"}}</div><div class="inline" ng-repeat="x in date_marker_padding" style="width: 20px">&nbsp;</div><div class="inline" style="margin-left: 18px;">| {{date_3 | date:"dd/MM"}}</div><div class="inline" ng-repeat="x in date_marker_padding" style="width: 20px">&nbsp;</div><div class="inline" style="margin-left: 14px;">| {{date_4 | date:"dd/MM"}}</div><div class="inline" ng-repeat="x in date_marker_padding" style="width: 20px">&nbsp;</div><div class="inline" style="margin-left: 15px;">| {{date_5 | date:"dd/MM"}}</div></div></div></div></div></th></tr><tbody><tr class="goto" ng-repeat="(vehicle_id, vehicle_availabilities) in courtesy_vehicle_availabilities"><td><div class="row-fluid"><div class="column span3 truncate"><div class="inline" ng-show="job" style="vertical-align: top"><div class="label label-success inline" ng-show="job.courtesy_vehicle_booking.vehicle_id == vehicle_id" style="margin-right: 5px">Booked</div><a class="btn btn-primary" href="javascript:void(0);" ng-click="select_vehicle(vehicle_availabilities.vehicle)" ng-hide="job.courtesy_vehicle_booking.vehicle_id == vehicle_id" style="margin-right: 5px; vertical-align: top">Select</a></div><div class="inline"><div>{{vehicle_availabilities.vehicle | vehicle_title: \'withoutRego\'}}</div><div ng-show="vehicle_availabilities.vehicle.registration_number">Reg. No# {{vehicle_availabilities.vehicle.registration_number}}</div></div></div><div class="column span9"><div class="inline" ng-repeat="day in vehicle_availabilities.days" style="background-color: {{highlight_indicator(day)}}; width: 20px;"><span ng-click="booking_actions(day)" style="background-color: {{availability_indicator(day)}}; margin: 2px; width: 100%; border-radius: 20px;" tooltip="{{day.date | date:&#39;dd/MM&#39;}} {{day.booking.customer.name}}">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="pull-right"><button class="btn btn-link" ng-click="remove(vehicle_id)"><i class="icon icon-remove red"></i>Remove</button></div></div></div></td></tr><tr><td><div class="row-fluid"><div class="column span12"><div ng-show="job">Click \'Select\' to register this vehicle for the current job.</div><div ng-show="job">The booking will be pending and will only be saved after the new job is saved.</div></div></div></td></tr></tbody></thead></table></div></div></div><div class="row-fluid"><div class="column span12"><div id="new-vehicle-form"><div class="popover fade left in" style="width: 550px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">Add New {{asset_name()}}</div></div><div class="popover-content"><div class="content-box"><form class="form-horizontal"><div ad-vehicle-form="true" ng-model="new_vehicle"></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="create_vehicle()">Save</button><button class="btn" ng-click="cancel_new_vehicle()">Cancel</button><div class="spinner" id="save-vehicle-spinner"></div></div></div></form></div></div></div></div><div id="vehicle-booking-form"><div class="popover fade left in" style="width: 800px"><div class="arrow"></div><div class="popover-title"><div class="sub-header" ng-hide="editing_booking.id">New Booking  for {{editing_booking.vehicle.title}}</div><div class="sub-header" ng-show="editing_booking.id">Edit Booking for {{editing_booking.vehicle.title}}</div></div><div class="popover-content"><div class="content-box"><form class="form-horizontal"><div ng-show="booking_error" style="color: red">{{booking_error}}</div><div class="control-group"><label class="control-label"><div>Job number</div></label><div class="controls"><div ad-jobpicker="true" job="editing_booking.job" ng-model="editing_booking.job_id"></div></div></div><div class="control-group"><label class="control-label"><div>Check out date</div></label><div class="controls"><ad-datepicker error="top" ng-model="editing_booking.check_out_time"></ad-datepicker></div></div><div class="control-group"><label class="control-label"><div>Return date</div></label><div class="controls"><ad-datepicker error="top" ng-model="editing_booking.return_time"></ad-datepicker></div></div><div class="control-group"><label class="control-label"><div>Notes</div></label><div class="controls"><input ng-model="editing_booking.note" style="width: 50%, height: 100px;" type="textbox" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_booking()">Save</button><button class="btn" ng-click="cancel_edit_booking()">Cancel</button><button class="btn btn-danger" ng-click="delete_booking(editing_booking)" ng-show="editing_booking.id" style="margin-left: 50px">Delete</button><div class="pull-right"><a href="/courtesy_vehicle_bookings/{{editing_booking.id}}/terms_and_conditions.pdf" ng-show="editing_booking.id" style="margin-right: 10px;" target="_blank">Print T&C</a></div><div class="spinner" id="edit-booking-spinner"></div></div></div></form></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_customer.html",'<div class="content-nav"><ul><li ng-class="{active: left_side==&#39;details&#39;}" ng-click="show_left_side(&#39;details&#39;)"><a>Customer Details</a></li><li ng-class="{active: left_side == &#39;contacts&#39;}" ng-click="show_left_side(&#39;contacts&#39;)"><a>Contacts</a></li><li ng-class="{active: left_side==&#39;vehicles&#39;}" ng-click="show_left_side(&#39;vehicles&#39;)" ng-hide="!customer.vehicles || customer.vehicles.length == 0"><a>{{asset_name_plural()}}</a></li></ul></div><div class="content-box"><div ng-show="left_side==&#39;vehicles&#39;"><div class="spinner" id="customer-vehicle-list-spinner"></div><table class="table table-striped" style="max-height: 600px; y-overflow: scroll;"><thead><tr><th>{{asset_name()}}</th><th>Fleet. No#</th><th>Last Job Date</th><th>Next Service</th></tr></thead><tbody><tr class="goto" ng-click="select_vehicle(v)" ng-repeat="v in customer.vehicles"><td><div>{{v.title}}</div><div ng-show="v.serial_number">{{v.serial_number}}</div></td><td>{{v.fleet_number}}</td><td>{{v.service_schedule.last_service_date|date: \'mediumDate\'}}</td><td>{{v.service_schedule.next_service_date|date: \'mediumDate\'}}</td></tr></tbody></table><pagination boundary-links="true" current-page="vehicle_page_number" max-size="8" num-pages="vehicle_total_pages" on-select-page="selectVehiclePage(page)" rotate="false"></pagination></div><div ng-show="left_side==&#39;contacts&#39;"><div class="spinner" id="customer-contacts-spinner"></div><div class="sub-header">Contacts</div><table class="table table-striped" style="max-height: 600px; y-overflow: scroll;"><thead><tr><th><div class="row-fluid"><div class="span4">Name</div><div class="span3">Phone/Mobile</div><div class="span3">Email</div><div class="span2">Position</div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="c in customer.contacts"><td><div class="row-fluid" ng-click="edit_contact(c)" ng-hide="c.editing"><div class="column span4">{{c.name}}</div><div class="column span3"><div>{{c.phone}}</div><div>{{c.mobile}}</div></div><div class="column span3">{{c.email}}</div><div class="column span2">{{c.position}}</div></div><div class="row-fluid" ng-show="c.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input ng-model="c.editing.name" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="c.editing.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Mobile</label><div class="controls"><input ng-model="c.editing.mobile" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input ng-model="c.editing.email" type="text" /></div></div><div class="control-group"><label class="control-label">Title/Position</label><div class="controls"><input ng-model="c.editing.position" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_contact(c)" type="submit">Save</button><button class="btn" ng-click="cancel_editing_contact(c)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="destroy_contact(c)">Remove</button></div></div></div></form></div></td></tr><tr><td><div ng-hide="new_contact"><a href="javascript:void(0);" ng-click="create_contact()">New Contact</a></div><div ng-show="new_contact"><form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input ng-model="new_contact.name" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="new_contact.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Mobile</label><div class="controls"><input ng-model="new_contact.mobile" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input ng-model="new_contact.email" type="text" /></div></div><div class="control-group"><label class="control-label">Title/Position</label><div class="controls"><input ng-model="new_contact.position" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_new_contact()" type="submit">Save</button><button class="btn" ng-click="cancel_new_contact()">Cancel</button></div></div></form></div></td></tr></tbody></table></div><div ng-show="left_side==&#39;details&#39;"><div class="spinner" id="customer-details-spinner"></div><div class="sub-header">Customer Details</div><div class="editable" ng-click="edit(customer)" ng-hide="customer.editing"><div class="info"><span class="label-name customer-field-label">Name:</span><span>{{customer.name}}</span></div><div class="info" ng-show="country() == &#39;au&#39;"><span class="label-name customer-field-label" ng-show="customer.abn">ABN:</span><span>{{customer.abn}}</span></div><div class="info" ng-show="country() != &#39;au&#39;"><span class="label-name customer-field-label" ng-show="customer.tax_registration_number">{{tax_registration_name()}}:</span><span>{{customer.tax_registration_number}}</span></div><div class="info" ng-show="customer.contact_name"><span class="label-name customer-field-label">Contact Person:</span><span>{{customer.contact_name}}</span></div><div class="info" ng-show="customer.insurer_id"><span class="label-name customer-field-label">Invoice To Third Party:</span><span>{{customer.insurer.name}}</span></div><div class="info" ng-show="customer.insurer_id"><span class="label-name customer-field-label">Third Party Acct. No.:</span><span>{{customer.third_party_account_number}}</span></div><div class="info"><span class="label-name customer-field-label">Email:</span><span>{{customer.email}}</span></div><div class="info"><span class="label-name customer-field-label">Mobile:</span><span>{{customer.mobile}}</span></div><div class="info"><span class="label-name customer-field-label">Phone:</span><span>{{customer.phone}}</span></div><div class="info"><span class="label-name customer-field-label">Fax:</span><span>{{customer.fax}}</span></div><div class="info"><span class="label-name customer-field-label">Postal Address:</span><span>{{customer.address.full_address}}</span></div><div class="info" ng-show="customer.street_address"><span class="label-name customer-field-label">Street Address:</span><span>{{customer.street_address.full_address}}</span></div><div class="info"><span class="label-name customer-field-label">Price Level:</span><span>{{customer_price_level_name()}}</span></div><div class="info"><span class="label-name customer-field-label">Payment Term:</span><span>{{customer.payment_term_name}}</span></div><div class="info" ng-show="customer.credit_limit &amp;&amp; customer.credit_limit &gt; 0"><span class="label-name customer-field-label">Credit Limit:</span><span>{{customer.credit_limit|currency}}</span></div><div class="info" ng-show="customer.special_account_number"><span class="label-name customer-field-label">Special Account Number:</span><span>{{customer.special_account_number}}</span></div><div class="info" ng-show="customer.business_source"><span class="label-name customer-field-label">Source Of Business:</span><span>{{customer.business_source.name}}</span></div><div class="info" ng-show="customer.discount_percentage &amp;&amp; customer.discount_percentage &gt; 0"><span class="label-name customer-field-label">Default Discount:</span><span>{{customer.discount_percentage}} %</span></div><div class="info" ng-show="customer.disable_booking_reminder"><span class="label-name customer-field-label">Booking Reminder:</span><span>Disabled</span></div><div class="info" ng-show="customer.disable_service_reminder"><span class="label-name customer-field-label">Service Reminder:</span><span>Disabled</span></div><div class="info" ng-show="customer.payment_instruction"><span class="label-name customer-field-label">Special Payment Instruction:</span><span>{{customer.payment_instruction}}</span></div><div class="info" ng-show="customer.send_communications_to_driver"><span class="label-name customer-field-label">Send Communications To Driver:</span><span>Yes</span></div></div><div class="editing-item" ng-show="customer.editing"><div ad-customer-form="true" allow-rename="allowRename" ng-model="customer.editing" on-cancel="cancel_edit()" on-save="customer_updated()"></div></div><br /><div ad-notes="true" model-type="customer" ng-model="customer"></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_customer_communication.html",'<div id="send-reminder-dialog"><div class="popover fade bottom in" style="width: 500px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">Send Reminder</div></div><div class="popover-content"><form><div class="control-group"><label class="control-label bold">Sent by:</label><div class="controls"><label class="radio"><input ng-model="customer_communication.delivery_method" type="radio" value="email_then_sms" />Try email first then sms</label><label class="radio"><input ng-model="customer_communication.delivery_method" type="radio" value="sms_then_email" />Try sms first then email</label><label class="radio"><input ng-model="customer_communication.delivery_method" type="radio" value="email_only" />Send by email only</label><label class="radio"><input ng-model="customer_communication.delivery_method" type="radio" value="sms_only" />Send by sms only</label><label class="radio"><input ng-model="customer_communication.delivery_method" type="radio" value="email_and_sms" />Send both email and sms</label><label class="radio"><input ng-model="customer_communication.delivery_method" type="radio" value="postal_mail" />Generate postal mails</label><br /><label class="checkbox" ng-hide="customer_communication.delivery_method == &#39;postal_mail&#39;"><input ng-model="customer_communication.include_postal_mail" type="checkbox" />Include postal mails</label></div></div><div class="control-group"><label class="control-label bold">Subject</label><div class="controls"><input ng-model="customer_communication.subject" style="width: 90%" type="text" /></div></div><div class="control-group"><label class="control-label bold">Message</label><div class="controls"><span ad-vehicle-visual-button="true" ng-model="customer_communication.message"></span><textarea ng-model="customer_communication.message" rows="5" style="width: 90%"></textarea></div></div><div>Note: anything inside %{...} will be replaced by real value<br />Eg. %{vehicle_title} to become \'Honda Prelude\'</div></form><div><button class="btn btn-danger" ng-click="send_reminder()">Send Reminder</button><button class="btn" ng-click="cancel_reminder()">Cancel</button><div class="spinner" id="send-reminder-spinner"></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_customer_communications.html",'<div class="content-box" id="customer-communications"><div class="sub-header">Service Reminders\' statuses</div><div ng-show="customer_communications.length == 0"><span>Has not been sent</span></div><div ng-show="customer_communications.length &gt; 0"><table class="table table-striped"><thead><tr><th ng-show="show_type">Communication</th><th>Sent at</th><th>Total sent</th><th></th></tr></thead><tbody><tr ng-repeat="customer_communication in customer_communications"><td ng-show="show_type">{{customer_communication.type_name}}</td><td><span ng-show="customer_communication.status == &#39;processed&#39;"><i class="icon-ok"></i>{{customer_communication.finished_time | date: \'mediumDate\'}}</span><span ng-show="customer_communication.status == &#39;sending&#39;"><i class="icon-refresh"></i>{{customer_communication.status}}</span><span ng-show="customer_communication.status == &#39;scheduled&#39;"><i class="icon-time"></i>{{customer_communication.status}}</span></td><td>{{customer_communication.total}}/{{customer_communication.estimate_total}}</td><td class="action"><a ng-click="show(customer_communication)">Open</a></td></tr></tbody></table><div id="showing-customer-communication-popover"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="row-fluid"><div class="page-header">{{showing_customer_communication.type_name}} &nbsp;<span class="label label-info" ng-show="showing_customer_communication.status != &#39;processed&#39;">{{showing_customer_communication.status}}</span><span class="label label-success" ng-show="showing_customer_communication.status == &#39;processed&#39;">{{showing_customer_communication.status}}</span><div class="pull-right"><i class="icon icon-remove goto" ng-click="close()"></i></div></div></div></div><div class="popover-content"><div class="content-box"><div class="sub-header">Details</div><div class="spinner" id="loading-customer-communication-spinner"></div><div class="pull-right"><div class="info" ng-show="showing_customer_communication.status == &#39;processed&#39; || showing_customer_communication.status == &#39;sending&#39;"><label class="label-name">Start:</label><span>{{showing_customer_communication.start_time|date:\'short\'}}</span></div><div class="info" ng-show="showing_customer_communication.status == &#39;processed&#39;"><label class="label-name">Finished:</label><span>{{showing_customer_communication.finished_time|date:\'short\'}}</span></div><div class="info" ng-hide="showing_customer_communication.status == &#39;processed&#39;"><label class="label-name">Status:</label><span>{{showing_customer_communication.status}}</span></div><div class="info"><label class="label-name">Estimate Total:</label><span>{{showing_customer_communication.estimate_total}}</span></div><div class="info"><label class="label-name">Total Sent:</label><span>{{showing_customer_communication.total}}</span></div></div><div class="info"><label class="label-name">Created At:</label><span>{{showing_customer_communication.created_at|date:\'short\'}}</span></div><div class="info"><label class="label-name">Sent By:</label><span>{{showing_customer_communication.communication_methods}}</span></div><div class="info"><label class="label-name">Service Over Due:</label><span>{{showing_customer_communication.over_due_days}} days ago</span></div><div class="info"><label class="label-name">Last Reminder:</label><span>{{showing_customer_communication.last_reminder_days}} days ago</span></div><br /><br /><div class="row-fluid"><div class="sub-header">Message</div><pre>{{showing_customer_communication.communication_template.message}}</pre></div></div><div class="content-box"><div class="sub-header">Receivers ({{showing_customer_communication.successful_vehicles.length}}) &nbsp;<a ng-click="show_receivers()" ng-hide="showing_receivers">Show</a><a ng-click="hide_receivers()" ng-show="showing_receivers">Hide</a></div><table class="table table-striped" ng-show="showing_receivers"><thead><tr><th>{{asset_name()}}</th><th>Customer</th></tr></thead><tbody><tr ng-repeat="vehicle in showing_customer_communication.successful_vehicles"><td>{{vehicle.title}}</td><td>{{vehicle.customer.name}}</td></tr></tbody></table></div><div ng-show="showing_customer_communication.uncommunicated_attempts.length &gt; 0"><div class="content-box"><div class="sub-header">Failed to send ({{showing_customer_communication.uncommunicated_attempts.length}}) &nbsp;<a ng-click="show_uncommunicated_attempts()" ng-hide="showing_uncommunicated_attempts">Show</a><a ng-click="hide_uncommunicated_attempts()" ng-show="showing_uncommunicated_attempts">Hide</a></div><table class="table table-striped" ng-show="showing_uncommunicated_attempts"><thead><tr><th>{{asset_name()}}</th><th>Customer</th><th>Reason</th></tr></thead><tbody><tr ng-repeat="uncommunicated_attempt in showing_customer_communication.uncommunicated_attempts"><td>{{uncommunicated_attempt.vehicle.title}}</td><td>{{uncommunicated_attempt.vehicle.customer.name}}</td><td>{{uncommunicated_attempt.reason}}</td></tr></tbody></table></div></div><br /><button class="btn" ng-click="close()">Close</button></div></div><pagination boundary-links="true" current-page="page" max-size="5" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_customer_form.html",'<form class="form-horizontal" novalidate="true"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input ng-model="customer.name" ng-readonly="!allowRename" type="text" /><label class="checkbox"><input ng-model="customer.is_company" type="checkbox" /><span>Is Company</span></label><label class="checkbox"><input ng-model="customer.is_insurer" type="checkbox" /><span>Is 3rd Party</span><div>(Insurance Company, Co-operative group etc...)</div></label></div></div><div class="control-group" ng-show="country() == &#39;au&#39;"><label class="control-label">ABN</label><div class="controls"><input ng-model="customer.abn" type="text" /></div></div><div class="control-group" ng-show="country() != &#39;au&#39;"><label class="control-label">{{tax_registration_name()}}</label><div class="controls"><input ng-model="customer.tax_registration_number" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input ng-model="customer.email" type="text" /></div></div><div class="control-group"><label class="control-label">Mobile</label><div class="controls"><input ng-model="customer.mobile" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="customer.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Fax</label><div class="controls"><input ng-model="customer.fax" type="text" /></div></div><addresspicker ng-model="customer.address"></addresspicker><div class="control-group" ng-hide="customer.street_address"><label class="control-label"></label><div class="controls"><button class="btn btn-link" ng-click="add_street_address()">Add Street Address</button><br /><br /></div></div><div ng-show="customer.street_address"><addresspicker address-label="Street Address" ng-model="customer.street_address"></addresspicker></div><div class="control-group"><label class="control-label">Contact Person</label><div class="controls"><input ng-model="customer.contact_name" type="text" /></div></div><div class="control-group"><label class="control-label">Price Level</label><div class="controls"><select ng-model="customer.price_level" ng-options="price_level.value as price_level.name for price_level in price_levels()" type="text"></select></div></div><div class="control-group"><label class="control-label">Payment Term</label><div class="controls"><select ng-model="customer.payment_term" ng-options="payment_term.value as payment_term.name for payment_term in payment_terms" type="text"></select></div></div><div class="control-group"><label class="control-label">Discount</label><div class="controls"><div class="input-append"><input class="input-mini" ng-model="customer.discount_percentage" type="text" /><span class="add-on">%</span></div></div></div><div class="control-group"><label class="control-label">Source Of Business</label><div class="controls"><div businesssourcepicker="true" ng-model="customer.business_source_id"></div></div></div><div class="control-group" ng-hide="customer.is_insurer"><label class="control-label">Invoice To Third Party</label><div class="controls"><select ng-model="customer.insurer_id" ng-options="s.id as s.name for s in insurers"><option value=""></option></select></div></div><div class="control-group" ng-hide="customer.is_insurer || !customer.insurer_id"><label class="control-label">Third Party Account Number</label><div class="controls"><input ng-model="customer.third_party_account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Credit Limit</label><div class="controls"><input ng-model="customer.credit_limit" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Special Account Number</label><div class="controls"><input ng-model="customer.special_account_number" step="any" type="text" /></div></div><div class="control-group"><label class="control-label">Special Payment Instruction</label><div class="controls"><div ng-hide="customer.payment_instruction || customer.show_payment_instruction"><div>Use this only if you have special payment instruction for this customer</div><a href="javascript:void(0);" ng-click="customer.show_payment_instruction=true">Set Payment Instruction</a></div><div ng-show="customer.payment_instruction || customer.show_payment_instruction"><textarea ng-model="customer.payment_instruction"></textarea></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox"><input ng-model="customer.require_order_number" type="checkbox" />Require Order Number</label></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox"><input ng-model="customer.no_rounding" type="checkbox" />Disable Rounding On invoice(if applied)</label></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox"><input ng-model="customer.disable_booking_reminder" type="checkbox" />Disable Booking Reminder</label></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox"><input ng-model="customer.disable_service_reminder" type="checkbox" />Disable Service Reminder</label></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox"><input ng-model="customer.unsubscribed" type="checkbox" />Disable Marketing Email/SMS</label></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox"><input ng-model="customer.send_communications_to_driver" type="checkbox" />Send Communications To Driver</label></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save()">Save</button><button class="btn" ng-click="cancel()">Cancel</button><div class="spinner" id="saving-customer-spinner"></div></div></div></form>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_customer_vehicle_form.html",'<div class="sub-header">{{asset_name()}} Owner</div><div class="control-group"><label class="control-label"></label><div class="controls"><div ad-contact-name-warning="true" ng-model="customer" resource="customer"></div><div class="unselect" ng-show="selection.customer"><button class="btn btn-primary" id="change-customer-button" ng-click="unselect_customer()" type="button">Change Customer</button><button class="btn btn-success" id="update-customer-name-button" ng-click="edit_customer()" type="button">Update Customer Name</button></div></div></div><div class="control-group"><label class="control-label">Name</label><div class="controls"><div class="inline"><input autocomplete="off" id="ad-customer-vehicle-form-name" ng-change="search_recommendations()" ng-model="customer.name" ng-readonly="customer.id &amp;&amp; !customer.editing" type="text" /></div><div class="inline"><label class="checkbox" style="margin-left: 5px"><input ng-model="customer.is_company" type="checkbox" />Is Company</label></div></div></div><div class="control-group"><label class="control-label">Mobile</label><div class="controls"><input ng-change="search_recommendations()" ng-model="customer.mobile" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-change="search_recommendations()" ng-model="customer.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input ng-change="search_recommendations()" ng-model="customer.email" type="text" /></div></div><div class="control-group" ng-hide="customer.id &amp;&amp; customer.business_source"><label class="control-label">Source Of Business</label><div class="controls"><div businesssourcepicker="true" ng-model="customer.business_source_id"></div></div></div><addresspicker address-label="Postal Address" form="form" name="&#39;customer_address&#39;" ng-model="customer.address"></addresspicker><div class="control-group" ng-hide="show_more_customer_fields"><label class="control-label"></label><div class="controls"><a ng-click="show_more_customer_fields = true">More fields</a></div></div><span ng-show="show_more_customer_fields"><div class="control-group" ng-hide="customer.street_address"><label class="control-label"></label><div class="controls"><button class="btn btn-link" ng-click="add_street_address()">Add Street Address</button><br /><br /></div></div><div ng-show="customer.street_address"><addresspicker address-label="Street Address" ng-model="customer.street_address"></addresspicker></div><div class="control-group"><label class="control-label">Fax</label><div class="controls"><input ng-model="customer.fax" type="text" /></div></div><div class="control-group"><label class="control-label">Contact Person</label><div class="controls"><input ng-model="customer.contact_name" type="text" /></div></div><div class="control-group"><label class="control-label">Price Level</label><div class="controls"><select ng-model="customer.price_level" ng-options="price_level.value as price_level.name for price_level in price_levels()" type="text"></select></div></div><div class="control-group"><label class="control-label">Payment Term</label><div class="controls"><select ng-model="customer.payment_term" ng-options="payment_term.value as payment_term.name for payment_term in payment_terms" type="text"></select></div></div><div class="control-group"><label class="control-label">Default Discount</label><div class="controls"><div class="input-append"><input class="input-mini" ng-model="customer.discount_percentage" type="text" /><span class="add-on">%</span></div></div></div></span><div class="sub-header">{{asset_name()}}</div><div class="control-group"><label class="control-label"></label><div class="controls"><div ad-existing-vehicle-warning="true" ng-model="vehicle"></div><div class="unselect" ng-show="selection.vehicle"><button class="btn btn-primary" ng-click="unselect_vehicle()" type="button">Change {{asset_name()}}</button></div></div></div><div class="control-group" ng-show="asset_property_set().asset_type"><label class="control-label">Type</label><div class="controls"><input class="input" ng-model="vehicle.asset_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().boat_name"><label class="control-label">Boat Name</label><div class="controls"><input ng-model="vehicle.boat_name" type="text" /></div></div><div ng-hide="asset_property_set().model"><div class="control-group" ng-show="asset_property_set().engine_brand"><label class="control-label">Engine Brand</label><div class="controls"><input ng-model="vehicle.engine_brand" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_model"><label class="control-label">Engine Model</label><div class="controls"><input ng-model="vehicle.engine_model" type="text" /></div></div></div><div class="control-group" ng-show="asset_property_set().registration_number"><label class="control-label">Registration Number</label><div class="controls"><input class="registration-number-input" ng-change="search_recommendations()" ng-model="vehicle.registration_number" type="text" /><div class="inline">&nbsp;</div><div ad-vehicle-look-up-button="true" class="inline" ng-model="vehicle"></div></div></div><div class="control-group" ng-show="asset_property_set().serial_number"><label class="control-label">Serial Number</label><div class="controls"><input class="vin-input" ng-model="vehicle.serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().fleet_number"><label class="control-label">Fleet Number</label><div class="controls"><input ng-change="search_recommendations()" ng-model="vehicle.fleet_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().driver_name"><label class="control-label">Driver Name</label><div class="controls"><input ng-model="vehicle.driver_name" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().driver_phone"><label class="control-label">Driver Phone</label><div class="controls"><input ng-model="vehicle.driver_phone" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().driver_email"><label class="control-label">Driver Email</label><div class="controls"><input ng-model="vehicle.driver_email" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().make"><label class="control-label">Make</label><div class="controls"><input id="ad-customer-vehicle-form-make" ng-change="update_models()" ng-model="vehicle.make" ng-model-on-blur="" type="text" typeahead="vm.make as vm.make for vm in makes | filter: {make: $viewValue}" typeahead-on-select="update_models()" typeahead-wait-ms="500" /></div></div><div class="control-group" ng-show="asset_property_set().series"><label class="control-label">Series</label><div class="controls"><input ng-model="vehicle.series" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().model"><label class="control-label">Model</label><div class="controls"><input ng-model="vehicle.model" type="text" typeahead="vm.model as vm.model for vm in vehicle_models | filter: {model: $viewValue}" typeahead-wait-ms="500" /></div></div><div class="control-group" ng-show="asset_property_set().year"><label class="control-label">Year</label><div class="controls"><input class="input-mini" ng-model="vehicle.year" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().model_code"><label class="control-label">Model Code</label><div class="controls"><input ng-model="vehicle.model_code" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().vin"><label class="control-label">VIN</label><div class="controls"><input class="vin-input" ng-change="search_recommendations()" ng-model="vehicle.vin" type="text" /><div class="inline">&nbsp;</div><div ad-vehicle-look-up-button="true" class="inline" ng-model="vehicle"></div></div></div><div class="control-group" ng-show="asset_property_set().color"><label class="control-label">Color</label><div class="controls"><input ng-model="vehicle.color" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().size"><label class="control-label">Size</label><div class="controls"><input ng-model="vehicle.size" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().body"><label class="control-label">Body Type</label><div class="controls"><input ng-model="vehicle.body" type="text" typeahead="body as body for body in vehicle_body_types | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().location"><label class="control-label">Location</label><div class="controls"><input ng-model="vehicle.location" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().key_location"><label class="control-label">Key Location</label><div class="controls"><input ng-model="vehicle.key_location" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().service_interval"><label class="control-label">Service Interval</label><div class="controls"><input class="input" ng-model="vehicle.service_interval" type="text" /></div></div><div class="control-group" ng-hide="show_more_vehicle_fields"><label class="control-label"></label><div class="controls"><a ng-click="show_more_vehicle_fields = true">More fields</a></div></div><div ng-show="show_more_vehicle_fields"><div class="control-group" ng-show="asset_property_set().color_code"><label class="control-label">Color Code</label><div class="controls"><input ng-model="vehicle.color_code" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().seats"><label class="control-label">Seats</label><div class="controls"><input ng-model="vehicle.seats" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().doors"><label class="control-label">Doors</label><div class="controls"><input ng-model="vehicle.doors" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().compliance_plate_date"><label class="control-label">Compliance Plate Date</label><div class="controls"><div ad-datepicker="true" ng-model="vehicle.compliance_plate_date"></div></div></div><div class="control-group" ng-show="asset_property_set().purchase_date"><label class="control-label">Purchase Date</label><div class="controls"><div ad-datepicker="true" ng-model="vehicle.purchase_date"></div></div></div><div class="control-group" ng-show="asset_property_set().warranty_expiry_date"><label class="control-label">Warranty Expiry Date</label><div class="controls"><div ad-datepicker="true" ng-model="vehicle.warranty_expiry_date"></div></div></div><div class="control-group" ng-show="asset_property_set().registration_date"><label class="control-label">Registration Date</label><div class="controls"><div ad-datepicker="true" ng-model="vehicle.registration_date"></div></div></div><div class="control-group" ng-show="asset_property_set().registration_due_date"><label class="control-label">Registration Due Date</label><div class="controls"><div ad-datepicker="true" ng-model="vehicle.registration_due_date"></div></div></div><div class="control-group" ng-show="asset_property_set().registration_billing_number"><label class="control-label">Registration Billing Number</label><div class="controls"><input ng-model="vehicle.registration_billing_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().transmission"><label class="control-label">Transmission Type</label><div class="controls"><input ng-model="vehicle.transmission" type="text" typeahead="t as t for t in vehicle_transmission_types | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().drive_type"><label class="control-label">Drive Type</label><div class="controls"><input ng-model="vehicle.drive_type" type="text" typeahead="dt as dt for dt in vehicle_drive_types | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().gears"><label class="control-label">Gears</label><div class="controls"><input class="vin-input" ng-model="vehicle.gears" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().cylinders"><label class="control-label">Cylinders</label><div class="controls"><input class="vin-input" ng-model="vehicle.cylinders" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().chassis_number"><label class="control-label">Chassis Number</label><div class="controls"><input class="vin-input" ng-model="vehicle.chassis_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().serial_number"><label class="control-label">Serial Number</label><div class="controls"><input class="vin-input" ng-model="vehicle.serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().product_number"><label class="control-label">Product Number</label><div class="controls"><input class="vin-input" ng-model="vehicle.product_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().warrant"><label class="control-label">Warrant</label><div class="controls"><input class="vin-input" ng-model="vehicle.warrant" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().battery"><label class="control-label">Battery</label><div class="controls"><input class="vin-input" ng-model="vehicle.battery" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().fan_belt"><label class="control-label">Fan Belt</label><div class="controls"><input class="vin-input" ng-model="vehicle.fan_belt" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().aircon_belt"><label class="control-label">Aircon Belt</label><div class="controls"><input class="vin-input" ng-model="vehicle.aircon_belt" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().airbag_type"><label class="control-label">Airbag Type</label><div class="controls"><input class="vin-input" ng-model="vehicle.airbag_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().odometer_unit"><label class="control-label">Odometer Unit</label><div class="controls"><select ng-model="vehicle.odometer_unit" ng-options="ou as ou for ou in odometer_units" type="text"></select></div></div><div ng-show="asset_property_set().model"><div class="control-group" ng-show="asset_property_set().engine_brand"><label class="control-label">Engine Brand</label><div class="controls"><input ng-model="vehicle.engine_brand" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_model"><label class="control-label">Engine Model</label><div class="controls"><input ng-model="vehicle.engine_model" type="text" /></div></div></div><div class="control-group" ng-show="asset_property_set().engine_year"><label class="control-label">Engine Year</label><div class="controls"><input ng-model="vehicle.engine_year" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_number"><label class="control-label">Engine Number</label><div class="controls"><input ng-model="vehicle.engine_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().injector_pump_number"><label class="control-label">Injector/Pump Number</label><div class="controls"><input ng-model="vehicle.injector_pump_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_type"><label class="control-label">Engine Type</label><div class="controls"><input ng-model="vehicle.engine_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_size"><label class="control-label">Engine Size</label><div class="controls"><input ng-model="vehicle.engine_size" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().horsepower"><label class="control-label">Horsepower</label><div class="controls"><input ng-model="vehicle.horsepower" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_data_dot"><label class="control-label">Engine Data Dot</label><div class="controls"><input ng-model="vehicle.engine_data_dot" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_oil_type"><label class="control-label">Engine Oil Type</label><div class="controls"><input ng-model="vehicle.engine_oil_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_oil_quantity"><label class="control-label">Engine Oil Quantity</label><div class="controls"><input ng-model="vehicle.engine_oil_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().power_steering_oil_type"><label class="control-label">Power Steering Oil Type</label><div class="controls"><input ng-model="vehicle.power_steering_oil_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().power_steering_oil_quantity"><label class="control-label">Power Steering Oil Quantity</label><div class="controls"><input ng-model="vehicle.power_steering_oil_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().spark_plug"><label class="control-label">Spark Plug</label><div class="controls"><input ng-model="vehicle.spark_plug" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().transmission_oil_type"><label class="control-label">Transmission Oil Type</label><div class="controls"><input ng-model="vehicle.transmission_oil_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().transmission_oil_quantity"><label class="control-label">Transmission Oil Quantity</label><div class="controls"><input ng-model="vehicle.transmission_oil_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().transfer_case_oil_type"><label class="control-label">Transfer Case Oil Type</label><div class="controls"><input ng-model="vehicle.transfer_case_oil_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().transfer_case_oil_quantity"><label class="control-label">Transfer Case Oil Quantity</label><div class="controls"><input ng-model="vehicle.transfer_case_oil_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().front_differential_type"><label class="control-label">Front Differential Type</label><div class="controls"><input ng-model="vehicle.front_differential_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().front_differential_quantity"><label class="control-label">Front Differential Quantity</label><div class="controls"><input ng-model="vehicle.front_differential_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().rear_differential_type"><label class="control-label">Rear Differential Type</label><div class="controls"><input ng-model="vehicle.rear_differential_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().rear_differential_quantity"><label class="control-label">Rear Differential Quantity</label><div class="controls"><input ng-model="vehicle.rear_differential_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().coolant_type"><label class="control-label">Coolant Type</label><div class="controls"><input ng-model="vehicle.coolant_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().coolant_quantity"><label class="control-label">Coolant Quantity</label><div class="controls"><input ng-model="vehicle.coolant_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().differential_type"><label class="control-label">Differential Type</label><div class="controls"><input ng-model="vehicle.differential_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().fuel_type"><label class="control-label">Fuel Type</label><div class="controls"><input ng-model="vehicle.fuel_type" type="text" typeahead="ft as ft for ft in fuel_types | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().fuel_tank_expiry_date"><label class="control-label">Fuel Tank Expiry Date</label><div class="controls"><div ad-datepicker="true" ng-model="vehicle.fuel_tank_expiry_date"></div></div></div><div class="control-group" ng-show="asset_property_set().exhaust_system"><label class="control-label">Exhaust System</label><div class="controls"><input ng-model="vehicle.exhaust_system" type="text" typeahead="es as es for es in exhaust_systems | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().exhaust_header"><label class="control-label">Exhaust Header</label><div class="controls"><input ng-model="vehicle.exhaust_header" type="text" typeahead="eh as eh for eh in exhaust_headers | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().air_intake_system"><label class="control-label">Air Intake</label><div class="controls"><input ng-model="vehicle.air_intake_system" type="text" typeahead="ai as ai for ai in air_intakes | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().air_filter"><label class="control-label">Air Filter</label><div class="controls"><input ng-model="vehicle.air_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().air_dryer_filter"><label class="control-label">Air Dryer Filter</label><div class="controls"><input ng-model="vehicle.air_dryer_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().oil_filter"><label class="control-label">Oil Filter</label><div class="controls"><input ng-model="vehicle.oil_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().oil_filter_element"><label class="control-label">Oil Filter Element</label><div class="controls"><input ng-model="vehicle.oil_filter_element" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().fuel_filter"><label class="control-label">Fuel Filter</label><div class="controls"><input ng-model="vehicle.fuel_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().transmission_filter"><label class="control-label">Transmission Filter</label><div class="controls"><input ng-model="vehicle.transmission_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().hydraulic_filter"><label class="control-label">Hydraulic Filter</label><div class="controls"><input ng-model="vehicle.hydraulic_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().pollen_filter"><label class="control-label">Pollen Filter</label><div class="controls"><input ng-model="vehicle.pollen_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().screen_code"><label class="control-label">Screen Code</label><div class="controls"><input ng-model="vehicle.screen_code" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().tyre_size"><label class="control-label">Tyre Size</label><div class="controls"><input ng-model="vehicle.tyre_size" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().radio_code"><label class="control-label">Radio Code</label><div class="controls"><input ng-model="vehicle.radio_code" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().window_tinted"><label class="control-label">Window Tinted?</label><div class="controls"><input ng-model="vehicle.window_tinted" type="checkbox" /></div></div><div class="control-group" ng-show="asset_property_set().key_number"><label class="control-label">Key Number</label><div class="controls"><input ng-model="vehicle.key_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().air_conditioning"><label class="control-label">Air Conditioning</label><div class="controls"><input ng-model="vehicle.air_conditioning" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().obd_location"><label class="control-label">OBD Location</label><div class="controls"><input ng-model="vehicle.obd_location" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().groupset"><label class="control-label">Groupset</label><div class="controls"><input ng-model="vehicle.groupset" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().wheels"><label class="control-label">Wheels</label><div class="controls"><input ng-model="vehicle.wheels" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().weight"><label class="control-label">Weight</label><div class="controls"><input ng-model="vehicle.weight" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().seat_height"><label class="control-label">Seat Height</label><div class="controls"><input ng-model="vehicle.seat_height" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().bar_height"><label class="control-label">Bar Height</label><div class="controls"><input ng-model="vehicle.bar_height" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().reach"><label class="control-label">Reach</label><div class="controls"><input ng-model="vehicle.reach" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().stem_length"><label class="control-label">Stem Length</label><div class="controls"><input ng-model="vehicle.stem_length" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().crank_length"><label class="control-label">Crank Length</label><div class="controls"><input ng-model="vehicle.crank_length" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().handlebar_width"><label class="control-label">Handlebar Width</label><div class="controls"><input ng-model="vehicle.handlebar_width" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().chain_rings"><label class="control-label">Chain Rings</label><div class="controls"><input ng-model="vehicle.chain_rings" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().trailer_brand"><label class="control-label">Trailer Brand</label><div class="controls"><input ng-model="vehicle.trailer_brand" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().trailer_model"><label class="control-label">Trailer Model</label><div class="controls"><input ng-model="vehicle.trailer_model" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().trailer_year"><label class="control-label">Trailer Year</label><div class="controls"><input ng-model="vehicle.trailer_year" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().trailer_serial_number"><label class="control-label">Trailer S/N</label><div class="controls"><input ng-model="vehicle.trailer_serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().starboard_serial_number"><label class="control-label">Starboard Serial Number</label><div class="controls"><input ng-model="vehicle.starboard_serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().port_serial_number"><label class="control-label">Port Serial Number</label><div class="controls"><input ng-model="vehicle.port_serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().drive_brand"><label class="control-label">Drive Brand</label><div class="controls"><input ng-model="vehicle.drive_brand" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().drive_model"><label class="control-label">Drive Model</label><div class="controls"><input ng-model="vehicle.drive_model" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().inboard_motor"><label class="control-label">Inboard Motor</label><div class="controls"><textarea auto-rows="3" ng-model="vehicle.inboard_motor" rows="6" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().outboard_motor"><label class="control-label">Outboard Motor</label><div class="controls"><textarea auto-rows="3" ng-model="vehicle.outboard_motor" rows="6" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().generator"><label class="control-label">Generator</label><div class="controls"><textarea auto-rows="3" ng-model="vehicle.generator" rows="6" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().impeller"><label class="control-label">Impeller</label><div class="controls"><textarea auto-rows="3" ng-model="vehicle.impeller" rows="6" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().dive_cylinder"><label class="control-label">Dive Cylinder</label><div class="controls"><textarea auto-rows="3" ng-model="vehicle.dive_cylinder" rows="6" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().hire_equipment"><label class="control-label">Hire Equipment</label><div class="controls"><textarea auto-rows="3" ng-model="vehicle.hire_equipment" rows="6" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().dive_certification"><label class="control-label">Dive Certification</label><div class="controls"><textarea auto-rows="3" ng-model="vehicle.dive_certification" rows="6" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().bcd"><label class="control-label">BCD</label><div class="controls"><textarea auto-rows="3" ng-model="vehicle.bcd" rows="6" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().regulator"><label class="control-label">Regulator</label><div class="controls"><textarea auto-rows="3" ng-model="vehicle.regulator" rows="6" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().gvm"><label class="control-label">GVM</label><div class="controls"><input ng-model="vehicle.gvm" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().gcm"><label class="control-label">GCM</label><div class="controls"><input ng-model="vehicle.gcm" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().tare_weight"><label class="control-label">Tare Weight</label><div class="controls"><input ng-model="vehicle.tare_weight" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().axle_code"><label class="control-label">Axle Code</label><div class="controls"><input ng-model="vehicle.axle_code" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().sleeper_air_serial_number"><label class="control-label">Sleeper Air SN</label><div class="controls"><input ng-model="vehicle.sleeper_air_serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().sleeper_air_engine_serial_number"><label class="control-label">Sleeper Air Engine SN</label><div class="controls"><input ng-model="vehicle.sleeper_air_engine_serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().sleeper_air_ecm_serial_number"><label class="control-label">Sleeper Air ECM SN</label><div class="controls"><input ng-model="vehicle.sleeper_air_ecm_serial_number" type="text" /></div></div><div class="control-group" ng-repeat="custom_attribute in asset_property_set().custom_attributes"><label class="control-label">{{custom_attribute.name}}</label><div class="controls"><input ng-model="vehicle[custom_attribute.id]" type="text" /></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_customer_vehicle_recommendations.html",'<div class="spinner" id="recommendation-spinner"></div><div class="page-header" id="recommendation-header">Recommendations that match your inputs</div><ul class="recommendations"><li ng-class="{selected: customer == selection.customer}" ng-repeat="customer in recommendations"><div class="customer" ng-click="select_customer(customer)"><div class="title"><span class="customer-name"><i class="icon-user"></i><span>{{customer.name}}</span><div ad-tag-icons="true" class="inline" owner="customer" style="margin-left: 15px"></div><div class="inline" ng-hide="hide_customer_balance()"><span ng-class="{red: customer.balance &gt; 0, green: customer.balance &lt; 0}">&nbsp; Bal.: {{customer.balance|currency}}</span></div><div class="red" ng-show="customer.credit_limit &gt; 0 &amp;&amp; customer.balance + 100 &gt; customer.credit_limit">Alert! Balance is approaching or has exceeded the credit limit of {{customer.credit_limit|currency}} </div></span><div class="pull-right"><div ng-show="customer.phone"><i class="icon-phone"></i><span>{{customer.phone}}</span></div><div ng-show="customer.mobile"><i class="icon-mobile-phone" style="font-size: 150%"></i><span>{{customer.mobile}}</span></div></div></div><br /><div class="row-fluid" ng-show="customer.vehicle_count &gt; 10"><div class="pull-right"><span class="bold">{{asset_name()}}:&nbsp;</span><div class="input-append"><input class="input" ng-change="search_vehicles(customer)" ng-model="customer.vehicle_search_text" stop-event="click" type="text" /><span class="add-on"><i class="icon icon-search"></i></span></div></div></div><div class="row-fluid vehicle" ng-class="{selected: vehicle == selection.vehicle}" ng-click="select_vehicle(vehicle)" ng-repeat="vehicle in customer.vehicles"><span>{{vehicle.title}}</span><span ng-show="vehicle == selection.vehicle"><i class="icon-ok icon-right green"></i></span><div class="pull-right"><div ng-show="vehicle.registration_number"><span>Reg.#:</span> <span class="registration-number">{{vehicle.registration_number}}</span></div><div ng-show="vehicle.fleet_number"><span>Fleet#:</span> <span class="registration-number">{{vehicle.fleet_number}}</span></div><div ng-show="vehicle == selection.vehicle &amp;&amp; vehicle.service_note.length &gt; 0"><span class="label label-success" ng-click="open_service_book()">Service Note/TODO</span></div><div ng-click="open_service_book()" ng-show="vehicle == selection.vehicle"><i class="icon icon-book"></i><span>&nbsp;</span><span>Service Book</span></div></div></div><div class="row-fluid italic bold" ng-show="customer.vehicle_count &gt; 10"><center><span>Only 10 vehicles showing, for more please use search</span></center></div></div><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="unselect_customer()" ng-show="customer == selection.customer">Unselect</button></div></div></li></ul><div id="service-book-popover"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="row-fluid"><div class="sub-header"><span>Notes</span><div class="pull-right"><button class="btn btn-primary" ng-click="close_service_book()">Close</button></div></div></div></div><div class="popover-content"><div class="spinner" id="service-book-spinner"></div><div ad-vehicle="true" ng-model="showing_vehicle"></div><button class="btn btn-primary" ng-click="close_service_book()">Close</button></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_date_range_selection.html",'<div class="dropdown inline" style="margin-right: 25px;"><a dropdown-toggle="true"><span>Select</span></a><ul class="dropdown-menu top-dropdown new-list"><li style="width: 90%"><a href="javascript:void(0)" ng-click="select_today()"><span>Today</span></a></li><li style="width: 90%"><a href="javascript:void(0)" ng-click="select_month_to_date()"><span>Month To Date</span></a></li><li style="width: 90%"><a href="javascript:void(0)" ng-click="select_one_month_back()"><span>1 Month Back</span></a></li><li style="width: 90%"><a href="javascript:void(0)" ng-click="select_last_month()"><span>Last Month</span></a></li><li style="width: 90%"><a href="javascript:void(0)" ng-click="select_last_two_weeks()"><span>Last 2 Weeks</span></a></li></ul></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_datepicker.html",'<ng-form name="form"><div ng-show="error == &#39;top&#39;"><span class="error right" ng-show="form.date.$invalid">Please check input format dd/mm/yyyy E.g 12/12/2012</span></div><div class="input-append"><input autocomplete="off" class="input-small" datepicker-popup="dd/MM/yyyy" name="date" ng-model="model" ng-pattern="/[0123][0-9]\\/[012][0-9]\\/[1-9][0-9]{3}/" type="text"><span class="add-on"><i class="icon-calendar"></i></span></input></div><div class="inline" ng-show="error == &#39;right&#39;"><span class="error right" ng-show="form.date.$invalid">Please check input format dd/mm/yyyy E.g 12/12/2012</span></div></ng-form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_diary.html",'<div id="diary"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Diary</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form><table style="width: 100%"><thead><tr><th></th><th>Workload</th><th>Opening Hour</th><th>Closing Hour</th></tr></thead><tr><td class="text-align-right" style="vertical-align: middle; padding-right: 10px">Monday</td><td style="padding-top: 10px"><div class="input-append"><input class="input-small" name="monday" ng-model="diary.monday_workload" step="any" type="number" /><span class="add-on">Hours</span></div></td><td><div ad-timepicker="true" ng-model="diary.monday_opening_hour"></div></td><td><div ad-timepicker="true" ng-model="diary.monday_closing_hour"></div></td></tr><tr><td class="text-align-right" style="vertical-align: middle; padding-right: 10px">Tuesday</td><td style="padding-top: 10px"><div class="input-append"><input class="input-small" name="tuesday" ng-model="diary.tuesday_workload" step="any" type="number" /><span class="add-on">Hours</span></div></td><td><div ad-timepicker="true" ng-model="diary.tuesday_opening_hour"></div></td><td><div ad-timepicker="true" ng-model="diary.tuesday_closing_hour"></div></td></tr><tr><td class="text-align-right" style="vertical-align: middle; padding-right: 10px">Wednesday</td><td style="padding-top: 10px"><div class="input-append"><input class="input-small" name="wednesday" ng-model="diary.wednesday_workload" step="any" type="number" /><span class="add-on">Hours</span></div></td><td><div ad-timepicker="true" ng-model="diary.wednesday_opening_hour"></div></td><td><div ad-timepicker="true" ng-model="diary.wednesday_closing_hour"></div></td></tr><tr><td class="text-align-right" style="vertical-align: middle; padding-right: 10px">Thursday</td><td style="padding-top: 10px"><div class="input-append"><input class="input-small" name="thursday" ng-model="diary.thursday_workload" step="any" type="number" /><span class="add-on">Hours</span></div></td><td><div ad-timepicker="true" ng-model="diary.thursday_opening_hour"></div></td><td><div ad-timepicker="true" ng-model="diary.thursday_closing_hour"></div></td></tr><tr><td class="text-align-right" style="vertical-align: middle; padding-right: 10px">Friday</td><td style="padding-top: 10px"><div class="input-append"><input class="input-small" name="friday" ng-model="diary.friday_workload" step="any" type="number" /><span class="add-on">Hours</span></div></td><td><div ad-timepicker="true" ng-model="diary.friday_opening_hour"></div></td><td><div ad-timepicker="true" ng-model="diary.friday_closing_hour"></div></td></tr><tr><td class="text-align-right" style="vertical-align: middle; padding-right: 10px">Saturday</td><td style="padding-top: 10px"><div class="input-append"><input class="input-small" name="saturday" ng-model="diary.saturday_workload" step="any" type="number" /><span class="add-on">Hours</span></div></td><td><div ad-timepicker="true" ng-model="diary.saturday_opening_hour"></div></td><td><div ad-timepicker="true" ng-model="diary.saturday_closing_hour"></div></td></tr><tr><td class="text-align-right" style="vertical-align: middle; padding-right: 10px">Sunday</td><td style="padding-top: 10px"><div class="input-append"><input class="input-small" name="sunday" ng-model="diary.sunday_workload" step="any" type="number" /><span class="add-on">Hours</span></div></td><td><div ad-timepicker="true" ng-model="diary.sunday_opening_hour"></div></td><td><div ad-timepicker="true" ng-model="diary.sunday_closing_hour"></div></td></tr></table></form><center><button class="btn btn-primary" ng-click="save()">Save</button><button class="btn" ng-click="cancel()">Cancel</button></center></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_email_purchase_order.html",'<div id="email-purchase-order"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header"><span>{{title}}</span><div class="pull-right"><i class="icon icon-remove" ng-click="hide()"></i></div></div></div><div class="popover-content"><div class="content-box"><div class="spinner" id="email-purchase-spinner"></div><div class="row-fluid"><form><label>Email</label><input class="span9" id="email-input" ng-model="email" type="text" /><div class="pull-right"><div class="inline" contactpicker="true" model-type="Supplier" ng-model="purchase.supplier" on-select="select_contact(contacts)" show_email="true"></div></div><label>Message</label><textarea class="span12" id="purchase-send-email-subject" ng-model="subject" type="text"></textarea><label>Message</label><textarea class="span12" id="purchase-send-email-message" ng-model="message" type="text"></textarea><div><label class="checkbox"><input ng-model="delivery_notification_required" type="checkbox" /><span>Send me a notification on delivery</span></label></div><div><label class="checkbox"><input ng-model="attached_files" type="checkbox" /><span>Attach Files</span></label></div><div ng-show="attached_files"><table class="table table-striped"><thead></thead><tbody><tr ng-repeat="file in purchase.photos"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in purchase.documents"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr></tbody></table></div><div><button class="btn btn-success" ng-click="send_email()">Send</button><button class="btn" ng-click="hide()">Cancel</button></div></form></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_email_quote.html",'<div id="email-quote"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header"><span>{{title}}</span><div class="pull-right"><i class="icon icon-remove" ng-click="hide()"></i></div></div></div><div class="popover-content"><div class="content-box"><div class="spinner" id="email-quote-spinner"></div><div class="row-fluid"><form><label>Email</label><input class="span9" id="email-input" ng-model="email" type="text" /><div class="pull-right"><div class="inline" contactpicker="true" model-type="Customer" ng-model="customer" on-select="select_contact(contacts)" show_email="true"></div></div><label>Subject</label><input class="span12" id="quote-send-email-subject" ng-model="subject" type="text" /><label><span>Message</span><div ad-saved-texts-button="true" class="inline" ng-model="message" quote="quote"></div><div ad-vehicle-visual-button="true" class="inline" ng-model="message"></div></label> <textarea class="span12" id="quote-send-email-message" ng-model="message" rows="15" type="text"></textarea><div><label class="checkbox"><input ng-model="delivery_notification_required" type="checkbox" /><span>Send me a notification on delivery</span></label></div><div><label class="checkbox"><input ng-model="attached_files" type="checkbox" /><span>Attach Files</span></label></div><div ng-show="attached_files"><table class="table table-striped"><thead></thead><tbody><tr ng-repeat="file in quote.photos"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in job.photos"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in quote.documents"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in job.documents"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr></tbody></table></div><div><button class="btn btn-success" ng-click="send_email()">Send</button><button class="btn" ng-click="hide()">Cancel</button></div></form></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_email_statement.html",'<div id="email-statement"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header"><span>{{title}}</span><div class="pull-right"><i class="icon icon-remove" ng-click="hide()"></i></div></div></div><div class="popover-content"><div class="spinner" id="email-statement-spinner"></div><div class="content-box"><div class="row-fluid"><form><label>Email</label><input class="span12" id="email-input" ng-model="email" type="text" /><label>Subject</label> <input class="span12" id="invoice-send-email-subject" ng-model="subject" type="text" /><label>Message</label> <span ad-saved-texts-button="true" customer="customer" ng-model="message"></span><textarea class="span12" id="invoice-send-email-message" ng-model="message" rows="15" type="text"></textarea><div><button class="btn btn-success" ng-click="send_email()">Send</button><button class="btn" ng-click="hide()">Cancel</button></div></form></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_employee_tag.html",'<span ng-show="employees.length &gt; 0"><span ng-repeat="employee in employees"><span class="label" style="background-color: {{employee.color_code}}">{{employee.name}}</span><span>&nbsp;</span></span></span><span ng-hide="employees.length &gt; 0">{{empty}}</span>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_existing_vehicle_warning.html",'<div ng-show="matches.length &gt; 0 &amp;&amp; !vehicle.id"><pre class="no-style word-wrap yellow">{{message}}</pre><br /></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_ezy_parts.html",'<div class="inline" ng-show="ezy_parts_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="{{ezy_parts_button_id}}" ng-click="send(ezy_parts_account())"><img src="/assets/burson_ezy_parts-c30f833eeb9ad9ec26fdcc4747ec3dd4.png" style="height: 30px;" /></a></div><div class="inline" ng-show="autopro_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="{{autopro_button_id}}" ng-click="send(autopro_account())"><img src="/assets/autopro-53633ab840f227c7debd83dc4cab9de3.png" style="height: 30px;" /></a></div><div id="{{popover_id}}"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header">{{status}}</div></div><div class="popover-content"><div class="content-box"><div class="spinner" id="{{spinner_id}}"></div><span>{{status_message}}</span></div><div class="button-panel"><button class="btn-danger" ng-click="cancel()">Cancel</button></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_files.html",'<div class="sub-header"><div class="inline" id="photo-list">{{title}}</div><div class="pull-right" ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_files()">Upload</button></div></div><div class="files" ng-hide="uploading_files"><div class="pull-right"></div><div class="inline photo" ng-repeat="photo in owner.photos" style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><div ng-show="owner.documents.length &gt; 0"><div class="bold">Documents</div><div ng-repeat="document in owner.documents"><div class="editable" ng-click="edit_file(document)" ng-hide="document.editing"><span>{{document.file_name}} &nbsp;</span><a ng-href="{{document.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="document.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="document.editing.file_name" type="text" /></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(document)">Save</button><button class="btn" ng-click="cancel_edit_file(document)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(document)">Remove</button></div></form></div></div></div></div><div id="photo-viewer-{{viewer_id}}"><div class="popover fade right in" style="width: 800px; height: 1000px"><div class="popover-title"><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="full_size_photo()">Full Size</button><button class="btn btn-primary" ng-click="close_photo_viewer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div style="height: 750px"><carousel><slide active="photo.active" ng-repeat="photo in owner.photos"><img ng-src="{{photo.url}}" style="margin:auto; max-width: 100%; max-height:750px;" /></slide></carousel></div></div><div class="row-fluid"><center><div class="inline photo" ng-class="{&#39;photo-active&#39;: photo.active}" ng-repeat="photo in owner.photos"><div style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><button class="btn btn-danger" ng-click="remove_photo(photo)" ng-show="photo.active">Remove</button></div></center></div></div></div></div><form action="{{upload_url}}" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /></div><br /><div class="spinner inline" id="upload-photos-spinner-{{spinner_id}}"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_finish_job.html",'<div id="finish-popover"><div class="popover fade left in" style="width: 550px"><div class="popover-title"><div class="sub-header">{{job.title}}</div></div><div class="popover-content"><div class="row-fluid"><div class="spinner" id="finish-job-spinner"></div><form class="form-horizontal" name="finish_job_form" novalidate="true"><div class="content-box"><input ng-model="job.id" type="hidden" /><div class="control-group"><label class="control-label">Finished Time:</label><div class="controls"><ad-datepicker error="top" ng-model="job.finished_time"></ad-datepicker><ad-timepicker error="top" ng-model="job.finished_time"></ad-timepicker></div></div><control-group></control-group><div class="control-group" ng-show="show_odometer()"><label class="control-label">Current Odometer:</label><div class="controls"><div class="input-append"><input class="input-small" name="odometer" ng-model="job.odometer" type="number" /><span class="add-on">{{job.vehicle.odometer_unit}}</span></div><span class="error right" ng-show="finish_job_form.odometer.$invalid">odometer reading must be a number</span></div></div><div class="control-group" ng-show="show_hubodometer()"><label class="control-label">Hubodometer:</label><div class="controls"><div class="input-append"><input class="input-small" name="hubodometer" ng-model="job.hubodometer" type="number" /><span class="add-on">{{job.vehicle.odometer_unit}}</span></div><span class="error right" ng-show="finish_job_form.hubodometer.$invalid">hubodometer must be a number</span></div></div><div class="control-group" ng-show="show_machine_hours()"><label class="control-label">Current Machine Hours:</label><div class="controls"><div class="input-append"><input class="input-small" name="machine_hours" ng-model="job.machine_hours" type="number" /><span class="add-on">Hr(s)</span></div><span class="error right" ng-show="finish_job_form.machine_hours.$invalid">Machine hours reading must be a number</span></div></div><div class="control-group" ng-show="show_engine_hours()"><label class="control-label">Current Engine Hours:</label><div class="controls"><div class="input-append"><input class="input-small" name="engine_hours" ng-model="job.engine_hours" type="number" /><span class="add-on">Hr(s)</span></div><span class="error right" ng-show="finish_job_form.engine_hours.$invalid">Engine hours reading must be a number</span></div></div><div class="control-group" ng-show="show_port_engine_hours()"><label class="control-label">Current Port Engine Hours:</label><div class="controls"><div class="input-append"><input class="input-small" name="port_engine_hours" ng-model="job.port_engine_hours" type="number" /><span class="add-on">Hr(s)</span></div><span class="error right" ng-show="finish_job_form.port_engine_hours.$invalid">Engine hours reading must be a number</span></div></div><div class="control-group" ng-show="show_starboard_engine_hours()"><label class="control-label">Current Starboard Engine Hours:</label><div class="controls"><div class="input-append"><input class="input-small" name="starboard_engine_hours" ng-model="job.starboard_engine_hours" type="number" /><span class="add-on">Hr(s)</span></div><span class="error right" ng-show="finish_job_form.starboard_engine_hours.$invalid">Engine hours reading must be a number</span></div></div><div class="control-group" ng-show="show_next_service()"><label class="control-label">Next Service:</label><div class="controls"><ad-datepicker ng-model="job.next_service_date"></ad-datepicker></div></div><div class="control-group" ng-show="show_registration_due_date()"><label class="control-label">Registration Due:</label><div class="controls"><ad-datepicker ng-model="job.registration_due_date"></ad-datepicker></div></div><div class="control-group" ng-show="show_wof()"><label class="control-label">{{wof_name()}} Due Date:</label><div class="controls"><ad-datepicker ng-model="job.wof_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Communications</label><div class="controls"><div ng-show="job.contact_mobile"><label class="checkbox"><input class="checkbox" ng-model="communications.sms" type="checkbox">Send SMS</input><button class="btn btn-link" ng-show="sms_preview" popover="{{sms_preview.message}}" popover-placement="right" popover-trigger="mouseenter">Preview</button></label></div><div ng-hide="job.contact_mobile">Cannot contact by sms: customer\'s mobile number is not available</div><div ng-show="job.contact_email"><label class="checkbox"><input class="checkbox" ng-model="communications.email" type="checkbox">Send Email</input><button class="btn btn-link" ng-show="email_preview" popover="{{email_preview.message}}" popover-placement="right" popover-title="{{email_preview.subject}}" popover-trigger="mouseenter">Preview</button></label></div><div ng-hide="job.contact_email">Cannot contact by email: customer\'s email address is not available</div></div></div><div class="control-group" ng-show="show_next_service()"><label class="control-label"><div>Next Service Note:</div><div ng-show="service_note"><a href="javascript:void(0);" ng-click="clear_service_note()">Clear</a></div></label><div class="controls" style="padding-top: 5px"><a ng-click="add_service_note()" ng-hide="service_note">Add Next Service Note</a><textarea class="span12 maintenance-entry" id="finish-job-service-note" ng-model="job.service_note" ng-show="service_note"></textarea></div></div><div class="control-group"><label class="control-label">Follow Up:</label><div class="controls" style="padding-top: 5px"><a ng-click="add_follow_up()" ng-hide="follow_up">Add Follow up</a><div ng-show="follow_up"><div><label class="label-name-left inline" style="vertical-align: middle">Date</label><div ad-datepicker="true" class="inline" ng-model="follow_up.date"></div><div class="pull-right"><button class="btn btn-link" ng-click="cancel_follow_up()"><i class="icon icon-remove red"></i><span>Cancel</span></button></div></div><div><label class="label-name-left inline" style="vertical-align: bottom">Delivery Method:</label></div><div style="margin-left: 20px"><label class="radio"><input name="follow_up_delivery_method" ng-model="follow_up.delivery_method" type="radio" value="sms" /><span>SMS</span></label><label class="radio"><input name="follow_up_delivery_method" ng-model="follow_up.delivery_method" type="radio" value="email" /><span>Email</span></label></div><div><span>Message:</span><div ad-saved-texts-button="true" class="inline" customer="customer" job="job" ng-model="follow_up.message" vehicle="vehicle"></div><div ad-vehicle-visual-button="true" class="inline" ng-model="follow_up.message"></div><textarea class="span12 maintenance-entry" ng-model="follow_up.message"></textarea></div></div></div></div><div ng-hide="job.invoice.id"><hr /><div class="bold">There is no invoice for this job?</div><br /><label class="radio"><input checked="true" name="no_invoice" type="radio" />Create Invoice</label><label class="radio"><input name="no_invoice" ng-model="job.no_invoice" type="radio" value="true" />No Invoice For This Job (Internal Job or the customer is not charged)</label></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="save()">Finish</button><button class="btn btn-success" ng-click="save(true)" ng-hide="job.invoice.paid">Finish & Pay</button><button class="btn" ng-click="hide()">Cancel</button></div></div></form></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_funds_available.html",'<div id="available-credit"><center><a href="javascript:void(0)" ng-click="show_funds()" ng-show="funds_available() &amp;&amp; invoice.unpaid_amount &gt; 0"><span>Credit available, Allocate</span></a></center></div><div id="available-credit-popover"><div class="popover fade left in" style="width: 550px"><div class="popover-title"><div class="sub-header">Credit Allocation</div></div><div class="popover-content"><div class="content-box"><div class="sub-header">Available funds</div><div class="container-fluid"><div class="row-fluid"><div class="column span3 bold"><div>Number</div></div><div class="column span3 bold"><div>Date</div></div><div class="column span3 bold"><div>Amount</div></div><div class="column span3 bold"><div>Allocate</div></div></div><div class="row-fluid" ng-repeat="(id, data) in funds"><div class="column span3"><div>{{data.number}}</div></div><div class="column span3"><div>{{data.date|date}}</div></div><div class="column span3"><div>{{data.original_amount | number: 2}} </div></div><div class="column span3"><input class="input-small text-align-right" ng-model="data.allocated_amount" step="any" type="number" /></div></div><br /><div class="row-fluid"><div class="column span3"></div><div class="column span3"></div><div class="column span3 bold"><div>SELECTED</div><div>BALANCE DUE</div></div><div class="column span3"><div class="bold text-align-right" ng-show="total_allocated_funds() &lt; invoice.unpaid_amount" style="color: orange; font-size: 15px;">{{total_allocated_funds() | number: 2}}</div><div class="bold text-align-right" ng-show="total_allocated_funds() == invoice.unpaid_amount" style="color: green; font-size: 15px;">{{total_allocated_funds() | number: 2}}</div><div class="bold text-align-right" ng-show="total_allocated_funds() &gt; invoice.unpaid_amount" style="color: red; font-size: 15px;">{{total_allocated_funds() | number: 2}}</div><div class="bold text-align-right" style="font-size: 15px;">{{balance_due() | number: 2}}</div></div></div></div></div><br /><div class="row-fluid"><center><div class="buttons"><button class="btn btn-primary" ng-click="allocate()" ng-show="total_allocated_funds() &gt; 0">Allocate</button><button class="btn" ng-click="close()">Cancel</button><div class="spinner" id="available-credit-spinner"></div></div></center></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_help.html",'<div ng-show="help.steps.length == 0"><div class="row-fluid"><div class="content-box help-content" ng-bind-html-unsafe="help.content"></div><div class="content-box" ng-repeat="child in help.children"><div class="sub-header" id="help-{{child.id}}">{{child.title}}</div><div class="help-content"><div ng-show="child.section"><div ng-bind-html-unsafe="child.summary"></div><div><a ng-click="show(child)">More</a></div></div><div ng-hide="child.section || child.area"><div ng-bind-html-unsafe="child.content"></div></div></div></div></div></div><div ng-show="help.steps.length &gt; 0"><div class="row-fluid"><div class="help-steps"><i class="icon-chevron-left pointer" ng-click="previous_step()" style="font-size: 200%"></i><div class="help-step pointer" ng-class="{active: step == selected_step}" ng-click="select(step)" ng-repeat="step in help.steps"><div class="help-step-number">{{step.step_number}}.</div><div class="help-step-title" ng-bind-html-unsafe="step.title"></div></div><i class="icon-chevron-right pointer" ng-click="next_step()" style="font-size: 200%"></i></div></div><div class="row-fluid"><div ng-show="selected_step"><div class="content-box help-content" ng-bind-html-unsafe="selected_step.content" ng-show="selected_step.content"></div><div class="help-content" ng-show="selected_step.screenshot"><img ng-src="/assets/help/{{selected_step.screenshot}}" /></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_input_credit_card.html",'<div id="input-credit-card"><div class="popover fade left in" style="width: 450px"><div class="popover-title"><div class="pull-right"><i class="goto icon-remove" ng-click="hide()"></i></div><div class="sub-header">{{title}}</div></div><div class="popover-content"><div class="spinner" id="credit-card-spinner"></div><div class="row-fluid"><div class="error" ng-show="error"><div>{{error}}</div><br /><br /></div><div ng-hide="new_credit_card"><div ng-show="existing_card"><div ng-hide="existing_card.editing"><div class="pull-right"><button class="btn btn-link" ng-click="edit_card()">Update Card</button><br /><button class="btn btn-link" ng-click="change_card()">Change Card</button></div><div class="info"><label class="label-name credit-card-label">Card:</label><span>{{existing_card.brand}}</span></div><div class="info"><label class="label-name credit-card-label">Card Number:</label><span>********{{existing_card.last4}}</span></div><div class="info"><label class="label-name credit-card-label">Expiration:</label><span>{{existing_card.exp_month}}/{{existing_card.exp_year}}</span></div><br /><br /><div class="info"><label class="label-name credit-card-label"></label><button class="btn btn-success" ng-click="submit_payment(existing_card)" ng-show="invoice">Pay ${{invoice.total_amount}}</button><button class="btn" ng-click="hide()">Close</button></div></div><div ng-show="existing_card.editing"><form class="form-horizontal" method="POST"><div class="control-group"><label class="control-label"><div class="bold">Expiration</div></label><div class="controls"><select ng-model="existing_card.editing.exp_month" style="width: 60px" type="text"><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10 </option><option value="11">11</option><option value="12">12</option></select><span>&nbsp;/&nbsp; </span><select ng-model="existing_card.editing.exp_year" style="width: 80px" type="text"><option value="2017">2017</option><option value="2018">2018</option><option value="2019">2019</option><option value="2020">2020</option><option value="2021">2021</option><option value="2022">2022</option><option value="2023">2023</option><option value="2024">2024</option><option value="2024">2025</option><option value="2024">2026</option></select></div></div><div class="control-group"><label class="control-label"><span class="bold">CVV</span></label><div class="controls"><input class="input-tiny" ng-model="existing_card.editing.cvc" size="4" type="text" /><span>&nbsp;</span><a href="javascript:void(0);" id="cvv-help-link" ng-click="show_cvv_help()">What\'s this?</a></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="update_card()">Save</button><span>&nbsp;</span><button class="btn" ng-click="cancel_editing_card()">Cancel</button></div></div></form></div></div></div><div ng-show="new_credit_card"><form class="form-horizontal" id="credit-card" method="POST"><div class="control-group"><label class="control-label"><span class="bold">Card Number</span></label><div class="controls"><input data-stripe="number" size="20" type="text" /></div></div><div class="control-group"><label class="control-label"><span class="bold">CVV</span></label><div class="controls"><input class="input-tiny" data-stripe="cvc" size="4" type="text" /><span>&nbsp;</span><a href="javascript:void(0);" id="cvv-help-link" ng-click="show_cvv_help()">What\'s this?</a><div ng-show="showing_cvv_help"><img src="/assets/credit_card_cvv-6b0a8c909d3de79a90c9b95c9dbb4f25.gif" /></div></div></div><div class="control-group"><label class="control-label"><div class="bold">Expiration</div></label><div class="controls"><select data-stripe="exp-month" style="width: 60px" type="text"><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10 </option><option value="11">11</option><option value="12">12</option></select><span>&nbsp;/&nbsp; </span><select data-stripe="exp-year" style="width: 80px" type="text"><option value="2017">2017</option><option value="2018">2018</option><option value="2019">2019</option><option value="2020">2020</option><option value="2021">2021</option><option value="2022">2022</option><option value="2023">2023</option><option value="2024">2024</option><option value="2024">2025</option><option value="2024">2026</option></select></div></div><br /><br /><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="submit_payment(new_credit_card)" ng-show="invoice">Pay ${{invoice.total_amount}}</button><button class="btn btn-success" ng-click="save_new_card()" ng-hide="invoice">Save</button><button class="btn" ng-click="hide()">Close</button></div></div></form></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_invoice.html",'<div class="hide" id="invoice-anchor"></div><div class="spinner" id="invoice-spinner" style="z-index: 1000"></div><br /><div class="row-fluid"><div class="column span4"><div ng-show="invoice.id"><div class="inline" ng-hide="invoice.finalized"><span class="label label-info">In progress</span><button class="btn btn-link" ng-click="finalize()">Finalize</button></div><div class="spinner inline" id="finalize-invoice-spinner"></div><div ng-show="invoice.finalized"><span class="label label-success">Finalized</span></div></div></div><div class="column span4"><div ad-funds-available="" invoice="invoice"></div></div><div class="column span4"><div class="pull-right"><div class="label label-info" ng-show="invoice.printed" style="vertical-align: top">Printed</div></div><div class="pull-right"><div ng-show="invoice.last_email" style="vertical-align: top">Email: &nbsp;<span class="label label-info" ng-class="{&#39;label-success&#39;: invoice.last_email.status ==&#39;delivered&#39;}">{{invoice.last_email.status}}</span></div></div></div></div><hr /><div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Rate</div><div class="total">Total</div><div class="included-gst"></div></div><ul class="invoice-items" id="invoice-item-list" ng-model="invoice.items" ui-sortable="invoice_item_sortable_options"><li class="cost" id="invoice-item-{{invoice_item.id}}" ng-hide="invoice_item.editing" ng-repeat="invoice_item in invoice.items"><div ng-show="invoice_item.header"><div class="editable" ng-click="edit_invoice_item(invoice_item)"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline" ng-show="invoice_item.saving"><img src="/assets/littlespinner-b053f26fde4de42a09c6c20272ce08ba.gif" /></div><div class="inline"><pre class="no-style bold">{{invoice_item.details}}</pre></div></div></div><div ng-hide="invoice_item.header"><div class="editable" ng-click="edit_invoice_item(invoice_item)"><div class="description"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline" ng-show="invoice_item.linked_supplier == &#39;repco&#39;"><span class="red bold" tooltip="Repco item">R &nbsp;</span></div><div class="inline" ng-show="invoice_item.linked_supplier == &#39;burson&#39;"><span class="burson-blue bold" tooltip="Burson item">B &nbsp;</span></div><div class="inline" ng-show="invoice_item.linked_supplier == &#39;ashdown ingram&#39;"><span class="red bold" tooltip="Ashdown Ingram item">A &nbsp;</span></div><div class="inline" ng-show="invoice_item.saving"><img src="/assets/littlespinner-b053f26fde4de42a09c6c20272ce08ba.gif" /></div><span>{{invoice_item.description}}</span><button class="btn btn-link" ng-click="show_invoice_item_details(invoice_item)" ng-show="invoice_item.details &amp;&amp; !invoice_item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button><button class="btn btn-link" ng-click="hide_invoice_item_details(invoice_item)" ng-show="invoice_item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button></div><div class="quantity">{{invoice_item.quantity}}</div><div class="rate">{{invoice_item.unit_price|currency}}</div><div class="total">{{invoice_item_total(invoice_item) | currency}}</div><div class="included-gst"><div ng-hide="invoice.not_registered_for_gst"><span ng-show="invoice_item.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="invoice_item.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span></div><div ng-show="invoice_item.discount_percentage &gt; 0"><span>&nbsp; (disc.&nbsp;{{invoice_item.discount_percentage}}%)</span></div></div><div class="details" ng-show="invoice_item.show_details"><pre class="no-style">{{invoice_item.details}}</pre></div></div></div></li><li id="editing-invoice-item" ng-show="editing_invoice_item"><div class="editing-item"><div ng-show="editing_invoice_item.header &amp;&amp; editing_invoice_item.editing"><form autocomplete="off" name="edit_invoice_item_header_form" novalidate="true"><div ad-saved-texts-button="true" invoice="invoice" ng-model="editing_invoice_item.editing.details"></div><textarea auto-rows="15" class="span12" id="edit-invoice-item-header-description" name="description" ng-model="editing_invoice_item.editing.details"></textarea><br /><div ng-show="editing_invoice_item.editing.confirm_deletion"><label class="checkbox"><input ng-model="editing_invoice_item.editing.delete_children" type="checkbox" />Also Remove items within this header</label></div><br /><div><button class="btn btn-success" ng-click="save_invoice_item(edit_invoice_item_header_form, editing_invoice_item)">Save</button><button class="btn" ng-click="cancel_edit_invoice_item(editing_invoice_item)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="remove_invoice_item(editing_invoice_item)">Remove</button></div></div></form></div><div ng-show="!editing_invoice_item.header &amp;&amp; editing_invoice_item.editing"><form autocomplete="off" name="edit_invoice_item_form" novalidate="true"><div class="error" ng-show="edit_invoice_item_form.description.$error.required">description is required</div><div class="error" ng-show="edit_invoice_item_form.description.$error.maxlength">description\'s max length is 225 characters, click on "More Details" to add detailed description. </div><div class="error" ng-show="edit_invoice_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="edit_invoice_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" customer="customer()" ng-model="editing_invoice_item.editing"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_invoice_item_amount(editing_invoice_item.editing)" ng-model="editing_invoice_item.editing.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-change="update_invoice_item_amount(editing_invoice_item.editing)" ng-model="editing_invoice_item.editing.unit_price" required="true" step="any" type="number" /><div ng-show="editing_invoice_item.editing.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices  </span> <i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in editing_invoice_item.editing.prices"><a href="javascript:void(0);" ng-click="select_price_level(editing_invoice_item.editing, price)"><span>{{price|currency}}</span></a></li></ul></div></div><div><span>Discount</span><div><div class="input-append"><input class="input-mini" ng-model="editing_invoice_item.editing.discount_percentage" step="any" type="number" /><span class="add-on">%</span></div></div><div ng-show="editing_invoice_item.editing.discount_percentage &gt; 100"><span class="error">Maximum: 100%</span></div></div></div><div class="total"><input class="input-mini" readonly="true" value="{{invoice_item_total(editing_invoice_item.editing)}}" /></div><div class="pull-right" ng-show="editing_invoice_item.stock_id"><a href="javascript:void(0)" ng-click="show_stock(editing_invoice_item)"><i class="icon icon-info"></i><span>Info</span></a></div><br /><div><div class="row-fluid"><a ng-click="edit_invoice_item_details(editing_invoice_item.editing)" ng-hide="editing_invoice_item.details || editing_invoice_item.editing.edit_details">More Details</a><div class="pull-right" ng-hide="invoice.not_registered_for_gst"><div><label class="checkbox"><input ng-model="editing_invoice_item.editing.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="editing_invoice_item.editing.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><div class="details" ng-show="editing_invoice_item.details || editing_invoice_item.editing.edit_details"><div ad-saved-texts-button="true" invoice="invoice" ng-model="editing_invoice_item.editing.details"></div><textarea ng-model="editing_invoice_item.editing.details" style="width: 97%; height: 150px;"></textarea></div></div><br /><div class="button-panel"><button class="btn btn-success" ng-click="save_invoice_item(edit_invoice_item_form, editing_invoice_item)">Save</button><button class="btn" ng-click="cancel_edit_invoice_item(editing_invoice_item)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="remove_invoice_item(editing_invoice_item)">Remove</button></div></div></form></div></div></li></ul><div ng-hide="new_invoice_item"><a href="javascript: void(0);" id="add-item-button" ng-click="add_invoice_item()"> <span>+ Item</span></a><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-header-button" ng-click="add_invoice_item_header()"> <span>+ Header</span></a><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-job-types-button" ng-click="add_job_types()"> <span>+ Job types</span></a><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-buyin-button" ng-click="add_invoice_item_buyin()"> <span>+ Buy-in</span></a><div class="inline" ng-show="repco_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-repco-button" ng-click="add_items_from_repco(repco_account())"><img src="/assets/repco_navigator-8e21ef0b294533a128d4feada69c8241.png" style="height: 20px;" /></a></div><div ad-ezy-parts="true" class="inline" invoice="invoice" job="job" on-update="oscar_success(account)"></div><div class="inline" ng-show="quantum_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-quantum-button" ng-click="add_items_from_repco(quantum_account())"><img src="/assets/quantum_pro-5e21beca4f69abf19b557f26df4871f2.png" style="height: 20px;" /></a></div><div class="inline" ng-show="pro_link_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-link-pro-button" ng-click="add_items_from_repco(pro_link_account())"><img src="/assets/pro_link-ed0e9bca251211f98062a43051fa0baf.png" style="height: 20px;" /></a></div><div class="inline" ng-show="motospecs_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-motospecs-button" ng-click="add_items_from_repco(motospecs_account())"><img src="/assets/motospecs-a9a4edc7104b920de0eeb485620ff60b.jpg" style="height: 30px;" /></a></div></div><div class="invoice_item" ng-show="new_invoice_item"><div ng-show="new_invoice_item.header"><form autocomplete="off" name="new_invoice_item_header_form" novalidate="true"><div class="editing-item"><div ad-saved-texts-button="true" invoice="invoice" ng-model="new_invoice_item.details"></div><textarea auto-rows="15" class="span12" id="new-invoice-item-header-description" name="description" ng-model="new_invoice_item.details" type="text"></textarea><br /><br /><div><button class="btn btn-success" ng-click="save_new_invoice_item()">Save</button><button class="btn" ng-click="cancel_add_invoice_item()">Cancel</button></div></div></form></div><div ng-hide="new_invoice_item.header"><div class="editing-item"><form autocomplete="off" name="new_invoice_item_form" novalidate="true"><div class="error" ng-show="new_invoice_item_form.description.$error.required">description is required</div><div class="error" ng-show="new_invoice_item_form.description.$error.maxlength">description\'s max length is 225 characters, click on "More Details" to add detailed description. </div><div class="error" ng-show="new_invoice_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="new_invoice_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" customer="customer()" input-id="new-invoice-item-description" ng-model="new_invoice_item"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_invoice_item_amount(new_invoice_item)" ng-model="new_invoice_item.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini inline" name="unit_price" ng-change="update_invoice_item_amount(new_invoice_item)" ng-model="new_invoice_item.unit_price" required="true" step="any" type="number" /><div ng-show="new_invoice_item.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices&nbsp;  </span><i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in new_invoice_item.prices"><a href="javascript:void(0);" ng-click="select_price_level(new_invoice_item, price)"><span>{{price|currency}}</span></a></li></ul></div></div><div><span>Discount</span><div><div class="input-append"><input class="input-mini" ng-model="new_invoice_item.discount_percentage" type="number" /><span class="add-on">%</span></div></div><div ng-show="new_invoice_item.discount_percentage &gt; 100"><span class="error">Maximum: 100%</span></div></div></div><div class="total"><input class="input-mini" readonly="true" value="{{invoice_item_total(new_invoice_item)}}" /></div><div class="pull-right" ng-show="new_invoice_item.stock_id"><a href="javascript:void(0)" ng-click="show_stock(new_invoice_item)"><i class="icon icon-info"></i><span>Info</span></a></div><br /><div><div class="row-fluid"><a ng-click="edit_invoice_item_details(new_invoice_item)" ng-hide="new_invoice_item.edit_details">More Details</a><div class="pull-right" ng-hide="invoice.not_registered_for_gst"><div><label class="checkbox inline"><input ng-model="new_invoice_item.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="new_invoice_item.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><div class="details" ng-show="new_invoice_item.edit_details"><div ad-saved-texts-button="true" invoice="invoice" ng-model="new_invoice_item.details"></div><textarea ng-model="new_invoice_item.details" style="width: 95%; height: 150px;"></textarea></div></div><br /><br /><div><button class="btn btn-success" ng-click="save_new_invoice_item()">Save</button><button class="btn" ng-click="cancel_add_invoice_item()">Cancel</button><div class="pull-right"><div ad-new-stock="true" class="inline" generic-item="new_invoice_item" ng-model="new_stock" on-save="select_new_stock()"></div></div></div></form></div></div></div><div class="summary"><div ng-show="invoice.discount_amount"><div class="title"><span ng-hide="not_registered_for_gst()">Discount Incl. {{tax_name()}}:</span><span ng-show="not_registered_for_gst()">Discount:</span></div><div class="value">- {{invoice.discount_amount | currency}}</div></div><div ng-hide="not_registered_for_gst()"><div><div class="title">Total Excl. {{tax_name()}}:</div> <div class="value">{{invoice.net_amount | currency}}</div></div><div><div class="title">{{tax_name()}}:&nbsp;</div><div class="value">{{invoice.gst_amount | currency}}</div></div></div><div><div class="title">Total:</div> <div class="value">{{invoice.total_amount | currency}}</div></div><div><div class="title">Paid:</div> <div class="value">{{invoice.paid_amount | currency}}</div></div><div><div class="title">Balance Due:</div> <div class="value">{{invoice.unpaid_amount | currency}}</div></div><div class="included-gst"></div></div><div ng-show="invoice &amp;&amp; invoice.id"><div><label><b>Discount</b></label><div ng-show="invoice.editing_discount"><div class="input-append"><input class="input-tiny" ng-model="invoice.editing_discount.discount_percentage" step="any" type="number" /><span class="add-on">%</span></div><span class="error" ng-show="invoice.editing_discount.discount_percentage &gt; 100">&nbsp; Maximum: 100%</span><br /><div class="input-append"><input class="input-tiny" ng-model="invoice.editing_discount.discount_money" type="number" /><span class="add-on">$</span></div><br /><button class="btn btn-primary" ng-click="update_invoice_discount()">Save</button><button class="btn" ng-click="cancel_edit_invoice_discount()">Cancel</button></div><div class="editable" ng-click="edit_invoice_discount()" ng-hide="invoice.editing_discount"><div class="red bold" ng-show="invoice.discount_money">${{invoice.discount_money}}</div><div class="red bold" ng-show="invoice.discount_percentage">{{invoice.discount_percentage}} % </div><div ng-show="!invoice.discount_money &amp;&amp; !invoice.discount_percentage">No Discount</div></div></div><hr class="divider" /><div class="sub-header">Invoice Note<div class="pull-right"><button class="btn btn-link" ng-click="edit_invoice_details()">Add Invoice Details</button></div></div><div class="editable note" ng-click="edit_invoice_details()" ng-hide="invoice.editing_details"><pre class="no-style" ng-show="invoice.details">{{invoice.details}}</pre></div><div class="editing-item" ng-show="invoice.editing_details"><div><label class="checkbox inline"><input ng-click="auto_save_invoice_details()" ng-model="invoice.editing_details.auto_save" type="checkbox" /><span>Auto-save (every 10 seconds)</span></label><div class="pull-right"><div><span class="green" ng-show="invoice.editing_details.details == invoice.details">Saved</span><span ng-show="(invoice.editing_details.details != invoice.details) &amp;&amp; !invoice.editing_details.saving">Pending...</span><span class="green" ng-show="invoice.editing_details.saving">Saving...</span></div></div></div><div><div ad-saved-texts-button="true" class="inline" invoice="invoice" ng-model="invoice.editing_details.details"></div><div ad-vehicle-visual-button="true" class="inline" ng-model="invoice.editing_details.details"></div><textarea class="span12" id="edit-invoice-details" ng-model="invoice.editing_details.details" rows="20"></textarea></div><button class="btn btn-primary" ng-click="save_invoice_details()">Save</button><button class="btn" ng-click="cancel_edit_invoice_details()">Close</button><div class="pull-right"><button class="btn btn-danger" ng-click="clear_invoice_details()">Remove</button></div></div></div></div><div ad-buyin-selection="true" anchor-element="#invoice-anchor" on-select="select_buyin()" placement="bottom" selection="selected_buyin_items" showing="showing_buyin"></div><div id="add-job-types-popover"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header">Add Job Types</div></div><div class="popover-content"><div class="content-box"><div class="bold">Job types:</div><div ad-job-type-selection="true" ng-model="new_job_types"></div><div class="spinner" id="add-job-types-spinner"></div><br /><br /><button class="btn btn-primary" ng-click="save_new_job_types()">Add</button><button class="btn" ng-click="hide_add_job_types()">Cancel</button></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_invoice_actions.html",'<a class="btn btn-default" ng-href="{{print_url()}}" ng-show="show_print_url()" target="_blank">Print Invoice</a><a class="btn btn-default" href="javascript:void(0);" ng-click="create_bulk_invoice_request()" ng-show="show_create_backend_request()">Print Invoice</a><a class="btn btn-default" ng-href="/invoices/{{invoice.id}}/print_delivery_docket.pdf" ng-show="invoice.id &amp;&amp; !job" target="_blank">Print Delivery Docket</a><button class="btn" id="invoice-send-email-button" ng-click="open_send_email()"><i class="icon-envelope"></i>Email Invoice</button><div id="invoice-send-email"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Send Email</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form name="email_invoice_form" novalidate="true"><label><div class="row-fluid"><span>Email</span> <span class="error" ng-show="email_invoice_form.email.$error.required">(email address is required)</span></div><input class="span9" id="invoice-send-email-address" name="email" ng-model="email" required="true" type="text" /><div class="pull-right"><div class="inline" contactpicker="true" model-type="customer" ng-model="customer" on-select="email_select_contact(contacts)" show-email="true"></div></div></label><label>Subject</label> <input class="span12" id="invoice-send-email-subject" ng-model="subject" type="text" /><label><span>Message</span><span ad-saved-texts-button="true" invoice="invoice" ng-model="message"></span><div ad-vehicle-visual-button="true" class="inline" ng-model="message"></div></label> <textarea class="span12" id="invoice-send-email-message" ng-model="message" rows="15" type="text"></textarea><div><label class="checkbox"><input ng-model="send_me_a_copy" type="checkbox" /><span>Send me a copy</span></label></div><div><label class="checkbox"><input ng-model="delivery_notification_required" type="checkbox" /><span>Send me a notification on delivery</span></label></div><div><label class="checkbox"><input ng-model="attached_files" type="checkbox" /><span>Attach Files</span></label></div><div ng-show="attached_files"><table class="table table-striped"><tbody><tr ng-show="job"><td><label class="checkbox"><input ng-model="attach_job_card" type="checkbox" />Job Card</label></td></tr><tr ng-repeat="file in job.photos"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in invoice.photos"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in job.documents"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in invoice.documents"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr></tbody></table></div><br /><br /><div class="button-panel"><button class="btn btn-success" ng-click="send_email()">Send</button><button class="btn btn-success" ng-click="send_email_and_print()">Send & Print</button><button class="btn" ng-click="cancel()">Cancel</button><div class="inline" id="invoice-send-email-spinner"></div></div></form></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_invoice_bills.html",'<table class="table table-striped table-bordered"><tbody><tr ng-repeat="bill in invoice.related_bills"><td id="bill-{{bill.id}}"><a class="goto" ng-href="#/bills/{{bill.id}}"><div class="inline" style="width: 100px">Ref: #{{bill.reference}}</div><div class="inline"><span class="bold">Supplier:&nbsp;</span><span>{{bill.supplier.name}}</span></div><div class="pull-right"><span class="bold">Total:&nbsp;</span><span>{{bill.total_amount|currency}}</span></div></a></td></tr></tbody></table>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_invoice_cogs.html",'<div class="row-fluid"><div class="pull-right"><a href="/invoices/{{invoice.id}}/print_cogs.pdf" target="_blank"><i class="icon icon-print"></i><span>Print</span></a></div></div><br /><div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Cost</div><div class="pull-right"><div class="total">Total</div></div></div><ul class="invoice-items" id="invoice-item-cogs"><li class="cost" id="invoice-item-cogs-{{invoice_item.id}}" ng-repeat="invoice_item in invoice.items" ng-show="show_item(invoice_item)"><div class="editable" ng-click="edit_cogs(invoice_item)" ng-hide="invoice_item.editing_cogs"><div><div class="description">{{invoice_item.description}}</div><div class="quantity">{{invoice_item.cost_quantity}}</div><div class="rate">{{invoice_item.buy_price|currency}}</div><div class="pull-right"><div class="total"><span>{{invoice_item_total(invoice_item) | currency}}</span><span ng-show="invoice_item.cogs_quantity != invoice_item.quantity">&nbsp;(Est)</span></div></div></div></div></li><li class="editing-item" id="editing-invoice-item-cogs" ng-show="editing_invoice_item.editing_cogs"><form><div><div class="description">{{editing_invoice_item.description}}</div><div class="quantity">{{editing_invoice_item.cost_quantity}}</div><div class="rate"><input class="input-small" ng-model="editing_invoice_item.editing_cogs.buy_price" type="number" /></div><div class="pull-right"><div class="total">{{invoice_item_total(editing_invoice_item.editing_cogs) | currency}}</div></div></div><div><div class="description"></div><div class="quantity"></div><div class="inline"><button class="btn btn-success" ng-click="save_cogs(editing_invoice_item)" type="submit">Save</button><button class="btn" ng-click="cancel_edit_cogs(editing_invoice_item)">Cancel</button></div></div></form></li><li class="cost" ng-show="new_cogs"><div><div class="description"><select ng-change="select_cogs()" ng-model="new_cogs.id" ng-options="item.id as item.description for item in selectable_items()"></select></div><div class="quantity">{{new_cogs.cost_quantity}}</div><div class="rate"><input class="input-small" ng-model="new_cogs.buy_price" type="number" /></div><div class="pull-right"><div class="total">{{invoice_item_total(new_cogs) | currency}}</div></div></div><div><button class="btn btn-success" ng-click="save_cogs(new_cogs)" type="submit">Save</button><button class="btn" ng-click="cancel_edit_cogs(new_cogs)">Cancel</button></div><br /></li></ul><div class="row-fluid"><div class="inline"><a href="javascript:void(0);" ng-click="add_cogs()">Add</a></div><div class="pull-right"><div class="bold" ng-show="invoice">Total COGS: {{total_cost() | currency}}</div></div><hr /><div class="pull-right"><div class="bold" ng-show="invoice">Profit Margin: {{profit_margin() | currency}} ({{profit_margin_percentage()}}%)</div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_invoice_details.html",'<div class="editable" ng-click="edit()" ng-hide="invoice.editing_info"><div><span class="label-name-left auto-width">Issue Date:</span><span class="issue-date">{{invoice.issue_date|date: \'mediumDate\'}}</span></div><div><span class="label-name-left auto-width">Due Date:</span><span class="due-date">{{invoice.due_date|date: \'mediumDate\'}}</span></div><div><span class="label-name-left auto-width">Invoice Number:</span><span class="inline invoice-number" style="min-width: 40px;">{{invoice.number}}</span></div><div><span class="label-name-left auto-width">Order Number:</span><span class="inline invoice-number" style="min-width: 40px;">{{invoice.order_number}}</span></div><div ng-show="enable_tracking_category_selection()"><span class="label-name-left auto-width">Tracking Categories</span><div class="inline" style="min-width: 40px;">{{invoice.tracking_categories|comma_seperated: \'option\'}}</div></div></div><div class="editing-item" ng-show="invoice.editing_info"><form class="inline form form-inline" name="edit_details_form" novalidate="true"><div class="row-fluid"><div class="column span5" style="text-align: right">Issue Date</div><div class="column span7"><ad-datepicker error="top" id="invoice-details-issue-date" name="issue_date" ng-model="invoice.editing_info.issue_date"></ad-datepicker></div></div><div class="row-fluid" style="margin-top: 3px"><div class="column span5" style="text-align: right">Due Date</div><div class="column span7"><ad-datepicker error="top" id="invoice-details-due-date" name="due_date" ng-model="invoice.editing_info.due_date"></ad-datepicker></div></div><div class="row-fluid" style="margin-top: 3px"><div class="column span5" style="text-align: right">Invoice No#:</div><div class="column span7"><input class="input-small" error="top" id="invoice-details-number" name="number" ng-model="invoice.editing_info.number" type="text" /></div></div><div class="row-fluid" style="margin-top: 3px"><div class="column span5" style="text-align: right">Order No#:</div><div class="column span7"><input class="input-small" id="invoice-details-order-number" name="order_number" ng-model="invoice.editing_info.order_number" type="text" /></div></div><br /><div ng-show="enable_tracking_category_selection()"><span class="label-name-left auto-width">Tracking Categories</span><div class="inline" style="min-width: 40px;"><div ad-tracking-category-selection="true" ng-model="invoice.editing_info"></div></div></div></form><div><button class="btn btn-success" ng-click="save()">Save</button><button class="btn" ng-click="cancel_edit()">Cancel</button></div></div><div class="editable" ng-click="edit_royalty()" ng-hide="invoice.editing_royalty || royalty_integration_accounts().length == 0"><div><span class="label-name-left auto-width">Auto Club</span><div class="inline" style="min-width: 40px;">{{invoice.royalty_auto_club|na}}</div></div><div ng-show="invoice.royalty_account_number"><span class="label-name-left auto-width">{{invoice.royalty_auto_club}} Card No.</span><div class="inline" style="min-width: 40px;">{{invoice.royalty_account_number|na: \'short\'}}</div></div></div><div class="editing-item" ng-show="invoice.editing_royalty"><royaltypicker ng-model="invoice.editing_royalty"></royaltypicker><button class="btn btn-success" ng-click="save_royalty()">Save</button><button class="btn" ng-click="cancel_edit_royalty()">Cancel</button></div><div ng-click="edit_salesperson()"><span class="label-name-left auto-width">Salesperson:</span><div class="inline invoice-salesperson editable" ng-hide="invoice.editing_salesperson" style="min-width: 40px;">{{invoice.employee.name | na}}</div></div><div class="inline editing-item" ng-show="invoice.editing_salesperson"><form class="inline form form-inline" name="edit_salesperson_form" novalidate="true"><select class="inline" name="employee" ng-model="invoice.editing_salesperson.employee_id" ng-options="employee.id as employee.name for employee in employees()"><option value=""></option></select>&nbsp;<button class="btn btn-success" ng-click="save_salesperson()">Save</button><button class="btn" ng-click="cancel_edit_salesperson()">Cancel</button></form></div><div ng-show="invoice.finalized"><span class="label-name-left auto-width">Finalized By:</span>{{invoice.finalized_by.name}}</div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_invoice_item_input.html",'<input autocomplete="off" class="span12" enable-submit="true" id="{{input_id}}" name="description" ng-maxlength="255" ng-model="invoice_item.description" required="true" select-value-on-click="code/description" type="text" typeahead="item.lookup_text for item in lookup($viewValue)" typeahead-on-select="select($item, $model, $label, selected_item)" typeahead-wait-ms="300" />')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_invoice_item_selection.html",'<div id="invoice-selection"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header">Select related invoice</div></div><div class="popover-content"><form class="form-search form-inline form-search-invoice"><div class="inline search-box"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></div></form><div class="content-box"><div class="spinner" id="invoice-item-selection-spinner"></div><table class="table table-striped"><thead></thead><tbody><tr class="pointer" ng-click="toggle_select(invoice)" ng-repeat="invoice in invoices"><td><div ng-class="{&#39;invoice-selected&#39;: invoice.selected}"><div class="row-fluid"><div class="column span7"><div><span class="label-name-left auto-width">Invoice# {{invoice.number}} - {{invoice.description}}</span></div><div><span class="label-name-left auto-width">Date:</span><span>{{invoice.issue_date|date: \'mediumDate\'}}</span></div></div><div class="column span5"><div class="bold"><span class="label-name-left auto-width">Customer:</span><span>{{invoice.customer.name}}</span></div><div><span class="label-name-left auto-width">Total:</span><span class="bold">{{invoice.total_amount|currency}}</span></div><div><span class="label-name-left auto-width">Remaining:</span><span class="bold">{{invoice.unpaid_amount|currency}}</span></div></div></div><div class="row-fluid" ng-show="invoice.show_items"><br /><table class="table"><thead><tr><td class="bold">Name</td><td class="bold">Quantity</td><td class="bold">Price</td><td class="bold">Total</td><td class="bold">Total Incl. {{tax_name()}}</td></tr></thead><tbody><tr class="pointer" ng-class="{&#39;invoice-item-selected&#39;: item.selected}" ng-click="toggle_select_invoice_item(item)" ng-repeat="item in invoice.items" stop-event="click"><td>{{item.description}}</td><td>{{item.quantity}}</td><td>{{item.unit_price|currency}}</td><td>{{item.net_amount|currency}}</td><td>{{item.total_amount|currency}}</td></tr></tbody></table></div></div></td></tr></tbody></table><div ng-show="total_pages &gt; 1"><pagination boundary-links="true" current-page="page_number" max-size="10" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div><br /></div><div class="buttons"><button class="btn btn-success" ng-click="do_select()">Select</button><button class="btn" ng-click="hide()">Cancel</button></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_invoice_payments.html",'<div class="sub-header">Payments<div class="pull-right">{{payment_status()}}</div></div><div ng-show="invoice.payments.length == 0"><span>No payment</span></div><div ng-show="invoice.payments.length &gt; 0"><div class="invoice-payment" ng-repeat="payment in invoice.payments"><pre class="goto"><div class="row-fluid"><a class="goto" ng-href="#/payments/{{payment.id}}"><div class="pull-right"><div>{{payment.payment_type_name}}: &nbsp;{{payment.amount|currency}}</div></div><div class="pull-left"><div>{{payment.date|date: \'mediumDate\'}}</div></div></a></div></pre></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_invoice_restricted.html",'<div class="hide" id="invoice-anchor"></div><div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div></div><ul class="invoice-items" ng-model="invoice.items" ui-sortable="invoice_item_sortable_options"><li class="cost" ng-repeat="invoice_item in invoice.items"><div ng-show="invoice_item.header"><div class="editable" ng-click="edit_invoice_item(invoice_item)" ng-hide="invoice_item.editing"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline" ng-show="invoice_item.saving"><img src="/assets/littlespinner-b053f26fde4de42a09c6c20272ce08ba.gif" /></div><div class="inline"><pre class="no-style bold">{{invoice_item.details}}</pre></div></div><div class="editing-item" ng-show="invoice_item.editing"><form autocomplete="off" name="edit_invoice_item_header_form" novalidate="true"><textarea auto-rows="15" class="span12" id="edit-invoice-item-header-description" name="description" ng-model="invoice_item.editing.details"></textarea><br /><div ng-show="invoice_item.editing.confirm_deletion"><label class="checkbox"><input ng-model="invoice_item.editing.delete_children" type="checkbox" />Also Remove items within this header</label></div><br /><div><button class="btn btn-success" ng-click="save_invoice_item(edit_invoice_item_header_form, invoice_item)">Save</button><button class="btn btn-success" ng-click="save_invoice_item(edit_invoice_item_header_form, invoice_item)">Save</button><button class="btn" ng-click="cancel_edit_invoice_item(invoice_item)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="remove_invoice_item(invoice_item)">Remove</button></div></div></form></div></div><div ng-hide="invoice_item.header"><div class="editable" ng-click="edit_invoice_item(invoice_item)" ng-hide="invoice_item.editing"><div class="description"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline" ng-show="invoice_item.saving"><img src="/assets/littlespinner-b053f26fde4de42a09c6c20272ce08ba.gif" /></div><span>{{invoice_item.description}}</span><button class="btn btn-link" ng-click="show_invoice_item_details(invoice_item)" ng-show="invoice_item.details &amp;&amp; !invoice_item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button><button class="btn btn-link" ng-click="hide_invoice_item_details(invoice_item)" ng-show="invoice_item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button></div><div class="quantity">{{invoice_item.quantity}}</div><div class="details" ng-show="invoice_item.show_details"><pre class="no-style">{{invoice_item.details}}</pre></div></div><div class="editing-item" ng-show="invoice_item.editing"><form autocomplete="off" name="edit_invoice_item_form" novalidate="true"><div class="error" ng-show="edit_invoice_item_form.description.$error.required">description is required</div><div class="error" ng-show="edit_invoice_item_form.description.$error.maxlength">description\'s max length is 225 characters, click on "More Details" to add detailed description. </div><div class="error" ng-show="edit_invoice_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="edit_invoice_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" customer="customer()" ng-model="invoice_item.editing"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_invoice_item_amount(invoice_item.editing)" ng-model="invoice_item.editing.quantity" required="true" step="any" type="number" /></div><div class="pull-right" ng-show="invoice_item.stock_id"><a href="javascript:void(0)" ng-click="show_stock(invoice_item)"><i class="icon icon-info"></i><span>Info</span></a></div><br /><div class="button-panel"><button class="btn btn-success" ng-click="save_invoice_item(edit_invoice_item_form, invoice_item)">Save</button><button class="btn" ng-click="cancel_edit_invoice_item(invoice_item)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="remove_invoice_item(invoice_item)">Remove</button></div></div></form></div></div></li></ul><div ng-hide="new_invoice_item"><a href="javascript: void(0);" id="add-item-button" ng-click="add_invoice_item()"> <span>+ Item</span></a><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-header-button" ng-click="add_invoice_item_header()"> <span>+ Header</span></a></div><div class="invoice_item" ng-show="new_invoice_item"><div ng-show="new_invoice_item.header"><form autocomplete="off" name="new_invoice_item_header_form" novalidate="true"><div class="editing-item"><textarea auto-rows="15" class="span12" id="new-invoice-item-header-description" name="description" ng-model="new_invoice_item.details" type="text"></textarea><br /><br /><div><button class="btn btn-success" ng-click="save_and_new_invoice_item()">Save And Add</button><button class="btn btn-success" ng-click="save_new_invoice_item()">Save </button><button class="btn" ng-click="cancel_add_invoice_item()">Cancel</button></div></div></form></div><div ng-hide="new_invoice_item.header"><div class="editing-item"><form autocomplete="off" name="new_invoice_item_form" novalidate="true"><div class="error" ng-show="new_invoice_item_form.description.$error.required">description is required</div><div class="error" ng-show="new_invoice_item_form.description.$error.maxlength">description\'s max length is 225 characters, click on "More Details" to add detailed description. </div><div class="error" ng-show="new_invoice_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="new_invoice_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" customer="customer()" input-id="new-invoice-item-description" ng-model="new_invoice_item"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_invoice_item_amount(new_invoice_item)" ng-model="new_invoice_item.quantity" required="true" step="any" type="number" /></div><div class="pull-right" ng-show="new_invoice_item.stock_id"><a href="javascript:void(0)" ng-click="show_stock(new_invoice_item)"><i class="icon icon-info"></i><span>Info</span></a></div><br /><div><div class="row-fluid"><a ng-click="edit_invoice_item_details(new_invoice_item)" ng-hide="new_invoice_item.edit_details">More Details</a></div><div class="details" ng-show="new_invoice_item.edit_details"><textarea ng-model="new_invoice_item.details" style="width: 95%; height: 150px;"></textarea></div></div><br /><br /><div><button class="btn btn-success" ng-click="save_and_new_invoice_item()">Save And Add</button><button class="btn btn-success" ng-click="save_new_invoice_item()">Save</button><button class="btn" ng-click="cancel_add_invoice_item()">Cancel</button><div class="pull-right"><div ad-new-stock="true" class="inline" generic-item="new_invoice_item" ng-model="new_stock" on-save="select_new_stock()"></div></div></div></form></div></div></div><br /><br /><br /><br /><hr class="divider" /><div class="sub-header">Invoice Note<div class="pull-right"><button class="btn btn-link" ng-click="edit_invoice_details()">Add Invoice Details</button></div></div><div class="editable note" ng-click="edit_invoice_details()" ng-hide="invoice_editing_details"><pre class="no-style" ng-show="invoice.details">{{invoice.details}}</pre></div><div class="editing-item" ng-show="invoice_editing_details"><div><label class="checkbox inline"><input ng-click="auto_save_invoice_details()" ng-model="invoice_editing_details.auto_save" type="checkbox" /><span>Auto-save (every 10 seconds)</span></label><div class="pull-right"><div><span class="green" ng-show="invoice_editing_details.details == invoice.details">Saved</span><span ng-show="(invoice_editing_details.details != invoice.details) &amp;&amp; !invoice_editing_details.saving">Pending...</span><span class="green" ng-show="invoice_editing_details.saving">Saving...</span></div></div></div><div><div ad-saved-texts-button="true" invoice="invoice" ng-model="invoice_editing_details.details"></div><textarea class="span12" id="edit-invoice-details" ng-model="invoice_editing_details.details" rows="20"></textarea></div><button class="btn btn-primary" ng-click="save_invoice_details()">Save</button><button class="btn" ng-click="cancel_edit_invoice_details()">Close</button><div class="pull-right"><button class="btn btn-danger" ng-click="clear_invoice_details()">Remove</button></div></div></div><div ad-stock-info="true"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_invoice_selection.html",'<div id="invoice-selection"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header">{{customer.name}}\'s unpaid invoices</div></div><div class="popover-content"><label class="checkbox"><input ng-click="search()" ng-model="finalized_only" type="checkbox" /><span>Show</span> <span class="label label-info">finalized</span> <span>invoices only</span></label><div class="content-box"><div class="spinner" id="loading-invoices-spinner"></div><div class="row-fluid"><div class="column span4"><div class="bold">Available Amount: {{allocatable_amount()|currency}}</div></div><div class="column span4"><div class="bold">Allocated Amount: {{total_allocated_amount()|currency}}</div></div><div class="column span4"><div class="pull-right"><button class="btn btn-warning" ng-click="automatic_allocate()" ng-hide="total_allocated_amount() &gt; 0">Auto-Allocate</button><button class="btn" ng-click="unallocate()" ng-show="total_allocated_amount() &gt; 0">Unallocate</button><div class="spinner" id="auto-allocate-spinner"></div></div></div></div><br /><table class="table table-striped"><thead></thead><tbody><tr ng-repeat="invoice in invoices"><td><div ng-class="{&#39;invoice-selected&#39;: invoice.selected}"><div class="row-fluid"><div class="column span2"><div class="buttons"><button class="btn btn-link" ng-click="select(invoice)" ng-hide="invoice.selected || auto_allocating">Select</button><button class="btn btn-link" ng-click="deselect(invoice)" ng-show="invoice.selected &amp;&amp; !auto_allocating">Unselect</button></div></div><div class="column span4"><div><span class="label-name-left auto-width">Invoice No#:</span><span>{{invoice.number}}</span></div><div></div><span class="label-name-left auto-width">Date:</span><span>{{invoice.issue_date|date: \'mediumDate\'}}</span></div><div class="column span6"><div class="pull-right"><button class="btn btn-link" ng-click="show_items(invoice)" ng-hide="invoice.show_items">Show Items</button><button class="btn btn-link" ng-click="hide_items(invoice)" ng-show="invoice.show_items">Hide Items</button></div><div><span class="label-name-left auto-width">Total:</span><span class="bold">{{invoice.total_amount|currency}}</span></div><div><span class="label-name-left auto-width">Remaining:</span><span class="bold">{{invoice.unpaid_amount|currency}}</span></div></div></div><div class="row-fluid" ng-show="invoice.selected"><br /><div class="column span12"><span class="label-name-left auto-width">Amount:</span><input class="input-small" ng-model="invoice.allocated_amount" type="text" /></div></div><div class="row-fluid" ng-show="invoice.show_items"><br /><table class="table"><thead><tr><td class="bold">Name</td><td class="bold">Quantity</td><td class="bold">Price</td><td class="bold">Total</td><td class="bold">Total Incl. {{tax_name()}}</td></tr></thead><tbody><tr ng-repeat="item in invoice.items"><td>{{item.description}}</td><td>{{item.quantity}}</td><td>{{item.unit_price|currency}}</td><td>{{item.net_amount|currency}}</td><td>{{item.total_amount|currency}}</td></tr></tbody></table></div></div></td></tr></tbody></table><br /></div><div class="buttons"><button class="btn btn-success" ng-click="do_select()">Select</button><button class="btn" ng-click="hide()">Cancel</button><div class="spinner" id="select-invoices-spinner"></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_invoice_viewer.html",'<div id="invoice-viewer-popover"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="row-fluid"><div class="sub-header"><span ng-hide="invoice.type == &#39;credit note&#39;">Invoice #{{invoice.number}}</span><span ng-show="invoice.type == &#39;credit note&#39;">Credit Note #{{invoice.number}}</span></div><div class="pull-right"><a class="btn btn-primary" ng-href="{{invoice_path()}}" target="_blank">Full Details</a></div></div></div><div class="popover-content"><div class="content-box"><div class="spinner" id="invoice-viewer-spinner"></div><div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Rate</div><div class="total">Total</div><div class="included-gst"></div></div><ul class="invoice-items" ng-model="invoice.items"><li class="cost" ng-repeat="invoice_item in invoice.items"><div ng-show="invoice_item.header"><div class="inline"><pre class="no-style bold">{{invoice_item.details}}</pre></div></div><div ng-hide="invoice_item.header"><div><div class="description"><span>{{invoice_item.description}}</span></div><div class="quantity">{{invoice_item.quantity}}</div><div class="rate">{{invoice_item.unit_price|currency}}</div><div class="total">{{invoice_item.total_amount | currency}}</div><div class="included-gst"><div ng-hide="invoice.not_registered_for_gst"><span ng-show="invoice_item.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="invoice_item.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span></div><div ng-show="invoice_item.discount_percentage &gt; 0"><span>&nbsp; (disc.&nbsp;{{invoice_item.discount_percentage}}%)</span></div></div><div class="details" ng-show="invoice_item.show_details"><pre class="no-style">{{invoice_item.details}}</pre></div></div></div></li></ul><div class="summary"><div ng-show="invoice.discount_amount"><div class="title"><span ng-hide="not_registered_for_gst()">Discount Incl. {{tax_name()}}:</span><span ng-show="not_registered_for_gst()">Discount:</span></div><div class="value">- {{invoice.discount_amount | currency}}</div></div><div ng-hide="not_registered_for_gst()"><div><div class="title">Total Excl. {{tax_name()}}:</div> <div class="value">{{invoice.net_amount | currency}}</div></div><div><div class="title">{{tax_name()}}:&nbsp;</div><div class="value">{{invoice.gst_amount | currency}}</div></div></div><div><div class="title">Total:</div> <div class="value">{{invoice.total_amount | currency}}</div></div></div><div ng-show="invoice &amp;&amp; invoice.id"><div><label><b>Discount</b></label></div><hr class="divider" /><div class="sub-header">Note</div><div class="note"><pre class="no-style" ng-show="invoice.details">{{invoice.details}}</pre></div></div></div></div><button class="btn btn-primary" ng-click="hide()">Close</button></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_invoicepicker.html",'<div class="inline"><div class="input-append"><input autocomplete="off" class="span12" id="{{input_id}}" ng-maxlength="255" ng-model="invoice.lookup_text" ng-readonly="readonly" style="min-width: 200px; max-width: 300px" type="text" typeahead="item.lookup_text for item in lookup($viewValue)" typeahead-on-select="select($item, $model, $label, selected_invoice)" typeahead-wait-ms="200" /><span class="add-on"><div class="spinner spinner-small" id="lookup-invoice-spinner-{{spinner_id}}"></div><i class="icon icon-search" id="lookup-invoice-icon-{{spinner_id}}"></i></span><span>&nbsp; {{invoice.customer_name}}</span></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_job_type_selection.html",'<div class="span8"><selectize config="selectizeConfigs" init-options="job_types()" ng-model="job_type_ids" placeholder="Pick job types..."></selectize></div><button class="btn btn-link" id="create-job-type-button" ng-click="new_job_type()" type="button">New</button><div id="create-job-type"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">New Job Type</div></div><div class="popover-content"><div class="row-fluid"><form class="form-horizontal"><div class="content-box"><div class="control-group"><label class="control-label">Name*</label><div class="controls"><div class="error" ng-show="!job_type_form.title">Name is required</div><input id="new-job-type-title" ng-model="job_type.title" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_job_type()">Save</button><button class="btn" ng-click="cancel_new_job_type()">Cancel</button></div></div></div></form></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_jobpicker.html",'<div class="inline"><div class="input-append"><input autocomplete="off" class="span12" id="{{input_id}}" ng-maxlength="255" ng-model="job.title" ng-readonly="readonly" style="min-width: 400px; max-width: 500px" type="text" typeahead="item.lookup_text for item in lookup($viewValue)" typeahead-on-select="select($item, $model, $label, selected_job)" typeahead-wait-ms="200" /><span class="add-on"><div class="spinner spinner-small" id="lookup-job-spinner-{{spinner_id}}"></div><i class="icon icon-search" id="lookup-job-icon-{{spinner_id}}"></i></span><span>&nbsp; {{job.customer_name}}</span></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_merge_customer.html",'<div id="merge-customer-popover"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Merge Customer</div></div><div class="popover-content"><div class="content-box"><div class="alert warning">This action is irreversible. All data from this customer will be transferred to the customer you choose to merge into and this customer will be deleted.</div><div class="sub-header">Merged To:</div><label>Customer</label><div customer="selected_customer" customerpicker="true" on-select="select_customer()"></div><div><div class="sub-header">Selected Customer</div><div class="well" ng-hide="selected_customer.id"><b>Note:</b> <span>Please use the input above to search for customers and</span> <b>Select a customer from the dropdown.</b></div><div ng-show="selected_customer.id"><div ng-show="selected_customer.name"><span class="label-text-left auto-width">Name:</span> <span>{{selected_customer.name}}</span></div><div ng-show="selected_customer.phone"><span class="label-text-left auto-width">Phone:</span> <span>{{selected_customer.phone}}</span></div><div ng-show="selected_customer.mobile"><span class="label-text-left auto-width">Mobile:</span> <span>{{selected_customer.mobile}}</span></div><div ng-show="selected_customer.fax"><span class="label-text-left auto-width">Fax:</span> <span>{{selected_customer.fax}}</span></div><div ng-show="selected_customer.address.full_address"><span class="label-text-left auto-width">Address:</span> <span>{{selected_customer.address.full_address}}</span></div></div></div></div><div class="row-fluid"><button class="btn btn-primary" ng-click="merge()">Merge</button><button class="btn" ng-click="hide()">Cancel</button></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_merge_supplier.html",'<div id="merge-supplier-popover"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Merge Supplier</div></div><div class="popover-content"><div class="content-box"><div class="alert warning">This action is irreversible. All data from this supplier will be transferred to the supplier you choose to merge into and this supplier will be deleted.</div><div class="sub-header">Merged To:</div><label>Supplier</label><div ng-model="supplier_id" on-select="select_supplier()" supplier="selected_supplier" supplierpicker="true"></div><div><div class="sub-header">Selected Supplier</div><div class="well" ng-hide="selected_supplier.id"><b>Note:</b> <span>Please use the input above to search for suppliers and</span> <b>Select a supplier from the dropdown.</b></div><div ng-show="selected_supplier.id"><div ng-show="selected_supplier.name"><span class="label-text-left auto-width">Name:</span> <span>{{selected_supplier.name}}</span></div><div ng-show="selected_supplier.phone"><span class="label-text-left auto-width">Phone:</span> <span>{{selected_supplier.phone}}</span></div><div ng-show="selected_supplier.mobile"><span class="label-text-left auto-width">Mobile:</span> <span>{{selected_supplier.mobile}}</span></div><div ng-show="selected_supplier.fax"><span class="label-text-left auto-width">Fax:</span> <span>{{selected_supplier.fax}}</span></div><div ng-show="selected_supplier.address.full_address"><span class="label-text-left auto-width">Address:</span> <span>{{selected_supplier.address.full_address}}</span></div></div></div></div><div class="row-fluid"><button class="btn btn-primary" ng-click="merge()">Merge</button><button class="btn" ng-click="hide()">Cancel</button></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_merge_vehicle.html",'<div id="vehicle-merge-popover"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header">Merge {{asset_name_plural()}}</div></div><div class="popover-content"><div class="content-box"><div class="row-fluid"><div class="column span6"><div class="sub-header">Merged {{asset_name()}}</div><div customer="customer" input-id="merged-vehicle-picker-input" vehicle="merged_vehicle" vehiclepicker="true"></div></div><div class="column span6"><div class="sub-header">Merged Into:</div><div customer="customer" input-id="selected-vehicle-picker-input" vehicle="selected_vehicle" vehiclepicker="true"></div></div></div><div class="row-fluid"><button class="btn btn-primary" ng-click="merge()">Merge</button><button class="btn" ng-click="hide()">Cancel</button></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_new_stock.html",'<button class="btn btn-primary" id="create-stock-button" ng-click="create_stock()">Create Stock</button><div id="create-stock"><div class="popover fade left in" style="width: 1000px"><div class="popover-title"><div class="sub-header">New stock</div></div><div class="popover-content"><div class="content-box"><div class="row-fluid"><ng-form class="form-horizontal"><div ad-stock-form="true" ng-model="stock"></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_stock()">Save</button><button class="btn" ng-click="cancel()">Cancel</button></div></div></ng-form></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_notes.html",'<ul class="notes"><li ng-repeat="note in notes()"><pre class="no-style editable note" ng-click="edit_note(note)" ng-hide="note.editing"><div class="label label-warning" ng-show="note.office_only">Office Only</div><div class="label label-info" ng-show="note.workshop_only" style="margin-left: 5px">Workshop Only</div><div class="content">{{note.content}}</div><div class="row-fluid"><div class="pull-right"><span class="creator">{{note.creator.name}} {{note.updated_at | date: \'short\'}}</span></div></div></pre><div class="editing-item" ng-show="note.editing"><form name="edit_note_form" novalidate="true"><div ad-saved-texts-button="true" ng-model="note.editing.content"></div><div class="error" ng-show="edit_note_form.content.$invalid">note\'s content is required</div><textarea class="note" name="content" ng-model="note.editing.content" required="true"></textarea><div><label class="checkbox"><input ng-model="note.editing.office_only" type="checkbox" />Office Only</label><label class="checkbox" ng-show="enable_workshop_only"><input ng-model="note.editing.workshop_only" type="checkbox" /><div class="inline"><span>Workshop Only &nbsp;</span><i class="icon icon-info-sign" tooltip="viewable by everyone but not printed on the job card"></i></div></label></div><button class="btn btn-success" ng-click="save_note(edit_note_form, note)"><i class="icon-ok"></i>Save</button><button class="btn" ng-click="cancel_edit_note(note)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="remove_note(note)"><i class="icon-remove"></i>Remove</button></div></form></div></li><li ng-hide="new_note"><a ng-click="add_note()">Add Note</a></li><li ng-show="new_note"><div class="editing-item"><form name="new_note_form" novalidate="true"><div ad-saved-texts-button="true" ng-model="new_note.content"></div><div class="error" ng-show="new_note_form.content.$invalid">note\'s content is required</div><textarea class="note" id="new-note-content-{{new_note_content_id}}" name="content" ng-model="new_note.content" required="true"></textarea><div><label class="checkbox"><input ng-model="new_note.office_only" type="checkbox" />Office Only</label><label class="checkbox" ng-show="enable_workshop_only"><input ng-model="new_note.workshop_only" type="checkbox" /><div class="inline"><span>Workshop Only &nbsp;</span><i class="icon icon-info-sign" tooltip="viewable by everyone but not printed on the job card"></i></div></label></div><button class="btn btn-success" ng-click="save_new_note(new_note_form)"><i class="icon-ok"></i>Save</button><button class="btn" ng-click="cancel_add_note()">Cancel</button></form></div></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_pay_invoice.html",'<div id="pay-popover"><div class="popover fade left in" style="width: 550px"><div class="popover-title"><div class="sub-header">Paying {{job.title}}</div></div><div class="popover-content"><div class="spinner" id="pay-invoice-spinner"></div><div class="row-fluid"><form class="form-horizontal" name="pay_form" novalidate="true"><div class="content-box"><div class="control-group"><label class="control-label">Total Payable</label><div class="controls"><input class="input-small" readonly="true" type="text" value="{{invoice.unpaid_amount + surcharge_charge() |currency}}" /></div></div><div class="control-group" ng-repeat="method in payment_methods()"><label class="control-label">{{method.name}}</label><div class="controls"><input class="input-small" name="method.value" ng-model="payment[method.value].amount" step="any" type="number" />&nbsp;<button class="btn btn-link" ng-click="pay_fully_in(method.value)" type="button">Pay fully</button><span class="error" ng-show="pay_form[method.value].amount.$invalid">Please enter a number</span></div></div><div ng-show="payment.credit.amount &gt; 0 &amp;&amp; surcharge() &gt; 0"><div><label class="inline checkbox" ng-class="{&#39;cross&#39;: payment.waive_surcharge}" style="padding-left: 0px;"><span>+ {{surcharge()}}% surcharge: &nbsp;</span><span class="bold">{{surcharge_amount() | currency}}</span></label><span>&nbsp;&nbsp;&nbsp;</span><label class="inline checkbox"><input ng-model="payment.waive_surcharge" type="checkbox" /><span>&nbsp;Waive</span></label></div><div class="bold" ng-show="surcharge_charge() &gt; 0"><span class="underline">Total: {{payment.credit.amount + surcharge_charge()|currency}}</span></div></div><hr /><div class="control-group"><label class="control-label">Reference</label><div class="controls"><input class="input-small" ng-model="payment.reference" type="text" />&nbsp;</div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="payment.date" type="text"></ad-datepicker>&nbsp;</div></div><div class="control-group" ng-show="show_select_bank_account()"><label class="control-label">Paid To Account</label><div class="controls"><button class="btn btn-link" ng-click="choose_specific_bank_account = true" ng-hide="choose_specific_bank_account">Choose specific bank account</button><div ng-show="choose_specific_bank_account"><div accounts="bank_accounts()" ad-accounting-account-picker="true" ng-model="payment.accounting_account_id"></div></div></div></div><hr /><div class="control-group"><label class="control-label">Paid Total</label><div class="controls"><input class="input-small" readonly="true" type="text" value="{{payment_total()|currency}}" /></div></div><div class="control-group"><label class="control-label">Balance Due</label><div class="controls"><input class="input-small" readonly="true" type="text" value="{{(invoice.unpaid_amount + surcharge_charge()) - payment_total()|currency}}" /></div></div><div ng-switch="tyro_ready()"><div ng-switch-when="true"><div ad-tyro-payment="true"></div></div></div><div ng-switch="payment_express_ready()"><div ng-switch-when="true"><div ad-payment-express="true"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" id="pay-button" ng-click="pay()"><i class="icon-dollar"></i>Pay</button><button class="btn btn-success" ng-click="pay(true)"><i class="icon-dollar"></i>Pay & Print</button><button class="btn" ng-click="hide()">Cancel</button></div></div></div></form></div><div class="spinner" id="pay-invoice-spinner"></div></div></div></div><div id="overpay-popover"><div class="popover fade left in" style="width: 550px"><div class="popover-title"><div class="sub-header">Please Confirm...</div></div><div class="popover-conten"><div class="content-box"><div>Total payment amount is greater than invoice\'s payable amount.</div><br /><div class="buttons"><button class="btn btn-success" ng-click="do_pay()" ng-hide="invoice.finalized">Deposit Full Amount</button><button class="btn btn-info" ng-click="pay_and_give_change()">Pay and give change</button><button class="btn" ng-click="hide()">Cancel</button></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_payment_express.html",'<div ng-show="payment_express_account()"><div class="green" ng-show="enabled()"><div class="inline"><img src="/assets/payment_express-35fcbc9dfa4327091e84368898dd2bdf.png" style="height: 40px;" /></div><div class="inline green">Paired with Terminal ID {{payment_express_tid()}}</div><div class="inline"><button class="btn-link btn" id="payment-express-pairing-button" ng-click="start_payment_express_pairing()">Pair With A Different Terminal</button><span>&nbsp; :: &nbsp;</span><button class="btn-link btn" id="payment-express-pairing-button" ng-click="disable()">Disable</button></div></div><div ng-hide="enabled()"><div class="inline">AAA {{payment_express_tid()}}</div><div class="inline"><img src="/assets/payment_express-35fcbc9dfa4327091e84368898dd2bdf.png" style="height: 40px;" /></div><div class="inline red">{{unavailable_reason()}} &nbsp;</div><div class="inline" ng-show="!payment_express_paired()"><button class="btn" id="payment-express-pairing-button" ng-click="start_payment_express_pairing()">Pair With A Terminal</button></div><div class="inline" ng-show="payment_express_paired()"><button class="btn" id="payment-express-pairing-button" ng-click="enable()">Enable</button></div></div><br /></div><div id="pos-payment-express-dialogue"><div class="popover fade left in" style="width: 500px; z-index:1020;"><div class="popover-title"><div class="sub-header"></div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form style="font-size: 110%"><div class="spinner" id="create-payment-express-invoice-spinner"></div><center><div style="margin-top: 60px"><label class="bold" style="font-size: 60px">{{amount()|currency}}</label></div><br /><br /><div class="green">{{display1()}}</div><div class="green">{{display2()}}</div><div class="red">{{response_code()}}</div><br /><button class="btn" ng-click="click_button(&#39;B1&#39;, button1())" ng-show="button1().length &gt; 0">{{button1()}}</button><button class="btn" ng-click="click_button(&#39;B2&#39;, button2())" ng-show="button2().length &gt; 0">{{button2()}}</button><div class="spinner" id="payment-express-spinner"></div></center></form></div></div><div class="row-fluid"><div class="pull-right"><button class="btn btn-link" ng-click="payment_express_cancel()">CANCEL TRANSACTION</button></div></div></div></div></div><div id="pos-payment-express-pairing"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">payment_express, Pairing with A Terminal</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form class="form form-horizontal" style="font-size: 110%"><div class="control-group"><label class="control-label">Terminal ID</label><div class="controls"><select ng-model="payment_express_pairing_tid" ng-options="terminal for terminal in payment_express_terminals()"></select></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="select_terminal()">Select</button><button class="btn" ng-click="close_payment_express_pairing()">Cancel</button><div class="spinner" id="payment_express-pairing-spinner"></div></div></div></form></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_preference.html",'<span class="editable" ng-click="edit()" ng-hide="editing">{{current_value()|yes_no}}</span><div class="inline" ng-show="editing"><input class="checkbox" ng-model="editing.value" type="checkbox" /><button class="btn btn-small" ng-click="save()">Save</button></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_price_group_form.html",'<form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input id="price-group-name-input" name="name" ng-model="price_group.name" required="true" type="text" /></div></div><div class="control-group"><label class="control-label">Markup 1</label><div class="controls"><div class="inline"><div class="input-append"><input class="input-mini" name="markup_percentage" ng-change="recalculate_margin_percentages()" ng-model="price_group.markup_percentage" step="any" type="number" /><span class="add-on">%</span></div></div><div class="inline"><label class="control-label" style="width: auto; margin-left: 30px; margin-right: 15px;">Margin 1</label><div class="input-append"><input class="input-mini" name="margin_percentage" ng-change="recalculate_markup_percentages()" ng-model="price_group.margin_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><div class="control-group"><label class="control-label">Markup 2</label><div class="controls"><div class="inline"><div class="input-append"><input class="input-mini" name="markup_percentage2" ng-change="recalculate_margin_percentages()" ng-model="price_group.markup_percentage2" step="any" type="number" /><span class="add-on">%</span></div></div><div class="inline"><label class="control-label" style="width: auto; margin-left: 30px; margin-right: 15px;">Margin 2</label><div class="input-append"><input class="input-mini" name="margin_percentage3" ng-change="recalculate_markup_percentages()" ng-model="price_group.margin_percentage2" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><div class="control-group"><label class="control-label">Markup 3</label><div class="controls"><div class="inline"><div class="input-append"><input class="input-mini" name="markup_percentage3" ng-change="recalculate_margin_percentages()" ng-model="price_group.markup_percentage3" step="any" type="number" /><span class="add-on">%</span></div></div><div class="inline"><label class="control-label" style="width: auto; margin-left: 30px; margin-right: 15px;">Margin 3</label><div class="input-append"><input class="input-mini" name="margin_percentage3" ng-change="recalculate_markup_percentages()" ng-model="price_group.margin_percentage3" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><div class="control-group"><label class="control-label">Markup 4</label><div class="controls"><div class="inline"><div class="input-append"><input class="input-mini" name="markup_percentage4" ng-change="recalculate_margin_percentages()" ng-model="price_group.markup_percentage4" step="any" type="number" /><span class="add-on">%</span></div></div><div class="inline"><label class="control-label" style="width: auto; margin-left: 30px; margin-right: 15px;">Margin 4</label><div class="input-append"><input class="input-mini" name="margin_percentage3" ng-change="recalculate_markup_percentages()" ng-model="price_group.margin_percentage4" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><div class="control-group"><label class="control-label">Markup 5</label><div class="controls"><div class="inline"><div class="input-append"><input class="input-mini" name="markup_percentage5" ng-change="recalculate_margin_percentages()" ng-model="price_group.markup_percentage5" step="any" type="number" /><span class="add-on">%</span></div></div><div class="inline"><label class="control-label" style="width: auto; margin-left: 30px; margin-right: 15px;">Margin 5</label><div class="input-append"><input class="input-mini" name="margin_percentage3" ng-change="recalculate_markup_percentages()" ng-model="price_group.margin_percentage5" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><div class="control-group"><label class="control-label">Markup 6</label><div class="controls"><div class="inline"><div class="input-append"><input class="input-mini" name="markup_percentage6" ng-change="recalculate_margin_percentages()" ng-model="price_group.markup_percentage6" step="any" type="number" /><span class="add-on">%</span></div></div><div class="inline"><label class="control-label" style="width: auto; margin-left: 30px; margin-right: 15px;">Margin 6</label><div class="input-append"><input class="input-mini" name="margin_percentage3" ng-change="recalculate_markup_percentages()" ng-model="price_group.margin_percentage6" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><div class="control-group"><label class="control-label">Markup 7</label><div class="controls"><div class="inline"><div class="input-append"><input class="input-mini" name="markup_percentage7" ng-change="recalculate_margin_percentages()" ng-model="price_group.markup_percentage7" step="any" type="number" /><span class="add-on">%</span></div></div><div class="inline"><label class="control-label" style="width: auto; margin-left: 30px; margin-right: 15px;">Margin 7</label><div class="input-append"><input class="input-mini" name="margin_percentage3" ng-change="recalculate_markup_percentages()" ng-model="price_group.margin_percentage7" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><br /><br /><div class="control-group"><label class="control-label">&nbsp;</label><div class="controls"><button class="btn btn-success" ng-click="save_price_group()" type="button">Save</button><button class="btn" ng-click="cancel_price_group()" type="button">Cancel</button><div class="spinner" id="price-group-spinner"></div></div></div></form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_pricing_plans.html",'<div id="change-pricing-plan"><div class="popover fade left in" style="width: 1200px"><div class="popover-title"><div class="pull-right"><i class="goto icon-remove" ng-click="hide()"></i></div><div class="sub-header">Select Your Plan</div></div><div class="popover-content"><div class="row-fluid"><div class="pricing-plan"><center><div class="inline" ng-repeat="plan in pricing_plans()"><div class="inline" style="margin-left: 5px"><div class="well pricing-plan-block"><div class="pricing-plan-name"><span style="color: {{plan.color}}">{{plan.name}}</span></div><div class="pricing-plan-subscription"><span class="bold" ng-bind-html-unsafe="plan.display_subscription_price"></span></div><div class="pricing-plan-users"><span ng-bind-html-unsafe="show_users(plan)"></span></div><div class="pricing-plan-additional-user-price"><span ng-bind-html-unsafe="plan.display_additional_user_price"></span></div><div class="pricing-plan-sms-price"><span ng-bind-html-unsafe="plan.display_sms_price"></span></div><div class="pricing-plan-select"><button class="btn btn-success" ng-click="select_plan(plan)">Select</button></div></div></div></div><br /><br /><div>* Price is exclusive of txts (SMS).</div><br /><br /><div class="row-fluid"><center><button class="btn btn-primary" ng-click="hide()" style="width: 300px">Close</button></center></div></center></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_process_purchase_order.html",'<div id="process-purchase-order-popover"><div class="popover fade left in" style="width: 550px"><div class="popover-title"><div class="sub-header">Process Purchase Order #{{purchase.number}}</div></div><div class="popover-content"><div class="row-fluid"><form class="form-horizontal" name="process_purchase_order_form" novalidate="true"><div class="content-box"><table class="table table-striped"><thead><tr><th>Item</th><th>Receipt Quantity</th></tr></thead><tbody><tr ng-repeat="item in purchase_items"><td>{{item.description}}</td><td><input class="input-small text-align-right" ng-model="item.quantity" /></td></tr></tbody></table></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="process()">Process</button><button class="btn" ng-click="hide()">Cancel</button><div class="spinner" id="process-purchase-order-spinner"></div></div></div></form></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_purchase.html",'<div class="row-fluid"><div class="column span6"><div class="editable" ng-click="edit_purchase()" ng-hide="purchase.editing"><div class="info"><label class="label-name-left auto-width">Title:</label><span class="bold">{{purchase.title}}</span></div><div class="info"><label class="label-name-left auto-width">Order Number:</label><span>{{purchase.number}}</span></div><div class="info"><label class="label-name-left auto-width">Supplier:</label><span>{{purchase.supplier.name}}</span></div><div class="info"><label class="label-name-left auto-width">Supplier Phone:</label><span>{{purchase.supplier.mobile || purchase.supplier.phone}}</span></div><div class="info"><label class="label-name-left auto-width">Created By:</label><span>{{purchase.employee.name}}</span></div><div class="info"><label class="label-name-left auto-width">Created At:</label><span>{{purchase.created_at|date: \'medium\'}}</span></div><div class="info" ng-show="purchase.creditor_id"><label class="label-name-left auto-width">Creditor/Buying Group:</label><span>{{purchase.creditor.name}}</span></div><div class="info"><label class="label-name-left auto-width">Order Date:</label><span>{{purchase.date | date: \'mediumDate\'}}</span></div><div class="info"><label class="label-name-left auto-width">Due Date:</label><span>{{purchase.due_date | date: \'mediumDate\'}}</span></div><div class="info"><label class="label-name-left auto-width">Total:</label><span class="bold">{{purchase.total_amount|zero_as_na}}</span></div><div class="info" ng-show="purchase.reference"><label class="label-name-left auto-width">Reference:</label><span>{{purchase.reference}}</span></div><div class="info" ng-show="enable_tracking_category_selection()"><label class="label-name-left auto-width">Tracking Categories</label><div class="inline" style="min-width: 40px;">{{purchase.tracking_categories|comma_seperated: \'option\'}}</div></div><div class="info"><label class="label-name-left auto-width">Status:</label><span class="label" ng-class="{&#39;label-success&#39;: purchase.status == &#39;paid&#39; || purchase.status == &#39;billed&#39; || purchase.status == &#39;processed&#39;}">{{purchase.status}}</span></div><div class="info" ng-show="purchase.processed_by"><label class="label-name-left auto-width">Processed By:</label><span>{{purchase.processed_by.name}}</span></div><div class="info" ng-show="purchase.processed_by"><label class="label-name-left auto-width">Processed At:</label><span>{{purchase.processed_at|date}} &nbsp;</span><span>{{purchase.processed_at|date: \'mediumTime\'}}</span></div></div></div><div class="column span6" ng-show="purchase.back_orders.length &gt; 0"><div class="sub-header">Back Orders</div><table class="table table-striped"><tbody><tr class="goto" ng-click="open(bo)" ng-repeat="bo in purchase.back_orders"><td><span>#{{bo.number}}</span></td><td><span class="label label-info" ng-show="bo.status != &#39;pending&#39; &amp;&amp; bo.status != &#39;processed&#39;">{{bo.status}}</span><span class="label label-success" ng-show="bo.status == &#39;processed&#39;">{{bo.status}}</span><span class="label" ng-show="bo.status == &#39;pending&#39;">{{bo.status}}</span></td></tr></tbody></table></div><div class="column span6" ng-show="purchase.original_purchase"><div class="sub-header">Original Purchase Order</div><table class="table table-striped"><tbody><tr class="goto" ng-click="open(purchase.original_purchase)"><td><span>#{{purchase.original_purchase.number}}</span></td><td><span class="label label-info" ng-show="purchase.original_purchase.status != &#39;pending&#39; &amp;&amp; purchase.original_purchase.status != &#39;processed&#39;">{{purchase.original_purchase.status}}</span><span class="label label-success" ng-show="purchase.original_purchase.status == &#39;processed&#39;">{{purchase.original_purchase.status}}</span><span class="label" ng-show="purchase.original_purchase.status == &#39;pending&#39;">{{purchase.original_purchase.status}}</span></td></tr></tbody></table></div></div><div class="editing-item" ng-show="purchase.editing"><form autocomplete="off" class="form-horizontal"><div class="control-group"><label class="control-label">Title</label><div class="controls"><select ng-model="purchase.editing.title"><option value="Purchase Order">Purchase Order</option><option value="Price And Availability Request">Price And Availability Request</option></select></div></div><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><div ng-model="purchase.editing.supplier_id" supplier="purchase.editing.supplier" supplierpicker="true"></div></div></div><div class="control-group"><label class="control-label">Creditor/Buying Group</label><div class="controls"><div creditorpicker="true" ng-model="purchase.editing.creditor_id"></div></div></div><div class="control-group"><label class="control-label">Order Date</label><div class="controls"><ad-datepicker ng-model="purchase.editing.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Due Date</label><div class="controls"><ad-datepicker ng-model="purchase.editing.due_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><input ng-model="purchase.editing.reference" type="text" /></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="true" ng-model="purchase.editing"></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_purchase()">Save</button><button class="btn" ng-click="cancel_edit_purchase()">Cancel</button></div></div></form></div><hr /><div class="cost-table" id="purchase-item-list"><div class="header"><div class="description">Name</div><div class="quantity">Qty.</div><div class="rate">Unit Price</div><div class="total">Total</div></div><div class="cost" id="purchase-item-{{purchase_item.id}}" ng-hide="purchase_item.editing" ng-repeat="purchase_item in purchase.purchase_items"><div class="editable" ng-click="edit_purchase_item(purchase_item)" ng-hide="purchase_item.editing" tooltip="{{purchase_item.note}}"><div class="description"><div><span class="label label-info" ng-show="purchase_item.is_buyin">B</span><span>{{purchase_item.description}}</span></div><div ng-show="purchase_item.supplier_stock_number"><span>Supplier Stock No. {{purchase_item.supplier_stock_number}}</span></div></div><div class="quantity">{{purchase_item.quantity}}</div><div class="rate">{{purchase_item.unit_price|zero_as_na}}</div><div class="total">{{purchase_item_total(purchase_item) | zero_as_na}}</div><div class="included-gst"><div class="pull-right"><span ng-show="purchase_item.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="purchase_item.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span></div></div></div></div><div class="cost" id="editing-purchase-item" ng-show="editing_purchase_item"><div class="editing-item"><form autocomplete="off" name="edit_purchase_item_form" novalidate="true"><div class="error" ng-show="edit_purchase_item_form.description.$error.required">description is required</div><div class="error" ng-show="edit_purchase_item_form.description.$error.maxlength">description\'s max length is 255 characters</div><div class="error" ng-show="edit_purchase_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="edit_purchase_item_form.unit_price.$invalid">unit price must be a number</div><div class="row-flluid"><div class="description"><div ad-invoice-item-input="true" ng-model="editing_purchase_item.editing" purchase="purchase"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-model="editing_purchase_item.editing.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-model="editing_purchase_item.editing.unit_price" required="true" step="any" type="number" /></div><div class="total"><input class="input-mini" readonly="true" step="any" type="number" value="{{purchase_item_total(editing_purchase_item.editing)}}" /></div><div class="included-gst"><div class="pull-right"><div><label class="checkbox"><input ng-click="update_buyin_price(editing_purchase_item.editing)" ng-model="editing_purchase_item.editing.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-click="update_buyin_price(editing_purchase_item.editing)" ng-model="editing_purchase_item.editing.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div></div><div class="row-fluid"><div><div class="inline"><label class="checkbox"><input ng-click="update_buyin_price(editing_purchase_item.editing)" ng-model="editing_purchase_item.editing.is_buyin" type="checkbox" /><span>Is Buyin Item</span></label></div><div class="inline" ng-show="editing_purchase_item.editing.is_buyin" style="margin-left: 20px"><label class="checkbox"><input ng-click="unset_sell_price(editing_purchase_item.editing)" ng-model="editing_purchase_item.editing.is_non_charge" type="checkbox" /><span>No charge</span></label></div></div><div ng-show="editing_purchase_item.editing.is_buyin"><div><label class="inline" style="width: 120px">Sell Price</label><input class="input-small" ng-change="reset_markup_percentage(editing_purchase_item)" ng-model="editing_purchase_item.editing.sell_price" ng-readonly="editing_purchase_item.editing.is_non_charge" step="any" type="number" /><span ng-show="markup_percentages(editing_purchase_item.editing, true).length &gt; 0" style="font-size: 90%"><span>&nbsp;Markup:</span> <div class="inline" ng-repeat="percentage in markup_percentages(editing_purchase_item.editing, true)"><button class="btn btn-link" ng-class="{&#39;selected-percentage&#39;: percentage == editing_purchase_item.editing.markup_percentage}" ng-click="update_buyin_price(editing_purchase_item.editing, percentage)" style="font-size: 90%" type="button">{{percentage}}%</button><span>&nbsp;::&nbsp;</span></div><button class="btn btn-link" ng-click="unset_sell_price(editing_purchase_item.editing)" type="button">Unset</button></span></div><div ng-show="editing_purchase_item.unit_price != editing_purchase_item.editing.unit_price &amp;&amp; editing_purchase_item.sell_price == editing_purchase_item.editing.sell_price"><div class="warning inline underline">Buy price is updated, Do you want to update the sell price?</div><button class="btn btn-link" ng-click="update_buyin_price(editing_purchase_item.editing)">Update Sell Price</button><br /><br /></div><div><label class="inline" style="width: 120px">Warranty</label><ad-datepicker ng-model="editing_purchase_item.editing.warranty_expiry_date"></ad-datepicker><div><label class="inline" style="width: 120px">Allocate To Job</label><ad-jobpicker job="editing_purchase_item.editing.job" ng-model="editing_purchase_item.editing.job_id" readonly="job"></ad-jobpicker></div><div class="row-fluid"><label class="inline" style="width: 120px">Note</label><input class="inline" ng-model="editing_purchase_item.editing.note" style="width: 400px" type="text" /></div></div></div></div><br /><div class="button-panel"><button class="btn btn-success" ng-click="save_purchase_item(edit_purchase_item_form, editing_purchase_item)">Save</button><button class="btn" ng-click="cancel_edit_purchase_item(editing_purchase_item)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="remove_purchase_item(editing_purchase_item)">Remove</button></div></div></form></div></div><div ng-hide="new_purchase_item"><a href="javascript: void(0);" id="new-purchase-item-button" ng-click="add_purchase_item()">Add Item</a><div class="inline" ng-show="job.invoice.items"><span>&nbsp;::&nbsp;</span><button class="btn btn-link" id="select-invoice-items-button" ng-click="select_from_invoice_items()">Select From Invoice Items</button></div><div class="inline" ng-show="repco_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-repco-button" ng-click="add_items_from_repco(repco_account())"><img src="/assets/repco_navigator-8e21ef0b294533a128d4feada69c8241.png" style="height: 20px;" /></a></div><div ad-ezy-parts="true" class="inline" on-update="oscar_success()" purchase="purchase"></div><div class="inline" ng-show="quantum_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-quantum-button" ng-click="add_items_from_repco(quantum_account())"><img src="/assets/quantum_pro-5e21beca4f69abf19b557f26df4871f2.png" style="height: 20px;" /></a></div><div class="inline" ng-show="pro_link_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-pro_link-button" ng-click="add_items_from_repco(pro_link_account())"><img src="/assets/pro_link-ed0e9bca251211f98062a43051fa0baf.png" style="height: 20px;" /></a></div><div class="inline" ng-show="motospecs_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-motospecs-button" ng-click="add_items_from_repco(motospecs_account())"><img src="/assets/motospecs-a9a4edc7104b920de0eeb485620ff60b.jpg" style="height: 30px;" /></a></div></div><div class="purchase_item" ng-show="new_purchase_item"><form autocomplete="off" name="new_purchase_item_form" novalidate="true"><div class="editing-item"><div class="error" ng-show="new_purchase_item_form.description.$error.required">description is required</div><div class="error" ng-show="new_purchase_item_form.description.$error.maxlength">description\'s max length is 255 characters</div><div class="error" ng-show="new_purchase_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="new_purchase_item_form.unit_price.$invalid">unit price must be a number</div><div class="row-fluid"><div class="description"><div ad-invoice-item-input="true" input-id="new-purchase-item-description" ng-model="new_purchase_item" purchase="purchase"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-model="new_purchase_item.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-change="update_buyin_price(new_purchase_item)" ng-model="new_purchase_item.unit_price" required="true" step="any" type="number" /></div><div class="total"><input class="input-mini" readonly="true" step="any" type="number" value="{{purchase_item_total(new_purchase_item)}}" /></div><div class="included-gst"><div class="pull-right"><div><label class="checkbox"><input ng-click="update_buyin_price(new_purchase_item)" ng-model="new_purchase_item.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-click="update_buyin_price(new_purchasee_item)" ng-model="new_purchase_item.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div></div><div class="row-fluid"><div class="pull-left"><div><div class="inline"><label class="checkbox"><input ng-click="update_buyin_price(new_purchase_item)" ng-model="new_purchase_item.is_buyin" type="checkbox" /><span>Is Buyin Item</span></label></div><div class="inline" ng-show="new_purchase_item.is_buyin" style="margin-left: 20px"><label class="checkbox"><input ng-click="unset_sell_price(new_purchase_item)" ng-model="new_purchase_item.is_non_charge" type="checkbox" /><span>No charge</span></label></div></div><div ng-show="new_purchase_item.is_buyin"><div><label class="inline" style="width: 120px">Sell Price</label><input class="input-small" ng-change="reset_markup_percentage(new_purchase_item)" ng-model="new_purchase_item.sell_price" ng-readonly="new_purchase_item.is_non_charge" step="any" type="number" /><span ng-show="markup_percentages(new_purchase_item, true).length &gt; 0" style="font-size: 90%"><span>&nbsp;Markup:</span> <div class="inline" ng-repeat="percentage in markup_percentages(new_purchase_item, true)"><button class="btn btn-link" ng-class="{&#39;selected-percentage&#39;: percentage == new_purchase_item.markup_percentage}" ng-click="update_buyin_price(new_purchase_item, percentage)" type="button">{{percentage}}%</button><span>&nbsp;::&nbsp;</span></div><button class="btn btn-link" ng-click="unset_sell_price(new_purchase_item)" type="button">Unset</button></span></div><div><label class="inline" style="width: 120px">Warranty</label><ad-datepicker ng-model="new_purchase_item.warranty_expiry_date"></ad-datepicker></div><div><label class="inline" style="width: 120px">Allocate To Job</label><ad-jobpicker job="new_purchase_item.job" ng-model="new_purchase_item.job_id" readonly="job"></ad-jobpicker></div><div><label class="inline" style="width: 120px">Note</label><input class="inline" ng-model="new_purchase_item.note" style="width: 400px" type="text" /></div></div></div></div><br /><br /><div><button class="btn btn-success" ng-click="save_new_purchase_item()">Save</button><button class="btn" ng-click="cancel_add_purchase_item()">Cancel</button><div class="pull-right"><div ad-new-stock="true" generic-item="new_purchase_item" is-a-purchase="true" ng-model="new_stock" on-save="select_new_stock()"></div></div></div></div></form></div><div class="summary" ng-show="purchase.purchase_items.length &gt; 0"><div><div class="title">Total</div><div class="value">{{purchase.total_amount | zero_as_na}}</div></div></div><hr class="divider" /><div class="sub-header">Note To Supplier<div class="pull-right"><button class="btn btn-link" ng-click="edit_purchase_description()">Edit Note</button></div></div><div class="editable note" ng-click="edit_purchase_description()" ng-hide="purchase.editing_description"><pre class="no-style" ng-show="purchase.description">{{purchase.description}}</pre></div><div class="editing-item" ng-show="purchase.editing_description"><textarea class="span12" id="edit-purchase-description" ng-model="purchase.editing_description.description"></textarea><button class="btn btn-primary" ng-click="save_purchase_description()">Save</button><button class="btn btn-danger" ng-click="clear_purchase_description()">Remove</button><button class="btn" ng-click="cancel_edit_purchase_description()">Cancel</button></div></div><div id="purchase-invoice-items-selection"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header"><span>Select Invoice Items</span></div></div><div class="popover-content"><button class="btn btn-link" ng-click="select_all_invoice_items()">Select All</button><div class="content-box"><div class="row-fluid"><div class="pointer" ng-class="{&#39;invoice-item-selected&#39;: item.selected}" ng-click="toggle_select_invoice_item(item)" ng-repeat="item in invoice_items" style="padding: 3px; margin-bottom: 3px"><div class="inline" ng-show="item.linked_supplier"><span class="label label-info linked-supplier" ng-class="{&#39;linked-repco&#39;: item.linked_supplier==&#39;repco&#39;, &#39;linked-burson&#39;: item.linked_supplier==&#39;burson&#39;}">{{item.linked_supplier}}</span><span>&nbsp;</span></div><span>{{item.description}}</span><span ng-show="item.quantity &gt; 1">&nbsp; x {{item.quantity}}</span><span ng-show="item.buy_price"> &nbsp; at {{iem.buy_price}}/each</span><span ng-show="item.sku">&nbsp;(sku: {{item.sku}})</span></div></div></div><div class="action-buttons"><button class="btn btn-success" ng-click="confirm_invoice_item_selection()">Select</button><button class="btn btn" ng-click="close_select_from_invoice_items()">Cancel</button></div></div></div></div><div id="purchase-invoice-items-confirmation"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header"><span>Add Invoice Items</span></div></div><div class="popover-content"><div class="content-box"><div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Unit Price</div><div class="total">Total</div></div><div class="cost" ng-repeat="purchase_item in purchase.from_invoice_items" style="border-bottom: none"><hr /><ng-form autocomplete="off" name="from_invoice_items_form" novalidate="true"><div class="error" ng-show="from_invoice_items_form.description.$error.required">description is required</div><div class="error" ng-show="from_invoice_items_formdescription.$error.maxlength">description\'s max length is 255 characters</div><div class="error" ng-show="from_invoice_items_formquantity.$invalid">quantity must be a number</div><div class="error" ng-show="from_invoice_items_formunit_price.$invalid">unit price must be a number</div><div class="row-fluid"><div class="description" ng-class="{&#39;new-item&#39;: purchase_item.new}"><div class="inline" style="margin-right: 10px"><i class="icon icon-remove red pointer" ng-click="remove_purchase_item(purchase_item)"></i></div><div class="inline" style="width: 90%"><div ad-invoice-item-input="true" ng-model="purchase_item" purchase="purchase"></div></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-model="purchase_item.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-change="update_buyin_price(purchase_item)" ng-model="purchase_item.unit_price" required="true" step="any" type="number" /></div><div class="total"><input class="input-mini" readonly="true" step="any" type="number" value="{{purchase_item_total(purchase_item)}}" /></div><div class="inline" style="padding-left: 10px"><label class="checkbox"><input ng-click="update_buyin_price(purchase_item)" ng-model="purchase_item.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div></div><br /><div class="row-fluid"><div class="pull-left"><div><label class="checkbox"><input ng-click="update_buyin_price(purchase_item)" ng-model="purchase_item.is_buyin" type="checkbox" /><span>Is Buyin Item</span></label></div><div ng-show="purchase_item.is_buyin"><div><label class="inline" style="width: 100px">Sell Price</label><input class="input-small" ng-change="reset_markup_percentage(purchase_item)" ng-model="purchase_item.sell_price" step="any" type="number" /><span ng-show="markup_percentages(purchase_item, true).length &gt; 0" style="font-size: 90%"><span>&nbsp;Markup:</span> <div class="inline" ng-repeat="percentage in markup_percentages(purchase_item, true)"><button class="btn btn-link" ng-class="{&#39;selected-percentage&#39;: percentage == purchase_item.markup_percentage}" ng-click="update_buyin_price(purchase_item, percentage)" style="font-size: 90%" type="button">{{percentage}}%</button><span>&nbsp;::&nbsp;</span></div><button class="btn btn-link" ng-click="unset_sell_price(purchase_item)" type="button">Unset</button></span></div><div><label class="inline" style="width: 100px">Warranty</label><ad-datepicker ng-model="purchase_item.warranty_expiry_date"></ad-datepicker></div></div></div></div></ng-form></div></div></div><br /><br /><div class="action-buttons"><button class="btn btn-success" ng-click="add_invoice_item_selection()">Add</button><button class="btn btn" ng-click="close_select_from_invoice_items()">Cancel</button><div class="spinner" id="add-invoice-item-spinner"></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_purchase_history.html",'<div id="purchase-history-spinner"></div><table class="table table-striped"><thead><tr><th>Date</th><th>Reference</th><th>Description</th><th>Qty.</th><th>Unit Price</th><th>Total</th><th>Supplier</th><th>Status</th></tr></thead><tbody><tr class="goto" ng-click="goto(item)" ng-repeat="item in bill_items"><td>{{item.created_at|date: \'mediumDate\'}}</td><td><span ng-show="item.supplier_credit_note">Supplier Credit Note #{{item.supplier_credit_note.reference}}</span><span ng-show="item.bill">Bill #{{item.bill.reference}}</span></td><td>{{item.description}}</td><td>{{item.quantity}}</td><td>{{item.unit_price_exclude_gst|currency}}</td><td>{{item.total_amount|currency}}</td><td>{{item.supplier.name}}</td><td><div ng-show="item.supplier_credit_note"><label class="label label-info" ng-show="!item.finalized">Allocated</label></div></td></tr></tbody></table><br /><pagination boundary-links="true" current-page="page_number" max-size="8" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_purchase_order_bill_form.html",'<div id="purchase-bill-popover"><div class="popover fade right in" style="width: 600px"><div class="popover-title"><div class="page-header">Purchase Order Bill</div></div><div class="popover-content"><div class="content-box"><div class="row-fluid"><form class="form-horizontal"><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><supplierpicker ng-model="bill.supplier_id" supplier="bill.supplier"></supplierpicker></div></div><div class="control-group"><label class="control-label">Creditor/Buying Group</label><div class="controls"><div creditorpicker="true" ng-model="bill.billing_supplier_id"></div></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><input ng-model="bill.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="bill.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Due Date</label><div class="controls"><ad-datepicker ng-model="bill.due_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><input class="input-small" ng-model="bill.total_amount" type="text" /></div></div><div class="control-group" ng-hide="restricted_to_finalize_documents()"><label class="control-label">Finalized</label><div class="controls"><input class="checkbox" ng-model="bill.finalized" type="checkbox" /></div></div><div class="control-group" ng-show="purchase"><label class="control-label">Purchase Order</label><div class="controls"><div>#{{purchase.number}}</div><div><span class="bold">Supplier:</span> <span>{{purchase.supplier.name}}</span></div><div class="bold">Items:</div><div ng-repeat="item in purchase.purchase_items">{{item.description}}</div></div></div><div class="control-group"><label class="control-label">Expense/Purchase Account</label><div class="controls"><div accounts="input_accounts" ad-accounting-account-picker="true" ng-model="bill.accounting_account_id"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="bill"></div></div><br /><br /><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save()">Continue</button><button class="btn" ng-click="cancel()">Cancel</button></div></div></form></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_purchase_order_form.html",'<form autocomplete="off" class="form-horizontal"><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><div ng-model="purchase.supplier_id" supplier="purchase.supplier" supplierpicker="true"></div></div></div><div class="control-group"><label class="control-label">Creditor/Buying Group</label><div class="controls"><div creditorpicker="true" ng-model="purchase.creditor_id"></div></div></div><div class="control-group"><label class="control-label">Order Date</label><div class="controls"><ad-datepicker ng-model="purchase.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Due Date</label><div class="controls"><ad-datepicker ng-model="purchase.due_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><input ng-model="purchase.reference" type="text" /><span>&nbsp;(auto generated if left blank)</span></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="purchase"></div></div><div class="control-group"><label class="control-label">Title</label><div class="controls"><select ng-model="purchase.title"><option value="Purchase Order">Purchase Order</option><option value="Price And Availability Request">Price And Availability Request</option></select></div></div><br /><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save()">Continue</button><button class="btn" ng-click="cancel()">Cancel</button><div class="spinner" id="create-purchase-order-spinner"></div></div></div></form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_purchase_order_selection.html",'<div id="purchase-order-selection"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{supplier.name}}\'s current purchase orders</div></div><div class="popover-content"><div class="content-box"><div class="spinner" id="purchase-order-selection-spinner"></div><table class="table table-striped"><thead></thead><tbody><tr ng-repeat="purchase in purchases"><td><div ng-class="{&#39;purchase-order-selected&#39;: purchase.selected}"><div class="row-fluid"><div class="column span2"><div class="buttons"><button class="btn btn-link" ng-click="select(purchase)" ng-hide="purchase.selected">Select</button><button class="btn btn-link" ng-click="deselect(purchase)" ng-show="purchase.selected">Unselect</button></div></div><div class="column span4"><div><span class="label-name-left auto-width">Purchase No#:</span><span>{{purchase.number}}</span></div><div></div><span class="label-name-left auto-width">Date:</span><span>{{purchase.date|date: \'mediumDate\'}}</span></div><div class="column span6"><div class="pull-right"><button class="btn btn-link" ng-click="show_items(purchase)" ng-hide="purchase.show_items">Show Items</button><button class="btn btn-link" ng-click="hide_items(purchase)" ng-show="purchase.show_items">Hide Items</button></div><div><span class="label-name-left auto-width">Total:</span><span class="bold">{{purchase.total_amount|currency}}</span></div></div></div><div class="row-fluid" ng-show="purchase.show_items"><br /><table class="table"><thead><tr><td class="bold">Name</td><td class="bold">Quantity</td><td class="bold">Price</td><td class="bold">Total</td></tr></thead><tbody><tr ng-repeat="item in purchase.purchase_items"><td>{{item.description}}</td><td>{{item.quantity}}</td><td>{{item.unit_price|currency}}</td><td>{{item.total_amount|currency}}</td></tr></tbody></table></div></div></td></tr></tbody></table><br /></div><div class="buttons"><button class="btn btn-success" ng-click="do_select()">Select</button><button class="btn" ng-click="hide()">Cancel</button></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_put_on_hold.html",'<div id="put-on-hold-dialog"><div class="popover fade left in" style="width: 400px"><div class="popover-title"><div class="sub-header">Put this job on hold</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form><label class="bold">Reason</label><textarea class="span12" id="put-on-hold-reason" ng-model="on_hold_reason"></textarea><br /><label class="radio"><input name="on_hold_reason" ng-model="on_hold_reason" type="radio" value="Waiting on parts" />Waiting on parts</label><label class="radio"><input name="on_hold_reason" ng-model="on_hold_reason" type="radio" value="Waiting on order number" />Waiting on order number</label><label class="radio"><input name="on_hold_reason" ng-model="on_hold_reason" type="radio" value="Waiting on purchase order" />Waiting on purchase order</label><label class="radio"><input name="on_hold_reason" ng-model="on_hold_reason" type="radio" value="Waiting on customer confirmation" />Waiting on customer confirmation</label><label class="radio"><input name="on_hold_reason" ng-model="on_hold_reason" type="radio" value="Waiting for customer to book in" />Waiting for customer to book in</label><label class="radio"><input name="on_hold_reason" ng-model="on_hold_reason" type="radio" value="Customer missed appointment" />Customer missed appointment</label><br /><br /><div class="button-panel"><button class="btn btn-success" ng-click="put_on_hold()">Save</button><button class="btn" ng-click="cancel()">Cancel</button></div></form></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_quote.html",'<div class="cost-table" id="ad-quote"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Rate</div><div class="total">Total</div></div><ul class="quote-items" id="quote-item-list" ng-model="quote.quote_items" ui-sortable="quote_item_sortable_options"><li class="cost" id="quote-item-{{item.id}}" ng-hide="item.editing" ng-repeat="item in quote.quote_items"><div ng-show="item.header"><div class="editable" ng-click="edit_item(item)"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline" ng-show="item.saving"><img src="/assets/littlespinner-b053f26fde4de42a09c6c20272ce08ba.gif" /></div><div class="inline"><pre class="no-style bold">{{item.details}}</pre></div></div></div><div ng-hide="item.header"><div class="editable" ng-click="edit_item(item)"><div class="description"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline" ng-show="item.saving"><img src="/assets/littlespinner-b053f26fde4de42a09c6c20272ce08ba.gif" /></div><div class="inline" ng-show="item.linked_supplier == &#39;repco&#39;"><span class="red" tooltip="Repco item">R &nbsp;</span></div><div class="inline" ng-show="item.linked_supplier == &#39;ashdown ingram&#39;"><span class="red" tooltip="Ashdown Ingram item">A &nbsp;</span></div><div class="inline">{{item.description}}</div><button class="btn btn-link" ng-click="show_item_details(item)" ng-show="item.details &amp;&amp; !item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button><button class="btn btn-link" ng-click="hide_item_details(item)" ng-show="item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button></div><div class="quantity">{{item.quantity}}</div><div class="rate">{{item.unit_price|currency}}</div><div class="total">{{item_total(item) | currency}}</div><div class="included-gst" ng-hide="quote.not_registered_for_gst"><span ng-show="item.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="item.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span><div ng-show="item.discount_percentage &gt; 0"><span>&nbsp; (disc.&nbsp;{{item.discount_percentage}}%)</span></div></div><div class="details" ng-show="item.show_details"><pre class="no-style">{{item.details}}</pre></div></div></div></li><li id="editing-quote-item" ng-show="editing_quote_item"><div class="editing-item" ng-show="editing_quote_item.header &amp;&amp; editing_quote_item.editing"><form autocomplete="off" name="edit_item_header_form" novalidate="true"><div ad-saved-texts-button="true" ng-model="editing_quote_item.editing.details" quote="quote"></div><textarea auto-rows="15" class="span12" id="edit-invoice-item-header-description" name="description" ng-model="editing_quote_item.editing.details"></textarea><br /><div ng-show="editing_quote_item.editing.confirm_deletion"><label class="checkbox"><input ng-model="editing_quote_item.editing.delete_children" type="checkbox" />Also Remove items within this header</label></div><br /><div><button class="btn btn-success" ng-click="save_item(edit_item_header_form, editing_quote_item)">Save</button><button class="btn" ng-click="cancel_edit_item(editing_quote_item)">Cancel</button><button class="btn btn-danger" ng-click="remove_item(editing_quote_item)">Delete</button></div></form></div><div class="editing-item" ng-show="!editing_quote_item.header &amp;&amp; editing_quote_item.editing"><form autocomplete="off" name="edit_item_form" novalidate="true"><div class="error" ng-show="edit_item_form.description.$invalid">description is required</div><div class="error" ng-show="edit_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="edit_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" customer="customer()" ng-model="editing_quote_item.editing"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-model="editing_quote_item.editing.quantity" required="true" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-model="editing_quote_item.editing.unit_price" required="true" type="number" /><div ng-show="editing_quote_item.editing.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices</span> <i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in editing_quote_item.editing.prices"><a href="javascript:void(0);" ng-click="select_price_level(editing_quote_item.editing, price)"><span>{{price|currency}}</span></a></li></ul></div></div><div><span>Discount</span><div><div class="input-append"><input class="input-mini" ng-model="editing_quote_item.editing.discount_percentage" step="any" type="number" /><span class="add-on">%</span></div></div><div ng-show="editing_quote_item.editing.discount_percentage &gt; 100"><span class="error">Maximum: 100%</span></div></div></div><div class="total"><input class="input-mini" readonly="true" value="{{item_total(editing_quote_item.editing)}}" /></div><div class="pull-right" ng-show="editing_quote_item.stock_id"><a href="javascript:void(0)" ng-click="show_stock(editing_quote_item)"><i class="icon icon-info"></i><span>Info</span></a></div><div><div class="row-fluid"><a ng-click="edit_item_details(editing_quote_item.editing)" ng-hide="editing_quote_item.details || editing_quote_item.editing.edit_details">More Details</a><div class="pull-right" ng-hide="quote.not_registered_for_gst"><div><label class="checkbox"><input ng-model="editing_quote_item.editing.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="editing_quote_item.editing.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><div class="details" ng-show="editing_quote_item.details || editing_quote_item.editing.edit_details"><div ad-saved-texts-button="true" ng-model="editing_quote_item.editing.details" quote="quote"></div><textarea auto-rows="15" ng-model="editing_quote_item.editing.details" style="width: 95%;"></textarea></div><br /><br /></div><div><button class="btn btn-success" ng-click="save_item(edit_item_form, editing_quote_item)">Save</button><button class="btn btn-danger" ng-click="remove_item(editing_quote_item)">Remove</button><button class="btn" ng-click="cancel_edit_item(editing_quote_item)">Cancel</button></div></form></div></li></ul><div ng-hide="new_item"><a href="javascript: void(0);" id="add-item-button" ng-click="add_item()"> <span>+ Item</span></a><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-header-button" ng-click="add_header()"> <span>+ Header</span></a><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-job-types-button" ng-click="add_job_types()"> <span>+ Job types</span></a><div class="inline" ng-show="repco_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-job-types-button" ng-click="add_items_from_repco(repco_account())"><img src="/assets/repco_navigator-8e21ef0b294533a128d4feada69c8241.png" style="height: 20px;" /></a></div><div ad-ezy-parts="true" class="inline" on-update="repco_success()" quote="quote"></div><div class="inline" ng-show="quantum_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-job-types-button" ng-click="add_items_from_repco(quantum_account())"><img src="/assets/quantum_pro-5e21beca4f69abf19b557f26df4871f2.png" style="height: 20px;" /></a></div><div class="inline" ng-show="pro_link_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-job-types-button" ng-click="add_items_from_repco(pro_link_account())"><img src="/assets/pro_link-ed0e9bca251211f98062a43051fa0baf.png" style="height: 20px;" /></a></div><div class="inline" ng-show="motospecs_account()"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-motospecs-button" ng-click="add_items_from_repco(motospecs_account())"><img src="/assets/motospecs-a9a4edc7104b920de0eeb485620ff60b.jpg" style="height: 30px;" /></a></div></div><div class="cost" ng-show="new_item"><div ng-show="new_item.header"><form autocomplete="off" name="new_item_header_form" novalidate="true"><div class="editing-item"><div ad-saved-texts-button="true" ng-model="new_item.details" quote="quote"></div><textarea auto-rows="15" class="span12" id="new-item-header-description" name="description" ng-model="new_item.details" type="text"></textarea><br /><br /><div><button class="btn btn-success" ng-click="save_new_item()">Save</button><button class="btn" ng-click="cancel_add_item()">Cancel</button></div></div></form></div><div ng-hide="new_item.header"><form autocomplete="off" name="new_item_form" novalidate="true"><div class="editing-item"><div class="error" ng-show="new_item_form.description.$invalid">description is required</div><div class="error" ng-show="new_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="new_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" customer="customer()" input-id="new-item-description" ng-model="new_item"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-model="new_item.quantity" required="true" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-model="new_item.unit_price" required="true" type="number" /><div ng-show="new_item.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices  </span><i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in new_item.prices"><a href="javascript:void(0);" ng-click="select_price_level(new_item, price)"><span>{{price|currency}}</span></a></li></ul></div></div><div><span>Discount</span><div><div class="input-append"><input class="input-mini" ng-model="new_item.discount_percentage" type="number" /><span class="add-on">%</span></div></div><div ng-show="new_item.discount_percentage &gt; 100"><span class="error">Maximum: 100%</span></div></div></div><div class="total"><input class="input-mini" readonly="true" value="{{item_total(new_item)}}" /></div><div class="pull-right" ng-show="new_item.stock_id"><a href="javascript:void(0)" ng-click="show_stock(new_item)"><i class="icon icon-info"></i><span>Info</span></a></div><div><div class="row-fluid"><a ng-click="edit_item_details(new_item)" ng-hide="new_item.edit_details">More Details</a><div class="pull-right" ng-hide="quote.not_registered_for_gst"><div><label class="checkbox"><input ng-model="new_item.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="new_item.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><div class="details" ng-show="new_item.edit_details"><div ad-saved-texts-button="true" ng-model="new_item.details" quote="quote"></div><textarea auto-rows="15" ng-model="new_item.details" style="width: 95%;"></textarea></div><br /><br /></div><div><button class="btn btn-success" ng-click="save_new_item()">Save</button><button class="btn" ng-click="cancel_add_item()">Cancel</button><div class="pull-right"><div ad-new-stock="true" generic-item="new_item" ng-model="new_stock" on-save="select_new_stock()"></div></div></div></div></form></div></div><div class="summary"><div ng-show="quote.discount_amount"><div class="title"><span ng-hide="not_registered_for_gst()">Discount Incl. {{tax_name()}}:</span><span ng-show="not_registered_for_gst()">Discount:</span></div><div class="value">- {{quote.discount_amount | currency}}</div></div><div ng-hide="not_registered_for_gst()"><div><div class="title">Total Excl. {{tax_name()}}:</div><div class="value">{{quote.net_amount | currency}}</div></div><div><div class="title">{{tax_name()}}:</div><div class="value">{{quote.gst_amount | currency}}</div></div></div><div><div class="title">Total:</div><div class="value">{{quote.total_amount | currency}}</div></div><div class="included-gst"></div></div><div ng-show="quote &amp;&amp; quote.id"><div><label><b>Discount</b></label><div ng-show="quote.editing_discount"><div class="input-append"><input class="input-tiny" ng-model="quote.editing_discount.discount_percentage" step="any" type="number" /><span class="add-on">%</span></div><span class="error" ng-show="quote.editing_discount.discount_percentage &gt; 100">&nbsp; Maximum: 100%</span><br /><div class="input-append"><input class="input-tiny" ng-model="quote.editing_discount.discount_money" type="number" /><span class="add-on">$</span></div><br /><button class="btn btn-primary" ng-click="update_quote_discount()">Save</button><button class="btn" ng-click="cancel_edit_quote_discount()">Cancel</button></div><div class="editable" ng-click="edit_quote_discount()" ng-hide="quote.editing_discount"><div class="red bold" ng-show="quote.discount_money">${{quote.discount_money}}</div><div class="red bold" ng-show="quote.discount_percentage">{{quote.discount_percentage}} % </div><div ng-show="!quote.discount_percentage &amp;&amp; !quote.discount_money">No Discount</div></div></div></div></div><br /><hr class="divider" /><div class="sub-header">Quote Note<div class="pull-right"><button class="btn btn-link" ng-click="edit_quote_details()">Add Quote Details</button></div></div><div class="editable note" ng-click="edit_quote_details()" ng-hide="quote.editing_details"><pre class="no-style" ng-show="quote.details">{{quote.details}}</pre></div><div class="editing-item" ng-show="quote.editing_details"><div><label class="checkbox inline"><input ng-click="auto_save_quote_details()" ng-model="quote.editing_details.auto_save" type="checkbox" /><span>Auto-save (every 10 seconds)</span></label><div class="pull-right"><div><span class="green" ng-show="quote.editing_details.details == quote.details">Saved</span><span ng-show="(quote.editing_details.details != quote.details) &amp;&amp; !quote.editing_details.saving">Pending...</span><span class="green" ng-show="quote.editing_details.saving">Saving...</span></div></div></div><div ad-saved-texts-button="true" ng-model="quote.editing_details.details" quote="quote"></div><textarea class="span12" id="edit-quote-details" ng-model="quote.editing_details.details" rows="5"></textarea><button class="btn btn-primary" ng-click="save_quote_details()">Save</button><button class="btn btn-danger" ng-click="clear_quote_details()">Remove</button><button class="btn" ng-click="cancel_edit_quote_details()">Cancel</button></div><div id="add-job-types-popover"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header">Add Job Types</div></div><div class="popover-content"><div class="content-box"><div class="bold">Job types:</div><div ad-job-type-selection="true" ng-model="new_job_types"></div><div class="spinner" id="add-quote-job-types-spinner"></div><br /><br /><button class="btn btn-primary" ng-click="save_new_job_types()">Add</button><button class="btn" ng-click="hide_add_job_types()">Cancel</button></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_quote_cogs.html",'<div class="row-fluid"></div><br /><div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Cost</div><div class="pull-right"><div class="total">Total</div></div></div><ul class="quote-items" id="quote-item-cogs"><li class="cost" id="quote-item-cogs-{{quote_item.id}}" ng-repeat="quote_item in quote.quote_items" ng-show="show_item(quote_item)"><div class="editable" ng-click="edit_cogs(quote_item)" ng-hide="quote_item.editing_cogs"><div><div class="description">{{quote_item.description}}</div><div class="quantity">{{quote_item.cost_quantity}}</div><div class="rate">{{quote_item.buy_price|currency}}</div><div class="pull-right"><div class="total"><span>{{quote_item_total(quote_item) | currency}}</span><span ng-show="quote_item.cogs_quantity != quote_item.quantity">&nbsp;(Est)</span></div></div></div></div></li><li class="editing-item" id="editing-quote-item-cogs" ng-show="editing_quote_item.editing_cogs"><form><div><div class="description">{{editing_quote_item.description}}</div><div class="quantity">{{editing_quote_item.cost_quantity}}</div><div class="rate"><input class="input-small" ng-model="editing_quote_item.editing_cogs.buy_price" type="number" /></div><div class="pull-right"><div class="total">{{quote_item_total(editing_quote_item.editing_cogs) | currency}}</div></div></div><div><div class="description"></div><div class="quantity"></div><div class="inline"><button class="btn btn-success" ng-click="save_cogs(editing_quote_item)" type="submit">Save</button><button class="btn" ng-click="cancel_edit_cogs(editing_quote_item)">Cancel</button></div></div></form></li><li class="cost" ng-show="new_cogs"><div><div class="description"><select ng-change="select_cogs()" ng-model="new_cogs.id" ng-options="item.id as item.description for item in selectable_items()"></select></div><div class="quantity">{{new_cogs.cost_quantity}}</div><div class="rate"><input class="input-small" ng-model="new_cogs.buy_price" type="number" /></div><div class="pull-right"><div class="total">{{quote_item_total(new_cogs) | currency}}</div></div></div><div><button class="btn btn-success" ng-click="save_cogs(new_cogs)" type="submit">Save</button><button class="btn" ng-click="cancel_edit_cogs(new_cogs)">Cancel</button></div><br /></li></ul><div class="row-fluid"><div class="inline"><a href="javascript:void(0);" ng-click="add_cogs()">Add</a></div><div class="pull-right"><div class="bold" ng-show="quote">Total COGS: {{total_cost() | currency}}</div></div><hr /><div class="pull-right"><div class="bold" ng-show="quote">Profit Margin: {{profit_margin() | currency}} ({{profit_margin_percentage()}}%)</div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_quotepicker.html",'<div class="inline"><div class="input-append"><input autocomplete="off" class="span12" id="{{input_id}}" ng-maxlength="255" ng-model="quote.lookup_text" ng-readonly="readonly" style="min-width: 200px; max-width: 300px" type="text" typeahead="item.lookup_text for item in lookup($viewValue)" typeahead-on-select="select($item, $model, $label, selected_quote)" typeahead-wait-ms="200" /><span class="add-on"><div class="spinner spinner-small" id="lookup-quote-spinner-{{spinner_id}}"></div><i class="icon icon-search" id="lookup-quote-icon-{{spinner_id}}"></i></span><span>&nbsp; {{quote.customer_name}}</span></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_repco_navigator.html",'<form action="{{active_repco_account().url}}" id="repco-navigator-purchase-order" method="POST" target="_blank"><input name="NEW_ITEM-CUST_FIELD1[1]" type="hidden" value="{{active_repco_account().site_code}}" /><input name="NEW_ITEM-CUST_FIELD2[1]" type="hidden" value="MechanicDesk" /><input name="Username" type="hidden" value="{{active_repco_account().username}}" /><input name="Password" type="hidden" value="{{active_repco_account().password}}" /><input name="NEW_ITEM-CUST_FIELD3[1]" type="hidden" value="1" /><input name="HOOK_URL" type="hidden" value="{{hooked_url()}}" /><input name="NEW_ITEM-CUST_FIELD4[1]" type="hidden" value="po submit" /><input name="NEW_ITEM-CUST_FIELD5[1]" type="hidden" value="{{repco_purchase().number}}" /><input name="NEW_ITEM-CUST_FIELD6[1]" type="hidden" value="{{repco_purchase().description}}" /><input name="NEW_ITEM-CUST_FIELD7[1]" type="hidden" value="{{active_repco_account().account_number}}" /><input name="NEW_ITEM-CUST_FIELD8[1]" type="hidden" value="{{active_repco_account().account_suffix}}" /><input name="NEW_ITEM-CUST_FIELD9[1]" type="hidden" value="{{active_repco_account().account_company}}" /><input name="NEW_ITEM-CUST_FIELD10[1]" type="hidden" value="{{active_repco_account().account_division}}" /><input name="NEW_ITEM-CUST_FIELD11[1]" type="hidden" value="Inc" /><div ng-repeat="item in accepted_purchase_items()"><input name="NEW_ITEM-EXT_PRODUCT_ID[{{purchase_item_index(item)}}]" ng-disabled="!item.sku" type="hidden" value="{{item.sku}}" /><input name="NEW_ITEM-CUST_FIELD13[{{purchase_item_index(item)}}]" ng-disabled="!item.sku" type="hidden" value="{{item.supplier_stock_number}}" /><input name="NEW_ITEM-QUANTITY[{{purchase_item_index(item)}}]" ng-disabled="!item.sku" type="hidden" value="{{item.quantity}}" /><input name="NEW_ITEM-PRICE[{{purchase_item_index(item)}}]" ng-disabled="!item.sku" type="hidden" value="{{purchase_item_price(item)}}" /><input name="NEW_ITEM-CUST_FIELD12[{{purchase_item_index(item)}}]" ng-disabled="!item.sku" type="hidden" value="{{purchase_item_index(item)}}" /></div></form><form action="{{active_repco_account().url}}" id="repco-navigator-inquiry" method="POST" target="_blank"><input name="NEW_ITEM-CUST_FIELD1[1]" type="hidden" value="{{active_repco_account().site_code}}" /><input name="NEW_ITEM-CUST_FIELD2[1]" type="hidden" value="MechanicDesk" /><input name="Username" type="hidden" value="{{active_repco_account().username}}" /><input name="Password" type="hidden" value="{{active_repco_account().password}}" /><input name="NEW_ITEM-CUST_FIELD3[1]" type="hidden" value="1" /><input name="HOOK_URL" type="hidden" value="{{hooked_url()}}" /><input name="NEW_ITEM-CUST_FIELD4[1]" type="hidden" value="inquiry" /><input name="NEW_ITEM-CUST_FIELD5[1]" type="hidden" value="{{repco_vehicle().repco_id}}" /><input name="NEW_ITEM-CUST_FIELD6[1]" type="hidden" value="{{repco_vehicle().make}}" /><input name="NEW_ITEM-CUST_FIELD7[1]" type="hidden" value="{{repco_vehicle().model}}" /><input name="NEW_ITEM-CUST_FIELD8[1]" type="hidden" value="{{repco_vehicle().series}}" /><input name="NEW_ITEM-CUST_FIELD10[1]" type="hidden" value="{{repco_vehicle().engine_size}} {{repco_vehicle().engine_type}}" /><input name="NEW_ITEM-CUST_FIELD11[1]" type="hidden" value="{{repco_vehicle().transmission}}" /><input name="NEW_ITEM-CUST_FIELD12[1]" type="hidden" value="{{repco_vehicle().drive_type}}" /><input name="NEW_ITEM-CUST_FIELD13[1]" type="hidden" value="{{repco_vehicle().body_type}}" /><input name="NEW_ITEM-CUST_FIELD15[1]" type="hidden" value="{{repco_vehicle_year()}}" /><input name="NEW_ITEM-CUST_FIELD18[1]" type="hidden" value="{{repco_vehicle_vin_or_registration_number()}}" /><input name="NEW_ITEM-CUST_FIELD20[1]" type="hidden" value="N" /><input name="NEW_ITEM-CUST_FIELD21[1]" type="hidden" value="section()" /></form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_sale_history.html",'<div id="sale-history-spinner"></div><table class="table table-striped"><thead><tr><th>Date</th><th>Reference</th><th>Qty.</th><th>Unit Price</th><th>Total</th><th>Customer</th><th>Status</th></tr></thead><tbody><tr class="goto" ng-click="goto(item)" ng-repeat="item in invoice_items"><td>{{item.created_at|date: \'mediumDate\'}}</td><td><span ng-show="item.credit_note">Credit Note #{{item.credit_note.number}}</span><span ng-show="item.invoice">Invoice #{{item.invoice.number}}</span></td><td>{{item.quantity}}</td><td>{{item.unit_price_exclude_gst|currency}}</td><td>{{item.total_amount|currency}}</td><td>{{item.customer.name}}</td><td><label class="label label-info" ng-hide="item.finalized">Allocated</label></td></tr></tbody></table><br /><pagination boundary-links="true" current-page="page_number" max-size="8" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_saved_texts.html",'<div id="saved-texts-popover"><div class="popover fade left in" style="width: 750px"><div class="popover-content"><div class="row-fluid"><div class="inline"><form class="form-search"><input class="search-query" id="saved-texts-search-input" ng-change="search()" ng-model="query" style="width: 370px" type="text" /></form></div><div class="pull-right"><button class="btn btn-success" ng-click="create_saved_text()" ng-hide="editing_saved_text" style="margin-left: 20px">New Saved Text</button><button class="btn" ng-click="hide()">Close (F7)</button></div></div><div class="row-fluid" ng-show="saved_texts.length == 0 &amp;&amp; !editing_saved_text"><p>Saved Texts allows you to create frequently used texts and use it anywhere inside MechanicDesk. Such as email message, job description, etc...</p></div><br /><div class="row-fluid" ng-hide="editing_saved_text"><table class="table table-striped"><tr ng-repeat="text in saved_texts"><td><div class="row-fluid editable" ng-click="edit(text)"><div class="bold">{{text.name}}</div><pre class="no-style" id="saved-text-{{text.id}}">{{text.message}}</pre></div><div class="row-fluid"><div class="pull-right"><div class="inline" ng-show="context()"><button class="btn btn-link" ng-click="insert(text)">Insert</button><span>&nbsp;::&nbsp;</span><button class="btn btn-link" ng-click="replace(text)">Replace</button><span>&nbsp;::&nbsp;</span></div><button class="btn btn-link copy-to-clipboard" data-clipboard-text="{{process(text)}}">Copy to clipboard</button></div></div></td></tr></table><div ng-show="total_pages &gt; 1"><pagination boundary-links="true" current-page="page_number" max-size="8" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div></div><div class="row-fluid"><div class="row-fluid editing-item" ng-show="editing_saved_text"><div class="column span9"><div class="row-fluid"><form name="edit_saved_text_form" novalidate="true"><div><span class="bold">Name</span> <input ng-model="editing_saved_text.name" type="text" /></div><div ng-hide="use_subject"><a href="javascript:void(0);" ng-click="use_subject = true">Add Subject for use on emails </a></div><div ng-show="use_subject || editing_saved_text.message"><span class="bold">Subject (for use on emails only)</span> <input class="span12" id="editing-saved-text-subject-input" name="subject" ng-model="editing_saved_text.subject" rows="5" /></div><div><span class="bold">Message*</span> <span class="error" ng-show="edit_saved_text_form.message.$invalid">message is required</span><textarea class="span12" id="editing-saved-text-input" name="message" ng-model="editing_saved_text.message" required="true" rows="5"></textarea></div><div>Note: To use the variable put it inside the %{} on the mesage</div><div>E.g %{customer_name}</div><br /><div ng-show="editing_saved_text.errors.message"><div class="inline alert alert-error">{{editing_saved_text.errors.message.join(\', \')}}</div></div></form></div><div class="row-fluid"><button class="btn btn-success" ng-click="save(edit_saved_text_form)">Save</button><button class="btn" ng-click="cancel_editing()">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="remove()">Remove</button></div></div></div><div class="column span3"><h6>Applicable variables</h6><div ng-repeat="variable in editing_saved_text.variables">{{variable}}</div></div></div><br /></div></div><div class="popover-footer"><center><div class="button-pannel"><button class="btn btn-primary" ng-click="hide()">Close (F7)</button></div></center></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_saved_texts_button.html",'<a href="javascript:void(0);" ng-click="show()" style="margin-left: 5px;"><span>[...]</span></a>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_scheduler.html",'<div class="row-fluid"><div class="column" ng-class="{span2: showing_side_view()}" ng-show="showing_side_view()"><div ng-show="showing_employee_list"><div class="bold">Scheduled For:</div><br /><div><label class="checkbox"><input ng-checked="showing_all_employees" ng-click="toggle_all_employees()" type="checkbox" /><span>All</span></label></div><div ng-click="refresh()" ng-repeat="employee in employees"><label class="checkbox"><input check-list="showing_employees" type="checkbox" value="{{employee.id}}" /><span>{{employee.name}}</span></label></div><div ng-click="refresh()"><label class="checkbox"><input check-list="showing_employees" type="checkbox" value="0" /><span>Unassigned</span></label></div><hr /><div class="bold">Showing:</div><br /><label class="checkbox" ng-click="refresh()"><input check-list="showing_events" type="checkbox" value="finished" /><span>Finished jobs</span></label><label class="checkbox" ng-click="refresh()"><input check-list="showing_events" type="checkbox" value="booked" /><span>Bookings</span></label><label class="checkbox" ng-click="refresh()"><input check-list="showing_events" type="checkbox" value="started" /><span>Current jobs</span></label><label class="checkbox" ng-click="refresh()"><input check-list="showing_events" type="checkbox" value="on_hold" /><span>Jobs on hold</span></label><a href="javascript:void(0);" ng-click="hide_employee_list()">Hide</a><hr /></div><div class="bold">Notes</div><br /><div class="well" ng-repeat="note in pinned_notes()"><p class="editable" ng-click="edit_note(note)">{{note.content}}</p></div><hr /><a href="javascript:void(0)" ng-click="create_note()">Create Note</a></div><div class="column" ng-class="{span10: showing_side_view()}"><div class="row-fluid"><button class="btn btn-link" ng-click="show_employee_list()" ng-hide="showing_employee_list">Filters</button><span>&nbsp; :: &nbsp;</span><div class="inline"><button class="btn btn-link" ng-click="show_summary()" ng-hide="summary_view">Show summary</button><button class="btn btn-link" ng-click="show_details()" ng-show="summary_view">Show details</button></div><span>&nbsp; :: &nbsp;</span><div class="inline"><button class="btn btn-link" id="diary-button" ng-click="edit_diary()">Set Daily Workload</button></div><span>&nbsp; :: &nbsp;</span><div class="inline"><button class="btn btn-link" id="editing-note-button" ng-click="create_note()">Create Note</button></div><div class="pull-right"><div><div class="inline" style="width: 200px"><div class="inline event-new">&nbsp;&nbsp;</div><span>&nbsp; Bookings</span></div><div class="inline"><div class="inline event-started">&nbsp;&nbsp;</div><span>&nbsp; Current jobs</span></div></div><div><div class="inline" style="width: 200px"><div class="inline event-finished">&nbsp;&nbsp;</div><span>&nbsp; Finished jobs</span></div><div class="inline"><div class="inline event-on-hold">&nbsp;&nbsp;</div><span>&nbsp; Jobs On hold</span></div></div></div></div><br /><div class="row-fluid"><div class="column span6"><label class="checkbox"><input ng-click="toggle_auto_refresh()" ng-model="auto_refresh_status" type="checkbox" />Auto Refresh (every {{refresh_rate()}})</label></div><div class="column span6" ng-show="view == &#39;resourceDay&#39;"><a href="javascript:void(0);" ng-click="toggle_day_view_with_time()"><span ng-hide="day_view_with_time()"><i class="icon icon-time"></i><span>Show time line</span></span><span ng-show="day_view_with_time()"><i class="icon icon-th"></i><span>Hide time line</span></span></a></div></div><div class="content-box"><div class="spinner" id="calendar-spinner"></div><div ng-show="view == &#39;resourceDay&#39;"><div class="row-fluid"><div class="pull-right"><button class="btn btn-link" ng-click="hide_notes = false" ng-show="day_notes().length &gt; 0 &amp;&amp; hide_notes">Show notes ({{day_notes().length}}</button><button class="btn btn-link" ng-click="hide_notes=true" ng-show="!hide_notes">Hide notes</button></div></div><div class="row-fluid"><div class="well" ng-hide="hide_notes" ng-repeat="note in day_notes()" style="margin-bottom: 4px; background-color: white;"><span>{{note.content}}</span></div></div></div><div calendar="bookingCalendar" id="calendar" ng-model="events" ui-calendar="calendar_options"></div></div><div class="row-fluid"><div class="bold">Note:</div><div>Click on a day for more actions. E.g: creating a booking on the day, or mark the day as fully booked.</div><div>Drag and drop bookings or jobs to a different day to reschedule them</div></div></div></div><div class="popover-container"></div><div id="event-dialog"><div class="popover fade right in" style="width: 500px"><div class="popover-title">{{selected_event.type.toUpperCase()}} {{selected_event.number.toUpperCase()}}</div><div class="popover-content"><div class="content-box"><span> {{selected_event.time | date: \'shortTime\'}}</span><div class="pull-right" ng-show="selected_event.job_number"><span>Job No. {{selected_event.job_number}}</span><a ng-href="/jobs/{{selected_event.job_id}}/print.pdf" style="margin-left: 5px" target="_blank"><i class="icon icon-print"></i></a></div><div ng-show="selected_event.created_by"><div>Created by {{selected_event.created_by}}</div><br /></div><div ng-show="selected_event.job_types_title.length &gt; 0">{{selected_event.job_types_title}}</div><div ng-show="selected_event.key_tag.length &gt; 0"><br /><span class="bold">Key Tag: &nbsp;</span><span>{{selected_event.key_tag}}</span></div><div class="event-popover-title">{{selected_event | vehicle_title}}</div><div class="well" ng-show="selected_event.on_hold"><div class="inline label label-warning">On Hold</div><div class="inline">&nbsp;{{selected_event.on_hold_reason}}</div></div><br /><div style="margin-bottom: 10px">{{selected_event.name}}</div><div ng-show="selected_event.phone"><span class="bold">Ph:</span> <span>{{selected_event.phone}}</span></div><div ng-show="selected_event.mobile"><span class="bold">Mobi:</span> <span>{{selected_event.mobile}}</span></div><div style="margin-top: 10px">{{display_address(selected_event.customer)|address: \'short\'}}</div><div ad-tag-icons="true" owner="selected_event"></div><div ng-show="selected_event.note"><br /><div>Note:</div><div>{{selected_event.note}}</div></div></div><br /><div class="inline"><div class="dropdown inline dropup" id="event-actions"><a class="btn" dropdown-toggle="true"><i class="icon icon-reorder"></i>Actions</a><ul class="dropdown-menu"><li ng-show="selected_event.type==&#39;job&#39;"><button class="btn btn-link"><a ng-href="/jobs/{{selected_event.id}}/print.pdf" target="_blank"><i class="icon-print"></i><span>Print</span></a></button></li><li ng-show="selected_event.type==&#39;job&#39; &amp;&amp; selected_event.on_hold"><button class="btn btn-link" id="put-on-hold" ng-click="continue(selected_event)"><i class="icon-play"></i><span>Continue</span></button></li><li ng-show="selected_event.type==&#39;job&#39; &amp;&amp; !selected_event.on_hold"><button class="btn btn-link" id="put-on-hold" ng-click="put_on_hold(selected_event)"><i class="icon-pause"></i><span>Put on hold</span></button></li><li><button class="btn btn-link" id="send-sms" ng-click="send_sms(selected_event)"><i class="icon icon-mobile-phone"></i><span>SMS</span></button></li><li><button class="btn btn-link" id="send-email" ng-click="send_email(selected_event)"><i class="icon icon-envelope"></i><span>Email</span></button></li><li><button class="btn btn-link" id="tag" ng-click="tag(selected_event)"><i class="icon icon-tags"></i><span>Tags</span></button></li><li><button class="btn btn-link" id="assign" ng-click="assign(selected_event)"><i class="icon icon-wrench"></i><span>Assign To</span></button></li><li><button class="btn btn-link" id="assign" ng-click="adjust_time(selected_event)"><i class="icon icon-time"></i><span>Adjust Time</span></button></li><li ng-hide="selected_event.job_id"><button class="btn btn-link" ng-click="edit_booking(selected_event)"><a href="javascript:void(0);" id="edit-button"><i class="icon-pencil"></i><span>Edit</span></a></button></li></ul></div><div class="inline" ng-hide="selected_event.job_id"><a class="btn btn-small btn-primary" href="#/jobs/new?booking={{selected_event.id}}&amp;prepare=true"><i class="icon-pencil"></i>Prepare</a><a class="btn btn-small btn-success" href="#/jobs/new?booking={{selected_event.id}}"><i class="icon-ok"></i>Start</a></div><div class="inline" ng-show="selected_event.job_id"><a class="btn btn-small btn-success" href="#/jobs/{{selected_event.job_id}}"><i class="icon-ok"></i>Prepare/Start</a></div></div><div class="inline green" ng-show="selected_event.type == &#39;job&#39;"><a class="btn btn-primary" ng-href="#/jobs/{{selected_event.job_id}}">Go To Job Page</a></div><div class="inline">&nbsp;<button class="btn btn-small close-popover" ng-click="hide_event_dialog()">Close</button><br /></div><div class="pull-right" ng-hide="selected_event.type == &#39;job&#39;"><button class="btn btn-small btn-danger remove inline" ng-click="delete_booking()"><i class="icon-remove"></i>Delete</button></div><div modal="showing_delete_booking_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this booking</h3></div><div class="modal-body"><div>Are you sure you want to delete this Booking?</div><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea><div class="modal-footer"><div class="spinner" id="delete-job-spinner"></div><button class="btn btn-danger" ng-click="do_delete_booking()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_booking()">Cancel</button></div></div></div></div></div></div><div id="new-booking-popover"><div class="popover fade left in" style="width: 200px"><div class="popover-content"><div class="row-fluid"><div ng-hide="fully_booked()"><div ng-hide="restricted_to_create_jobs()"><div><button class="btn span12 btn-primary" ng-click="new_booking()">New Booking</button><br /><br /></div><div><button class="btn span12 btn-primary" ng-click="new_job()">New Job</button><br /><br /></div></div><div><button class="btn span12 btn-primary" ng-click="create_note()">New Note</button><br /><br /></div><div><button class="btn span12" ng-click="mark_as_fully_booked()">Mark as fully booked</button><br /><br /></div><div><button class="btn span12" ng-click="day_resource_view()">Zoom in</button><br /><br /></div></div><div ng-show="fully_booked()"><div><span>Marked as Fully Booked</span><button class="inline btn btn-link" ng-click="unmark_as_fully_booked()">(Unmark)</button><br /><br /></div><div><button class="btn span12 btn-primary" ng-click="create_note()">New Note</button><br /><br /></div><div><button class="btn span12" ng-click="day_resource_view()">Zoom in</button><br /><br /></div></div><br /><div><button class="btn span12" ng-click="close_actions()">Cancel</button></div></div></div></div></div><div id="editing-note"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="sub-header">New Note/Reminder</div></div><div class="popover-content"><div class="content-box"><div class="row-fluid"><form><div><div class="inline"><label>Start Date</label><ad-datepicker error="top" ng-model="editing_note.start_time"></ad-datepicker></div><div class="inline" style="margin-left: 40px;"><label>End Date</label><ad-datepicker error="top" ng-model="editing_note.end_time"></ad-datepicker></div><div class="inline" style="margin-left: 40px;"><label class="checkbox"><input class="input" ng-model="editing_note.office_only" type="checkbox" />Office Only</label></div></div><textarea auto-rows="15" class="span12" id="editing-note-content" ng-model="editing_note.content" rows="10"></textarea><button class="btn btn-success" ng-click="save_note(editing_note)">Save</button><button class="btn" ng-click="cancel_editing_note()">Cancel</button><div class="pull-right" ng-show="editing_note.id"><a class="btn btn-danger" href="javascript: void(0);" ng-click="delete_note(editing_note)">Delete</a></div></form></div></div></div></div></div><div ad-diary="true" anchor-element="#diary-button" ng-model="diary" on-save="refresh" placement="top" showing="showing_diary_workload"></div><div ad-put-on-hold="true" anchor-element="&#39;#event-actions&#39;" ng-model="selected_event" on-success="rerender()" placement="top" showing="putting_on_hold"></div><div ad-send-email="true" anchor-element="&#39;#event-actions&#39;" customer="selected_event.customer" job="selected_event" placement="top" showing="sending_email" vehicle="selected_event.vehicle"></div><div ad-send-sms="true" anchor-element="&#39;#event-actions&#39;" customer="selected_event.customer" job="selected_event" placement="top" showing="sending_sms" vehicle="selected_event.vehicle"></div><div ad-tags="true" anchor-element="&#39;#event-actions&#39;" on-success="rerender()" owner="selected_event" placement="top" resource="Job" showing="tagging_job"></div><div ad-tags="true" anchor-element="&#39;#event-actions&#39;" on-success="rerender()" owner="selected_event" placement="top" resource="Booking" showing="tagging_booking"></div><div ad-assign-employees="true" anchor-element="&#39;#event-actions&#39;" job="selected_event" on-success="rerender()" placement="top" showing="assigning_job"></div><div ad-adjust-time="true" anchor-element="&#39;#event-actions&#39;" ng-model="selected_event" on-success="time_adjusted()" placement="top" showing="adjusting_job_time"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_select_invoice_template.html",'<div id="select-invoice-template"><div class="popover fade left in" style="width: 800px; height: 1000px"><div class="popover-title"><div class="row-fluid"><div class="column span4"><div class="sub-header"><span>Invoice Template</span></div></div><div class="column span6"><div class="invoice-template-selection" style="font-size: 150%"><i class="icon-chevron-left goto" ng-click="previous()"></i><span>&nbsp; {{template().id}} &nbsp;</span><i class="icon-chevron-right goto" ng-click="next()"></i><button class="btn btn-primary" ng-click="select()" style="margin-left: 30px">Select</button></div></div><div class="column span2"><div class="pull-right"><i class="icon-remove goto" ng-click="hide()"></i></div></div></div></div><div class="popover-content"><div class="row-fluid"><br /><iframe id="preview" style="width: 100%; height: 900px"></iframe></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_send_email.html",'<div id="send-email"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header">Email</div></div><div class="popover-content"><div class="content-box"><div class="spinner" id="send-email-spinner"></div><div class="row-fluid"><form class="form-horizontal" name="email_form" novalidate="true"><div class="control-group"><label class="control-label"></label><div class="controls"><div class="error" ng-show="email_form.email.$error.required">email address is required</div></div></div><div class="control-group"><label class="control-label">To:</label><div class="controls"><input class="span9" name="email" ng-model="email.to" required="true" type="text" /><div class="pull-right"><div class="inline" contactpicker="true" model-type="customer" ng-model="customer" on-select="email_select_contact(contacts)" show-email="true"></div></div></div></div><div class="control-group"><label class="control-label">Subject:</label><div class="controls"><input class="span12" ng-model="email.subject" type="text" /></div></div><div class="control-group"><label class="control-label"><span>Message:</span></label> <div class="controls"><div ad-saved-texts-button="true" class="inline" customer="customer" job="job" ng-model="email.message" populate-subject="true" subject="email.subject" vehicle="vehicle"></div><div ad-vehicle-visual-button="true" class="inline" ng-model="email.message"></div><textarea class="span12" ng-model="email.message" rows="10" type="text"></textarea><div><label class="checkbox"><input ng-model="attached_files" type="checkbox" /><span>Attach Files</span></label></div><div ng-show="attached_files"><table class="table table-striped"><thead></thead><tbody><tr ng-repeat="file in job.photos"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in job.documents"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in customer.photos"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in customer.documents"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr></tbody></table></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="send()">Send</button><button class="btn" ng-click="hide()">Cancel</button></div></div></form></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_send_sms.html",'<div id="send-sms"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">SMS</div></div><div class="popover-content"><div class="content-box"><div class="spinner" id="send-sms-spinner"></div><div class="row-fluid"><form class="form-horizontal" name="sms_form" novalidate="true"><div class="control-group"><label class="control-label"></label><div class="controls"><div class="error" ng-show="sms_form.sms.$error.required">mobile number is required</div></div></div><div class="control-group"><label class="control-label">To:</label><div class="controls"><input class="span12" name="sms" ng-model="sms.to" required="true" type="text" /></div></div><div class="control-group"><label class="control-label">Message:</label><div class="controls"><div ad-saved-texts-button="true" class="inline" customer="customer" job="job" ng-model="sms.message" vehicle="vehicle"></div><div ad-vehicle-visual-button="true" class="inline" ng-model="sms.message"></div><textarea class="span12" ng-model="sms.message" rows="10" type="text"></textarea></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="send()">Send</button><button class="btn" ng-click="hide()">Cancel</button></div></div></form></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_service_schedule.html",'<div ng-show="showing_customer"><div class="row-fluid"><button class="btn" ng-click="back_to_service_schedule()"><i class="icon-arrow-left"></i>Service Schedule</button><br /><br /><ad-customer ng-model="customer" on-select-vehicle="goto_vehicle(vehicle)"></ad-customer></div></div><div ng-hide="showing_customer"><div class="content-box" ng-show="customer &amp;&amp; vehicle"><div class="row-fluid"><div class="column span4 goto" ng-click="show_customer()"><div>{{vehicle|vehicle_title}}</div><div><i class="icon-user"></i>{{customer|customer_name}}</div><div><i class="icon-phone"></i>{{customer.phone || customer.mobile}}</div><div><i class="icon-envelope"></i>{{customer.email}}</div><div ng-show="customer.send_communications_to_driver"><i class="icon icon-mail-forward"></i>Send Commication To Driver</div></div><div class="column span8"><div class="pull-right"><div ng-show="!no_wof()"><div class="editable" ng-click="edit_wof_date()" ng-hide="service_schedule.editing_wof_date"><span class="label-name-left">{{wof_name()}} Due Date:</span><span>{{service_schedule.wof_date|date: \'mediumDate\'}}</span></div><div class="editing-item" ng-show="service_schedule.editing_wof_date"><form class="form-inline"><span class="label-name-left">{{wof_name()}} Due Date:</span><ad-datepicker ng-model="service_schedule.editing_wof_date.wof_date"></ad-datepicker><br /><br /><div class="row-fluid"><div class="pull-right"><button class="btn btn-success" ng-click="save_wof_date()" type="submit">Save</button>&nbsp;<button class="btn" ng-click="cancel_edit_wof_date()">Close</button></div></div></form></div></div><div><div class="editable" ng-click="edit_registration_due_date()" ng-hide="service_schedule.editing_registration_due_date"><span class="label-name-left">Registration Due:</span><span>{{service_schedule.registration_due_date|date: \'mediumDate\'}}</span></div></div><div class="editing-item" ng-show="service_schedule.editing_registration_due_date"><form class="row-fluid form-inline"><span class="label-name-left">Registration Due:</span><ad-datepicker ng-model="service_schedule.editing_registration_due_date.registration_due_date"></ad-datepicker><br /><br /><div class="pull-right"><button class="btn btn-success" ng-click="save_registration_due_date()" type="submit">Save</button>&nbsp;<button class="btn" ng-click="cancel_edit_registration_due_date()">Cancel</button></div></form></div><div class="editable" ng-click="edit_last_service_date()" ng-hide="service_schedule.editing_last_service_date"><span class="label-name-left">Last Job Date:</span><span>{{service_schedule.last_service_date|date: \'mediumDate\'}}</span></div><div class="editing-item" ng-show="service_schedule.editing_last_service_date"><form class="form-inline"><span class="label-name-left">Last Job Date:</span><ad-datepicker ng-model="service_schedule.editing_last_service_date.last_service_date"></ad-datepicker><br /><br /><div class="row-fluid"><div class="pull-right"><button class="btn btn-success" ng-click="save_last_service_date()" type="submit">Save</button>&nbsp;<button class="btn" ng-click="cancel_last_next_service_date()">Close</button></div></div></form></div><div class="editable" ng-click="edit_next_service_date()" ng-hide="service_schedule.editing_next_service_date"><span class="label-name-left">Next Service:</span><span>{{service_schedule.next_service_date|date: \'mediumDate\'}}</span></div><div class="editing-item" ng-show="service_schedule.editing_next_service_date"><form class="form-inline"><span class="label-name-left">Next Service:</span><ad-datepicker ng-model="service_schedule.editing_next_service_date.next_service_date"></ad-datepicker><br /><br /><div class="row-fluid"><div class="pull-right"><button class="btn btn-success" ng-click="save_next_service_date()" type="submit">Save</button>&nbsp;<button class="btn" ng-click="cancel_edit_next_service_date()">Close</button></div></div></form></div></div></div></div></div><div class="content-nav"><ul><li ng-class="{active: vehicle_detail_tab==&#39;service_reminder&#39;}" ng-click="show_vehicle_detail_tab(&#39;service_reminder&#39;)"><a>Service Reminder</a></li><li ng-class="{active: vehicle_detail_tab==&#39;vehicle&#39;}" ng-click="show_vehicle_detail_tab(&#39;vehicle&#39;)"><a>Vehicle</a></li></ul></div><div ng-show="vehicle_detail_tab == &#39;vehicle&#39;"><div ad-vehicle="true" ng-model="service_schedule.vehicle"></div></div><div class="content-box" ng-show="vehicle_detail_tab == &#39;service_reminder&#39;"><div class="sub-header">Service Reminder &nbsp;<span class="label" ng-class="{&#39;label-important&#39;: !service_schedule.enable}">{{service_schedule.reminder_status}}</span><span ng-show="service_schedule.current_booking"><span>&nbsp;&nbsp;</span><a ng-href="#bookings/{{service_schedule.current_booking.id}}/edit">Current Booking</a></span><div class="pull-right"><button class="btn btn-success" ng-click="enable_service_schedule()" ng-show="!service_schedule.enable">Enable</button><button class="btn" ng-click="disable_service_schedule()" ng-show="service_schedule.enable">Disable</button></div></div><div class="editable" ng-click="edit_reminder_date()" ng-hide="service_schedule.editing_reminder_date"><span class="label-name-left">Reminder Last Sent:</span><span>{{service_schedule.reminder_date|date: \'mediumDate\'}}</span></div><div class="editing-item" ng-show="service_schedule.editing_reminder_date"><form class="form-inline"><span class="label-name-left">Reminder Last Sent:</span><ad-datepicker ng-model="service_schedule.editing_reminder_date.reminder_date"></ad-datepicker><button class="inline btn btn-success" ng-click="save_reminder_date()" style="margin-left: 5px" type="submit">Save</button>&nbsp;<button class="inline btn" ng-click="cancel_edit_reminder_date()">Close</button></form></div><div><label class="checkbox"><input ng-change="update_service_schedule()" ng-model="service_schedule.enable_email" type="checkbox" />Deliverable by email</label></div><div><label class="checkbox"><input ng-change="update_service_schedule()" ng-model="service_schedule.enable_sms" type="checkbox" />Deliverable by sms</label><label class="checkbox"><input ng-change="update_service_schedule()" ng-model="service_schedule.enable_postal_mail" type="checkbox" />Deliverable by postal mail</label></div><div ad-notes="true" model-type="service_schedule" ng-model="service_schedule"></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_service_schedule_list.html",'<div class="content-box"><table class="table table-striped"><thead><tr><th><label class="checkbox inline"><input ng-click="toggle_select_all()" type="checkbox" /><span class="bold">All</span></label></th><th>Reminder Status</th><th>{{asset_name()}}</th><th>Owner</th><th>Last Job</th><th>Last Job Date</th><th ng-show="service_type == &#39;wof&#39;">{{wof_name}} Due</th><th ng-show="service_type == &#39;service&#39;">Next Service</th><th ng-show="service_type == &#39;registration&#39;">Registration Due</th></tr></thead><tbody><tr class="goto" id="service_schedule_{{service_schedule.id}}" ng-click="show_service_schedule(service_schedule, $event)" ng-repeat="service_schedule in service_schedules"><td stop-event="click"><label class="checkbox" ng-show="service_schedule_active(service_schedule)"><input check-list="selected_service_schedule_ids" type="checkbox" value="{{service_schedule.id}}" /></label></td><td><span ng-class="{warning: !service_schedule_active(service_schedule) || service_schedule.booked, green: service_schedule_status(service_schedule) == &#39;Sent today&#39; || service_schedule_status(service_schedule) == &#39;Reminder scheduled&#39;}"> {{service_schedule_status(service_schedule)}}</span><div ng-show="postal_only(service_schedule)"><div class="label label-info">Postal Only</div></div></td><td><div>{{service_schedule.vehicle.title}}</div><div ng-show="service_schedule.vehicle.fleet_number">Fleet No.: {{service_schedule.vehicle.fleet_number}}</div></td><td>{{service_schedule.customer.first_name}} {{service_schedule.customer.last_name}}</td><td>{{service_schedule.last_job.job_types_title}}</td><td>{{service_schedule.last_service_date|date: \'mediumDate\'}}</td><td ng-show="service_type == &#39;wof&#39;">{{service_schedule.wof_date|date: \'mediumDate\'}}</td><td ng-show="service_type == &#39;service&#39;">{{service_schedule.next_service_date|date: \'mediumDate\'}}</td><td ng-show="service_type == &#39;registration&#39;">{{service_schedule.registration_due_date|date: \'mediumDate\'}}</td></tr></tbody></table></div><div id="service-schedule-popover"><div class="popover fade right in" style="width: 700px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">Service Schedule</div></div><div class="popover-content"><div ad-service-schedule="true" customer="showing_service_schedule.customer" ng-model="showing_service_schedule" vehicle="showing_service_schedule.vehicle"></div><button class="btn" ng-click="close_popup()">Close</button></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_sp_workshop_finder.html",'<div class="control-group"><label class="control-label bold">ID Search</label><div class="error" ng-show="auto_workshop.error">{{auto_workshop.error}}</div><div class="controls"><input class="no-margin" ng-model="auto_workshop.id" type="text" /><span>&nbsp;</span><button class="btn btn-default inline" ng-click="get_auto_workshop()">Search</button><div class="dropdown" style="width: 95%; margin-top: 5px;"><button class="btn btn-default dropdown-toggle" data-toggle="dropdown" style="width: 100%" type="button"><span class="caret"></span><span>&nbsp;</span><span>Advanced</span><span>&nbsp;</span><span class="caret"></span></button><ul class="dropdown-menu" id="advanced-actions"><li><a href="javascript:void(0)" ng-click="go_to_auto_workshop()">Go To Workshop</a></li><li><a href="javascript:void(0)" ng-click="show_follow_up()">Follow Up List</a></li><li><a href="javascript:void(0)" ng-click="show_owing()">Owing List</a></li></ul></div></div></div><div class="control-group" ng-show="show_adv_search"><label class="control-label bold inline">Adv Search &nbsp;</label><i class="icon icon-question-sign inline" ng-click="toggle_help_dialogue()"></i><div class="error" ng-show="auto_workshop.error">{{auto_workshop.error}}</div><div class="controls"><input class="no-margin" ng-model="search_term" type="text" /><span>&nbsp;</span><button class="btn btn-default inline" ng-click="adv_get_auto_workshop()">Search</button></div></div><div ng-hide="show_adv_search" style="width: 95%; height: 1px; background-color: orange"><span>&nbsp;</span></div><br /><div class="control-group"><div class="controls"><button class="btn btn-default" ng-click="clear_auto_workshop()" style="width: 95%">Clear</button></div></div><div style="border: 1px solid orange; width: 95%; height: 40px"><span>&nbsp;</span><span ng-show="error.message">{{error.message}}</span></div><div id="help-dialogue" ng-show="show_help_dialogue"><div class="bold">Syntax</div><div>criterion1,criterion2 term</div><div>Enter term only to search across all criteria</div><br /><div class="bold">Valid search criteria</div><div>name, registered_name, phone, email, abn</div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_stock.html",'<div class="editable" ng-click="edit_stock()" ng-hide="editing_stock_info"><div ng-hide="stock.disable_tracking"><div class="row-fluid"><div class="column span3"><label>Current Qty.: {{stock.quantity}}</label></div><div class="column span3"><label>Allocated: {{stock.allocated_quantity}}</label></div><div class="column span3"><label>Ordered: {{stock.ordered_quantity}}</label></div><div class="column span3"><label>Available: {{stock.quantity - stock.allocated_quantity}}</label></div></div><hr /></div><div class="info"><label class="label-name-left auto-width">Stock Number:</label><span>{{stock.stock_number}}</span></div><div class="info"><label class="label-name-left auto-width">Barcode:</label><span>{{stock.barcode}}</span></div><div class="info"><label class="label-name-left auto-width">Stock Name:</label><span>{{stock.name}}</span></div><div class="info"><label class="label-name-left auto-width">Category:</label><span>{{stock.stock_category.name}}</span></div><div class="info" ng-show="stock.brand"><label class="label-name-left auto-width">Brand:</label><span>{{stock.brand}}</span></div><div class="info" ng-show="stock.model"><label class="label-name-left auto-width">Model:</label><span>{{stock.model}}</span></div><div class="info" ng-show="stock.size"><label class="label-name-left auto-width">Size:</label><span>{{stock.size}}</span></div><div class="info" ng-show="stock.weight"><label class="label-name-left auto-width">Weight:</label><span>{{stock.weight}}</span></div><div class="info" ng-hide="stock.disable_tracking"><label class="label-name-left auto-width">Quantity:</label><span>{{stock.quantity}}</span></div><div class="info"><label class="label-name-left auto-width">Unit Of Measure:</label><span>{{stock.unit_of_measure}}</span></div><div class="info"><label class="label-name-left auto-width">Location:</label><span>{{stock.location}}</span><span ng-show="stock.bin">&nbsp; Bin {{stock.bin}}</span></div><div class="info"><label class="label-name-left auto-width">Buy Price:</label><span>{{stock.buy_price|currency}}</span></div><div class="info" ng-show="stock.custom_and_duty"><label class="label-name-left auto-width">Custom And Duty:</label><span>{{stock.custom_and_duty|currency}}</span></div><div class="info"><label class="label-name-left auto-width">Average Cost:</label><span>{{stock.average_buy_price|currency}}</span></div><div class="info" ng-show="stock.price_group_id"><label class="label-name-left auto-width">Price Group:</label><span>{{stock.price_group.name}}</span></div><div ng-hide="stock.gst_free"><div class="info"><div class="inline label-name-left auto-width">Sell Price (excluded {{tax_name()|lowercase}}):</div><div class="inline"><span>{{stock.excluded_gst_prices|price_list}}</span></div></div><div class="info"><div class="inline label-name-left auto-width">Sell Price (included {{tax_name()|lowercase}}):</div><div class="inline"><span>{{stock.included_gst_prices|price_list}}</span></div></div></div><div ng-show="stock.gst_free"><div class="info"><div class="inline label-name-left auto-width">Sell Price ({{tax_name()|lowercase}} free):</div><div class="inline"><span>{{stock.included_gst_prices|price_list}}</span></div></div></div><div class="info" ng-show="stock.description"><label class="label-name-left auto-width">Specification:</label><span>{{stock.description}}</span></div><div class="info" ng-show="stock.description"><label class="label-name-left auto-width">Invoice Description:</label><span>{{stock.invoice_details}}</span></div></div><div ng-show="editing_stock_info"><form class="form-horizontal"><div class="control-group"><label class="control-label">Stock Number</label><div class="controls"><div class="error" ng-show="stock.editing.errors.stock_number">{{stock.editing.errors.stock_number|error}}</div><input ng-model="stock.editing.stock_number" type="text" /></div></div><div class="control-group"><label class="control-label">Name</label><div class="controls"><input class="span12" ng-model="stock.editing.name" type="text" /></div></div><div class="control-group"><label class="control-label">Is Kit?</label><div class="controls"><input ng-model="stock.editing.is_kit" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Category</label><div class="controls"><div ad-stock-category-selection="true" ng-model="stock.editing.stock_category_id"></div></div></div><div class="control-group"><label class="control-label">Location</label><div class="controls"><input class="input-small" ng-model="stock.editing.location" type="text" /><span>&nbsp; Bin &nbsp;</span><input class="input-tiny" ng-model="stock.editing.bin" type="text" /></div></div><hr /><div class="control-group"><label class="control-label">Barcode</label><div class="controls"><div class="error" ng-show="stock.editing.errors.barcode">{{stock.editing.errors.barcode|error}}</div><input ng-model="stock.editing.barcode" type="text" /><label class="checkbox"><input ng-model="stock.editing.generate_barcode" type="checkbox" /><span>&nbsp; Generate</span></label></div></div><div class="control-group"><label class="control-label">Brand</label><div class="controls"><input ng-model="stock.editing.brand" type="text" /></div></div><div class="control-group"><label class="control-label">Model</label><div class="controls"><input ng-model="stock.editing.model" type="text" /></div></div><div class="control-group"><label class="control-label">Size</label><div class="controls"><input class="input-small" ng-model="stock.editing.size" type="text" /></div></div><div class="control-group"><label class="control-label">Weight</label><div class="controls"><input class="input-small" ng-model="stock.editing.weight" type="text" /></div></div><hr /><div class="control-group"><label class="control-label">Quantity</label><div class="controls"><div class="inline" tooltip="To Edit the quantity, please create stock adjustment"><input class="input-mini" ng-hide="stock.editing.disable_tracking" ng-model="stock.quantity" readonly="true" type="text" /></div><label class="checkbox inline" style="margin-left: 5px;"><input ng-model="stock.editing.disable_tracking" type="checkbox" />nonstock item</label></div></div><div class="control-group"><label class="control-label">Unit Of Measure</label><div class="controls"><input class="input-small" ng-model="stock.editing.unit_of_measure" type="text" /></div></div><hr /><div class="control-group"><label class="control-label">{{tax_name()}} Free</label><div class="controls"><input class="input-mini" ng-model="stock.editing.gst_free" type="checkbox" /></div></div><div class="control-group" ng-show="price_groups().length &gt; 0"><label class="control-label">Price Group</label><div class="controls"><pricegrouppicker ng-model="stock.editing.price_group_id" price-group="stock.price_group"></pricegrouppicker><div class="red" ng-show="stock.editing.price_group_id != stock.price_group_id &amp;&amp; !auto_calculate_sell_prices"><span>Price Group is changed, please consider updating/recalculating the sell prices</span></div></div></div><div class="control-group" ng-show="automatic_price_update()"><label class="control-label">Disable Automatic Price Update</label><div class="controls"><input class="input-mini" ng-model="stock.editing.disable_automatic_price_update" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Buy Price</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;buy_price&#39;)" ng-model="stock.editing.buy_price" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.gst_free" style="width: 150px;"><div class="input-prepend"><span class="add-on">Includes {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;buy_price&#39;)" ng-model="stock.editing.with_gst.buy_price" step="any" type="number" /></div></div><div class="inline" style="margin-left: 25px"><label class="checkbox"><input ng-change="calculate_sell_prices()" ng-model="auto_calculate_sell_prices" type="checkbox" />Recalculate sell prices</label></div><br /><a href="javascript:void(0);" ng-click="add_custom_and_duty = true" ng-hide="add_custom_and_duty || stock.custom_and_duty">+ Custom & Duty</a></div></div><div class="control-group" ng-show="add_custom_and_duty || stock.custom_and_duty"><label class="control-label">Custom And Duty</label><div class="controls"><div class="inline" style="width: 100px"><input class="input-mini" ng-change="price_with_gst(&#39;custom_and_duty&#39;)" ng-model="stock.editing.custom_and_duty" type="number" /></div><div class="inline" ng-show="!stock.gst_free" style="width: 150px;"><div class="input-prepend"><span class="add-on">Includes {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;custom_and_duty&#39;)" ng-model="stock.editing.with_gst.custom_and_duty" step="any" type="number" /></div></div></div></div><br /><div class="control-group"><label class="control-label">{{configurations().price_level_1_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price&#39;)" ng-model="stock.editing.price" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.editing.gst_free" style="width: 200px;"><div class="input-prepend"><span class="add-on">Includes {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price&#39;)" ng-model="stock.editing.with_gst.price" step="any" type="text" /></div></div><div class="inline" ng-show="show_margin()" style="width: 150px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.editing.buy_price, stock.editing.price)}}%" /></div></div></div></div><div class="control-group"><label class="control-label">{{configurations().price_level_2_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price2&#39;)" ng-model="stock.editing.price2" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.editing.gst_free" style="width: 200px;"><div class="input-prepend"><span class="add-on">Includes {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price2&#39;)" ng-model="stock.editing.with_gst.price2" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 150px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.editing.buy_price, stock.editing.price2)}}%" /></div></div></div></div><div class="control-group"><label class="control-label">{{configurations().price_level_3_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price3&#39;)" ng-model="stock.editing.price3" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.editing.gst_free" style="width: 200px;"><div class="input-prepend"><span class="add-on">Includes {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price3&#39;)" ng-model="stock.editing.with_gst.price3" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 150px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.editing.buy_price, stock.editing.price3)}}%" /></div></div></div></div><div class="control-group"><label class="control-label">{{configurations().price_level_4_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price4&#39;)" ng-model="stock.editing.price4" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.editing.gst_free" style="width: 200px;"><div class="input-prepend"><span class="add-on">Includes {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price4&#39;)" ng-model="stock.editing.with_gst.price4" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 150px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.editing.buy_price, stock.editing.price4)}}%" /></div></div></div></div><div class="control-group"><label class="control-label">{{configurations().price_level_5_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price5&#39;)" ng-model="stock.editing.price5" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.editing.gst_free" style="width: 200px;"><div class="input-prepend"><span class="add-on">Includes {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price5&#39;)" ng-model="stock.editing.with_gst.price5" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 150px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.editing.buy_price, stock.editing.price5)}}%" /></div></div></div></div><div class="control-group"><label class="control-label">{{configurations().price_level_6_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price6&#39;)" ng-model="stock.editing.price6" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.editing.gst_free" style="width: 200px;"><div class="input-prepend"><span class="add-on">Includes {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price6&#39;)" ng-model="stock.editing.with_gst.price6" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 150px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.editing.buy_price, stock.editing.price6)}}%" /></div></div></div></div><div class="control-group"><label class="control-label">{{configurations().price_level_7_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price7&#39;)" ng-model="stock.editing.price7" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.editing.gst_free" style="width: 200px;"><div class="input-prepend"><span class="add-on">Includes {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price7&#39;)" ng-model="stock.editing.with_gst.price7" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 150px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.editing.buy_price, stock.editing.price7)}}%" /></div></div></div></div><div class="control-group"><label class="control-label">Average Cost</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-model="stock.editing.average_buy_price" step="any" type="number" /></div></div></div><div class="control-group"><label class="control-label">Specification/Note</label><div class="controls"><textarea class="span12" ng-model="stock.editing.description" rows="6" type="text"></textarea></div></div><hr /><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox inline" style="margin-left: 5px;"><input ng-model="stock.editing.hide_quantity_on_invoice" type="checkbox" />Hide Quantity On Invoice</label></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox inline" style="margin-left: 5px;"><input ng-model="stock.editing.is_non_discount" type="checkbox" />Non Discount (Invoice percentage discount does not apply to this item)</label></div></div><div class="control-group"><label class="control-label">Default Invoice Quantity</label><div class="controls"><input ng-model="stock.editing.default_quantity" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Invoice Description</label><div class="controls"><textarea class="span12" ng-model="stock.editing.invoice_details" rows="3" type="text"></textarea></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_stock()">Save</button><button class="btn" ng-click="cancel_edit_stock()">Cancel</button></div></div></form></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_stock_category_selection.html",'<select ng-model="stock_category_id" ng-options="stock_category.id as stock_category.name for stock_category in stock_categories"></select><button class="btn btn-link" id="{{create_stock_category_button_id}}" ng-click="new_stock_category()" ng-hide="disable_new" type="button">New</button><div id="{{create_stock_category_id}}"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">New Stock Category</div></div><div class="popover-content"><div class="row-fluid"><ng-form class="form-horizontal"><div class="content-box"><div class="control-group"><label class="control-label">Name*</label><div class="controls"><div class="error" ng-show="!stock_category_form.name">Name is required</div><input id="{{new_stock_category_name_input_id}}" ng-model="stock_category.name" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_stock_category()">Save</button><button class="btn" ng-click="cancel_new_stock_category()">Cancel</button></div></div></div></ng-form></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_stock_form.html",'<div class="row-fluid"><div class="column span6"><div class="sub-header">Stock</div><div class="control-group"><label class="control-label">Stock Number</label><div class="controls"><div ad-stock-number-warning="true" ng-model="stock"></div><div class="error" ng-show="stock.errors.stock_number">{{stock.errors.stock_number|error}}</div><input id="stock-number-input" ng-change="check_stock_number()" ng-model="stock.stock_number" type="text" /></div></div><div class="control-group"><label class="control-label">Name</label><div class="controls"><input class="span12" ng-model="stock.name" type="text" /></div></div><div class="control-group"><label class="control-label">Is Kit?</label><div class="controls"><input ng-model="stock.is_kit" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Category</label><div class="controls"><div ad-stock-category-selection="true" ng-model="stock.stock_category_id"></div></div></div><div class="control-group"><label class="control-label">Location</label><div class="controls"><input class="input-small" ng-model="stock.location" type="text" /><span>&nbsp; Bin &nbsp;</span><input class="input-tiny" ng-model="stock.bin" type="text" /></div></div><div class="control-group"><label class="control-label">Barcode</label><div class="controls"><div class="error" ng-show="stock.errors.barcode">{{stock.errors.barcode|error}}</div><input ng-model="stock.barcode" type="text" /><label class="checkbox"><input ng-model="stock.generate_barcode" type="checkbox" /><span>&nbsp; Generate</span></label></div></div><div class="control-group"><label class="control-label">Quantity</label><div class="controls"><input class="input-mini" ng-hide="stock.disable_tracking" ng-model="stock.quantity" type="text" /><label class="checkbox inline" style="margin-left: 5px;"><input ng-model="stock.disable_tracking" type="checkbox" />nonstock item</label></div></div><div class="control-group"><label class="control-label">Unit Of Measure</label><div class="controls"><input class="input-small" ng-model="stock.unit_of_measure" type="text" /></div></div><div class="control-group"><label class="control-label">{{tax_name()}} Free?</label><div class="controls"><input class="input-mini" ng-model="stock.gst_free" type="checkbox" /></div></div><div class="control-group" ng-show="price_groups().length &gt; 0"><label class="control-label">Price Group</label><div class="controls"><pricegrouppicker ng-model="stock.price_group_id" price-group="stock.price_group"></pricegrouppicker></div></div><div class="control-group" ng-show="automatic_price_update()"><label class="control-label">Disable Automatic Price Update</label><div class="controls"><input class="input-mini" ng-model="stock.disable_automatic_price_update" type="checkbox" /></div></div><hr /><div class="sub-header">Prices</div><div class="control-group"><label class="control-label">Buy Price</label><div class="controls"><div class="inline" style="width: 100px"><input class="input-mini" ng-change="price_with_gst(&#39;buy_price&#39;)" ng-model="stock.buy_price" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.gst_free" style="width: 170px;"><div class="input-prepend"><span class="add-on">Incl. {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;buy_price&#39;)" ng-model="stock.with_gst.buy_price" step="any" type="number" /></div></div><br /><a href="javascript:void(0);" ng-click="add_custom_and_duty = true" ng-hide="add_custom_and_duty">+ Custom & Duty</a></div></div><div class="control-group" ng-show="add_custom_and_duty"><label class="control-label">Custom And Duty</label><div class="controls"><div class="inline" style="width: 100px"><input class="input-mini" ng-change="price_with_gst(&#39;custom_and_duty&#39;)" ng-model="stock.custom_and_duty" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.gst_free" style="width: 170px;"><div class="input-prepend"><span class="add-on">Incl. {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;custom_and_duty&#39;)" ng-model="stock.with_gst.custom_and_duty" step="any" type="number" /></div></div></div></div><div class="control-group"><label class="control-label">{{configurations().price_level_1_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price&#39;)" ng-model="stock.price" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.gst_free" style="width: 170px;"><div class="input-prepend"><span class="add-on">Incl. {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price&#39;)" ng-model="stock.with_gst.price" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 130px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.buy_price, stock.price)}}%" /></div></div></div></div><div class="control-group"><label class="control-label">{{configurations().price_level_2_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price2&#39;)" ng-model="stock.price2" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.gst_free" style="width: 170px;"><div class="input-prepend"><span class="add-on">Incl. {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price2&#39;)" ng-model="stock.with_gst.price2" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 130px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.buy_price, stock.price2)}}%" /></div></div></div></div><div class="control-group"><label class="control-label">{{configurations().price_level_3_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price3&#39;)" ng-model="stock.price3" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.gst_free" style="width: 170px;"><div class="input-prepend"><span class="add-on">Incl. {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price3&#39;)" ng-model="stock.with_gst.price3" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 130px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.buy_price, stock.price3)}}%" /></div></div></div></div><div class="control-group"><label class="control-label">{{configurations().price_level_4_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price4&#39;)" ng-model="stock.price4" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.gst_free" style="width: 170px;"><div class="input-prepend"><span class="add-on">Incl. {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price4&#39;)" ng-model="stock.with_gst.price4" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 130px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.buy_price, stock.price4)}}%" /></div></div></div></div><div class="control-group" ng-hide="more_price_lvl"><label class="control-label"></label><div class="controls"><button class="btn btn-link" ng-click="more_price_lvl = true">More Pricing Levels</button></div></div><div ng-show="more_price_lvl"><div class="control-group"><label class="control-label">{{configurations().price_level_5_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price5&#39;)" ng-model="stock.price5" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.gst_free" style="width: 170px;"><div class="input-prepend"><span class="add-on">Incl. {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price5&#39;)" ng-model="stock.with_gst.price5" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 130px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.buy_price, stock.price5)}}%" /></div></div></div></div><div class="control-group"><label class="control-label">{{configurations().price_level_6_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price6&#39;)" ng-model="stock.price6" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.gst_free" style="width: 170px;"><div class="input-prepend"><span class="add-on">Incl. {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price6&#39;)" ng-model="stock.with_gst.price6" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 130px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.buy_price, stock.price6)}}%" /></div></div></div></div><div class="control-group"><label class="control-label">{{configurations().price_level_7_name}}</label><div class="controls"><div class="inline" style="width: 100px;"><input class="input-mini" ng-change="price_with_gst(&#39;price7&#39;)" ng-model="stock.price7" step="any" type="number" /></div><div class="inline" ng-show="!prices_include_gst() &amp;&amp; !stock.gst_free" style="width: 170px;"><div class="input-prepend"><span class="add-on">Incl. {{tax_name()}}</span><input class="input-mini" ng-change="price_without_gst(&#39;price7&#39;)" ng-model="stock.with_gst.price7" step="any" type="number" /></div></div><div class="inline" ng-show="show_margin()" style="width: 130px;"><div class="input-prepend"><span class="add-on">Margin</span><input class="input-mini" readonly="true" type="text" value="{{calculate_margin(stock.buy_price, stock.price7)}}%" /></div></div></div></div></div><hr /><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox inline" style="margin-left: 5px;"><input ng-model="stock.hide_quantity_on_invoice" type="checkbox" />Hide Quantity On Invoice</label></div></div><div class="control-group"><label class="control-label"><div>Default Invoice Quantity</div></label><div class="controls"><input class="input-small" ng-model="stock.default_quantity" step="any" type="number" /></div></div><div class="control-group"><label class="control-label"><div>Invoice Description</div></label><div class="controls"><textarea class="span12" ng-model="stock.invoice_details" rows="3" type="text"></textarea></div></div></div><div class="column span5"><div class="sub-header">Supplier</div><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><supplierpicker ng-model="stock.supplier_id" placement="right" supplier="stock.supplier"></supplierpicker></div></div><div class="control-group"><label class="control-label">Supplier Stock No#</label><div class="controls"><input ng-model="stock.supplier_stock_number" type="text" /></div></div><div class="control-group"><label class="control-label">Supplier SKU</label><div class="controls"><input ng-model="stock.supplier_stock_sku" type="text" /></div></div><hr /><div class="sub-header">Specification</div><div class="control-group"><label class="control-label">Brand</label><div class="controls"><input ng-model="stock.brand" type="text" /></div></div><div class="control-group"><label class="control-label">Model</label><div class="controls"><input ng-model="stock.model" type="text" /></div></div><div class="control-group"><label class="control-label">Size</label><div class="controls"><input class="input-small" ng-model="stock.size" type="text" /></div></div><div class="control-group"><label class="control-label">Weight</label><div class="controls"><input class="input-small" ng-model="stock.weight" type="text" /></div></div><div class="control-group"><label class="control-label">Specification/Note</label><div class="controls"><textarea class="span12" ng-model="stock.description" rows="3" type="text"></textarea></div></div><hr /><div class="sub-header">Accounting</div><div class="control-group"><label class="control-label">Purchase Account</label><div class="controls"><select ng-model="stock.purchase_account_id" ng-options="account.id as account.title for account in input_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Sale Account</label><div class="controls"><select ng-model="stock.sale_account_id" ng-options="account.id as account.title for account in output_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Inventory Asset Account</label><div class="controls"><select ng-model="stock.inventory_asset_account_id" ng-options="account.id as account.title for account in inventory_accounts()"><option value=""></option></select><br /><div class="bold">Please note:</div><div>Only set inventory asset account if you enable tracking for this item in your accounting software(E.g Xero or MYOB). Setup tracking inventory is NOT recommended as it requires some manual setup. If you are not sure please contact our support team for more details.</div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_stock_info.html",'<div id="stock-info-popover"><div class="popover fade left in" style="width: 800px"><div class="popover-title"><div class="row-fluid"><div class="pull-right"><a class="btn" ng-href="#/stocks/{{stock.id}}" target="_blank">Full Details</a><i class="goto icon-remove" ng-click="hide()"></i></div><div class="sub-header">{{stock.number}} {{stock.name}}</div></div></div><div class="popover-content"><div class="spinner" id="stock-info-spinner"></div><div class="row-fluid"><div class="content-box"><div ad-stock="true" ng-model="stock"></div></div><center><button class="btn" ng-click="hide()"> Close</button></center></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_stock_number_warning.html",'<div ng-show="matches.length &gt; 0 &amp;&amp; !stock.id"><span class="red">Stock Number {{stock.stock_number}} already exists</span><br /></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_stockpicker.html",'<div class="inline"><input autocomplete="off" id="{{input_id}}" name="description" ng-maxlength="255" ng-model="item.description" required="true" type="text" typeahead="item.lookup_text for item in lookup($viewValue)" typeahead-on-select="select($item, $model, $label, item)" /><div class="spinner spinner-small" id="lookup-stock-spinner-{{spinner_id}}"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_supplier_form.html",'<form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input ng-model="supplier.name" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox"><input ng-model="supplier.is_creditor" type="checkbox" /><span>Is Creditor/Buying Group</span><div>(E.g Capricorn)</div></label></div></div><div class="control-group"><label class="control-label">Account Number</label><div class="controls"><input ng-model="supplier.account_number" type="text" /></div></div><div class="control-group" ng-show="country() == &#39;au&#39;"><label class="control-label">ABN</label><div class="controls"><input ng-model="supplier.abn" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="supplier.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Mobile</label><div class="controls"><input ng-model="supplier.mobile" type="text" /></div></div><div class="control-group"><label class="control-label">Fax</label><div class="controls"><input ng-model="supplier.fax" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input ng-model="supplier.email" type="text" /></div></div><div class="control-group"><label class="control-label">Contact Person</label><div class="controls"><input ng-model="supplier.contact_name" type="text" /></div></div><div addresspicker="true" ng-model="supplier.address"></div><div class="control-group" ng-hide="supplier.street_address"><label class="control-label"></label><div class="controls"><button class="btn btn-link" ng-click="add_street_address()">Add Street Address</button><br /><br /></div></div><div ng-show="supplier.street_address"><addresspicker address-label="Street Address" ng-model="supplier.street_address"></addresspicker></div><div class="control-group"><label class="control-label">Payment Term</label><div class="controls"><select ng-model="supplier.payment_term" ng-options="payment_term.value as payment_term.name for payment_term in payment_terms" type="text"></select></div></div><div class="control-group"><label class="control-label">Bank Account Details</label><div class="controls"><textarea ng-model="supplier.bank_account_details" rows="4"></textarea></div></div><div class="control-group" ng-hide="supplier.is_creditor"><label class="control-label">Creditor/Buying Group</label><div class="controls"><div creditorpicker="true" ng-model="supplier.creditor_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-link" ng-click="show_more_supplier_fields()" ng-hide="showing_more_supplier_fields">More Details</button></div></div><div ng-show="showing_more_supplier_fields"><div class="control-group"><label class="control-label">Registered Name</label><div class="controls"><input ng-model="supplier.registered_name" type="text" /></div></div><div class="control-group" ng-show="country() == &#39;au&#39;"><label class="control-label">ACN</label><div class="controls"><input ng-model="supplier.acn" type="text" /></div></div><div class="control-group"><label class="control-label">Shipping Instruction</label><div class="controls"><div ng-hide="supplier.shipping_instruction || supplier.show_shipping_instruction"><div>Only set this if you have special shipping instruction for this supplier</div><a href="javascript:void(0);" ng-click="supplier.show_shipping_instruction=true">Set Shipping Instruction</a></div><div ng-show="supplier.shipping_instruction || supplier.show_shipping_instruction"><textarea ng-model="supplier.shipping_instruction"></textarea></div></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save()" type="button">Save</button><button class="btn" ng-click="cancel()">Cancel</button><div class="spinner" id="create-supplier-spinner"></div></div></div></form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_supplier_transaction_history.html",'<div class="row-fluid"><div class="column span8"><div><label class="checkbox"><span>Show unpaid only</span><input ng-click="fetch_supplier_history(1)" ng-model="show_unpaid_only" type="checkbox" /></label><div><a href="javascript:void(0);" ng-click="more_filters = true" ng-hide="more_filters">More Filters</a></div></div><div class="row-fluid" ng-show="more_filters"><div class="column span7" ng-show="supplier.is_creditor"><div><span>Original Supplier</span><a href="javascript:void(0);" ng-click="reset_original_supplier()" ng-show="original_supplier.id" style="margin-left: 20px">Show All</a></div><supplierpicker disable-new="true" ng-model="original_supplier.id" supplier="original_supplier"></supplierpicker></div><div class="column span5"><div>Date</div><ad-datepicker ng-model="date"></ad-datepicker></div></div></div><div class="column span4"><div class="pull-right"><div style="text-align: right;"><span ng-class="{red: balance &gt; 0, green: balance == 0}">Balance: {{balance|currency}}</span></div><div style="text-align: right;"><span>Bill: {{bill_balance|currency}}</span></div><div style="text-align: right;"><span class="green">Credit: {{credit_balance|currency}}</span></div></div></div></div><br /><div class="spinner" id="supplier-transaction-history-spinner"></div><table class="table table-striped" id="supplier-transaction-history"><thead><tr><th><div class="row-fluid"><div class="column span1"><div>Type</div></div><div class="column span2"><div>Supplier</div></div><div class="column span2"><div>Issue Date</div></div><div class="column span2"><div>Reference</div></div><div class="column span2"><div>Amount</div></div><div class="column span2"><div>Remaining</div></div><div class="column span1"></div></div></th></tr></thead><tbody><tr class="goto" ng-click="select(transaction)" ng-repeat="transaction in transactions"><td><div class="row-fluid"><div class="column span1"><div><span class="yellow" ng-show="transaction.type == &#39;credit note&#39;">CR</span><span ng-show="transaction.type == &#39;bill&#39;">Bill</span></div></div><div class="column span2"><div>{{transaction.supplier.name}}</div></div><div class="column span2"><div>{{transaction.date|date: \'mediumDate\'}}</div></div><div class="column span2"><div>{{transaction.reference}}</div></div><div class="column span2"><div>{{transaction.total_amount|currency}}</div></div><div class="column span2"><div><span ng-class="{red: transaction.unpaid_amount &gt; 0}" ng-show="transaction.type == &#39;bill&#39;">{{transaction.unpaid_amount|currency}}</span><span ng-class="{green: transaction.unallocated_amount &gt; 0}" ng-show="transaction.type == &#39;credit note&#39;">{{transaction.unallocated_amount|currency}}</span></div></div><div class="column span1"><a href="javascript:void(0);" ng-click="preview(transaction)" stop-event="click">Preview</a></div></div></td></tr></tbody></table><pagination boundary-links="true" current-page="current_page" max-size="3" num-pages="total_pages" on-select-page="get_transaction_page(page)" rotate="false"></pagination><div ad-bill-viewer="true" anchor-element="#supplier-transaction-history" bill="previewed_bill" placement="top" showing="previewed_bill"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_tag_icons.html",'<div class="inline" ng-repeat="tag in owner.tags" style="background-color: {{tag.color_code}}; vertical-align: top; padding-right: 5px; width: 18px; height: 18px; margin-right: 2px; border-radius: 3px" tooltip="{{tag.name}}"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_tag_labels.html",'<div class="inline"><label class="label" ng-repeat="tag in owner.tags" style="height: 25px; background-color: {{tag.color_code}}; margin-left: 2px; margin-right: 2px">{{tag.name}}</label></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_tags.html",'<div id="{{tag_popover_id}}"><div class="popover fade left in" style="width: 450px"><div class="popover-title"><div class="sub-header">tags</div></div><div class="popover-content"><div class="content-box"><div class="taggable" ng-repeat="tag in tags()" style="margin-bottom: 10px"><div class="row-fluid" ng-show="has_tag(tag)" style="background-color: {{tag.color_code}}; width: 98%; margin-top: 10px"><div class="column span7"><div class="inline" style="vertical-align: top; padding-left: 10px; padding-right: 10px; padding-top: 3px; padding-bottom: 3px; color: white; height: 36px">{{tag.name}}</div></div><div class="column span5"><div class="pull-right"><div class="button-pannel"><button class="btn btn-link" ng-click="remove_tag(tag)" style="color: white">Remove</button></div></div></div></div><div class="row-fluid" ng-hide="has_tag(tag)" style="background-color: white; width: 98%; margin-top: 10px; padding-top: 3px; padding-bottom: 3px;"><div class="column span7"><div class="inline" style="background-color: {{tag.color_code}}; width: 30px; height: 30px;"></div><div class="inline" style="vertical-align: top; padding-left: 10px; padding-right: 10px">{{tag.name}}</div></div><div class="column span5"><div class="pull-right"><div class="button-pannel"><button class="btn btn-link" ng-click="add_tag(tag)">Add</button><button class="btn btn-link" ng-click="switch_tag(tag)">Switch</button></div></div></div></div></div><br /><br /><div class="bold">new tag</div><form><input ng-model="new_tag.name" style="vertical-align: bottom; margin-bottom: 0px; margin-right: 10px" type="text" /><spectrum-colorpicker format="&#39;hex&#39;" ng-model="new_tag.color_code"></spectrum-colorpicker><button class="btn btn-link" ng-click="add_tag(new_tag)">save</button></form><br /><div><a href="javascript:void(0)" ng-click="add_tag(new_tag, false)">add another</a><div class="spinner" id="ad-tags-spinner"></div></div></div><br /><button class="btn" ng-click="hide()">close</button></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_timepicker.html",'<div class="inline"><select class="input-small" ng-change="set_time()" ng-model="selected_time" style="width: 110px;" type="text" ui-select2="true"><option value="">N/A</option><option value="0:0"> 0.00 am</option><option value="0:5"> 0.05 am</option><option value="0:10">0.10 am</option><option value="0:15">0.15 am</option><option value="0:20">0.20 am</option><option value="0:25">0.25 am</option><option value="0:30">0.30 am</option><option value="0:35">0.35 am</option><option value="0:40">0.40 am</option><option value="0:45">0.45 am</option><option value="0:50">0.50 am</option><option value="0:55">0.55 am</option><option value="1:0"> 1.00 am</option><option value="1:5"> 1.05 am</option><option value="1:10">1.10 am</option><option value="1:15">1.15 am</option><option value="1:20">1.20 am</option><option value="1:25">1.25 am</option><option value="1:30">1.30 am</option><option value="1:35">1.35 am</option><option value="1:40">1.40 am</option><option value="1:45">1.45 am</option><option value="1:50">1.50 am</option><option value="1:55">1.55 am</option><option value="2:0"> 2.00 am</option><option value="2:5"> 2.05 am</option><option value="2:10">2.10 am</option><option value="2:15">2.15 am</option><option value="2:20">2.20 am</option><option value="2:25">2.25 am</option><option value="2:30">2.30 am</option><option value="2:35">2.35 am</option><option value="2:40">2.40 am</option><option value="2:45">2.45 am</option><option value="2:50">2.50 am</option><option value="2:55">2.55 am</option><option value="3:0"> 3.00 am</option><option value="3:5"> 3.05 am</option><option value="3:10">3.10 am</option><option value="3:15">3.15 am</option><option value="3:20">3.20 am</option><option value="3:25">3.25 am</option><option value="3:30">3.30 am</option><option value="3:35">3.35 am</option><option value="3:40">3.40 am</option><option value="3:45">3.45 am</option><option value="3:50">3.50 am</option><option value="3:55">3.55 am</option><option value="4:0"> 4.00 am</option><option value="4:5"> 4.05 am</option><option value="4:10">4.10 am</option><option value="4:15">4.15 am</option><option value="4:20">4.20 am</option><option value="4:25">4.25 am</option><option value="4:30">4.30 am</option><option value="4:35">4.35 am</option><option value="4:40">4.40 am</option><option value="4:45">4.45 am</option><option value="4:50">4.50 am</option><option value="4:55">4.55 am</option><option value="5:0"> 5.00 am</option><option value="5:5"> 5.05 am</option><option value="5:10">5.10 am</option><option value="5:15">5.15 am</option><option value="5:20">5.20 am</option><option value="5:25">5.25 am</option><option value="5:30">5.30 am</option><option value="5:35">5.35 am</option><option value="5:40">5.40 am</option><option value="5:45">5.45 am</option><option value="5:50">5.50 am</option><option value="5:55">5.55 am</option><option value="6:0"> 6.00 am</option><option value="6:5"> 6.05 am</option><option value="6:10">6.10 am</option><option value="6:15">6.15 am</option><option value="6:20">6.20 am</option><option value="6:25">6.25 am</option><option value="6:30">6.30 am</option><option value="6:35">6.35 am</option><option value="6:40">6.40 am</option><option value="6:45">6.45 am</option><option value="6:50">6.50 am</option><option value="6:55">6.55 am</option><option value="7:0"> 7.00 am</option><option value="7:5"> 7.05 am</option><option value="7:10">7.10 am</option><option value="7:15">7.15 am</option><option value="7:20">7.20 am</option><option value="7:25">7.25 am</option><option value="7:30">7.30 am</option><option value="7:35">7.35 am</option><option value="7:40">7.40 am</option><option value="7:45">7.45 am</option><option value="7:50">7.50 am</option><option value="7:55">7.55 am</option><option value="8:0"> 8.00 am</option><option value="8:5"> 8.05 am</option><option value="8:10">8.10 am</option><option value="8:15">8.15 am</option><option value="8:20">8.20 am</option><option value="8:25">8.25 am</option><option value="8:30">8.30 am</option><option value="8:35">8.35 am</option><option value="8:40">8.40 am</option><option value="8:45">8.45 am</option><option value="8:50">8.50 am</option><option value="8:55">8.55 am</option><option value="9:0"> 9.00 am</option><option value="9:5"> 9.05 am</option><option value="9:10">9.10 am</option><option value="9:15">9.15 am</option><option value="9:20">9.20 am</option><option value="9:25">9.25 am</option><option value="9:30">9.30 am</option><option value="9:35">9.35 am</option><option value="9:40">9.40 am</option><option value="9:45">9.45 am</option><option value="9:50">9.50 am</option><option value="9:55">9.55 am</option><option value="10:0"> 10.00 am</option><option value="10:5"> 10.05 am</option><option value="10:10">10.10 am</option><option value="10:15">10.15 am</option><option value="10:20">10.20 am</option><option value="10:25">10.25 am</option><option value="10:30">10.30 am</option><option value="10:35">10.35 am</option><option value="10:40">10.40 am</option><option value="10:45">10.45 am</option><option value="10:50">10.50 am</option><option value="10:55">10.55 am</option><option value="11:0"> 11.00 am</option><option value="11:5"> 11.05 am</option><option value="11:10">11.10 am</option><option value="11:15">11.15 am</option><option value="11:20">11.20 am</option><option value="11:25">11.25 am</option><option value="11:30">11.30 am</option><option value="11:35">11.35 am</option><option value="11:40">11.40 am</option><option value="11:45">11.45 am</option><option value="11:50">11.50 am</option><option value="11:55">11.55 am</option><option value="12:0"> 12.00 pm</option><option value="12:5"> 12.05 pm</option><option value="12:10">12.10 pm</option><option value="12:15">12.15 pm</option><option value="12:20">12.20 pm</option><option value="12:25">12.25 pm</option><option value="12:30">12.30 pm</option><option value="12:35">12.35 pm</option><option value="12:40">12.40 pm</option><option value="12:45">12.45 pm</option><option value="12:50">12.50 pm</option><option value="12:55">12.55 pm</option><option value="13:0"> 1.00 pm</option><option value="13:5"> 1.05 pm</option><option value="13:10">1.10 pm</option><option value="13:15">1.15 pm</option><option value="13:20">1.20 pm</option><option value="13:25">1.25 pm</option><option value="13:30">1.30 pm</option><option value="13:35">1.35 pm</option><option value="13:40">1.40 pm</option><option value="13:45">1.45 pm</option><option value="13:50">1.50 pm</option><option value="13:55">1.55 pm</option><option value="14:0"> 2.00 pm</option><option value="14:5"> 2.05 pm</option><option value="14:10">2.10 pm</option><option value="14:15">2.15 pm</option><option value="14:20">2.20 pm</option><option value="14:25">2.25 pm</option><option value="14:30">2.30 pm</option><option value="14:35">2.35 pm</option><option value="14:40">2.40 pm</option><option value="14:45">2.45 pm</option><option value="14:50">2.50 pm</option><option value="14:55">2.55 pm</option><option value="15:0"> 3.00 pm</option><option value="15:5"> 3.05 pm</option><option value="15:10">3.10 pm</option><option value="15:15">3.15 pm</option><option value="15:20">3.20 pm</option><option value="15:25">3.25 pm</option><option value="15:30">3.30 pm</option><option value="15:35">3.35 pm</option><option value="15:40">3.40 pm</option><option value="15:45">3.45 pm</option><option value="15:50">3.50 pm</option><option value="15:55">3.55 pm</option><option value="16:0"> 4.00 pm</option><option value="16:5"> 4.05 pm</option><option value="16:10">4.10 pm</option><option value="16:15">4.15 pm</option><option value="16:20">4.20 pm</option><option value="16:25">4.25 pm</option><option value="16:30">4.30 pm</option><option value="16:35">4.35 pm</option><option value="16:40">4.40 pm</option><option value="16:45">4.45 pm</option><option value="16:50">4.50 pm</option><option value="16:55">4.55 pm</option><option value="17:0"> 5.00 pm</option><option value="17:5"> 5.05 pm</option><option value="17:10">5.10 pm</option><option value="17:15">5.15 pm</option><option value="17:20">5.20 pm</option><option value="17:25">5.25 pm</option><option value="17:30">5.30 pm</option><option value="17:35">5.35 pm</option><option value="17:40">5.40 pm</option><option value="17:45">5.45 pm</option><option value="17:50">5.50 pm</option><option value="17:55">5.55 pm</option><option value="18:0"> 6.00 pm</option><option value="18:5"> 6.05 pm</option><option value="18:10">6.10 pm</option><option value="18:15">6.15 pm</option><option value="18:20">6.20 pm</option><option value="18:25">6.25 pm</option><option value="18:30">6.30 pm</option><option value="18:35">6.35 pm</option><option value="18:40">6.40 pm</option><option value="18:45">6.45 pm</option><option value="18:50">6.50 pm</option><option value="18:55">6.55 pm</option><option value="19:0"> 7.00 pm</option><option value="19:5"> 7.05 pm</option><option value="19:10">7.10 pm</option><option value="19:15">7.15 pm</option><option value="19:20">7.20 pm</option><option value="19:25">7.25 pm</option><option value="19:30">7.30 pm</option><option value="19:35">7.35 pm</option><option value="19:40">7.40 pm</option><option value="19:45">7.45 pm</option><option value="19:50">7.50 pm</option><option value="19:55">7.55 pm</option><option value="20:0"> 8.00 pm</option><option value="20:5"> 8.05 pm</option><option value="20:10">8.10 pm</option><option value="20:15">8.15 pm</option><option value="20:20">8.20 pm</option><option value="20:25">8.25 pm</option><option value="20:30">8.30 pm</option><option value="20:35">8.35 pm</option><option value="20:40">8.40 pm</option><option value="20:45">8.45 pm</option><option value="20:50">8.50 pm</option><option value="20:55">8.55 pm</option><option value="21:0"> 9.00 pm</option><option value="21:5"> 9.05 pm</option><option value="21:10">9.10 pm</option><option value="21:15">9.15 pm</option><option value="21:20">9.20 pm</option><option value="21:25">9.25 pm</option><option value="21:30">9.30 pm</option><option value="21:35">9.35 pm</option><option value="21:40">9.40 pm</option><option value="21:45">9.45 pm</option><option value="21:50">9.50 pm</option><option value="21:55">9.55 pm</option><option value="22:0"> 10.00 pm</option><option value="22:5"> 10.05 pm</option><option value="22:10">10.10 pm</option><option value="22:15">10.15 pm</option><option value="22:20">10.20 pm</option><option value="22:25">10.25 pm</option><option value="22:30">10.30 pm</option><option value="22:35">10.35 pm</option><option value="22:40">10.40 pm</option><option value="22:45">10.45 pm</option><option value="22:50">10.50 pm</option><option value="22:55">10.55 pm</option><option value="23:0"> 11.00 pm</option><option value="23:5"> 11.05 pm</option><option value="23:10">11.10 pm</option><option value="23:15">11.15 pm</option><option value="23:20">11.20 pm</option><option value="23:25">11.25 pm</option><option value="23:30">11.30 pm</option><option value="23:35">11.35 pm</option><option value="23:40">11.40 pm</option><option value="23:45">11.45 pm</option><option value="23:50">11.50 pm</option><option value="23:55">11.55 pm</option></select></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_tracking_category_selection.html",'<div class="control-group" ng-repeat="category in tracking_categories()"><label class="control-label">{{category.name}}</label><div class="controls"><select class="inline" ng-change="toggle_selection(category)" ng-model="category.selected_option" ng-options="option.name as option.name for option in category.options"><option value=""></option></select></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_transaction_history.html",'<div class="content-nav"><ul><li ng-class="{active: content==&#39;invoices&#39;}" ng-click="show_content(&#39;invoices&#39;)"><a>Invoices</a></li><li ng-class="{active: content==&#39;payments&#39;}" ng-click="show_content(&#39;payments&#39;)"><a>Payments</a></li><li ng-class="{active: content == &#39;quotes&#39;}" ng-click="show_content(&#39;quotes&#39;)"><a>Quotes</a></li></ul></div><div class="content-box"><div ng-show="content==&#39;invoices&#39;"><div class="container-fluid"><div class="row-fluid"><div class="pull-left"><label class="checkbox"><span>Show unpaid only</span><input ng-click="fetch_customer_transactions()" ng-model="show_unpaid_only" type="checkbox" /></label><label class="checkbox"><span>Show unfinalized only</span><input ng-click="fetch_customer_transactions()" ng-model="show_unfinalized_only" type="checkbox" /></label></div><div class="pull-right"><div style="text-align: right;"><span ng-class="{red: balance &gt; 0, green: balance == 0}">Balance: {{balance|currency}}</span></div><div style="text-align: right;"><span>Invoice: {{invoice_balance|currency}}</span></div><div style="text-align: right;"><span class="green">Credit: {{credit_balance|currency}}</span></div></div></div><br /><div class="spinner" id="transaction-history-spinner"></div><div id="transaction-history-list"></div><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span2"><div>No.</div></div><div class="column span2"><div>Iss. Date</div></div><div class="column span2"><div>Desc.</div></div><div class="column span2"><div>Amount</div></div><div class="column span2"><div>Remain</div></div><div class="column span1"><div>&nbsp;</div></div></div></th></tr></thead><tbody><tr class="goto" ng-click="select(transaction)" ng-repeat="transaction in transactions"><td><div class="row-fluid"><div class="column span2"><div ng-class="{&#39;green&#39;: transaction.finalized, &#39;blue&#39;: !transaction.finalized}"><span class="yellow" ng-show="transaction.type == &#39;credit note&#39;">{{transaction.number}}</span><span ng-show="transaction.type == &#39;invoice&#39;">{{transaction.number}}</span></div></div><div class="column span2"><div>{{transaction.issue_date|date: \'shortDate\'}} &nbsp;</div></div><div class="column span2"><div>{{transaction.description}} &nbsp;</div></div><div class="column span2"><div>{{transaction.total_amount|currency}} &nbsp;</div></div><div class="column span2"><div ng-class="{red: transaction.unpaid_amount &gt; 0}" ng-show="transaction.type == &#39;invoice&#39;">{{transaction.unpaid_amount|currency}} &nbsp;</div><div ng-class="{green: transaction.unallocated_amount &gt; 0}" ng-show="transaction.type == &#39;credit note&#39;">{{transaction.unallocated_amount|currency}} &nbsp;</div></div><div class="column span1"><a href="javascript:void(0)" ng-click="preview(transaction)" stop-event="click">Preview</a></div></div></td></tr></tbody></table><pagination boundary-links="true" current-page="current_txn_page" max-size="3" num-pages="total_txn_pages" on-select-page="get_transaction_page(page)" rotate="false"></pagination></div></div><div ng-show="content==&#39;payments&#39;"><div><label class="checkbox"><span>Show unallocated only</span><input ng-click="fetch_customer_payments()" ng-model="show_unallocated_only" type="checkbox" /></label></div><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span2"><div>No.</div></div><div class="column span2"><div>Date</div></div><div class="column span2"><div>Paymt Type</div></div><div class="column span2"><div>Ref.</div></div><div class="column span2"><div>Amount</div></div><div class="column span2"><div>Remain</div></div></div></th></tr></thead><tbody><tr class="goto" ng-click="select_payment(payment)" ng-repeat="payment in payments"><td><div class="row-fluid"><div class="column span2"><div ng-class="{&#39;green&#39;: payment.finalized, &#39;blue&#39;: !payment.finalized}">{{payment.number}}</div></div><div class="column span2"><div>{{payment.date|date: \'shortDate\'}}</div></div><div class="column span2"><div>{{payment.payment_type_name}}</div></div><div class="column span2"><div>{{payment.reference}}</div></div><div class="column span2"><div>{{payment.amount|currency}}</div></div><div class="column span2"><div>{{payment.unallocated_amount|currency}}</div></div></div></td></tr></tbody></table><pagination boundary-links="true" current-page="current_payment_page" max-size="3" num-pages="total_payment_pages" on-select-page="get_payment_page(page)" rotate="false"></pagination></div><div ng-show="content==&#39;quotes&#39;"><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span3"><div>No.</div></div><div class="column span3"><div>Date</div></div><div class="column span6"><div>Desc.</div></div></div></th></tr></thead><tbody><tr class="goto" ng-click="select_quote(quote)" ng-repeat="quote in quotes"><td><div class="row-fluid"><div class="column span3"><div>{{quote.number}}</div></div><div class="column span3"><div>{{quote.issue_date | date: "shortDate"}}</div></div><div class="column span6"><div>{{quote.description}}</div></div></div></td></tr></tbody></table><pagination boundary-links="true" current-page="current_quote_page" max-size="3" num-pages="total_quote_pages" on-select-page="get_quote_page(page)" rotate="false"></pagination></div><div ad-invoice-viewer="true" anchor-element="&#39;#transaction-history-list&#39;" invoice="previewed_invoice" placement="top" showing="previewed_invoice"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_transfer_vehicle.html",'<div id="vehicle-transfer-popover"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header">Transfer {{asset_name()}}</div></div><div class="popover-content"><div class="content-box"><div class="row-fluid"><div class="column span6"><div class="sub-header">Vehicle</div><div customer="customer" input-id="selected-vehicle-picker-input" vehicle="selected_vehicle" vehiclepicker="true"></div></div><div class="column span6"><div style="margin-left: 30px"><div class="sub-header">Transfer To</div><div customer="selected_customer" customerpicker="true" on-select="select_customer()"></div><div><div class="sub-header">Selected Customer</div><div class="well" ng-hide="selected_customer.id"><b>Note:</b> <span>Please use the input above to search for customers and</span> <b>Select a customer from the dropdown.</b></div><div ng-show="selected_customer.id"><div ng-show="selected_customer.name"><span class="label-text-left auto-width">Name:</span> <span>{{selected_customer.name}}</span></div><div ng-show="selected_customer.phone"><span class="label-text-left auto-width">Phone:</span> <span>{{selected_customer.phone}}</span></div><div ng-show="selected_customer.mobile"><span class="label-text-left auto-width">Mobile:</span> <span>{{selected_customer.mobile}}</span></div><div ng-show="selected_customer.fax"><span class="label-text-left auto-width">Fax:</span> <span>{{selected_customer.fax}}</span></div><div ng-show="selected_customer.address.full_address"><span class="label-text-left auto-width">Address:</span> <span>{{selected_customer.address.full_address}}</span></div></div></div></div></div></div></div><div class="row-fluid"><button class="btn btn-primary" ng-click="transfer()">Transfer</button><button class="btn" ng-click="hide()">Cancel</button></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_tyro_payment.html",'<div ng-show="tyro_account()"><div class="green" ng-show="enabled()"><div class="inline"><img src="/assets/tyro-17e8f1c9a3d948219dff71a2bd7bc5a4.png" style="height: 40px;" /></div><div class="inline green">Paired with Terminal ID {{tyro_tid()}}</div><div class="inline"><button class="btn-link btn" id="tyro-pairing-button" ng-click="start_tyro_pairing()">Pair With A Different Terminal</button><span>&nbsp; :: &nbsp;</span><button class="btn-link btn" id="tyro-pairing-button" ng-click="disable()">Disable</button></div></div><div ng-hide="enabled()"><div class="inline"><img src="/assets/tyro-17e8f1c9a3d948219dff71a2bd7bc5a4.png" style="height: 40px;" /></div><div class="inline red">{{unavailable_reason()}} &nbsp;</div><div class="inline" ng-show="!tyro_paired()"><button class="btn" id="tyro-pairing-button" ng-click="start_tyro_pairing()">Pair With A Terminal</button></div><div class="inline" ng-show="tyro_paired()"><button class="btn" id="tyro-pairing-button" ng-click="enable()">Enable/Retry</button></div><div class="inline"><div class="spinner" id="tyro-status-spinner"><span>Updating Status ...</span></div></div></div><br /></div><div id="pos-tyro-dialogue"><div class="popover fade left in" style="width: 500px; z-index:1020;"><div class="popover-title"><div class="sub-header"></div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form style="font-size: 110%"><div class="spinner" id="create-tyro-invoice-spinner"></div><center><div style="margin-top: 60px"><label class="bold" style="font-size: 60px">{{amount|currency}}</label></div></center><br /><br /><div ng-show="tyro_reset_trigger"><span class="bold">Resetting will refresh the page in approx 5s. Please do not interact with the browser</span><br /><span class="bold">A pop up window will show which can be freely closed. Reset will cause information in current POS to be deleted. Reapply as necessary.</span><br /><br /><button class="btn btn-success" ng-click="tyro_reset(&#39;YES&#39;)">YES</button><button class="inline btn btn-danger" ng-click="tyro_reset_decide(&#39;NO&#39;)">NO</button><br /><br /></div><div ng-show="tyro_non_success"><span class="bold">{{tyro_non_success}}</span><br /><span class="bold">Card Type: {{card_type}}</span><br /><span class="bold">Transaction reference (quote to Tyro support): {{transaction_ref}}</span><br /><span class="bold">Authorisation code (quote to card issuer): {{auth_code}}</span><br /><span class="bold">Issuer action code (quote to card issuer): {{issuer_code}}</span><br /><br /><button class="btn btn-danger" ng-click="close_dialogue()">CLOSE</button><br /><br /></div><br /><br /><div ng-hide="tyro_non_success"><span class="bold">{{question_text}}</span></div><div class="inline" ng-repeat="option in label_list"><button class="btn btn-success" ng-click="tyro_answer_controller(option)">{{option}}</button></div></form></div><div class="row-fluid"><div class="pull-right"><button class="btn btn-link" ng-click="tyro_cancel()">CANCEL TRANSACTION</button><span>&nbsp; :: &nbsp;</span><button class="red btn btn-link" ng-click="tyro_reset_decide()">HARD RESET</button></div></div></div></div></div></div><div id="pos-tyro-pairing"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">Tyro, Pairing with A Terminal</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div class="red" ng-show="tyro_pairing_status == &#39;failure&#39;"><span>{{tyro_pairing_message}}</span><br /></div><div class="blue" ng-show="tyro_pairing_status == &#39;inProgress&#39;"><span>{{tyro_pairing_message}}</span><br /></div><form class="form form-horizontal" style="font-size: 110%"><div class="control-group"><label class="control-label">Terminal ID</label><div class="controls"><select ng-model="tyro_pairing_tid" ng-options="terminal for terminal in tyro_terminals()"></select></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="tyro_initiate_pair()">Pair</button><button class="btn" ng-click="cancel_tyro_pairing()">Cancel</button><div class="spinner" id="tyro-pairing-spinner"></div></div></div></form></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_vehicle.html",'<div class="content-box"><div class="row-fluid"><div class="sub-header"><span>{{vehicle.title}}</span><div class="pull-right" ng-show="actions"><a ng-href="#/jobs/new?vehicle_id={{vehicle.id}}&amp;customer_id={{customer.id}}">New Job</a><span>&nbsp;::&nbsp;</span><a ng-href="#/invoices/new?vehicle_id={{vehicle.id}}&amp;customer_id={{customer.id}}">New Invoice</a><span>&nbsp;::&nbsp;</span><a ng-href="/vehicles/{{vehicle.id}}/print_history.pdf" target="_blank">Print History</a></div></div></div><div class="row-fluid editable" ng-click="edit_vehicle()" ng-hide="vehicle.editing"><div class="column span6"><div class="info" ng-show="vehicle.boat_name"><span class="label-name-left auto-width">Boat Name:</span><span>{{vehicle.boat_name}}</span></div><div class="info" ng-show="vehicle.asset_type"><span class="label-name-left auto-width">Type:</span><span>{{vehicle.asset_type}}</span></div><div class="info" ng-show="asset_property_set().sequence_number"><span class="label-name-left auto-width">Vehicle No#:</span><span>{{vehicle.number}}</span></div><div class="info"><span class="label-name-left auto-width">Reg. No#:</span><span>{{vehicle.registration_number}}</span></div><div class="info" ng-show="vehicle.fleet_number"><span class="label-name-left auto-width">Fleet No#:</span><span>{{vehicle.fleet_number}}</span></div><div class="info" ng-show="vehicle.serial_number"><span class="label-name-left auto-width">Serial Number:</span><span>{{vehicle.serial_number}}</span></div><div class="info" ng-show="vehicle.product_number"><span class="label-name-left auto-width">Product Number:</span><span>{{vehicle.product_number}}</span></div><div class="info" ng-show="vehicle.registration_date"><span class="label-name-left auto-width">Registration Date:</span><span>{{vehicle.registration_date|date: \'mediumDate\'}}</span></div><div class="info" ng-show="vehicle.registration_due_date"><span class="label-name-left auto-width">Registration Due Date:</span><span>{{vehicle.registration_due_date|date: \'mediumDate\'}}</span></div><div class="info" ng-show="vehicle.registration_billing_number"><span class="label-name-left auto-width">Registration Billing Number:</span><span>{{vehicle.registration_billing_number}}</span></div><div class="info" ng-show="vehicle.warranty_expiry_date"><span class="label-name-left auto-width">Warranty Expiry Date:</span><span>{{vehicle.warranty_expiry_date|date: \'mediumDate\'}}</span></div><div class="info"><span class="label-name-left auto-width">Make:</span><span>{{vehicle.make}}</span></div><div class="info" ng-show="vehicle.series"><span class="label-name-left auto-width">Series:</span><span>{{vehicle.series}}</span></div><div class="info"><span class="label-name-left auto-width">Model:</span><span>{{vehicle.model}}</span></div><div class="info" ng-show="vehicle.model_code"><span class="label-name-left auto-width">Model Code:</span><span>{{vehicle.model_code}}</span></div><div class="info" ng-show="vehicle.year"><span class="label-name-left auto-width">Year:</span><span>{{vehicle.year}}</span></div><div class="info" ng-show="vehicle.color"><span class="label-name-left auto-width">Color:</span><span>{{vehicle.color}}</span></div><div class="info" ng-show="vehicle.color_code"><span class="label-name-left auto-width">Color Code:</span><span>{{vehicle.color_code}}</span></div><div class="info" ng-show="vehicle.size"><span class="label-name-left auto-width">Size:</span><span>{{vehicle.size}}</span></div><div class="info" ng-show="vehicle.body"><span class="label-name-left auto-width">Body:</span><span>{{vehicle.body}}</span></div><div class="info" ng-show="vehicle.seats"><span class="label-name-left auto-width">Seats:</span><span>{{vehicle.seats}}</span></div><div class="info" ng-show="vehicle.doors"><span class="label-name-left auto-width">Doors:</span><span>{{vehicle.doors}}</span></div><div class="info" ng-show="vehicle.compliance_plate_date"><span class="label-name-left auto-width">Compliance Plate Date:</span><span>{{vehicle.compliance_plate_date|date: \'mediumDate\'}}</span></div><div class="info" ng-show="vehicle.location"><span class="label-name-left auto-width">Location:</span><span>{{vehicle.location}}</span></div><div class="info" ng-show="vehicle.key_location"><span class="label-name-left auto-width">Key Location:</span><span>{{vehicle.key_location}}</span></div><div class="info" ng-show="vehicle.driver_name"><span class="label-name-left auto-width">Driver Name:</span><span>{{vehicle.driver_name}}</span></div><div class="info" ng-show="vehicle.driver_phone"><span class="label-name-left auto-width">Driver Phone:</span><span>{{vehicle.driver_phone}}</span></div><div class="info" ng-show="vehicle.driver_email"><span class="label-name-left auto-width">Driver Email:</span><span>{{vehicle.driver_email}}</span></div><div class="info" ng-repeat="attribute in asset_property_set().custom_attributes" ng-show="vehicle[attribute.id]"><span class="label-name-left auto-width">{{attribute.name}}:</span><span>{{vehicle[attribute.id]}}</span></div></div><div class="column span6"><div class="pull-right"><div class="info" ng-show="vehicle.purchase_date"><span class="label-name-left auto-width">Purchase Date:</span><span>{{vehicle.purchase_date|date: \'mediumDate\'}}</span></div><div class="info" ng-show="vehicle.service_interval"><span class="label-name-left auto-width">Service Interval:</span><span>{{vehicle.service_interval}}</span></div><div class="info" ng-show="vehicle.vin"><span class="label-name-left auto-width">Transmission:</span><span>{{vehicle.transmission}}</span></div><div class="info" ng-show="vehicle.chassis_number"><span class="label-name-left auto-width">Chassis Number:</span><span>{{vehicle.chassis_number}}</span></div><div class="info" ng-show="vehicle.vin"><span class="label-name-left auto-width">VIN:</span><span>{{vehicle.vin}}</span></div><div class="info" ng-show="vehicle.drive_type"><span class="label-name-left auto-width">Drive Type:</span><span>{{vehicle.drive_type}}</span></div><div class="info" ng-show="vehicle.gears"><span class="label-name-left auto-width">Gears:</span><span>{{vehicle.gears}}</span></div><div class="info" ng-show="vehicle.cylinders"><span class="label-name-left auto-width">Cylinders:</span><span>{{vehicle.cylinders}}</span></div><div class="info" ng-show="vehicle.warrant"><span class="label-name-left auto-width">Warrant:</span><span>{{vehicle.warrant}}</span></div><div class="info" ng-show="vehicle.odometer_unit"><span class="label-name-left auto-width">Odometer Unit:</span><span>{{vehicle.odometer_unit}}</span></div><div class="info" ng-show="vehicle.battery"><span class="label-name-left auto-width">Battery:</span><span>{{vehicle.battery}}</span></div><div class="info" ng-show="vehicle.fan_belt"><span class="label-name-left auto-width">Fan Belt:</span><span>{{vehicle.fan_belt}}</span></div><div class="info" ng-show="vehicle.aircon_belt"><span class="label-name-left auto-width">Aircon Belt:</span><span>{{vehicle.aircon_belt}}</span></div><div class="info" ng-show="vehicle.airbag_type"><span class="label-name-left auto-width">Airbag Type:</span><span>{{vehicle.airbag_type}}</span></div><div class="info" ng-show="vehicle.engine_brand"><span class="label-name-left auto-width">Engine Brand:</span><span>{{vehicle.engine_brand}}</span></div><div class="info" ng-show="vehicle.engine_model"><span class="label-name-left auto-width">Engine Model:</span><span>{{vehicle.engine_model}}</span></div><div class="info" ng-show="vehicle.engine_year"><span class="label-name-left auto-width">Engine Year:</span><span>{{vehicle.engine_year}}</span></div><div class="info" ng-show="vehicle.engine_number"><span class="label-name-left auto-width">Engine No#:</span><span>{{vehicle.engine_number}}</span></div><div class="info" ng-show="vehicle.engine_type"><span class="label-name-left auto-width">Engine Type:</span><span>{{vehicle.engine_type}}</span></div><div class="info" ng-show="vehicle.engine_size"><span class="label-name-left auto-width">Engine Size:</span><span>{{vehicle.engine_size}}</span></div><div class="info" ng-show="vehicle.horsepower"><span class="label-name-left auto-width">Horsepower:</span><span>{{vehicle.horsepower}}</span></div><div class="info" ng-show="vehicle.engine_data_dot"><span class="label-name-left auto-width">Engine Data Dot:</span><span>{{vehicle.engine_data_dot}}</span></div><div class="info" ng-show="vehicle.engine_oil_type"><span class="label-name-left auto-width">Engine Oil Type:</span><span>{{vehicle.engine_oil_type}}</span></div><div class="info" ng-show="vehicle.engine_oil_quantity"><span class="label-name-left auto-width">Engine Oil Quantity:</span><span>{{vehicle.engine_oil_quantity}}</span></div><div class="info" ng-show="vehicle.power_steering_oil_type"><span class="label-name-left auto-width">Power Steering Oil Type:</span><span>{{vehicle.power_steering_oil_type}}</span></div><div class="info" ng-show="vehicle.power_steering_oil_quantity"><span class="label-name-left auto-width">Power Steering Oil Quantity:</span><span>{{vehicle.power_steering_oil_quantity}}</span></div><div class="info" ng-show="vehicle.spark_plug"><span class="label-name-left auto-width">Spark Plug:</span><span>{{vehicle.spark_plug}}</span></div><div class="info" ng-show="vehicle.injector_pump_number"><span class="label-name-left auto-width">Injector/Pump Number:</span><span>{{vehicle.injector_pump_number}}</span></div><div class="info" ng-show="vehicle.transmission_oil_type"><span class="label-name-left auto-width">Transmission Oil Type:</span><span>{{vehicle.transmission_oil_type}}</span></div><div class="info" ng-show="vehicle.transmission_oil_quantity"><span class="label-name-left auto-width">Transmission Oil Quantity:</span><span>{{vehicle.transmission_oil_quantity}}</span></div><div class="info" ng-show="vehicle.transfer_case_oil_type"><span class="label-name-left auto-width">Transfer Case Oil Type:</span><span>{{vehicle.transfer_case_oil_type}}</span></div><div class="info" ng-show="vehicle.transfer_case_oil_quantity"><span class="label-name-left auto-width">Transfer Case Oil Quantity:</span><span>{{vehicle.transfer_case_oil_quantity}}</span></div><div class="info" ng-show="vehicle.front_differential_type"><span class="label-name-left auto-width">Front Differential Type:</span><span>{{vehicle.front_differential_type}}</span></div><div class="info" ng-show="vehicle.front_differential_quantity"><span class="label-name-left auto-width">Front Differential Quantity:</span><span>{{vehicle.front_differential_quantity}}</span></div><div class="info" ng-show="vehicle.rear_differential_type"><span class="label-name-left auto-width">Rear Differential Type:</span><span>{{vehicle.rear_differential_type}}</span></div><div class="info" ng-show="vehicle.rear_differential_quantity"><span class="label-name-left auto-width">Rear Differential Quantity:</span><span>{{vehicle.rear_differential_quantity}}</span></div><div class="info" ng-show="vehicle.coolant_type"><span class="label-name-left auto-width">Coolant Type:</span><span>{{vehicle.coolant_type}}</span></div><div class="info" ng-show="vehicle.coolant_quantity"><span class="label-name-left auto-width">Coolant Quantity:</span><span>{{vehicle.coolant_quantity}}</span></div><div class="info" ng-show="vehicle.differential_type"><span class="label-name-left auto-width">Differential Type:</span><span>{{vehicle.differential_type}}</span></div><div class="info" ng-show="vehicle.fuel_type"><span class="label-name-left auto-width">Fuel Type:</span><span>{{vehicle.fuel_type}}</span></div><div class="info" ng-show="vehicle.fuel_tank_expiry_date"><span class="label-name-left auto-width">Fuel Tank Expiry Date:</span><span>{{vehicle.fuel_tank_expiry_date|date: \'mediumDate\'}}</span></div><div class="info" ng-show="vehicle.exhaust_system"><span class="label-name-left auto-width">Exhaust System:</span><span>{{vehicle.exhaust_system}}</span></div><div class="info" ng-show="vehicle.exhaust_header"><span class="label-name-left auto-width">Exhaust Header:</span><span>{{vehicle.exhaust_header}}</span></div><div class="info" ng-show="vehicle.air_intake_system"><span class="label-name-left auto-width">Air Intake System:</span><span>{{vehicle.air_intake_system}}</span></div><div class="info" ng-show="vehicle.air_filter"><span class="label-name-left auto-width">Air Filter:</span><span>{{vehicle.air_filter}}</span></div><div class="info" ng-show="vehicle.air_dryer_filter"><span class="label-name-left auto-width">Air Dryer Filter:</span><span>{{vehicle.air_dryer_filter}}</span></div><div class="info" ng-show="vehicle.oil_filter"><span class="label-name-left auto-width">Oil Filter:</span><span>{{vehicle.oil_filter}}</span></div><div class="info" ng-show="vehicle.oil_filter_element"><span class="label-name-left auto-width">Oil Filter Element:</span><span>{{vehicle.oil_filter_element}}</span></div><div class="info" ng-show="vehicle.fuel_filter"><span class="label-name-left auto-width">Fuel Filter:</span><span>{{vehicle.fuel_filter}}</span></div><div class="info" ng-show="vehicle.transmission_filter"><span class="label-name-left auto-width">Transmission Filter:</span><span>{{vehicle.transmission_filter}}</span></div><div class="info" ng-show="vehicle.hydraulic_filter"><span class="label-name-left auto-width">Hydraulic Filter:</span><span>{{vehicle.hydraulic_filter}}</span></div><div class="info" ng-show="vehicle.pollen_filter"><span class="label-name-left auto-width">Pollen Filter:</span><span>{{vehicle.pollen_filter}}</span></div><div class="info" ng-show="vehicle.obd_location"><span class="label-name-left auto-width">OBD Location:</span><span>{{vehicle.obd_location}}</span></div><div class="info" ng-show="vehicle.screen_code"><span class="label-name-left auto-width">Screen Code:</span><span>{{vehicle.screen_code}}</span></div><div class="info" ng-show="vehicle.tyre_size"><span class="label-name-left auto-width">Tyre Size:</span><span>{{vehicle.tyre_size}}</span></div><div class="info" ng-show="vehicle.radio_code"><span class="label-name-left auto-width">Radio Code:</span><span>{{vehicle.radio_code}}</span></div><div class="info" ng-show="vehicle.window_tinted"><span class="label-name-left auto-width">Window Tinted:</span><span>{{vehicle.window_tinted|yes_no}}</span></div><div class="info" ng-show="vehicle.key_number"><span class="label-name-left auto-width">Key Number:</span><span>{{vehicle.key_number}}</span></div><div class="info" ng-show="vehicle.air_conditioning"><span class="label-name-left auto-width">Air Conditioning:</span><span>{{vehicle.air_conditioning}}</span></div><div class="info" ng-show="vehicle.groupset"><span class="label-name-left auto-width">Groupset:</span><span>{{vehicle.groupset}}</span></div><div class="info" ng-show="vehicle.wheels"><span class="label-name-left auto-width">Wheels:</span><span>{{vehicle.wheels}}</span></div><div class="info" ng-show="vehicle.weight"><span class="label-name-left auto-width">Weight:</span><span>{{vehicle.weight}}</span></div><div class="info" ng-show="vehicle.seat_height"><span class="label-name-left auto-width">Seat Height:</span><span>{{vehicle.seat_height}}</span></div><div class="info" ng-show="vehicle.bar_height"><span class="label-name-left auto-width">Bar Height:</span><span>{{vehicle.bar_height}}</span></div><div class="info" ng-show="vehicle.reach"><span class="label-name-left auto-width">Reach:</span><span>{{vehicle.reach}}</span></div><div class="info" ng-show="vehicle.stem_length"><span class="label-name-left auto-width">Stem Length:</span><span>{{vehicle.stem_length}}</span></div><div class="info" ng-show="vehicle.crank_length"><span class="label-name-left auto-width">Crank Length:</span><span>{{vehicle.crank_length}}</span></div><div class="info" ng-show="vehicle.handlebar_width"><span class="label-name-left auto-width">Handlebar Width:</span><span>{{vehicle.handlebar_width}}</span></div><div class="info" ng-show="vehicle.chain_rings"><span class="label-name-left auto-width">Chain Rings:</span><span>{{vehicle.chain_rings}}</span></div><div class="info" ng-show="vehicle.trailer_brand"><span class="label-name-left auto-width">Trailer Brand:</span><span>{{vehicle.trailer_brand}}</span></div><div class="info" ng-show="vehicle.trailer_model"><span class="label-name-left auto-width">Trailer Model:</span><span>{{vehicle.trailer_model}}</span></div><div class="info" ng-show="vehicle.trailer_year"><span class="label-name-left auto-width">Trailer Year:</span><span>{{vehicle.trailer_year}}</span></div><div class="info" ng-show="vehicle.trailer_serial_number"><span class="label-name-left auto-width">Trailer S/N:</span><span>{{vehicle.trailer_serial_number}}</span></div><div class="info" ng-show="vehicle.trailer_registration_number"><span class="label-name-left auto-width">Trailer Reg. No.:</span><span>{{vehicle.trailer_registration_number}}</span></div><div class="info" ng-show="vehicle.starboard_serial_number"><span class="label-name-left auto-width">Starboard Serial Number:</span><span>{{vehicle.starboard_serial_number}}</span></div><div class="info" ng-show="vehicle.port_serial_number"><span class="label-name-left auto-width">Port Serial Number:</span><span>{{vehicle.port_serial_number}}</span></div><div class="info" ng-show="vehicle.drive_brand"><span class="label-name-left auto-width">Drive Brand:</span><span>{{vehicle.drive_brand}}</span></div><div class="info" ng-show="vehicle.drive_model"><span class="label-name-left auto-width">Drive Model:</span><span>{{vehicle.drive_model}}</span></div><div class="info" ng-show="vehicle.inboard_motor"><div class="inline label-name-left auto-width">Inboard Motor:</div><pre class="inline">{{vehicle.inboard_motor}}</pre></div><div class="info" ng-show="vehicle.outboard_motor"><span class="label-name-left auto-width">Outboard Motor:</span><pre>{{vehicle.outboard_motor}}</pre></div><div class="info" ng-show="vehicle.generator"><span class="label-name-left auto-width">Generator:</span><pre>{{vehicle.generator}}</pre></div><div class="info" ng-show="vehicle.impeller"><span class="label-name-left auto-width">Impeller:</span><pre>{{vehicle.impeller}}</pre></div><div class="info" ng-show="vehicle.dive_cylinder"><span class="label-name-left auto-width">Dive Cylinder:</span><pre>{{vehicle.dive_cylinder}}</pre></div><div class="info" ng-show="vehicle.hire_equipment"><span class="label-name-left auto-width">Hire Equipment:</span><pre>{{vehicle.hire_equipment}}</pre></div><div class="info" ng-show="vehicle.dive_certification"><span class="label-name-left auto-width">Dive Certification:</span><pre>{{vehicle.dive_certification}}</pre></div><div class="info" ng-show="vehicle.bcd"><span class="label-name-left auto-width">BCD:</span><pre>{{vehicle.bcd}}</pre></div><div class="info" ng-show="vehicle.regulator"><span class="label-name-left auto-width">Regulator:</span><pre>{{vehicle.regulator}}</pre></div><div class="info" ng-show="vehicle.gvm"><span class="label-name-left auto-width">GVM:</span><span>{{vehicle.gvm}}</span></div><div class="info" ng-show="vehicle.gcm"><span class="label-name-left auto-width">GCM:</span><span>{{vehicle.gcm}}</span></div><div class="info" ng-show="vehicle.tare_weight"><span class="label-name-left auto-width">Tare Weight:</span><span>{{vehicle.tare_weight}}</span></div><div class="info" ng-show="vehicle.axle_code"><span class="label-name-left auto-width">Axle Code:</span><span>{{vehicle.axle_code}}</span></div><div class="info" ng-show="vehicle.sleeper_air_serial_number"><span class="label-name-left auto-width">Sleeper Air SN.</span><span>{{vehicle.sleeper_air_serial_number}}</span></div><div class="info" ng-show="vehicle.sleeper_air_engine_serial_number"><span class="label-name-left auto-width">Sleeper Air Engine SN.</span><span>{{vehicle.sleeper_air_engine_serial_number}}</span></div><div class="info" ng-show="vehicle.sleeper_air_ecm_serial_number"><span class="label-name-left auto-width">Sleeper Air ECM SN.</span><span>{{vehicle.sleeper_air_ecm_serial_number}}</span></div></div></div></div><div class="editing-item" ng-show="vehicle.editing"><form class="form-horizontal"><div ad-vehicle-form="true" ng-model="vehicle.editing"></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_vehicle()">Save</button><button class="btn" ng-click="cancel_edit()">Cancel</button><div class="spinner" id="update-vehicle-spinner"></div></div></div></form></div><br /><div class="editable" ng-click="edit_service_note()" ng-hide="vehicle.editing_service_note"><div class="bold"><span>Next Service Note/TODO:</span><span ng-hide="vehicle.service_note.length &gt; 0">&nbsp; (Not Available)</span></div><pre class="note" ng-show="vehicle.service_note.length &gt; 0" style="border-color: #084175">{{vehicle.service_note|na}}</pre></div><div ng-show="vehicle.editing_service_note"><div class="bold">Next Service Note/TODO:</div><div class="row-fluid"><textarea class="span12" id="edit-service-note" ng-model="vehicle.editing_service_note.service_note" rows="8"></textarea></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_service_note()">Save</button><button class="btn" ng-click="cancel_edit_service_note()">Cancel</button><div class="pull-right"><a href="javascript:void(0);" ng-click="clear_service_note()">Clear</a></div></div></div><br /><hr /><div ad-notes="true" model-type="vehicle" ng-model="vehicle"></div><br /><div class="row-fluid" style="vertical-align: text-bottom;"><div class="sub-header inline">Service History</div><div class="pull-right"><div ng-show="!no_wof()"><div class="editable" ng-click="edit_wof_date()" ng-hide="vehicle.service_schedule.editing_wof_date"><span class="label-name-left">{{wof_name()}} Due Date:</span><span>{{vehicle.service_schedule.wof_date|date: \'mediumDate\'}}</span></div></div><div class="editing-item" ng-show="vehicle.service_schedule.editing_wof_date"><form class="row-fluid form-inline"><span class="label-name-left">{{wof_name()}}  Due Date:</span><ad-datepicker ng-model="vehicle.service_schedule.editing_wof_date.wof_date"></ad-datepicker><br /><br /><div class="pull-right"><button class="btn btn-success" ng-click="save_wof_date()" type="submit">Save</button>&nbsp;<button class="btn" ng-click="cancel_edit_wof_date()">Cancel</button></div></form></div><div><div class="editable" ng-click="edit_registration_due_date()" ng-hide="vehicle.editing_registration_due_date"><div><span class="label-name-left">Registration Due:</span><span>{{vehicle.registration_due_date|date: \'mediumDate\'}}</span></div><div ng-show="vehicle.registration_billing_number"><span class="label-name-left">Registration Billing Number:</span><span>{{vehicle.registration_billing_number}}</span></div></div></div><div class="editing-item" ng-show="vehicle.editing_registration_due_date"><form class="row-fluid form-inline"><div><span class="label-name-left">Registration Due:</span><ad-datepicker ng-model="vehicle.editing_registration_due_date.registration_due_date"></ad-datepicker></div><div ng-show="asset_property_set().registration_billing_number"><span class="label-name-left">Registration Billing Number:</span><ad-datepicker ng-model="vehicle.editing_registration_due_date.registration_billing_number"></ad-datepicker></div><br /><br /><div class="pull-right"><button class="btn btn-success" ng-click="save_registration_due_date()" type="submit">Save</button>&nbsp;<button class="btn" ng-click="cancel_edit_registration_due_date()">Cancel</button></div></form></div><div class="editable" ng-click="edit_last_service_date()" ng-hide="vehicle.service_schedule.editing_last_service_date"><span class="label-name-left">Last Job Date:</span><span>{{vehicle.service_schedule.last_service_date|date: \'mediumDate\'}}</span></div><div class="editing-item" ng-show="vehicle.service_schedule.editing_last_service_date"><form class="row-fluid form-inline"><span class="label-name-left">Last Job Date:</span><ad-datepicker ng-model="vehicle.service_schedule.editing_last_service_date.last_service_date"></ad-datepicker><br /><br /><div class="pull-right"><button class="btn btn-success" ng-click="save_last_service_date()" type="submit">Save</button>&nbsp;<button class="btn" ng-click="cancel_edit_last_service_date()">Cancel</button></div></form></div><div class="editable" ng-click="edit_next_service_date()" ng-hide="vehicle.service_schedule.editing_next_service_date"><span class="label-name-left">Next Service:</span><span>{{vehicle.service_schedule.next_service_date|date: \'mediumDate\'}}</span></div><div class="editing-item" ng-show="vehicle.service_schedule.editing_next_service_date"><form class="row-fluid form-inline"><span class="label-name-left">Next Service:</span><ad-datepicker ng-model="vehicle.service_schedule.editing_next_service_date.next_service_date"></ad-datepicker><br /><br /><div class="pull-right"><button class="btn btn-success" ng-click="save_next_service_date()" type="submit">Save</button>&nbsp;<button class="btn" ng-click="cancel_edit_next_service_date()">Cancel</button></div></form></div></div></div><table class="table table-striped"><tbody><tr class="goto" ng-click="select_service_history_item(item)" ng-repeat="item in vehicle.service_history.service_history_items"><td>{{item.date|date: \'mediumDate\'}}</td><td>{{item.description}}</td><td><div ng-show="item.odometer"><span>Odometer: {{item.odometer|number}} {{vehicle.odometer_unit|lowercase}}</span></div><div ng-show="item.hubodometer"><span>Hubodometer: {{item.hubodometer|number}} {{vehicle.odometer_unit|lowercase}}</span></div><div ng-show="item.machine_hours"><span>Hrs: {{item.machine_hours|number}} hrs</span></div><div ng-show="item.engine_hours"><span>Eng. Hrs: {{item.engine_hours|number}} hrs</span></div></td><td><span ng-show="show_history_item_price()">{{item.total_amount | currency}}</span></td></tr></tbody></table></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_vehicle_form.html",'<div class="control-group" ng-show="asset_property_set().boat_name"><label class="control-label">Boat Name</label><div class="controls"><input ng-model="vehicle.boat_name" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().asset_type"><label class="control-label">Type</label><div class="controls"><input class="input" ng-model="vehicle.asset_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().registration_number"><label class="control-label">Registration Number</label><div class="controls"><div ad-existing-vehicle-warning="true" ng-model="vehicle"></div><input class="registration-number-input" ng-model="vehicle.registration_number" type="text" /><div class="inline">&nbsp;</div><div ad-vehicle-look-up-button="true" class="inline" ng-model="vehicle"></div></div></div><div class="control-group" ng-show="asset_property_set().registration_date"><label class="control-label">Registration Date</label><div class="controls"><div ad-datepicker="true" ng-model="vehicle.registration_date"></div></div></div><div class="control-group" ng-show="asset_property_set().registration_due_date"><label class="control-label">Registration Due Date</label><div class="controls"><div ad-datepicker="true" ng-model="vehicle.registration_due_date"></div></div></div><div class="control-group" ng-show="asset_property_set().registration_billing_number"><label class="control-label">Registration Billing Number</label><div class="controls"><input ng-model="vehicle.registration_billing_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().purchase_date"><label class="control-label">Purchase Date</label><div class="controls"><div ad-datepicker="true" ng-model="vehicle.purchase_date"></div></div></div><div class="control-group" ng-show="asset_property_set().fleet_number"><label class="control-label">Fleet Number</label><div class="controls"><input ng-model="vehicle.fleet_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().serial_number"><label class="control-label">Serial Number</label><div class="controls"><input class="vin-input" ng-model="vehicle.serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().product_number"><label class="control-label">Product Number</label><div class="controls"><input class="vin-input" ng-model="vehicle.product_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().driver_name"><label class="control-label">Driver Name</label><div class="controls"><input ng-model="vehicle.driver_name" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().driver_phone"><label class="control-label">Driver Phone</label><div class="controls"><input ng-model="vehicle.driver_phone" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().driver_email"><label class="control-label">Driver Email</label><div class="controls"><input ng-model="vehicle.driver_email" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().make"><label class="control-label">Make</label><div class="controls"><input ng-change="update_models()" ng-model="vehicle.make" ng-model-on-blur="" type="text" typeahead="vm.make as vm.make for vm in makes | filter: {make: $viewValue}" typeahead-on-select="update_models()" typeahead-wait-ms="500" /></div></div><div class="control-group" ng-show="asset_property_set().series"><label class="control-label">Series</label><div class="controls"><input ng-model="vehicle.series" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().model"><label class="control-label">Model</label><div class="controls"><input ng-model="vehicle.model" type="text" typeahead="vm.model as vm.model for vm in vehicle_models | filter: {model: $viewValue}" typeahead-wait-ms="500" /></div></div><div class="control-group" ng-show="asset_property_set().model_code"><label class="control-label">Model Code</label><div class="controls"><input ng-model="vehicle.model_code" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().year"><label class="control-label">Year</label><div class="controls"><input ng-model="vehicle.year" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().color"><label class="control-label">Color</label><div class="controls"><input ng-model="vehicle.color" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().color_code"><label class="control-label">Color Code</label><div class="controls"><input ng-model="vehicle.color_code" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().size"><label class="control-label">Size</label><div class="controls"><input ng-model="vehicle.size" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().body"><label class="control-label">Body Type</label><div class="controls"><input ng-model="vehicle.body" type="text" typeahead="body as body for body in vehicle_body_types | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().seats"><label class="control-label">Seats</label><div class="controls"><input ng-model="vehicle.seats" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().doors"><label class="control-label">Doors</label><div class="controls"><input ng-model="vehicle.doors" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().compliance_plate_date"><label class="control-label">Compliance Plate Date</label><div class="controls"><div ad-datepicker="true" ng-model="vehicle.compliance_plate_date"></div></div></div><div class="control-group" ng-show="asset_property_set().service_interval"><label class="control-label">Service Interval</label><div class="controls"><input ng-model="vehicle.service_interval" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().groupset"><label class="control-label">Groupset</label><div class="controls"><input ng-model="vehicle.groupset" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().wheels"><label class="control-label">Wheels</label><div class="controls"><input ng-model="vehicle.wheels" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().weight"><label class="control-label">Weight</label><div class="controls"><input ng-model="vehicle.weight" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().seat_height"><label class="control-label">Seat Height</label><div class="controls"><input ng-model="vehicle.seat_height" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().bar_height"><label class="control-label">Bar Height</label><div class="controls"><input ng-model="vehicle.bar_height" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().reach"><label class="control-label">Reach</label><div class="controls"><input ng-model="vehicle.reach" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().stem_length"><label class="control-label">Stem Length</label><div class="controls"><input ng-model="vehicle.stem_length" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().crank_length"><label class="control-label">Crank Length</label><div class="controls"><input ng-model="vehicle.crank_length" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().handlebar_width"><label class="control-label">Handlebar Width</label><div class="controls"><input ng-model="vehicle.handlebar_width" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().chain_rings"><label class="control-label">Chain Rings</label><div class="controls"><input ng-model="vehicle.chain_rings" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().transmission"><label class="control-label">Transmission Type</label><div class="controls"><input ng-model="vehicle.transmission" type="text" typeahead="t as t for t in vehicle_transmission_types | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().drive_type"><label class="control-label">Drive Type</label><div class="controls"><input ng-model="vehicle.drive_type" type="text" typeahead="dt as dt for dt in vehicle_drive_types | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().gears"><label class="control-label">Gears</label><div class="controls"><input class="vin-input" ng-model="vehicle.gears" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().cylinders"><label class="control-label">Cylinders</label><div class="controls"><input class="vin-input" ng-model="vehicle.cylinders" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().chassis_number"><label class="control-label">Chassis Number</label><div class="controls"><input class="vin-input" ng-model="vehicle.chassis_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().vin"><label class="control-label">VIN</label><div class="controls"><input class="vin-input" ng-model="vehicle.vin" type="text" /><div class="inline">&nbsp;</div><div ad-vehicle-look-up-button="true" class="inline" ng-model="vehicle"></div></div></div><div class="control-group" ng-show="asset_property_set().warrant"><label class="control-label">Warrant</label><div class="controls"><input class="vin-input" ng-model="vehicle.warrant" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().warranty_expiry_date"><label class="control-label">Warranty Expiry Date</label><div class="controls"><div ad-datepicker="true" ng-model="vehicle.warranty_expiry_date"></div></div></div><div class="control-group" ng-show="asset_property_set().odometer_unit"><label class="control-label">Odometer Unit</label><div class="controls"><select ng-model="vehicle.odometer_unit" ng-options="ou as ou for ou in odometer_units" type="text"></select></div></div><div class="control-group" ng-show="asset_property_set().battery"><label class="control-label">Battery</label><div class="controls"><input ng-model="vehicle.battery" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().fan_belt"><label class="control-label">Fan Belt</label><div class="controls"><input ng-model="vehicle.fan_belt" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().aircon_belt"><label class="control-label">Aircon Belt</label><div class="controls"><input ng-model="vehicle.aircon_belt" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().airbag_type"><label class="control-label">Airbag Type</label><div class="controls"><input ng-model="vehicle.airbag_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_brand"><label class="control-label">Engine Brand</label><div class="controls"><input ng-model="vehicle.engine_brand" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_model"><label class="control-label">Engine Model</label><div class="controls"><input ng-model="vehicle.engine_model" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_year"><label class="control-label">Engine Year</label><div class="controls"><input ng-model="vehicle.engine_year" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_number"><label class="control-label">Engine Number</label><div class="controls"><input ng-model="vehicle.engine_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_type"><label class="control-label">Engine Type</label><div class="controls"><input ng-model="vehicle.engine_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_size"><label class="control-label">Engine Size</label><div class="controls"><input ng-model="vehicle.engine_size" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().horsepower"><label class="control-label">Horsepower</label><div class="controls"><input ng-model="vehicle.horsepower" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_data_dot"><label class="control-label">Engine Data Dot</label><div class="controls"><input ng-model="vehicle.engine_data_dot" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_oil_type"><label class="control-label">Engine Oil Type</label><div class="controls"><input ng-model="vehicle.engine_oil_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_oil_quantity"><label class="control-label">Engine Oil Quantity</label><div class="controls"><input ng-model="vehicle.engine_oil_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().power_steering_oil_type"><label class="control-label">Power Steering Oil Type</label><div class="controls"><input ng-model="vehicle.power_steering_oil_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().power_steering_oil_quantity"><label class="control-label">Power Steering Oil Quantity</label><div class="controls"><input ng-model="vehicle.power_steering_oil_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().spark_plug"><label class="control-label">Spark Plug</label><div class="controls"><input ng-model="vehicle.spark_plug" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().injector_pump_number"><label class="control-label">Injector/Pump Number</label><div class="controls"><input ng-model="vehicle.injector_pump_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().transmission_oil_type"><label class="control-label">Transmission Oil Type</label><div class="controls"><input ng-model="vehicle.transmission_oil_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().transmission_oil_quantity"><label class="control-label">Transmission Oil Quantity</label><div class="controls"><input ng-model="vehicle.transmission_oil_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().transfer_case_oil_type"><label class="control-label">Transfer Case Oil Type</label><div class="controls"><input ng-model="vehicle.transfer_case_oil_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().transfer_case_oil_quantity"><label class="control-label">Transfer Case Oil Quantity</label><div class="controls"><input ng-model="vehicle.transfer_case_oil_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().fuel_type"><label class="control-label">Fuel Type</label><div class="controls"><input ng-model="vehicle.fuel_type" type="text" typeahead="ft as ft for ft in fuel_types | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().fuel_tank_expiry_date"><label class="control-label">Fuel Tank Expiry Date</label><div class="controls"><div ad-datepicker="true" ng-model="vehicle.fuel_tank_expiry_date"></div></div></div><div class="control-group" ng-show="asset_property_set().exhaust_system"><label class="control-label">Exhaust System</label><div class="controls"><input ng-model="vehicle.exhaust_system" type="text" typeahead="es as es for es in exhaust_systems | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().exhaust_header"><label class="control-label">Exhaust Header</label><div class="controls"><input ng-model="vehicle.exhaust_header" type="text" typeahead="eh as eh for eh in exhaust_headers | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().air_intake_system"><label class="control-label">Air Intake System</label><div class="controls"><input ng-model="vehicle.air_intake_system" type="text" typeahead="ai as ai for ai in air_intakes | filter: $viewValue" /></div></div><div class="control-group" ng-show="asset_property_set().air_filter"><label class="control-label">Air Filter</label><div class="controls"><input ng-model="vehicle.air_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().air_dryer_filter"><label class="control-label">Air Dryer Filter</label><div class="controls"><input ng-model="vehicle.air_dryer_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().oil_filter"><label class="control-label">Oil Filter</label><div class="controls"><input ng-model="vehicle.oil_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().oil_filter_element"><label class="control-label">Oil Filter Element</label><div class="controls"><input ng-model="vehicle.oil_filter_element" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().fuel_filter"><label class="control-label">Fuel Filter</label><div class="controls"><input ng-model="vehicle.fuel_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().transmission_filter"><label class="control-label">Transmission Filter</label><div class="controls"><input ng-model="vehicle.transmission_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().hydraulic_filter"><label class="control-label">Hydraulic Filter</label><div class="controls"><input ng-model="vehicle.hydraulic_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().pollen_filter"><label class="control-label">Pollen Filter</label><div class="controls"><input ng-model="vehicle.pollen_filter" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().obd_location"><label class="control-label">OBD Location</label><div class="controls"><input ng-model="vehicle.obd_location" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().coolant_type"><label class="control-label">Coolant Type</label><div class="controls"><input ng-model="vehicle.coolant_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().coolant_quantity"><label class="control-label">Coolant Quantity</label><div class="controls"><input ng-model="vehicle.coolant_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().differential_type"><label class="control-label">Differential Type</label><div class="controls"><input ng-model="vehicle.differential_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().front_differential_type"><label class="control-label">Front Differential Type</label><div class="controls"><input ng-model="vehicle.front_differential_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().front_differential_quantity"><label class="control-label">Front Differential Quantity</label><div class="controls"><input ng-model="vehicle.front_differential_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().rear_differential_type"><label class="control-label">Rear Differential Type</label><div class="controls"><input ng-model="vehicle.rear_differential_type" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().rear_differential_quantity"><label class="control-label">Rear Differential Quantity</label><div class="controls"><input ng-model="vehicle.rear_differential_quantity" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().screen_code"><label class="control-label">Screen Code</label><div class="controls"><input ng-model="vehicle.screen_code" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().tyre_size"><label class="control-label">Tyre Size</label><div class="controls"><input ng-model="vehicle.tyre_size" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().radio_code"><label class="control-label">Radio Code</label><div class="controls"><input ng-model="vehicle.radio_code" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().window_tinted"><label class="control-label">Window Tinted</label><div class="controls"><input ng-model="vehicle.window_tinted" type="checkbox" /></div></div><div class="control-group" ng-show="asset_property_set().key_number"><label class="control-label">Key Number</label><div class="controls"><input ng-model="vehicle.key_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().air_conditioning"><label class="control-label">Air Conditioning</label><div class="controls"><input ng-model="vehicle.air_conditioning" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().trailer_brand"><label class="control-label">Trailer Brand</label><div class="controls"><input ng-model="vehicle.trailer_brand" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().trailer_model"><label class="control-label">Trailer Model</label><div class="controls"><input ng-model="vehicle.trailer_model" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().trailer_year"><label class="control-label">Trailer Year</label><div class="controls"><input ng-model="vehicle.trailer_year" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().trailer_serial_number"><label class="control-label">Trailer S/N</label><div class="controls"><input ng-model="vehicle.trailer_serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().trailer_registration_number"><label class="control-label">Trailer Reg. No.</label><div class="controls"><input ng-model="vehicle.trailer_registration_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().location"><label class="control-label">Location</label><div class="controls"><input ng-model="vehicle.location" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().key_location"><label class="control-label">Key Location</label><div class="controls"><input ng-model="vehicle.key_location" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().starboard_serial_number"><label class="control-label">Starboard Serial Number</label><div class="controls"><input ng-model="vehicle.starboard_serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().port_serial_number"><label class="control-label">Port Serial Number</label><div class="controls"><input ng-model="vehicle.port_serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().drive_brand"><label class="control-label">Drive Brand</label><div class="controls"><input ng-model="vehicle.drive_brand" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().drive_model"><label class="control-label">Drive Model</label><div class="controls"><input ng-model="vehicle.drive_model" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().inboard_motor"><label class="control-label">Inboard Motor</label><div class="controls"><textarea auto-rows="4" maxlength="1000" ng-model="vehicle.inboard_motor" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().outboard_motor"><label class="control-label">Outboard Motor</label><div class="controls"><textarea auto-rows="4" maxlength="1000" ng-model="vehicle.outboard_motor" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().generator"><label class="control-label">Generator</label><div class="controls"><textarea auto-rows="4" maxlength="1000" ng-model="vehicle.generator" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().impeller"><label class="control-label">Impeller</label><div class="controls"><textarea auto-rows="4" maxlength="1000" ng-model="vehicle.impeller" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().dive_cylinder"><label class="control-label">Dive Cylinder</label><div class="controls"><textarea auto-rows="4" maxlength="1000" ng-model="vehicle.dive_cylinder" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().hire_equipment"><label class="control-label">Hire Equipment</label><div class="controls"><textarea auto-rows="4" maxlength="1000" ng-model="vehicle.hire_equipment" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().dive_certification"><label class="control-label">Dive Certification</label><div class="controls"><textarea auto-rows="4" maxlength="1000" ng-model="vehicle.dive_certification" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().bcd"><label class="control-label">BCD</label><div class="controls"><textarea auto-rows="4" maxlength="1000" ng-model="vehicle.bcd" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().regulator"><label class="control-label">Regulator</label><div class="controls"><textarea auto-rows="4" maxlength="1000" ng-model="vehicle.regulator" type="text"></textarea></div></div><div class="control-group" ng-show="asset_property_set().gvm"><label class="control-label">GVM</label><div class="controls"><input ng-model="vehicle.gvm" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().gcm"><label class="control-label">GCM</label><div class="controls"><input ng-model="vehicle.gcm" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().tare_weight"><label class="control-label">Tare Weight</label><div class="controls"><input ng-model="vehicle.tare_weight" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().axle_code"><label class="control-label">Axle Code</label><div class="controls"><input ng-model="vehicle.axle_code" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().sleeper_air_serial_number"><label class="control-label">Sleeper Air SN.</label><div class="controls"><input ng-model="vehicle.sleeper_air_serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().sleeper_air_engine_serial_number"><label class="control-label">Sleeper Air Engine SN.</label><div class="controls"><input ng-model="vehicle.sleeper_air_engine_serial_number" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().sleeper_air_ecm_serial_number"><label class="control-label">Sleeper Air ECM SN.</label><div class="controls"><input ng-model="vehicle.sleeper_air_ecm_serial_number" type="text" /></div></div><div class="control-group" ng-repeat="custom_attribute in asset_property_set().custom_attributes"><label class="control-label">{{custom_attribute.name}}</label><div class="controls"><input ng-model="vehicle[custom_attribute.id]" type="text" /></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_vehicle_look_up_button.html",'<div class="inline" ng-show="enabled()"><button class="btn btn-priamry" id="look-up-button" ng-click="look_up_plate_or_vin()">Look up</button><div class="inline vehicle-lookup-spinner spinner"></div><div id="error-message" ng-show="error_message"><div class="popover fade left in" style="width: 300px; height: 100px"><div class="popover-title"></div><div class="popover-content"><div style="text-align: center; margin-top: 5%"><span class="red" ng-show="error_message">{{error_message}}</span></div><div style="text-align: center; margin-top: 5px"><button class="btn btn-primary" ng-click="close_error_message()">Close</button></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_vehicle_visual.html",'<div id="vehicle-visual-popover"><div class="popover fade left in" style="width: 750px; z-index: 1020"><div class="popover-content"><div class="content-box"><div class="row-fluid"><div><img src="/assets/vehicle_visual-fbebdc06aa795051e21b8909451845a6.png" style="height: 70px;" /></div><div class="pull-right"><button class="btn btn-primary" ng-click="hide()">Close</button></div><div><form class="form-search"><input class="search-query" id="vehicle-visual-search-input" ng-change="search()" ng-model="term" style="width: 370px" type="text" /></form></div><div class="spinner" id="vehicle-visual-search-spinner"></div></div><br /><div class="row-fluid"><table class="table table-striped"><tr ng-repeat="video in videos"><td style="width: 20%"><img src="{{video.banner_image}}" style="width: 500px" /></td><td style="width: 50%"><div>{{video.title}}</div><div>{{video.description}}</div><div ng-show="video.url" style="font-size: 50%"><br /><textarea class="span12" id="video-{{video.part_id}}" readonly="true" rows="3">{{video.url}}</textarea></div></td><td><div class="row-fluid"><div class="pull-right"><div class="inline"><button class="btn btn-link" ng-click="play(video)">Play</button><span>&#58;&#58;</span></div><div class="inline" ng-show="context()"><button class="btn btn-link" ng-click="insert(video)">Insert</button><span>&#58;&#58;</span></div><button class="btn btn-link" ng-click="copy(video)" unselectable="on">Link</button></div></div></td></tr></table></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_vehicle_visual_button.html",'<a href="javascript:void(0);" ng-click="show()" ng-show="vehicle_visual_enabled()" style="margin-left: 5px;"><span>[Vehicle Visuals]</span></a>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/ad_work_hour_form.html",'<div id="work-hour-form"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Timesheet Item</div></div><div class="popover-content"><div class="content-box"><form name="work_hour_form" novalidate="true"><div class="row-fluid" ng-hide="work_hour.id"><div class="error" ng-show="work_hour_form.job.$error.required">Job is required</div><label>Job</label><div ad-jobpicker="true" job="work_hour.job" ng-model="work_hour.job_id"></div><hr /></div><div class="row-fluid"><div class="column span3"><label>Date</label><ad-datepicker ng-model="work_hour.started_at"></ad-datepicker></div><div class="column span3"><label class="inline">Start</label><br /><ad-timepicker ng-model="work_hour.started_at" on-select="update_duration(work_hour)"></ad-timepicker></div><div class="column span3"><label class="inline">End</label><br /><ad-timepicker ng-model="work_hour.ended_at" on-select="update_duration(work_hour)"></ad-timepicker></div><div class="column span3"><label>Total (hour)</label><input class="input-tiny" ng-change="update_ended_at(work_hour)" ng-model="work_hour.hour" step="any" type="number" /></div></div><div class="row-fluid"><div class="error" ng-show="work_hour_form.employee.$error.required">Employee is required</div><label>Mechanic</label><select class="inline" name="employee" ng-change="select_work_hour_employee(work_hour)" ng-model="work_hour.employee_id" ng-options="employee.id as employee.name for employee in employees" required="true"></select> <label class="inline">Comment/Note:</label></div><div class="row-fluid"><textarea class="span12" id="new-work_hour-description" name="work_hour_description" ng-model="work_hour.description" select-text="true"></textarea>&nbsp;<label class="checkbox"><input ng-model="work_hour.overtime" type="checkbox" /><span>Overtime</span></label><label class="checkbox"><input ng-model="work_hour.no_charge" type="checkbox" /><span>Internal, No charge-out</span></label><br /></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_work_hour(work_hour_form)"><i class="icon-ok"></i><span>Save</span></button><button class="btn" ng-click="cancel_edit_work_hour()">Cancel</button><div class="pull-right" ng-show="work_hour.id"><button class="btn btn-danger" ng-click="remove_work_hour()"><i class="icon-remove"></i><span>Remove</span></button></div></div></form></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/addresspicker.html",'<ng-form name="form"><div class="control-group"><label class="control-label">{{label()}}</label><div class="controls"><div class="input-append" style="width: 80%; max-width: 500px;"><input class="span12" details="details" ng-autocomplete="true" ng-model="address_search" options="options" style="width: 80%; max-width: 500px;" type="text" /><span class="add-on"><i class="icon-search"></i></span></div></div></div><div class="control-group"><label class="control-label">Street Line</label><div class="controls"><input ng-model="address.street_line" type="text" /></div></div><div class="control-group"><label class="control-label">Suburb</label><div class="controls"><input ng-model="address.suburb" type="text" /></div></div><div class="control-group"><label class="control-label">State/City</label><div class="controls"><input ng-model="address.state" type="text" /></div></div><div class="control-group"><label class="control-label">Postcode</label><div class="controls"><input class="input-mini" name="postcode" ng-model="address.postcode" type="text" /></div></div><input ng-model="address.number" type="hidden" /><input ng-model="address.street" type="hidden" /></ng-form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/business_source_picker.html",'<select ng-model="business_source" ng-options="s.id as s.name for s in business_sources"><option value=""></option></select><span>&nbsp;</span><button class="btn btn-link" id="new-business-source-button" ng-click="create_business_source()" type="button">New</button><div id="create-business-source"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">New Business Source</div></div><div class="popover-content"><div class="row-fluid"><form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input id="new-business-source-input" ng-model="new_business_source.name" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_new_business_source()" type="button">Save</button><button class="btn" ng-click="hide_create_business_source()">Cancel</button></div></div></form></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/contactpicker.html",'<div class="inline" ng-show="show_contacts()"><button class="btn btn-link" id="contactpicker-button" ng-click="list_contact()" style="margin-left: 5px" type="button"><i class="icon icon-book"></i><span>Contacts</span></button></div><div id="contactpicker-list"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Contacts</div></div><div class="popover-content"><div class="row-fluid" ng-show="owner.contacts.length &gt; 0"><div class="content-box"><div class="sub-header">Customer Contacts</div><br /><table class="table table-striped"><tbody><tr ng-class="{&#39;contact-selected&#39;: contact_selected(contact)}" ng-repeat="contact in owner.contacts"><td class="goto" ng-click="select_contact(contact, true)"><div class="inline" ng-show="show_email">{{contact.email}}</div><div class="inline" ng-show="show_mobile">{{contact.mobile}}</div><div class="pull-right"><div class="inline">{{contact.name}}</div></div></td><td><div class="pull-right"><a href="javascript:void(0)" ng-click="select_contact(contact, false)" ng-hide="contact_selected(contact)">Replace</a><span>&nbsp;::&nbsp;</span><a href="javascript:void(0)" ng-click="select_contact(contact, true)" ng-hide="contact_selected(contact)">Add</a><span>&nbsp;&nbsp;</span><a href="javascript:void(0)" ng-click="remove_contact(contact)" ng-show="contact_selected(contact)">Remove</a></div></td></tr></tbody></table></div></div><div class="row-fluid" ng-show="employees.length &gt; 0 &amp;&amp; show_employees_on_contact_list()"><div class="content-box"><div class="sub-header">Workshop Contacts</div><table class="table table-striped"><tbody><tr class="goto" ng-click="select_contact(employee)" ng-repeat="employee in employees"><td><div class="inline" ng-show="show_email">{{employee.email}}</div><div class="inline" ng-show="show_mobile">{{employee.phone}}</div><div class="pull-right"><div class="inline">{{employee.name}}</div></div></td></tr></tbody></table></div></div><div class="row"><div class="pull-right"><button class="btn btn-primary" ng-click="select()">Select</button><button class="btn" ng-click="cancel()">Cancel</button></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/creditorpicker.html",'<select ng-model="creditor" ng-options="s.id as s.name for s in creditors"><option value=""></option></select><span>&nbsp;</span><button class="btn btn-link" id="new-creditor-button" ng-click="create_creditor()" type="button">New</button><div id="create-creditor"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">New Creditor/Buying Group</div></div><div class="popover-content"><div class="row-fluid"><form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input ng-model="new_creditor.name" type="text" /></div></div><div class="control-group"><label class="control-label">Account Number</label><div class="controls"><input ng-model="new_creditor.account_number" type="text" /></div></div><div class="control-group" ng-show="country() == &#39;au&#39;"><label class="control-label">ABN</label><div class="controls"><input ng-model="new_supplier.abn" type="text" /></div></div><div class="control-group" ng-show="country() == &#39;au&#39;"><label class="control-label">ACN</label><div class="controls"><input ng-model="new_supplier.acn" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="new_creditor.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Fax</label><div class="controls"><input ng-model="new_creditor.fax" type="text" /></div></div><div addresspicker="true" ng-model="new_creditor.address"></div><div class="control-group" ng-hide="new_creditor.street_address"><label class="control-label"></label><div class="controls"><button class="btn btn-link" ng-click="add_street_address()">Add Street Address</button><br /><br /></div></div><div ng-show="new_creditor.street_address"><addresspicker address-label="Street Address" ng-model="new_creditor.street_address"></addresspicker></div><div class="control-group"><label class="control-label">Payment Term</label><div class="controls"><select ng-model="new_creditor.payment_term" ng-options="payment_term.value as payment_term.name for payment_term in payment_terms" type="text"></select></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_new_creditor()" type="button">Save</button><button class="btn" ng-click="hide_create_creditor()">Cancel</button></div></div></form></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/customerpicker.html",'<div class="inline"><div class="input-append"><input autocomplete="off" class="span12" id="{{input_id}}" ng-maxlength="255" ng-model="customer.lookup" style="max-width: 500px" type="text" typeahead="item.lookup for item in lookup($viewValue)" typeahead-on-select="select($item, $model, $label, selected_customer)" typeahead-wait-ms="200" /><span class="add-on"><div class="spinner spinner-small" id="lookup-customer-spinner-{{spinner_id}}"></div><i class="icon icon-search" id="lookup-customer-icon-{{spinner_id}}"></i></span></div><div class="inline" ng-show="customer.id &amp;&amp; with_balances" style="margin-left: 50px"><button class="btn btn-link" id="show-customer-balances-button" ng-click="show_balances()">Show Balances</button></div></div><div id="customer-balances-popover"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="spinner" id="customer-balances-spinner"></div><div class="row-fluid"><div class="sub-header"><span>{{customer.name}}</span><div class="pull-right"><a class="btn" ng-href="#/customers/{{customer.id}}" target="_blank">Full Details</a><a class="btn" ng-href="/customers/{{customer.id}}/statement.pdf" target="_blank">Statement</a><button class="btn" ng-click="close_balances()">Close</button></div></div></div></div><div class="popover-content"><div class="content-box"><div class="info"><span class="label-name customer-field-label">Customer Name:</span><span>{{customer.name}}</span></div><div class="info"><span class="label-name customer-field-label">Total Payable:</span><span class="bold">{{customer_account.total_payable|currency}}</span></div><div class="info"><span class="label-name customer-field-label">Finalized Balance:</span><span>{{customer_account.finalized_balance|currency}}</span></div><div class="info"><span class="label-name customer-field-label">Unallocated Payment:</span><span>{{customer_account.unallocated_payment_balance}}</span></div><div class="info"><span class="label-name customer-field-label">Credit:</span><span>{{customer_account.credit_balance|currency}}</span></div><div class="info"><span class="label-name customer-field-label">Running Balance:</span><span>{{customer_account.balance|currency}} &nbsp; (Include in progress invoices)</span></div></div><center><div class="button-panel"><button class="btn" ng-click="close_balances()">Close</button></div></center></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/insurerpicker.html",'<select ng-model="insurer" ng-options="s.id as s.name for s in insurers"><option value=""></option></select><span>&nbsp;</span><button class="btn btn-link" id="new-insurer-button" ng-click="create_insurer()" type="button">New</button><div id="create-insurer"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">New 3rd Party</div></div><div class="popover-content"><div class="row-fluid"><div ad-customer-form="true" allow-rename="true" ng-model="new_insurer" on-cancel="hide_create_insurer()" on-save="select_new_insurer()"></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/locationpicker.html",'<div class="inline"><div class="input-append"><input autocomplete="off" class="span12" id="{{input_id}}" ng-maxlength="255" ng-model="location" style="max-width: 500px" type="text" typeahead="item for item in lookup($viewValue)" typeahead-on-select="select($item, $model, $label, selected_location)" typeahead-wait-ms="200" /><span class="add-on"><div class="spinner spinner-small" id="lookup-location-spinner-{{spinner_id}}"></div><i class="icon icon-search" id="lookup-location-icon-{{spinner_id}}"></i></span></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/makepicker.html",'<input ng-model="make" type="text" typeahead="vm.make as vm.make for vm in makes | filter: {make: $viewValue}" />')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/modelpicker.html",'<input ng-model="model" type="text" typeahead="vm.model as vm.model for vm in models | filter: {model: $viewValue}" />')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/new_stock_category.html",'<form class="form-horizontal" name="new_category_form" novalidate="true"><div class="control-group"><label class="control-label"> Name</label><div class="controls"><div class="error" ng-show="new_category.name.$invalid">category\'s name is required</div><input name="name" ng-model="new_category.name" required="true" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_new_category()">Save</button><button class="btn" ng-click="cancel_new_category()">Cancel</button></div></div></form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/price_group_picker.html",'<select ng-model="price_group" ng-options="s.id as s.name for s in price_groups"><option value=""></option></select>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/royaltypicker.html",'<div ng-show="royalty_integration_accounts().length &gt; 0"><div class="control-group"><label class="control-label"><div>Royalty Program</div></label><div class="controls"><select ng-change="select()" ng-model="model.royalty_integration_account_id" ng-options="s.id as s.name for s in royalty_integration_accounts()"><option value=""></option></select></div></div><div ng-show="auto_club_options().length &gt; 0"><div class="control-group"><label class="control-label"><div>Customer Membership</div></label><div class="controls"><select ng-model="model.royalty_auto_club" ng-options="s.code as s.name for s in auto_club_options()"><option value=""></option></select></div></div></div><div ng-show="model.royalty_integration_account_id"><div class="control-group"><label class="control-label"><div>{{model.royalty_auto_club}} Card No.</div></label><div class="controls"><input ng-model="model.royalty_account_number" type="text" /></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/supplierpicker.html",'<div class="inline"><div class="input-append"><input autocomplete="off" id="supplierpicker-name" ng-maxlength="255" ng-model="supplier.lookup" select-value-on-click="true" style="width: 150px" type="text" typeahead="item.lookup for item in lookup($viewValue)" typeahead-on-select="select($item, $model, $label, selected_supplier)" typeahead-wait-ms="100" /><span class="add-on"><div class="spinner spinner-small" id="lookup-supplier-spinner-{{spinner_id}}"></div><i class="icon icon-search" id="lookup-supplier-icon-{{spinner_id}}"></i></span><button class="btn btn-link" id="new-supplier-button" ng-click="create_supplier()" ng-hide="disableNew" type="button">New</button></div></div><div id="create-supplier"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">New Supplier</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div ad-supplier-form="true" ng-model="new_supplier" on-cancel="hide_create_supplier()" on-save="select_new_supplier()"></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("directives/vehiclepicker.html",'<div class="inline"><div class="input-append"><input autocomplete="off" class="span12" id="{{input_id}}" ng-maxlength="255" ng-model="vehicle.title" style="max-width: 500px" type="text" typeahead="item.lookup_text for item in lookup($viewValue)" typeahead-on-select="select($item, $model, $label, selected_vehicle)" typeahead-wait-ms="200" /><span class="add-on"><div class="spinner spinner-small" id="lookup-vehicle-spinner-{{spinner_id}}"></div><i class="icon icon-search" id="lookup-vehicle-icon-{{spinner_id}}"></i></span></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("employees/edit.html",'<ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div ng-controller="EditEmployeeController"><div class="page-header">Edit Employee {{employee.name}}<div class="pull-right"><button class="btn btn-danger" ng-click="show_delete_employee_dialog()">Delete</button></div></div><div class="content-box"><form class="form-horizontal" name="employee_form" novalidate="true"><div class="row-fluid"><div class="column span6"><div class="sub-header">Employee Details</div><div class="control-group"><label class="control-label">Name</label><div class="controls"><input ng-model="employee.name" type="text" /></div></div><div class="control-group"><label class="control-label">Date of Birth</label><div class="controls"><div ad-datepicker="true" ng-model="employee.dob"></div></div></div><div class="control-group"><label class="control-label">Next of kin</label><div class="controls"><input ng-model="employee.next_of_kin" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input ng-model="employee.email" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="employee.phone" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><a ng-click="show_address = true" ng-hide="show_address || employee.address.street_line" ng-href="javascript:void(0);">Add an address</a></div></div><div ng-show="show_address || employee.address.street_line"><addresspicker ng-model="employee.address"></addresspicker></div><div class="control-group"><label class="control-label">License No.</label><div class="controls"><input class="input-small" ng-model="employee.license" /><div class="inline" style="margin-left: 10px;"><span>Expires:</span> <div ad-datepicker="true" class="inline" ng-model="employee.license_expiry_date"></div></div></div></div><div class="control-group"><label class="control-label">Driver License No.</label><div class="controls"><input class="input-small" ng-model="employee.driver_license" /><div class="inline" style="margin-left: 10px;"><span>Expires:</span> <div ad-datepicker="true" class="inline" ng-model="employee.driver_license_expiry_date"></div></div></div></div><div class="control-group"><label class="control-label">AirCon License No.</label><div class="controls"><input class="input-small" ng-model="employee.aircon_license" /><div class="inline" style="margin-left: 10px;"><span>Expires:</span> <div ad-datepicker="true" class="inline" ng-model="employee.aircon_license_expiry_date"></div></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox"><input ng-model="employee.unassignable" type="checkbox" />Omit from job assignment</label></div></div><div class="control-group"><label class="control-label">Internal Rate</label><div class="controls"><input class="input-tiny" ng-model="employee.internal_rate" step="any" type="number" /><div class="inline" style="margin-left: 10px;"><span>Overtime (extra):</span> <div class="input-append"><input class="input-tiny" ng-model="employee.internal_overtime_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><div class="control-group"><label class="control-label">Charge-out Rate</label><div class="controls"><input class="input-tiny" ng-model="employee.rate" step="any" type="number" /><div class="inline" style="margin-left: 10px;"><span>Overtime (extra):</span> <div class="input-append"><input class="input-tiny" ng-model="employee.overtime_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><div class="control-group" ng-hide="more_rate"><label class="control-label"></label><div class="controls"><a href="javascript:void(0);" ng-click="more_rate = true">More Rates</a></div></div><span ng-show="more_rate"><div class="control-group"><label class="control-label">Charge-out Rate 2</label><div class="controls"><input class="input-tiny" ng-model="employee.rate2" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 3</label><div class="controls"><input class="input-tiny" ng-model="employee.rate3" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 4</label><div class="controls"><input class="input-tiny" ng-model="employee.rate4" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 5</label><div class="controls"><input class="input-tiny" ng-model="employee.rate5" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 6</label><div class="controls"><input class="input-tiny" ng-model="employee.rate6" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 7</label><div class="controls"><input class="input-tiny" ng-model="employee.rate7" step="any" type="number" /></div></div></span><div class="control-group"><label class="control-label">Sales Commission</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="employee.commission_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div><div class="control-group"><label class="control-label">Sale Account</label><div class="controls"><select ng-model="employee.sale_account_id" ng-options="account.id as account.title for account in output_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Color Code</label><div class="controls"><spectrum-colorpicker format="&#39;hex&#39;" ng-model="employee.color_code"></spectrum-colorpicker></div></div><br /><br /><div ng-show="employee.id"><br /><br /><div ad-files="true" ng-model="employee" title="Employee Documents/Photos" upload-url="&#39;/employees/&#39; + employee.id +&#39;/upload_files&#39;" viewer-placement="left"></div><br /><br /><div ad-avatar="true" ng-model="employee" title="Avatar" upload-url="&#39;/employees/&#39; + employee.id +&#39;/avatar&#39;" viewer-placement="left"></div></div></div><div class="column span6"><div class="sub-header">Login Details</div><div class="well"><div class="bold">Note:</div><span>Assign a username and password if you want the employee to be able to login. If you do not, the employee is available for job assignment and report, but will not be able to login to the system.</span></div><label>Username:</label><div class="error" ng-show="employee.errors.username">{{employee.errors.username|error}}</div><input ng-model="employee.username" type="text" /><div ng-show="employee.no_password"><label>Password</label><input ng-model="employee.password" type="password" /></div><br /><br /><label class="checkbox"><input ng-model="employee.disabled" type="checkbox" />Inactive (This user will not be able to login into the system temporarily)</label><label class="checkbox"><input ng-model="employee.is_readonly" type="checkbox" />Read Only (This user cannot change/update anything)</label><br /><br /><div class="sub-header">Role / Access Level</div><label class="radio"><input ng-model="employee.role" type="radio" value="admin" />Admin</label><label class="radio"><input ng-model="employee.role" type="radio" value="staff" />Staff</label><label class="radio"><input ng-model="employee.role" type="radio" value="senior mechanic" />Senior Mechanic</label><label class="radio"><input ng-model="employee.role" type="radio" value="mechanic" />Mechanic</label><label class="radio"><input ng-model="employee.role" type="radio" value="restricted mechanic" />Restricted Mechanic</label><br /><br /><div class="sub-header">Restrictions</div><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_diary" />Cannot Access Diary</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_all_jobs" />Cannot Access All Jobs Tab (under Jobs section)</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_inventory" />Cannot Access Inventory</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_customers_and_vehicles" />Cannot Access Customers And Vehicles</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_timesheets" />Cannot Access Timesheets</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_reports" />Cannot Access Reports</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_service_schedules" />Cannot Access Service Schedules</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_pos" />Cannot Access POS</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_integrations" />Cannot Access Integrations</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="create_payments" />Cannot Create Payment</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="create_jobs" />Cannot Create New Jobs, Bookings, Quotes</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="deletion" />Cannot Delete Invoices, Bills, Payments, Credit Notes etc..</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="update_inventory" />Cannot Update Inventory</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="process_purchase_orders" />Cannot Process Purchase Orders</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="finalize_documents" />Cannot Finalize Invoices, Bills, Credit Notes etc..</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="update_finalized_documents" />Cannot Update Finalized Invoices, Bills, Credit Notes etc..</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="no_access_out_of_hours" />No Out Of Hours Access</label><br /><br /></div></div><div class="button-panel" style="text-align: center;"><button class="btn btn-success" ng-click="save_employee()">Save</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="save-employee-spinner"></div></div></form></div><div modal="showing_delete_employee_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this employee</h3></div><div class="modal-body"><div>Are you sure you want to delete this employee</div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_employee()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_employee()">Cancel</button></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("employees/form.html",'<div class="content-box"><form class="form-horizontal" name="employee_form" novalidate="true"><div class="row-fluid"><div class="column span6"><div class="sub-header">Employee Details</div><div class="control-group"><label class="control-label">Name</label><div class="controls"><input ng-model="employee.name" type="text" /></div></div><div class="control-group"><label class="control-label">Date of Birth</label><div class="controls"><div ad-datepicker="true" ng-model="employee.dob"></div></div></div><div class="control-group"><label class="control-label">Next of kin</label><div class="controls"><input ng-model="employee.next_of_kin" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input ng-model="employee.email" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="employee.phone" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><a ng-click="show_address = true" ng-hide="show_address || employee.address.street_line" ng-href="javascript:void(0);">Add an address</a></div></div><div ng-show="show_address || employee.address.street_line"><addresspicker ng-model="employee.address"></addresspicker></div><div class="control-group"><label class="control-label">License No.</label><div class="controls"><input class="input-small" ng-model="employee.license" /><div class="inline" style="margin-left: 10px;"><span>Expires:</span> <div ad-datepicker="true" class="inline" ng-model="employee.license_expiry_date"></div></div></div></div><div class="control-group"><label class="control-label">Driver License No.</label><div class="controls"><input class="input-small" ng-model="employee.driver_license" /><div class="inline" style="margin-left: 10px;"><span>Expires:</span> <div ad-datepicker="true" class="inline" ng-model="employee.driver_license_expiry_date"></div></div></div></div><div class="control-group"><label class="control-label">AirCon License No.</label><div class="controls"><input class="input-small" ng-model="employee.aircon_license" /><div class="inline" style="margin-left: 10px;"><span>Expires:</span> <div ad-datepicker="true" class="inline" ng-model="employee.aircon_license_expiry_date"></div></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox"><input ng-model="employee.unassignable" type="checkbox" />Omit from job assignment</label></div></div><div class="control-group"><label class="control-label">Internal Rate</label><div class="controls"><input class="input-tiny" ng-model="employee.internal_rate" step="any" type="number" /><div class="inline" style="margin-left: 10px;"><span>Overtime (extra):</span> <div class="input-append"><input class="input-tiny" ng-model="employee.internal_overtime_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><div class="control-group"><label class="control-label">Charge-out Rate</label><div class="controls"><input class="input-tiny" ng-model="employee.rate" step="any" type="number" /><div class="inline" style="margin-left: 10px;"><span>Overtime (extra):</span> <div class="input-append"><input class="input-tiny" ng-model="employee.overtime_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><div class="control-group" ng-hide="more_rate"><label class="control-label"></label><div class="controls"><a href="javascript:void(0);" ng-click="more_rate = true">More Rates</a></div></div><span ng-show="more_rate"><div class="control-group"><label class="control-label">Charge-out Rate 2</label><div class="controls"><input class="input-tiny" ng-model="employee.rate2" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 3</label><div class="controls"><input class="input-tiny" ng-model="employee.rate3" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 4</label><div class="controls"><input class="input-tiny" ng-model="employee.rate4" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 5</label><div class="controls"><input class="input-tiny" ng-model="employee.rate5" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 6</label><div class="controls"><input class="input-tiny" ng-model="employee.rate6" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 7</label><div class="controls"><input class="input-tiny" ng-model="employee.rate7" step="any" type="number" /></div></div></span><div class="control-group"><label class="control-label">Sales Commission</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="employee.commission_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div><div class="control-group"><label class="control-label">Sale Account</label><div class="controls"><select ng-model="employee.sale_account_id" ng-options="account.id as account.title for account in output_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Color Code</label><div class="controls"><spectrum-colorpicker format="&#39;hex&#39;" ng-model="employee.color_code"></spectrum-colorpicker></div></div><br /><br /><div ng-show="employee.id"><br /><br /><div ad-files="true" ng-model="employee" title="Employee Documents/Photos" upload-url="&#39;/employees/&#39; + employee.id +&#39;/upload_files&#39;" viewer-placement="left"></div><br /><br /><div ad-avatar="true" ng-model="employee" title="Avatar" upload-url="&#39;/employees/&#39; + employee.id +&#39;/avatar&#39;" viewer-placement="left"></div></div></div><div class="column span6"><div class="sub-header">Login Details</div><div class="well"><div class="bold">Note:</div><span>Assign a username and password if you want the employee to be able to login. If you do not, the employee is available for job assignment and report, but will not be able to login to the system.</span></div><label>Username:</label><div class="error" ng-show="employee.errors.username">{{employee.errors.username|error}}</div><input ng-model="employee.username" type="text" /><div ng-show="employee.no_password"><label>Password</label><input ng-model="employee.password" type="password" /></div><br /><br /><label class="checkbox"><input ng-model="employee.disabled" type="checkbox" />Inactive (This user will not be able to login into the system temporarily)</label><label class="checkbox"><input ng-model="employee.is_readonly" type="checkbox" />Read Only (This user cannot change/update anything)</label><br /><br /><div class="sub-header">Role / Access Level</div><label class="radio"><input ng-model="employee.role" type="radio" value="admin" />Admin</label><label class="radio"><input ng-model="employee.role" type="radio" value="staff" />Staff</label><label class="radio"><input ng-model="employee.role" type="radio" value="senior mechanic" />Senior Mechanic</label><label class="radio"><input ng-model="employee.role" type="radio" value="mechanic" />Mechanic</label><label class="radio"><input ng-model="employee.role" type="radio" value="restricted mechanic" />Restricted Mechanic</label><br /><br /><div class="sub-header">Restrictions</div><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_diary" />Cannot Access Diary</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_all_jobs" />Cannot Access All Jobs Tab (under Jobs section)</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_inventory" />Cannot Access Inventory</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_customers_and_vehicles" />Cannot Access Customers And Vehicles</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_timesheets" />Cannot Access Timesheets</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_reports" />Cannot Access Reports</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_service_schedules" />Cannot Access Service Schedules</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_pos" />Cannot Access POS</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_integrations" />Cannot Access Integrations</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="create_payments" />Cannot Create Payment</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="create_jobs" />Cannot Create New Jobs, Bookings, Quotes</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="deletion" />Cannot Delete Invoices, Bills, Payments, Credit Notes etc..</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="update_inventory" />Cannot Update Inventory</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="process_purchase_orders" />Cannot Process Purchase Orders</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="finalize_documents" />Cannot Finalize Invoices, Bills, Credit Notes etc..</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="update_finalized_documents" />Cannot Update Finalized Invoices, Bills, Credit Notes etc..</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="no_access_out_of_hours" />No Out Of Hours Access</label><br /><br /></div></div><div class="button-panel" style="text-align: center;"><button class="btn btn-success" ng-click="save_employee()">Save</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="save-employee-spinner"></div></div></form></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("employees/index.html",'<div ng-controller="EmployeesController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">Employees<div class="pull-right"><a class="btn btn-primary" ng-href="#/employees/new">New Employee</a></div></div><div class="content-box"><table class="table table-striped"><thead><tr><th>Employee</th><th>Username</th><th>Role/Access Level</th><th>License</th><th>Driver License</th><th>Colour Code</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/employees/&#39; + employee.id + &#39;/edit&#39;)" ng-repeat="employee in employees"><td><div>{{employee.name}}</div><div ng-show="employee.phone"><i class="icon icon-phone"></i><span>{{employee.phone}}</span></div><div ng-show="employee.email"><i class="icon icon-envelope"></i><span>{{employee.email}}</span></div><div ng-show="employee.address.full_address"><i class="icon icon-home"></i><span>{{employee.address.full_address}}</span></div></td><td>{{employee.username}}</td><td>{{employee.role}}</td><td><div>License No.#: {{employee.license}}</div><div ng-show="employee.license"><div>Expiry Date: {{employee.license_expiry_date|date}}</div><div class="red" ng-show="employee.license_expired_in_days &gt; 0 &amp;&amp; employee.license_expired_in_days &lt; 17">Expired in {{employee.license_expired_in_days}} days</div><div class="red" ng-show="employee.license_expired_in_days &lt; 0">Expired</div></div></td><td><div>License No.#: {{employee.driver_license}}</div><div ng-show="employee.driver_license"><div>Expiry Date: {{employee.driver_license_expiry_date|date}}</div><div class="red" ng-show="employee.driver_license_expired_in_days &gt; 0 &amp;&amp; employee.driver_license_expired_in_days &lt; 17">Expired in {{employee.driver_license_expired_in_days}} days</div><div class="red" ng-show="employee.driver_license_expired_in_days &lt; 0">Expired</div></div></td><td><label class="label" style="height: 25px; width: 50px; background-color: {{employee.color_code}}; margin-left: 2px; margin-right: 2px; text-align: center">&nbsp;</label></td></tr></tbody></table></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("employees/list.html",'<div class="content-box"><table class="table table-striped"><thead><tr><th>Employee</th><th>Username</th><th>Role/Access Level</th><th>License</th><th>Driver License</th><th>Colour Code</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/employees/&#39; + employee.id + &#39;/edit&#39;)" ng-repeat="employee in employees"><td><div>{{employee.name}}</div><div ng-show="employee.phone"><i class="icon icon-phone"></i><span>{{employee.phone}}</span></div><div ng-show="employee.email"><i class="icon icon-envelope"></i><span>{{employee.email}}</span></div><div ng-show="employee.address.full_address"><i class="icon icon-home"></i><span>{{employee.address.full_address}}</span></div></td><td>{{employee.username}}</td><td>{{employee.role}}</td><td><div>License No.#: {{employee.license}}</div><div ng-show="employee.license"><div>Expiry Date: {{employee.license_expiry_date|date}}</div><div class="red" ng-show="employee.license_expired_in_days &gt; 0 &amp;&amp; employee.license_expired_in_days &lt; 17">Expired in {{employee.license_expired_in_days}} days</div><div class="red" ng-show="employee.license_expired_in_days &lt; 0">Expired</div></div></td><td><div>License No.#: {{employee.driver_license}}</div><div ng-show="employee.driver_license"><div>Expiry Date: {{employee.driver_license_expiry_date|date}}</div><div class="red" ng-show="employee.driver_license_expired_in_days &gt; 0 &amp;&amp; employee.driver_license_expired_in_days &lt; 17">Expired in {{employee.driver_license_expired_in_days}} days</div><div class="red" ng-show="employee.driver_license_expired_in_days &lt; 0">Expired</div></div></td><td><label class="label" style="height: 25px; width: 50px; background-color: {{employee.color_code}}; margin-left: 2px; margin-right: 2px; text-align: center">&nbsp;</label></td></tr></tbody></table></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("employees/new.html",'<ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div ng-controller="NewEmployeeController"><div class="page-header">New Employee</div><div class="well" ng-show="paying_employee() &amp;&amp; !confirmed_paying_employee"><span ng-bind-html-unsafe="additional_employee_price_message()"></span><br /><button class="btn btn-primary" ng-click="confirm_paying_employee()">Confirm</button><button class="btn" ng-click="back()">Cancel</button><a href="#/auto_workshop_details">Review my pricing plan</a></div><div class="content-box"><form class="form-horizontal" name="employee_form" novalidate="true"><div class="row-fluid"><div class="column span6"><div class="sub-header">Employee Details</div><div class="control-group"><label class="control-label">Name</label><div class="controls"><input ng-model="employee.name" type="text" /></div></div><div class="control-group"><label class="control-label">Date of Birth</label><div class="controls"><div ad-datepicker="true" ng-model="employee.dob"></div></div></div><div class="control-group"><label class="control-label">Next of kin</label><div class="controls"><input ng-model="employee.next_of_kin" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input ng-model="employee.email" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="employee.phone" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><a ng-click="show_address = true" ng-hide="show_address || employee.address.street_line" ng-href="javascript:void(0);">Add an address</a></div></div><div ng-show="show_address || employee.address.street_line"><addresspicker ng-model="employee.address"></addresspicker></div><div class="control-group"><label class="control-label">License No.</label><div class="controls"><input class="input-small" ng-model="employee.license" /><div class="inline" style="margin-left: 10px;"><span>Expires:</span> <div ad-datepicker="true" class="inline" ng-model="employee.license_expiry_date"></div></div></div></div><div class="control-group"><label class="control-label">Driver License No.</label><div class="controls"><input class="input-small" ng-model="employee.driver_license" /><div class="inline" style="margin-left: 10px;"><span>Expires:</span> <div ad-datepicker="true" class="inline" ng-model="employee.driver_license_expiry_date"></div></div></div></div><div class="control-group"><label class="control-label">AirCon License No.</label><div class="controls"><input class="input-small" ng-model="employee.aircon_license" /><div class="inline" style="margin-left: 10px;"><span>Expires:</span> <div ad-datepicker="true" class="inline" ng-model="employee.aircon_license_expiry_date"></div></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><label class="checkbox"><input ng-model="employee.unassignable" type="checkbox" />Omit from job assignment</label></div></div><div class="control-group"><label class="control-label">Internal Rate</label><div class="controls"><input class="input-tiny" ng-model="employee.internal_rate" step="any" type="number" /><div class="inline" style="margin-left: 10px;"><span>Overtime (extra):</span> <div class="input-append"><input class="input-tiny" ng-model="employee.internal_overtime_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><div class="control-group"><label class="control-label">Charge-out Rate</label><div class="controls"><input class="input-tiny" ng-model="employee.rate" step="any" type="number" /><div class="inline" style="margin-left: 10px;"><span>Overtime (extra):</span> <div class="input-append"><input class="input-tiny" ng-model="employee.overtime_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div></div><div class="control-group" ng-hide="more_rate"><label class="control-label"></label><div class="controls"><a href="javascript:void(0);" ng-click="more_rate = true">More Rates</a></div></div><span ng-show="more_rate"><div class="control-group"><label class="control-label">Charge-out Rate 2</label><div class="controls"><input class="input-tiny" ng-model="employee.rate2" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 3</label><div class="controls"><input class="input-tiny" ng-model="employee.rate3" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 4</label><div class="controls"><input class="input-tiny" ng-model="employee.rate4" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 5</label><div class="controls"><input class="input-tiny" ng-model="employee.rate5" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 6</label><div class="controls"><input class="input-tiny" ng-model="employee.rate6" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Charge-out Rate 7</label><div class="controls"><input class="input-tiny" ng-model="employee.rate7" step="any" type="number" /></div></div></span><div class="control-group"><label class="control-label">Sales Commission</label><div class="controls"><div class="input-append"><input class="input-tiny" ng-model="employee.commission_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div><div class="control-group"><label class="control-label">Sale Account</label><div class="controls"><select ng-model="employee.sale_account_id" ng-options="account.id as account.title for account in output_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Color Code</label><div class="controls"><spectrum-colorpicker format="&#39;hex&#39;" ng-model="employee.color_code"></spectrum-colorpicker></div></div><br /><br /><div ng-show="employee.id"><br /><br /><div ad-files="true" ng-model="employee" title="Employee Documents/Photos" upload-url="&#39;/employees/&#39; + employee.id +&#39;/upload_files&#39;" viewer-placement="left"></div><br /><br /><div ad-avatar="true" ng-model="employee" title="Avatar" upload-url="&#39;/employees/&#39; + employee.id +&#39;/avatar&#39;" viewer-placement="left"></div></div></div><div class="column span6"><div class="sub-header">Login Details</div><div class="well"><div class="bold">Note:</div><span>Assign a username and password if you want the employee to be able to login. If you do not, the employee is available for job assignment and report, but will not be able to login to the system.</span></div><label>Username:</label><div class="error" ng-show="employee.errors.username">{{employee.errors.username|error}}</div><input ng-model="employee.username" type="text" /><div ng-show="employee.no_password"><label>Password</label><input ng-model="employee.password" type="password" /></div><br /><br /><label class="checkbox"><input ng-model="employee.disabled" type="checkbox" />Inactive (This user will not be able to login into the system temporarily)</label><label class="checkbox"><input ng-model="employee.is_readonly" type="checkbox" />Read Only (This user cannot change/update anything)</label><br /><br /><div class="sub-header">Role / Access Level</div><label class="radio"><input ng-model="employee.role" type="radio" value="admin" />Admin</label><label class="radio"><input ng-model="employee.role" type="radio" value="staff" />Staff</label><label class="radio"><input ng-model="employee.role" type="radio" value="senior mechanic" />Senior Mechanic</label><label class="radio"><input ng-model="employee.role" type="radio" value="mechanic" />Mechanic</label><label class="radio"><input ng-model="employee.role" type="radio" value="restricted mechanic" />Restricted Mechanic</label><br /><br /><div class="sub-header">Restrictions</div><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_diary" />Cannot Access Diary</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_all_jobs" />Cannot Access All Jobs Tab (under Jobs section)</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_inventory" />Cannot Access Inventory</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_customers_and_vehicles" />Cannot Access Customers And Vehicles</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_timesheets" />Cannot Access Timesheets</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_reports" />Cannot Access Reports</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_service_schedules" />Cannot Access Service Schedules</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_pos" />Cannot Access POS</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="access_integrations" />Cannot Access Integrations</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="create_payments" />Cannot Create Payment</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="create_jobs" />Cannot Create New Jobs, Bookings, Quotes</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="deletion" />Cannot Delete Invoices, Bills, Payments, Credit Notes etc..</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="update_inventory" />Cannot Update Inventory</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="process_purchase_orders" />Cannot Process Purchase Orders</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="finalize_documents" />Cannot Finalize Invoices, Bills, Credit Notes etc..</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="update_finalized_documents" />Cannot Update Finalized Invoices, Bills, Credit Notes etc..</label><label class="checkbox"><input check-list="employee.restrictions" type="checkbox" value="no_access_out_of_hours" />No Out Of Hours Access</label><br /><br /></div></div><div class="button-panel" style="text-align: center;"><button class="btn btn-success" ng-click="save_employee()">Save</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="save-employee-spinner"></div></div></form></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("employees/tabs.html",'<ul class="sub-nav" ng-controller="EmployeesNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("follow_ups/index.html",'<div ng-controller="FollowUpsController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="page-header"><span>Follow Ups</span><div class="pull-right"><form class="form-search inline"><button class="btn btn-link" ng-click="show_filter()" ng-hide="showing_filter" type="button">More Options</button><button class="btn btn-link" ng-click="hide_filter()" ng-show="showing_filter" type="button">Hide</button><div class="inline" ng-show="showing_filter"><label class="inline">From:</label> <ad-datepicker ng-model="query.from"><span class="add-on"><i class="icon-calendar"></i></span></ad-datepicker><span>&nbsp;</span><label class="inline">To:</label> <ad-datepicker ng-model="query.to"></ad-datepicker><span>&nbsp;</span></div><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn btn-primary" ng-click="search()" type="submit"><i class="icon-search"></i>Search</button></form></div></div><div class="search-description" ng-show="query.query">Search "{{query.query}}"</div></div><div class="row-fluid"><div class="column span6"><div class="content-box"><div class="row-fluid"><div class="sub-header">Scheduled Follow Ups<div class="pull-right"><button class="btn btn-primary" id="new-follow-up-button" ng-click="new()">New Follow Up</button></div></div></div><br /><div class="row-fluid"><div class="spinner" id="current-followups-spinner"></div><table class="table table-striped"><tbody><tr class="editable" id="follow-up-{{follow_up.id}}" ng-repeat="follow_up in current.follow_ups"><td ng-click="edit(follow_up)"><div class="row-fluid"><div class="column span5"><div class="truncate"><label class="label-name-left">Customer</label><span>{{follow_up.customer.name}}</span></div></div><div class="column span5"><div ng-show="follow_up.job"><a ng-href="#jobs/{{follow_up.job.id}}" stop-event="click" target="_blank"><div>{{follow_up.job.title}}</div></a></div></div><div class="column span2"><div class="pull-right"><span>{{follow_up.date|date}}</span></div></div></div><div class="row-fluid"><pre class="no-style">{{follow_up.message}}</pre></div></td></tr></tbody></table><pagination boundary-links="false" current-page="current.meta.page_number" max-size="8" num-pages="current.meta.total_pages" on-select-page="search_current(page)" rotate="false"></pagination></div></div></div><div class="column span6"><div class="content-box"><div class="row-fluid"><div class="sub-header">Processed Follow Ups</div></div><div class="spinner" id="processed-followups-spinner"></div><div class="row-fluid"><table class="table table-striped"><tbody><tr id="follow-up-{{follow_up.id}}" ng-repeat="follow_up in processed.follow_ups"><td><div class="row-fluid"><div class="column span5"><div class="truncate"><label class="label-name-left">Customer</label><span>{{follow_up.customer.name}}</span></div></div><div class="column span5"><div ng-show="follow_up.job"><a ng-href="#jobs/{{follow_up.job.id}}" stop-event="click" target="_blank"><div>{{follow_up.job.title}}</div></a></div></div><div class="column span2"><div class="pull-right"><span>{{follow_up.date|date}}</span></div></div></div><div class="row-fluid"><pre class="no-style">{{follow_up.message}}</pre></div></td></tr></tbody></table><pagination boundary-links="false" current-page="processed.meta.page_number" max-size="8" num-pages="processed.meta.total_pages" on-select-page="search_processed(page)" rotate="false"></pagination></div></div></div></div><div id="edit-follow-up-popover"><div class="popover fade left in" style="width: 550px"><div class="popover-title"><div class="sub-header">{{job.title}}</div></div><div class="popover-content"><div class="row-fluid"><div class="spinner" id="edit-follow-up-spinner"></div><div class="content-box"><div><label class="label-name-left inline" style="vertical-align: middle">Customer</label><div class="inline" customer="follow_up.customer" customerpicker="true"></div></div><div><label class="label-name-left inline" style="vertical-align: middle">Date</label><div ad-datepicker="true" class="inline" ng-model="follow_up.date"></div></div><div><label class="label-name-left inline" style="vertical-align: bottom">Delivery Method:</label><label class="radio inline"><input ng-model="follow_up.delivery_method" type="radio" value="sms" /><span>SMS</span></label><label class="radio inline"><input ng-model="follow_up.delivery_method" selected="true" type="radio" value="email" /><span>Email</span></label></div><div><span>Message:</span><div ad-saved-texts-button="true" class="inline" ng-model="follow_up.message"></div><textarea class="span12 maintenance-entry" ng-model="follow_up.message"></textarea></div></div></div><div class="row-fluid"><div class="button-panel"><button class="btn btn-success" ng-click="save()">Save</button><button class="btn" ng-click="cancel()">Close</button><div class="pull-right"><button class="btn btn-danger" ng-click="cancel_follow_up()" ng-show="follow_up.id">Cancel Follow Up</button></div></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("franchisor/customers.html",'<div ng-controller="CustomersController"><div class="page-header">Customers<div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="search-description" ng-show="keyword">Search "{{query}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="row-fluid"><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div><div class="row-fluid"><div class="content-box"><div class="spinner" id="customer-list-spinner"></div><table class="table table-striped"><thead><tr><th class="column-sortable" ng-click="sort(&#39;number&#39;)">Customer No#</th><th class="column-sortable" ng-click="sort(&#39;name&#39;)">Name</th><th>Phone</th><th>Email</th><th>Address</th><th class="column-sortable" ng-click="sort(&#39;balance&#39;)">Balance</th></tr></thead><tbody><tr class="goto" ng-repeat="customer in customers"><td>{{customer.number}}</td><td>{{customer.name}}</td><td><div ng-show="customer.phone">{{customer.phone}}</div><div ng-show="customer.mobile &amp;&amp; customer.mobile != customer.phone">{{customer.mobile}}</div></td><td>{{customer.email}}</td><td>{{customer.address.full_address}}</td><td ng-class="{red: customer.balance &gt; 0, green: customer.balance == 0}">{{customer.balance|currency}}</td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="20" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("franchisor/reports/buyins.html",'<br /><div class="content-nav" ng-controller="ReportsNavController"><ul><li ng-class="{active: isActive(&#39;payments&#39;)}" ng-click="select_report(&#39;payments&#39;)"><a>Received Payments</a></li><li ng-class="{active: isActive(&#39;income&#39;)}" ng-click="select_report(&#39;income&#39;)"><a>Income</a></li><li ng-class="{active: isActive(&#39;sales&#39;)}" ng-click="select_report(&#39;sales&#39;)"><a>Sales</a></li><li ng-class="{active: isActive(&#39;purchases&#39;)}" ng-click="select_report(&#39;purchases&#39;)"><a>Purchases</a></li><li ng-class="{active: isActive(&#39;leads&#39;)}" ng-click="select_report(&#39;leads&#39;)"><a>Leads</a></li><li ng-class="{active: isActive(&#39;stock_values&#39;)}" ng-click="select_report(&#39;stock_values&#39;)"><a>Stock Values</a></li></ul></div><div class="row-fluid" ng-controller="BuyinReportController"><div class="spinner" id="report-spinner"></div><div class="page-header">Buyin Report</div><div class="row-fluid"><label>Buyin Stock:&nbsp;</label><div class="inline"><div ad-stockpicker="true" input-id="stockpicker-input" ng-model="stock" on-select="filter_report()"></div></div><div class="pull-right search-form"><div class="inline"><div class="form-inline"><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div></div></div><br /><div class="content-box" ng-show="stock.id"><div class="sub-header">Purchases</div><table class="table table-striped"><thead><tr><th>Date</th><th>Supplier</th><th>Bill Ref</th><th>Item</th><th>Qty.</th><th></th></tr></thead><tbody><tr class="goto" ng-click="open_purchase(purchase)" ng-repeat="purchase in data.purchases"><td>{{purchase.date|date: \'shortDate\'}}</td><td>{{purchase.supplier}}</td><td>{{purchase.bill_reference}}</td><td>{{purchase.description}}</td><td>{{purchase.quantity}}</td><td><div ng-show="purchase.invoice_number"><a ng-href="#/invoices/{{purchase.invoice_number}}" stop-event="click" target="_blank"><span class="badge badge-info">Invoice {{purchase.invoice_number}} - Qty. {{purchase.invoice_quantity}}</span></a></div></td></tr></tbody></table><div ng-show="data.customer_returns.length &gt; 0"><br /><hr /><br /><div class="sub-header">Customer Returns</div><table class="table table-striped"><thead><tr><th>Date</th><th>Customer</th><th>Credit Note No.#</th><th>Item</th><th>Qty.</th><th></th></tr></thead><tbody><tr class="goto" ng-click="open_customer_return(ri)" ng-repeat="ri in data.customer_returns"><td>{{ri.date|date: \'shortDate\'}}</td><td>{{ri.customer}}</td><td>{{ri.credit_note_number}}</td><td>{{ri.description}}</td><td>{{ri.quantity}}</td></tr></tbody></table></div></div><br /><div class="content-box"><div class="sub-header">Returned</div><table class="table table-striped"><thead><tr><th>Date</th><th>Supplier</th><th>Supplier Credit Note</th><th>Item</th><th>Qty.</th><th></th></tr></thead><tbody><tr class="goto" ng-click="open_return(ri)" ng-repeat="ri in data.returns"><td>{{ri.date|date: \'shortDate\'}}</td><td>{{ri.supplier}}</td><td>{{ri.supplier_credit_note_reference}}</td><td>{{ri.description}}</td><td>{{ri.quantity}}</td></tr></tbody></table></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("franchisor/reports/income.html",'<br /><div class="content-nav" ng-controller="ReportsNavController"><ul><li ng-class="{active: isActive(&#39;payments&#39;)}" ng-click="select_report(&#39;payments&#39;)"><a>Received Payments</a></li><li ng-class="{active: isActive(&#39;income&#39;)}" ng-click="select_report(&#39;income&#39;)"><a>Income</a></li><li ng-class="{active: isActive(&#39;sales&#39;)}" ng-click="select_report(&#39;sales&#39;)"><a>Sales</a></li><li ng-class="{active: isActive(&#39;purchases&#39;)}" ng-click="select_report(&#39;purchases&#39;)"><a>Purchases</a></li><li ng-class="{active: isActive(&#39;leads&#39;)}" ng-click="select_report(&#39;leads&#39;)"><a>Leads</a></li><li ng-class="{active: isActive(&#39;stock_values&#39;)}" ng-click="select_report(&#39;stock_values&#39;)"><a>Stock Values</a></li></ul></div><div class="row-fluid" ng-controller="IncomeWeeklyMonthlyReportController"><div class="spinner" id="report-spinner"></div><div class="page-header">Incomes</div><div class="row-fluid"><div class="pull-left"><label class="checkbox"><input ng-change="filter_report()" ng-model="include_unfinalized" type="checkbox" />Include Unfinalized Invoices</label></div><div class="pull-right search-form"><div class="inline"><div class="form-inline"><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button></div></div><br /><div class="content-box"><div class="row-fluid"><div class="column span12 income-report-by-time-selection"><div class="form-inline"><div class="sub-header inline">Income by:</div><label class="radio"><input ng-model="by_time" type="radio" value="week" />Week</label><label class="radio"><input ng-model="by_time" type="radio" value="month" />Month</label></div></div></div><div class="row-fluid income-report-by-time"><div class="column span12 report-container"><div ng-show="by_time==&#39;week&#39; &amp;&amp; data.income_by_week.length &gt; 0"><div class="report report-bar" id="income-by-week-report"></div></div><div ng-show="by_time==&#39;week&#39; &amp;&amp; data.income_by_week.length == 0"><span>No data available in this reporting period</span></div><div ng-show="by_time==&#39;month&#39; &amp;&amp; data.income_by_month.length &gt; 0"><div class="report report-bar" id="income-by-month-report"></div></div><div ng-show="by_time==&#39;month&#39; &amp;&amp; data.income_by_month.length == 0"><span>No data available in this reporting period</span></div></div></div><br /><br /><table class="table table-striped"><thead><tr><th>Date</th><th class="text-align-right">No.#</th><th class="text-align-right">Customer </th><th class="text-align-right">{{tax_name()}}</th><th class="text-align-right">Total</th><th class="text-align-right">COGS</th><th class="text-align-right">Profit Margin</th><th class="text-align-right">Paid</th><th class="text-align-right">Remain</th></tr></thead><tbody><tr class="goto" ng-click="open_invoice(invoice)" ng-repeat="invoice in data.invoices"><td>{{invoice.date|date: \'mediumDate\'}}</td><td class="text-align-right">{{invoice.number}}</td><td class="text-align-right">{{invoice.customer_name}}</td><td class="text-align-right">{{invoice.gst_amount|currency}}</td><td class="text-align-right">{{invoice.total_amount|currency}}</td><td class="text-align-right">{{invoice.total_cost|currency}}</td><td class="text-align-right">{{invoice.profit_margin|currency}}</td><td class="text-align-right">{{invoice.paid_amount|currency}}</td><td class="text-align-right">{{invoice.unpaid_amount|currency}}</td></tr><tr><td></td><td></td><td class="bold text-align-right">Total</td><td class="text-align-right bold">{{data.total_gst_amount|currency}}</td><td class="text-align-right bold">{{data.total_receivable_amount|currency}}</td><td class="text-align-right bold">{{data.total_cost|currency}}</td><td class="text-align-right bold"><div>{{data.total_profit_margin|currency}}</div><div>{{data.total_profit_margin_percentage}}%</div></td><td class="text-align-right bold">{{data.total_received_amount|currency}}</td><td class="text-align-right bold">{{data.total_remaining_amount|currency}}</td></tr></tbody></table></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("franchisor/reports/index.html",'<div class="row-fluid" ng-controller="ReportsController"><div class="content-box"><div>Please select A Workshop on the right hand side to starts</div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("franchisor/reports/leads.html",'<br /><div class="content-nav" ng-controller="ReportsNavController"><ul><li ng-class="{active: isActive(&#39;payments&#39;)}" ng-click="select_report(&#39;payments&#39;)"><a>Received Payments</a></li><li ng-class="{active: isActive(&#39;income&#39;)}" ng-click="select_report(&#39;income&#39;)"><a>Income</a></li><li ng-class="{active: isActive(&#39;sales&#39;)}" ng-click="select_report(&#39;sales&#39;)"><a>Sales</a></li><li ng-class="{active: isActive(&#39;purchases&#39;)}" ng-click="select_report(&#39;purchases&#39;)"><a>Purchases</a></li><li ng-class="{active: isActive(&#39;leads&#39;)}" ng-click="select_report(&#39;leads&#39;)"><a>Leads</a></li><li ng-class="{active: isActive(&#39;stock_values&#39;)}" ng-click="select_report(&#39;stock_values&#39;)"><a>Stock Values</a></li></ul></div><div class="row-fluid" ng-controller="LeadReportController"><div class="page-header">Lead Report</div><div class="row-fluid"><div class="pull-right search-form"><div class="form-inline"><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div></div><br /><div class="content-box"><div class="spinner" id="lead-new-customer-report-spinner"></div><div class="sub-header">New Customers</div><div ng-show="data.length == 0"><span>No data available in this reporting period</span></div><div class="report report-pie" id="lead-new-customer-report"></div></div><br /><div class="content-box"><div class="spinner" id="report-spinner"></div><div class="sub-header">Income By Source Of Business </div><div ng-show="data.length == 0"><span>No data available in this reporting period</span></div><div class="report report-pie" id="lead-report"></div><br /><div class="bold">Please Note: Only the first invoice is considered from the source, all subsequence invoices are grouped into "Repeated Customers"</div></div><br /><div class="content-box"><div class="sub-header">Income By Original Source Of Business </div><div ng-show="data.original_source_data.length == 0"><span>No data available in this reporting period</span></div><div class="report report-pie" id="original-lead-report"></div><br /></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("franchisor/reports/payments.html",'<br /><div class="content-nav" ng-controller="ReportsNavController"><ul><li ng-class="{active: isActive(&#39;payments&#39;)}" ng-click="select_report(&#39;payments&#39;)"><a>Received Payments</a></li><li ng-class="{active: isActive(&#39;income&#39;)}" ng-click="select_report(&#39;income&#39;)"><a>Income</a></li><li ng-class="{active: isActive(&#39;sales&#39;)}" ng-click="select_report(&#39;sales&#39;)"><a>Sales</a></li><li ng-class="{active: isActive(&#39;purchases&#39;)}" ng-click="select_report(&#39;purchases&#39;)"><a>Purchases</a></li><li ng-class="{active: isActive(&#39;leads&#39;)}" ng-click="select_report(&#39;leads&#39;)"><a>Leads</a></li><li ng-class="{active: isActive(&#39;stock_values&#39;)}" ng-click="select_report(&#39;stock_values&#39;)"><a>Stock Values</a></li></ul></div><div class="row-fluid" ng-controller="DailyIncomeReportController"><div class="spinner" id="report-spinner"></div><div class="page-header">Received Payments</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button></div></div><br /><div class="content-box"><div ng-show="data.data.length == 0"><span>No data available in this reporting period</span></div><div class="report report-pie" id="income-payment-method-report"></div><br /><br /><table class="table table-striped" ng-hide="showing_day"><thead><tr><th>Date</th><th class="text-align-right">Cash</th><th class="text-align-right">EFTPOS</th><th class="text-align-right">Bank Transfer</th><th class="text-align-right">Credit Card</th><th class="text-align-right">Direct Debit</th><th class="text-align-right">Cheque</th><th class="text-align-right">Paypal</th><th class="text-align-right">Other</th><th class="text-align-right">Total</th></tr></thead><tbody><tr class="goto" ng-click="show_day(day)" ng-repeat="day in data.days" tooltip="click to show payment on this day"><td>{{day.date|date}}</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: day.summary.cash &gt; 0}">{{day.summary.cash|currency}}</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: day.summary.debit &gt; 0}">{{day.summary.debit|currency}}</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: day.summary.eft &gt; 0}">{{day.summary.eft|currency}}</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: day.summary.credit &gt; 0}">{{day.summary.credit|currency}}</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: day.summary.direct_debit &gt; 0}">{{day.summary.direct_debit|currency}}</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: day.summary.cheque &gt; 0}">{{day.summary.cheque|currency}}</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: day.summary.paypal &gt; 0}">{{day.summary.paypal|currency}}</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: day.summary.unspecified &gt; 0}">{{day.summary.unspecified|currency}}</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: day.summary.total &gt; 0}">{{day.summary.total|currency}}</td></tr></tbody></table><div ng-show="showing_day"><label class="label label-info">Showing {{showing_day.date|date}}</label><button class="btn btn-link" ng-click="show_summary()">Summary</button><table class="table table-striped"><thead><tr><th>Customer</th><th>Payment Type</th><th class="text-align-right">Amount</th><th>Reference</th><th>Invoice No.</th></tr></thead><tbody><tr ng-click="open_payment(payment)" ng-repeat="payment in showing_day.payments"><td>{{payment.customer_name}}</td><td><span>{{payment.payment_type_name}}</span><span ng-show="payment.type == &#39;refund&#39;">Refund</span></td><td class="text-align-right" ng-class="{&#39;red&#39;: payment.type == &#39;refund&#39;}">{{payment.amount|currency}}</td><td>{{payment.reference}}</td><td>{{payment.invoice}}</td></tr></tbody></table></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("franchisor/reports/purchases.html",'<br /><div class="content-nav" ng-controller="ReportsNavController"><ul><li ng-class="{active: isActive(&#39;payments&#39;)}" ng-click="select_report(&#39;payments&#39;)"><a>Received Payments</a></li><li ng-class="{active: isActive(&#39;income&#39;)}" ng-click="select_report(&#39;income&#39;)"><a>Income</a></li><li ng-class="{active: isActive(&#39;sales&#39;)}" ng-click="select_report(&#39;sales&#39;)"><a>Sales</a></li><li ng-class="{active: isActive(&#39;purchases&#39;)}" ng-click="select_report(&#39;purchases&#39;)"><a>Purchases</a></li><li ng-class="{active: isActive(&#39;leads&#39;)}" ng-click="select_report(&#39;leads&#39;)"><a>Leads</a></li><li ng-class="{active: isActive(&#39;stock_values&#39;)}" ng-click="select_report(&#39;stock_values&#39;)"><a>Stock Values</a></li></ul></div><div class="row-fluid" ng-controller="PurchasesReportController"><div class="spinner" id="report-spinner"></div><div class="page-header">Purchase/Expense Report</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button></div></div><br /><div class="report report-pie" id="purchase-category-report"></div><label class="checkbox inline"><input ng-model="show_category_data" type="checkbox" /><span>Grouped by Categories</span></label><div class="inline" ng-show="showing_category" style="margin-left: 15px"><label class="label label-info">Showing {{showing_category.name}}</label><button class="btn btn-link" ng-click="close_category()">Summary</button></div><div class="content-box" ng-hide="show_category_data &amp;&amp; !showing_category"><table class="table table-striped"><thead><tr><th class="column sortable" ng-click="sort(&#39;stock_number&#39;)" style="min-width: 150px">Stock No#</th><th class="column-sortable" ng-click="sort(&#39;name&#39;)">Name </th><th>Buy Price</th><th>Average Buy Price</th><th class="column-sortable text-align-right" ng-click="sort(&#39;quantity&#39;)">Qty. </th><th class="column-sortable text-align-right" ng-click="sort(&#39;return&#39;)">Returned </th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_amount&#39;)" style="width: 150px">Subtotal</th><th class="text-align-right">{{tax_name()}}</th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_amount&#39;)" style="width: 150px">Total</th></tr></thead><tbody><tr class="goto" ng-click="open_item(item)" ng-repeat="item in item_list()"><td>{{item.stock_number}}</td><td>{{item.name}}</td><td>{{item.buy_price|currency}}</td><td>{{item.average_buy_price|currency}}</td><td class="text-align-right">{{item.quantity}}</td><td class="text-align-right">{{item.return}}</td><td class="text-align-right">{{item.total_net_amount|currency}}</td><td class="text-align-right">{{item.total_gst_amount|currency}}</td><td class="text-align-right">{{item.total_amount|currency}}</td></tr><tr ng-hide="showing_category"><td class="bold text-align-right" colspan="6">TOTAL:&nbsp;</td><td class="bold text-align-right">{{data.total_net_amount|currency}}</td><td class="bold text-align-right">{{data.total_gst_amount|currency}}</td><td class="bold text-align-right">{{data.total_amount|currency}}</td></tr><tr ng-show="showing_category"><td class="bold text-align-right" colspan="6">TOTAL:&nbsp;</td><td class="bold text-align-right">{{showing_category.total_net_amount|currency}}</td><td class="bold text-align-right">{{showing_category.total_gst_amount|currency}}</td><td class="bold text-align-right">{{showing_category.total_amount|currency}}</td></tr></tbody></table></div><div class="content-box" ng-show="show_category_data &amp;&amp; !showing_category"><table class="table table-striped"><thead><tr><th class="column-sortable" ng-click="sort_categories(&#39;name&#39;)" style="min-width: 150px">Category</th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;quantity&#39;)">Quantity </th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;return&#39;)">Return </th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;total_amount&#39;)" style="width: 150px">Subtotal</th><th class="text-align-right">{{tax_name()}}</th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;total_amount&#39;)" style="width: 150px">Total</th></tr></thead><tbody><tr class="goto" ng-click="open_category(item)" ng-repeat="item in categories" tooltip="click to show purchases of this category"><td>{{item.name}}</td><td class="text-align-right">{{item.quantity}}</td><td class="text-align-right">{{item.return}}</td><td class="text-align-right">{{item.total_net_amount|currency}}</td><td class="text-align-right">{{item.total_gst_amount|currency}}</td><td class="text-align-right">{{item.total_amount|currency}}</td></tr><tr><td class="bold text-align-right" colspan="3">TOTAL:&nbsp;</td><td class="bold text-align-right">{{data.total_net_amount|currency}}</td><td class="bold text-align-right">{{data.total_gst_amount|currency}}</td><td class="bold text-align-right">{{data.total_amount|currency}}</td></tr></tbody></table></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("franchisor/reports/reporting_period_selection.html",'<div class="form-inline"><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("franchisor/reports/sales.html",'<br /><div class="content-nav" ng-controller="ReportsNavController"><ul><li ng-class="{active: isActive(&#39;payments&#39;)}" ng-click="select_report(&#39;payments&#39;)"><a>Received Payments</a></li><li ng-class="{active: isActive(&#39;income&#39;)}" ng-click="select_report(&#39;income&#39;)"><a>Income</a></li><li ng-class="{active: isActive(&#39;sales&#39;)}" ng-click="select_report(&#39;sales&#39;)"><a>Sales</a></li><li ng-class="{active: isActive(&#39;purchases&#39;)}" ng-click="select_report(&#39;purchases&#39;)"><a>Purchases</a></li><li ng-class="{active: isActive(&#39;leads&#39;)}" ng-click="select_report(&#39;leads&#39;)"><a>Leads</a></li><li ng-class="{active: isActive(&#39;stock_values&#39;)}" ng-click="select_report(&#39;stock_values&#39;)"><a>Stock Values</a></li></ul></div><div class="row-fluid" ng-controller="SalesReportController"><div class="spinner" id="report-spinner"></div><div class="page-header">Sales Report</div><div class="row-fluid"><div class="pull-left"><label class="checkbox"><input ng-change="filter_report()" ng-model="include_unfinalized" type="checkbox" />Include Unfinalized Invoices</label></div><div class="pull-right search-form"><div class="inline"><div class="form-inline"><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button></div></div><br /><div class="report report-pie" id="sale-category-report"></div><label class="checkbox inline"><input ng-model="show_category_data" type="checkbox" /><span>Grouped by Categories</span></label><div class="inline" ng-show="showing_category" style="margin-left: 15px"><label class="label label-info">Showing {{showing_category.name}}</label><button class="btn btn-link" ng-click="close_category()">Summary</button></div><div class="content-box" ng-hide="show_category_data &amp;&amp; !showing_category"><div class="row-fluid"><table class="table table-striped"><thead><tr><th class="column-sortable" ng-click="sort(&#39;stock_number&#39;)" style="min-width: 150px">Stock No#</th><th class="column-sortable" ng-click="sort(&#39;name&#39;)">Name </th><th>Sell Price </th><th class="column-sortable text-align-right" ng-click="sort(&#39;quantity&#39;)">Qty. </th><th class="column-sortable text-align-right" ng-click="sort(&#39;return&#39;)">Returned </th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_amount&#39;)" style="width: 150px">Subtotal</th><th class="text-align-right">{{tax_name()}}</th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_amount&#39;)" style="width: 150px">Total</th><th class="column-sortable text-align-right" ng-click="sort(&#39;profit_margin&#39;)" style="width: 150px">Profit Margin</th><th class="text-align-right" style="width: 150px">Average Cost</th><th class="text-align-right" style="width: 150px">Average Sell</th><th class="text-align-right" style="width: 150px">Average Profit</th></tr></thead><tbody><tr class="goto" ng-click="open_item(item)" ng-repeat="item in item_list()"><td>{{item.stock_number}}</td><td>{{item.name}}</td><td>{{item.price|currency}}</td><td class="text-align-right">{{item.quantity}}</td><td class="text-align-right">{{item.return}}</td><td class="text-align-right">{{item.total_net_amount|currency}}</td><td class="text-align-right">{{item.total_gst_amount|currency}}</td><td class="text-align-right">{{item.total_amount|currency}}</td><td class="text-align-right">{{item.profit_margin|currency}}</td><td class="text-align-right">{{average_cost(item)|currency}}</td><td class="text-align-right">{{average_sell(item)|currency}}</td><td class="text-align-right">{{average_profit(item)|currency}}</td></tr><tr ng-hide="showing_category"><td class="bold text-align-right" colspan="5">TOTAL:&nbsp;</td><td class="bold text-align-right">{{data.total_net_amount|currency}}</td><td class="bold text-align-right">{{data.total_gst_amount|currency}}</td><td class="bold text-align-right">{{data.total_amount|currency}}</td><td class="bold text-align-right"><div>{{data.total_profit_margin|currency}}</div><div>{{data.profit_margin_percentage}}%</div></td><td></td><td></td><td></td></tr><tr ng-show="showing_category"><td class="bold text-align-right" colspan="5">TOTAL:&nbsp;</td><td class="bold text-align-right">{{showing_category.total_net_amount|currency}}</td><td class="bold text-align-right">{{showing_category.total_gst_amount|currency}}</td><td class="bold text-align-right">{{showing_category.total_amount|currency}}</td><td class="bold text-align-right"><div>{{showing_category.total_profit_margin|currency}}</div><div>{{showing_category.profit_margin_percentage|currency}}%</div></td><td></td><td></td><td></td></tr></tbody></table></div></div><div class="content-box" ng-show="show_category_data &amp;&amp; !showing_category"><div class="row-fluid"><table class="table table-striped"><thead><tr><th class="column-sortable" ng-click="sort_categories(&#39;name&#39;)" style="min-width: 150px">Category</th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;quantity&#39;)">Quantity </th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;return&#39;)">Return </th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;total_amount&#39;)" style="width: 150px">Subtotal</th><th class="text-align-right">{{tax_name()}}</th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;total_amount&#39;)" style="width: 150px">Total</th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;profit_margin&#39;)" style="width: 150px">Profit Margin</th><th class="text-align-right" style="width: 150px">Average Cost</th><th class="text-align-right" style="width: 150px">Average Sell</th><th class="text-align-right" style="width: 150px">Average Profit</th></tr></thead><tbody><tr class="goto" ng-click="open_category(item)" ng-repeat="item in categories" tooltip="click to show sales of this category"><td>{{item.name}}</td><td class="text-align-right">{{item.quantity}}</td><td class="text-align-right">{{item.return}}</td><td class="text-align-right">{{item.total_net_amount|currency}}</td><td class="text-align-right">{{item.total_gst_amount|currency}}</td><td class="text-align-right">{{item.total_amount|currency}}</td><td class="text-align-right">{{item.profit_margin|currency}}</td><td class="text-align-right">{{average_cost(item)|currency}}</td><td class="text-align-right">{{average_sell(item)|currency}}</td><td class="text-align-right">{{average_profit(item)|currency}}</td></tr><tr><td class="bold text-align-right" colspan="3">TOTAL:&nbsp;</td><td class="bold text-align-right">{{data.total_net_amount|currency}}</td><td class="bold text-align-right">{{data.total_gst_amount|currency}}</td><td class="bold text-align-right">{{data.total_amount|currency}}</td><td class="bold text-align-right"><div>{{data.total_profit_margin|currency}}</div><div>{{data.profit_margin_percentage|currency}}%</div></td><td></td><td></td><td></td></tr></tbody></table></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("franchisor/reports/stock_values.html",'<br /><div class="content-nav" ng-controller="ReportsNavController"><ul><li ng-class="{active: isActive(&#39;payments&#39;)}" ng-click="select_report(&#39;payments&#39;)"><a>Received Payments</a></li><li ng-class="{active: isActive(&#39;income&#39;)}" ng-click="select_report(&#39;income&#39;)"><a>Income</a></li><li ng-class="{active: isActive(&#39;sales&#39;)}" ng-click="select_report(&#39;sales&#39;)"><a>Sales</a></li><li ng-class="{active: isActive(&#39;purchases&#39;)}" ng-click="select_report(&#39;purchases&#39;)"><a>Purchases</a></li><li ng-class="{active: isActive(&#39;leads&#39;)}" ng-click="select_report(&#39;leads&#39;)"><a>Leads</a></li><li ng-class="{active: isActive(&#39;stock_values&#39;)}" ng-click="select_report(&#39;stock_values&#39;)"><a>Stock Values</a></li></ul></div><div class="row-fluid" ng-controller="StockValueReportController"><div class="page-header">Stock Value Report (Beta)</div><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="content-box"><div class="spinner" id="report-spinner"></div><div class="sub-header">Stock Value</div><div ng-show="data.length == 0"><span>No data available in this reporting period</span></div><div class="report report-pie" id="stock-value-report"></div></div><br /><div class="content-box"><div class="sub-header">Value By Category</div><table class="table table-striped"><thead><tr><th>Category</th><th>Value</th></tr></thead><tbody><tr class="goto" ng-click="goto_category(category)" ng-repeat="category in data.data"><td>{{category.label}}</td><td>{{category.data|currency}}</td></tr><tr><td class="bold text-align-right">TOTAL</td><td>{{data.total_value|currency}}</td></tr></tbody></table></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("franchisor/reports/tab.html",'<br /><div class="content-nav" ng-controller="ReportsNavController"><ul><li ng-class="{active: isActive(&#39;payments&#39;)}" ng-click="select_report(&#39;payments&#39;)"><a>Received Payments</a></li><li ng-class="{active: isActive(&#39;income&#39;)}" ng-click="select_report(&#39;income&#39;)"><a>Income</a></li><li ng-class="{active: isActive(&#39;sales&#39;)}" ng-click="select_report(&#39;sales&#39;)"><a>Sales</a></li><li ng-class="{active: isActive(&#39;purchases&#39;)}" ng-click="select_report(&#39;purchases&#39;)"><a>Purchases</a></li><li ng-class="{active: isActive(&#39;leads&#39;)}" ng-click="select_report(&#39;leads&#39;)"><a>Leads</a></li><li ng-class="{active: isActive(&#39;stock_values&#39;)}" ng-click="select_report(&#39;stock_values&#39;)"><a>Stock Values</a></li></ul></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("franchisor/vehicles.html",'<div ng-controller="VehiclesController"><div class="page-header"><span>{{asset_name_plural()}}</span><div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query" type="text" />&nbsp;<button class="btn btn-primary" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="search-description" ng-show="keyword">Search "{{query}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="row-fluid"><div class="spinner" id="vehicle-list-spinner"></div><div class="content-box"><table class="table table-striped"><thead><tr><th ng-show="asset_property_set().registration_number">Reg No#</th><th ng-show="asset_property_set().fleet_number">Fleet Number</th><th ng-show="asset_property_set().serial_number">Serial No#</th><th ng-show="asset_property_set().product_number">Product No#</th><th>Make</th><th>Model</th><th>Year</th><th>Owner Name</th><th>Phone</th><th>Last Job Date</th><th>Next Service</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/customers/&#39; + vehicle.customer.id + &#39;/vehicles/&#39; + vehicle.id)" ng-repeat="vehicle in vehicles"><td ng-show="asset_property_set().registration_number">{{vehicle.registration_number}}</td><td ng-show="asset_property_set().fleet_number">{{vehicle.fleet_number}}</td><td ng-show="asset_property_set().serial_number">{{vehicle.serial_number}}</td><td ng-show="asset_property_set().product_number">{{vehicle.product_number}}</td><td>{{vehicle.make}}</td><td>{{vehicle.model}}</td><td>{{vehicle.year}}</td><td>{{vehicle.customer.name}}</td><td>{{vehicle.customer.phone}}</td><td>{{vehicle.service_schedule.last_service_date|date:\'mediumDate\'}}</td><td>{{vehicle.service_schedule.next_service_date|date:\'mediumDate\'}}</td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("helps/index.html",'<div ng-controller="HelpsController"><div class="row-fluid"><div class="page-header"><span ng-hide="help || search_results.length &gt;= 0">Help</span><span ng-show="help">Help: {{help.title}}</span><span ng-show="search_results.length &gt;= 0">Search Helps: {{query}}</span></div></div><div class="row-fluid"><div class="column span7"><div ng-hide="help || search_results.length &gt;= 0"><p>If you have just signed up. Please take a moment to watch these tutorial videos:</p><div><a href="https://www.youtube.com/embed/pwF6Ph1FAOQ?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 1: Setting Up</a></div><div><a href="https://www.youtube.com/embed/NLaRN4hrHZc?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 1B: Advance Settings</a></div><div><a href="https://www.youtube.com/embed/gCbuy2SBQdM?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 1C: Adding employees or users</a></div><div><a href="https://www.youtube.com/embed/UQYpE5kIzmU?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 2: Create your first job</a></div><div><a href="https://www.youtube.com/embed/Bb_kC9KdWus?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 3: Working on a job</a></div><div><a href="https://www.youtube.com/embed/b1qKPbS1EzE?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 4: Finish your job, print or send invoice to customer</a></div><div><a href="https://www.youtube.com/embed/9dQ-520g1QI?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 5: Using Job Type: Job template to avoid repetitive data entry</a></div><div><a href="https://www.youtube.com/embed/RIQRX2ttz6o?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 6: Service Schedule and Service Reminder</a></div><div><a href="https://www.youtube.com/embed/mI5Ko7yj2uA?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 7: Employees, Job assignments and Workshop Diary</a></div><div><a href="https://www.youtube.com/embed/MDgKQ3uvYG0?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 8: Saving services and products as invoice items to avoid repetition </a></div><div><a href="https://www.youtube.com/embed/DXWeRzihtDA?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 9: Inventory, Adding stock item and setup stock level alert</a></div><div><a href="https://www.youtube.com/embed/DgFfvk5IT0E?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 10: Inventory, Pricing Level, Sale and Purchase Histories</a></div><div><a href="https://www.youtube.com/embed/N7tbhAkNtP4?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 11: Inventory, Stock-take</a></div><div><a href="https://www.youtube.com/embed/HRK-mFhhf40?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 12: Inventory, Purchase Orders</a></div><div><a href="https://www.youtube.com/embed/6_QGwgJSNKg?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 13: Managing Bill And Bill Payment</a></div><div><a href="https://www.youtube.com/embed/2juJ8U1D5fo?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 14: Data Export</a></div><div><a href="https://www.youtube.com/embed/Y35o_h-k_9g?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 15: Managing Customers And {{asset_name_plural()}}</a></div><div><a href="https://www.youtube.com/embed/pv8GAvds40E?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 16: Setup Xero Integration</a></div><div><a href="https://www.youtube.com/embed/np_eOaqfFlE?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 17: Xero Integration, Sync sales and purchases to specific accounts</a></div><div><a href="https://www.youtube.com/embed/32_EnMHqZ9I?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 18: Point Of Sale: Setup stock item barcode</a></div><div><a href="https://www.youtube.com/embed/yWfdub-FDQg?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 19: Point Of Sale: Using the Point Of Sale</a></div><div><a href="https://www.youtube.com/embed/pUowj2y_O4g?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 20A: Repco Navigator Pro Integration</a></div><div><a href="https://www.youtube.com/embed/jT9Vu5P1x7I?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 20B: Burson EzyParts Integration</a></div><div><a href="https://www.youtube.com/embed/-zmqByT_pwo?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 21: Bulk Customer Payment</a></div><div><a href="https://www.youtube.com/embed/dlKHmXK0ffs?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 22: Bulk Bill Payment</a></div><div><a href="https://www.youtube.com/embed/aRO9s1njsRE?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 23: Quick Invoicing</a></div><div><a href="https://www.youtube.com/embed/Pl0OVmtWEcI?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 24: Follow Up</a></div><div><a href="https://www.youtube.com/embed/oCOGPwxrujI?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 25: Tagging</a></div><div><a href="https://www.youtube.com/embed/xmWWNzUuAC4?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 26: Reports - Part 1</a></div><div><a href="https://www.youtube.com/embed/Oud8umz7E4w?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 28: Merging duplicated records</a></div><div><a href="https://www.youtube.com/embed/-2bvZYt_3ks?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 29: Control Employees\' Access Level</a></div><div><a href="https://www.youtube.com/embed/RzzJRSW3234?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 30: Tyro EFTPOS Machine Integration</a></div><div><a href="https://www.youtube.com/embed/8UFjFZgxdNI?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 31: CarJam Integration (For New Zealand customers only)</a></div><div><a href="https://www.youtube.com/embed/o5R7tJ7bhYY?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 32: Set up Online Booking</a></div><div><a href="https://www.youtube.com/embed/_E6rWJkbs6g?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 33: Courtesy Vehicle Management</a></div><div><a href="https://www.youtube.com/embed/vCtQk-jYJXY?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 34: Communication Templates</a></div><div><a href="https://www.youtube.com/embed/3wroG-GbRMM?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 35: Timesheet</a></div><div><a href="https://www.youtube.com/embed/5fKi9G4I6hc?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 36: Workstation</a></div><div><a href="https://www.youtube.com/embed/2Ld8ObMX5JY?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 37: Quotes</a></div><div><a href="https://www.youtube.com/embed/FRc8AxtcugQ?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 38: Saved Texts</a></div><div><a href="https://www.youtube.com/embed/6vspp0D_3F8?vq=hd1080&amp;autoplay=1" target="_blank">Tutorial 39: Price Groups</a></div></div></div><div class="column span5"><a class="btn btn-success bold" href="https://mechanicdesk.freshdesk.com/support/home" target="_blank">Online Manual</a><br /><br /><a href="http://appstore.com/mechanicdesk" target="_blank"><img src="/images/appstore.png" width="120px" /></a><a href="https://play.google.com/store/apps/details?id=org.nativescript.MechanicDeskApp" style="margin-left: 10px" target="_blank"><img src="/images/playstore.png" width="120px" /></a><br /><br /><div class="bold">Please Install Teamviewer if you have not done so, this will allow our support team members and you to be looking at the same screen while they provide online support</div><a href="https://www.teamviewer.com/en/download/"><img src="/images/teamviewer.jpeg" /></a><br /><br /><br /><div>Our support line numbers are</div><br><strong>Australia: 1300 737 100<br />New Zealand: 0800 110 259<br />United Kingdom: 0808 178 0486<br />Global: +61386400964</strong></br><div class="row-fluid"><br /><p>Please use the following form to send us a message. One of our support members will get back to you as soon as possible.</p><div ng-hide="sent"><textarea class="span12" ng-model="message" rows="10"></textarea><button class="btn btn-primary" ng-click="send_message()">Send</button><div id="spinner"></div></div><div ng-show="sent"><span class="bold">Your message has been sent. Please click</span><a ng-click="send_again()">&nbsp; here &nbsp;</a><span>if you want to send another message</span></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("helps/nav.html",'<ul class="nav nav-list side-nav help-nav"><li class="nav-header">Help Topics</li><li><a ng-click="home()">Home</a></li><span ng-repeat="area in structure"><li class="nav-header" ng-class="isActive(area)" style="background-color: #BBBBBB;"><a ng-click="show(area)">{{area.title}}</a><div class="pull-right"><i class="icon-folder-open-alt pointer" ng-click="close(area)" ng-show="!area.close &amp;&amp; area.children.length &gt; 0"></i><i class="icon-folder-close-alt pointer" ng-click="open(area)" ng-show="area.close &amp;&amp; area.children.length &gt; 0"></i></div></li><span ng-hide="area.close"><li ng-class="isActive(section)" ng-repeat="section in area.children"><a ng-click="show(section)">{{section.title}}</a></li></span></span></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("helps/search_results.html",'<div ng-show="search_results.length &gt;= 0"><div ng-show="search_results.length == 0"><div>Sorry no search result found for "{{query}}"</div></div><div ng-repeat="child in search_results"><h4 class="help-title">{{child.title}}</h4><ul class="breadcrumb help-path"><li>Path:&nbsp;</li><li ng-repeat="parent in child.parents"><a ng-click="show(parent)">{{parent.title}}</a><span class="divider">/</span></li><li class="active"><a>{{child.title}}</a></li></ul><div class="help-content">{{child.content}}<div ng-show="child.children.length &gt; 0"><a ng-click="show(child)">More</a></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/accounting/details.html",'<div class="sub-header">Accounting Software Integration</div><div ng-hide="editing"><div ng-hide="accounting_integration_account.id"><div ng-hide="creating_accounting_integration"><div class="row-fluid"><span>No Integration</span><div class="pull-right"><button class="btn btn-link" ng-click="edit_accounting_integration()">Start integration</button></div></div></div></div><div ng-show="accounting_integration_account.id"><div class="row-fluid"><div class="editable" ng-click="edit_accounting_integration()"><div><span class="label-name-left">{{accounting_integration_account.third_party}}</span><span class="green" ng-show="accounting_integration_account.enabled">(Enabled)</span><span class="red" ng-hide="accounting_integration_account.enabled">(Disabled)</span></div><div><span class="label-name-left">Sync method:</span><span>{{accounting_integration_account.sync_method}}</span></div><div ng-show="accounting_integration_account.third_party != &#39;Myob Essentials&#39;"><span class="label-name-left">Sync payments back to MechanicDesk:</span><span>{{accounting_integration_account.pull_payments|yes_no}}</span><span ng-show="accounting_integration_account.pull_payments">&nbsp; - &nbsp; (every 15 minutes during business hours)</span></div><div><span class="label-name-left">Sync start date:</span><span>{{accounting_integration_account.sync_start_date|date: \'mediumDate\'}}</span></div></div><div ng-show="accounting_integration_account.enabled &amp;&amp; (accounting_integration_account.third_party == &#39;Xero&#39; || accounting_integration_account.third_party == &#39;Myob Account Right Live&#39;)"><div class="pull-right"><button class="btn btn-link" id="show-instruction-button" ng-click="show_instruction()">Instruction</button></div></div></div></div><hr /><div class="row-fluid"><div class="editable" ng-click="edit_accounting_accounts()" ng-hide="editing_accounting_accounts"><div ng-show="accounting_integration_account.tracking_category_option_ids"><div class="sub-header">Tracking Category</div><div><span class="label-name-left auto-width">Tracking Category:</span><span> {{accounting_integration_account.tracking_category_options|comma_seperated: \'name\'}}</span></div><br /></div><div ng-show="accounting_integration_account &amp;&amp; !accounting_integration_account.accounts_confirmed"><br /><div class="label label-info"><div>Chart of accounts has not been confirmed.</div><div>Please click to select matching accounts and confirm.</div></div></div><br /><div class="sub-header">Accounts</div><br /><div class="bold">Sale Accounts</div><div><span class="label-name-left auto-width">Default Sale Account:</span><span ng-class="{red: !accounting_integration_account.invoice_account}">{{accounting_integration_account.invoice_account.title|na}}</span></div><div><span class="label-name-left auto-width">Part Sale Account:</span><span ng-class="{red: !accounting_integration_account.part_sale_account}">{{accounting_integration_account.part_sale_account.title|na}}</span></div><div><span class="label-name-left auto-width">Discount Account:</span><span ng-class="{red: !accounting_integration_account.discount_account}">{{accounting_integration_account.discount_account.title|na}}</span></div><hr /><div class="bold">Customer Payment Accounts</div><div><span class="label-name-left auto-width">Cash payment Account:</span><span ng-class="{red: !accounting_integration_account.cash_payment_account}">{{accounting_integration_account.cash_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bank Payment Account:</span><span ng-class="{red: !accounting_integration_account.bank_payment_account}"> {{accounting_integration_account.bank_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">EFTPOS Payment Account:</span><span ng-class="{red: !accounting_integration_account.eftpos_payment_account}"> {{accounting_integration_account.eftpos_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Credit Card Payment Account:</span><span ng-class="{red: !accounting_integration_account.credit_card_payment_account}"> {{accounting_integration_account.credit_card_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Cheque Payment Account:</span><span ng-class="{red: !accounting_integration_account.cheque_payment_account}"> {{accounting_integration_account.cheque_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Direct Debit Payment Account:</span><span ng-class="{red: !accounting_integration_account.direct_debit_payment_account}"> {{accounting_integration_account.direct_debit_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Paypal Payment Account:</span><span ng-class="{red: !accounting_integration_account.paypal_payment_account}"> {{accounting_integration_account.paypal_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Other Payment Account:</span><span ng-class="{red: !accounting_integration_account.other_payment_account}"> {{accounting_integration_account.other_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Customer Credit Account:</span><span ng-class="{red: !accounting_integration_account.customer_credit_account}">{{accounting_integration_account.customer_credit_account.title|na}}</span></div><hr /><div class="bold">Purchase Accounts</div><div><span class="label-name-left auto-width">Default Purchase Account:</span><span ng-class="{red: !accounting_integration_account.bill_account}">{{accounting_integration_account.bill_account.title|na}}</span></div><div ng-hide="accounting_integration_account.third_party == &#39;Myob Essentials&#39;"><div><span class="label-name-left auto-width">Part Purchase Account:</span><span ng-class="{red: !accounting_integration_account.part_purchase_account}">{{accounting_integration_account.part_purchase_account.title|na}}</span></div><hr /><div class="bold">Bill Payment Accounts</div><div><span class="label-name-left auto-width">Bill Cash Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_cash_payment_account}">{{accounting_integration_account.bill_cash_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill Bank Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_payment_account}">{{accounting_integration_account.bill_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill Credit Card Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_credit_card_payment_account}">{{accounting_integration_account.bill_credit_card_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill EFTPOS Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_eftpos_payment_account}">{{accounting_integration_account.bill_eftpos_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill Cheque Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_cheque_payment_account}">{{accounting_integration_account.bill_cheque_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill Direct Debit Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_direct_debit_payment_account}">{{accounting_integration_account.bill_direct_debit_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill Paypal Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_paypal_payment_account}">{{accounting_integration_account.bill_paypal_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill Other Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_other_payment_account}">{{accounting_integration_account.bill_other_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Supplier Credit Account:</span><span ng-class="{red: !accounting_integration_account.supplier_credit_account}">{{accounting_integration_account.supplier_credit_account.title|na}}</span></div><br /><div class="sub-header">Tax Codes</div><div ng-hide="not_registered_for_gst"><div><span class="label-name-left auto-width">Invoice {{tax_name()}}:</span><span>{{tax_code_name(accounting_integration_account.invoice_gst_tax_type)}}</span></div><div><span class="label-name-left auto-width">Invoice {{tax_name()}} Free:</span><span>{{tax_code_name(accounting_integration_account.invoice_gst_free_tax_type)}}</span></div></div><div ng-show="not_registered_for_gst"><div><span class="label-name-left auto-width">Invoice Tax Code:</span><span>{{tax_code_name(accounting_integration_account.invoice_no_gst_tax_type)}}</span></div></div><div><span class="label-name-left auto-width">Bill {{tax_name()}}:</span><span>{{tax_code_name(accounting_integration_account.bill_gst_tax_type)}}</span></div><div><span class="label-name-left auto-width">Bill {{tax_name()}} Free:</span><span>{{tax_code_name(accounting_integration_account.bill_gst_free_tax_type)}}</span></div><div ng-show="accounting_integration_account.third_party == &#39;Quickbooks&#39;"><br /><div class="sub-header">Tax Rates</div><div ng-hide="not_registered_for_gst"><div><span class="label-name-left auto-width">Invoice {{tax_name()}} Tax Rate:</span><span>{{accounting_integration_account.invoice_gst_tax_rate}}</span></div><div><span class="label-name-left auto-width">Invoice {{tax_name()}} Free Tax Rate:</span><span>{{accounting_integration_account.invoice_gst_free_tax_type}}</span></div></div><div ng-show="not_registered_for_gst"><div><span class="label-name-left auto-width">Invoice Tax Rate:</span><span>{{tax_code_name(accounting_integration_account.invoice_gst_free_tax_rate)}}</span></div></div><div><span class="label-name-left auto-width">Bill {{tax_name()}} Tax Rate:</span><span>{{accounting_integration_account.bill_gst_tax_rate}}</span></div><div><span class="label-name-left auto-width">Bill {{tax_name()}} Free Tax Rate:</span><span>{{accounting_integration_account.bill_gst_free_tax_rate}}</span></div></div></div></div><div class="editing-item" ng-show="editing_accounting_accounts"><form class="form-horizontal"><div ng-show="accounting_integration_account.tracking_categories.length &gt; 0"><div class="sub-header">Tracking Category</div><hr /><div class="control-group"><label class="control-label">Default Tracking Category</label><div class="controls"><div ng-repeat="tracking_category in editing_accounting_accounts.tracking_categories"><div>{{tracking_category.name}}</div><select ng-model="tracking_category.selected_option_id" ng-options="option.id as option.name for option in tracking_category.options"></select><br /><br /></div></div></div><hr /><div class="control-group"><label class="control-label">Enable Tracking Category Selection On Documents</label><div class="controls"><input class="checkbox" ng-model="editing_accounting_accounts.enable_tracking_category_selection" type="checkbox" /></div></div></div><div class="sub-header">Accounts</div><hr /><div class="bold">Sale Accounts</div><br /><div class="control-group"><label class="control-label">Default Sale</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_account_id" ng-options="account.id as account.title for account in output_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Part Sale</label><div class="controls"><select ng-model="editing_accounting_accounts.part_sale_account_id" ng-options="account.id as account.title for account in output_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Discount Account</label><div class="controls"><select ng-model="editing_accounting_accounts.discount_account_id" ng-options="account.id as account.title for account in output_input_accounts()"><option value=""></option></select></div></div><hr /><div class="bold">Payment Accounts</div><br /><div class="control-group"><label class="control-label">Cash Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.cash_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Bank Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bank_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">EFTPOS Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.eftpos_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Credit Card Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.credit_card_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Cheque Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.cheque_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Direct Debit Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.direct_debit_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Paypal Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.paypal_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Other Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.other_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Credit</label><div class="controls"><select ng-model="editing_accounting_accounts.customer_credit_account_id" ng-options="account.id as account.title for account in output_accounts()"><option value=""></option></select></div></div><hr /><div class="bold">Purchase Accounts</div><br /><div class="control-group"><label class="control-label">Default Purchase</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_account_id" ng-options="account.id as account.title for account in input_accounts()"><option value=""></option></select></div></div><div ng-hide="accounting_integration_account.third_party == &#39;Myob Essentials&#39;"><div class="control-group"><label class="control-label">Part Purchase</label><div class="controls"><select ng-model="editing_accounting_accounts.part_purchase_account_id" ng-options="account.id as account.title for account in input_accounts()"><option value=""></option></select></div></div><hr /><div class="bold">Bill Payment Accounts</div><br /><div class="control-group"><label class="control-label">Cash Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_cash_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Bank Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">EFTPOS Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_eftpos_payment_account_id" ng-options="account.id as account.title for account in bank_accounts()"></select></div></div><div class="control-group"><label class="control-label">Credit Card Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_credit_card_payment_account_id" ng-options="account.id as account.title for account in bank_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Cheque Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_cheque_payment_account_id" ng-options="account.id as account.title for account in bank_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Direct Debit Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_direct_debit_payment_account_id" ng-options="account.id as account.title for account in bank_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Paypal Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_paypal_payment_account_id" ng-options="account.id as account.title for account in bank_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Other Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_other_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Supplier Credit</label><div class="controls"><select ng-model="editing_accounting_accounts.supplier_credit_account_id" ng-options="account.id as account.title for account in input_accounts()"><option value=""></option></select></div></div><br /><div class="sub-header">Tax Codes</div><div ng-hide="not_registered_for_gst"><div class="control-group"><label class="control-label">Invoice {{tax_name()}}</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_gst_tax_type" ng-options="tax_type.tax_type as tax_type.name for tax_type in tax_types()"></select></div></div><div class="control-group"><label class="control-label">Invoice {{tax_name()}} Free</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_gst_free_tax_type" ng-options="tax_type.tax_type as tax_type.name for tax_type in tax_types()"></select></div></div></div><div ng-show="not_registered_for_gst"><div class="control-group"><label class="control-label">Invoice Tax Code</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_no_gst_tax_type" ng-options="tax_type.tax_type as tax_type.name for tax_type in tax_types()"></select></div></div></div><div class="control-group"><label class="control-label">Bill {{tax_name()}}</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_gst_tax_type" ng-options="tax_type.tax_type as tax_type.name for tax_type in tax_types()"></select></div></div><div class="control-group"><label class="control-label">Bill {{tax_name()}} Free</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_gst_free_tax_type" ng-options="tax_type.tax_type as tax_type.name for tax_type in tax_types()"></select></div></div><div ng-show="accounting_integration_account.third_party == &#39;Quickbooks&#39;"><br /><div class="sub-header">Tax Rates</div><div ng-hide="not_registered_for_gst"><div class="control-group"><label class="control-label">Invoice {{tax_name()}} Tax Rate</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_gst_tax_rate" ng-options="tax_rate.name as tax_rate.name for tax_rate in tax_rates()"></select></div></div><div class="control-group"><label class="control-label">Invoice {{tax_name()}} Free</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_gst_free_tax_rate" ng-options="tax_rate.name as tax_rate.name for tax_rate in tax_rates()"></select></div></div></div><div ng-show="not_registered_for_gst"><div class="control-group"><label class="control-label">Invoice Tax Code</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_gst_free_tax_rate" ng-options="tax_rate.name as tax_rate.name for tax_rate in tax_rates()"></select></div></div></div><div class="control-group"><label class="control-label">Bill {{tax_name()}} Tax Rate</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_gst_tax_rate" ng-options="tax_rate.name as tax_rate.name for tax_rate in tax_rates()"></select></div></div><div class="control-group"><label class="control-label">Bill {{tax_name()}} Free Tax Rate</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_gst_free_tax_rate" ng-options="tax_rate.name as tax_rate.name for tax_rate in tax_rates()"></select></div></div></div></div><div class="control-group"><label></label><div class="controls actions"><button class="btn btn-primary" ng-click="save_accounting_accounts()">Save</button><button class="btn" ng-click="cancel_edit_accounting_accounts()">Cancel</button></div></div></form></div></div></div><div class="editing-item" ng-show="editing"><form class="form-horizontal"><div class="control-group" ng-hide="editing_accounting_integration_account.id &amp;&amp; editing_accounting_integration_account.third_party"><label class="control-label">Third Party Software</label><div class="controls"><select ng-model="editing_accounting_integration_account.third_party"><option value="Xero">Xero</option><option value="Myob Essentials">MYOB Essentials</option><option value="Myob Account Right Live">MYOB Account Right Live</option><option value="Quickbooks">Quickbooks Online</option><option value="Quickbooks-US">Quickbooks Online (US Version)</option></select></div></div><div class="control-group"><label class="control-label">Enabled</label><div class="controls"><input class="checkbox" ng-model="editing_accounting_integration_account.enabled" type="checkbox" value="true" /></div></div><div class="control-group"><label class="control-label">Sync method</label><div class="controls"><select ng-model="editing_accounting_integration_account.sync_method" type="text"><option value="manual">Manual</option><option value="live">Live</option></select></div></div><div class="control-group" ng-hide="editing_accounting_integration_account.third_party == &#39;Myob Essentials&#39;"><label class="control-label">Sync payments back to MechanicDesk</label><div class="controls"><input class="checkbox" ng-model="editing_accounting_integration_account.pull_payments" type="checkbox" value="true" /></div></div><div class="control-group" ng-show="editing_accounting_integration_account.third_party == &#39;Xero&#39;"><label class="control-label">Skip syncing stocks</label><div class="controls"><input class="checkbox" ng-model="editing_accounting_integration_account.disable_stock_sync" type="checkbox" value="true" /></div></div><div class="control-group"><label class="control-label">Sync Start Date</label><div class="controls"><ad_datepicker ng-model="editing_accounting_integration_account.sync_start_date"></ad_datepicker></div></div><div ng-show="accounting_integration_account.id &amp;&amp; accounting_integration_account.third_party == &#39;Myob Account Right Live&#39;"><div class="control-group"><label class="control-label">Username</label><div class="controls"><input class="input" ng-model="editing_accounting_integration_account.username" type="text" /></div></div><div class="control-group"><label class="control-label">Password</label><div class="controls"><input class="input" ng-model="editing_accounting_integration_account.password" type="password" /></div></div></div><div class="control-group"><label></label><div class="controls"><button class="btn btn-success" ng-click="save_accounting_integration_account()">Save</button><button class="btn" ng-click="cancel_edit_accounting_integration()">Cancel</button></div></div></form></div><div id="instruction-popover"><div class="popover fade bottom in" style="width: 98%"><div class="popover-title"><div class="sub-header"><span>How does it works?</span><div class="pull-right"><button class="btn btn-primary" ng-click="hide_instruction()"><i class="icon icon-remove"></i><span>Close</span></button></div></div></div><div class="popover-content"><div class="content-box"><div ng-show="accounting_integration_account.third_party == &#39;Xero&#39;"><h3>What resources are synced?</h3><div><div>The following resources are synced with Xero</div><table class="table table-striped"><thead><tr><th style="min-width: 200px">Resource</th><th style="min-width: 200px">Sync Direction</th><th>Sync Condition</th></tr></thead><tbody><tr><td class="bold">Chart of accounts</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-left"></i></span><span>Xero</span></td><td>Whenever an account is changed in Xero</td></tr><tr><td class="bold">Suppliers</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td>Whenever a supplier is changed in MechanicDesk or Xero</td></tr><tr><td class="bold">Customers</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td>Whenever a customer is changed in MechanicDesk or Xero</td></tr><tr><td class="bold">Stocks</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td>Whenever a stock is changed in MechanicDesk or Xero</td></tr><tr><td class="bold">Invoices</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>Xero</span></td><td><span>When the invoice is </span> <span class="label label-success">finalized</span><span>. Any change to the invoice after that will not be synced.</span></td></tr><tr><td class="bold">Credit Notes</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>Xero</span></td><td><span>When the credit note is </span> <span class="label label-success">finalized</span><span>. Any change to the credit note after that will not be synced.</span></td></tr><tr><td class="bold">Invoice payments</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td><span>When the invoice is</span> <span class="label label-success">finalized</span> <span>. If the payment is a part of a bulk payment. It is only synced when the bulk payment\'s allocations are</span> <span class="label label-success">finalized</span></td></tr><tr><td class="bold">Bills</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>Xero</span></td><td><span>When the bill is</span> <span class="label label-success">finalized.</span> <span>Any change to the bill after that will not be synced.</span></td></tr><tr><td class="bold">Supplier Credit Notes</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>Xero</span></td><td><span>When the supplier credit note is</span> <span class="label label-success">finalized.</span> <span>Any change to the supplier credit note after that will not be synced.</span></td></tr><tr><td class="bold">Bill payments</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td><span>When the bill is</span> <span class="label label-success">finalized</span><span>. If the bill payment is a part of a bulk payment, It is only synced when the bulk payment\'s allocations are</span> <span class="label label-success">finalized</span></td></tr></tbody></table></div><h3>Setup Xero Integration</h3><h5 class="bold">Step 1: Sign up with Xero</h5><p><span>You need a Xero account to sync to, so if you do not have one, please go to &nbsp;</span><a href="https://www.xero.com?xtid=x30mechanicdesk" target="_blank">www.xero.com</a><span>&nbsp; to sign up.</span></p><br /><br /><h5 class="bold">Step 2: Make sure you do not use Xero\'s "Demo Company"</h5><p>When you sign up with Xero, your account will have a "Demo Company" organisation with some sample data for you to play with. Unless your MechanicDesk account\'s data is disposable, do not sync MechanicDesk with "Demo Company", otherwise the sample data will be synced from Xero back to MechanicDesk and polutes your MechanicDesk data.</p><br /><br /><h5 class="bold">Step 3: Initialze Xero integration from MechanicDesk</h5><ul><li>Click on "Sync" button on the right hand side. A popup window will open, you will be redirected to a Xero page which requests your permission to give MechanicDesk access to your Xero account.</li><li>Choose the organisation you want to sync with MechanicDesk and click on "Authorize"</li><li>The sync process is now started</li></ul><p>On the first sync request, MechanicDesk will sync the following resources</p><ol><li>Chart of accounts</li><li>Suppliers</li><li>Customers</li><li>Stocks</li></ol><p><span class="bold">Please Note:</span> <span>If you have a lot of stocks in MechanicDesk, the sync process can take a while so please be patient.</span></p><img src="/assets/help/xero_integration.sync.png" /><img src="/assets/help/xero_integration.xero_authorisation.png" /><br /><br /><br /><br /><h5 class="bold">Step 4: Confirm your accounts</h5><p>After the first sync request is finished. You will need to set up your accounting accounts with invoices, different payment types, bills and bill payments. MechanicDesk automatically detects the accounts and selects sensible default values for you. However you will need to have a look at your accounts, make any change neccessary and confirm your selections.</p><img src="/assets/help/xero_integration.confirm_accounts.png" /><img src="/assets/help/xero_integration.accounts_confirmation.png" /><br /><br /><br /><br /><h5 class="bold">Step 5: Start the sync again</h5><p>After you have confirmed the accounting accounts. You can click on the "Sync" button to start the sync process again. This time, as the accounting accounts have been confirmed, invoices, payments, bills and bill payments will be synced.</p></div><div ng-show="accounting_integration_account.third_party == &#39;Myob Account Right Live&#39;"><h3>What resources are synced?</h3><div><div>The following resources are synced with MYOB Account Right Live</div><table class="table table-striped"><thead><tr><th style="min-width: 200px">Resource</th><th style="min-width: 200px">Sync Direction</th><th>Sync Condition</th></tr></thead><tbody><tr><td class="bold">Chart of accounts</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-left"></i></span><span>MYOB</span></td><td>Once an account is created in MYOB</td></tr><tr><td class="bold">Suppliers</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td>Whenever a supplier is changed in MechanicDesk or MYOB</td></tr><tr><td class="bold">Customers</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td>Whenever a customer is changed in MechanicDesk or MYOB</td></tr><tr><td class="bold">Stocks</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td>Whenever a stock is changed in MechanicDesk or MYOB</td></tr><tr><td class="bold">Invoices</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>MYOB</span></td><td><span>When the invoice is </span> <span class="label label-success">finalized</span><span>. Any change to the invoice after that will not be synced.</span></td></tr><tr><td class="bold">Invoice payments</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td><span>When the invoice is</span> <span class="label label-success">finalized</span> <span>. If the payment is a part of a bulk payment. It is only synced when the bulk payment\'s allocations are</span> <span class="label label-success">finalized</span></td></tr><tr><td class="bold">Bills</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>MYOB</span></td><td><span>When the bill is</span> <span class="label label-success">finalized.</span> <span>Any change to the bill after that will not be synced.</span></td></tr><tr><td class="bold">Bill payments</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td><span>When the bill is</span> <span class="label label-success">finalized</span><span>. If the bill payment is a part of a bulk payment, It is only synced when the bulk payment\'s allocations are</span> <span class="label label-success">finalized</span></td></tr></tbody></table></div><h3>Setup MYOB Integration</h3><h5 class="bold">Step 1: Sign up with MYOB Account Right Live</h5><p><span>You need a MYOB Account Right Live account to sync to, so if you do not have one, please go to &nbsp;</span><a href="http://myob.com.au/products/small-business/accounting-software/myob-accountright-1422735752948" target="_blank">www.myob.com.au</a><span>&nbsp; to sign up.</span></p><br /><br /><h5 class="bold">Step 2: Initialze MYOB integration from MechanicDesk</h5><ul><li><div>Click on "Sync", Then Chose "Full Sync" button on the right hand side. A popup window will open, you will be redirected to a MYOB page which requests your permission to give MechanicDesk access to your MYOB account.</div><div><span class="bold">Note: </span> <span>Make sure you allow popup window from www.mechanicdesk.com.au for your browser</span></div><br /></li><li><div>Authorize MechanicDesk to sync with your MYOB Account Right Live account</div><br /></li><li><div>Chose your company file to integrate with MechanicDesk</div><br /></li><li><div>Enter the Username and Password to sync</div><div><span class="bold">Note:</span> <span class="bold">This Username and Password is NOT the one you sign in online but the one you need to access the company file online. The default would be Username: Administrator without any password. If you are not sure please follow this &nbsp;</span> <a href="http://help.myob.com/wiki/display/ar/Open+a+company+file" target="_balank">Link</a><span>&nbsp; for instructions</span></div><br /></li><li><div>The sync process is now started</div><br /></li></ul><p>On the first sync request, MechanicDesk will sync the following resources</p><ol><li><div>Chart of accounts</div><br /></li></ol><img src="/assets/help/myob_start_sync.png" /><img src="/assets/help/myob_authorization.png" /><img src="/assets/help/myob_select_company_name.png" /><br /><br /><br /><br /><h5 class="bold">Step 3: Confirm your accounts</h5><p>After the first sync request is finished. You will need to set up your accounting accounts with invoices, different payment types, bills and bill payments. MechanicDesk automatically detects the accounts and selects sensible default values for you. However you will need to have a look at your accounts, make any change neccessary and confirm your selections.</p><img src="/assets/help/myob_integration.confirm_accounts.png" /><img src="/assets/help/myob_integration.accounts_confirmation.png" /><br /><br /><br /><br /><h5 class="bold">Step 4: Start the sync again</h5><p>After you have confirmed the accounting accounts. You can click on the "Sync" button to start the sync process again. This time, as the accounting accounts have been confirmed, customers, suppliers, stocks, invoices, payments, bills and bill payments will be synced.</p></div><br /><br /><br /><div class="row-fluid"><button class="btn btn-primary span12" ng-click="hide_instruction()">Close</button></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/accounting/index.html",'<div ng-controller="AccountingIntegrationController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="hide" id="show-instruction-anchor" style="margin: auto"></div><div class="row-fluid"><div class="column span2"><ul class="nav nav-list side-nav" ng-controller="IntegrationsNavController"><li class="{{isActive(&#39;Accounting Integration&#39;)}}"><a href="#/integrations/accounting">Accounting Integration</a></li><li class="{{isActive(&#39;Supplier Integration&#39;)}}"><a href="#/integrations/supplier">Supplier Integration</a></li><li class="{{isActive(&#39;Marketing Integration&#39;)}}"><a href="#/integrations/marketing">Marketing Integration</a></li><li class="{{isActive(&#39;EFTPOS Integration&#39;)}}"><a href="#/integrations/eftpos">EFTPOS Integration</a></li><li class="{{isActive(&#39;Vehicle Look Up Integration&#39;)}}"><a href="#/integrations/vehiclelookup">Vehicle Look Up Integration</a></li><li class="{{isActive(&#39;Trade Memberships&#39;)}}"><a href="#/integrations/royalty">Royalty Program Integrations</a></li><li class="{{isActive(&#39;Vehicle Visual&#39;)}}"><a href="#/integrations/vehicle_visual">Vehicle Visual Integration</a></li></ul></div><div class="column span10"><div class="row-fluid"><div class="page-header"><span>Accounting Integration</span></div></div><div class="row-fluid" ng-show="accounting_integration_account.id"><div class="pull-right"><div class="btn-group" ng-show="accounting_integration_account.enabled &amp;&amp; current_sync_requests.length == 0"><a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon icon-refresh"></i> <span>Sync</span> <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="javascript:void(0)" ng-click="accounting_integration_sync()">Quick Sync</a></li><li><a href="javascript:void(0)" ng-click="accounting_integration_full_sync()">Full Sync</a></li></ul></div><button class="btn" ng-click="unauthorize()" ng-show="accounting_integration_account.authorized"><span>Unauthorize</span></button><div class="spinner" id="sync-request-spinner"></div></div></div><br /><div class="row-fluid"><div class="span6"><div class="content-box"><div class="sub-header">Accounting Software Integration</div><div ng-hide="editing"><div ng-hide="accounting_integration_account.id"><div ng-hide="creating_accounting_integration"><div class="row-fluid"><span>No Integration</span><div class="pull-right"><button class="btn btn-link" ng-click="edit_accounting_integration()">Start integration</button></div></div></div></div><div ng-show="accounting_integration_account.id"><div class="row-fluid"><div class="editable" ng-click="edit_accounting_integration()"><div><span class="label-name-left">{{accounting_integration_account.third_party}}</span><span class="green" ng-show="accounting_integration_account.enabled">(Enabled)</span><span class="red" ng-hide="accounting_integration_account.enabled">(Disabled)</span></div><div><span class="label-name-left">Sync method:</span><span>{{accounting_integration_account.sync_method}}</span></div><div ng-show="accounting_integration_account.third_party != &#39;Myob Essentials&#39;"><span class="label-name-left">Sync payments back to MechanicDesk:</span><span>{{accounting_integration_account.pull_payments|yes_no}}</span><span ng-show="accounting_integration_account.pull_payments">&nbsp; - &nbsp; (every 15 minutes during business hours)</span></div><div><span class="label-name-left">Sync start date:</span><span>{{accounting_integration_account.sync_start_date|date: \'mediumDate\'}}</span></div></div><div ng-show="accounting_integration_account.enabled &amp;&amp; (accounting_integration_account.third_party == &#39;Xero&#39; || accounting_integration_account.third_party == &#39;Myob Account Right Live&#39;)"><div class="pull-right"><button class="btn btn-link" id="show-instruction-button" ng-click="show_instruction()">Instruction</button></div></div></div></div><hr /><div class="row-fluid"><div class="editable" ng-click="edit_accounting_accounts()" ng-hide="editing_accounting_accounts"><div ng-show="accounting_integration_account.tracking_category_option_ids"><div class="sub-header">Tracking Category</div><div><span class="label-name-left auto-width">Tracking Category:</span><span> {{accounting_integration_account.tracking_category_options|comma_seperated: \'name\'}}</span></div><br /></div><div ng-show="accounting_integration_account &amp;&amp; !accounting_integration_account.accounts_confirmed"><br /><div class="label label-info"><div>Chart of accounts has not been confirmed.</div><div>Please click to select matching accounts and confirm.</div></div></div><br /><div class="sub-header">Accounts</div><br /><div class="bold">Sale Accounts</div><div><span class="label-name-left auto-width">Default Sale Account:</span><span ng-class="{red: !accounting_integration_account.invoice_account}">{{accounting_integration_account.invoice_account.title|na}}</span></div><div><span class="label-name-left auto-width">Part Sale Account:</span><span ng-class="{red: !accounting_integration_account.part_sale_account}">{{accounting_integration_account.part_sale_account.title|na}}</span></div><div><span class="label-name-left auto-width">Discount Account:</span><span ng-class="{red: !accounting_integration_account.discount_account}">{{accounting_integration_account.discount_account.title|na}}</span></div><hr /><div class="bold">Customer Payment Accounts</div><div><span class="label-name-left auto-width">Cash payment Account:</span><span ng-class="{red: !accounting_integration_account.cash_payment_account}">{{accounting_integration_account.cash_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bank Payment Account:</span><span ng-class="{red: !accounting_integration_account.bank_payment_account}"> {{accounting_integration_account.bank_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">EFTPOS Payment Account:</span><span ng-class="{red: !accounting_integration_account.eftpos_payment_account}"> {{accounting_integration_account.eftpos_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Credit Card Payment Account:</span><span ng-class="{red: !accounting_integration_account.credit_card_payment_account}"> {{accounting_integration_account.credit_card_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Cheque Payment Account:</span><span ng-class="{red: !accounting_integration_account.cheque_payment_account}"> {{accounting_integration_account.cheque_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Direct Debit Payment Account:</span><span ng-class="{red: !accounting_integration_account.direct_debit_payment_account}"> {{accounting_integration_account.direct_debit_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Paypal Payment Account:</span><span ng-class="{red: !accounting_integration_account.paypal_payment_account}"> {{accounting_integration_account.paypal_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Other Payment Account:</span><span ng-class="{red: !accounting_integration_account.other_payment_account}"> {{accounting_integration_account.other_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Customer Credit Account:</span><span ng-class="{red: !accounting_integration_account.customer_credit_account}">{{accounting_integration_account.customer_credit_account.title|na}}</span></div><hr /><div class="bold">Purchase Accounts</div><div><span class="label-name-left auto-width">Default Purchase Account:</span><span ng-class="{red: !accounting_integration_account.bill_account}">{{accounting_integration_account.bill_account.title|na}}</span></div><div ng-hide="accounting_integration_account.third_party == &#39;Myob Essentials&#39;"><div><span class="label-name-left auto-width">Part Purchase Account:</span><span ng-class="{red: !accounting_integration_account.part_purchase_account}">{{accounting_integration_account.part_purchase_account.title|na}}</span></div><hr /><div class="bold">Bill Payment Accounts</div><div><span class="label-name-left auto-width">Bill Cash Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_cash_payment_account}">{{accounting_integration_account.bill_cash_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill Bank Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_payment_account}">{{accounting_integration_account.bill_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill Credit Card Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_credit_card_payment_account}">{{accounting_integration_account.bill_credit_card_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill EFTPOS Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_eftpos_payment_account}">{{accounting_integration_account.bill_eftpos_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill Cheque Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_cheque_payment_account}">{{accounting_integration_account.bill_cheque_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill Direct Debit Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_direct_debit_payment_account}">{{accounting_integration_account.bill_direct_debit_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill Paypal Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_paypal_payment_account}">{{accounting_integration_account.bill_paypal_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Bill Other Payment Account:</span><span ng-class="{red: !accounting_integration_account.bill_other_payment_account}">{{accounting_integration_account.bill_other_payment_account.title|na}}</span></div><div><span class="label-name-left auto-width">Supplier Credit Account:</span><span ng-class="{red: !accounting_integration_account.supplier_credit_account}">{{accounting_integration_account.supplier_credit_account.title|na}}</span></div><br /><div class="sub-header">Tax Codes</div><div ng-hide="not_registered_for_gst"><div><span class="label-name-left auto-width">Invoice {{tax_name()}}:</span><span>{{tax_code_name(accounting_integration_account.invoice_gst_tax_type)}}</span></div><div><span class="label-name-left auto-width">Invoice {{tax_name()}} Free:</span><span>{{tax_code_name(accounting_integration_account.invoice_gst_free_tax_type)}}</span></div></div><div ng-show="not_registered_for_gst"><div><span class="label-name-left auto-width">Invoice Tax Code:</span><span>{{tax_code_name(accounting_integration_account.invoice_no_gst_tax_type)}}</span></div></div><div><span class="label-name-left auto-width">Bill {{tax_name()}}:</span><span>{{tax_code_name(accounting_integration_account.bill_gst_tax_type)}}</span></div><div><span class="label-name-left auto-width">Bill {{tax_name()}} Free:</span><span>{{tax_code_name(accounting_integration_account.bill_gst_free_tax_type)}}</span></div><div ng-show="accounting_integration_account.third_party == &#39;Quickbooks&#39;"><br /><div class="sub-header">Tax Rates</div><div ng-hide="not_registered_for_gst"><div><span class="label-name-left auto-width">Invoice {{tax_name()}} Tax Rate:</span><span>{{accounting_integration_account.invoice_gst_tax_rate}}</span></div><div><span class="label-name-left auto-width">Invoice {{tax_name()}} Free Tax Rate:</span><span>{{accounting_integration_account.invoice_gst_free_tax_type}}</span></div></div><div ng-show="not_registered_for_gst"><div><span class="label-name-left auto-width">Invoice Tax Rate:</span><span>{{tax_code_name(accounting_integration_account.invoice_gst_free_tax_rate)}}</span></div></div><div><span class="label-name-left auto-width">Bill {{tax_name()}} Tax Rate:</span><span>{{accounting_integration_account.bill_gst_tax_rate}}</span></div><div><span class="label-name-left auto-width">Bill {{tax_name()}} Free Tax Rate:</span><span>{{accounting_integration_account.bill_gst_free_tax_rate}}</span></div></div></div></div><div class="editing-item" ng-show="editing_accounting_accounts"><form class="form-horizontal"><div ng-show="accounting_integration_account.tracking_categories.length &gt; 0"><div class="sub-header">Tracking Category</div><hr /><div class="control-group"><label class="control-label">Default Tracking Category</label><div class="controls"><div ng-repeat="tracking_category in editing_accounting_accounts.tracking_categories"><div>{{tracking_category.name}}</div><select ng-model="tracking_category.selected_option_id" ng-options="option.id as option.name for option in tracking_category.options"></select><br /><br /></div></div></div><hr /><div class="control-group"><label class="control-label">Enable Tracking Category Selection On Documents</label><div class="controls"><input class="checkbox" ng-model="editing_accounting_accounts.enable_tracking_category_selection" type="checkbox" /></div></div></div><div class="sub-header">Accounts</div><hr /><div class="bold">Sale Accounts</div><br /><div class="control-group"><label class="control-label">Default Sale</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_account_id" ng-options="account.id as account.title for account in output_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Part Sale</label><div class="controls"><select ng-model="editing_accounting_accounts.part_sale_account_id" ng-options="account.id as account.title for account in output_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Discount Account</label><div class="controls"><select ng-model="editing_accounting_accounts.discount_account_id" ng-options="account.id as account.title for account in output_input_accounts()"><option value=""></option></select></div></div><hr /><div class="bold">Payment Accounts</div><br /><div class="control-group"><label class="control-label">Cash Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.cash_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Bank Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bank_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">EFTPOS Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.eftpos_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Credit Card Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.credit_card_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Cheque Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.cheque_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Direct Debit Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.direct_debit_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Paypal Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.paypal_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Other Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.other_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Credit</label><div class="controls"><select ng-model="editing_accounting_accounts.customer_credit_account_id" ng-options="account.id as account.title for account in output_accounts()"><option value=""></option></select></div></div><hr /><div class="bold">Purchase Accounts</div><br /><div class="control-group"><label class="control-label">Default Purchase</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_account_id" ng-options="account.id as account.title for account in input_accounts()"><option value=""></option></select></div></div><div ng-hide="accounting_integration_account.third_party == &#39;Myob Essentials&#39;"><div class="control-group"><label class="control-label">Part Purchase</label><div class="controls"><select ng-model="editing_accounting_accounts.part_purchase_account_id" ng-options="account.id as account.title for account in input_accounts()"><option value=""></option></select></div></div><hr /><div class="bold">Bill Payment Accounts</div><br /><div class="control-group"><label class="control-label">Cash Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_cash_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Bank Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">EFTPOS Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_eftpos_payment_account_id" ng-options="account.id as account.title for account in bank_accounts()"></select></div></div><div class="control-group"><label class="control-label">Credit Card Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_credit_card_payment_account_id" ng-options="account.id as account.title for account in bank_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Cheque Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_cheque_payment_account_id" ng-options="account.id as account.title for account in bank_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Direct Debit Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_direct_debit_payment_account_id" ng-options="account.id as account.title for account in bank_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Paypal Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_paypal_payment_account_id" ng-options="account.id as account.title for account in bank_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Other Payment</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_other_payment_account_id" ng-options="account.id as account.title for account in payment_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Supplier Credit</label><div class="controls"><select ng-model="editing_accounting_accounts.supplier_credit_account_id" ng-options="account.id as account.title for account in input_accounts()"><option value=""></option></select></div></div><br /><div class="sub-header">Tax Codes</div><div ng-hide="not_registered_for_gst"><div class="control-group"><label class="control-label">Invoice {{tax_name()}}</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_gst_tax_type" ng-options="tax_type.tax_type as tax_type.name for tax_type in tax_types()"></select></div></div><div class="control-group"><label class="control-label">Invoice {{tax_name()}} Free</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_gst_free_tax_type" ng-options="tax_type.tax_type as tax_type.name for tax_type in tax_types()"></select></div></div></div><div ng-show="not_registered_for_gst"><div class="control-group"><label class="control-label">Invoice Tax Code</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_no_gst_tax_type" ng-options="tax_type.tax_type as tax_type.name for tax_type in tax_types()"></select></div></div></div><div class="control-group"><label class="control-label">Bill {{tax_name()}}</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_gst_tax_type" ng-options="tax_type.tax_type as tax_type.name for tax_type in tax_types()"></select></div></div><div class="control-group"><label class="control-label">Bill {{tax_name()}} Free</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_gst_free_tax_type" ng-options="tax_type.tax_type as tax_type.name for tax_type in tax_types()"></select></div></div><div ng-show="accounting_integration_account.third_party == &#39;Quickbooks&#39;"><br /><div class="sub-header">Tax Rates</div><div ng-hide="not_registered_for_gst"><div class="control-group"><label class="control-label">Invoice {{tax_name()}} Tax Rate</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_gst_tax_rate" ng-options="tax_rate.name as tax_rate.name for tax_rate in tax_rates()"></select></div></div><div class="control-group"><label class="control-label">Invoice {{tax_name()}} Free</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_gst_free_tax_rate" ng-options="tax_rate.name as tax_rate.name for tax_rate in tax_rates()"></select></div></div></div><div ng-show="not_registered_for_gst"><div class="control-group"><label class="control-label">Invoice Tax Code</label><div class="controls"><select ng-model="editing_accounting_accounts.invoice_gst_free_tax_rate" ng-options="tax_rate.name as tax_rate.name for tax_rate in tax_rates()"></select></div></div></div><div class="control-group"><label class="control-label">Bill {{tax_name()}} Tax Rate</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_gst_tax_rate" ng-options="tax_rate.name as tax_rate.name for tax_rate in tax_rates()"></select></div></div><div class="control-group"><label class="control-label">Bill {{tax_name()}} Free Tax Rate</label><div class="controls"><select ng-model="editing_accounting_accounts.bill_gst_free_tax_rate" ng-options="tax_rate.name as tax_rate.name for tax_rate in tax_rates()"></select></div></div></div></div><div class="control-group"><label></label><div class="controls actions"><button class="btn btn-primary" ng-click="save_accounting_accounts()">Save</button><button class="btn" ng-click="cancel_edit_accounting_accounts()">Cancel</button></div></div></form></div></div></div><div class="editing-item" ng-show="editing"><form class="form-horizontal"><div class="control-group" ng-hide="editing_accounting_integration_account.id &amp;&amp; editing_accounting_integration_account.third_party"><label class="control-label">Third Party Software</label><div class="controls"><select ng-model="editing_accounting_integration_account.third_party"><option value="Xero">Xero</option><option value="Myob Essentials">MYOB Essentials</option><option value="Myob Account Right Live">MYOB Account Right Live</option><option value="Quickbooks">Quickbooks Online</option><option value="Quickbooks-US">Quickbooks Online (US Version)</option></select></div></div><div class="control-group"><label class="control-label">Enabled</label><div class="controls"><input class="checkbox" ng-model="editing_accounting_integration_account.enabled" type="checkbox" value="true" /></div></div><div class="control-group"><label class="control-label">Sync method</label><div class="controls"><select ng-model="editing_accounting_integration_account.sync_method" type="text"><option value="manual">Manual</option><option value="live">Live</option></select></div></div><div class="control-group" ng-hide="editing_accounting_integration_account.third_party == &#39;Myob Essentials&#39;"><label class="control-label">Sync payments back to MechanicDesk</label><div class="controls"><input class="checkbox" ng-model="editing_accounting_integration_account.pull_payments" type="checkbox" value="true" /></div></div><div class="control-group" ng-show="editing_accounting_integration_account.third_party == &#39;Xero&#39;"><label class="control-label">Skip syncing stocks</label><div class="controls"><input class="checkbox" ng-model="editing_accounting_integration_account.disable_stock_sync" type="checkbox" value="true" /></div></div><div class="control-group"><label class="control-label">Sync Start Date</label><div class="controls"><ad_datepicker ng-model="editing_accounting_integration_account.sync_start_date"></ad_datepicker></div></div><div ng-show="accounting_integration_account.id &amp;&amp; accounting_integration_account.third_party == &#39;Myob Account Right Live&#39;"><div class="control-group"><label class="control-label">Username</label><div class="controls"><input class="input" ng-model="editing_accounting_integration_account.username" type="text" /></div></div><div class="control-group"><label class="control-label">Password</label><div class="controls"><input class="input" ng-model="editing_accounting_integration_account.password" type="password" /></div></div></div><div class="control-group"><label></label><div class="controls"><button class="btn btn-success" ng-click="save_accounting_integration_account()">Save</button><button class="btn" ng-click="cancel_edit_accounting_integration()">Cancel</button></div></div></form></div><div id="instruction-popover"><div class="popover fade bottom in" style="width: 98%"><div class="popover-title"><div class="sub-header"><span>How does it works?</span><div class="pull-right"><button class="btn btn-primary" ng-click="hide_instruction()"><i class="icon icon-remove"></i><span>Close</span></button></div></div></div><div class="popover-content"><div class="content-box"><div ng-show="accounting_integration_account.third_party == &#39;Xero&#39;"><h3>What resources are synced?</h3><div><div>The following resources are synced with Xero</div><table class="table table-striped"><thead><tr><th style="min-width: 200px">Resource</th><th style="min-width: 200px">Sync Direction</th><th>Sync Condition</th></tr></thead><tbody><tr><td class="bold">Chart of accounts</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-left"></i></span><span>Xero</span></td><td>Whenever an account is changed in Xero</td></tr><tr><td class="bold">Suppliers</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td>Whenever a supplier is changed in MechanicDesk or Xero</td></tr><tr><td class="bold">Customers</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td>Whenever a customer is changed in MechanicDesk or Xero</td></tr><tr><td class="bold">Stocks</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td>Whenever a stock is changed in MechanicDesk or Xero</td></tr><tr><td class="bold">Invoices</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>Xero</span></td><td><span>When the invoice is </span> <span class="label label-success">finalized</span><span>. Any change to the invoice after that will not be synced.</span></td></tr><tr><td class="bold">Credit Notes</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>Xero</span></td><td><span>When the credit note is </span> <span class="label label-success">finalized</span><span>. Any change to the credit note after that will not be synced.</span></td></tr><tr><td class="bold">Invoice payments</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td><span>When the invoice is</span> <span class="label label-success">finalized</span> <span>. If the payment is a part of a bulk payment. It is only synced when the bulk payment\'s allocations are</span> <span class="label label-success">finalized</span></td></tr><tr><td class="bold">Bills</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>Xero</span></td><td><span>When the bill is</span> <span class="label label-success">finalized.</span> <span>Any change to the bill after that will not be synced.</span></td></tr><tr><td class="bold">Supplier Credit Notes</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>Xero</span></td><td><span>When the supplier credit note is</span> <span class="label label-success">finalized.</span> <span>Any change to the supplier credit note after that will not be synced.</span></td></tr><tr><td class="bold">Bill payments</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td><span>When the bill is</span> <span class="label label-success">finalized</span><span>. If the bill payment is a part of a bulk payment, It is only synced when the bulk payment\'s allocations are</span> <span class="label label-success">finalized</span></td></tr></tbody></table></div><h3>Setup Xero Integration</h3><h5 class="bold">Step 1: Sign up with Xero</h5><p><span>You need a Xero account to sync to, so if you do not have one, please go to &nbsp;</span><a href="https://www.xero.com?xtid=x30mechanicdesk" target="_blank">www.xero.com</a><span>&nbsp; to sign up.</span></p><br /><br /><h5 class="bold">Step 2: Make sure you do not use Xero\'s "Demo Company"</h5><p>When you sign up with Xero, your account will have a "Demo Company" organisation with some sample data for you to play with. Unless your MechanicDesk account\'s data is disposable, do not sync MechanicDesk with "Demo Company", otherwise the sample data will be synced from Xero back to MechanicDesk and polutes your MechanicDesk data.</p><br /><br /><h5 class="bold">Step 3: Initialze Xero integration from MechanicDesk</h5><ul><li>Click on "Sync" button on the right hand side. A popup window will open, you will be redirected to a Xero page which requests your permission to give MechanicDesk access to your Xero account.</li><li>Choose the organisation you want to sync with MechanicDesk and click on "Authorize"</li><li>The sync process is now started</li></ul><p>On the first sync request, MechanicDesk will sync the following resources</p><ol><li>Chart of accounts</li><li>Suppliers</li><li>Customers</li><li>Stocks</li></ol><p><span class="bold">Please Note:</span> <span>If you have a lot of stocks in MechanicDesk, the sync process can take a while so please be patient.</span></p><img src="/assets/help/xero_integration.sync.png" /><img src="/assets/help/xero_integration.xero_authorisation.png" /><br /><br /><br /><br /><h5 class="bold">Step 4: Confirm your accounts</h5><p>After the first sync request is finished. You will need to set up your accounting accounts with invoices, different payment types, bills and bill payments. MechanicDesk automatically detects the accounts and selects sensible default values for you. However you will need to have a look at your accounts, make any change neccessary and confirm your selections.</p><img src="/assets/help/xero_integration.confirm_accounts.png" /><img src="/assets/help/xero_integration.accounts_confirmation.png" /><br /><br /><br /><br /><h5 class="bold">Step 5: Start the sync again</h5><p>After you have confirmed the accounting accounts. You can click on the "Sync" button to start the sync process again. This time, as the accounting accounts have been confirmed, invoices, payments, bills and bill payments will be synced.</p></div><div ng-show="accounting_integration_account.third_party == &#39;Myob Account Right Live&#39;"><h3>What resources are synced?</h3><div><div>The following resources are synced with MYOB Account Right Live</div><table class="table table-striped"><thead><tr><th style="min-width: 200px">Resource</th><th style="min-width: 200px">Sync Direction</th><th>Sync Condition</th></tr></thead><tbody><tr><td class="bold">Chart of accounts</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-left"></i></span><span>MYOB</span></td><td>Once an account is created in MYOB</td></tr><tr><td class="bold">Suppliers</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td>Whenever a supplier is changed in MechanicDesk or MYOB</td></tr><tr><td class="bold">Customers</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td>Whenever a customer is changed in MechanicDesk or MYOB</td></tr><tr><td class="bold">Stocks</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td>Whenever a stock is changed in MechanicDesk or MYOB</td></tr><tr><td class="bold">Invoices</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>MYOB</span></td><td><span>When the invoice is </span> <span class="label label-success">finalized</span><span>. Any change to the invoice after that will not be synced.</span></td></tr><tr><td class="bold">Invoice payments</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td><span>When the invoice is</span> <span class="label label-success">finalized</span> <span>. If the payment is a part of a bulk payment. It is only synced when the bulk payment\'s allocations are</span> <span class="label label-success">finalized</span></td></tr><tr><td class="bold">Bills</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>MYOB</span></td><td><span>When the bill is</span> <span class="label label-success">finalized.</span> <span>Any change to the bill after that will not be synced.</span></td></tr><tr><td class="bold">Bill payments</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td><span>When the bill is</span> <span class="label label-success">finalized</span><span>. If the bill payment is a part of a bulk payment, It is only synced when the bulk payment\'s allocations are</span> <span class="label label-success">finalized</span></td></tr></tbody></table></div><h3>Setup MYOB Integration</h3><h5 class="bold">Step 1: Sign up with MYOB Account Right Live</h5><p><span>You need a MYOB Account Right Live account to sync to, so if you do not have one, please go to &nbsp;</span><a href="http://myob.com.au/products/small-business/accounting-software/myob-accountright-1422735752948" target="_blank">www.myob.com.au</a><span>&nbsp; to sign up.</span></p><br /><br /><h5 class="bold">Step 2: Initialze MYOB integration from MechanicDesk</h5><ul><li><div>Click on "Sync", Then Chose "Full Sync" button on the right hand side. A popup window will open, you will be redirected to a MYOB page which requests your permission to give MechanicDesk access to your MYOB account.</div><div><span class="bold">Note: </span> <span>Make sure you allow popup window from www.mechanicdesk.com.au for your browser</span></div><br /></li><li><div>Authorize MechanicDesk to sync with your MYOB Account Right Live account</div><br /></li><li><div>Chose your company file to integrate with MechanicDesk</div><br /></li><li><div>Enter the Username and Password to sync</div><div><span class="bold">Note:</span> <span class="bold">This Username and Password is NOT the one you sign in online but the one you need to access the company file online. The default would be Username: Administrator without any password. If you are not sure please follow this &nbsp;</span> <a href="http://help.myob.com/wiki/display/ar/Open+a+company+file" target="_balank">Link</a><span>&nbsp; for instructions</span></div><br /></li><li><div>The sync process is now started</div><br /></li></ul><p>On the first sync request, MechanicDesk will sync the following resources</p><ol><li><div>Chart of accounts</div><br /></li></ol><img src="/assets/help/myob_start_sync.png" /><img src="/assets/help/myob_authorization.png" /><img src="/assets/help/myob_select_company_name.png" /><br /><br /><br /><br /><h5 class="bold">Step 3: Confirm your accounts</h5><p>After the first sync request is finished. You will need to set up your accounting accounts with invoices, different payment types, bills and bill payments. MechanicDesk automatically detects the accounts and selects sensible default values for you. However you will need to have a look at your accounts, make any change neccessary and confirm your selections.</p><img src="/assets/help/myob_integration.confirm_accounts.png" /><img src="/assets/help/myob_integration.accounts_confirmation.png" /><br /><br /><br /><br /><h5 class="bold">Step 4: Start the sync again</h5><p>After you have confirmed the accounting accounts. You can click on the "Sync" button to start the sync process again. This time, as the accounting accounts have been confirmed, customers, suppliers, stocks, invoices, payments, bills and bill payments will be synced.</p></div><br /><br /><br /><div class="row-fluid"><button class="btn btn-primary span12" ng-click="hide_instruction()">Close</button></div></div></div></div></div></div></div><div class="span6"><div ng-hide="accounting_integration_account.id"><div class="well"><div><span class="bold">Please backup your accounting software data or consider integrating with a test/demo account first to make sure that you fully understand how the integration works. Contact MechanicDesk support team if you need any help</span> </div><br /><br /></div><div><div class="bold">Please Note:</div><br /><br><span class="bold">MYOB Essentials</span> does not allow bills, bill payments, credit notes to sync.</br><div><span>With MYOB Essential only</span> <span class="bold">accounts, contacts, stock items, invoices and invoice payments are synced. </span> </div><br /><br /><div><span>For</span> <span class="bold">Complete Integration</span> <span class="bold">with all resources,</span> <span>Please integrate with</span> <span class="bold">Xero, Quickbooks</span> <span>or</span> <span class="bold">MYOB Account Right Live</span> </div></div></div><div ng-show="accounting_integration_account.id"><div class="content-box"><div class="row-fluid"><div class="sub-header">Current Sync Requests</div><br /><div ng-repeat="request in current_sync_requests"><div class="inline bold">Requested at {{request.created_at | date: \'short\'}}</div><div class="inline pull-right"><div><span class="label label-info"><img ng-show="request.status == &#39;syncing&#39;" src="/assets/littlespinner-b053f26fde4de42a09c6c20272ce08ba.gif" /><span>&nbsp;</span><span>{{request.status}}</span></span></div><div class="pull-right" ng-show="request.status == &#39;access request sent&#39;"><button class="btn btn-small" ng-click="cancel_sync_request(request)">Cancel</button></div></div><br /><br /><div ad-accounting-sync-result="true" name="syncing accounts" ng-model="request.account_sync_result"></div><div ng-show="request.full_sync"><div ad-accounting-sync-result="true" name="syncing contacts" ng-model="request.contact_sync_result"></div></div><div ng-show="request.full_sync"><div ad-accounting-sync-result="true" name="syncing stocks" ng-model="request.stock_sync_result"></div></div><div ad-accounting-sync-result="true" name="syncing bills" ng-model="request.bill_sync_result"></div><div ad-accounting-sync-result="true" name="syncing supplier credit notes" ng-model="request.supplier_credit_note_sync_result"></div><div ad-accounting-sync-result="true" name="syncing bill payments" ng-model="request.bill_payment_sync_result"></div><div ad-accounting-sync-result="true" name="syncing customer credit notes" ng-model="request.credit_note_sync_result"></div><div ad-accounting-sync-result="true" name="syncing invoices" ng-model="request.invoice_sync_result"></div><div ad-accounting-sync-result="true" name="syncing payments" ng-model="request.payment_sync_result"></div></div><hr /><div class="sub-header">Last Sync Requests</div><div ng-repeat="request in accounting_integration_account.last_sync_requests"><div class="row-fluid"><div class="inline bold">Requested at {{request.created_at | date: \'short\'}}</div><div class="inline pull-right"><a href="javascript:void(0);" ng-click="show_error_hints(request)" ng-show="request.hints.length &gt; 0"><div class="inline red">E</div><span>rror Hints</span></a><div class="inline" ng-class="{red: request.sync_result.status == &#39;failed&#39;, green: request.sync_result.status == &#39;finished&#39;}" style="margin-left: 20px;">{{request.sync_result.status}}</div></div><div><div ad-accounting-sync-result="true" name="syncing accounts" ng-model="request.account_sync_result"></div><div ng-show="request.full_sync"><div ad-accounting-sync-result="true" name="syncing contacts" ng-model="request.contact_sync_result"></div></div><div ng-show="request.full_sync"><div ad-accounting-sync-result="true" name="syncing stocks" ng-model="request.stock_sync_result"></div></div><div ad-accounting-sync-result="true" name="syncing bills" ng-model="request.bill_sync_result"></div><div ad-accounting-sync-result="true" name="syncing supplier credit notes" ng-model="request.supplier_credit_note_sync_result"></div><div ad-accounting-sync-result="true" name="syncing bill payments" ng-model="request.bill_payment_sync_result"></div><div ad-accounting-sync-result="true" name="syncing invoices" ng-model="request.invoice_sync_result"></div><div ad-accounting-sync-result="true" name="syncing customer credit notes" ng-model="request.credit_note_sync_result"></div><div ad-accounting-sync-result="true" name="syncing payments" ng-model="request.payment_sync_result"></div></div><div class="italic" ng-show="request.sync_result.description">{{request.sync_result.description}}</div></div><br /></div></div><div id="request-hints-popover"><div class="popover fade bottom in" style="width: 700px"><div class="popover-title"><div class="sub-header"><span>Please check the following errors</span><div class="pull-right"><button class="btn btn-primary" ng-click="hide_error_hints()"><i class="icon icon-remove"></i><span>Close</span></button></div></div></div><div class="popover-content"><div class="content-box"><div ng-repeat="hint in showing_error_hint_request.hints">{{hint}}</div><div class="row-fluid"></div></div><button class="btn btn-primary" ng-click="hide_error_hints()">Close</button></div></div></div></div></div></div></div></div></div><form action="/accounting_sync_requests/sync" id="new-sync-request" method="POST" target="_blank"><input name="full_sync" type="hidden" value="{{full_sync}}" /><input name="csrf_token" type="hidden" value="{{csrf_value}}" /></form></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/accounting/myob_instruction.html",'<h3>What resources are synced?</h3><div><div>The following resources are synced with MYOB Account Right Live</div><table class="table table-striped"><thead><tr><th style="min-width: 200px">Resource</th><th style="min-width: 200px">Sync Direction</th><th>Sync Condition</th></tr></thead><tbody><tr><td class="bold">Chart of accounts</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-left"></i></span><span>MYOB</span></td><td>Once an account is created in MYOB</td></tr><tr><td class="bold">Suppliers</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td>Whenever a supplier is changed in MechanicDesk or MYOB</td></tr><tr><td class="bold">Customers</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td>Whenever a customer is changed in MechanicDesk or MYOB</td></tr><tr><td class="bold">Stocks</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td>Whenever a stock is changed in MechanicDesk or MYOB</td></tr><tr><td class="bold">Invoices</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>MYOB</span></td><td><span>When the invoice is </span> <span class="label label-success">finalized</span><span>. Any change to the invoice after that will not be synced.</span></td></tr><tr><td class="bold">Invoice payments</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td><span>When the invoice is</span> <span class="label label-success">finalized</span> <span>. If the payment is a part of a bulk payment. It is only synced when the bulk payment\'s allocations are</span> <span class="label label-success">finalized</span></td></tr><tr><td class="bold">Bills</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>MYOB</span></td><td><span>When the bill is</span> <span class="label label-success">finalized.</span> <span>Any change to the bill after that will not be synced.</span></td></tr><tr><td class="bold">Bill payments</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>MYOB</span></td><td><span>When the bill is</span> <span class="label label-success">finalized</span><span>. If the bill payment is a part of a bulk payment, It is only synced when the bulk payment\'s allocations are</span> <span class="label label-success">finalized</span></td></tr></tbody></table></div><h3>Setup MYOB Integration</h3><h5 class="bold">Step 1: Sign up with MYOB Account Right Live</h5><p><span>You need a MYOB Account Right Live account to sync to, so if you do not have one, please go to &nbsp;</span><a href="http://myob.com.au/products/small-business/accounting-software/myob-accountright-1422735752948" target="_blank">www.myob.com.au</a><span>&nbsp; to sign up.</span></p><br /><br /><h5 class="bold">Step 2: Initialze MYOB integration from MechanicDesk</h5><ul><li><div>Click on "Sync", Then Chose "Full Sync" button on the right hand side. A popup window will open, you will be redirected to a MYOB page which requests your permission to give MechanicDesk access to your MYOB account.</div><div><span class="bold">Note: </span> <span>Make sure you allow popup window from www.mechanicdesk.com.au for your browser</span></div><br /></li><li><div>Authorize MechanicDesk to sync with your MYOB Account Right Live account</div><br /></li><li><div>Chose your company file to integrate with MechanicDesk</div><br /></li><li><div>Enter the Username and Password to sync</div><div><span class="bold">Note:</span> <span class="bold">This Username and Password is NOT the one you sign in online but the one you need to access the company file online. The default would be Username: Administrator without any password. If you are not sure please follow this &nbsp;</span> <a href="http://help.myob.com/wiki/display/ar/Open+a+company+file" target="_balank">Link</a><span>&nbsp; for instructions</span></div><br /></li><li><div>The sync process is now started</div><br /></li></ul><p>On the first sync request, MechanicDesk will sync the following resources</p><ol><li><div>Chart of accounts</div><br /></li></ol><img src="/assets/help/myob_start_sync.png" /><img src="/assets/help/myob_authorization.png" /><img src="/assets/help/myob_select_company_name.png" /><br /><br /><br /><br /><h5 class="bold">Step 3: Confirm your accounts</h5><p>After the first sync request is finished. You will need to set up your accounting accounts with invoices, different payment types, bills and bill payments. MechanicDesk automatically detects the accounts and selects sensible default values for you. However you will need to have a look at your accounts, make any change neccessary and confirm your selections.</p><img src="/assets/help/myob_integration.confirm_accounts.png" /><img src="/assets/help/myob_integration.accounts_confirmation.png" /><br /><br /><br /><br /><h5 class="bold">Step 4: Start the sync again</h5><p>After you have confirmed the accounting accounts. You can click on the "Sync" button to start the sync process again. This time, as the accounting accounts have been confirmed, customers, suppliers, stocks, invoices, payments, bills and bill payments will be synced.</p>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/accounting/sync_requests.html",'<div class="row-fluid"><div class="sub-header">Current Sync Requests</div><br /><div ng-repeat="request in current_sync_requests"><div class="inline bold">Requested at {{request.created_at | date: \'short\'}}</div><div class="inline pull-right"><div><span class="label label-info"><img ng-show="request.status == &#39;syncing&#39;" src="/assets/littlespinner-b053f26fde4de42a09c6c20272ce08ba.gif" /><span>&nbsp;</span><span>{{request.status}}</span></span></div><div class="pull-right" ng-show="request.status == &#39;access request sent&#39;"><button class="btn btn-small" ng-click="cancel_sync_request(request)">Cancel</button></div></div><br /><br /><div ad-accounting-sync-result="true" name="syncing accounts" ng-model="request.account_sync_result"></div><div ng-show="request.full_sync"><div ad-accounting-sync-result="true" name="syncing contacts" ng-model="request.contact_sync_result"></div></div><div ng-show="request.full_sync"><div ad-accounting-sync-result="true" name="syncing stocks" ng-model="request.stock_sync_result"></div></div><div ad-accounting-sync-result="true" name="syncing bills" ng-model="request.bill_sync_result"></div><div ad-accounting-sync-result="true" name="syncing supplier credit notes" ng-model="request.supplier_credit_note_sync_result"></div><div ad-accounting-sync-result="true" name="syncing bill payments" ng-model="request.bill_payment_sync_result"></div><div ad-accounting-sync-result="true" name="syncing customer credit notes" ng-model="request.credit_note_sync_result"></div><div ad-accounting-sync-result="true" name="syncing invoices" ng-model="request.invoice_sync_result"></div><div ad-accounting-sync-result="true" name="syncing payments" ng-model="request.payment_sync_result"></div></div><hr /><div class="sub-header">Last Sync Requests</div><div ng-repeat="request in accounting_integration_account.last_sync_requests"><div class="row-fluid"><div class="inline bold">Requested at {{request.created_at | date: \'short\'}}</div><div class="inline pull-right"><a href="javascript:void(0);" ng-click="show_error_hints(request)" ng-show="request.hints.length &gt; 0"><div class="inline red">E</div><span>rror Hints</span></a><div class="inline" ng-class="{red: request.sync_result.status == &#39;failed&#39;, green: request.sync_result.status == &#39;finished&#39;}" style="margin-left: 20px;">{{request.sync_result.status}}</div></div><div><div ad-accounting-sync-result="true" name="syncing accounts" ng-model="request.account_sync_result"></div><div ng-show="request.full_sync"><div ad-accounting-sync-result="true" name="syncing contacts" ng-model="request.contact_sync_result"></div></div><div ng-show="request.full_sync"><div ad-accounting-sync-result="true" name="syncing stocks" ng-model="request.stock_sync_result"></div></div><div ad-accounting-sync-result="true" name="syncing bills" ng-model="request.bill_sync_result"></div><div ad-accounting-sync-result="true" name="syncing supplier credit notes" ng-model="request.supplier_credit_note_sync_result"></div><div ad-accounting-sync-result="true" name="syncing bill payments" ng-model="request.bill_payment_sync_result"></div><div ad-accounting-sync-result="true" name="syncing invoices" ng-model="request.invoice_sync_result"></div><div ad-accounting-sync-result="true" name="syncing customer credit notes" ng-model="request.credit_note_sync_result"></div><div ad-accounting-sync-result="true" name="syncing payments" ng-model="request.payment_sync_result"></div></div><div class="italic" ng-show="request.sync_result.description">{{request.sync_result.description}}</div></div><br /></div></div><div id="request-hints-popover"><div class="popover fade bottom in" style="width: 700px"><div class="popover-title"><div class="sub-header"><span>Please check the following errors</span><div class="pull-right"><button class="btn btn-primary" ng-click="hide_error_hints()"><i class="icon icon-remove"></i><span>Close</span></button></div></div></div><div class="popover-content"><div class="content-box"><div ng-repeat="hint in showing_error_hint_request.hints">{{hint}}</div><div class="row-fluid"></div></div><button class="btn btn-primary" ng-click="hide_error_hints()">Close</button></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/accounting/xero_instruction.html",'<h3>What resources are synced?</h3><div><div>The following resources are synced with Xero</div><table class="table table-striped"><thead><tr><th style="min-width: 200px">Resource</th><th style="min-width: 200px">Sync Direction</th><th>Sync Condition</th></tr></thead><tbody><tr><td class="bold">Chart of accounts</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-left"></i></span><span>Xero</span></td><td>Whenever an account is changed in Xero</td></tr><tr><td class="bold">Suppliers</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td>Whenever a supplier is changed in MechanicDesk or Xero</td></tr><tr><td class="bold">Customers</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td>Whenever a customer is changed in MechanicDesk or Xero</td></tr><tr><td class="bold">Stocks</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td>Whenever a stock is changed in MechanicDesk or Xero</td></tr><tr><td class="bold">Invoices</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>Xero</span></td><td><span>When the invoice is </span> <span class="label label-success">finalized</span><span>. Any change to the invoice after that will not be synced.</span></td></tr><tr><td class="bold">Credit Notes</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>Xero</span></td><td><span>When the credit note is </span> <span class="label label-success">finalized</span><span>. Any change to the credit note after that will not be synced.</span></td></tr><tr><td class="bold">Invoice payments</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td><span>When the invoice is</span> <span class="label label-success">finalized</span> <span>. If the payment is a part of a bulk payment. It is only synced when the bulk payment\'s allocations are</span> <span class="label label-success">finalized</span></td></tr><tr><td class="bold">Bills</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>Xero</span></td><td><span>When the bill is</span> <span class="label label-success">finalized.</span> <span>Any change to the bill after that will not be synced.</span></td></tr><tr><td class="bold">Supplier Credit Notes</td><td><span>MechanicDesk </span><span><i class="icon icon-arrow-right"></i></span><span>Xero</span></td><td><span>When the supplier credit note is</span> <span class="label label-success">finalized.</span> <span>Any change to the supplier credit note after that will not be synced.</span></td></tr><tr><td class="bold">Bill payments</td><td><span>MechanicDesk </span><span><i class="icon icon-exchange"></i></span><span>Xero</span></td><td><span>When the bill is</span> <span class="label label-success">finalized</span><span>. If the bill payment is a part of a bulk payment, It is only synced when the bulk payment\'s allocations are</span> <span class="label label-success">finalized</span></td></tr></tbody></table></div><h3>Setup Xero Integration</h3><h5 class="bold">Step 1: Sign up with Xero</h5><p><span>You need a Xero account to sync to, so if you do not have one, please go to &nbsp;</span><a href="https://www.xero.com?xtid=x30mechanicdesk" target="_blank">www.xero.com</a><span>&nbsp; to sign up.</span></p><br /><br /><h5 class="bold">Step 2: Make sure you do not use Xero\'s "Demo Company"</h5><p>When you sign up with Xero, your account will have a "Demo Company" organisation with some sample data for you to play with. Unless your MechanicDesk account\'s data is disposable, do not sync MechanicDesk with "Demo Company", otherwise the sample data will be synced from Xero back to MechanicDesk and polutes your MechanicDesk data.</p><br /><br /><h5 class="bold">Step 3: Initialze Xero integration from MechanicDesk</h5><ul><li>Click on "Sync" button on the right hand side. A popup window will open, you will be redirected to a Xero page which requests your permission to give MechanicDesk access to your Xero account.</li><li>Choose the organisation you want to sync with MechanicDesk and click on "Authorize"</li><li>The sync process is now started</li></ul><p>On the first sync request, MechanicDesk will sync the following resources</p><ol><li>Chart of accounts</li><li>Suppliers</li><li>Customers</li><li>Stocks</li></ol><p><span class="bold">Please Note:</span> <span>If you have a lot of stocks in MechanicDesk, the sync process can take a while so please be patient.</span></p><img src="/assets/help/xero_integration.sync.png" /><img src="/assets/help/xero_integration.xero_authorisation.png" /><br /><br /><br /><br /><h5 class="bold">Step 4: Confirm your accounts</h5><p>After the first sync request is finished. You will need to set up your accounting accounts with invoices, different payment types, bills and bill payments. MechanicDesk automatically detects the accounts and selects sensible default values for you. However you will need to have a look at your accounts, make any change neccessary and confirm your selections.</p><img src="/assets/help/xero_integration.confirm_accounts.png" /><img src="/assets/help/xero_integration.accounts_confirmation.png" /><br /><br /><br /><br /><h5 class="bold">Step 5: Start the sync again</h5><p>After you have confirmed the accounting accounts. You can click on the "Sync" button to start the sync process again. This time, as the accounting accounts have been confirmed, invoices, payments, bills and bill payments will be synced.</p>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/eftpos/index.html",'<div ng-controller="EftposMachineIntegrationController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span2"><ul class="nav nav-list side-nav" ng-controller="IntegrationsNavController"><li class="{{isActive(&#39;Accounting Integration&#39;)}}"><a href="#/integrations/accounting">Accounting Integration</a></li><li class="{{isActive(&#39;Supplier Integration&#39;)}}"><a href="#/integrations/supplier">Supplier Integration</a></li><li class="{{isActive(&#39;Marketing Integration&#39;)}}"><a href="#/integrations/marketing">Marketing Integration</a></li><li class="{{isActive(&#39;EFTPOS Integration&#39;)}}"><a href="#/integrations/eftpos">EFTPOS Integration</a></li><li class="{{isActive(&#39;Vehicle Look Up Integration&#39;)}}"><a href="#/integrations/vehiclelookup">Vehicle Look Up Integration</a></li><li class="{{isActive(&#39;Trade Memberships&#39;)}}"><a href="#/integrations/royalty">Royalty Program Integrations</a></li><li class="{{isActive(&#39;Vehicle Visual&#39;)}}"><a href="#/integrations/vehicle_visual">Vehicle Visual Integration</a></li></ul></div><div class="column span10"><div class="row-fluid"><div class="column span6"><div class="content-box"><img src="/assets/tyro-17e8f1c9a3d948219dff71a2bd7bc5a4.png" style="height: 40px;" /><div><div class="pull-right" ng-show="tyro_account.id"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(tyro_account)" ng-hide="tyro_account.id || tyro_account.editing">Start Integration</button><div class="editable" ng-click="edit_accounting_integration(tyro_account)" ng-show="tyro_account.id &amp;&amp; !tyro_account.editing"><div><span class="label-name-left">Merchant ID</span><span>{{tyro_account.merchant_id}}</span></div><div><span class="label-name-left">Terminal ID</span><span>{{tyro_account.terminal_id}}</span></div><div ng-show="tyro_account.terminal2_id"><span class="label-name-left">Terminal 2 ID</span><span>{{tyro_account.terminal2_id}}</span></div><div ng-show="tyro_account.terminal3_id"><span class="label-name-left">Terminal 3 ID</span><span>{{tyro_account.terminal3_id}}</span></div><div ng-show="tyro_account.terminal4_id"><span class="label-name-left">Terminal 4 ID</span><span>{{tyro_account.terminal4_id}}</span></div></div><div class="editing-item" ng-show="tyro_account.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Merchant ID</label><div class="controls"><input ng-model="tyro_account.editing.merchant_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal ID</label><div class="controls"><input ng-model="tyro_account.editing.terminal_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal 2 ID</label><div class="controls"><input ng-model="tyro_account.editing.terminal2_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal 3 ID</label><div class="controls"><input ng-model="tyro_account.editing.terminal3_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal 4 ID</label><div class="controls"><input ng-model="tyro_account.editing.terminal4_id" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(tyro_account)">Save</button><button class="btn" ng-click="cancel(tyro_account)">Cancel</button></div></div></form></div></div></div></div><div class="column span6"><div class="content-box"><img src="/assets/payment_express-35fcbc9dfa4327091e84368898dd2bdf.png" style="height: 40px;" /><div>(In Testing)</div><div><div class="pull-right" ng-show="payment_express_account.id"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(payment_express_account)" ng-hide="payment_express_account.id || payment_express_account.editing">Start Integration</button><div class="editable" ng-click="edit_accounting_integration(payment_express_account)" ng-show="payment_express_account.id &amp;&amp; !payment_express_account.editing"><div><span class="label-name-left">Username</span><span>{{payment_express_account.username}}</span></div><div><span class="label-name-left">Key</span><span class="truncate">{{payment_express_account.key}}</span></div><div><span class="label-name-left">Terminal ID</span><span>{{payment_express_account.terminal_id}}</span></div><div ng-show="payment_express_account.terminal2_id"><span class="label-name-left">Terminal 2 ID</span><span>{{payment_express_account.terminal2_id}}</span></div><div ng-show="payment_express_account.terminal3_id"><span class="label-name-left">Terminal 3 ID</span><span>{{payment_express_account.terminal3_id}}</span></div><div ng-show="payment_express_account.terminal4_id"><span class="label-name-left">Terminal 4 ID</span><span>{{payment_express_account.terminal4_id}}</span></div></div><div class="editing-item" ng-show="payment_express_account.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Username</label><div class="controls"><input ng-model="payment_express_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Key</label><div class="controls"><input ng-model="payment_express_account.editing.key" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal ID</label><div class="controls"><input ng-model="payment_express_account.editing.terminal_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal 2 ID</label><div class="controls"><input ng-model="payment_express_account.editing.terminal2_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal 3 ID</label><div class="controls"><input ng-model="payment_express_account.editing.terminal3_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal 4 ID</label><div class="controls"><input ng-model="payment_express_account.editing.terminal4_id" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(payment_express_account)">Save</button><button class="btn" ng-click="cancel(payment_express_account)">Cancel</button></div></div></form></div></div></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/eftpos/payment_express.html",'<div class="content-box"><img src="/assets/payment_express-35fcbc9dfa4327091e84368898dd2bdf.png" style="height: 40px;" /><div>(In Testing)</div><div><div class="pull-right" ng-show="payment_express_account.id"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(payment_express_account)" ng-hide="payment_express_account.id || payment_express_account.editing">Start Integration</button><div class="editable" ng-click="edit_accounting_integration(payment_express_account)" ng-show="payment_express_account.id &amp;&amp; !payment_express_account.editing"><div><span class="label-name-left">Username</span><span>{{payment_express_account.username}}</span></div><div><span class="label-name-left">Key</span><span class="truncate">{{payment_express_account.key}}</span></div><div><span class="label-name-left">Terminal ID</span><span>{{payment_express_account.terminal_id}}</span></div><div ng-show="payment_express_account.terminal2_id"><span class="label-name-left">Terminal 2 ID</span><span>{{payment_express_account.terminal2_id}}</span></div><div ng-show="payment_express_account.terminal3_id"><span class="label-name-left">Terminal 3 ID</span><span>{{payment_express_account.terminal3_id}}</span></div><div ng-show="payment_express_account.terminal4_id"><span class="label-name-left">Terminal 4 ID</span><span>{{payment_express_account.terminal4_id}}</span></div></div><div class="editing-item" ng-show="payment_express_account.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Username</label><div class="controls"><input ng-model="payment_express_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Key</label><div class="controls"><input ng-model="payment_express_account.editing.key" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal ID</label><div class="controls"><input ng-model="payment_express_account.editing.terminal_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal 2 ID</label><div class="controls"><input ng-model="payment_express_account.editing.terminal2_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal 3 ID</label><div class="controls"><input ng-model="payment_express_account.editing.terminal3_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal 4 ID</label><div class="controls"><input ng-model="payment_express_account.editing.terminal4_id" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(payment_express_account)">Save</button><button class="btn" ng-click="cancel(payment_express_account)">Cancel</button></div></div></form></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/eftpos/tyro.html",'<div class="content-box"><img src="/assets/tyro-17e8f1c9a3d948219dff71a2bd7bc5a4.png" style="height: 40px;" /><div><div class="pull-right" ng-show="tyro_account.id"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(tyro_account)" ng-hide="tyro_account.id || tyro_account.editing">Start Integration</button><div class="editable" ng-click="edit_accounting_integration(tyro_account)" ng-show="tyro_account.id &amp;&amp; !tyro_account.editing"><div><span class="label-name-left">Merchant ID</span><span>{{tyro_account.merchant_id}}</span></div><div><span class="label-name-left">Terminal ID</span><span>{{tyro_account.terminal_id}}</span></div><div ng-show="tyro_account.terminal2_id"><span class="label-name-left">Terminal 2 ID</span><span>{{tyro_account.terminal2_id}}</span></div><div ng-show="tyro_account.terminal3_id"><span class="label-name-left">Terminal 3 ID</span><span>{{tyro_account.terminal3_id}}</span></div><div ng-show="tyro_account.terminal4_id"><span class="label-name-left">Terminal 4 ID</span><span>{{tyro_account.terminal4_id}}</span></div></div><div class="editing-item" ng-show="tyro_account.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Merchant ID</label><div class="controls"><input ng-model="tyro_account.editing.merchant_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal ID</label><div class="controls"><input ng-model="tyro_account.editing.terminal_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal 2 ID</label><div class="controls"><input ng-model="tyro_account.editing.terminal2_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal 3 ID</label><div class="controls"><input ng-model="tyro_account.editing.terminal3_id" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal 4 ID</label><div class="controls"><input ng-model="tyro_account.editing.terminal4_id" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(tyro_account)">Save</button><button class="btn" ng-click="cancel(tyro_account)">Cancel</button></div></div></form></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/marketing/index.html",'<div ng-controller="MarketingIntegrationController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span2"><ul class="nav nav-list side-nav" ng-controller="IntegrationsNavController"><li class="{{isActive(&#39;Accounting Integration&#39;)}}"><a href="#/integrations/accounting">Accounting Integration</a></li><li class="{{isActive(&#39;Supplier Integration&#39;)}}"><a href="#/integrations/supplier">Supplier Integration</a></li><li class="{{isActive(&#39;Marketing Integration&#39;)}}"><a href="#/integrations/marketing">Marketing Integration</a></li><li class="{{isActive(&#39;EFTPOS Integration&#39;)}}"><a href="#/integrations/eftpos">EFTPOS Integration</a></li><li class="{{isActive(&#39;Vehicle Look Up Integration&#39;)}}"><a href="#/integrations/vehiclelookup">Vehicle Look Up Integration</a></li><li class="{{isActive(&#39;Trade Memberships&#39;)}}"><a href="#/integrations/royalty">Royalty Program Integrations</a></li><li class="{{isActive(&#39;Vehicle Visual&#39;)}}"><a href="#/integrations/vehicle_visual">Vehicle Visual Integration</a></li></ul></div><div class="column span10"><div class="row-fluid" ng-show="marketing_integration_account.id"><div class="pull-right"><div class="btn btn-primary" ng-click="sync()" ng-show="marketing_integration_account.enabled"><i class="icon icon-refresh"></i> <span>Sync</span> </div><a class="btn" ng-href="https://admin.mailchimp.com/" ng-show="marketing_integration_account.third_party == &#39;MailChimp&#39;" target="_blank">Open MailChimp</a><a class="btn" ng-href="https://activecampaign.com/" ng-show="marketing_integration_account.third_party == &#39;ActiveCampaign&#39;" target="_blank">Open ActiveCampaign</a></div></div><br /><div class="row-fluid"><div class="column span6"><div class="content-box"><button class="btn btn-link" ng-click="start_integration()" ng-hide="marketing_integration_account.id">Start Integration</button><div class="editing-item" ng-show="marketing_integration_account.editing &amp;&amp; !marketing_integration_account.id"><form class="form-horizontal"><label class="control-label">Third Party Software</label><div class="controls"><select ng-model="marketing_integration_account.editing.third_party"><option value="MailChimp">MailChimp</option><option value="ActiveCampaign">ActiveCampaign</option></select></div><div class="control-group" id="api-endpoint-input" ng-show="marketing_integration_account.editing.third_party == &#39;ActiveCampaign&#39;"><label class="control-label">API Endpoint/URL</label><div class="controls"><input class="input-medium" ng-model="marketing_integration_account.editing.api_endpoint" /><button class="btn btn-link" ng-click="show_third_party_api_key_popover()">Where is it?</button></div></div><div class="control-group" id="api-key-input"><label class="control-label">API Key</label><div class="controls"><input class="input-medium" ng-model="marketing_integration_account.editing.api_key" /><button class="btn btn-link" ng-click="show_third_party_api_key_popover()">Where is it?</button></div></div><div class="control-group"><label class="control-label">Enabled</label><div class="controls"><input class="checkbox" ng-model="marketing_integration_account.editing.enabled" type="checkbox" value="true" /></div></div><div class="control-group"><label></label><div class="controls"><button class="btn btn-success" id="marketing-save" ng-click="save_marketing_integration_account()">Save</button><button class="btn" ng-click="cancel_edit_marketing_integration()">Cancel</button></div></div></form></div><div class="editable" ng-click="edit_marketing_integration_account()" ng-show="!marketing_integration_account.editing &amp;&amp; marketing_integration_account.id"><div><span class="label-name-left">{{marketing_integration_account.third_party}}</span><span class="pull-right green" ng-show="marketing_integration_account.enabled">(Enabled)</span><span class="pull-right red" ng-hide="marketing_integration_account.enabled">(Disabled)</span></div><br /><div ng-show="marketing_integration_account.third_party == &#39;MailChimp&#39;"><div class="bold">Please Note:</div><div>Due to Mailchimp design. Even though the contacts are synced successfully, it might be several minutes or even hours before you see the contacts appear in Mailchimp.</div></div><div ng-show="marketing_integration_account.third_party == &#39;ActiveCampaign&#39;"></div><br /></div><div class="editing-item" ng-show="marketing_integration_account.editing &amp;&amp; marketing_integration_account.id"><form class="form-horizontal"><div class="control-group"><label class="control-label">API Key</label><div class="controls"><input class="input-medium" ng-model="marketing_integration_account.editing.api_key" /><button class="btn btn-link" ng-click="show_third_party_api_key_popover()">Where is it?</button></div></div><div class="control-group"><label class="control-label">Enabled</label><div class="controls"><input class="checkbox" ng-model="marketing_integration_account.editing.enabled" type="checkbox" value="true" /></div></div><div class="control-group"><label></label><div class="controls"><button class="btn btn-success" ng-click="save_marketing_integration_account()">Save</button><button class="btn" ng-click="cancel_edit_marketing_integration()">Cancel</button></div></div></form></div></div></div><div class="column span6"><div class="row-fluid"><div class="content-box"><div class="sub-header">Current Sync Requests</div><br /><div ng-repeat="request in current_sync_requests"><div class="inline bold">Requested at {{request.created_at | date: \'short\'}}</div><div class="inline pull-right"><div><span class="label label-info"><img ng-show="request.status == &#39;started&#39;" src="/assets/littlespinner-b053f26fde4de42a09c6c20272ce08ba.gif" /><span>&nbsp;</span><span>{{request.status}}</span></span></div></div><br /><br /></div><hr /><div class="sub-header">Last 5 Sync Requests</div><div ng-repeat="request in marketing_integration_account.last_five_sync_requests"><div class="row-fluid"><div class="inline bold">Requested at {{request.created_at | date: \'short\'}}</div><div class="inline pull-right"><span ng-class="{red: request.sync_result.status == &#39;failed&#39;, green: request.sync_result.status == &#39;finished&#39;}">{{request.sync_result.status}}</span></div><div></div><div class="italic" ng-show="request.sync_result.description">{{request.sync_result.description}}</div></div><br /><hr /></div></div></div></div></div></div></div><div id="third-party-api-key-popover"><div class="popover fade left in" style="width: 800px"><div class="popover-title"><div class="pull-right"><button class="btn btn-primary" ng-click="close_third_party_api_key_popover()">Close</button></div><div class="sub-header">Where to find API Key?</div></div><div class="popover-content"><div class="row-fluid" ng-show="marketing_integration_account.editing.third_party == &#39;ActiveCampaign&#39;"><div class="content-box"><img src="/assets/API_key_active_campaign-087e8e0282aa3ea26cb53154fbe90fc2.png" /></div></div><div class="row-fluid" ng-show="marketing_integration_account.editing.third_party == &#39;MailChimp&#39;"><div class="content-box"><img src="/assets/mailchimp_api_key_1-4c90c06baf9ef6567982446e7bd917ad.png" /><hr /><img src="/assets/mailchimp_api_key_2-cb3819d29b3f90798eeaf754d6b9c06f.png" /><hr /><img src="/assets/mailchimp_api_key_3-d587030e022ae1f5fee5d40f64a699be.png" /></div></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/nav.html",'<ul class="nav nav-list side-nav" ng-controller="IntegrationsNavController"><li class="{{isActive(&#39;Accounting Integration&#39;)}}"><a href="#/integrations/accounting">Accounting Integration</a></li><li class="{{isActive(&#39;Supplier Integration&#39;)}}"><a href="#/integrations/supplier">Supplier Integration</a></li><li class="{{isActive(&#39;Marketing Integration&#39;)}}"><a href="#/integrations/marketing">Marketing Integration</a></li><li class="{{isActive(&#39;EFTPOS Integration&#39;)}}"><a href="#/integrations/eftpos">EFTPOS Integration</a></li><li class="{{isActive(&#39;Vehicle Look Up Integration&#39;)}}"><a href="#/integrations/vehiclelookup">Vehicle Look Up Integration</a></li><li class="{{isActive(&#39;Trade Memberships&#39;)}}"><a href="#/integrations/royalty">Royalty Program Integrations</a></li><li class="{{isActive(&#39;Vehicle Visual&#39;)}}"><a href="#/integrations/vehicle_visual">Vehicle Visual Integration</a></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/royalty/ams.html",'<div class="content-box" id="ams-setup"><div class="row-fluid"><img src="/assets/ams_rewards-7278e99368043ef389b5220b3491820e.png" style="height: 40px;" /><span>&nbsp; (Only Available in Australia)</span><div class="pull-right" ng-show="ams_account.id"><label class="label label-success" ng-show="ams_account.enabled">Enabled</label><label class="label" ng-hide="ams_account.enabled">Disabled</label></div></div><div class="row-fluid"><img src="/assets/australian_motoring_clubs-75a508c21c6c9751d4b531c041905e21.png" /></div><br /><br /><button class="btn btn-link" ng-click="edit_account(ams_account)" ng-hide="ams_account.id || ams_account.editing">Start Integration</button><div class="editable" ng-click="edit_account(ams_account)" ng-show="ams_account.id &amp;&amp; !ams_account.editing"><div class="info"><span class="label-name">Partner Code:</span><span>{{ams_account.account_number}}</span></div><div class="info"><span class="label-name">Member Of:</span><span>{{ams_account.auto_club}}</span></div><div class="info"><span class="label-name">Discount:</span><span>{{ams_account.discount_percentage}} %</span></div><div ng-hide="ams_account.auto_upload"><br /><br /><div class="bold">Note</div><div>If you want MechanicDesk to automatically send the report to AMS Rewards at the end of day, please contact our support team and we will set this up for you. Please email support@mechanicdesk.com.au or call 1300 737 100</div></div></div><div class="editing-item" ng-show="ams_account.editing"><form class="form form-horizontal"><div class="control-group"><label class="control-label">Partner Code</label><div class="controls"><input ng-model="ams_account.editing.account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Auto Club</label><div class="controls"><select ng-model="ams_account.editing.auto_club" ng-options="autoclub.code as autoclub.name for autoclub in ams_auto_club_options"></select></div></div><div class="control-group"><label class="control-label">Enabled</label><div class="controls"><input ng-model="ams_account.editing.enabled" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Discount Percentage</label><div class="controls"><div class="input-append"><input class="input-mini" ng-model="ams_account.editing.discount_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(ams_account)">Save</button><button class="btn" ng-click="cancel(ams_account)">Cancel</button></div></div></form></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/royalty/index.html",'<div ng-controller="RoyaltyIntegrationAccountsController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span2"><ul class="nav nav-list side-nav" ng-controller="IntegrationsNavController"><li class="{{isActive(&#39;Accounting Integration&#39;)}}"><a href="#/integrations/accounting">Accounting Integration</a></li><li class="{{isActive(&#39;Supplier Integration&#39;)}}"><a href="#/integrations/supplier">Supplier Integration</a></li><li class="{{isActive(&#39;Marketing Integration&#39;)}}"><a href="#/integrations/marketing">Marketing Integration</a></li><li class="{{isActive(&#39;EFTPOS Integration&#39;)}}"><a href="#/integrations/eftpos">EFTPOS Integration</a></li><li class="{{isActive(&#39;Vehicle Look Up Integration&#39;)}}"><a href="#/integrations/vehiclelookup">Vehicle Look Up Integration</a></li><li class="{{isActive(&#39;Trade Memberships&#39;)}}"><a href="#/integrations/royalty">Royalty Program Integrations</a></li><li class="{{isActive(&#39;Vehicle Visual&#39;)}}"><a href="#/integrations/vehicle_visual">Vehicle Visual Integration</a></li></ul></div><div class="column span10"><div class="row-fluid"><div class="column span6"><div class="content-box" id="ams-setup"><div class="row-fluid"><img src="/assets/ams_rewards-7278e99368043ef389b5220b3491820e.png" style="height: 40px;" /><span>&nbsp; (Only Available in Australia)</span><div class="pull-right" ng-show="ams_account.id"><label class="label label-success" ng-show="ams_account.enabled">Enabled</label><label class="label" ng-hide="ams_account.enabled">Disabled</label></div></div><div class="row-fluid"><img src="/assets/australian_motoring_clubs-75a508c21c6c9751d4b531c041905e21.png" /></div><br /><br /><button class="btn btn-link" ng-click="edit_account(ams_account)" ng-hide="ams_account.id || ams_account.editing">Start Integration</button><div class="editable" ng-click="edit_account(ams_account)" ng-show="ams_account.id &amp;&amp; !ams_account.editing"><div class="info"><span class="label-name">Partner Code:</span><span>{{ams_account.account_number}}</span></div><div class="info"><span class="label-name">Member Of:</span><span>{{ams_account.auto_club}}</span></div><div class="info"><span class="label-name">Discount:</span><span>{{ams_account.discount_percentage}} %</span></div><div ng-hide="ams_account.auto_upload"><br /><br /><div class="bold">Note</div><div>If you want MechanicDesk to automatically send the report to AMS Rewards at the end of day, please contact our support team and we will set this up for you. Please email support@mechanicdesk.com.au or call 1300 737 100</div></div></div><div class="editing-item" ng-show="ams_account.editing"><form class="form form-horizontal"><div class="control-group"><label class="control-label">Partner Code</label><div class="controls"><input ng-model="ams_account.editing.account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Auto Club</label><div class="controls"><select ng-model="ams_account.editing.auto_club" ng-options="autoclub.code as autoclub.name for autoclub in ams_auto_club_options"></select></div></div><div class="control-group"><label class="control-label">Enabled</label><div class="controls"><input ng-model="ams_account.editing.enabled" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Discount Percentage</label><div class="controls"><div class="input-append"><input class="input-mini" ng-model="ams_account.editing.discount_percentage" step="any" type="number" /><span class="add-on">%</span></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(ams_account)">Save</button><button class="btn" ng-click="cancel(ams_account)">Cancel</button></div></div></form></div></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/supplier/autopro.html",'<div class="content-box"><img src="/assets/autopro-53633ab840f227c7debd83dc4cab9de3.png" style="height: 25px;" /><div class="pull-right" ng-show="autopro_account.id &amp;&amp; autopro_account.active"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(autopro_account)" ng-hide="autopro_account.id || autopro_account.editing">Start Integration</button><div class="editable" ng-click="edit_accounting_integration(autopro_account)" ng-show="autopro_account.id &amp;&amp; !autopro_account.editing"><div><span class="label-name-left">Terminal ID</span><span>{{autopro_account.username}}</span></div><div><span class="label-name-left">Site Code</span><span>{{autopro_account.password}}</span></div><div><span class="label-name-left">Automatically Save Parts To Inventory</span><span>{{autopro_account.store_parts | yes_no}}</span></div></div><div class="row-fluid"><div class="pull-right"><a href="https://www.youtube.com/embed/jT9Vu5P1x7I?vq=hd1080&amp;autoplay=1" target="_blank">How does it works?</a></div></div><div class="editing-item" ng-show="autopro_account.editing"><form class="form-horizontal"><div class="sub-header">Authentication</div><div class="well bold">Authenication Code and Terminal ID are required</div><div class="control-group"><label class="control-label">Site Code</label><div class="controls"><input ng-model="autopro_account.editing.password" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal ID</label><div class="controls"><input ng-model="autopro_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Enable</label><div class="controls"><input ng-model="autopro_account.editing.active" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Automatically Save Parts To Inventory</label><div class="controls"><input ng-model="autopro_account.editing.store_parts" type="checkbox" /></div></div><div class="control-group" ng-show="autopro_account.editing.store_parts"><label class="control-label">Automatically Set the Part Category To</label><div class="controls"><div ad-stock-category-selection="" ng-model="autopro_account.editing.stock_category_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(autopro_account)">Save</button><button class="btn" ng-click="cancel(autopro_account)">Cancel</button></div></div></form></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/supplier/burson_ezy_parts.html",'<div class="content-box"><img src="/assets/burson_ezy_parts-c30f833eeb9ad9ec26fdcc4747ec3dd4.png" style="height: 25px;" /><div class="pull-right" ng-show="ezy_parts_account.id &amp;&amp; ezy_parts_account.active"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(ezy_parts_account)" ng-hide="ezy_parts_account.id || ezy_parts_account.editing">Start Integration</button><div class="editable" ng-click="edit_accounting_integration(ezy_parts_account)" ng-show="ezy_parts_account.id &amp;&amp; !ezy_parts_account.editing"><div><span class="label-name-left">Terminal ID</span><span>{{ezy_parts_account.username}}</span></div><div><span class="label-name-left">Site Code</span><span>{{ezy_parts_account.password}}</span></div><div><span class="label-name-left">Automatically Save Parts To Inventory</span><span>{{ezy_parts_account.store_parts | yes_no}}</span></div></div><div class="row-fluid"><div class="pull-right"><a href="https://www.youtube.com/embed/jT9Vu5P1x7I?vq=hd1080&amp;autoplay=1" target="_blank">How does it works?</a></div></div><div class="editing-item" ng-show="ezy_parts_account.editing"><form class="form-horizontal"><div class="sub-header">Authentication</div><div class="well bold">Authenication Code and Terminal ID are required</div><div class="control-group"><label class="control-label">Site Code</label><div class="controls"><input ng-model="ezy_parts_account.editing.password" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal ID</label><div class="controls"><input ng-model="ezy_parts_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Enable</label><div class="controls"><input ng-model="ezy_parts_account.editing.active" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Automatically Save Parts To Inventory</label><div class="controls"><input ng-model="ezy_parts_account.editing.store_parts" type="checkbox" /></div></div><div class="control-group" ng-show="ezy_parts_account.editing.store_parts"><label class="control-label">Automatically Set the Part Category To</label><div class="controls"><div ad-stock-category-selection="" ng-model="ezy_parts_account.editing.stock_category_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(ezy_parts_account)">Save</button><button class="btn" ng-click="cancel(ezy_parts_account)">Cancel</button></div></div></form></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/supplier/index.html",'<div ng-controller="RepcoIntegrationController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span2"><ul class="nav nav-list side-nav" ng-controller="IntegrationsNavController"><li class="{{isActive(&#39;Accounting Integration&#39;)}}"><a href="#/integrations/accounting">Accounting Integration</a></li><li class="{{isActive(&#39;Supplier Integration&#39;)}}"><a href="#/integrations/supplier">Supplier Integration</a></li><li class="{{isActive(&#39;Marketing Integration&#39;)}}"><a href="#/integrations/marketing">Marketing Integration</a></li><li class="{{isActive(&#39;EFTPOS Integration&#39;)}}"><a href="#/integrations/eftpos">EFTPOS Integration</a></li><li class="{{isActive(&#39;Vehicle Look Up Integration&#39;)}}"><a href="#/integrations/vehiclelookup">Vehicle Look Up Integration</a></li><li class="{{isActive(&#39;Trade Memberships&#39;)}}"><a href="#/integrations/royalty">Royalty Program Integrations</a></li><li class="{{isActive(&#39;Vehicle Visual&#39;)}}"><a href="#/integrations/vehicle_visual">Vehicle Visual Integration</a></li></ul></div><div class="column span10"><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="setup_repco_inventory(pro_link_account)" ng-show="pro_link_account.id">Add Parts From Covs</button><button class="btn" ng-click="setup_repco_inventory(repco_account)" ng-show="repco_account.id">Add Parts From Repco</button><button class="btn" ng-click="setup_repco_inventory(quantum_account)" ng-show="quantum_account.id">Add Parts From Ashdown Ingram</button></div></div><br /><div class="row-fluid"><div class="column span6"><div ng-show="repco_success_message"><div class="label label-success">{{repco_success_message}}</div><br /><br /></div><div class="content-box"><img src="/assets/repco_navigator-8e21ef0b294533a128d4feada69c8241.png" style="height: 20px;" /><div class="pull-right" ng-show="repco_account.id &amp;&amp; repco_account.active"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(repco_account)" ng-hide="repco_account.id || repco_account.editing">Start Integration</button><div class="row-fluid"><div class="pull-right"><a href="https://www.youtube.com/embed/O8SLeEtBJlY?vq=hd1080&amp;autoplay=1" target="_blank">How does it works?</a></div></div><div class="editable" ng-click="edit_accounting_integration(repco_account)" ng-show="repco_account.id &amp;&amp; !repco_account.editing"><div><span class="label-name-left">Account Number</span><span>{{repco_account.account_number}}</span></div><div><span class="label-name-left">Account Suffix</span><span>{{repco_account.account_suffix}}</span></div><div><span class="label-name-left">Account Company</span><span>{{repco_account.account_company}}</span></div><div><span class="label-name-left">Account Division</span><span>{{repco_account.account_division}}</span></div><div><span class="label-name-left">Automatically Save Parts To Inventory</span><span>{{repco_account.store_parts | yes_no}}</span></div></div><div class="editing-item" ng-show="repco_account.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Account Number</label><div class="controls"><input ng-model="repco_account.editing.account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Account Suffix</label><div class="controls"><input ng-model="repco_account.editing.account_suffix" type="text" /></div></div><div class="control-group"><label class="control-label">Account Company</label><div class="controls"><input ng-model="repco_account.editing.account_company" type="text" /></div></div><div class="control-group"><label class="control-label">Account Division</label><div class="controls"><input ng-model="repco_account.editing.account_division" type="text" /></div></div><div class="sub-header">Authentication</div><div class="well">Site code, username and password are optional, if not given, you will be prompt to authenticate everytime we connect to Supplier system</div><div class="control-group"><label class="control-label">Site Code</label><div class="controls"><input ng-model="repco_account.editing.site_code" type="text" /></div></div><div class="control-group"><label class="control-label">Username</label><div class="controls"><input ng-model="repco_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Password</label><div class="controls"><input ng-model="repco_account.editing.password" type="password" /></div></div><div class="control-group"><label class="control-label">Enable</label><div class="controls"><input ng-model="repco_account.editing.active" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Automatically Save Parts To Inventory</label><div class="controls"><input ng-model="repco_account.editing.store_parts" type="checkbox" /></div></div><div class="control-group" ng-show="repco_account.editing.store_parts"><label class="control-label">Automatically Set the Part Category To</label><div class="controls"><div ad-stock-category-selection="" ng-model="repco_account.editing.stock_category_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(repco_account)">Save</button><button class="btn" ng-click="cancel(repco_account)">Cancel</button></div></div></form></div></div><div ng-show="repco_success_message"><div class="label label-success">{{repco_success_message}}</div><br /><br /></div><div class="content-box"><img src="/assets/quantum_pro-5e21beca4f69abf19b557f26df4871f2.png" style="height: 20px;" /><div class="pull-right" ng-show="quantum_account.id &amp;&amp; quantum_account.active"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(quantum_account)" ng-hide="quantum_account.id || quantum_account.editing">Start Integration</button><div class="row-fluid"><div class="pull-right"><a href="https://www.youtube.com/embed/O8SLeEtBJlY?vq=hd1080&amp;autoplay=1" target="_blank">How does it works?</a></div></div><div class="editable" ng-click="edit_accounting_integration(quantum_account)" ng-show="quantum_account.id &amp;&amp; !quantum_account.editing"><div><span class="label-name-left">Account Number</span><span>{{quantum_account.account_number}}</span></div><div><span class="label-name-left">Account Suffix</span><span>{{quantum_account.account_suffix}}</span></div><div><span class="label-name-left">Account Company</span><span>{{quantum_account.account_company}}</span></div><div><span class="label-name-left">Account Division</span><span>{{quantum_account.account_division}}</span></div><div><span class="label-name-left">Automatically Save Parts To Inventory</span><span>{{quantum_account.store_parts | yes_no}}</span></div></div><div class="editing-item" ng-show="quantum_account.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Account Number</label><div class="controls"><input ng-model="quantum_account.editing.account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Account Suffix</label><div class="controls"><input ng-model="quantum_account.editing.account_suffix" type="text" /></div></div><div class="control-group"><label class="control-label">Account Company</label><div class="controls"><input ng-model="quantum_account.editing.account_company" type="text" /></div></div><div class="control-group"><label class="control-label">Account Division</label><div class="controls"><input ng-model="quantum_account.editing.account_division" type="text" /></div></div><div class="sub-header">Authentication</div><div class="well">Site code, username and password are optional, if not given, you will be prompt to authenticate everytime we connect to Supplier system</div><div class="control-group"><label class="control-label">Site Code</label><div class="controls"><input ng-model="quantum_account.editing.site_code" type="text" /></div></div><div class="control-group"><label class="control-label">Username</label><div class="controls"><input ng-model="quantum_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Password</label><div class="controls"><input ng-model="quantum_account.editing.password" type="password" /></div></div><div class="control-group"><label class="control-label">Enable</label><div class="controls"><input ng-model="quantum_account.editing.active" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Automatically Save Parts To Inventory</label><div class="controls"><input ng-model="quantum_account.editing.store_parts" type="checkbox" /></div></div><div class="control-group" ng-show="quantum_account.editing.store_parts"><label class="control-label">Automatically Set the Part Category To</label><div class="controls"><div ad-stock-category-selection="" ng-model="quantum_account.editing.stock_category_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(quantum_account)">Save</button><button class="btn" ng-click="cancel(quantum_account)">Cancel</button></div></div></form></div></div><div ng-show="repco_success_message"><div class="label label-success">{{repco_success_message}}</div><br /><br /></div><div class="content-box"><img src="/assets/pro_link-ed0e9bca251211f98062a43051fa0baf.png" style="height: 25px;" /><div class="pull-right" ng-show="pro_link_account.id &amp;&amp; pro_link_account.active"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(pro_link_account)" ng-hide="pro_link_account.id || pro_link_account.editing">Start Integration</button><div class="row-fluid"><div class="pull-right"><a href="https://www.youtube.com/embed/O8SLeEtBJlY?vq=hd1080&amp;autoplay=1" target="_blank">How does it works?</a></div></div><div class="editable" ng-click="edit_accounting_integration(pro_link_account)" ng-show="pro_link_account.id &amp;&amp; !pro_link_account.editing"><div><span class="label-name-left">Account Number</span><span>{{pro_link_account.account_number}}</span></div><div><span class="label-name-left">Account Suffix</span><span>{{pro_link_account.account_suffix}}</span></div><div><span class="label-name-left">Account Company</span><span>{{pro_link_account.account_company}}</span></div><div><span class="label-name-left">Account Division</span><span>{{pro_link_account.account_division}}</span></div><div><span class="label-name-left">Automatically Save Parts To Inventory</span><span>{{pro_link_account.store_parts | yes_no}}</span></div></div><div class="editing-item" ng-show="pro_link_account.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Account Number</label><div class="controls"><input ng-model="pro_link_account.editing.account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Account Suffix</label><div class="controls"><input ng-model="pro_link_account.editing.account_suffix" type="text" /></div></div><div class="control-group"><label class="control-label">Account Company</label><div class="controls"><input ng-model="pro_link_account.editing.account_company" type="text" /></div></div><div class="control-group"><label class="control-label">Account Division</label><div class="controls"><input ng-model="pro_link_account.editing.account_division" type="text" /></div></div><div class="sub-header">Authentication</div><div class="well">Site code, username and password are optional, if not given, you will be prompt to authenticate everytime we connect to Supplier system</div><div class="control-group"><label class="control-label">Site Code</label><div class="controls"><input ng-model="pro_link_account.editing.site_code" type="text" /></div></div><div class="control-group"><label class="control-label">Username</label><div class="controls"><input ng-model="pro_link_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Password</label><div class="controls"><input ng-model="pro_link_account.editing.password" type="password" /></div></div><div class="control-group"><label class="control-label">Enable</label><div class="controls"><input ng-model="pro_link_account.editing.active" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Automatically Save Parts To Inventory</label><div class="controls"><input ng-model="pro_link_account.editing.store_parts" type="checkbox" /></div></div><div class="control-group" ng-show="pro_link_account.editing.store_parts"><label class="control-label">Automatically Set the Part Category To</label><div class="controls"><div ad-stock-category-selection="" ng-model="pro_link_account.editing.stock_category_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(pro_link_account)">Save</button><button class="btn" ng-click="cancel(pro_link_account)">Cancel</button></div></div></form></div></div></div><div class="column span6"><div class="content-box"><img src="/assets/burson_ezy_parts-c30f833eeb9ad9ec26fdcc4747ec3dd4.png" style="height: 25px;" /><div class="pull-right" ng-show="ezy_parts_account.id &amp;&amp; ezy_parts_account.active"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(ezy_parts_account)" ng-hide="ezy_parts_account.id || ezy_parts_account.editing">Start Integration</button><div class="editable" ng-click="edit_accounting_integration(ezy_parts_account)" ng-show="ezy_parts_account.id &amp;&amp; !ezy_parts_account.editing"><div><span class="label-name-left">Terminal ID</span><span>{{ezy_parts_account.username}}</span></div><div><span class="label-name-left">Site Code</span><span>{{ezy_parts_account.password}}</span></div><div><span class="label-name-left">Automatically Save Parts To Inventory</span><span>{{ezy_parts_account.store_parts | yes_no}}</span></div></div><div class="row-fluid"><div class="pull-right"><a href="https://www.youtube.com/embed/jT9Vu5P1x7I?vq=hd1080&amp;autoplay=1" target="_blank">How does it works?</a></div></div><div class="editing-item" ng-show="ezy_parts_account.editing"><form class="form-horizontal"><div class="sub-header">Authentication</div><div class="well bold">Authenication Code and Terminal ID are required</div><div class="control-group"><label class="control-label">Site Code</label><div class="controls"><input ng-model="ezy_parts_account.editing.password" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal ID</label><div class="controls"><input ng-model="ezy_parts_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Enable</label><div class="controls"><input ng-model="ezy_parts_account.editing.active" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Automatically Save Parts To Inventory</label><div class="controls"><input ng-model="ezy_parts_account.editing.store_parts" type="checkbox" /></div></div><div class="control-group" ng-show="ezy_parts_account.editing.store_parts"><label class="control-label">Automatically Set the Part Category To</label><div class="controls"><div ad-stock-category-selection="" ng-model="ezy_parts_account.editing.stock_category_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(ezy_parts_account)">Save</button><button class="btn" ng-click="cancel(ezy_parts_account)">Cancel</button></div></div></form></div></div><div class="content-box"><img src="/assets/autopro-53633ab840f227c7debd83dc4cab9de3.png" style="height: 25px;" /><div class="pull-right" ng-show="autopro_account.id &amp;&amp; autopro_account.active"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(autopro_account)" ng-hide="autopro_account.id || autopro_account.editing">Start Integration</button><div class="editable" ng-click="edit_accounting_integration(autopro_account)" ng-show="autopro_account.id &amp;&amp; !autopro_account.editing"><div><span class="label-name-left">Terminal ID</span><span>{{autopro_account.username}}</span></div><div><span class="label-name-left">Site Code</span><span>{{autopro_account.password}}</span></div><div><span class="label-name-left">Automatically Save Parts To Inventory</span><span>{{autopro_account.store_parts | yes_no}}</span></div></div><div class="row-fluid"><div class="pull-right"><a href="https://www.youtube.com/embed/jT9Vu5P1x7I?vq=hd1080&amp;autoplay=1" target="_blank">How does it works?</a></div></div><div class="editing-item" ng-show="autopro_account.editing"><form class="form-horizontal"><div class="sub-header">Authentication</div><div class="well bold">Authenication Code and Terminal ID are required</div><div class="control-group"><label class="control-label">Site Code</label><div class="controls"><input ng-model="autopro_account.editing.password" type="text" /></div></div><div class="control-group"><label class="control-label">Terminal ID</label><div class="controls"><input ng-model="autopro_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Enable</label><div class="controls"><input ng-model="autopro_account.editing.active" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Automatically Save Parts To Inventory</label><div class="controls"><input ng-model="autopro_account.editing.store_parts" type="checkbox" /></div></div><div class="control-group" ng-show="autopro_account.editing.store_parts"><label class="control-label">Automatically Set the Part Category To</label><div class="controls"><div ad-stock-category-selection="" ng-model="autopro_account.editing.stock_category_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(autopro_account)">Save</button><button class="btn" ng-click="cancel(autopro_account)">Cancel</button></div></div></form></div></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/supplier/motospecs.html",'<div ng-show="repco_success_message"><div class="label label-success">{{repco_success_message}}</div><br /><br /></div><div class="content-box"><img src="/assets/motospecs-a9a4edc7104b920de0eeb485620ff60b.jpg" style="height: 45px;" /><div class="pull-right" ng-show="motospecs_account.id &amp;&amp; motospecs_account.active"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(motospecs_account)" ng-hide="motospecs_account.id || motospecs_account.editing">Start Integration</button><div class="row-fluid"><div class="pull-right"><a href="https://www.youtube.com/embed/O8SLeEtBJlY?vq=hd1080&amp;autoplay=1" target="_blank">How does it works?</a></div></div><div class="editable" ng-click="edit_accounting_integration(motospecs_account)" ng-show="motospecs_account.id &amp;&amp; !motospecs_account.editing"><div><span class="label-name-left">Account Number</span><span>{{motospecs_account.account_number}}</span></div><div><span class="label-name-left">Account Suffix</span><span>{{motospecs_account.account_suffix}}</span></div><div><span class="label-name-left">Account Company</span><span>{{motospecs_account.account_company}}</span></div><div><span class="label-name-left">Account Division</span><span>{{motospecs_account.account_division}}</span></div><div><span class="label-name-left">Automatically Save Parts To Inventory</span><span>{{motospecs_account.store_parts | yes_no}}</span></div></div><div class="editing-item" ng-show="motospecs_account.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Account Number</label><div class="controls"><input ng-model="motospecs_account.editing.account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Account Suffix</label><div class="controls"><input ng-model="motospecs_account.editing.account_suffix" type="text" /></div></div><div class="control-group"><label class="control-label">Account Company</label><div class="controls"><input ng-model="motospecs_account.editing.account_company" type="text" /></div></div><div class="control-group"><label class="control-label">Account Division</label><div class="controls"><input ng-model="motospecs_account.editing.account_division" type="text" /></div></div><div class="sub-header">Authentication</div><div class="well">Site code, username and password are optional, if not given, you will be prompt to authenticate everytime we connect to Supplier system</div><div class="control-group"><label class="control-label">Site Code</label><div class="controls"><input ng-model="motospecs_account.editing.site_code" type="text" /></div></div><div class="control-group"><label class="control-label">Username</label><div class="controls"><input ng-model="motospecs_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Password</label><div class="controls"><input ng-model="motospecs_account.editing.password" type="password" /></div></div><div class="control-group"><label class="control-label">Enable</label><div class="controls"><input ng-model="motospecs_account.editing.active" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Automatically Save Parts To Inventory</label><div class="controls"><input ng-model="motospecs_account.editing.store_parts" type="checkbox" /></div></div><div class="control-group" ng-show="motospecs_account.editing.store_parts"><label class="control-label">Automatically Set the Part Category To</label><div class="controls"><div ad-stock-category-selection="" ng-model="motospecs_account.editing.stock_category_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(motospecs_account)">Save</button><button class="btn" ng-click="cancel(motospecs_account)">Cancel</button></div></div></form></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/supplier/pro_link.html",'<div ng-show="repco_success_message"><div class="label label-success">{{repco_success_message}}</div><br /><br /></div><div class="content-box"><img src="/assets/pro_link-ed0e9bca251211f98062a43051fa0baf.png" style="height: 25px;" /><div class="pull-right" ng-show="pro_link_account.id &amp;&amp; pro_link_account.active"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(pro_link_account)" ng-hide="pro_link_account.id || pro_link_account.editing">Start Integration</button><div class="row-fluid"><div class="pull-right"><a href="https://www.youtube.com/embed/O8SLeEtBJlY?vq=hd1080&amp;autoplay=1" target="_blank">How does it works?</a></div></div><div class="editable" ng-click="edit_accounting_integration(pro_link_account)" ng-show="pro_link_account.id &amp;&amp; !pro_link_account.editing"><div><span class="label-name-left">Account Number</span><span>{{pro_link_account.account_number}}</span></div><div><span class="label-name-left">Account Suffix</span><span>{{pro_link_account.account_suffix}}</span></div><div><span class="label-name-left">Account Company</span><span>{{pro_link_account.account_company}}</span></div><div><span class="label-name-left">Account Division</span><span>{{pro_link_account.account_division}}</span></div><div><span class="label-name-left">Automatically Save Parts To Inventory</span><span>{{pro_link_account.store_parts | yes_no}}</span></div></div><div class="editing-item" ng-show="pro_link_account.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Account Number</label><div class="controls"><input ng-model="pro_link_account.editing.account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Account Suffix</label><div class="controls"><input ng-model="pro_link_account.editing.account_suffix" type="text" /></div></div><div class="control-group"><label class="control-label">Account Company</label><div class="controls"><input ng-model="pro_link_account.editing.account_company" type="text" /></div></div><div class="control-group"><label class="control-label">Account Division</label><div class="controls"><input ng-model="pro_link_account.editing.account_division" type="text" /></div></div><div class="sub-header">Authentication</div><div class="well">Site code, username and password are optional, if not given, you will be prompt to authenticate everytime we connect to Supplier system</div><div class="control-group"><label class="control-label">Site Code</label><div class="controls"><input ng-model="pro_link_account.editing.site_code" type="text" /></div></div><div class="control-group"><label class="control-label">Username</label><div class="controls"><input ng-model="pro_link_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Password</label><div class="controls"><input ng-model="pro_link_account.editing.password" type="password" /></div></div><div class="control-group"><label class="control-label">Enable</label><div class="controls"><input ng-model="pro_link_account.editing.active" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Automatically Save Parts To Inventory</label><div class="controls"><input ng-model="pro_link_account.editing.store_parts" type="checkbox" /></div></div><div class="control-group" ng-show="pro_link_account.editing.store_parts"><label class="control-label">Automatically Set the Part Category To</label><div class="controls"><div ad-stock-category-selection="" ng-model="pro_link_account.editing.stock_category_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(pro_link_account)">Save</button><button class="btn" ng-click="cancel(pro_link_account)">Cancel</button></div></div></form></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/supplier/quantum.html",'<div ng-show="repco_success_message"><div class="label label-success">{{repco_success_message}}</div><br /><br /></div><div class="content-box"><img src="/assets/quantum_pro-5e21beca4f69abf19b557f26df4871f2.png" style="height: 20px;" /><div class="pull-right" ng-show="quantum_account.id &amp;&amp; quantum_account.active"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(quantum_account)" ng-hide="quantum_account.id || quantum_account.editing">Start Integration</button><div class="row-fluid"><div class="pull-right"><a href="https://www.youtube.com/embed/O8SLeEtBJlY?vq=hd1080&amp;autoplay=1" target="_blank">How does it works?</a></div></div><div class="editable" ng-click="edit_accounting_integration(quantum_account)" ng-show="quantum_account.id &amp;&amp; !quantum_account.editing"><div><span class="label-name-left">Account Number</span><span>{{quantum_account.account_number}}</span></div><div><span class="label-name-left">Account Suffix</span><span>{{quantum_account.account_suffix}}</span></div><div><span class="label-name-left">Account Company</span><span>{{quantum_account.account_company}}</span></div><div><span class="label-name-left">Account Division</span><span>{{quantum_account.account_division}}</span></div><div><span class="label-name-left">Automatically Save Parts To Inventory</span><span>{{quantum_account.store_parts | yes_no}}</span></div></div><div class="editing-item" ng-show="quantum_account.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Account Number</label><div class="controls"><input ng-model="quantum_account.editing.account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Account Suffix</label><div class="controls"><input ng-model="quantum_account.editing.account_suffix" type="text" /></div></div><div class="control-group"><label class="control-label">Account Company</label><div class="controls"><input ng-model="quantum_account.editing.account_company" type="text" /></div></div><div class="control-group"><label class="control-label">Account Division</label><div class="controls"><input ng-model="quantum_account.editing.account_division" type="text" /></div></div><div class="sub-header">Authentication</div><div class="well">Site code, username and password are optional, if not given, you will be prompt to authenticate everytime we connect to Supplier system</div><div class="control-group"><label class="control-label">Site Code</label><div class="controls"><input ng-model="quantum_account.editing.site_code" type="text" /></div></div><div class="control-group"><label class="control-label">Username</label><div class="controls"><input ng-model="quantum_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Password</label><div class="controls"><input ng-model="quantum_account.editing.password" type="password" /></div></div><div class="control-group"><label class="control-label">Enable</label><div class="controls"><input ng-model="quantum_account.editing.active" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Automatically Save Parts To Inventory</label><div class="controls"><input ng-model="quantum_account.editing.store_parts" type="checkbox" /></div></div><div class="control-group" ng-show="quantum_account.editing.store_parts"><label class="control-label">Automatically Set the Part Category To</label><div class="controls"><div ad-stock-category-selection="" ng-model="quantum_account.editing.stock_category_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(quantum_account)">Save</button><button class="btn" ng-click="cancel(quantum_account)">Cancel</button></div></div></form></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/supplier/repco.html",'<div ng-show="repco_success_message"><div class="label label-success">{{repco_success_message}}</div><br /><br /></div><div class="content-box"><img src="/assets/repco_navigator-8e21ef0b294533a128d4feada69c8241.png" style="height: 20px;" /><div class="pull-right" ng-show="repco_account.id &amp;&amp; repco_account.active"><label class="label label-success">Enabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(repco_account)" ng-hide="repco_account.id || repco_account.editing">Start Integration</button><div class="row-fluid"><div class="pull-right"><a href="https://www.youtube.com/embed/O8SLeEtBJlY?vq=hd1080&amp;autoplay=1" target="_blank">How does it works?</a></div></div><div class="editable" ng-click="edit_accounting_integration(repco_account)" ng-show="repco_account.id &amp;&amp; !repco_account.editing"><div><span class="label-name-left">Account Number</span><span>{{repco_account.account_number}}</span></div><div><span class="label-name-left">Account Suffix</span><span>{{repco_account.account_suffix}}</span></div><div><span class="label-name-left">Account Company</span><span>{{repco_account.account_company}}</span></div><div><span class="label-name-left">Account Division</span><span>{{repco_account.account_division}}</span></div><div><span class="label-name-left">Automatically Save Parts To Inventory</span><span>{{repco_account.store_parts | yes_no}}</span></div></div><div class="editing-item" ng-show="repco_account.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Account Number</label><div class="controls"><input ng-model="repco_account.editing.account_number" type="text" /></div></div><div class="control-group"><label class="control-label">Account Suffix</label><div class="controls"><input ng-model="repco_account.editing.account_suffix" type="text" /></div></div><div class="control-group"><label class="control-label">Account Company</label><div class="controls"><input ng-model="repco_account.editing.account_company" type="text" /></div></div><div class="control-group"><label class="control-label">Account Division</label><div class="controls"><input ng-model="repco_account.editing.account_division" type="text" /></div></div><div class="sub-header">Authentication</div><div class="well">Site code, username and password are optional, if not given, you will be prompt to authenticate everytime we connect to Supplier system</div><div class="control-group"><label class="control-label">Site Code</label><div class="controls"><input ng-model="repco_account.editing.site_code" type="text" /></div></div><div class="control-group"><label class="control-label">Username</label><div class="controls"><input ng-model="repco_account.editing.username" type="text" /></div></div><div class="control-group"><label class="control-label">Password</label><div class="controls"><input ng-model="repco_account.editing.password" type="password" /></div></div><div class="control-group"><label class="control-label">Enable</label><div class="controls"><input ng-model="repco_account.editing.active" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Automatically Save Parts To Inventory</label><div class="controls"><input ng-model="repco_account.editing.store_parts" type="checkbox" /></div></div><div class="control-group" ng-show="repco_account.editing.store_parts"><label class="control-label">Automatically Set the Part Category To</label><div class="controls"><div ad-stock-category-selection="" ng-model="repco_account.editing.stock_category_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(repco_account)">Save</button><button class="btn" ng-click="cancel(repco_account)">Cancel</button></div></div></form></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/vehicle_visual/index.html",'<div ng-controller="VehicleVisualIntegrationController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span2"><ul class="nav nav-list side-nav" ng-controller="IntegrationsNavController"><li class="{{isActive(&#39;Accounting Integration&#39;)}}"><a href="#/integrations/accounting">Accounting Integration</a></li><li class="{{isActive(&#39;Supplier Integration&#39;)}}"><a href="#/integrations/supplier">Supplier Integration</a></li><li class="{{isActive(&#39;Marketing Integration&#39;)}}"><a href="#/integrations/marketing">Marketing Integration</a></li><li class="{{isActive(&#39;EFTPOS Integration&#39;)}}"><a href="#/integrations/eftpos">EFTPOS Integration</a></li><li class="{{isActive(&#39;Vehicle Look Up Integration&#39;)}}"><a href="#/integrations/vehiclelookup">Vehicle Look Up Integration</a></li><li class="{{isActive(&#39;Trade Memberships&#39;)}}"><a href="#/integrations/royalty">Royalty Program Integrations</a></li><li class="{{isActive(&#39;Vehicle Visual&#39;)}}"><a href="#/integrations/vehicle_visual">Vehicle Visual Integration</a></li></ul></div><div class="column span10"><div class="row-fluid"><div class="column span6"><div class="content-box" id="vehicle-visual-setup"><img src="/assets/vehicle_visual-fbebdc06aa795051e21b8909451845a6.png" style="height: 60px;" /><div class="pull-right" ng-show="vehicle_visual_account.id"><label class="label label-success" ng-show="vehicle_visual_account.enabled">Enabled</label><label class="label" ng-hide="vehicle_visual_account.enabled">Disabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(vehicle_visual_account)" ng-hide="vehicle_visual_account.id || vehicle_visual_account.editing">Start Integration</button><button class="btn btn-link" ng-click="edit_account(vehicle_visual_account)" ng-show="vehicle_visual_account.id &amp;&amp; !vehicle_visual_account.editing">Edit</button><div class="editing-item" ng-show="vehicle_visual_account.editing"><form class="form form-horizontal"><div class="control-group"><label class="control-label">API Key</label><div class="controls"><div ng-show="!show_api_input &amp;&amp; !account.api_key"><span>Do you have a Vehicle Visual account? &nbsp;</span><button class="btn-link" ng-click="show_api_input=true">Yes</button><a class="btn btn-link" ng-click="set_scope()" ng-href="/vehicle_visual_integration_accounts/{{vehicle_visual_account.id}}/sign_up" target="_blank"> No, Register for one</a></div><div class="inline" ng-show="show_api_input || vehicle_visual_account.api_key"><div class="row-fluid"><div>Please enter the API Key</div><input class="span12" ng-model="vehicle_visual_account.editing.api_key" type="text" /><a class="btn btn-link" ng-click="set_scope()" ng-hide="vehicle_visual_account.api_key" ng-href="/vehicle_visual_integration_accounts/{{vehicle_visual_account.id}}/sign_up" target="_blank">Register</a><div class="pull-right"><button class="btn btn-link" id="vehicle-visual-api-key-help-button" ng-click="open_vehicle_visual_api_key_popover()">Where to find API key</button></div></div></div></div></div><div class="control-group"><label class="control-label">Enabled</label><div class="controls"><input ng-model="vehicle_visual_account.editing.enabled" type="checkbox" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(vehicle_visual_account)">Save</button><button class="btn" ng-click="cancel(vehicle_visual_account)">Cancel</button></div></div></form></div><div id="vehicle-visual-api-key-popover"><div class="popover fade left in" style="width: 800px;"><div class="popover-title"><div class="pull-right"><button class="btn btn-primary" ng-click="close_vehicle_visual_api_key_popover()">Close</button></div><div class="sub-header">Where to find API key?</div></div><div class="popover-content"><div class="row-fluid" ng-show="vehicle_visual_account.editing.third_party == &#39;vehicle_visual&#39;"><div>Please find your API Key from the screenshot below.</div><img src="/assets/vehicle_visual_help-cedb4e7039ce3608c52b4de3b4f4fb04.png" /></div></div></div></div></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/vehicle_visual/vehicle_visual.html",'<div class="content-box" id="vehicle-visual-setup"><img src="/assets/vehicle_visual-fbebdc06aa795051e21b8909451845a6.png" style="height: 60px;" /><div class="pull-right" ng-show="vehicle_visual_account.id"><label class="label label-success" ng-show="vehicle_visual_account.enabled">Enabled</label><label class="label" ng-hide="vehicle_visual_account.enabled">Disabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(vehicle_visual_account)" ng-hide="vehicle_visual_account.id || vehicle_visual_account.editing">Start Integration</button><button class="btn btn-link" ng-click="edit_account(vehicle_visual_account)" ng-show="vehicle_visual_account.id &amp;&amp; !vehicle_visual_account.editing">Edit</button><div class="editing-item" ng-show="vehicle_visual_account.editing"><form class="form form-horizontal"><div class="control-group"><label class="control-label">API Key</label><div class="controls"><div ng-show="!show_api_input &amp;&amp; !account.api_key"><span>Do you have a Vehicle Visual account? &nbsp;</span><button class="btn-link" ng-click="show_api_input=true">Yes</button><a class="btn btn-link" ng-click="set_scope()" ng-href="/vehicle_visual_integration_accounts/{{vehicle_visual_account.id}}/sign_up" target="_blank"> No, Register for one</a></div><div class="inline" ng-show="show_api_input || vehicle_visual_account.api_key"><div class="row-fluid"><div>Please enter the API Key</div><input class="span12" ng-model="vehicle_visual_account.editing.api_key" type="text" /><a class="btn btn-link" ng-click="set_scope()" ng-hide="vehicle_visual_account.api_key" ng-href="/vehicle_visual_integration_accounts/{{vehicle_visual_account.id}}/sign_up" target="_blank">Register</a><div class="pull-right"><button class="btn btn-link" id="vehicle-visual-api-key-help-button" ng-click="open_vehicle_visual_api_key_popover()">Where to find API key</button></div></div></div></div></div><div class="control-group"><label class="control-label">Enabled</label><div class="controls"><input ng-model="vehicle_visual_account.editing.enabled" type="checkbox" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(vehicle_visual_account)">Save</button><button class="btn" ng-click="cancel(vehicle_visual_account)">Cancel</button></div></div></form></div><div id="vehicle-visual-api-key-popover"><div class="popover fade left in" style="width: 800px;"><div class="popover-title"><div class="pull-right"><button class="btn btn-primary" ng-click="close_vehicle_visual_api_key_popover()">Close</button></div><div class="sub-header">Where to find API key?</div></div><div class="popover-content"><div class="row-fluid" ng-show="vehicle_visual_account.editing.third_party == &#39;vehicle_visual&#39;"><div>Please find your API Key from the screenshot below.</div><img src="/assets/vehicle_visual_help-cedb4e7039ce3608c52b4de3b4f4fb04.png" /></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/vehiclelookup/carjam.html",'<div class="content-box"><div class="row-fluid"><div class="column span2"><img src="/carjam.png" style="height: 50px; vertical-align: top;" /></div><div class="column span8"><div>(Only Available in New Zealand)</div><div>All costs payable directly to Carjam.</div><div>For pricings information, please contact Carjam</div></div><div class="column span2"><div class="pull-right" ng-show="carjam_account.id"><label class="label label-success" ng-show="carjam_account.enabled">Enabled</label><label class="label" ng-hide="carjam_account.enabled">Disabled</label></div><div class="pull-right" ng-show="carjam_account.from_cache"><label class="label label-warning" style="margin-right: 5px;">From Cache</label></div></div></div><button class="btn btn-link" ng-click="start_integration(carjam_account)" ng-hide="carjam_account.id || carjam_account.editing">Start Integration</button><a href="javascript:void(0)" ng-click="edit_account(carjam_account)" ng-show="carjam_account.id &amp;&amp; !carjam_account.editing">Edit settings</a><div class="editing-item" ng-show="carjam_account.editing"><form class="form-horizontal"><div ng-show="carjam_account.api_key" style="width: 100%; text-align: center;"><span>API key configured</span> <a href="javascript:void(0)" ng-click="enter_api_key=true">Edit</a></div><div>&nbsp;</div><div class="control-group" ng-hide="carjam_account.api_key &amp;&amp; !enter_api_key"><label class="control-label">API key</label><div class="controls"><button class="btn btn-success" id="carjam-api-key-help-button" ng-click="get_api_key(carjam_account)">Register for API key</button><span>&nbsp; OR &nbsp;</span><a href="javascript:void(0);" ng-click="enter_api_key=true">Enter One</a><div class="pull-right"><span>&nbsp;</span><a href="javascript:void(0)" ng-click="open_carjam_api_key_popover()" stlye="margin-left: 5px;">What is this?</a></div><div ng-show="enter_api_key" style="margin-top: 10px"><input class="input input-large" ng-model="carjam_account.editing.api_key" type="text" /></div></div></div><div class="control-group"><label class="control-label">Enabled</label><div class="controls"><input ng-model="carjam_account.editing.enabled" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Use CarJam cache (default off)</label><div class="controls"><input ng-model="carjam_account.editing.from_cache" type="checkbox" /></div></div><div class="control-group" ng-show="carjam_account.id &amp;&amp; carjam_account.enabled"><label class="control-label">Server availability</label><div class="controls"><br /><div class="container-fluid"><div class="row-fluid"><div class="column span6"><div>All Servers</div></div><div class="column span6"><div>{{carjam_all_availability}}</div></div></div><div class="row-fluid"><div class="column span6"><div>CarJam Server</div></div><div class="column span6"><div>{{carjam_carjam_availability}}</div></div></div><div class="row-fluid"><div class="column span6"><div>MVR Server </div></div><div class="column span6"><div>{{carjam_mvr_availability}}</div></div></div><div class="row-fluid"><div class="column span6"><div>PPSR Server </div></div><div class="column span6"><div>{{carjam_ppsr_availability}}</div></div></div><div class="row-fluid"><a href="javascript:void(0)" ng-click="check_carjam_availability()">Check</a></div><br /></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(carjam_account)">Save</button><button class="btn" ng-click="cancel(carjam_account)">Cancel</button></div></div></form></div><div id="carjam-api-key-popover"><div class="popover fade left in" style="width: 800px;"><div class="popover-title"><div class="pull-right"><button class="btn btn-primary" ng-click="close_carjam_api_key_popover()">Close</button></div><div class="sub-header">Where to find API key?</div></div><div class="popover-content"><div class="row-fluid" ng-show="carjam_account.editing.third_party == &#39;carjam&#39;"><div class="content-box"><div class="sub-header">If you do not have a Carjam Account?</div><span>Click on "Register for API key" to initiate the CarJam Integration Registration process. At the end, the CarJam API key will be automatically configured for your account. Please make sure the browser allows pop ups for MechanicDesk.</span><br /><br /><br /><div class="sub-header">If you already have a Carjam Account?</div><div>Please find your API Key from the screenshot below. Then click on "Enter One" and key in the API Key then save.</div><img src="/assets/carjam-417c6a4060f52fade21938f00e1fb369.jpg" /></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/vehiclelookup/index.html",'<div ng-controller="VehicleLookUpIntegrationController"><ul class="sub-nav" ng-controller="AdministrationNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span2"><ul class="nav nav-list side-nav" ng-controller="IntegrationsNavController"><li class="{{isActive(&#39;Accounting Integration&#39;)}}"><a href="#/integrations/accounting">Accounting Integration</a></li><li class="{{isActive(&#39;Supplier Integration&#39;)}}"><a href="#/integrations/supplier">Supplier Integration</a></li><li class="{{isActive(&#39;Marketing Integration&#39;)}}"><a href="#/integrations/marketing">Marketing Integration</a></li><li class="{{isActive(&#39;EFTPOS Integration&#39;)}}"><a href="#/integrations/eftpos">EFTPOS Integration</a></li><li class="{{isActive(&#39;Vehicle Look Up Integration&#39;)}}"><a href="#/integrations/vehiclelookup">Vehicle Look Up Integration</a></li><li class="{{isActive(&#39;Trade Memberships&#39;)}}"><a href="#/integrations/royalty">Royalty Program Integrations</a></li><li class="{{isActive(&#39;Vehicle Visual&#39;)}}"><a href="#/integrations/vehicle_visual">Vehicle Visual Integration</a></li></ul></div><div class="column span10"><div class="row-fluid"><div class="column span6"><div class="content-box"><div class="row-fluid"><div class="column span2"><img src="/carjam.png" style="height: 50px; vertical-align: top;" /></div><div class="column span8"><div>(Only Available in New Zealand)</div><div>All costs payable directly to Carjam.</div><div>For pricings information, please contact Carjam</div></div><div class="column span2"><div class="pull-right" ng-show="carjam_account.id"><label class="label label-success" ng-show="carjam_account.enabled">Enabled</label><label class="label" ng-hide="carjam_account.enabled">Disabled</label></div><div class="pull-right" ng-show="carjam_account.from_cache"><label class="label label-warning" style="margin-right: 5px;">From Cache</label></div></div></div><button class="btn btn-link" ng-click="start_integration(carjam_account)" ng-hide="carjam_account.id || carjam_account.editing">Start Integration</button><a href="javascript:void(0)" ng-click="edit_account(carjam_account)" ng-show="carjam_account.id &amp;&amp; !carjam_account.editing">Edit settings</a><div class="editing-item" ng-show="carjam_account.editing"><form class="form-horizontal"><div ng-show="carjam_account.api_key" style="width: 100%; text-align: center;"><span>API key configured</span> <a href="javascript:void(0)" ng-click="enter_api_key=true">Edit</a></div><div>&nbsp;</div><div class="control-group" ng-hide="carjam_account.api_key &amp;&amp; !enter_api_key"><label class="control-label">API key</label><div class="controls"><button class="btn btn-success" id="carjam-api-key-help-button" ng-click="get_api_key(carjam_account)">Register for API key</button><span>&nbsp; OR &nbsp;</span><a href="javascript:void(0);" ng-click="enter_api_key=true">Enter One</a><div class="pull-right"><span>&nbsp;</span><a href="javascript:void(0)" ng-click="open_carjam_api_key_popover()" stlye="margin-left: 5px;">What is this?</a></div><div ng-show="enter_api_key" style="margin-top: 10px"><input class="input input-large" ng-model="carjam_account.editing.api_key" type="text" /></div></div></div><div class="control-group"><label class="control-label">Enabled</label><div class="controls"><input ng-model="carjam_account.editing.enabled" type="checkbox" /></div></div><div class="control-group"><label class="control-label">Use CarJam cache (default off)</label><div class="controls"><input ng-model="carjam_account.editing.from_cache" type="checkbox" /></div></div><div class="control-group" ng-show="carjam_account.id &amp;&amp; carjam_account.enabled"><label class="control-label">Server availability</label><div class="controls"><br /><div class="container-fluid"><div class="row-fluid"><div class="column span6"><div>All Servers</div></div><div class="column span6"><div>{{carjam_all_availability}}</div></div></div><div class="row-fluid"><div class="column span6"><div>CarJam Server</div></div><div class="column span6"><div>{{carjam_carjam_availability}}</div></div></div><div class="row-fluid"><div class="column span6"><div>MVR Server </div></div><div class="column span6"><div>{{carjam_mvr_availability}}</div></div></div><div class="row-fluid"><div class="column span6"><div>PPSR Server </div></div><div class="column span6"><div>{{carjam_ppsr_availability}}</div></div></div><div class="row-fluid"><a href="javascript:void(0)" ng-click="check_carjam_availability()">Check</a></div><br /></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(carjam_account)">Save</button><button class="btn" ng-click="cancel(carjam_account)">Cancel</button></div></div></form></div><div id="carjam-api-key-popover"><div class="popover fade left in" style="width: 800px;"><div class="popover-title"><div class="pull-right"><button class="btn btn-primary" ng-click="close_carjam_api_key_popover()">Close</button></div><div class="sub-header">Where to find API key?</div></div><div class="popover-content"><div class="row-fluid" ng-show="carjam_account.editing.third_party == &#39;carjam&#39;"><div class="content-box"><div class="sub-header">If you do not have a Carjam Account?</div><span>Click on "Register for API key" to initiate the CarJam Integration Registration process. At the end, the CarJam API key will be automatically configured for your account. Please make sure the browser allows pop ups for MechanicDesk.</span><br /><br /><br /><div class="sub-header">If you already have a Carjam Account?</div><div>Please find your API Key from the screenshot below. Then click on "Enter One" and key in the API Key then save.</div><img src="/assets/carjam-417c6a4060f52fade21938f00e1fb369.jpg" /></div></div></div></div></div></div></div><div class="column span6"><div class="content-box" id="mycarcheck-setup"><img src="/assets/mycarcheck-90e636a7e44552c63e31fd3b27c0c990.png" style="height: 80px;" /><span>&nbsp; (Only Available in United Kingdom)</span><div class="pull-right" ng-show="mycarcheck_account.id"><label class="label label-success" ng-show="mycarcheck_account.enabled">Enabled</label><label class="label" ng-hide="mycarcheck_account.enabled">Disabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(mycarcheck_account)" ng-hide="mycarcheck_account.id || mycarcheck_account.editing">Start Integration</button><button class="btn btn-link" ng-click="edit_account(mycarcheck_account)" ng-show="mycarcheck_account.id &amp;&amp; !mycarcheck_account.editing">Edit</button><div class="editing-item" ng-show="mycarcheck_account.editing"><form class="form form-horizontal"><div class="control-group"><label class="control-label">Username</label><div class="controls"><input ng-model="mycarcheck_account.editing.username" type="text" /><button class="btn btn-link" ng-click="open_mycarcheck_api_key_popover()">Where to find API username</button></div></div><div class="control-group"><label class="control-label">API Key</label><div class="controls"><input ng-model="mycarcheck_account.editing.api_key" type="text" /><button class="btn btn-link" ng-click="open_mycarcheck_api_key_popover()">Where to find API key</button></div></div><div class="control-group"><label class="control-label">Enabled</label><div class="controls"><input ng-model="mycarcheck_account.editing.enabled" type="checkbox" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(mycarcheck_account)">Save</button><button class="btn" ng-click="cancel(mycarcheck_account)">Cancel</button></div></div></form></div><div id="mycarcheck-api-key-popover"><div class="popover fade left in" style="width: 800px;"><div class="popover-title"><div class="pull-right"><button class="btn btn-primary" ng-click="close_mycarcheck_api_key_popover()">Close</button></div><div class="sub-header">Where to find API username and key?</div></div><div class="popover-content"><div class="row-fluid" ng-show="mycarcheck_account.editing.third_party == &#39;mycarcheck&#39;"><div>Please find your API Key from the screenshot below.</div><img src="/assets/mycarcheck_help-8616bfb9e8160eaca2e1c7c336b24ea3.png" /></div></div></div></div></div></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("integrations/vehiclelookup/mycarcheck.html",'<div class="content-box" id="mycarcheck-setup"><img src="/assets/mycarcheck-90e636a7e44552c63e31fd3b27c0c990.png" style="height: 80px;" /><span>&nbsp; (Only Available in United Kingdom)</span><div class="pull-right" ng-show="mycarcheck_account.id"><label class="label label-success" ng-show="mycarcheck_account.enabled">Enabled</label><label class="label" ng-hide="mycarcheck_account.enabled">Disabled</label></div><br /><br /><button class="btn btn-link" ng-click="start_integration(mycarcheck_account)" ng-hide="mycarcheck_account.id || mycarcheck_account.editing">Start Integration</button><button class="btn btn-link" ng-click="edit_account(mycarcheck_account)" ng-show="mycarcheck_account.id &amp;&amp; !mycarcheck_account.editing">Edit</button><div class="editing-item" ng-show="mycarcheck_account.editing"><form class="form form-horizontal"><div class="control-group"><label class="control-label">Username</label><div class="controls"><input ng-model="mycarcheck_account.editing.username" type="text" /><button class="btn btn-link" ng-click="open_mycarcheck_api_key_popover()">Where to find API username</button></div></div><div class="control-group"><label class="control-label">API Key</label><div class="controls"><input ng-model="mycarcheck_account.editing.api_key" type="text" /><button class="btn btn-link" ng-click="open_mycarcheck_api_key_popover()">Where to find API key</button></div></div><div class="control-group"><label class="control-label">Enabled</label><div class="controls"><input ng-model="mycarcheck_account.editing.enabled" type="checkbox" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save(mycarcheck_account)">Save</button><button class="btn" ng-click="cancel(mycarcheck_account)">Cancel</button></div></div></form></div><div id="mycarcheck-api-key-popover"><div class="popover fade left in" style="width: 800px;"><div class="popover-title"><div class="pull-right"><button class="btn btn-primary" ng-click="close_mycarcheck_api_key_popover()">Close</button></div><div class="sub-header">Where to find API username and key?</div></div><div class="popover-content"><div class="row-fluid" ng-show="mycarcheck_account.editing.third_party == &#39;mycarcheck&#39;"><div>Please find your API Key from the screenshot below.</div><img src="/assets/mycarcheck_help-8616bfb9e8160eaca2e1c7c336b24ea3.png" /></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stock_categories/index.html",'<div ng-controller="StockCategoriesController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">Stock Categories</div><div class="row-fluid"><div class="stock-category new-stock-category"><span ng-click="create_stock_category()" ng-hide="new_stock_category">Click to Create</span><div class="editing" ng-show="new_stock_category"><input id="create-stock-category-name" ng-model="new_stock_category.name" type="text" /><br /><button class="btn btn-success" ng-click="save_new_stock_category()">Save</button><button class="btn" ng-click="cancel_create_stock_category()">Cancel</button></div></div><div class="stock-category" ng-repeat="stock_category in stock_categories"><a ng-href="#/stock_categories/{{stock_category.id}}"><span>{{stock_category.name}}</span></a></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stock_categories/show.html",'<div ng-controller="ShowStockCategoryController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span6"><div class="page-header">{{stock_category.name}}<div class="pull-right"><div ng-show="stock_category.deleted">Deleted</div></div></div></div><div class="column span6"><div class="pull-right"><div ng-hide="stock_category.editing"><a class="btn" ng-href="/stock_categories/{{stock_category.id}}/print.pdf" target="_blank"><i class="icon icon-print"></i><span>Print</span></a><a class="btn" ng-href="/stock_categories/{{stock_category.id}}/download.xls" target="_blank"><i class="icon icon-download"></i><span>Download</span></a><a class="btn btn-primary" ng-href="#/stocks/new?category_id={{stock_category.id}}">New Stock</a><button class="btn" ng-click="edit_stock_category()">Rename</button><button class="btn btn-danger" ng-click="delete_stock_category()" ng-show="!stock_category.deleted">Delete</button></div><div ng-show="stock_category.editing"><form class="form-inline"><input ng-model="stock_category.editing.name" type="text" />&nbsp;<button class="btn btn-success" ng-click="save_stock_category()">Save</button><button class="btn" ng-click="cancel_edit_stock_category()">Cancel</button></form></div></div></div></div><div class="row-fluid"><div ng-show="tags().length &gt; 0 &amp;&amp; !showing_reorder"><select class="inline" ng-change="fetch_stocks()" ng-model="tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div><br /><div ng-show="stocks.length == 0"><span>No Stock</span></div><div ng-hide="stocks.length == 0"><div ng-show="total_pages &gt; 1"><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="fetch_stocks(page)" rotate="false"></pagination></div><div class="spinner" id="stock-category-stock-list-spinner"></div><div class="content-box"><br /><table class="table table-striped"><thead><th><div class="row-fluid"><div class="column span3 column-sortable" ng-click="sort(&#39;stock_number&#39;)" style="min-width: 170px">Stock No#</div><div class="column span2 column-sortable" ng-click="sort(&#39;name&#39;)">Name</div><div class="column span1 column"> Model</div><div class="column span1">Location</div><div class="column span1 column-sortable" ng-click="sort(&#39;quantity&#39;)"><div>Avail./Total</div><div>Quantity</div></div><div class="column span1">Buy Price</div><div class="column span2">Sell Price</div><div class="column span1">Margin</div></div></th></thead><tbody><tr ng-repeat="stock in stocks"><td><div class="row-fluid"><a class="goto" ng-href="#/stocks/{{stock.id}}"><div class="column span3"><div style="word-wrap:break-word;">{{stock.stock_number}}</div><div ad-tag-icons="true" owner="stock"></div></div><div class="column span2">{{stock.name}}</div><div class="column span1">{{stock.brand}} {{stock.model}}</div><div class="column span1">{{stock.location}}</div><div class="column span1"><div>{{stock.available_quantity}} / {{stock.quantity}}</div></div><div class="column span1">{{stock.buy_price | currency}}</div><div class="column span2"><div>{{stock.sell_price_excluded_gst|currency}}</div><div>({{stock.sell_price_included_gst|currency}} inc. gst)</div></div><div class="column span1">{{stock.price - stock.buy_price|currency}}</div></a></div></td></tr></tbody></table></div></div><div modal="showing_delete_stock_category_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this stock category</h3></div><div class="modal-body"><div>Are you sure you want to delete this stock category ?</div><div ng-show="stocks.length &gt; 0"><div>What about stocks currently inside this cateogry?</div><label class="radio"><input ng-model="stocks_decision" type="radio" value="keep" />Keep them in the old (deleted) category</label><label class="radio"><input ng-model="stocks_decision" type="radio" value="move" />Move them to a different category:</label><select class="inline" ng-model="deleted_to" ng-options="category.id as category.name for category in stock_categories" ng-show="stocks_decision == &#39;move&#39;"></select><label class="radio"><input ng-model="stocks_decision" type="radio" value="reset" />No stock category</label></div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_stock_category()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_stock_category()">Cancel</button></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocks/accounting_accounts.html",'<div class="content-box"><div class="sub-header">Accounting</div><div class="editable" ng-click="edit_accounting_accounts()" ng-hide="stock.editing_accounts"><div><span class="label-name-left no-width">Purchase Account:</span><span>{{stock.purchase_account.title | na}}</span></div><div><span class="label-name-left no-width">Sale Account:</span><span>{{stock.sale_account.title | na}}</span></div><div><span class="label-name-left no-width">Inventory Asset Account:</span><span>{{stock.inventory_asset_account.title | na}}</span></div></div><div ng-show="stock.editing_accounts"><form class="form-horizontal"><div class="control-group"><label class="control-label">Purchase Account</label><div class="controls"><select ng-model="stock.editing_accounts.purchase_account_id" ng-options="account.id as account.title for account in input_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Sale Account</label><div class="controls"><select ng-model="stock.editing_accounts.sale_account_id" ng-options="account.id as account.title for account in output_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Inventory Asset Account</label><div class="controls"><select ng-model="stock.editing_accounts.inventory_asset_account_id" ng-options="account.id as account.title for account in inventory_accounts()"><option value=""></option></select></div></div><br /><br /><div class="bold">Please note:</div><div>Only set inventory asset account if you enable tracking for this item in your accounting software(E.g Xero or MYOB). Setup tracking inventory is NOT recommended as it requires some manual setup. If you are not sure please contact our support team for more details.</div><div class="control-group"><label></label><div class="controls"><button class="btn btn-primary" ng-click="save_accounting_accounts()">Save</button><button class="btn" ng-click="cancel_edit_accounting_accounts()">Cancel</button></div></div></form></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocks/change_logs.html",'<div class="content-box"><div class="sub-header">Change Logs</div><table class="table table-striped"><thead><tr><th>Date</th><th>Description</th><th>Changes</th></tr></thead><tbody><tr ng-repeat="change_log in change_logs.change_logs"><td>{{change_log.created_at|date: \'mediumDate\'}}</td><td><pre class="no-style">{{change_log.description}}</pre></td><td><div ng-repeat="attribute_change in change_log.attribute_changes"><span>{{attribute_change.attribute}} changed to {{attribute_change.new_value}}</span></div></td></tr></tbody></table><pagination boundary-links="true" current-page="change_logs.meta.page" max-size="15" num-pages="change_logs.meta.total_pages" on-select-page="fetch_change_logs(page)" rotate="false"></pagination></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocks/components.html",'<table class="table" style="width: 100%; text-align: left"><thead><tr><th><ul><li><div class="row-fluid"><div class="column span3">Stock Number</div><div class="column span4">Item</div><div class="column span2">Qty. Needed</div><div class="column span2">Avail Qty.</div><div class="column span1 text-align-right">Cost</div></div></li></ul></th></tr></thead><tbody><tr><td><ul ng-model="stock.components" ui-sortable="component_sortable_options"><li ng-repeat="component in stock.components"><div class="row-fluid editable" ng-click="edit_component(component)" ng-hide="component.editing"><div class="column span3"><div class="dragable-handle" stop-event="click" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><span>{{component.stock.stock_number}}</span></div><div class="column span4">{{component.stock.name}}</div><div class="column span2">{{component.quantity}}</div><div class="column span2">{{component.stock.available_quantity}}</div><div class="column span1 text-align-right">{{component_cost(component)|currency}}</div></div><div class="row-fluid" ng-show="component.editing"><form class="form-linline"><div class="column span7"><div ad-stockpicker="true" class="inline" ng-model="component.editing"></div></div><div class="column span5"><input class="input-tiny" ng-model="component.editing.quantity" step="any" type="number" /></div><div><button class="btn btn-success" ng-click="update_component(component)">Save</button><button class="btn" ng-click="cancel_edit_component(component)">Cancel</button><button class="btn btn-danger" ng-click="delete_component(component)" style="margin-left: 30px">Remove</button><div class="spinner" id="edit-component-spinner-{{component.id}}"></div></div></form></div></li></ul></td></tr><tr><td><div class="row-fluid"><div class="column span10">&nbsp;</div><div class="column span2 text-align-right">{{total_component_cost()|currency}}</div></div></td></tr></tbody></table><div ng-hide="new_component"><button class="btn btn-link" id="new-component-button" ng-click="add_component()">New Component</button></div><div ng-show="new_component"><form class="form form-horizontal"><div class="control-group"><label class="control-label">Stock</label><div class="controls"><div ad-stockpicker="true" class="inline" input-id="new-component-stock" ng-model="new_component"></div></div></div><div class="control-group"><label class="control-label">Quantity Needed</label><div class="controls"><input ng-model="new_component.quantity" step="any" type="number" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="create_component()">Save</button><button class="btn" ng-click="cancel_new_component()" type="button">Cancel</button><div class="spinner" id="new-component-spinner"></div></div></div></form></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocks/deleted_list.html",'<div ng-show="query.deleted"><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span2 column-sortable" ng-click="sort(&#39;stock_number&#39;)" style="min-width: 150px">Stock No#</div><div class="column span2 column-sortable" ng-click="sort(&#39;name&#39;)">Name</div><div class="column span2 column-sortable">Category</div><div class="column span2 column-sortable" ng-click="sort(&#39;brand&#39;)">Brand/Model/Size</div><div class="column span1">Location</div><div class="column span1 column-sortable" ng-click="sort(&#39;quantity&#39;)">Qty.</div><div class="column span1">Deleted By</div><div class="column span1">Deleted Reason</div></div></th></tr></thead><tbody><tr ng-repeat="stock in stocks"><td><div class="row-fluid"><div class="column span2">{{stock.stock_number}}</div><div class="column span2">{{stock.name}}</div><div class="column span2">{{stock.stock_category.name}}</div><div class="column span2">{{stock.brand}} {{stock.model}} {{stock.size}}</div><div class="column span1">{{stock.location}}</div><div class="column span1">{{stock.quantity}}</div><div class="column span1"><div>{{stock.deleted_by.name}}</div><div>{{stock.deleted_reason}}</div></div><div class="column span1"><button class="btn btn-info" ng-click="undelete(stock)" ng-show="can_undelete_stock()">Undelete</button></div></div></td></tr></tbody></table><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocks/index.html",'<div ng-controller="StocksController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">Stocks<div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="search-description" ng-show="keyword">Search "{{keyword}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="row-fluid"><div class="pull-right"><div class="inline" id="selection-list" ng-show="selected_stocks.length &gt; 0" style="margin-right: 10px"><a href="javascript:void(0);" ng-click="show_selection_preview()">{{selected_stocks.length}} Selected</a></div><button class="btn btn-success" ng-click="show_selection_preview()">Reorder</button><a class="btn btn-primary" ng-href="#/stocks/new">New Stock</a></div></div><div class="row-fluid"><div class="column span3" style="margin-bottom: 10px; margin-top: 10px"><label class="checkbox"><input ng-click="toggle_deleted()" ng-model="showing_deleted" type="checkbox" /><span>Show</span> <span class="label">Deleted</span> <span>Stocks Only</span></label></div><div class="column span3" style="margin-bottom: 10px; margin-top: 10px"><label class="checkbox"><input ng-click="toggle_reorder()" ng-model="showing_reorder" type="checkbox" /><span>Show Suggested </span> <span class="label label-info">Reorder</span> <span>Stocks</span> </label></div><div class="column span5"><div ng-show="showing_reorder" style="margin-bottom: 10px; margin-top: 10px"><div class="inline">Supplier:</div> <div class="inline" disable-new="true" ng-model="supplier_id" on-select="search()" supplier="reorder_supplier" supplierpicker=""></div><div class="inline" style="margin-left: 10px"><a href="javascript: void(0);" ng-click="reorder_all_supplier()">Show All</a></div></div><div ng-show="tags().length &gt; 0 &amp;&amp; !showing_reorder"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div></div><div class="spinner" id="stock-list-spinner"></div><div class="content-box"><table class="table table-striped" ng-show="query.reorder"><thead><tr><th><div class="row-fluid"><div class="column span2" style="min-width: 150px"><label class="checkbox"><input ng-click="toggle_select_all()" ng-model="all_selected" type="checkbox" /><span class="bold" style="margin-left: 3px">Stock No#</span></label></div><div class="column span2">Name</div><div class="column span2">Category</div><div class="column span2">Brand/Model/Size</div><div class="column span1 text-align-right">Qty.</div><div class="column span1 text-align-right">Allocated</div><div class="column span1 text-align-right">Available</div><div class="column span1 text-align-right">Ordered</div></div></th></tr></thead><tbody><tr ng-repeat="stock in stocks"><td><div class="row-fluid" ng-click="open_stock(stock)"><div class="column span2" stop-event="click"><label class="checkbox"><input ng-click="toggle_select(stock)" ng-model="stock.selected" type="checkbox" /><span style="margin-left: 3px">{{stock.stock_number}}</span></label></div><div class="column span2">{{stock.name}}</div><div class="column span2">{{stock.stock_category.name}}</div><div class="column span2">{{stock.brand}} {{stock.model}} {{stock.size}}</div><div class="column span1 text-align-right">{{stock.quantity}}</div><div class="column span1 text-align-right">{{stock.allocated_quantity}}</div><div class="column span1 text-align-right">{{stock.available_quantity}}</div><div class="column span1 text-align-right">{{stock.ordered_quantity}}</div></div></td></tr></tbody></table><div ng-show="query.deleted"><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span2 column-sortable" ng-click="sort(&#39;stock_number&#39;)" style="min-width: 150px">Stock No#</div><div class="column span2 column-sortable" ng-click="sort(&#39;name&#39;)">Name</div><div class="column span2 column-sortable">Category</div><div class="column span2 column-sortable" ng-click="sort(&#39;brand&#39;)">Brand/Model/Size</div><div class="column span1">Location</div><div class="column span1 column-sortable" ng-click="sort(&#39;quantity&#39;)">Qty.</div><div class="column span1">Deleted By</div><div class="column span1">Deleted Reason</div></div></th></tr></thead><tbody><tr ng-repeat="stock in stocks"><td><div class="row-fluid"><div class="column span2">{{stock.stock_number}}</div><div class="column span2">{{stock.name}}</div><div class="column span2">{{stock.stock_category.name}}</div><div class="column span2">{{stock.brand}} {{stock.model}} {{stock.size}}</div><div class="column span1">{{stock.location}}</div><div class="column span1">{{stock.quantity}}</div><div class="column span1"><div>{{stock.deleted_by.name}}</div><div>{{stock.deleted_reason}}</div></div><div class="column span1"><button class="btn btn-info" ng-click="undelete(stock)" ng-show="can_undelete_stock()">Undelete</button></div></div></td></tr></tbody></table><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div><div ng-hide="query.deleted || query.reorder"><label class="checkbox"><input ng-model="extended" type="checkbox" />Show more details</label><br /><table class="table table-striped"><thead><tr><th><div class="row-fluid" ng-show="extended"><div class="column span2 column-sortable" ng-click="sort(&#39;stock_number&#39;)">Stock No#</div><div class="column span2 column-sortable" ng-click="sort(&#39;name&#39;)">Name</div><div class="column span1 column-sortable">Category</div><div class="column span2 column-sortable" ng-click="sort(&#39;brand&#39;)">Brand/Model/Size</div><div class="column span1">Location</div><div class="column span1 text-align-right column-sortable" ng-click="sort(&#39;quantity&#39;)"><div>Avail./Total</div><div>Quantity</div></div><div class="column span1 text-align-right">Buy Price</div><div class="column span1 text-align-right">Sell Price</div><div class="column span1 text-align-right"><div>Price</div><div>(Incl. {{tax_name()}})</div></div></div><div class="row-fluid" ng-hide="extended"><div class="column span2 column-sortable" ng-click="sort(&#39;stock_number&#39;)">Stock No#</div><div class="column span4 column-sortable" ng-click="sort(&#39;name&#39;)">Name</div><div class="column span2">Location</div><div class="column span1 text-align-right column-sortable" ng-click="sort(&#39;quantity&#39;)"><div>Avail./Total</div><div>Quantity</div></div><div class="column span1 text-align-right">Sell Price</div><div class="column span2 text-align-right"><div>Price</div><div>(Incl. {{tax_name()}})</div></div></div></th></tr></thead><tbody><tr ng-repeat="stock in stocks"><td><div class="row-fluid" ng-show="extended"><a class="goto" ng-href="#/stocks/{{stock.id}}"><div class="column span2"><div>{{stock.stock_number}}</div><div ad-tag-icons="true" owner="stock"></div></div><div class="column span2">{{stock.name}}</div><div class="column span1">{{stock.stock_category.name}}</div><div class="column span2">{{stock.brand}} {{stock.model}} {{stock.size}}</div><div class="column span1"><span>{{stock.location}}</span><span ng-show="stock.bin">&nbsp; Bin: {{stock.bin}}</span></div><div class="column span1 text-align-right">{{stock.available_quantity}} / {{stock.quantity}}</div><div class="column span1 text-align-right">{{stock.buy_price | currency}}</div><div class="column span1 text-align-right">{{stock.sell_price_excluded_gst|currency}}</div><div class="column span1 text-align-right">{{stock.sell_price_included_gst|currency}}</div></a></div><div class="row-fluid" ng-hide="extended"><a class="goto" ng-href="#/stocks/{{stock.id}}"><div class="column span2"><div>{{stock.stock_number}}</div><div ad-tag-icons="true" owner="stock"></div></div><div class="column span4">{{stock.name}}</div><div class="column span2"><span>{{stock.location}}</span><span ng-show="stock.bin">&nbsp; Bin: {{stock.bin}}</span></div><div class="column span1 text-align-right">{{stock.available_quantity}} / {{stock.quantity}}</div><div class="column span1 text-align-right">{{stock.sell_price_excluded_gst|currency}}</div><div class="column span2 text-align-right">{{stock.sell_price_included_gst|currency}}</div></a></div></td></tr></tbody></table><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div></div><div id="stock-list-preview-popover"><div class="popover fade left in" style="width: 900px"><div class="popover-title"><div class="sub-header">Selected Stocks</div></div><div class="popover-content"><div class="content-box"><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span2">Stock No#</div><div class="column span3">Name</div><div class="column span1 text-align-right">Qty.</div><div class="column span1 text-align-right">Alloc.</div><div class="column span1 text-align-right">Avail.</div><div class="column span1 text-align-right">Ordered</div><div class="column span2 text-align-right">Order Qty.</div></div></th></tr></thead><tbody><tr ng-repeat="stock in selected_stocks"><td><div class="row-fluid"><div class="column span2" stop-event="click"><label class="checkbox"><input ng-click="toggle_select(stock)" ng-model="stock.selected" type="checkbox" /><span style="margin-left: 3px">{{stock.stock_number}}</span></label></div><div class="column span3">{{stock.name}}</div><div class="column span1 text-align-right">{{stock.quantity}}</div><div class="column span1 text-align-right">{{stock.allocated_quantity}}</div><div class="column span1 text-align-right">{{stock.available_quantity}}</div><div class="column span1 text-align-right">{{stock.ordered_quantity}}</div><div class="column span2 text-align-right"><input class="input input-tiny" ng-model="stock.order_quantity" step="any" type="number" /></div></div></td></tr></tbody></table></div><hr /><div ad-purchase-order-form="true" ng-model="new_purchase_order" on-cancel="close_selection_preview()" on-save="add_selected_stocks()"></div></div></div></div><div ad-email-purchase-order="true" anchor-element="#selection-list" ng-model="sending_purchase" placement="left" showing="sending_purchase"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocks/kits.html",'<div ng-controller="KitsController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">Kits</div><div class="search-description" ng-show="keyword">Search "{{keyword}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="row-fluid"><div class="pull-right"><a class="btn btn-primary" ng-href="#/stocks/new?is_kit=true">New Kit</a></div></div><br /><div class="spinner" id="stock-list-spinner"></div><div class="content-box"><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span2 column-sortable" ng-click="sort(&#39;stock_number&#39;)" style="min-width: 150px">Stock No#</div><div class="column span2 column-sortable" ng-click="sort(&#39;name&#39;)">Name</div><div class="column span2 column-sortable">Category</div><div class="column span2 column-sortable" ng-click="sort(&#39;brand&#39;)">Brand/Model/Size</div><div class="column span1">Location</div><div class="column span1 column-sortable" ng-click="sort(&#39;quantity&#39;)">Qty.</div><div class="column span1">Buy Price</div><div class="column span1"><div>Price</div><div>(Incl. {{tax_name()}})</div></div></div></th></tr></thead><tbody><tr ng-repeat="stock in stocks"><td><div class="row-fluid"><a class="goto" ng-href="#/stocks/{{stock.id}}"><div class="column span2">{{stock.stock_number}}</div><div class="column span2">{{stock.name}}</div><div class="column span2">{{stock.stock_category.name}}</div><div class="column span2">{{stock.brand}} {{stock.model}} {{stock.size}}</div><div class="column span1">{{stock.location}}</div><div class="column span1">{{stock.quantity}}</div><div class="column span1">{{stock.buy_price | currency}}</div><div class="column span1">{{stock.sell_price_included_gst|currency}}</div></a></div></td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocks/list.html",'<div ng-hide="query.deleted || query.reorder"><label class="checkbox"><input ng-model="extended" type="checkbox" />Show more details</label><br /><table class="table table-striped"><thead><tr><th><div class="row-fluid" ng-show="extended"><div class="column span2 column-sortable" ng-click="sort(&#39;stock_number&#39;)">Stock No#</div><div class="column span2 column-sortable" ng-click="sort(&#39;name&#39;)">Name</div><div class="column span1 column-sortable">Category</div><div class="column span2 column-sortable" ng-click="sort(&#39;brand&#39;)">Brand/Model/Size</div><div class="column span1">Location</div><div class="column span1 text-align-right column-sortable" ng-click="sort(&#39;quantity&#39;)"><div>Avail./Total</div><div>Quantity</div></div><div class="column span1 text-align-right">Buy Price</div><div class="column span1 text-align-right">Sell Price</div><div class="column span1 text-align-right"><div>Price</div><div>(Incl. {{tax_name()}})</div></div></div><div class="row-fluid" ng-hide="extended"><div class="column span2 column-sortable" ng-click="sort(&#39;stock_number&#39;)">Stock No#</div><div class="column span4 column-sortable" ng-click="sort(&#39;name&#39;)">Name</div><div class="column span2">Location</div><div class="column span1 text-align-right column-sortable" ng-click="sort(&#39;quantity&#39;)"><div>Avail./Total</div><div>Quantity</div></div><div class="column span1 text-align-right">Sell Price</div><div class="column span2 text-align-right"><div>Price</div><div>(Incl. {{tax_name()}})</div></div></div></th></tr></thead><tbody><tr ng-repeat="stock in stocks"><td><div class="row-fluid" ng-show="extended"><a class="goto" ng-href="#/stocks/{{stock.id}}"><div class="column span2"><div>{{stock.stock_number}}</div><div ad-tag-icons="true" owner="stock"></div></div><div class="column span2">{{stock.name}}</div><div class="column span1">{{stock.stock_category.name}}</div><div class="column span2">{{stock.brand}} {{stock.model}} {{stock.size}}</div><div class="column span1"><span>{{stock.location}}</span><span ng-show="stock.bin">&nbsp; Bin: {{stock.bin}}</span></div><div class="column span1 text-align-right">{{stock.available_quantity}} / {{stock.quantity}}</div><div class="column span1 text-align-right">{{stock.buy_price | currency}}</div><div class="column span1 text-align-right">{{stock.sell_price_excluded_gst|currency}}</div><div class="column span1 text-align-right">{{stock.sell_price_included_gst|currency}}</div></a></div><div class="row-fluid" ng-hide="extended"><a class="goto" ng-href="#/stocks/{{stock.id}}"><div class="column span2"><div>{{stock.stock_number}}</div><div ad-tag-icons="true" owner="stock"></div></div><div class="column span4">{{stock.name}}</div><div class="column span2"><span>{{stock.location}}</span><span ng-show="stock.bin">&nbsp; Bin: {{stock.bin}}</span></div><div class="column span1 text-align-right">{{stock.available_quantity}} / {{stock.quantity}}</div><div class="column span1 text-align-right">{{stock.sell_price_excluded_gst|currency}}</div><div class="column span2 text-align-right">{{stock.sell_price_included_gst|currency}}</div></a></div></td></tr></tbody></table><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocks/new.html",'<div ng-controller="NewStockController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">New Stock</div><div class="content-box"><div class="row-fluid"><ng-form class="form-horizontal"><div ad-stock-form="true" ng-model="stock"></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_stock()">Save</button><button class="btn" ng-click="cancel()">Cancel</button><div class="spinner" id="saving-stock"></div></div></div></ng-form></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocks/reorder_list.html",'<table class="table table-striped" ng-show="query.reorder"><thead><tr><th><div class="row-fluid"><div class="column span2" style="min-width: 150px"><label class="checkbox"><input ng-click="toggle_select_all()" ng-model="all_selected" type="checkbox" /><span class="bold" style="margin-left: 3px">Stock No#</span></label></div><div class="column span2">Name</div><div class="column span2">Category</div><div class="column span2">Brand/Model/Size</div><div class="column span1 text-align-right">Qty.</div><div class="column span1 text-align-right">Allocated</div><div class="column span1 text-align-right">Available</div><div class="column span1 text-align-right">Ordered</div></div></th></tr></thead><tbody><tr ng-repeat="stock in stocks"><td><div class="row-fluid" ng-click="open_stock(stock)"><div class="column span2" stop-event="click"><label class="checkbox"><input ng-click="toggle_select(stock)" ng-model="stock.selected" type="checkbox" /><span style="margin-left: 3px">{{stock.stock_number}}</span></label></div><div class="column span2">{{stock.name}}</div><div class="column span2">{{stock.stock_category.name}}</div><div class="column span2">{{stock.brand}} {{stock.model}} {{stock.size}}</div><div class="column span1 text-align-right">{{stock.quantity}}</div><div class="column span1 text-align-right">{{stock.allocated_quantity}}</div><div class="column span1 text-align-right">{{stock.available_quantity}}</div><div class="column span1 text-align-right">{{stock.ordered_quantity}}</div></div></td></tr></tbody></table>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocks/show.html",'<div ng-controller="ShowStockController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div ng-hide="stock &amp;&amp; stock.id"><div class="spinner" id="stock-loading"></div></div><div ng-show="stock &amp;&amp; stock.id"><div class="deleted-sign" ng-show="stock.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><div class="row-fluid"><div class="column span7"><div class="page-header">{{stock.name}}</div></div><div class="column span5"><div class="pull-right"><div ad-tag-labels="true" class="inline" owner="stock"></div><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="stock" placement="left" resource="Stock" showing="x_tags"></div></div></div></div><div class="row-fluid"><div class="pull-right"><a class="btn" ng-href="/stocks/{{stock.id}}/label.pdf" target="_blank"><i class="icon icon-barcode"></i>Print Label</a><a class="btn" ng-href="/stocks/{{stock.id}}/barcode.pdf" ng-show="stock.barcode" target="_blank"><i class="icon icon-barcode"></i>Print Barcode</a><a class="btn" ng-href="/stocks/{{stock.id}}/pick_slip.pdf" ng-show="stock.is_kit" target="_blank"><i class="icon icon-barcode"></i>Print Pick Slip</a><div class="inline"><button class="btn btn-success" id="build-kit-button" ng-click="open_build()" ng-hide="stock.deleted || !stock.is_kit">Build</button></div><button class="btn" id="transfer-stock-button" ng-click="transfer_stock()" ng-show="transferable()">Inter Stores\' Stocks/Transfer</button><a class="btn" href="javascript:void(0);" id="create-adjustment-button" ng-click="adjust_stock_quantity()">Adjust Quantity</a><button class="btn btn-danger" id="merge-stock-button" ng-click="merge_stock()" ng-hide="stock.deleted || restricted_to(&#39;deletion&#39;)">Merge</button><button class="btn btn-danger" ng-click="delete_stock()" ng-hide="stock.deleted || restricted_to(&#39;deletion&#39;)">Delete</button></div></div><br /><div class="row-fluid"><div class="column span7"><div class="content-nav" ng-show="stock.is_kit"><ul><li ng-class="{active: left_side==&#39;details&#39;}" ng-click="show_left_side(&#39;details&#39;)"><a>Kit Details</a></li><li ng-class="{active: left_side==&#39;components&#39;}" ng-click="show_left_side(&#39;components&#39;)"><a>Components</a></li></ul></div><div class="content-box" ng-show="left_side==&#39;details&#39;"><div ad-stock="true" ng-model="stock" on-save="fetch_change_logs()"></div><hr /><div class="sub-header">Photos/Documents</div><div ad-files="true" ng-model="stock" upload-url="&#39;/stocks/&#39; + stock.id + &#39;/upload_files&#39;"></div></div><div class="content-box" ng-show="left_side==&#39;components&#39;"><table class="table" style="width: 100%; text-align: left"><thead><tr><th><ul><li><div class="row-fluid"><div class="column span3">Stock Number</div><div class="column span4">Item</div><div class="column span2">Qty. Needed</div><div class="column span2">Avail Qty.</div><div class="column span1 text-align-right">Cost</div></div></li></ul></th></tr></thead><tbody><tr><td><ul ng-model="stock.components" ui-sortable="component_sortable_options"><li ng-repeat="component in stock.components"><div class="row-fluid editable" ng-click="edit_component(component)" ng-hide="component.editing"><div class="column span3"><div class="dragable-handle" stop-event="click" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><span>{{component.stock.stock_number}}</span></div><div class="column span4">{{component.stock.name}}</div><div class="column span2">{{component.quantity}}</div><div class="column span2">{{component.stock.available_quantity}}</div><div class="column span1 text-align-right">{{component_cost(component)|currency}}</div></div><div class="row-fluid" ng-show="component.editing"><form class="form-linline"><div class="column span7"><div ad-stockpicker="true" class="inline" ng-model="component.editing"></div></div><div class="column span5"><input class="input-tiny" ng-model="component.editing.quantity" step="any" type="number" /></div><div><button class="btn btn-success" ng-click="update_component(component)">Save</button><button class="btn" ng-click="cancel_edit_component(component)">Cancel</button><button class="btn btn-danger" ng-click="delete_component(component)" style="margin-left: 30px">Remove</button><div class="spinner" id="edit-component-spinner-{{component.id}}"></div></div></form></div></li></ul></td></tr><tr><td><div class="row-fluid"><div class="column span10">&nbsp;</div><div class="column span2 text-align-right">{{total_component_cost()|currency}}</div></div></td></tr></tbody></table><div ng-hide="new_component"><button class="btn btn-link" id="new-component-button" ng-click="add_component()">New Component</button></div><div ng-show="new_component"><form class="form form-horizontal"><div class="control-group"><label class="control-label">Stock</label><div class="controls"><div ad-stockpicker="true" class="inline" input-id="new-component-stock" ng-model="new_component"></div></div></div><div class="control-group"><label class="control-label">Quantity Needed</label><div class="controls"><input ng-model="new_component.quantity" step="any" type="number" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="create_component()">Save</button><button class="btn" ng-click="cancel_new_component()" type="button">Cancel</button><div class="spinner" id="new-component-spinner"></div></div></div></form></div></div><div class="content-nav"><ul><li ng-class="{active: history_side==&#39;purchase_history&#39;}" ng-click="show_history_side(&#39;purchase_history&#39;)"><a>Purchase History</a></li><li ng-class="{active: history_side==&#39;current_purchase_orders&#39;}" ng-click="show_history_side(&#39;current_purchase_orders&#39;)"><a>Current Purchase Orders</a></li></ul></div><div class="content-box" ng-show="history_side==&#39;purchase_history&#39;"><div class="sub-header">Purchase History</div><div class="pull-right"><a class="btn btn-link" ng-href="/stocks/{{stock.id}}/purchase_history.pdf" target="_blank"><i class="icon icon-print"></i>Print</a></div><div ad-purchase-history="true" ng-model="stock"></div></div><div class="content-box" ng-show="history_side==&#39;current_purchase_orders&#39;"><div class="sub-header">Current Purchase Orders</div><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span2">PO No.</div><div class="column span3">Date</div><div class="column span2">Quantity</div><div class="column span5">Supplier</div></div></th></tr></thead><tbody><tr ng-repeat="purchase_item in stock.current_purchase_items"><td><a ng-href="#/purchases/{{purchase_item.purchase.id}}" target="_blank"><div class="row-fluid goto"><div class="column span2">{{purchase_item.purchase.number}}</div><div class="column span3">{{purchase_item.purchase.date|date}}</div><div class="column span2">{{purchase_item.quantity}}</div><div class="column span5">{{purchase_item.purchase.supplier.name}}</div></div></a></td></tr></tbody></table></div><br /><div class="content-box"><div class="sub-header"><span>Sale History</span><div class="pull-right"><a class="btn btn-link" ng-href="/stocks/{{stock.id}}/sale_history.pdf" target="_blank"><i class="icon icon-print"></i>Print</a></div></div><div ad-sale-history="true" ng-model="stock"></div></div><br /><div class="content-box" ng-show="stock.stock_transfers.length &gt; 0"><div class="sub-header"><span>Transfers</span></div><table class="table table-striped"><thead><tr><th>Date</th><th>In/Out</th><th>From/To</th><th>Quantity</th><th>By</th><th>Note</th></tr></thead><tbody><tr ng-repeat="stock_transfer in stock.stock_transfers"><td>{{stock_transfer.date|date}}</td><td><span class="label label-success" ng-show="stock_transfer.to_stock_id == stock.id">In</span><span class="label label-info" ng-hide="stock_transfer.to_stock_id == stock.id">Out</span></td><td><span ng-show="stock_transfer.to_stock_id == stock.id">{{stock_transfer.from_auto_workshop_name}}</span><span ng-hide="stock_transfer.to_stock_id == stock.id">{{stock_transfer.to_auto_workshop_name}}</span></td><td>{{stock_transfer.quantity}}</td><td>{{stock_transfer.employee_name}}</td><td>{{stock_transfer.note}}</td></tr></tbody></table></div></div><div class="column span5"><div class="content-box stock-alert"><div class="sub-header">Stock Alert<div class="pull-right"><button class="btn btn-link" ng-click="enable_stock_alert()" ng-hide="stock.stock_alert">Enable </button><button class="btn btn-link" ng-click="disable_stock_alert()" ng-show="stock.stock_alert">Disable </button></div></div><br /><div ng-show="stock.stock_alert"><div class="info"><div class="editable" ng-click="edit_stock_alert()" ng-hide="stock_alert"><div><label class="label-name-left auto-width">Alert Quantity:</label><span>{{stock.alert_quantity}}</span></div><div><label class="label-name-left auto-width">Reorder Point:</label><span>{{stock.reorder_point}}</span></div><div><label class="label-name-left auto-width">Maximum Quantity:</label><span>{{stock.maximum_quantity}}</span></div></div><div class="editing-item" ng-show="stock_alert"><form class="form-horizontal"><div class="control-group"><label class="control-label" style="width: 150px">Alert Quantity</label><div class="controls"><input class="input-tiny" ng-model="stock_alert.alert_quantity" type="text" /></div></div><div class="control-group"><label class="control-label" style="width: 150px">Reorder Point</label><div class="controls"><input class="input-tiny" ng-model="stock_alert.reorder_point" type="text" /></div></div><div class="control-group"><label class="control-label" style="width: 150px">Maximum Quantity</label><div class="controls"><input class="input-tiny" ng-model="stock_alert.maximum_quantity" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_stock_alert()">Save</button><button class="btn" ng-click="cancel_edit_stock_alert()">Cancel</button></div></div></form></div></div></div></div><div class="content-box"><div class="sub-header">Suppliers</div><div class="spinner" id="stock-suppliers-spinner"></div><div ng-show="stock_suppliers.length &gt; 0 || new_stock_supplier"><div class="row-fluid"><div class="column span7"><span class="bold">Supplier</span></div><div class="column span3"><span class="bold">Stock No#</span></div><div class="column span2"><span class="bold">Price</span></div></div><ul class="work-check-list" ng-model="stock_suppliers" ui-sortable="supplier_sortable_options"><li ng-repeat="stock_supplier in stock_suppliers"><div class="row-fluid editable" ng-click="edit_stock_supplier(stock_supplier)" ng-hide="stock_supplier.editing"><div class="column span7"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><span>{{stock_supplier.supplier.name}}</span><span ng-show="preferred_supplier(stock_supplier)"><span>&nbsp;</span><span class="label label-info">Preferred Supplier</span></span></div><div class="column span3"><div>{{stock_supplier.supplier_stock_number}}</div><div ng-show="stock_supplier.sku">(sku: {{stock_supplier.sku}})</div></div><div class="column span2">{{stock_supplier.price | currency}}</div></div><div class="row-fluid editing-item" ng-show="stock_supplier.editing"><div class="column span7"><div ng-model="stock_supplier.editing.supplier_id" supplier="stock_supplier.editing.supplier" supplierpicker="true"></div><br /><button class="btn btn-success" ng-click="save_stock_supplier(stock_supplier)">Save</button><button class="btn" ng-click="cancel_edit_stock_supplier(stock_supplier)">Cancel</button><button class="btn btn-danger" ng-click="delete_stock_supplier(stock_supplier)">Delete</button></div><div class="column span3"><div><input class="input-small" ng-model="stock_supplier.editing.supplier_stock_number" type="text" /></div><div><div class="bold">sku</div><input class="input-small" ng-model="stock_supplier.editing.sku" type="text" /></div></div><div class="column span2"><input class="input-small" ng-model="stock_supplier.editing.price" step="any" type="number" /></div></div></li><li class="editing-item" ng-show="new_stock_supplier"><div class="row-fluid"><div class="column span7"><div ng-model="new_stock_supplier.supplier_id" supplier="new_stock_supplier.supplier" supplierpicker="true"></div></div><div class="column span3"><div><input class="input-small" ng-model="new_stock_supplier.supplier_stock_number" type="text" /></div><div><div class="bold">sku</div><input class="input-small" ng-model="new_stock_supplier.sku" type="text" /></div></div><div class="column span2"><input class="input-small" ng-model="new_stock_supplier.price" step="any" type="number" /></div></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_new_stock_supplier()">Save</button><button class="btn" ng-click="cancel_create_stock_supplier()">Cancel</button></div></li></ul></div><div><a ng-click="create_stock_supplier()" ng-hide="new_stock_supplier">Add Supplier</a></div></div><div class="content-box"><div class="sub-header">Accounting</div><div class="editable" ng-click="edit_accounting_accounts()" ng-hide="stock.editing_accounts"><div><span class="label-name-left no-width">Purchase Account:</span><span>{{stock.purchase_account.title | na}}</span></div><div><span class="label-name-left no-width">Sale Account:</span><span>{{stock.sale_account.title | na}}</span></div><div><span class="label-name-left no-width">Inventory Asset Account:</span><span>{{stock.inventory_asset_account.title | na}}</span></div></div><div ng-show="stock.editing_accounts"><form class="form-horizontal"><div class="control-group"><label class="control-label">Purchase Account</label><div class="controls"><select ng-model="stock.editing_accounts.purchase_account_id" ng-options="account.id as account.title for account in input_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Sale Account</label><div class="controls"><select ng-model="stock.editing_accounts.sale_account_id" ng-options="account.id as account.title for account in output_accounts()"><option value=""></option></select></div></div><div class="control-group"><label class="control-label">Inventory Asset Account</label><div class="controls"><select ng-model="stock.editing_accounts.inventory_asset_account_id" ng-options="account.id as account.title for account in inventory_accounts()"><option value=""></option></select></div></div><br /><br /><div class="bold">Please note:</div><div>Only set inventory asset account if you enable tracking for this item in your accounting software(E.g Xero or MYOB). Setup tracking inventory is NOT recommended as it requires some manual setup. If you are not sure please contact our support team for more details.</div><div class="control-group"><label></label><div class="controls"><button class="btn btn-primary" ng-click="save_accounting_accounts()">Save</button><button class="btn" ng-click="cancel_edit_accounting_accounts()">Cancel</button></div></div></form></div></div><div class="content-box"><div class="sub-header">Change Logs</div><table class="table table-striped"><thead><tr><th>Date</th><th>Description</th><th>Changes</th></tr></thead><tbody><tr ng-repeat="change_log in change_logs.change_logs"><td>{{change_log.created_at|date: \'mediumDate\'}}</td><td><pre class="no-style">{{change_log.description}}</pre></td><td><div ng-repeat="attribute_change in change_log.attribute_changes"><span>{{attribute_change.attribute}} changed to {{attribute_change.new_value}}</span></div></td></tr></tbody></table><pagination boundary-links="true" current-page="change_logs.meta.page" max-size="15" num-pages="change_logs.meta.total_pages" on-select-page="fetch_change_logs(page)" rotate="false"></pagination></div></div></div><div modal="showing_delete_stock_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this stock</h3></div><div class="modal-body"><div>Are you sure you want to delete this stock ?</div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_stock()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_stock()">Cancel</button></div></div></div><div id="merge-stock-popover"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Merge Stock</div></div><div class="popover-content"><div class="content-box"><div class="alert warning">This action is irreversible. All data from this stock will be transferred to the stock you choose to merge into and this stock will be deleted.</div><div class="sub-header">Merged To:</div><div ad-stockpicker="true" ng-model="selected_stock"></div><div><div class="sub-header">Selected Stock</div><div class="well" ng-hide="selected_stock.id"><b>Note:</b> <span>Please use the input above to search for stock and</span> <b>Select a stock from the dropdown.</b></div><div ng-show="selected_stock.id"><div ng-show="selected_stock.stock_number"><span class="label-text-left auto-width">Stock Number:</span> <span>{{selected_stock.stock_number}}</span></div><div ng-show="selected_stock.name"><span class="label-text-left auto-width">Name:</span> <span>{{selected_stock.name}}</span></div><div ng-show="selected_stock.quantity"><span class="label-text-left auto-width">Quantity:</span> <span>{{selected_stock.quantity}}</span></div></div></div></div><div class="row-fluid"><button class="btn btn-primary" ng-click="merge()">Merge</button><button class="btn" ng-click="hide_merge()">Cancel</button><div class="spinner" id="merge-stock-spinner"></div></div></div></div></div><div id="build-kit-popover"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Build Kit</div></div><div class="popover-content"><div class="content-box"><input id="build-quantity-input" ng-model="build_quantity" step="any" type="number" /></div><div class="row-fluid"><button class="btn btn-primary" ng-click="build()">Build</button><button class="btn" ng-click="cancel_build()">Cancel</button><div class="spinner" id="build-kit-spinner"></div></div></div></div></div><div id="adjust-quantity-popover"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Adjust Quantity</div></div><div class="popover-content"><div class="content-box"><div class="row-fluid"><div>Quantity (Including Allocated Items)</div><input ng-model="stock.editing_quantity.quantity" step="any" type="number" /><div>Reason</div><textarea class="span12" ng-model="stock.editing_quantity.change_description" rows="6"></textarea></div></div><div class="row-fluid"><button class="btn btn-primary" ng-click="save_stock_quantity()">Save</button><button class="btn" ng-click="hide_adjust_stock_quantity()">Cancel</button><div class="spinner" id="adjust-quantity-spinner"></div></div></div></div></div><div id="adjust-prices-popover"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Adjust Prices</div></div><div class="popover-content"><div class="content-box"><div class="bold">Reason</div><input ng-model="stock.editing_prices.reason" type="text" /></div><div class="row-fluid"><button class="btn btn-primary" ng-click="update_stock_prices()">Save</button><button class="btn" ng-click="cancel_adjust_stock_prices()">Cancel</button><div class="spinner" id="adjust-prices-spinner"></div></div></div></div></div><div id="transfer-popover"><div class="popover fade left in" style="width: 750px"><div class="popover-title"><div class="sub-header">Transfer Stocks</div></div><div class="popover-content"><div class="content-box"><div id="business-stocks-spinner"></div><table class="table table-striped"><thead><tr><th>Store ID</th><th>Store Name</th><th>Quantity</th><th>Allocated</th><th>Ordered</th><th>Avail. Quantity</th></tr></thead><tbody><tr ng-repeat="stock in business_stocks"><td>{{stock.auto_workshop_id}}</td><td>{{stock.auto_workshop_name}}</td><td>{{stock.quantity}}</td><td>{{stock.allocated_quantity}}</td><td>{{stock.ordered_quantity}}</td><td>{{stock.available_quantity}}</td></tr></tbody></table></div><div class="content-box"><div class="row-fluid"><form class="form-horizontal"><div class="control-group"><label class="control-label">Date</label><div class="controls"><div ad-datepicker="true" ng-model="transfer_data.date"></div></div></div><div class="control-group"><label class="control-label">Quantity</label><div class="controls"><input class="input input-small" id="transfer-quantity-input" ng-model="transfer_data.quantity" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Transfer To</label><div class="controls"><select ng-model="transfer_data.auto_workshop_id" ng-options="w.id as w.name for w in related_auto_workshops()"></select></div></div><div class="control-group"><label class="control-label">Note</label><div class="controls"><textarea class="span12" ng-model="transfer_data.note" rows="3"></textarea></div></div></form></div></div><div class="row-fluid"><button class="btn btn-primary" ng-click="transfer()">Transfer</button><button class="btn" ng-click="cancel_transfer()">Cancel</button><div class="spinner" id="transfer-spinner"></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocks/stock_alert.html",'<div class="content-box stock-alert"><div class="sub-header">Stock Alert<div class="pull-right"><button class="btn btn-link" ng-click="enable_stock_alert()" ng-hide="stock.stock_alert">Enable </button><button class="btn btn-link" ng-click="disable_stock_alert()" ng-show="stock.stock_alert">Disable </button></div></div><br /><div ng-show="stock.stock_alert"><div class="info"><div class="editable" ng-click="edit_stock_alert()" ng-hide="stock_alert"><div><label class="label-name-left auto-width">Alert Quantity:</label><span>{{stock.alert_quantity}}</span></div><div><label class="label-name-left auto-width">Reorder Point:</label><span>{{stock.reorder_point}}</span></div><div><label class="label-name-left auto-width">Maximum Quantity:</label><span>{{stock.maximum_quantity}}</span></div></div><div class="editing-item" ng-show="stock_alert"><form class="form-horizontal"><div class="control-group"><label class="control-label" style="width: 150px">Alert Quantity</label><div class="controls"><input class="input-tiny" ng-model="stock_alert.alert_quantity" type="text" /></div></div><div class="control-group"><label class="control-label" style="width: 150px">Reorder Point</label><div class="controls"><input class="input-tiny" ng-model="stock_alert.reorder_point" type="text" /></div></div><div class="control-group"><label class="control-label" style="width: 150px">Maximum Quantity</label><div class="controls"><input class="input-tiny" ng-model="stock_alert.maximum_quantity" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_stock_alert()">Save</button><button class="btn" ng-click="cancel_edit_stock_alert()">Cancel</button></div></div></form></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocks/stock_supplier.html",'<div class="content-box"><div class="sub-header">Suppliers</div><div class="spinner" id="stock-suppliers-spinner"></div><div ng-show="stock_suppliers.length &gt; 0 || new_stock_supplier"><div class="row-fluid"><div class="column span7"><span class="bold">Supplier</span></div><div class="column span3"><span class="bold">Stock No#</span></div><div class="column span2"><span class="bold">Price</span></div></div><ul class="work-check-list" ng-model="stock_suppliers" ui-sortable="supplier_sortable_options"><li ng-repeat="stock_supplier in stock_suppliers"><div class="row-fluid editable" ng-click="edit_stock_supplier(stock_supplier)" ng-hide="stock_supplier.editing"><div class="column span7"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><span>{{stock_supplier.supplier.name}}</span><span ng-show="preferred_supplier(stock_supplier)"><span>&nbsp;</span><span class="label label-info">Preferred Supplier</span></span></div><div class="column span3"><div>{{stock_supplier.supplier_stock_number}}</div><div ng-show="stock_supplier.sku">(sku: {{stock_supplier.sku}})</div></div><div class="column span2">{{stock_supplier.price | currency}}</div></div><div class="row-fluid editing-item" ng-show="stock_supplier.editing"><div class="column span7"><div ng-model="stock_supplier.editing.supplier_id" supplier="stock_supplier.editing.supplier" supplierpicker="true"></div><br /><button class="btn btn-success" ng-click="save_stock_supplier(stock_supplier)">Save</button><button class="btn" ng-click="cancel_edit_stock_supplier(stock_supplier)">Cancel</button><button class="btn btn-danger" ng-click="delete_stock_supplier(stock_supplier)">Delete</button></div><div class="column span3"><div><input class="input-small" ng-model="stock_supplier.editing.supplier_stock_number" type="text" /></div><div><div class="bold">sku</div><input class="input-small" ng-model="stock_supplier.editing.sku" type="text" /></div></div><div class="column span2"><input class="input-small" ng-model="stock_supplier.editing.price" step="any" type="number" /></div></div></li><li class="editing-item" ng-show="new_stock_supplier"><div class="row-fluid"><div class="column span7"><div ng-model="new_stock_supplier.supplier_id" supplier="new_stock_supplier.supplier" supplierpicker="true"></div></div><div class="column span3"><div><input class="input-small" ng-model="new_stock_supplier.supplier_stock_number" type="text" /></div><div><div class="bold">sku</div><input class="input-small" ng-model="new_stock_supplier.sku" type="text" /></div></div><div class="column span2"><input class="input-small" ng-model="new_stock_supplier.price" step="any" type="number" /></div></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_new_stock_supplier()">Save</button><button class="btn" ng-click="cancel_create_stock_supplier()">Cancel</button></div></li></ul></div><div><a ng-click="create_stock_supplier()" ng-hide="new_stock_supplier">Add Supplier</a></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocktakes/index.html",'<div ng-controller="StocktakesController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">Stock-takes</div><div class="row-fluid"><div class="pull-right"><a class="btn btn-primary" ng-href="#/stocktakes/new">New Stock-take</a></div></div><br /><div class="spinner" id="stocktake-list-spinner"></div><div class="content-box"><table class="table table-striped"><thead><tr><th>Name</th><th>Started At</th><th>Finished At</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/stocktakes/&#39; + stocktake.id)" ng-repeat="stocktake in stocktakes"><td>{{stocktake.name}}</td><td>{{stocktake.time|date: \'mediumTime\'}}</td><td>{{stocktake.finished_at|date: \'mediumTime\'}}</td></tr></tbody></table></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocktakes/new.html",'<div ng-controller="NewStocktakeController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">New Stock-take</div><div class="content-box"><div class="row-fluid"><form class="form-horizontal"><div class="sub-header">Stocktake</div><div class="control-group"><label class="control-label">Name</label><div class="controls"><div class="error" ng-show="stock.errors.name">{{stock.errors.name|error}}</div><input ng-model="stocktake.name" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="save_new_stocktake()">Continue</button><button class="btn" ng-click="back()">Cancel</button></div></div></form></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/stocktakes/show.html",'<div ng-controller="ShowStocktakeController"><div class="deleted-sign" ng-show="stocktake.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="spinner" id="stocktake-spinner"></div><div class="row-fluid"><div class="column span7"><div class="page-header">{{stocktake.name}}</div></div><div class="column span5"><div class="pull-right"><img class="done-sign" ng-show="stocktake.finished" ng-src="/assets/completed-db7f0f84520f48344132128dbeb76d73.gif" /><button class="btn btn-success" id="finish-stocktake-button" ng-click="finish_stocktake()" ng-hide="stocktake.finished || stocktake.deleted">Finish</button><button class="btn btn-danger" ng-click="delete_stocktake()" ng-hide="stocktake.deleted || stocktake.finished">Delete</button><a class="btn" ng-href="/stocktakes/{{stocktake.id}}/download" target="_blank"><span class="icon icon-download"></span> <span>Download</span></a></div></div></div><div class="row-fluid"><div class="content-box" ng-hide="stocktake.finished || stocktake.deleted"><form autocomplete="off" class="form inline-form"><div class="inline"><div class="bold">&nbsp;Stock</div><div ad-stockpicker="true" id="new-stocktake-item" ng-model="new_stocktake_item"></div></div><div class="inline" style="margin-left: 10px"><div class="bold">&nbsp;Allocated</div><input class="input-small" ng-model="new_stocktake_item.allocated_quantity" readonly="true" tabindex="1" tabstop="false" type="text" /></div><div class="inline" style="margin-left: 10px"><div class="bold">&nbsp;Quantity</div><input class="input-small" ng-model="new_stocktake_item.quantity" readonly="true" tabindex="1" tabstop="false" type="text" /></div><div class="inline" style="margin-left: 10px"><div class="bold">&nbsp;Count</div><input class="input-small" ng-model="new_stocktake_item.count" required="true" step="any" type="number" /></div><div class="inline" style="margin-left: 10px"><button class="btn btn-success" ng-click="save_new_stocktake_item()">Save</button><div class="spinner inline" id="new-stocktake-item-spinner"></div></div></form><div class="bold">Note:</div><pre class="no-style">If the item has already been counted. using this form will add more to the total count. If you want to update the item\'s total count. Please find the item on the list and adjust the total count.</pre></div><div class="content-nav"><ul><li ng-class="{active: right_side==&#39;stocktake&#39;}" ng-click="show_right_side(&#39;stocktake&#39;)"><a>Stock Counts</a></li><li ng-class="{active: right_side==&#39;notes&#39;}" ng-click="show_right_side(&#39;notes&#39;)"><a>Notes ({{stocktake.notes.length}})</a></li></ul></div><div class="content-box"><div ng-show="right_side==&#39;stocktake&#39;"><div class="bold">Total Value: {{stocktake.total_value|currency}}</div><div class="row-fluid"><div class="pull-right"><button class="btn btn-link" ng-click="adding_stock_category = true" ng-hide="adding_stock_category || stocktake.finished || stocktake.deleted">+ Stock Category</button><div class="inline editing-item" ng-show="adding_stock_category" style="margin-bottom: 5px"><div ad-stock-category-selection="true" class="inline" disable-new="true" ng-model="add_stock_category_id"></div><div class="inline" style="margin-left: 10px"><button class="btn btn-success" ng-click="add_stock_category()">Add</button><button class="btn" ng-click="cancel_add_stock_category()">Cancel</button><div class="spinner" id="adding-stock-category"></div></div></div><div class="inline" style="margin-left: 50px"><button class="btn btn-link" ng-click="adding_location = true" ng-hide="adding_location || stocktake.finished || stocktake.deleted">+ Location</button><div class="inline editing-item" ng-show="adding_location" style="margin-bottom: 5px"><div class="inline" locationpicker="true" ng-model="add_location_id"></div><div class="inline" style="margin-left: 40px"><button class="btn btn-success" ng-click="add_location()">Add</button><button class="btn" ng-click="cancel_add_location()">Cancel</button><div class="spinner" id="adding-location"></div></div></div></div></div></div><div ng-show="stocktake.stocktake_items.length == 0">No Items</div><table class="table table-striped" ng-show="stocktake.stocktake_items.length &gt; 0"><thead><tr><th><div class="row-fluid"><div class="column span2 bold">Stock No.#</div><div class="column span2 bold">Stock Name</div><div class="column span1 bold">Category</div><div class="column span1 bold">Location</div><div class="column span1 text-align-right">Qty.</div><div class="column span1 text-align-right">Total Count</div><div class="column span1 text-align-right">Old Value</div><div class="column span1 text-align-right">New Value</div><div class="column span2"></div></div></th></tr></thead><tbody><tr ng-repeat="item in stocktake.stocktake_items"><td><div class="row-fluid"><div class="column span2"><span>{{item.stock.stock_number}}</span></div><div class="column span2"><span>{{item.stock.name}}</span></div><div class="column span1"><span>{{item.stock.stock_category.name}}</span></div><div class="column span1"><span>{{item.stock.location}}</span></div><div class="column span1 text-align-right"><span>{{item.quantity}}</span></div><div class="column span1"><div class="pull-right"><input class="input-tiny text-align-right" ng-change="save_item(item)" ng-model="item.count" ng-readonly="stocktake.deleted || stocktake.finished" step="any" type="number" /><span class="green" ng-show="item.saving" style="padding-left: 5px"><span>&nbsp;Saving...</span></span></div></div><div class="column span1 text-align-right">{{item.system_total_value|currency}}</div><div class="column span1 text-align-right">{{item.total_value|currency}}</div><div class="column span2"><div class="row"><span class="green" ng-show="item.counted" style="margin-left: 20px">Counted</span><div class="pull-right"><a class="red" ng-click="remove_item(item)" ng-hide="stocktake.deleted || stocktake.finished" ng-href="javascript:void(0);" tabindex="-1"><i class="icon-remove"></i><span>Remove</span></a></div></div></div></div></td></tr><tr ng-show="stocktake.finished"><td><div ng-show="stocktake.remaining_stocks_decision == &#39;keep_system_quantity&#39;"><span>Keeps the remaining stocks\' quantities as is</span></div><div ng-show="stocktake.remaining_stocks_decision == &#39;reset_to_zero&#39;"><span>Reset the remaining stocks\' quantities to 0</span></div><div class="bold">Total Value: {{stocktake.total_value|currency}}</div><div class="bold">Total Adjusted: {{stocktake.total_difference_amount|currency}}</div></td></tr></tbody></table></div><div ng-show="right_side==&#39;notes&#39;"><div ad-notes="true" model-type="stocktake" ng-model="stocktake"></div></div></div></div><div id="finish-stocktake-popover"><div class="popover fade left in" style="width: 550px"><div class="popover-title"><div class="sub-header">Finish {{stocktake.name}}</div></div><div class="popover-content"><div class="row-fluid"><div class="spinner" id="finish-stocktake-spinner"></div><form class="form-horizontal" name="finish_stocktake_form" novalidate="true"><div class="content-box"><input ng-model="stocktake.id" type="hidden" /><div class="control-group"><label class="control-label bold">For remaining stocks</label><div class="controls"><div><label class="radio"><input class="radio" ng-model="stocktake.remaining_stocks_decision" type="radio" value="keep_system_quantity" /><span>Keep current system\'s quantity</span></label></div><div><label class="radio"><input class="radio" ng-model="stocktake.remaining_stocks_decision" type="radio" value="reset_to_zero" /><span>Set quantity to 0</span></label></div></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" ng-click="do_finish()">Finish</button><button class="btn" ng-click="cancel_finish()">Cancel</button></div></div></form></div></div></div></div><div modal="showing_delete_stocktake_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this stocktake</h3></div><div class="modal-body"><div>Are you sure you want to delete this Stocktake ?</div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_stocktake()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_stocktake()">Cancel</button></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/suppliers/creditor.html",'<div class="content-box" ng-hide="supplier.is_creditor"><div class="sub-header">Creditor/Buying Group</div><div ng-hide="supplier.editing_creditor"><div class="editable" ng-click="select_creditor()" ng-show="supplier.creditor"><div class="info"><label class="label-name-left auto-width">Name:</label><span>{{supplier.creditor.registered_name || supplier.creditor.name}}</span></div><div class="info" ng-show="supplier.creditor.abn"><label class="label-name-left auto-width">ABN:</label><span>{{supplier.creditor.abn}}</span></div><div class="info" ng-show="supplier.creditor.acn"><label class="label-name-left auto-width">ACN:</label><span>{{supplier.creditor.acn}}</span></div><div class="info"><label class="label-name-left auto-width">Account Number:</label><span>{{supplier.creditor.account_number|na}}</span></div><br><a ng-href="#suppliers/{{supplier.creditor_id}}" stop-event="click">Details</a></br></div><div ng-hide="supplier.creditor"><a href="javascript:void(0);" ng-click="select_creditor()">Select One</a></div></div><div ng-show="supplier.editing_creditor"><div creditorpicker="true" ng-model="supplier.editing_creditor.creditor_id"></div><button class="btn btn-success" ng-click="save_selected_creditor()">Save</button><button class="btn" ng-click="cancel_select_creditor()">Cancel</button></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/suppliers/index.html",'<div ng-controller="SuppliersController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">Suppliers<div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="search-description" ng-show="keyword">Search "{{query}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="pull-right"><a class="btn btn-primary" ng-href="#/suppliers/new">New Supplier</a></div><br /><div class="row-fluid"><div class="column span4"><label class="checkbox" ng-click="toggle_positive_balances()"><input ng-model="showing_positive_balances" type="checkbox" /><span>Suppliers with positive balances only</span></label></div><div class="column span4"><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div></div><div class="row-fluid"><div class="spinner" id="supplier-list-spinner"></div><div class="content-box"><table class="table table-striped"><thead><tr><th class="column-sortable" ng-click="sort(&#39;number&#39;)">Supplier No.</th><th class="column-sortable" ng-click="sort(&#39;name&#39;)">Name</th><th>Phone</th><th>Email</th><th>Address</th><th class="column-sortable" ng-click="sort(&#39;balance&#39;)">Balance</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/suppliers/&#39; + supplier.id)" ng-repeat="supplier in suppliers"><td>{{supplier.number}}</td><td>{{supplier.name}}</td><td><div ng-show="supplier.phone">{{supplier.phone}}</div><div ng-show="supplier.mobile &amp;&amp; supplier.mobile != supplier.phone">{{supplier.mobile}}</div></td><td>{{supplier.email}}</td><td>{{supplier.address.full_address}}</td><td ng-class="{red: supplier.balance &gt; 0, green: supplier.balance == 0}">{{supplier.balance|currency}}</td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/suppliers/new.html",'<div ng-controller="NewSupplierController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">New Supplier</div><div class="content-box span12"><ad-supplier-form ng-model="new_supplier" on-cancel="back()" on-save="on_save_new_supplier()"></ad-supplier-form></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/suppliers/show.html",'<div ng-controller="ShowSupplierController"><div class="deleted-sign" ng-show="supplier.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div ng-hide="supplier &amp;&amp; supplier.id"><div class="spinner" id="supplier-spinner"></div></div><div ng-show="supplier &amp;&amp; supplier.id"><div class="row-fluid"><div class="pull-left"><div class="page-header">#{{supplier.number}} - {{supplier.name}}</div></div><div class="pull-right"><div ad-tag-labels="true" class="inline" owner="supplier"></div><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="supplier" placement="left" resource="Supplier" showing="x_tags"></div></div></div><div class="row-fluid"><div class="pull-right" ng-hide="supplier.deleted"><a class="btn" ng-href="/suppliers/{{supplier.id}}/statement.pdf" target="_blank">Statement</a><a class="btn btn-primary" id="new-bill-button" ng-href="#/bills/new?supplier_id={{supplier.id}}">New Bill</a><a class="btn btn-primary" id="new-payment-button" ng-href="#/bill_payments/new?supplier_id={{supplier.id}}">New Payment</a><button class="btn btn-danger" id="merge-supplier-button" ng-click="merge_supplier()">Merge</button><button class="btn btn-danger" ng-click="delete_supplier()">Delete</button></div></div><br /><div class="row-fluid"><div class="column span7"><div class="content-nav"><ul><li ng-class="{active: left_side==&#39;details&#39;}" ng-click="show_left_side(&#39;details&#39;)"><a>Supplier Details</a></li><li ng-class="{active: left_side == &#39;contacts&#39;}" ng-click="show_left_side(&#39;contacts&#39;)"><a>Contacts</a></li></ul></div><div class="content-box supplier-info"><div ng-show="left_side == &#39;contacts&#39;"><div class="spinner" id="supplier-contacts-spinner"></div><div class="sub-header">Contacts</div><table class="table table-striped" style="max-height: 600px; y-overflow: scroll;"><thead><tr><th><div class="row-fluid"><div class="column span4">Name</div><div class="column span3">Phone/Mobile</div><div class="column span3">Email</div><div class="column span2">Position</div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="c in supplier.contacts"><td><div class="row-fluid" ng-click="edit_contact(c)" ng-hide="c.editing"><div class="column span4">{{c.name}}</div><div class="column span3"><div>{{c.phone}}</div><div>{{c.mobile}}</div></div><div class="column span3">{{c.email}}</div><div class="column span2">{{c.position}}</div></div><div class="row-fluid" ng-show="c.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input ng-model="c.editing.name" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="c.editing.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Mobile</label><div class="controls"><input ng-model="c.editing.mobile" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input ng-model="c.editing.email" type="text" /></div></div><div class="control-group"><label class="control-label">Title/Position</label><div class="controls"><input ng-model="c.editing.position" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_contact(c)" type="submit">Save</button><button class="btn" ng-click="cancel_editing_contact(c)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="destroy_contact(c)">Remove</button></div></div></div></form></div></td></tr><tr><td><div ng-hide="new_contact"><a href="javascript:void(0);" ng-click="create_contact()">New Contact</a></div><div ng-show="new_contact"><form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input ng-model="new_contact.name" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="new_contact.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Mobile</label><div class="controls"><input ng-model="new_contact.mobile" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input ng-model="new_contact.email" type="text" /></div></div><div class="control-group"><label class="control-label">Title/Position</label><div class="controls"><input ng-model="new_contact.position" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_new_contact()" type="submit">Save</button><button class="btn" ng-click="cancel_new_contact()">Cancel</button></div></div></form></div></td></tr></tbody></table></div><div ng-show="left_side == &#39;details&#39;"><div class="editable" ng-click="edit_supplier()" ng-hide="supplier.editing"><div class="info"><label class="label-name">Full Name:</label><span>{{supplier.registered_name || supplier.name}}</span></div><div class="info"><label class="label-name">Account No#:</label><span>{{supplier.account_number}}</span></div><div class="info" ng-show="country() == &#39;au&#39;"><label class="label-name">ABN:</label><span>{{supplier.abn}}</span></div><div class="info"><label class="label-name">Phone:</label><span>{{supplier.phone}}</span></div><div class="info"><label class="label-name">Mobile:</label><span>{{supplier.mobile}}</span></div><div class="info"><label class="label-name">Fax:</label><span>{{supplier.fax}}</span></div><div class="info"><label class="label-name">Email:</label><span>{{supplier.email}}</span></div><div class="info" ng-show="supplier.contact_name"><label class="label-name">Contact Person:</label><span>{{supplier.contact_name}}</span></div><div class="info"><label class="label-name">Postal Address:</label><span>{{supplier.address.full_address}}</span></div><div class="info" ng-show="supplier.street_address"><label class="label-name">Street Address:</label><span>{{supplier.street_address.full_address}}</span></div><div class="info"><label class="label-name">Payment Term:</label><span>{{supplier.payment_term_name}}</span></div><div class="info" ng-show="supplier.bank_account_details"><label class="label-name">Bank Account Details:</label><div class="inline"><pre class="no-style">{{supplier.bank_account_details | na}}</pre></div></div><div class="info" ng-show="supplier.shipping_instruction"><label class="label-name">Speical Shipping Instruction:</label><span>{{supplier.shipping_instruction}}</span></div></div><div ng-show="supplier.editing"><ad-supplier-form ng-model="supplier.editing" on-cancel="supplier.editing = undefined" on-save="copy_fields(supplier.editing, supplier); supplier.editing = undefined"></ad-supplier-form></div><br /><div ad-notes="true" model-type="supplier" ng-model="supplier"></div></div><div modal="showing_delete_supplier_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this supplier</h3></div><div class="modal-body"><div>Are you sure you want to delete this supplier?</div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_supplier()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_supplier()">Cancel</button></div></div></div><div class="content-box"><div class="sub-header">Bills</div><div ad-supplier-transaction-history="true" supplier="supplier"></div></div></div><div class="column span5"><div class="content-box" ng-hide="supplier.is_creditor"><div class="sub-header">Creditor/Buying Group</div><div ng-hide="supplier.editing_creditor"><div class="editable" ng-click="select_creditor()" ng-show="supplier.creditor"><div class="info"><label class="label-name-left auto-width">Name:</label><span>{{supplier.creditor.registered_name || supplier.creditor.name}}</span></div><div class="info" ng-show="supplier.creditor.abn"><label class="label-name-left auto-width">ABN:</label><span>{{supplier.creditor.abn}}</span></div><div class="info" ng-show="supplier.creditor.acn"><label class="label-name-left auto-width">ACN:</label><span>{{supplier.creditor.acn}}</span></div><div class="info"><label class="label-name-left auto-width">Account Number:</label><span>{{supplier.creditor.account_number|na}}</span></div><br><a ng-href="#suppliers/{{supplier.creditor_id}}" stop-event="click">Details</a></br></div><div ng-hide="supplier.creditor"><a href="javascript:void(0);" ng-click="select_creditor()">Select One</a></div></div><div ng-show="supplier.editing_creditor"><div creditorpicker="true" ng-model="supplier.editing_creditor.creditor_id"></div><button class="btn btn-success" ng-click="save_selected_creditor()">Save</button><button class="btn" ng-click="cancel_select_creditor()">Cancel</button></div></div><div class="content-box"><div class="sub-header"><span>Stocks Supplied</span><div class="pull-right"><a class="btn" ng-href="/suppliers/{{supplier.id}}/stocks.pdf">Print</a></div></div><table class="table"><thead><tr><th>Stock</th><th>Supplier Stock No#</th></tr></thead><tbody ng-repeat="stock_supplier in stock_supplier_list.stock_suppliers"><tr class="editable" ng-click="edit_stock_supplier(stock_supplier)" ng-hide="stock_supplier.editing"><td>{{stock_supplier.stock.name}}</td><td>{{stock_supplier.supplier_stock_number}}</td></tr><tr class="editing-item" ng-show="stock_supplier.editing"><td><div ad-stockpicker="true" ng-model="stock_supplier.editing.stock"></div><br /><button class="btn btn-success" ng-click="save_stock_supplier(stock_supplier)">Save</button><button class="btn" ng-click="cancel_edit_stock_supplier(stock_supplier)">Cancel</button><button class="btn btn-danger" ng-click="delete_stock_supplier(stock_supplier)">Delete</button></td><td><input class="input-small" ng-model="stock_supplier.editing.supplier_stock_number" type="text" /></td></tr></tbody><tbody><tr class="editing-item" ng-show="new_stock_supplier"><td><div ad-stockpicker="true" ng-model="new_stock_supplier.stock"></div><br /><button class="btn btn-success" ng-click="save_new_stock_supplier()">Save</button><button class="btn" ng-click="cancel_create_stock_supplier()">Cancel</button></td><td><input class="input-small" ng-model="new_stock_supplier.supplier_stock_number" type="text" /></td></tr></tbody></table><div><a ng-click="create_stock_supplier()" ng-hide="new_stock_supplier">Add Stock</a></div><div></div><pagination boundary-links="true" current-page="stock_supplier_list.page" max-size="5" num-pages="stock_supplier_list.total_pages" on-select-page="selectStockSupplierPage(page)" rotate="false"></pagination></div><div class="content-box"><div ad-files="true" ng-model="supplier" title="Supplier&#39;s Documents/Photos" upload-url="&#39;/suppliers/&#39; + supplier.id +&#39;/upload_files&#39;"></div></div></div></div><div ad-merge-supplier="true" anchor-element="#merge-supplier-button" placement="left" showing="showing_merge_supplier" supplier="supplier"></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/suppliers/stocks_supplied.html",'<div class="content-box"><div class="sub-header"><span>Stocks Supplied</span><div class="pull-right"><a class="btn" ng-href="/suppliers/{{supplier.id}}/stocks.pdf">Print</a></div></div><table class="table"><thead><tr><th>Stock</th><th>Supplier Stock No#</th></tr></thead><tbody ng-repeat="stock_supplier in stock_supplier_list.stock_suppliers"><tr class="editable" ng-click="edit_stock_supplier(stock_supplier)" ng-hide="stock_supplier.editing"><td>{{stock_supplier.stock.name}}</td><td>{{stock_supplier.supplier_stock_number}}</td></tr><tr class="editing-item" ng-show="stock_supplier.editing"><td><div ad-stockpicker="true" ng-model="stock_supplier.editing.stock"></div><br /><button class="btn btn-success" ng-click="save_stock_supplier(stock_supplier)">Save</button><button class="btn" ng-click="cancel_edit_stock_supplier(stock_supplier)">Cancel</button><button class="btn btn-danger" ng-click="delete_stock_supplier(stock_supplier)">Delete</button></td><td><input class="input-small" ng-model="stock_supplier.editing.supplier_stock_number" type="text" /></td></tr></tbody><tbody><tr class="editing-item" ng-show="new_stock_supplier"><td><div ad-stockpicker="true" ng-model="new_stock_supplier.stock"></div><br /><button class="btn btn-success" ng-click="save_new_stock_supplier()">Save</button><button class="btn" ng-click="cancel_create_stock_supplier()">Cancel</button></td><td><input class="input-small" ng-model="new_stock_supplier.supplier_stock_number" type="text" /></td></tr></tbody></table><div><a ng-click="create_stock_supplier()" ng-hide="new_stock_supplier">Add Stock</a></div><div></div><pagination boundary-links="true" current-page="stock_supplier_list.page" max-size="5" num-pages="stock_supplier_list.total_pages" on-select-page="selectStockSupplierPage(page)" rotate="false"></pagination></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/suppliers/supplier_details.html",'<div class="content-nav"><ul><li ng-class="{active: left_side==&#39;details&#39;}" ng-click="show_left_side(&#39;details&#39;)"><a>Supplier Details</a></li><li ng-class="{active: left_side == &#39;contacts&#39;}" ng-click="show_left_side(&#39;contacts&#39;)"><a>Contacts</a></li></ul></div><div class="content-box supplier-info"><div ng-show="left_side == &#39;contacts&#39;"><div class="spinner" id="supplier-contacts-spinner"></div><div class="sub-header">Contacts</div><table class="table table-striped" style="max-height: 600px; y-overflow: scroll;"><thead><tr><th><div class="row-fluid"><div class="column span4">Name</div><div class="column span3">Phone/Mobile</div><div class="column span3">Email</div><div class="column span2">Position</div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="c in supplier.contacts"><td><div class="row-fluid" ng-click="edit_contact(c)" ng-hide="c.editing"><div class="column span4">{{c.name}}</div><div class="column span3"><div>{{c.phone}}</div><div>{{c.mobile}}</div></div><div class="column span3">{{c.email}}</div><div class="column span2">{{c.position}}</div></div><div class="row-fluid" ng-show="c.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input ng-model="c.editing.name" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="c.editing.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Mobile</label><div class="controls"><input ng-model="c.editing.mobile" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input ng-model="c.editing.email" type="text" /></div></div><div class="control-group"><label class="control-label">Title/Position</label><div class="controls"><input ng-model="c.editing.position" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_contact(c)" type="submit">Save</button><button class="btn" ng-click="cancel_editing_contact(c)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="destroy_contact(c)">Remove</button></div></div></div></form></div></td></tr><tr><td><div ng-hide="new_contact"><a href="javascript:void(0);" ng-click="create_contact()">New Contact</a></div><div ng-show="new_contact"><form class="form-horizontal"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input ng-model="new_contact.name" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><input ng-model="new_contact.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Mobile</label><div class="controls"><input ng-model="new_contact.mobile" type="text" /></div></div><div class="control-group"><label class="control-label">Email</label><div class="controls"><input ng-model="new_contact.email" type="text" /></div></div><div class="control-group"><label class="control-label">Title/Position</label><div class="controls"><input ng-model="new_contact.position" type="text" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_new_contact()" type="submit">Save</button><button class="btn" ng-click="cancel_new_contact()">Cancel</button></div></div></form></div></td></tr></tbody></table></div><div ng-show="left_side == &#39;details&#39;"><div class="editable" ng-click="edit_supplier()" ng-hide="supplier.editing"><div class="info"><label class="label-name">Full Name:</label><span>{{supplier.registered_name || supplier.name}}</span></div><div class="info"><label class="label-name">Account No#:</label><span>{{supplier.account_number}}</span></div><div class="info" ng-show="country() == &#39;au&#39;"><label class="label-name">ABN:</label><span>{{supplier.abn}}</span></div><div class="info"><label class="label-name">Phone:</label><span>{{supplier.phone}}</span></div><div class="info"><label class="label-name">Mobile:</label><span>{{supplier.mobile}}</span></div><div class="info"><label class="label-name">Fax:</label><span>{{supplier.fax}}</span></div><div class="info"><label class="label-name">Email:</label><span>{{supplier.email}}</span></div><div class="info" ng-show="supplier.contact_name"><label class="label-name">Contact Person:</label><span>{{supplier.contact_name}}</span></div><div class="info"><label class="label-name">Postal Address:</label><span>{{supplier.address.full_address}}</span></div><div class="info" ng-show="supplier.street_address"><label class="label-name">Street Address:</label><span>{{supplier.street_address.full_address}}</span></div><div class="info"><label class="label-name">Payment Term:</label><span>{{supplier.payment_term_name}}</span></div><div class="info" ng-show="supplier.bank_account_details"><label class="label-name">Bank Account Details:</label><div class="inline"><pre class="no-style">{{supplier.bank_account_details | na}}</pre></div></div><div class="info" ng-show="supplier.shipping_instruction"><label class="label-name">Speical Shipping Instruction:</label><span>{{supplier.shipping_instruction}}</span></div></div><div ng-show="supplier.editing"><ad-supplier-form ng-model="supplier.editing" on-cancel="supplier.editing = undefined" on-save="copy_fields(supplier.editing, supplier); supplier.editing = undefined"></ad-supplier-form></div><br /><div ad-notes="true" model-type="supplier" ng-model="supplier"></div></div><div modal="showing_delete_supplier_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this supplier</h3></div><div class="modal-body"><div>Are you sure you want to delete this supplier?</div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_supplier()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_supplier()">Cancel</button></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("inventory/tabs.html",'<ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("invoices/customer_details.html",'<div class="vehicle-owner-details goto" ng-click="show_customer()"><div class="inline" id="customer-name"></div><div class="bold">{{invoice.customer.name}}</div><div class="address"><div ng-show="invoice.customer.address">{{invoice.customer.address.street_line}}</div><div ng-show="invoice.customer.address">{{invoice.customer.address.suburb_line}}</div></div><div ng-show="invoice.customer.phone || invoice.customer.mobile"><span class="label-name-left auto-width">Tel:</span><span ng-show="invoice.customer.phone">{{invoice.customer.phone}}</span><span ng-hide="invoice.customer.phone">{{invoice.customer.mobile}}</span></div><div ng-show="invoice.customer.abn"><span class="label-name-left auto-width">ABN:</span><span>{{invoice.customer.abn}}</span></div></div><div><a href="javascript:void(0)" id="change-customer-button" ng-click="change_customer()">Change</a></div><div ad-change-customer="true" anchor-element="#change-customer-button" customer="customer" invoice="invoice" showing="changing_customer"></div><div id="customer"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{customer.name}}<div class="pull-right"><a class="btn" ng-href="#/customers/{{customer.id}}"><i class="icon-external-link"></i><span>Full Details</span></a><button class="btn" ng-click="close_customer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><ad-customer ng-model="customer" on-save="close_customer()" on-select-vehicle="goto_vehicle(vehicle)"></ad-customer></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("invoices/delete_confirmation.html",'<div modal="showing_delete_invoice_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this invoice</h3></div><div class="modal-body"><div>Are you sure you want to delete this invoice?</div><br /><div ng-show="invoice.finalized"><div class="div-pre bold">IMPORTANT! Editing a finalized invoice requires</div><div class="div-pre bold">manually updating the stock items\' quantity on hand</div></div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><div class="spinner" id="delete-invoice-spinner"></div><button class="btn btn-danger" ng-click="do_delete_invoice()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_invoice()">Cancel</button></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("invoices/editable.html",'<div class="content-box invoice"><div class="row-fluid"><div class="column span6"><div ng-show="invoice.logo_url"><img class="logo" ng-src="{{invoice.logo_url}}" style="max-height: 200px" /></div><div ng-hide="invoice.logo_url"><h3 class="registered-name">{{invoice.auto_workshop_name}}</h3></div><br /><br /></div><div class="column span6"><div class="invoice-word span12">TAX INVOICE</div><div><div ad-invoice-details="true" ng-model="invoice"></div></div></div></div><div class="row-fluid customer-detail"><div class="column span6"><div class="pointer"><div class="bold">BILL TO:</div><div class="vehicle-owner-details goto" ng-click="show_customer()"><div class="inline" id="customer-name"></div><div class="bold">{{invoice.customer.name}}</div><div class="address"><div ng-show="invoice.customer.address">{{invoice.customer.address.street_line}}</div><div ng-show="invoice.customer.address">{{invoice.customer.address.suburb_line}}</div></div><div ng-show="invoice.customer.phone || invoice.customer.mobile"><span class="label-name-left auto-width">Tel:</span><span ng-show="invoice.customer.phone">{{invoice.customer.phone}}</span><span ng-hide="invoice.customer.phone">{{invoice.customer.mobile}}</span></div><div ng-show="invoice.customer.abn"><span class="label-name-left auto-width">ABN:</span><span>{{invoice.customer.abn}}</span></div></div><div><a href="javascript:void(0)" id="change-customer-button" ng-click="change_customer()">Change</a></div><div ad-change-customer="true" anchor-element="#change-customer-button" customer="customer" invoice="invoice" showing="changing_customer"></div><div id="customer"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{customer.name}}<div class="pull-right"><a class="btn" ng-href="#/customers/{{customer.id}}"><i class="icon-external-link"></i><span>Full Details</span></a><button class="btn" ng-click="close_customer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><ad-customer ng-model="customer" on-save="close_customer()" on-select-vehicle="goto_vehicle(vehicle)"></ad-customer></div></div></div></div></div></div><div class="column span6"><div class="bold">FOR:</div><div class="editable" ng-click="edit_invoice_description()" ng-hide="invoice.editing_description"><div>{{invoice.description}}</div><div ng-show="customer.is_insurer"><span class="label-name-left auto-width">Claim No.#:</span>{{invoice.claim_number}}</div><div ng-show="invoice.account_number"><span class="label-name-left auto-width">Account No.#:</span>{{invoice.account_number}}</div><div ng-show="customer.is_insurer"><span class="label-name-left auto-width">Excess:</span>{{invoice.excess|currency}}</div></div><div class="editing-item" ng-show="invoice.editing_description"><form class="form form-inline"><div class="row-fluid"><div class="column span4" style="text-align: right">Description:</div><div class="column span8"><input ng-model="invoice.editing_description.description" type="text" /></div></div><div ng-show="customer.is_insurer"><div class="row-fluid"><div class="column span4" style="text-align: right">Claim No.#:</div><div class="column span8"><input class="span12" ng-model="invoice.editing_description.claim_number" type="text" /></div></div><div class="row-fluid"><div class="column span4" style="text-align: right">Account No.#:</div><div class="coumn span8"><input class="span12" ng-model="invoice.editing_description.account_number" type="text" /></div></div><div class="row-fluid"><div class="column span4" style="text-align: right">Excess:</div><div class="column span8"><input class="span12" ng-model="invoice.editing_description.excess" type="text" /></div></div></div><br /><div class="row-fluid"><div class="column span4"></div><div class="column span8"><button class="btn btn-success" ng-click="save_invoice_description()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_description&#39;)">Cancel</button></div></div></form></div><div class="vehicle-details"><div class="goto" ng-show="invoice.vehicle"><div ng-click="show_vehicle()"><div><span class="label-name-left auto-width">Model:</span>{{invoice.vehicle.title}}</div><div ng-show="invoice.vehicle.registration_number"><span class="label-name-left auto-width">Reg No.:</span>{{invoice.vehicle.registration_number}}</div><div ng-show="invoice.vehicle.fleet_number"><span class="label-name-left auto-width">Fleet No.:</span>{{invoice.vehicle.fleet_number}}</div><div ng-show="invoice.vehicle.body"><span class="label-name-left auto-width">Body Type:</span>{{invoice.vehicle.body}}</div></div><div class="editable" ng-click="edit_invoice_odometer()" ng-hide="invoice.editing_odometer"><span class="label-name-left auto-width">Odometer:</span>{{invoice.odometer|number}} {{invoice.vehicle.odometer_unit}}</div><div class="editing-item" ng-show="invoice.editing_odometer"><form class="form form-inline"><span class="label-name-left auto-width">Odometer:</span><input ng-model="invoice.editing_odometer.odometer" type="text" />&nbsp;<br /><br /><button class="btn btn-success" ng-click="save_invoice_odometer()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_odometer&#39;)">Cancel</button></form></div><div ng-show="asset_property_set().machine_hours"><div class="editable" ng-click="edit_invoice_machine_hours()" ng-hide="invoice.editing_machine_hours"><span class="label-name-left auto-width">Machine Hours:</span>{{invoice.machine_hours|number}} {{invoice.vehicle.machine_hours_unit}}</div><div class="editing-item" ng-show="invoice.editing_machine_hours"><form class="form form-inline"><span class="label-name-left auto-width">Machine Hours:</span><input ng-model="invoice.editing_machine_hours.machine_hours" type="text" />&nbsp;<br /><br /><button class="btn btn-success" ng-click="save_invoice_machine_hours()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_machine_hours&#39;)">Cancel</button></form></div></div><div ng-show="asset_property_set().engine_hours"><div class="editable" ng-click="edit_invoice_engine_hours()" ng-hide="invoice.editing_engine_hours"><span class="label-name-left auto-width">Engine Hours:</span>{{invoice.engine_hours|number}} hr(s)</div><div class="editing-item" ng-show="invoice.editing_engine_hours"><form class="form form-inline"><span class="label-name-left auto-width">Engine Hours:</span><input ng-model="invoice.editing_engine_hours.engine_hours" type="text" />&nbsp;<br /><br /><button class="btn btn-success" ng-click="save_invoice_engine_hours()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_engine_hours&#39;)">Cancel</button></form></div></div><div class="editable" ng-click="edit_invoice_hubodometer()" ng-hide="invoice.editing_hubodometer" ng-show="show_hubodometer()"><span class="label-name-left auto-width">Hubodometer:</span>{{invoice.hubodometer|number}} {{invoice.vehicle.odometer_unit}}</div><div class="editing-item" ng-show="invoice.editing_hubodometer"><form class="form form-inline"><span class="label-name-left auto-width">Hubodometer:</span><input ng-model="invoice.editing_hubodometer.hubodometer" type="text" />&nbsp;<br /><br /><button class="btn btn-success" ng-click="save_invoice_hubodometer()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_hubodometer&#39;)">Cancel</button></form></div></div><div class="goto" ng-hide="invoice.vehicle"><button class="btn btn-link" ng-click="change_vehicle()">Select A {{asset_name()}}</button></div></div><div id="vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="row-fluid"><div class="sub-header">{{invoice.vehicle.title}}<div class="pull-right"><button class="btn btn-danger" ng-click="change_vehicle()"><i class="icon-refresh"></i>Change To Different {{asset_name()}}</button><button class="btn" ng-click="close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div></div><div class="popover-content"><div class="row-fluid"><ad-vehicle ng-model="invoice.vehicle" on-save="close_vehicle()"></ad-vehicle></div></div></div></div><div id="new-vehicle"><div class="popover fade left in" style="width: 550px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">{{asset_name()}}</div></div><div class="popover-content"><form class="form-horizontal"><div ad-vehicle-form="true" ng-model="new_vehicle"></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_new_vehicle()">Save</button><button class="btn" ng-click="cancel_create_new_vehicle()" type="button">Cancel</button><div class="spinner" id="save-vehicle-spinner"></div></div></div></form></div></div></div><div id="change-vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="row-fluid"><div class="sub-header">{{vehicle.title}}<div class="pull-right"><button class="btn" ng-click="show_vehicle()" ng-show="invoice.vehicle">Show Current {{asset_name()}}</button><button class="btn btn-primary" ng-click="create_vehicle()" ng-hide="invoice.vehicle">Create New {{asset_name()}}</button><button class="btn" ng-click="close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-change-vehicle="true" model-type="invoice" ng-model="invoice" on-cancel="show_vehicle()" on-save="close_vehicle()" showing="changing_vehicle" vehicle="invoice.vehicle"></div></div></div></div></div></div></div><br /><div ad-invoice="true" class="row-fluid" ng-model="invoice" on-oscar-success="load()" on-repco-success="load()"></div></div><div ad-pay-invoice="true" anchor-element="#pay" ng-model="invoice" showing="paying"></div><div modal="showing_delete_invoice_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this invoice</h3></div><div class="modal-body"><div>Are you sure you want to delete this invoice?</div><br /><div ng-show="invoice.finalized"><div class="div-pre bold">IMPORTANT! Editing a finalized invoice requires</div><div class="div-pre bold">manually updating the stock items\' quantity on hand</div></div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><div class="spinner" id="delete-invoice-spinner"></div><button class="btn btn-danger" ng-click="do_delete_invoice()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_invoice()">Cancel</button></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("invoices/index.html",'<div ng-controller="InvoicesController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="spinner" id="invoices-spinner"></div><div class="row-fluid"><div class="page-header"><span>Invoices</span><div class="pull-right"><form class="form-search form-inline form-search-invoice"><div class="inline"><button class="btn btn-link" ng-click="show_filter()" ng-hide="showing_filter" type="button">More Options</button><button class="btn btn-link" ng-click="hide_filter()" ng-show="showing_filter" type="button">Hide</button><div class="inline" ng-show="showing_filter"><label class="inline">Issued From:</label><ad-datepicker ng-model="query.issued_from"><span class="add-on"><i class="icon-calendar"></i></span></ad-datepicker><label class="inline">To:</label><ad-datepicker ng-model="query.issued_to"></ad-datepicker><br /><label class="label-name-left">Including:</label><label class="checkbox"><input check-list="query.statuses" type="checkbox" value="paid" />paid</label><label class="checkbox"><input check-list="query.statuses" type="checkbox" value="unpaid" />unpaid</label><label class="checkbox"><input check-list="query.statuses" type="checkbox" value="deleted" />deleted</label></div><div class="inline search-box"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()" type="submit"><i class="icon-search"></i>Search</button></div></div></form></div></div></div><div class="row-fluid"><div class="search-description" ng-show="keyword">Search "{{keyword}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="pull-right"><div class="spinner inline" id="invoice-bulk-action-spinner"></div><div class="dropdown inline" id="invoice-bulk-actions"><a class="btn" dropdown-toggle="true"><i class="icon icon-list-alt"></i><span>Bulk Action...</span></a><ul class="dropdown-menu top-dropdown"><li><a href="javascript:void(0);" ng-click="bulk_print()"><i class="icon icon-print"></i><span>Print</span></a></li><li><a href="javascript:void(0);" ng-click="bulk_finalize()"><i class="icon icon-print"></i><span>Finalize</span></a></li><li><a href="javascript:void(0);" ng-click="start_bulk_send()"><i class="icon icon-envelope"></i><span>Send</span></a></li></ul></div><a class="btn btn-primary" ng-href="#/invoices/new">New Invoice</a><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><div class="row-fluid" style="margin-top: 10px"><div class="column span3"><label class="checkbox"><input ng-change="toggle_unpaid()" ng-model="showing_unpaid" type="checkbox" /><span class="label label-info">unpaid</span> <span>invoices only</span></label><label class="checkbox"><input ng-change="toggle_paid()" ng-model="showing_paid" type="checkbox" /><span class="label label-success">paid</span> <span>invoices only</span></label><label class="checkbox"><input ng-change="toggle_deleted()" ng-model="showing_deleted" type="checkbox" /><span class="label label-important">deleted</span> <span>invoices only</span></label></div><div class="column span3"><label class="checkbox"><input ng-change="toggle_in_progress()" ng-model="showing_in_progress" type="checkbox" /><span class="label label-info">in progress</span> <span>invoices only</span></label><label class="checkbox"><input ng-click="toggle_finalized()" ng-model="showing_finalized" type="checkbox" /><span class="label label-success">finalized</span> <span>invoices only</span></label></div><div class="column span3" style="vertical-align: bottom"><div>&nbsp;</div><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div></div><br /><div class="label label-info" ng-show="message">{{message}}</div><div class="content-box"><table class="table table-striped invoice-list" ng-show="showing_deleted"><thead><tr><th><div class="row-fluid"><div class="column span2"><div class="invoice-list-item inline">Invoice No#</div></div><div class="column span1"><div class="invoice-list-item column-sortable" ng-click="sort(&#39;issue_date&#39;)">Issue Date</div></div><div class="column span3"><div class="invoice-list-item">Description</div></div><div class="column span2"><div class="invoice-list-item">Customer/{{asset_name()}}</div></div><div class="column span3"><div class="invoice-list-item">Deletion entry</div></div><div class="column span1"></div></div></th></tr></thead><tbody><tr ng-repeat="invoice in invoices"><td><div class="row-fluid"><div class="column span2"><div class="invoice-list-item">#{{invoice.number}}</div></div><div class="column span1"><div class="invoice-list-item">{{invoice.issue_date | date: \'shortDate\'}}</div></div><div class="column span3"><div class="invoice-list-item-description"><div>{{invoice.description}}</div><div class="job-list-item-order-number" ng-show="invoice.order_number">Order #: {{invoice.order_number}}</div></div></div><div class="column span2"><div class="invoice-list-item">{{invoice.customer_name}}</div><div class="invoice-list-item">{{invoice.vehicle.title}}</div></div><div class="column span3"><div class="invoice-list-item red">By {{invoice.deleted_by.name}}</div><div class="invoice-list-item red">On {{invoice.deleted_at | date: \'mediumDate\'}}</div><div class="invoice-list-item">{{invoice.deleted_reason}}</div></div><div class="column span1"><button class="btn btn-info" ng-click="undelete(invoice)" ng-show="can_undelete_invoice()">Undelete</button></div></div></td></tr></tbody></table><div id="invoice-index-list"></div><table class="table table-striped invoice-list" ng-hide="showing_deleted"><thead><tr><th><div class="row-fluid"><div class="column span2"><label class="checkbox inline"><input ng-click="toggle_select_all()" type="checkbox" /></label><div class="inline">&nbsp;</div><div class="invoice-list-item inline">Invoice No#</div></div><div class="column span10"><div class="row-fluid"><div class="column span1"><div class="invoice-list-item">Job</div></div><div class="column span1"><div class="invoice-list-item column-sortable" ng-click="sort(&#39;issue_date&#39;)">Issue Date</div></div><div class="column span1"><div class="invoice-list-item">Due Date</div></div><div class="column span3"><div class="invoice-list-item">Description</div></div><div class="column span2"><div class="invoice-list-item">Customer/{{asset_name()}}</div></div><div class="column span1"><div class="invoice-list-item text-align-right">Amount</div></div><div class="column span2"><div class="invoice-list-item text-align-right">Due</div></div><div class="column span1"></div></div></div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="invoice in invoices"><td><div class="row-fluid"><div class="column span2"><div class="invoice-list-item"><label class="checkbox"><input ng-model="invoice.selected" type="checkbox" /><div class="invoice-list-item-number">#{{invoice.number}}</div></label></div><div><span class="label label-success" ng-show="invoice.finalized">Finalized</span><span class="label label-info" ng-show="!invoice.finalized">In progress</span></div><div class="invoice-list-item" ng-show="invoice.email_status"><span class="green" ng-show="invoice.email_status==&#39;delivered&#39;">Email delivered</span><span class="blue" ng-show="invoice.email_status !=&#39;delivered&#39;">Email {{invoice.email_status}}</span></div></div><div class="column span10"><a class="goto" ng-href="{{invoice_path(invoice)}}"><div class="row-fluid"><div class="column span1"><div class="invoice-list-item">{{invoice.job && invoice.job.number || \'\'}}</div></div><div class="column span1"><div class="invoice-list-item">{{invoice.issue_date | date: \'shortDate\'}}</div></div><div class="column span1"><div class="invoice-list-item">{{invoice.due_date | date: \'shortDate\'}}</div></div><div class="column span3"><div class="invoice-list-item-description">{{invoice.description}}</div><div class="job-list-item-order-number" ng-show="invoice.order_number">Order #: {{invoice.order_number}}</div><div ad-tag-icons="true" class="invoice-list-item" owner="invoice"></div></div><div class="column span2"><div class="invoice-list-item"><div>{{invoice.customer_name}}</div><div>{{invoice.vehicle.title}}</div></div></div><div class="column span1"><div class="invoice-list-item text-align-right">{{invoice.total_amount|currency}}</div></div><div class="column span2"><div class="invoice-list-item text-align-right" ng-class="{red: invoice.unpaid_amount &gt; 0, green: invoice.unpaid_amount == 0}">{{invoice.unpaid_amount|currency}}</div></div><div class="column span1"><div class="invoice-list-item" id="preview-{{invoice.id}}"><a href="javascript:void(0);" ng-click="preview(invoice)">Preview</a></div></div></div></a></div></div></td></tr></tbody></table><pagination boundary-links="true" current-page="page_number" max-size="20" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div><div ad-invoice-viewer="true" anchor-element="preview_anchor" invoice="previewed_invoice" placement="left" showing="previewed_invoice"></div><div id="bulk-send-invoice-popover"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Send Email</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form name="bulk_send_invoice_form" novalidate="true"><div class="pull-right"><div class="inline" id="bulk-send-invoice-spinner"></div></div><label><div class="row-fluid"><span>Email</span> <span class="error" ng-show="!email">(email address is required)</span></div><input class="span9" id="bulk-send-invoice-address" name="email" ng-model="email" required="true" type="text" /></label><label><span>Subject</span> </label><input class="span12" id="bulk-send-invoice-subject" ng-model="email_subject" type="text" /><label>Message</label><textarea class="span12" id="bulk-send-invoice-message" ng-model="email_message" type="text"></textarea><br /><br /><div><button class="btn btn-success" ng-click="bulk_send()">Send</button><button class="btn" ng-click="cancel_bulk_send()">Cancel</button></div></form></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("invoices/invoice_files.html",'<div class="sub-header"><div class="inline" id="invoice-photos">Photos/Documents</div><div class="pull-right" ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_invoice_files()">Upload</button></div></div><div class="invoice-files" ng-hide="uploading_files"><div class="pull-right"></div><div class="inline invoice-photo" ng-repeat="photo in invoice.photos" style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><div ng-show="invoice.documents.length &gt; 0"><div class="bold">Documents</div><div ng-repeat="document in invoice.documents"><div class="editable" ng-click="edit_file(document)" ng-hide="document.editing"><span>{{document.file_name}} &nbsp;</span><a ng-href="{{document.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="document.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="document.editing.file_name" type="text" /></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(document)">Save</button><button class="btn" ng-click="cancel_edit_file(document)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(document)">Remove</button></div></form></div></div></div></div><div id="photo-viewer"><div class="popover fade right in" style="width: 800px; height: 1000px"><div class="popover-title"><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="full_size_photo()">Full Size</button><button class="btn" ng-click="close_photo_viewer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div style="height: 750px"><carousel><slide active="photo.active" ng-repeat="photo in invoice.photos"><img ng-src="{{photo.url}}" style="margin:auto; max-width: 100%; max-height:750px;" /></slide></carousel></div></div><div class="row-fluid"><center><div class="inline job-photo" ng-class="{&#39;invoice-photo-active&#39;: photo.active}" ng-repeat="photo in invoice.photos"><div style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><button class="btn btn-danger" ng-click="remove_photo(photo)" ng-show="photo.active">Remove</button></div></center></div></div></div></div><form action="/invoices/{{invoice.id}}/upload_files" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /></div><br /><div class="inline" id="upload-photos-spinner"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("invoices/new.html",'<div ng-controller="NewInvoiceController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">New Invoice</div><div class="content-box new-invoice"><div class="row-fluid"><div class="column span7"><form class="form form-horizontal" name="new_invoice_form" novalidate="true"><div ad-customer-vehicle-form="true" customer="invoice.customer" recommendations="recommendations" selection="selection" vehicle="invoice.vehicle"></div><div class="sub-header">Invoices Information</div><div ng-model="invoice" royaltypicker="true"></div><div class="control-group"><label class="control-label">Issue Date</label><div class="controls"><ad-datepicker ng-model="invoice.issue_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Due Date</label><div class="controls"><ad-datepicker ng-model="invoice.due_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Order Number</label><div class="controls"><input class="input-small" ng-model="invoice.order_number" type="text" /></div></div><div class="control-group"><label class="control-label">Odometer</label><div class="controls"><input class="input-small" ng-model="invoice.odometer" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().machine_hours"><label class="control-label">Machine Hours</label><div class="controls"><input class="input-small" ng-model="invoice.machine_hours" type="text" /></div></div><div class="control-group" ng-show="show_hubodometer()"><label class="control-label">Hubodometer</label><div class="controls"><input class="input-small" ng-model="invoice.hubodometer" type="text" /></div></div><div class="control-group"><label class="control-label">Invoice Description</label><div class="controls"><input class="input-xlarge" ng-model="invoice.description" type="text" /></div></div><div class="control-group"><label class="control-label">Salesperson</label><div class="controls"><select class="inline" name="employee" ng-model="invoice.employee_id" ng-options="employee.id as employee.name for employee in employees()"><option value=""></option></select></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="invoice"></div></div><br /><br /><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_invoice()">Continue</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="create-invoice-spinner"></div></div></div></form></div><div class="column span5"><div ad-customer-vehicle-recommendations="true" ng-model="recommendations" selection="selection"></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("invoices/paid.html",'<div class="content-box invoice"><div class="row-fluid"><div class="column span8"><div ng-show="invoice.logo_url"><img class="logo" ng-src="{{invoice.logo_url}}" /></div><div ng-hide="invoice.logo_url"><div class="registered-name">{{invoice.auto_workshop_name}}</div></div><br /><br /><div ng-show="invoice.auto_workshop_street">{{invoice.auto_workshop_street}}</div><div ng-show="invoice.auto_workshop_suburb">{{invoice.auto_workshop_suburb}}</div><div ng-show="auto_workshop.abn"><span class="label-name-left auto-width">ABN:</span>{{auto_workshop.abn}}</div><div ng-show="auto_workshop.acn"><span class="label-name-left auto-width">ACN:</span>{{auto_workshop.abn}}</div><div ng-show="auto_workshop.phone"><span class="label-name-left auto-width">Tel:</span>{{auto_workshop.phone}}</div><div ng-show="auto_workshop.fax"><span class="label-name-left auto-width">Fax:</span>{{auto_workshop.fax}}</div><div ng-show="auto_workshop.email"><span class="label-name-left auto-width">Email:</span>{{auto_workshop.email}}</div><div ng-show="auto_workshop.website"><span class="label-name-left auto-width">Website:</span>{{auto_workshop.website}}</div></div><div class="column span4"><div class="invoice-word span12">TAX INVOICE</div><div><span class="label-name-left label-issue-date">Issue Date:</span><span class="issue-date">{{invoice.issue_date|date: \'mediumDate\'}}</span></div><div><span class="label-name-left label-invoice-number">Invoice Number:</span><span class="invoice-number">{{invoice.number}}</span></div></div></div><div class="row-fluid customer-detail"><div class="column span8"><div><div class="bold">BILL TO:</div><div class="bold">{{invoice.customer_name}}</div><div class="address"><div ng-show="invoice.customer_street">{{invoice.customer_street}}</div><div ng-show="invoice.customer_suburb">{{invoice.customer_suburb}}</div></div><div ng-show="invoice.customer_phone"><span class="label-name-left auto-width">Tel:</span><span>{{invoice.customer_phone}}</span></div></div></div><div class="column span4"><div class="bold">FOR:</div><div>{{invoice.description}}</div></div></div><div class="row-fluid"><div class="invoice-table"><div class="header"><div class="description">Description</div><div class="quantity">Quantity</div><div class="unit-price">Unit Price</div><div class="amount">Amount</div></div><div class="invoice-item" ng-repeat="item in invoice.items"><div><div class="description">{{item.description}}</div><div class="quantity">{{item.quantity}}</div><div class="unit-price">{{item.unit_price|currency}}</div><div class="amount">{{item.net_amount | currency}}</div></div></div><div class="summary"><div><div class="title">Subtotal</div><div class="value">{{invoice.net_amount|currency}}</div></div><div><div class="title">{{tax_name()}}</div><div class="value">{{invoice.gst_amount|currency}}</div></div><div><div class="title">Total</div><div class="value">{{invoice.total_amount|currency}}</div></div><div><div class="title">Balance Due</div><div class="value">{{invoice.unpaid_amount|currency}}</div></div></div></div></div><div class="row-fluid" ng-show="invoice.details"><div class="bold">DETAILS:</div><pre><div ng-bind-html-unsafe="invoice.details"></div></pre></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("invoices/show.html",'<div class="invoice" ng-controller="InvoiceController"><div ng-show="view == &#39;invoices&#39;"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul></div><div ng-show="view == &#39;jobs&#39;"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul></div><div ng-hide="invoice &amp;&amp; invoice.id"><div class="spinner" id="invoice-loading"></div></div><div ng-show="invoice &amp;&amp; invoice.id"><div class="deleted-sign" ng-show="invoice.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><div class="row-fluid"><div class="pull-left"><div class="page-header">{{job.title}} Invoice</div></div><div class="pull-right"><div ad-tag-labels="true" class="inline" owner="invoice"></div><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="invoice" placement="left" resource="Invoice" showing="x_tags"></div></div></div><div class="row-fluid"><div class="pull-right"><a class="btn" href="#/jobs/{{job.id}}" ng-show="invoice.job"><i class="icon-arrow-left"></i>Back To Job</a><a class="btn" href="#/jobs/new?invoice_id={{invoice.id}}" ng-hide="invoice.job">Create Job</a><button class="btn btn-primary" id="pay" ng-click="start_pay()" ng-hide="invoice.paid || invoice.deleted || restricted_to_enter_payment()"><i class="icon-dollar"></i>Pay</button><div class="inline" ng-hide="invoice.deleted"><div ad-invoice-actions="true" email="invoice.customer.email" ng-model="invoice"></div></div><a class="btn" id="invoice-add-credit-button" ng-href="#/credit_notes/new?original_invoice_id={{invoice.id}}&amp;customer_id={{invoice.customer.id}}&amp;customer_name={{invoice.customer.name}}&amp;original_invoice_number={{invoice.number}}&amp;original_invoice_total_amount={{invoice.total_amount}}">Add Credit Note</a><button class="btn" ng-click="copy_invoice()">Copy</button><div class="spinner" id="copy-invoice-spinner"></div><button class="btn btn-danger btn-delete" ng-click="delete_invoice()" ng-hide="invoice.deleted || invoice.paid || restricted_to(&#39;deletion&#39;)">Delete</button><img class="paid-sign" ng-show="invoice.paid" src="/assets/paid-d5240fc8cfeec7b14de62c19cf6d9848.gif" /></div></div><br /><div class="row-fluid"><div class="column span7"><div class="content-box invoice"><div class="row-fluid"><div class="column span6"><div ng-show="invoice.logo_url"><img class="logo" ng-src="{{invoice.logo_url}}" style="max-height: 200px" /></div><div ng-hide="invoice.logo_url"><h3 class="registered-name">{{invoice.auto_workshop_name}}</h3></div><br /><br /></div><div class="column span6"><div class="invoice-word span12">TAX INVOICE</div><div><div ad-invoice-details="true" ng-model="invoice"></div></div></div></div><div class="row-fluid customer-detail"><div class="column span6"><div class="pointer"><div class="bold">BILL TO:</div><div class="vehicle-owner-details goto" ng-click="show_customer()"><div class="inline" id="customer-name"></div><div class="bold">{{invoice.customer.name}}</div><div class="address"><div ng-show="invoice.customer.address">{{invoice.customer.address.street_line}}</div><div ng-show="invoice.customer.address">{{invoice.customer.address.suburb_line}}</div></div><div ng-show="invoice.customer.phone || invoice.customer.mobile"><span class="label-name-left auto-width">Tel:</span><span ng-show="invoice.customer.phone">{{invoice.customer.phone}}</span><span ng-hide="invoice.customer.phone">{{invoice.customer.mobile}}</span></div><div ng-show="invoice.customer.abn"><span class="label-name-left auto-width">ABN:</span><span>{{invoice.customer.abn}}</span></div></div><div><a href="javascript:void(0)" id="change-customer-button" ng-click="change_customer()">Change</a></div><div ad-change-customer="true" anchor-element="#change-customer-button" customer="customer" invoice="invoice" showing="changing_customer"></div><div id="customer"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{customer.name}}<div class="pull-right"><a class="btn" ng-href="#/customers/{{customer.id}}"><i class="icon-external-link"></i><span>Full Details</span></a><button class="btn" ng-click="close_customer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><ad-customer ng-model="customer" on-save="close_customer()" on-select-vehicle="goto_vehicle(vehicle)"></ad-customer></div></div></div></div></div></div><div class="column span6"><div class="bold">FOR:</div><div class="editable" ng-click="edit_invoice_description()" ng-hide="invoice.editing_description"><div>{{invoice.description}}</div><div ng-show="customer.is_insurer"><span class="label-name-left auto-width">Claim No.#:</span>{{invoice.claim_number}}</div><div ng-show="invoice.account_number"><span class="label-name-left auto-width">Account No.#:</span>{{invoice.account_number}}</div><div ng-show="customer.is_insurer"><span class="label-name-left auto-width">Excess:</span>{{invoice.excess|currency}}</div></div><div class="editing-item" ng-show="invoice.editing_description"><form class="form form-inline"><div class="row-fluid"><div class="column span4" style="text-align: right">Description:</div><div class="column span8"><input ng-model="invoice.editing_description.description" type="text" /></div></div><div ng-show="customer.is_insurer"><div class="row-fluid"><div class="column span4" style="text-align: right">Claim No.#:</div><div class="column span8"><input class="span12" ng-model="invoice.editing_description.claim_number" type="text" /></div></div><div class="row-fluid"><div class="column span4" style="text-align: right">Account No.#:</div><div class="coumn span8"><input class="span12" ng-model="invoice.editing_description.account_number" type="text" /></div></div><div class="row-fluid"><div class="column span4" style="text-align: right">Excess:</div><div class="column span8"><input class="span12" ng-model="invoice.editing_description.excess" type="text" /></div></div></div><br /><div class="row-fluid"><div class="column span4"></div><div class="column span8"><button class="btn btn-success" ng-click="save_invoice_description()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_description&#39;)">Cancel</button></div></div></form></div><div class="vehicle-details"><div class="goto" ng-show="invoice.vehicle"><div ng-click="show_vehicle()"><div><span class="label-name-left auto-width">Model:</span>{{invoice.vehicle.title}}</div><div ng-show="invoice.vehicle.registration_number"><span class="label-name-left auto-width">Reg No.:</span>{{invoice.vehicle.registration_number}}</div><div ng-show="invoice.vehicle.fleet_number"><span class="label-name-left auto-width">Fleet No.:</span>{{invoice.vehicle.fleet_number}}</div><div ng-show="invoice.vehicle.body"><span class="label-name-left auto-width">Body Type:</span>{{invoice.vehicle.body}}</div></div><div class="editable" ng-click="edit_invoice_odometer()" ng-hide="invoice.editing_odometer"><span class="label-name-left auto-width">Odometer:</span>{{invoice.odometer|number}} {{invoice.vehicle.odometer_unit}}</div><div class="editing-item" ng-show="invoice.editing_odometer"><form class="form form-inline"><span class="label-name-left auto-width">Odometer:</span><input ng-model="invoice.editing_odometer.odometer" type="text" />&nbsp;<br /><br /><button class="btn btn-success" ng-click="save_invoice_odometer()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_odometer&#39;)">Cancel</button></form></div><div ng-show="asset_property_set().machine_hours"><div class="editable" ng-click="edit_invoice_machine_hours()" ng-hide="invoice.editing_machine_hours"><span class="label-name-left auto-width">Machine Hours:</span>{{invoice.machine_hours|number}} {{invoice.vehicle.machine_hours_unit}}</div><div class="editing-item" ng-show="invoice.editing_machine_hours"><form class="form form-inline"><span class="label-name-left auto-width">Machine Hours:</span><input ng-model="invoice.editing_machine_hours.machine_hours" type="text" />&nbsp;<br /><br /><button class="btn btn-success" ng-click="save_invoice_machine_hours()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_machine_hours&#39;)">Cancel</button></form></div></div><div ng-show="asset_property_set().engine_hours"><div class="editable" ng-click="edit_invoice_engine_hours()" ng-hide="invoice.editing_engine_hours"><span class="label-name-left auto-width">Engine Hours:</span>{{invoice.engine_hours|number}} hr(s)</div><div class="editing-item" ng-show="invoice.editing_engine_hours"><form class="form form-inline"><span class="label-name-left auto-width">Engine Hours:</span><input ng-model="invoice.editing_engine_hours.engine_hours" type="text" />&nbsp;<br /><br /><button class="btn btn-success" ng-click="save_invoice_engine_hours()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_engine_hours&#39;)">Cancel</button></form></div></div><div class="editable" ng-click="edit_invoice_hubodometer()" ng-hide="invoice.editing_hubodometer" ng-show="show_hubodometer()"><span class="label-name-left auto-width">Hubodometer:</span>{{invoice.hubodometer|number}} {{invoice.vehicle.odometer_unit}}</div><div class="editing-item" ng-show="invoice.editing_hubodometer"><form class="form form-inline"><span class="label-name-left auto-width">Hubodometer:</span><input ng-model="invoice.editing_hubodometer.hubodometer" type="text" />&nbsp;<br /><br /><button class="btn btn-success" ng-click="save_invoice_hubodometer()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_hubodometer&#39;)">Cancel</button></form></div></div><div class="goto" ng-hide="invoice.vehicle"><button class="btn btn-link" ng-click="change_vehicle()">Select A {{asset_name()}}</button></div></div><div id="vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="row-fluid"><div class="sub-header">{{invoice.vehicle.title}}<div class="pull-right"><button class="btn btn-danger" ng-click="change_vehicle()"><i class="icon-refresh"></i>Change To Different {{asset_name()}}</button><button class="btn" ng-click="close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div></div><div class="popover-content"><div class="row-fluid"><ad-vehicle ng-model="invoice.vehicle" on-save="close_vehicle()"></ad-vehicle></div></div></div></div><div id="new-vehicle"><div class="popover fade left in" style="width: 550px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">{{asset_name()}}</div></div><div class="popover-content"><form class="form-horizontal"><div ad-vehicle-form="true" ng-model="new_vehicle"></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_new_vehicle()">Save</button><button class="btn" ng-click="cancel_create_new_vehicle()" type="button">Cancel</button><div class="spinner" id="save-vehicle-spinner"></div></div></div></form></div></div></div><div id="change-vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="row-fluid"><div class="sub-header">{{vehicle.title}}<div class="pull-right"><button class="btn" ng-click="show_vehicle()" ng-show="invoice.vehicle">Show Current {{asset_name()}}</button><button class="btn btn-primary" ng-click="create_vehicle()" ng-hide="invoice.vehicle">Create New {{asset_name()}}</button><button class="btn" ng-click="close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-change-vehicle="true" model-type="invoice" ng-model="invoice" on-cancel="show_vehicle()" on-save="close_vehicle()" showing="changing_vehicle" vehicle="invoice.vehicle"></div></div></div></div></div></div></div><br /><div ad-invoice="true" class="row-fluid" ng-model="invoice" on-oscar-success="load()" on-repco-success="load()"></div></div><div ad-pay-invoice="true" anchor-element="#pay" ng-model="invoice" showing="paying"></div><div modal="showing_delete_invoice_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this invoice</h3></div><div class="modal-body"><div>Are you sure you want to delete this invoice?</div><br /><div ng-show="invoice.finalized"><div class="div-pre bold">IMPORTANT! Editing a finalized invoice requires</div><div class="div-pre bold">manually updating the stock items\' quantity on hand</div></div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><div class="spinner" id="delete-invoice-spinner"></div><button class="btn btn-danger" ng-click="do_delete_invoice()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_invoice()">Cancel</button></div></div><div ng-show="digital_signature_enabled()"><div class="content-box"><div class="sub-header">Customer Signature {{digital_signature_message()}}</div><div id="customer-sign" ng-show="invoice.last_signature"><div class="inline">Customer signed at {{invoice.last_signature.created_at|date:\'mediumTime\'}} on {{invoice.last_signature.created_at|date: \'fullDate\'}}</div><a ng-href="{{invoice.last_signature.url}}" style="margin-left: 10px" target="_blank">Signed document</a></div><a class="inline" ng-href="/invoices/{{invoice.id}}/sign_form" target="_blank">Sign Now</a></div></div></div><div class="column span5"><div class="content-box"><div ad-invoice-payments="true" ng-model="invoice"></div></div><div class="content-box"><div class="sub-header">COGS<div class="pull-right"><button class="btn btn-link" ng-click="open_cogs()" ng-hide="cogs_opened">Open</button><button class="btn btn-link" ng-click="close_cogs()" ng-show="cogs_opened">Close</button></div><hr /></div><div ng-show="cogs_opened"><div ad-invoice-cogs="true" ng-model="invoice"></div></div></div><div class="content-box"><div class="sub-header">Related Bills<div class="pull-right"><button class="btn btn-link" ng-click="open_related_bills()" ng-hide="related_bills_opened">Open</button><button class="btn btn-link" ng-click="close_related_bills()" ng-show="related_bills_opened">Close</button></div></div><div ng-show="related_bills_opened"><div ad-invoice-bills="true" ng-model="invoice"></div></div></div><div class="content-box" ng-show="invoice.quote_id"><div class="sub-header">Related Quote</div><div><a ng-href="#/quotes/{{invoice.quote_id}}">Related Quote</a></div></div><div class="content-box invoice"><div class="sub-header"><div class="inline" id="invoice-photos">Photos/Documents</div><div class="pull-right" ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_invoice_files()">Upload</button></div></div><div class="invoice-files" ng-hide="uploading_files"><div class="pull-right"></div><div class="inline invoice-photo" ng-repeat="photo in invoice.photos" style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><div ng-show="invoice.documents.length &gt; 0"><div class="bold">Documents</div><div ng-repeat="document in invoice.documents"><div class="editable" ng-click="edit_file(document)" ng-hide="document.editing"><span>{{document.file_name}} &nbsp;</span><a ng-href="{{document.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="document.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="document.editing.file_name" type="text" /></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(document)">Save</button><button class="btn" ng-click="cancel_edit_file(document)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(document)">Remove</button></div></form></div></div></div></div><div id="photo-viewer"><div class="popover fade right in" style="width: 800px; height: 1000px"><div class="popover-title"><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="full_size_photo()">Full Size</button><button class="btn" ng-click="close_photo_viewer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div style="height: 750px"><carousel><slide active="photo.active" ng-repeat="photo in invoice.photos"><img ng-src="{{photo.url}}" style="margin:auto; max-width: 100%; max-height:750px;" /></slide></carousel></div></div><div class="row-fluid"><center><div class="inline job-photo" ng-class="{&#39;invoice-photo-active&#39;: photo.active}" ng-repeat="photo in invoice.photos"><div style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><button class="btn btn-danger" ng-click="remove_photo(photo)" ng-show="photo.active">Remove</button></div></center></div></div></div></div><form action="/invoices/{{invoice.id}}/upload_files" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /></div><br /><div class="inline" id="upload-photos-spinner"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form></div><div class="content-box" ng-show="invoice.remote_id"><div class="sub-header">Accounting Integration</div><div>Synced To ID {{invoice.remote_id}}</div><div ng-show="invoice.remote_url"><span>Please click </span> <a ng-href="{{invoice.remote_url}}" target="_blank">Here</a> <span>to access the invoice in Accounting Software</span></div></div></div></div></div><div ad-stock-info="true"></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("invoices/tabs.html",'<ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("invoices/vehicle_details.html",'<div class="vehicle-details"><div class="goto" ng-show="invoice.vehicle"><div ng-click="show_vehicle()"><div><span class="label-name-left auto-width">Model:</span>{{invoice.vehicle.title}}</div><div ng-show="invoice.vehicle.registration_number"><span class="label-name-left auto-width">Reg No.:</span>{{invoice.vehicle.registration_number}}</div><div ng-show="invoice.vehicle.fleet_number"><span class="label-name-left auto-width">Fleet No.:</span>{{invoice.vehicle.fleet_number}}</div><div ng-show="invoice.vehicle.body"><span class="label-name-left auto-width">Body Type:</span>{{invoice.vehicle.body}}</div></div><div class="editable" ng-click="edit_invoice_odometer()" ng-hide="invoice.editing_odometer"><span class="label-name-left auto-width">Odometer:</span>{{invoice.odometer|number}} {{invoice.vehicle.odometer_unit}}</div><div class="editing-item" ng-show="invoice.editing_odometer"><form class="form form-inline"><span class="label-name-left auto-width">Odometer:</span><input ng-model="invoice.editing_odometer.odometer" type="text" />&nbsp;<br /><br /><button class="btn btn-success" ng-click="save_invoice_odometer()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_odometer&#39;)">Cancel</button></form></div><div ng-show="asset_property_set().machine_hours"><div class="editable" ng-click="edit_invoice_machine_hours()" ng-hide="invoice.editing_machine_hours"><span class="label-name-left auto-width">Machine Hours:</span>{{invoice.machine_hours|number}} {{invoice.vehicle.machine_hours_unit}}</div><div class="editing-item" ng-show="invoice.editing_machine_hours"><form class="form form-inline"><span class="label-name-left auto-width">Machine Hours:</span><input ng-model="invoice.editing_machine_hours.machine_hours" type="text" />&nbsp;<br /><br /><button class="btn btn-success" ng-click="save_invoice_machine_hours()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_machine_hours&#39;)">Cancel</button></form></div></div><div ng-show="asset_property_set().engine_hours"><div class="editable" ng-click="edit_invoice_engine_hours()" ng-hide="invoice.editing_engine_hours"><span class="label-name-left auto-width">Engine Hours:</span>{{invoice.engine_hours|number}} hr(s)</div><div class="editing-item" ng-show="invoice.editing_engine_hours"><form class="form form-inline"><span class="label-name-left auto-width">Engine Hours:</span><input ng-model="invoice.editing_engine_hours.engine_hours" type="text" />&nbsp;<br /><br /><button class="btn btn-success" ng-click="save_invoice_engine_hours()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_engine_hours&#39;)">Cancel</button></form></div></div><div class="editable" ng-click="edit_invoice_hubodometer()" ng-hide="invoice.editing_hubodometer" ng-show="show_hubodometer()"><span class="label-name-left auto-width">Hubodometer:</span>{{invoice.hubodometer|number}} {{invoice.vehicle.odometer_unit}}</div><div class="editing-item" ng-show="invoice.editing_hubodometer"><form class="form form-inline"><span class="label-name-left auto-width">Hubodometer:</span><input ng-model="invoice.editing_hubodometer.hubodometer" type="text" />&nbsp;<br /><br /><button class="btn btn-success" ng-click="save_invoice_hubodometer()">Save</button><button class="btn" ng-click="cancel(invoice, &#39;editing_hubodometer&#39;)">Cancel</button></form></div></div><div class="goto" ng-hide="invoice.vehicle"><button class="btn btn-link" ng-click="change_vehicle()">Select A {{asset_name()}}</button></div></div><div id="vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="row-fluid"><div class="sub-header">{{invoice.vehicle.title}}<div class="pull-right"><button class="btn btn-danger" ng-click="change_vehicle()"><i class="icon-refresh"></i>Change To Different {{asset_name()}}</button><button class="btn" ng-click="close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div></div><div class="popover-content"><div class="row-fluid"><ad-vehicle ng-model="invoice.vehicle" on-save="close_vehicle()"></ad-vehicle></div></div></div></div><div id="new-vehicle"><div class="popover fade left in" style="width: 550px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">{{asset_name()}}</div></div><div class="popover-content"><form class="form-horizontal"><div ad-vehicle-form="true" ng-model="new_vehicle"></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_new_vehicle()">Save</button><button class="btn" ng-click="cancel_create_new_vehicle()" type="button">Cancel</button><div class="spinner" id="save-vehicle-spinner"></div></div></div></form></div></div></div><div id="change-vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="row-fluid"><div class="sub-header">{{vehicle.title}}<div class="pull-right"><button class="btn" ng-click="show_vehicle()" ng-show="invoice.vehicle">Show Current {{asset_name()}}</button><button class="btn btn-primary" ng-click="create_vehicle()" ng-hide="invoice.vehicle">Create New {{asset_name()}}</button><button class="btn" ng-click="close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-change-vehicle="true" model-type="invoice" ng-model="invoice" on-cancel="show_vehicle()" on-save="close_vehicle()" showing="changing_vehicle" vehicle="invoice.vehicle"></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("job_types/costs.html",'<div class="content-box"><div class="sub-header">Invoice Items</div><div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Rate</div><div class="total">Total</div></div><ul class="invoice-items" ng-model="job_type.costs" ui-sortable="cost_sortable_options"><li class="cost" ng-repeat="cost in job_type.costs"><div class="editable" ng-click="edit_cost(cost)" ng-hide="cost.editing"><div class="description"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div>{{cost.description}}<button class="btn btn-link" ng-click="show_cost_details(cost)" ng-show="cost.details &amp;&amp; !cost.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button><button class="btn btn-link" ng-click="hide_cost_details(cost)" ng-show="cost.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button></div><div class="quantity">{{cost.quantity}}</div><div class="rate">{{cost.unit_price|currency}}</div><div class="total">{{cost_total(cost) | currency}}</div><div class="included-gst"><div ng-hide="job_type.not_registered_for_gst"><span ng-show="cost.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="cost.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span></div></div><div class="details" ng-show="cost.show_details"><pre class="no-style">{{cost.details}}</pre></div></div><div class="editing-item" ng-show="cost.editing"><form autocomplete="off" name="edit_cost_form" novalidate="true"><div class="error" ng-show="edit_cost_form.description.$invalid">description is required</div><div class="error" ng-show="edit_cost_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="edit_cost_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" ng-model="cost.editing"></div><div><div class="pull-right"><label class="checkbox" ng-show="cost.editing.stock_id"><input ng-model="cost.editing.use_stock_price" type="checkbox" /><span>Use stock price</span></label></div></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-model="cost.editing.quantity" required="true" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-model="cost.editing.unit_price" required="true" step="any" type="number" /></div><div class="total"><input class="input-mini" readonly="true" type="number" value="{{cost_total(cost.editing)}}" /></div><div class="included-gst"></div><div><a ng-click="edit_cost_details(cost.editing)" ng-hide="cost.details || cost.editing.edit_details">More Details</a><div class="details" ng-show="cost.details || cost.editing.edit_details"><textarea ng-model="cost.editing.details" style="width: 95%; height: 150px;"></textarea></div><div class="pull-right" ng-hide="job_type.not_registered_for_gst"><div><label class="checkbox"><input ng-model="cost.editing.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="cost.editing.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div><br /><br /></div><div><button class="btn btn-success" ng-click="save_cost(edit_cost_form, cost)">Save</button><button class="btn btn-danger" ng-click="remove_cost(cost)">Remove</button><button class="btn" ng-click="cancel_edit_cost(cost)">Cancel</button></div></form></div></li></ul><div ng-hide="new_cost"><a href="javascript: void(0);" ng-click="add_cost()">Add Item/Stock</a></div><div class="cost" ng-show="new_cost"><form autocomplete="off" name="new_cost_form" novalidate="true"><div class="editing-item"><div class="error" ng-show="new_cost_form.description.$invalid">description is required</div><div class="error" ng-show="new_cost_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="new_cost_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" input-id="new-cost-description" ng-model="new_cost"></div><div><div class="pull-right"><label class="checkbox" ng-show="new_cost.stock_id"><input ng-model="new_cost.use_stock_price" type="checkbox" /><span>Use stock price</span></label></div></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-model="new_cost.quantity" required="true" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-model="new_cost.unit_price" required="true" type="number" /></div><div class="total"><input class="input-mini" readonly="true" type="number" value="{{cost_total(new_cost)}}" /></div><div class="included-gst"></div><div><a ng-click="edit_cost_details(new_cost)" ng-hide="new_cost.details || new_cost.edit_details">More Details</a><div class="details" ng-show="new_cost.details || new_cost.edit_details"><textarea ng-model="new_cost.details" style="width: 95%; height: 150px;"></textarea></div><div class="pull-right" ng-hide="job_type.not_registered_for_gst"><div><label class="checkbox"><input ng-model="new_cost.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox inline"><input ng-model="new_cost.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div><br /><br /></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_new_cost()">Save</button><button class="btn" ng-click="cancel_add_cost()">Cancel</button><div class="pull-right"><div ad-new-stock="true" generic-item="new_cost" ng-model="new_stock" on-save="select_new_stock()"></div></div></div></div></form></div><div class="summary"><div><div class="title">Total Excl. {{tax_name()}}:</div><div class="value">{{job_type.total_net_amount | currency}}</div></div><div><div class="title">{{tax_name()}}:</div><div class="value">{{job_type.total_gst_amount | currency}}</div></div><div><div class="title">Total Incl. {{tax_name()}}:</div><div class="value">{{job_type.total_amount | currency}}</div></div><div class="included-gst"></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("job_types/details.html",'<div class="content-box"><div class="sub-header">Details</div><div class="editable" ng-click="edit()" ng-hide="job_type.editing"><div class="info"><span class="label-name-left">Name:</span><span>{{job_type.title}}</span></div><div class="info" ng-show="job_type.is_wof"><span class="label-name-left">Is WOF Service:</span><span>{{job_type.is_wof|yes_no}}</span></div><div class="info"><span class="label-name-left">Estimated Work Hours:</span><span>{{job_type.total_hours}}</span></div><div class="info"><span class="label-name-left">Next Service In:</span><span>{{job_type.next_service_days}} days</span></div><div class="info"><span class="label-name-left">Description:</span><pre class="no-style">{{job_type.description}}</pre></div></div><div class="editing-item" ng-show="job_type.editing"><form class="form-horizontal" name="edit_job_type_form" novalidate="true"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input class="span8" name="title" ng-model="job_type.editing.title" required="true" type="text" /><span class="error right" ng-show="edit_job_type_form.title.$invalid">job type\'s name is required</span></div></div><div class="control-group" ng-show="!no_wof()"><label class="control-label"></label><div class="controls"><label class="checkbox"><input class="checkbox" ng-model="job_type.editing.is_wof" type="checkbox" />Is WOF Service</label></div></div><div class="control-group"><label class="control-label">Estimated work hours</label><div class="controls"><input class="input-small" ng-model="job_type.editing.total_hours" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Next Service In (days)</label><div class="controls"><input class="input-tiny" name="next_service_days" ng-model="job_type.editing.next_service_days" step="any" type="number" /><span class="error right" ng-show="edit_job_type_form.next_service_days.$invalid">days until next service must be a number</span></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><textarea class="span8" ng-model="job_type.editing.description"></textarea><div><label class="checkbox"><input class="checkbox" ng-model="job_type.editing.add_description_on_line_item" type="checkbox" />Show description on invoice line item instead of invoice summary</label></div></div></div><div class="control-group"><label></label><div class="controls"><button class="btn btn-success" ng-click="save_job_type()">Save </button>&nbsp;<button class="btn" ng-click="cancel(job_type, &#39;editing&#39;)">Cancel</button></div></div></form></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("job_types/index.html",'<div ng-controller="JobTypesController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span4"><div class="spinner" id="job-type-list-spinner"></div><ul class="nav nav-list side-nav" ng-controller="JobTypesNavController"><li class="nav-header">Job Types</li><li><div class="inline"><div class="input-append" style="margin-top: 10px; margin-right: 20px;"><input id="jobs-search-input" ng-model="job_type_search" type="text" /><span class="add-on"><i class="icon icon-search"></i></span></div></div><div class="inline"><a class="btn btn-primary" href="#/job_types/new">New</a></div></li><li class="{{isActive(job_type.id)}}" ng-repeat="job_type in job_types | filter: job_type_search"><a href="#/job_types/{{job_type.id}}">{{job_type.title}}</a></li></ul></div><div class="column span8"><div class="page-header">Job Types</div><div class="row-fluid"><div class="pull-right"><a class="btn btn-primary" href="#/job_types/new">New Job Type</a></div></div><br /><div class="content-box"><div>Please start by selecting a job type from the left navigation menu, or click on New Job Type to create one.</div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("job_types/job_files.html",'<div class="content-box"><div class="sub-header"><div class="inline" id="job-files">Files</div></div><div ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_job_files()">Upload</button></div><div class="job-files" ng-hide="uploading_files"><div ng-show="job_type.files.length &gt; 0"><div ng-repeat="file in job_type.files"><div class="editable" ng-click="edit_file(file)" ng-hide="file.editing"><span>{{file.file_name}} &nbsp;</span><a ng-href="{{file.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="file.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="file.editing.file_name" type="text" /><label class="checkbox"><input ng-model="file.editing.print_with_job_card" type="checkbox" />Print with job card (PDF files only)</label></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(file)">Save</button><button class="btn" ng-click="cancel_edit_file(file)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(file)">Remove</button></div></form></div></div></div></div><form action="{{&#39;/job_types/&#39; + job_type.id + &#39;/upload_files&#39;}}" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /><label class="checkbox"><input name="print_with_job_card[]" type="checkbox" />Print with job card (PDF files only)</label></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /><label class="checkbox"><input name="print_with_job_card[]" type="checkbox" />Print with job card (PDF files only)</label></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /><label class="checkbox"><input name="print_with_job_card[]" type="checkbox" />Print with job card (PDF file only)</label></div><br /><div class="inline" id="upload-photos-spinner"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("job_types/nav.html",'<div class="spinner" id="job-type-list-spinner"></div><ul class="nav nav-list side-nav" ng-controller="JobTypesNavController"><li class="nav-header">Job Types</li><li><div class="inline"><div class="input-append" style="margin-top: 10px; margin-right: 20px;"><input id="jobs-search-input" ng-model="job_type_search" type="text" /><span class="add-on"><i class="icon icon-search"></i></span></div></div><div class="inline"><a class="btn btn-primary" href="#/job_types/new">New</a></div></li><li class="{{isActive(job_type.id)}}" ng-repeat="job_type in job_types | filter: job_type_search"><a href="#/job_types/{{job_type.id}}">{{job_type.title}}</a></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("job_types/new.html",'<div ng-controller="NewJobTypeController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span3"><div class="spinner" id="job-type-list-spinner"></div><ul class="nav nav-list side-nav" ng-controller="JobTypesNavController"><li class="nav-header">Job Types</li><li><div class="inline"><div class="input-append" style="margin-top: 10px; margin-right: 20px;"><input id="jobs-search-input" ng-model="job_type_search" type="text" /><span class="add-on"><i class="icon icon-search"></i></span></div></div><div class="inline"><a class="btn btn-primary" href="#/job_types/new">New</a></div></li><li class="{{isActive(job_type.id)}}" ng-repeat="job_type in job_types | filter: job_type_search"><a href="#/job_types/{{job_type.id}}">{{job_type.title}}</a></li></ul></div><div class="column span9"><div class="page-header">New Job Type</div><div class="content-box"><form class="form-horizontal" name="new_job_type_form" novalidate="true"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input class="span8" id="new-job-type-title" name="title" ng-maxlength="255" ng-model="job_type.title" required="true" type="text" /><span class="error right" ng-show="new_job_type_form.title.$invalid">job type\'s name is required</span></div></div><div class="control-group" ng-hide="copied_from_job_type"><label class="control-label"></label><div class="controls"><a href="javascript:void(0)" ng-click="copied_from_job_type=true">Copy from existing job types</a></div></div><div class="control-group" ng-show="copied_from_job_type"><label class="control-label">Copied from job type(s)...</label><div class="controls"><div ad-job-type-selection="true" ng-model="job_type.copied_from_job_type_ids" on-change="copy_job_type()"></div></div></div><div class="control-group" ng-hide="copied_from_invoice"><label class="control-label"></label><div class="controls"><a href="javascript:void(0)" ng-click="copied_from_invoice=true">Copy from existing invoices </a></div></div><div class="control-group" ng-show="copied_from_invoice"><label class="control-label">Copied from invoice(s)...</label><div class="controls"><div ,="" ad-invoicepicker="true" invoice="job_type.copied_from_invoice" ng-model="job_type.copied_from_invoice_id"></div></div></div><div class="control-group" ng-show="!no_wof()"><label class="control-label"></label><div class="controls"><label class="checkbox"><input class="checkbox" ng-model="job_type.is_wof" type="checkbox" />Is WOF Service</label></div></div><div class="control-group"><label class="control-label">Estimated work hours</label><div class="controls"><input class="input-small" ng-model="job_type.total_hours" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Next Service In (days)</label><div class="controls"><input class="input-tiny" name="next_service_days" ng-model="job_type.next_service_days" step="any" type="number" /><span class="error right" ng-show="new_job_type_form.next_service_days.$invalid">days until next service must be a number</span></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><textarea class="span8" ng-model="job_type.description"></textarea><div><label class="checkbox"><input class="checkbox" ng-model="job_type.add_description_on_line_item" type="checkbox" />Show description on invoice line item instead of invoice summary</label></div></div></div><div class="control-group"><label></label><div class="controls"><button class="btn btn-primary" ng-click="save_new_job_type()">Save </button>&nbsp;<button class="btn" ng-click="cancel_new_job_type()">Cancel</button><div class="spinner" id="save-job-type-spinner"></div></div></div></form></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("job_types/show.html",'<div ng-controller="ShowJobTypeController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span4"><div class="spinner" id="job-type-list-spinner"></div><ul class="nav nav-list side-nav" ng-controller="JobTypesNavController"><li class="nav-header">Job Types</li><li><div class="inline"><div class="input-append" style="margin-top: 10px; margin-right: 20px;"><input id="jobs-search-input" ng-model="job_type_search" type="text" /><span class="add-on"><i class="icon icon-search"></i></span></div></div><div class="inline"><a class="btn btn-primary" href="#/job_types/new">New</a></div></li><li class="{{isActive(job_type.id)}}" ng-repeat="job_type in job_types | filter: job_type_search"><a href="#/job_types/{{job_type.id}}">{{job_type.title}}</a></li></ul></div><div class="column span8"><div ng-hide="job_type &amp;&amp; job_type.id"><div class="spinner" id="job-type-loading"></div></div><div ng-show="job_type &amp;&amp; job_type.id"><div class="page-header">{{job_type.title}}<div class="pull-right"><a class="btn" ng-href="#job_types/new?copied_from={{job_type.id}}">Copy</a><a class="btn" ng-href="/job_types/{{job_type.id}}/print.pdf" target="_blank">Print</a><button class="btn btn-danger" ng-click="showing_delete_job_type_dialog = true">Delete</button></div></div><div class="content-box"><div class="sub-header">Details</div><div class="editable" ng-click="edit()" ng-hide="job_type.editing"><div class="info"><span class="label-name-left">Name:</span><span>{{job_type.title}}</span></div><div class="info" ng-show="job_type.is_wof"><span class="label-name-left">Is WOF Service:</span><span>{{job_type.is_wof|yes_no}}</span></div><div class="info"><span class="label-name-left">Estimated Work Hours:</span><span>{{job_type.total_hours}}</span></div><div class="info"><span class="label-name-left">Next Service In:</span><span>{{job_type.next_service_days}} days</span></div><div class="info"><span class="label-name-left">Description:</span><pre class="no-style">{{job_type.description}}</pre></div></div><div class="editing-item" ng-show="job_type.editing"><form class="form-horizontal" name="edit_job_type_form" novalidate="true"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input class="span8" name="title" ng-model="job_type.editing.title" required="true" type="text" /><span class="error right" ng-show="edit_job_type_form.title.$invalid">job type\'s name is required</span></div></div><div class="control-group" ng-show="!no_wof()"><label class="control-label"></label><div class="controls"><label class="checkbox"><input class="checkbox" ng-model="job_type.editing.is_wof" type="checkbox" />Is WOF Service</label></div></div><div class="control-group"><label class="control-label">Estimated work hours</label><div class="controls"><input class="input-small" ng-model="job_type.editing.total_hours" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Next Service In (days)</label><div class="controls"><input class="input-tiny" name="next_service_days" ng-model="job_type.editing.next_service_days" step="any" type="number" /><span class="error right" ng-show="edit_job_type_form.next_service_days.$invalid">days until next service must be a number</span></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><textarea class="span8" ng-model="job_type.editing.description"></textarea><div><label class="checkbox"><input class="checkbox" ng-model="job_type.editing.add_description_on_line_item" type="checkbox" />Show description on invoice line item instead of invoice summary</label></div></div></div><div class="control-group"><label></label><div class="controls"><button class="btn btn-success" ng-click="save_job_type()">Save </button>&nbsp;<button class="btn" ng-click="cancel(job_type, &#39;editing&#39;)">Cancel</button></div></div></form></div></div><div class="content-box"><div class="sub-header"><div class="inline" id="job-files">Files</div></div><div ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_job_files()">Upload</button></div><div class="job-files" ng-hide="uploading_files"><div ng-show="job_type.files.length &gt; 0"><div ng-repeat="file in job_type.files"><div class="editable" ng-click="edit_file(file)" ng-hide="file.editing"><span>{{file.file_name}} &nbsp;</span><a ng-href="{{file.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="file.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="file.editing.file_name" type="text" /><label class="checkbox"><input ng-model="file.editing.print_with_job_card" type="checkbox" />Print with job card (PDF files only)</label></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(file)">Save</button><button class="btn" ng-click="cancel_edit_file(file)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(file)">Remove</button></div></form></div></div></div></div><form action="{{&#39;/job_types/&#39; + job_type.id + &#39;/upload_files&#39;}}" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /><label class="checkbox"><input name="print_with_job_card[]" type="checkbox" />Print with job card (PDF files only)</label></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /><label class="checkbox"><input name="print_with_job_card[]" type="checkbox" />Print with job card (PDF files only)</label></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /><label class="checkbox"><input name="print_with_job_card[]" type="checkbox" />Print with job card (PDF file only)</label></div><br /><div class="inline" id="upload-photos-spinner"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form></div><div class="content-box"><div class="sub-header">Check Sheet</div><ul class="work-check-list" ng-model="job_type.works" ui-sortable="work_sortable_options"><li ng-repeat="work in job_type.works"><div class="editable" ng-click="edit_work(work)" ng-hide="work.editing"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline"><pre class="no-style"><i class="icon-wrench" ng-hide="work.header"></i><span ng-class="{&#39;work-header&#39;: work.header}">{{work.title}}</span></pre></div></div><div class="editing-item" ng-show="work.editing"><form name="edit_work_form" novalidate="true"><div class="error" ng-show="edit_work_form.title.$invalid">work\'s name is required</div><textarea class="span12" name="title" ng-model="work.editing.title" required="true" type="text"></textarea><br /><button class="btn btn-success" ng-click="save_work(edit_work_form, work)"><span>Save</span></button><button class="btn btn-danger" ng-click="remove_work(work)"><span>Remove</span></button><button class="btn" ng-click="cancel_edit_work(work)"><span>Cancel</span></button></form></div></li></ul><div class="editing-item" ng-show="new_work"><form name="new_work_form" novalidate="true"><div class="error" ng-show="new_work_form.title.$invalid">work\'s name is required</div><textarea class="span12" id="new-work-title" name="title" ng-model="new_work.title" required="true" type="text"></textarea><br /><button class="btn btn-primary" ng-click="save_new_work()">Save</button><button class="btn btn" ng-click="cancel_new_work()">Cancel</button></form></div><div ng-hide="new_work"><button class="btn-link" id="new-work-button" ng-click="add_work()"><span>New Work</span></button><span>&nbsp;::&nbsp;</span><button class="btn-link" ng-click="add_work_header()"><span>New Header</span></button></div></div><div class="content-box"><div class="sub-header">Invoice Items</div><div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Rate</div><div class="total">Total</div></div><ul class="invoice-items" ng-model="job_type.costs" ui-sortable="cost_sortable_options"><li class="cost" ng-repeat="cost in job_type.costs"><div class="editable" ng-click="edit_cost(cost)" ng-hide="cost.editing"><div class="description"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div>{{cost.description}}<button class="btn btn-link" ng-click="show_cost_details(cost)" ng-show="cost.details &amp;&amp; !cost.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button><button class="btn btn-link" ng-click="hide_cost_details(cost)" ng-show="cost.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button></div><div class="quantity">{{cost.quantity}}</div><div class="rate">{{cost.unit_price|currency}}</div><div class="total">{{cost_total(cost) | currency}}</div><div class="included-gst"><div ng-hide="job_type.not_registered_for_gst"><span ng-show="cost.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="cost.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span></div></div><div class="details" ng-show="cost.show_details"><pre class="no-style">{{cost.details}}</pre></div></div><div class="editing-item" ng-show="cost.editing"><form autocomplete="off" name="edit_cost_form" novalidate="true"><div class="error" ng-show="edit_cost_form.description.$invalid">description is required</div><div class="error" ng-show="edit_cost_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="edit_cost_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" ng-model="cost.editing"></div><div><div class="pull-right"><label class="checkbox" ng-show="cost.editing.stock_id"><input ng-model="cost.editing.use_stock_price" type="checkbox" /><span>Use stock price</span></label></div></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-model="cost.editing.quantity" required="true" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-model="cost.editing.unit_price" required="true" step="any" type="number" /></div><div class="total"><input class="input-mini" readonly="true" type="number" value="{{cost_total(cost.editing)}}" /></div><div class="included-gst"></div><div><a ng-click="edit_cost_details(cost.editing)" ng-hide="cost.details || cost.editing.edit_details">More Details</a><div class="details" ng-show="cost.details || cost.editing.edit_details"><textarea ng-model="cost.editing.details" style="width: 95%; height: 150px;"></textarea></div><div class="pull-right" ng-hide="job_type.not_registered_for_gst"><div><label class="checkbox"><input ng-model="cost.editing.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="cost.editing.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div><br /><br /></div><div><button class="btn btn-success" ng-click="save_cost(edit_cost_form, cost)">Save</button><button class="btn btn-danger" ng-click="remove_cost(cost)">Remove</button><button class="btn" ng-click="cancel_edit_cost(cost)">Cancel</button></div></form></div></li></ul><div ng-hide="new_cost"><a href="javascript: void(0);" ng-click="add_cost()">Add Item/Stock</a></div><div class="cost" ng-show="new_cost"><form autocomplete="off" name="new_cost_form" novalidate="true"><div class="editing-item"><div class="error" ng-show="new_cost_form.description.$invalid">description is required</div><div class="error" ng-show="new_cost_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="new_cost_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" input-id="new-cost-description" ng-model="new_cost"></div><div><div class="pull-right"><label class="checkbox" ng-show="new_cost.stock_id"><input ng-model="new_cost.use_stock_price" type="checkbox" /><span>Use stock price</span></label></div></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-model="new_cost.quantity" required="true" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-model="new_cost.unit_price" required="true" type="number" /></div><div class="total"><input class="input-mini" readonly="true" type="number" value="{{cost_total(new_cost)}}" /></div><div class="included-gst"></div><div><a ng-click="edit_cost_details(new_cost)" ng-hide="new_cost.details || new_cost.edit_details">More Details</a><div class="details" ng-show="new_cost.details || new_cost.edit_details"><textarea ng-model="new_cost.details" style="width: 95%; height: 150px;"></textarea></div><div class="pull-right" ng-hide="job_type.not_registered_for_gst"><div><label class="checkbox"><input ng-model="new_cost.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox inline"><input ng-model="new_cost.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div><br /><br /></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_new_cost()">Save</button><button class="btn" ng-click="cancel_add_cost()">Cancel</button><div class="pull-right"><div ad-new-stock="true" generic-item="new_cost" ng-model="new_stock" on-save="select_new_stock()"></div></div></div></div></form></div><div class="summary"><div><div class="title">Total Excl. {{tax_name()}}:</div><div class="value">{{job_type.total_net_amount | currency}}</div></div><div><div class="title">{{tax_name()}}:</div><div class="value">{{job_type.total_gst_amount | currency}}</div></div><div><div class="title">Total Incl. {{tax_name()}}:</div><div class="value">{{job_type.total_amount | currency}}</div></div><div class="included-gst"></div></div></div></div></div></div></div><div modal="showing_delete_job_type_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this job</h3></div><div class="modal-body"><div>Are you sure you want to delete {{job_type.title}}</div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_job_type()">Yes, Delete It</button><button class="btn" ng-click="showing_delete_job_type_dialog = false">Cancel</button></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("job_types/works.html",'<div class="content-box"><div class="sub-header">Check Sheet</div><ul class="work-check-list" ng-model="job_type.works" ui-sortable="work_sortable_options"><li ng-repeat="work in job_type.works"><div class="editable" ng-click="edit_work(work)" ng-hide="work.editing"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline"><pre class="no-style"><i class="icon-wrench" ng-hide="work.header"></i><span ng-class="{&#39;work-header&#39;: work.header}">{{work.title}}</span></pre></div></div><div class="editing-item" ng-show="work.editing"><form name="edit_work_form" novalidate="true"><div class="error" ng-show="edit_work_form.title.$invalid">work\'s name is required</div><textarea class="span12" name="title" ng-model="work.editing.title" required="true" type="text"></textarea><br /><button class="btn btn-success" ng-click="save_work(edit_work_form, work)"><span>Save</span></button><button class="btn btn-danger" ng-click="remove_work(work)"><span>Remove</span></button><button class="btn" ng-click="cancel_edit_work(work)"><span>Cancel</span></button></form></div></li></ul><div class="editing-item" ng-show="new_work"><form name="new_work_form" novalidate="true"><div class="error" ng-show="new_work_form.title.$invalid">work\'s name is required</div><textarea class="span12" id="new-work-title" name="title" ng-model="new_work.title" required="true" type="text"></textarea><br /><button class="btn btn-primary" ng-click="save_new_work()">Save</button><button class="btn btn" ng-click="cancel_new_work()">Cancel</button></form></div><div ng-hide="new_work"><button class="btn-link" id="new-work-button" ng-click="add_work()"><span>New Work</span></button><span>&nbsp;::&nbsp;</span><button class="btn-link" ng-click="add_work_header()"><span>New Header</span></button></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/all_jobs/filters.html",'<div class="tab-content"><div class="tab-pane active" id="#/all_jobs"><div class="page-header">Jobs<div class="pull-right"><form class="form-search"><input class="search-query" id="all-jobs-search-input" ng-model="query.query" type="text" />&nbsp;<button class="btn btn-primary" ng-click="search()" type="submit"><i class="icon-search"></i>Search</button></form></div></div><div class="search-description" ng-show="query.query">Search "{{query.query}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="row-fluid"><div class="column span3"><div><label class="checkbox"><input ng-click="toggle_unfinalized()" ng-model="query.unfinalized" type="checkbox" /><span>With</span> <span class="label label-info">unfinalized</span> <span>invoice</span></label></div><div><label class="checkbox"><input ng-click="toggle_finalized()" ng-model="query.finalized" type="checkbox" /><span>With</span> <span class="label label-success">finalized</span> <span>invoice</span></label></div></div><div class="column span3"><div><label class="checkbox"><input ng-click="toggle_unfinished()" ng-model="query.unfinished" type="checkbox" /><span>Showing</span> <span class="label">unfinished</span> <span>jobs</span></label></div><div><label class="checkbox"><input ng-click="toggle_finished()" ng-model="query.finished" type="checkbox" /><span>Showing</span> <span class="label label-success">finished</span> <span>jobs</span></label></div></div><div class="column span3"><div><label class="checkbox"><input ng-click="search()" ng-model="query.deleted" type="checkbox" /><span>Showing</span> <span class="label label-important">deleted</span> <span>jobs</span></label></div><div><label class="checkbox"><input ng-click="search()" ng-model="query.on_hold" type="checkbox" /><span>Showing</span> <span class="label label-warning">On hold</span> <span>jobs</span></label></div></div><div class="column span3"><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/all_jobs/index.html",'<div ng-controller="AllJobsController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="tab-content"><div class="tab-pane active" id="#/all_jobs"><div class="page-header">Jobs<div class="pull-right"><form class="form-search"><input class="search-query" id="all-jobs-search-input" ng-model="query.query" type="text" />&nbsp;<button class="btn btn-primary" ng-click="search()" type="submit"><i class="icon-search"></i>Search</button></form></div></div><div class="search-description" ng-show="query.query">Search "{{query.query}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="row-fluid"><div class="column span3"><div><label class="checkbox"><input ng-click="toggle_unfinalized()" ng-model="query.unfinalized" type="checkbox" /><span>With</span> <span class="label label-info">unfinalized</span> <span>invoice</span></label></div><div><label class="checkbox"><input ng-click="toggle_finalized()" ng-model="query.finalized" type="checkbox" /><span>With</span> <span class="label label-success">finalized</span> <span>invoice</span></label></div></div><div class="column span3"><div><label class="checkbox"><input ng-click="toggle_unfinished()" ng-model="query.unfinished" type="checkbox" /><span>Showing</span> <span class="label">unfinished</span> <span>jobs</span></label></div><div><label class="checkbox"><input ng-click="toggle_finished()" ng-model="query.finished" type="checkbox" /><span>Showing</span> <span class="label label-success">finished</span> <span>jobs</span></label></div></div><div class="column span3"><div><label class="checkbox"><input ng-click="search()" ng-model="query.deleted" type="checkbox" /><span>Showing</span> <span class="label label-important">deleted</span> <span>jobs</span></label></div><div><label class="checkbox"><input ng-click="search()" ng-model="query.on_hold" type="checkbox" /><span>Showing</span> <span class="label label-warning">On hold</span> <span>jobs</span></label></div></div><div class="column span3"><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div></div></div></div><div class="content-box" ng-show="query.deleted"><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span1"><div class="job-list-item">Job No#</div></div><div class="column span4"><div class="job-list-item">Description</div></div><div class="column span2"><div class="job-list-item">Customer</div></div><div class="column span2"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span2"><div class="job-list-item">Deletion entry</div></div><div class="column span1"></div></div></th></tr></thead><tbody><tr ng-repeat="job in jobs"><td><div class="row-fluid"><div class="column span1"><div class="job-list-item">#{{job.number}}</div></div><div class="column span4"><div class="job-list-item-description"><div>{{job.full_description}}</div><div>({{job.employees|comma_seperated: \'name\'}})</div></div></div><div class="column span2"><div class="job-list-item">{{job.customer.name}}</div></div><div class="column span2"><div class="job-list-item">{{job.vehicle|vehicle_title: \'withoutRego\'}}</div></div><div class="column span2"><div class="job-list-item-alert">By {{job.deleted_by.name}}</div><div class="job-list-item-alert">On {{job.deleted_at | date: \'mediumDate\'}}</div><div class="job-list-item">{{job.deleted_reason}}</div></div><div class="column span1"><button class="btn btn-info" ng-click="undelete(job)" ng-show="can_undelete_job()">Undelete</button></div></div></td></tr></tbody></table></div><div class="content-box" ng-hide="query.deleted"><div class="spinner" id="all-jobs-spinner"></div><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span1"><div class="job-list-item">Job No#</div></div><div class="column span1"><div class="job-list-item">Start</div></div><div class="column span1"><div class="job-list-item">Finished</div></div><div class="column span3"><div class="job-list-item">Description</div></div><div class="column span2"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span1"><div class="job-list-item">Reg No.</div></div><div class="column span1"><div class="job-list-item" ng-show="asset_property_set().fleet_number">Fleet No.</div></div><div class="column span2"><div class="job-list-item">Customer</div></div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="job in jobs"><td><a class="goto" ng-href="#/jobs/{{job.id}}"><div class="row-fluid"><div class="column span1"><div class="job-list-item"><div>{{job.number}}</div><div class="label label-warning" ng-show="job.on_hold" tooltip="{{job.on_hold_reason}}">On Hold</div></div></div><div class="column span1"><div class="job-list-item">{{job.time | date: \'shortDate\'}}</div></div><div class="column span1"><div class="job-list-item" ng-show="job.status == &#39;finished&#39;">{{job.finished_time | date: \'shortDate\'}}</div></div><div class="column span3"><div class="job-list-item-description" ng-show="job.full_description"><div>{{job.full_description}}</div><div class="italic" ng-show="job.employees.length &gt; 0">({{job.employees|comma_seperated: \'name\'}})</div></div><div class="job-list-item-order-number" ng-show="job.order_number">Order #: {{job.order_number}}</div><div class="job-list-item-order-number" ng-show="job.key_tag.length &gt; 0">Key Tag: {{job.key_tag}}</div><div ad-tag-icons="true" class="job-list-item" owner="job"></div></div><div class="column span2"><div class="job-list-item">{{job.vehicle|vehicle_title: \'withoutRego\'}}</div></div><div class="column span1"><div class="job-list-item">{{job.vehicle.registration_number}}</div></div><div class="column span1"><div class="job-list-item" ng-show="asset_property_set().fleet_number">{{job.vehicle.fleet_number}}</div></div><div class="column span2"><div class="job-list-item">{{job.customer.name}}</div><div class="job-list-item">{{job.customer.phone || job.customer.mobile}}</div></div></div></a></td></tr></tbody></table></div><div ng-show="total_pages &gt; 1"><pagination boundary-links="true" current-page="page_number" max-size="20" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/all_jobs/long_job_list.html",'<div class="content-box" ng-show="query.deleted"><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span1"><div class="job-list-item">Job No#</div></div><div class="column span4"><div class="job-list-item">Description</div></div><div class="column span2"><div class="job-list-item">Customer</div></div><div class="column span2"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span2"><div class="job-list-item">Deletion entry</div></div><div class="column span1"></div></div></th></tr></thead><tbody><tr ng-repeat="job in jobs"><td><div class="row-fluid"><div class="column span1"><div class="job-list-item">#{{job.number}}</div></div><div class="column span4"><div class="job-list-item-description"><div>{{job.full_description}}</div><div>({{job.employees|comma_seperated: \'name\'}})</div></div></div><div class="column span2"><div class="job-list-item">{{job.customer.name}}</div></div><div class="column span2"><div class="job-list-item">{{job.vehicle|vehicle_title: \'withoutRego\'}}</div></div><div class="column span2"><div class="job-list-item-alert">By {{job.deleted_by.name}}</div><div class="job-list-item-alert">On {{job.deleted_at | date: \'mediumDate\'}}</div><div class="job-list-item">{{job.deleted_reason}}</div></div><div class="column span1"><button class="btn btn-info" ng-click="undelete(job)" ng-show="can_undelete_job()">Undelete</button></div></div></td></tr></tbody></table></div><div class="content-box" ng-hide="query.deleted"><div class="spinner" id="all-jobs-spinner"></div><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span1"><div class="job-list-item">Job No#</div></div><div class="column span1"><div class="job-list-item">Start</div></div><div class="column span1"><div class="job-list-item">Finished</div></div><div class="column span3"><div class="job-list-item">Description</div></div><div class="column span2"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span1"><div class="job-list-item">Reg No.</div></div><div class="column span1"><div class="job-list-item" ng-show="asset_property_set().fleet_number">Fleet No.</div></div><div class="column span2"><div class="job-list-item">Customer</div></div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="job in jobs"><td><a class="goto" ng-href="#/jobs/{{job.id}}"><div class="row-fluid"><div class="column span1"><div class="job-list-item"><div>{{job.number}}</div><div class="label label-warning" ng-show="job.on_hold" tooltip="{{job.on_hold_reason}}">On Hold</div></div></div><div class="column span1"><div class="job-list-item">{{job.time | date: \'shortDate\'}}</div></div><div class="column span1"><div class="job-list-item" ng-show="job.status == &#39;finished&#39;">{{job.finished_time | date: \'shortDate\'}}</div></div><div class="column span3"><div class="job-list-item-description" ng-show="job.full_description"><div>{{job.full_description}}</div><div class="italic" ng-show="job.employees.length &gt; 0">({{job.employees|comma_seperated: \'name\'}})</div></div><div class="job-list-item-order-number" ng-show="job.order_number">Order #: {{job.order_number}}</div><div class="job-list-item-order-number" ng-show="job.key_tag.length &gt; 0">Key Tag: {{job.key_tag}}</div><div ad-tag-icons="true" class="job-list-item" owner="job"></div></div><div class="column span2"><div class="job-list-item">{{job.vehicle|vehicle_title: \'withoutRego\'}}</div></div><div class="column span1"><div class="job-list-item">{{job.vehicle.registration_number}}</div></div><div class="column span1"><div class="job-list-item" ng-show="asset_property_set().fleet_number">{{job.vehicle.fleet_number}}</div></div><div class="column span2"><div class="job-list-item">{{job.customer.name}}</div><div class="job-list-item">{{job.customer.phone || job.customer.mobile}}</div></div></div></a></td></tr></tbody></table></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/all_jobs/short_job_list.html",'<div class="content-box" ng-show="query.deleted"><div class="container-fluid"><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span2"><div class="job-list-item">Job No#</div></div><div class="column span4"><div class="job-list-item">Description</div></div><div class="column span3"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span3"><div class="job-list-item">Customer</div></div></div></th></tr></thead><tbody><tr ng-repeat="job in jobs"><td><div class="row-fluid"><div class="column span2"><div class="job-list-item">#{{job.number}}</div></div><div class="column span4"><div class="job-list-item">{{job.full_description}}</div></div><div class="column span3"><div class="job-list-item">{{job.vehicle.title}}</div></div><div class="column span3"><div class="job-list-item">{{job.customer.name}}</div></div></div></td></tr></tbody></table></div></div><div class="content-box" ng-hide="query.deleted"><div class="spinner" id="all-jobs-spinner"></div><div class="container-fluid"><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span2"><div class="job-list-item">Job No#</div></div><div class="column span4"><div class="job-list-item">Description</div></div><div class="column span3"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span3"><div class="job-list-item">Customer</div></div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="job in jobs"><td><a class="goto" ng-href="#/jobs/{{job.id}}"><div class="row-fluid"><div class="column span2"><div class="job-list-item">{{job.number}}</div></div><div class="column span4"><div class="job-list-item">{{job.full_description}}</div></div><div class="column span3"><div class="job-list-item">{{vehicle.title}}</div><div class="job-list-item" ng-show="asset_property_set().fleet_number">{{job.vehicle.fleet_number}}</div></div><div class="column span3"><div class="job-list-item">{{job.customer.name}}</div><div class="job-lsit-item">{{job.customer.phone || job.customer.mobile}}</div></div></div></a></td></tr></tbody></table></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/communication_templates/index.html",'<div ng-controller="CommunicationTemplatesController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav"><li ng-class="{&#39;active&#39;: item == template}" ng-repeat="item in communication_templates"><a href="javascript:void(0)" ng-click="show_template(item)">{{template_name(item)}}</a></li></ul></div><div class="column span9"><div class="page-header" id="template-{{template.id}}">{{template.name}}</div><div class="content-box"><div class="row-fluid"><div class="column span9"><div class="editable" ng-click="edit(template)" ng-hide="template.editing"><div class="row-fluid info communication-template"><div class="column span4 text-align-right">Communication Method:</div><div class="column span8">{{template.communication_method}}</div></div><div class="row-fluid info communication-template"><div class="column span4 text-align-right">Subject</div><div class="column span8"><pre class="inline" ng-hide="template.editing">{{template.subject}}</pre></div></div><div class="row-fluid info communication-template"><div class="column span4 text-align-right">Message</div><div class="column span8"><pre ng-hide="template.editing">{{template.message}}</pre></div></div></div><div class="editing-item" ng-show="template.editing"><form name="edit_template_form" novalidate="true"><div class="info communication-template" ng-hide="template.communication_method == &#39;sms&#39;"><span class="label-name">Subject</span><input class="span8" name="subject" ng-model="template.editing.subject" required="true" type="text" /><span class="error right" ng-show="edit_template_form.subject.$invalid">subject is required</span></div><div class="info communication-template"><span class="label-name">Message</span><textarea class="span8" name="message" ng-model="template.editing.message" required="true" rows="10"></textarea><span class="error right" ng-show="edit_template_form.message.$invalid">message is required</span></div><div class="info communication-template" ng-show="template.editing.errors.message"><span class="label-name"></span><div class="inline alert alert-error">{{template.editing.errors.message.join(\', \')}}{{template.editing.errors.subject.join(\', \')}}</div></div><div class="info communication-template"><span class="label-name"></span><button class="btn btn-primary" ng-click="save(edit_template_form, template)">Save</button><button class="btn" ng-click="cancel_editing(template)">Cancel</button></div></form></div></div><div class="column span3"><h6>Applicable variables</h6><div ng-repeat="variable in template.variables">{{variable}}</div></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/bills.html",'<div class="content-box"><div class="sub-header">Bills</div><table class="table table-striped table-bordered"><tbody><tr ng-repeat="bill in $parent.job.invoice.related_bills"><td id="bill-{{bill.id}}"><a class="goto" ng-href="#/bills/{{bill.id}}"><div><div class="inline" style="width: 120px">Bill No: #{{bill.number}}</div></div><div><div class="inline" style="width: 120px">Ref: #{{bill.reference}}</div><div class="inline"><span class="bold">Supplier:&nbsp;</span><span>{{bill.supplier.name}}</span></div></div><div class="pull-right"><span>{{bill.total_amount|currency}} &nbsp;</span><span class="badge badge-success" ng-show="bill.finalized">Finalized</span></div></a></td></tr></tbody></table></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/cogs.html",'<div class="content-box"><div ad-invoice-cogs="true" ng-model="$parent.job.invoice"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/costs.html","")}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/form.html",'<form class="form-horizontal" name="job_form" novalidate="true"><input ng-model="job.customer.id" type="hidden" /><input ng-model="job.vehicle.id" type="hidden" /><div ad-customer-vehicle-form="true" customer="job.customer" recommendations="recommendations" selection="selection" vehicle="job.vehicle"></div><div class="sub-header">Job</div><div class="control-group"><label class="control-label"></label></div><div class="controls"><div id="current-jobs-notification" ng-show="current_jobs.length &gt; 0"><span style="color: red">Ongoing job exists for this vehicle</span><button class="btn btn-link" ng-click="open_current_jobs()">Click Here To Show Them</button></div></div><div class="control-group"><label class="control-label"><div>Invoice To 3rd Party</div><div ad-3rd-party-explain="true"></div></label><div class="controls"><insurerpicker ng-model="job.job.insurer_id"></insurerpicker></div></div><div ng-model="job.job" royaltypicker="true"></div><div class="control-group"><label class="control-label">Short Description</label><div class="controls"><input class="input span12" maxlength="255" ng-model="job.job.description" type="text" /></div></div><div class="control-group"><label class="control-label">Note/More Details</label><div class="controls"><button class="btn btn-link" ng-click="add_note()" ng-hide="show_note" type="button">Add a note</button><textarea class="note" ng-model="job.job.note" ng-show="show_note" type="text"></textarea></div></div><div class="control-group"><label class="control-label">Job Types</label><div class="controls"><div ad-job-type-selection="true" ng-model="job.job.job_type_ids" on-change="calculate_estimate_work_hours(old, value)"></div></div></div><div class="control-group" ng-show="job.job.insurer_id"><label class="control-label">Claim No.#</label><div class="controls"><input ng-model="job.job.claim_number" type="text" /></div></div><div class="control-group" ng-show="job.job.insurer_id"><label class="control-label">Account No.#</label><div class="controls"><input ng-model="job.job.account_number" type="text" /></div></div><div class="control-group" ng-show="job.job.insurer_id"><label class="control-label">Excess</label><div class="controls"><input ng-model="job.job.excess" type="text" /></div></div><div class="control-group"><label class="control-label">Mechanics</label><div class="controls"><span ad-employee-tag="true" employees="booking.employees" empty=""></span><button class="btn btn-link" ng-click="show_assign_to_mechanics()" ng-hide="showing_assign_to_mechanics">Assign</button><div ng-show="showing_assign_to_mechanics"><button class="btn btn-link" ng-click="show_schedule()">Show Schedule</button><div id="show-schedule-position" style="position: absolute, margin-left: 500px; visibility: hidden"></div><div><label class="label-name-left">Mechanic 1:</label><select ng-model="job.mechanic_1_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(1)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 2:</label><select ng-model="job.mechanic_2_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(2)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 3:</label><select ng-model="job.mechanic_3_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(3)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 4:</label><select ng-model="job.mechanic_4_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(4)"><div class="icon icon-remove red"></div></a></div></div></div></div><div class="control-group"><label class="control-label">Start Time</label><div class="controls"><div id="show-courtesy-booking-form-position" style="position: absolute, margin-left: 500px; visibility: hidden"></div><ad-datepicker error="top" ng-model="job.job.time"></ad-datepicker><ad-timepicker ng-model="job.job.time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimated Finished Time</label><div class="controls"><ad-datepicker error="top" ng-model="job.job.finished_time"></ad-datepicker><ad-timepicker ng-model="job.job.finished_time"></ad-timepicker></div></div><div class="control-group" ng-hide="provide_mobile_service()"><label class="control-label">Pickup time</label><div class="controls"><ad-datepicker error="top" ng-model="job.job.pickup_time"></ad-datepicker><ad-timepicker ng-model="job.job.pickup_time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimated work hours</label><div class="controls"><input class="input-small" ng-model="job.job.total_hours" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Order Number</label><div class="controls"><input class="input-small" ng-model="job.job.order_number" type="text" /></div></div><div class="control-group" ng-show="manual_job_number()"><label class="control-label">Job Number</label><div class="controls"><input class="input-small" ng-model="job.job.number" type="text" /></div></div><div class="control-group"><label class="control-label">Odometer</label><div class="controls"><input class="input-small" ng-model="job.job.odometer" step="any" type="number" /></div></div><div class="control-group" ng-show="show_hubodometer()"><label class="control-label">Hubodometer</label><div class="controls"><input class="input-small" ng-model="job.job.hubodometer" step="any" type="number" /></div></div><div class="control-group" ng-show="asset_property_set().engine_hours"><label class="control-label">Engine Hours</label><div class="controls"><input class="input-small" ng-model="job.job.engine_hours" step="any" type="number" /></div></div><div class="control-group" ng-show="asset_property_set().machine_hours"><label class="control-label">Machine Hours</label><div class="controls"><input class="input-small" ng-model="job.job.machine_hours" step="any" type="number" /></div></div><div class="control-group" ng-show="asset_property_set().key_tag"><label class="control-label">Key Tag</label><div class="controls"><input class="input-small" ng-model="job.job.key_tag" type="text" /></div></div><div class="control-group"><label class="control-label">Courtesy {{asset_name()}}</label><div class="controls"><input id="job-courtesy-vehicle-checkbox" ng-click="toggle_courtesy_vehicle_bookings()" ng-model="job.job.replacement_provided" style="margin-right: 10px;" type="checkbox" /><div ng-show="job.job.courtesy_vehicle_booking.vehicle" style="margin-left: 20px; margin-top: -17px;"><div class="inline">Booking selected for {{job.job.courtesy_vehicle_booking.vehicle.title}}</div><a class="inline" href="javascript:void(0)" ng-click="show_courtesy_vehicle_bookings()" style="margin-left: 5px;" target="_blank">Edit</a></div></div></div><div class="control-group"><label class="control-label"><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="job.job" placement="top" showing="x_tags"></div></label><div class="controls"><div ad-tag-labels="true" owner="job.job"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="job.job"></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" id="create-new-job" ng-click="create()" type="submit">Save</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="new-job-spinner"></div></div></div></form><div id="courtesy-vehicle-booking-form"><div class="popover fade top in" style="min-width: 900px; width: 50%"><div class="arrow"></div><div class="popover-title"><div class="sub-header">Courtesy {{asset_name()}} Booking<div class="pull-right"><button class="btn" ng-click="hide_courtesy_vehicle_bookings()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div class="column span12"><div ad-courtesy-vehicle-availability="true" job="job.job" on-select-vehicle="on_book_courtesy_vehicle()"></div></div></div><div class="row-fluid"><button class="btn" ng-click="hide_courtesy_vehicle_bookings()"><i class="icon-remove"></i>Close</button></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/index.html",'<div ng-controller="JobsController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span6"><div class="spinner" id="current-jobs-spinner"></div><div class="content-box"><div class="page-header">Current Jobs<div class="pull-right" ng-hide="restricted_to_create_jobs()"><a class="btn btn-primary" href="#/jobs/new"><i class="icon icon-wrench"></i><span>New Job</span></a><a class="btn btn-primary" href="#/bookings/new"><i class="icon icon-calendar"></i><span>New Booking</span></a></div></div><div><div class="pull-left"><label class="checkbox"><input ng-model="only_on_hold" type="checkbox" />Only  On Hold</label></div><div class="pull-right"><div class="input-append"><input id="jobs-search-input" ng-model="current_job_search" type="text" /><span class="add-on"><i class="icon icon-search"></i></span></div></div></div><table class="table table-striped"><tbody><tr class="goto" ng-repeat="job in current_jobs(page_number)"><td class="current-job-content"><div class="spinner" id="job-{{job.id}}"></div><div class="row-fluid"><div class="dashboard-job-number"><div><div class="dropdown inline" id="actions-job-{{job.id}}"><a dropdown-toggle="true"><span><i class="icon icon-reorder"></i></span></a><ul class="dropdown-menu"><li><button class="btn btn-link"><a ng-href="/jobs/{{job.id}}/print.pdf" target="_blank"><i class="icon-print"></i><span>Print</span></a></button></li><li><button class="btn btn-link" id="put-on-hold-{{job.id}}" ng-click="put_on_hold(job)"><i class="icon-pause"></i><span>Put On Hold</span></button></li><li><button class="btn btn-link" id="send-sms-{{job.id}}" ng-click="send_sms(job)"><i class="icon icon-mobile-phone"></i><span>SMS</span></button></li><li><button class="btn btn-link" id="send-email-{{job.id}}" ng-click="send_email(job)"><i class="icon icon-envelope"></i><span>Email</span></button></li><li><button class="btn btn-link" id="tag-{{job.id}}" ng-click="tag(job)"><i class="icon icon-tags"></i><span>Tags</span></button></li><li><button class="btn btn-link" id="assign-{{job.id}}" ng-click="assign(job)"><i class="icon icon-wrench"></i><span>Assign To</span></button></li></ul></div><div class="inline">#{{job.number}}</div></div><div ng-show="job.tags.length &gt; 0"><div ad-tag-icons="true" owner="job"></div></div></div><a class="goto" ng-href="#/jobs/{{job.id}}"><div class="dashboard-job-types"><div>{{job.full_description}}</div><div ng-show="job.key_tag.length &gt; 0">Key Tag: {{job.key_tag}}</div><div class="italic" ng-show="job.employees.length &gt; 0">({{job.employees|comma_seperated: \'name\'}})</div></div><div class="dashboard-vehicle"><div>{{job.vehicle|vehicle_title}}</div><div ng-show="job.vehicle.fleet_number">Fleet No.: {{job.vehicle.fleet_number}} </div><div ng-show="job.vehicle.vin">VIN: {{job.vehicle.vin}} </div></div><div class="dashboard-customer text-align-right"><div>{{job.customer.name}}</div><div>{{job.customer|phone_number}}</div></div></a></div></td></tr></tbody></table><div ng-show="total_pages() &gt; 1"><pagination boundary-links="true" current-page="page_number" max-size="30" num-pages="total_pages()" on-select-page="show(page)" rotate="false"></pagination></div><div class="page-header">Jobs On Hold</div><table class="table table-striped"><tbody><tr class="goto" ng-repeat="job in on_hold_jobs()"><td class="current-job-content"><div class="spinner" id="job-{{job.id}}"></div><div class="row-fluid"><div class="dashboard-job-number"><div><div class="inline"><div class="dropdown" id="actions-job-{{job.id}}"><a dropdown-toggle="true"><i class="icon icon-reorder"></i></a><ul class="dropdown-menu"><li><button class="btn btn-link"><a ng-href="/jobs/{{job.id}}/print.pdf" target="_blank"><i class="icon-print"></i><span>Print</span></a></button></li><li><button class="btn btn-link" id="put-on-hold-{{job.id}}" ng-click="continue(job)"><i class="icon-play"></i><span>Continue</span></button></li><li><button class="btn btn-link" id="send-sms-{{job.id}}" ng-click="send_sms(job)"><i class="icon icon-mobile-phone"></i><span>SMS</span></button></li><li><button class="btn btn-link" id="send-email-{{job.id}}" ng-click="send_email(job)"><i class="icon icon-envelope"></i><span>Email</span></button></li><li><button class="btn btn-link" id="tag-{{job.id}}" ng-click="tag(job)"><i class="icon icon-tags"></i><span>Tags</span></button></li><li><button class="btn btn-link" id="assign-{{job.id}}" ng-click="assign(job)"><i class="icon icon-wrench"></i><span>Assign To</span></button></li></ul></div></div><div class="inline">#{{job.number}}</div></div><div ng-show="job.tags.length &gt; 0"><div ad-tag-icons="true" owner="job"></div></div><div class="label label-warning" tooltip="{{job.on_hold_reason}}">On Hold</div><div ng-show="job.status == &#39;preparing&#39;"><div class="label label-info">Preparing</div></div></div><a class="goto" href="javascript:void(0)" ng-click="open_job(job)"><div class="dashboard-job-types"><div class="orange">{{job.on_hold_reason}}</div><div>{{job.full_description}}</div><div class="italic" ng-show="job.employees.length &gt; 0">({{job.employees|comma_seperated: \'name\'}})</div></div><div class="dashboard-vehicle"><div>{{job.vehicle|vehicle_title}}</div><div ng-show="job.vehicle.fleet_number">Fleet No.: {{job.vehicle.fleet_number}} </div><div ng-show="job.vehicle.vin">VIN: {{job.vehicle.vin}} </div></div><div class="dashboard-customer text-align-right"><div>{{job.customer.name}}</div><div>{{job.customer.phone}}</div></div></a></div></td></tr></tbody></table></div><div class="spinner" id="upcoming-bookings-spinner"></div><div class="content-box"><div class="row-fluid"><div class="pull-left"><div class="page-header">Upcoming Bookings (next 7 days)</div></div><div class="pull-right"><a ng-href="#/bookings/">All Bookings</a></div></div><table class="table table-striped upcoming-bookings"><tbody><tr ng-repeat="booking in filtered_bookings()"><td><div class="dashboard-booking-time"><div class="bold"><div><span>{{booking.time | date: \'mediumTime\'}}<br />{{booking.time | date: \'mediumDate\'}}</span></div><div><div>By {{booking.created_by}}</div></div></div><div ng-show="booking.status == &#39;preparing&#39;"><label class="label label-info">Preparing</label></div></div><div class="dashboard-job-types">{{booking.full_description}}<div class="italic" ng-show="booking.employees.length &gt; 0">({{booking.employees|comma_seperated:\'name\'}})</div></div><div class="dashboard-vehicle"><div>{{booking.vehicle.title}}</div><div ng-show="booking.vehicle.fleet_number">Fleet No.: {{booking.vehicle.fleet_number}} </div></div><div class="dashboard-customer text-align-right">{{booking.name}}<br />{{booking.mobile || booking.phone}}</div><br /><br /><div><div class="inline" ng-hide="booking.job_id"><a href="#/bookings/{{booking.id}}/edit"><i class="icon-pencil"></i>Edit</a><span>&nbsp;&nbsp;</span><a class="btn btn-link" href="#/jobs/new?booking={{booking.id}}&amp;prepare=true"><i class="icon-wrench"></i>Prepare</a><span>&nbsp;&nbsp;</span><a class="btn btn-link" href="#/jobs/new?booking={{booking.id}}"><i class="icon-ok green"></i>Start</a></div><div class="inline" ng-show="booking.job_id"><a href="#/bookings/{{booking.id}}/edit"><i class="icon-pencil"></i>Edit</a><span>&nbsp;&nbsp;</span><a class="btn btn-link" href="#/jobs/{{booking.job_id}}"><i class="icon-ok green"></i>Prepare/Start</a></div><span>&nbsp;&nbsp;</span><div class="inline"><button class="btn btn-link" ng-click="cancel_booking(booking)"><i class="icon-remove red"></i>Cancel</button></div></div></td></tr></tbody></table></div><div ad-put-on-hold="true" anchor-element="actions_job_anchor" ng-model="action_job" placement="top" showing="putting_on_hold"></div><div ad-send-email="true" anchor-element="actions_job_anchor" customer="action_job.customer" job="action_job" placement="top" showing="sending_email" vehicle="action_job.vehicle"></div><div ad-send-sms="true" anchor-element="actions_job_anchor" customer="action_job.customer" job="action_job" placement="top" showing="sending_sms" vehicle="action_job.vehicle"></div><div ad-tags="true" anchor-element="actions_job_anchor" owner="action_job" placement="top" resource="Job" showing="tagging_job"></div><div ad-assign-employees="true" anchor-element="actions_job_anchor" job="action_job" placement="top" showing="assigning_job"></div></div><div class="column span6"><div ng-show="!hide_unpaid_invoices_for_mechanics()"><div class="spinner" id="unpaid-jobs-spinner"></div><div class="content-box"><div class="row-fluid"><div class="inline"><div class="page-header">Unpaid Invoices</div></div><div class="pull-right"><div class="input-append"><input id="invoice-search-input" ng-change="search_invoices()" ng-model="unpaid_invoice_search" type="text" /><span class="add-on"><i class="icon icon-search"></i></span></div></div></div><table class="table table-striped"><tbody><tr class="goto" ng-click="open_invoice(invoice)" ng-repeat="invoice in unpaid_invoices.invoices"><td><div class="spinner" id="invoice-{{invoice.id}}"></div><div class="row-fluid"><div class="column span3"><span ng-class="{&#39;green&#39;: invoice.finalized, &#39;blue&#39;: !invoice.finalized}">#{{invoice.number}}</span><div>Due: {{invoice.due_date|date: \'shortDate\'}}</div></div><div class="column span4"><div>{{invoice.vehicle.title}}</div><div>{{invoice.description}}</div></div><div class="column span5 text-align-right">{{invoice.customer.name}}<br />{{invoice.customer.mobile || invoice.customer.phone}}</div></div></td></tr></tbody></table><div ng-show="unpaid_invoices.total_pages &gt; 1"><pagination boundary-links="false" current-page="unpaid_invoices.page_number" max-size="8" num-pages="unpaid_invoices.total_pages" on-select-page="fetch_unpaid_invoices(page)" rotate="false"></pagination></div></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/invoice.html",'<div ng-hide="job.invoice.id || adding_invoice"><div class="content-box" style="min-height: 400px"><center><br /><br /><br /><div class="goto" ng-click="create_invoice()" style="border: solid 1px; border-color: #AAA; width: 70%; background-color: white"><br /><div class="bold">Create Invoice</div><br /></div><center><div class="spinner" id="create-invoice-spinner"></div></center><br /><br /></center></div></div><div ng-show="adding_invoice"><div class="content-box" style="min-height: 400px"></div><div class="bold">Invoice</div><div invoicepicker="true" ng-model="adding_invoice"></div><div class="button-panel"><button class="btn btn-success" ng-click="add_invoice()">Add</button><button class="btn" ng-click="cancel_add_invoice()">Cancel</button></div></div><div ng-show="job.invoice.id"><div class="content-box job-invoice"><div class="row-fluid"><div class="column span3"><div class="spinner" id="invoice-spinner"></div><div class="sub-header">Invoice</div></div><div class="column span9"><div class="pull-right" ng-show="job.invoice.id"><div ad-tag-labels="true" class="inline" owner="job.invoice"></div><div ad-tags="true" class="inline" owner="job.invoice" resource="Invoice"></div><button class="btn btn-link" id="invoice-tags" ng-click="i_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#invoice-tags&#39;" owner="job.invoice" placement="left" resource="Invoice" showing="i_tags"></div></div></div></div><div class="row-fluid"><div class="column span6"><div ng-show="job.invoice.customer"><span class="label-name-left auto-width">Bill To:</span><span>{{job.invoice.customer.name}}</span><div ng-show="job.invoice.customer.phone || job.invoice.customer.mobile"><span class="label-name-left auto-width">Tel:</span><span ng-show="job.invoice.customer.phone">{{job.invoice.customer.phone}}</span><span ng-hide="job.invoice.customer.phone">{{job.invoice.customer.mobile}}</span></div><div><a href="javascript:void(0)" id="change-invoice-customer-button" ng-click="change_customer()">Change</a></div></div></div><div class="column span6"><div class="pull-right"><div ad-invoice-details="true" ng-model="job.invoice"></div><div><a ng-href="#/invoices/{{job.invoice.id}}">Details</a></div></div></div></div><div ad-invoice="true" job="job" ng-model="job.invoice" on-oscar-success="oscar_invoice_success(account)" on-repco-success="repco_invoice_success()"></div></div><div class="content-box"><div ad-invoice-payments="true" ng-model="job.invoice"></div></div><div ad-change-customer="true" anchor-element="#change-invoice-customer-button" invoice="job.invoice" showing="changing_invoice_customer"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/job_actions.html",'<a class="btn" ng-href="/jobs/{{job.id}}/print.pdf" target="_blank"><i class="icon-print"></i><span>Print Job Card</span></a><a class="btn" href="javascript:void(0);" id="email-job-card" ng-click="email_job_card()"><i class="icon icon-envelope"></i><span>Email Job Card</span></a><div class="dropdown inline" id="communication-actions"><a class="btn" dropdown-toggle="true"><i class="icon icon-share-alt"></i><span>Send...</span></a><ul class="dropdown-menu top-dropdown"><li><a href="javascript:void(0);" id="send-sms-button" ng-click="send_sms()"><i class="icon icon-mobile-phone"></i><span>Send SMS</span></a></li><li><a href="javascript:void(0);" id="send-email-button" ng-click="send_email()"><i class="icon icon-envelope"></i><span>Send Email</span></a></li></ul></div><button class="btn btn-warning" id="put-on-hold" ng-click="put_on_hold()" ng-hide="job.deleted || job.finished || job.on_hold"><i class="icon icon-stop"></i>Put On Hold</button><button class="btn btn-success" id="continue" ng-click="continue()" ng-hide="!job.on_hold"><i class="icon icon-play"></i>Continue</button><button class="btn btn-primary" id="finish" ng-click="finish()" ng-hide="job.deleted || job.finished"><i class="icon-ok"></i>Finish</button><button class="btn" id="unfinish" ng-click="unfinish()" ng-show="job.finished">Unfinish</button><div id="job-send-email"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Email Job Card</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form><div class="pull-right"><div class="inline" id="job-send-email-spinner"></div></div><label>Email</label><input class="span9" id="job-send-email-address" ng-model="email" type="text" /><div class="pull-right"><div class="inline" contactpicker="true" model-type="customer" ng-model="job.customer" on-select="email_select_contact(contacts)" show-email="true"></div></div><label>Subject</label><input class="span12" id="job-send-email-subject" ng-model="subject" type="text" /><label><span>Message</span><span ad-saved-texts-button="true" job="job" ng-model="message"></span></label> <textarea class="span12" id="job-send-email-message" ng-model="message" rows="5" type="text"></textarea><div><label class="checkbox"><input ng-model="delivery_notification_required" type="checkbox" /><span>Send me a notification on delivery</span></label></div><div><label class="checkbox"><input ng-model="attached_files" type="checkbox" /><span>Attach Files</span></label></div><div ng-show="attached_files"><table class="table table-striped"><tbody><tr ng-repeat="file in job.photos"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in job.documents"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr></tbody></table></div><div><button class="btn btn-success" ng-click="send_job_card()">Send</button><button class="btn" ng-click="cancel_email_job_card()">Cancel</button></div></form></div></div></div></div></div><div ad-put-on-hold="true" anchor-element="put_on_hold_anchor" ng-model="job" placement="bottom" showing="putting_on_hold"></div><div ad-finish-job="true" anchor-element="#finish" ng-model="job" on-paying="pay()" showing="finishing" vehicle="vehicle"></div><div ad-pay-invoice="true" anchor-element="#pay" ng-model="job.invoice" showing="paying"></div><div ad-send-email="true" anchor-element="&#39;#communication-actions&#39;" customer="job.customer" job="job" placement="left" showing="show_send_email" vehicle="job.vehicle"></div><div ad-send-sms="true" anchor-element="&#39;#communication-actions&#39;" customer="job.customer" job="job" placement="left" showing="show_send_sms" vehicle="job.vehicle"></div><div modal="showing_delete_job_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this job</h3></div><div class="modal-body"><div>Are you sure you want to delete this Job?</div><div ng-show="job.booking"><label class="checkbox"><input ng-model="delete_booking" type="checkbox" />Also delete the job\'s booking</label></div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><div class="spinner" id="delete-job-spinner"></div><button class="btn btn-danger" ng-click="do_delete_job()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_job()">Cancel</button></div></div><div id="in-progress-work-hours"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">You are current clocked on to another job</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div>You are current clocked on the the following jobs</div><br /><br /><div class="spinner" id="in-progress-clocking-spinner"></div><table class="table table-striped"><tr ng-repeat="work_hour in in_progress_work_hours"><td>{{work_hour.job.title}}</td><td><button class="btn btn-link" ng-click="clock_off_in_progress(work_hour)" ng-hide="require_timesheet_description(work_hour)">Clock Off</button></td><td><div class="pull-right"><a class="btn btn-link" ng-href="#/jobs/{{work_hour.job.id}}" target="_blank">Open</a></div></td></tr></table></div><button class="btn" ng-click="close_in_progress_work_hours()">Close</button></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/job_detail.html",'<div class="job-details" ng-click="edit_job_types()" ng-hide="job.editing_job_types"><div class="editable"><div class="info"><span class="label-name-left auto-width">Job Type:</span><span class="inline" style="max-width: 200px">{{job.job_types_title|na}}</span></div></div></div><div class="editing-item" ng-show="job.editing_job_types"><form class="form-horizontal" name="job_types_form" novalidate="true"><div class="control-group"><label class="control-label" style="width: 80px">Job Types</label><div class="controls" style="margin-left: 100px; min-width: 320px"><div ad-job-type-selection="true" ng-model="job.editing_job_types.job_type_ids"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_job_types()">Save</button><button class="btn" ng-click="cancel(job, &#39;editing_job_types&#39;)">Cancel</button><div class="spinner" id="job-update-job-types-spinner"></div></div></div></form></div><div class="job-details" ng-click="edit_job_details()" ng-hide="job.editing_job_details"><div class="editable"><div class="info" ng-show="job.order_number"><span class="label-name-left auto-width">Order Number:</span>{{job.order_number}}</div><div class="info" ng-show="job.quote"><span class="label-name-left auto-width">Quote Number:</span>{{job.quote.number}}</div><div class="info" ng-show="job.created_by"><span class="label-name-left auto-width">Booked In By:</span>{{job.created_by }}</div><div class="info" ng-show="job.time"><span class="label-name-left auto-width">Time:</span>{{job.time | date: \'short\'}}</div><div class="info" ng-show="job.total_hours"><span class="label-name-left auto-width">Estimate:</span>{{job.total_hours}} hours</div><div class="info" ng-show="job.pickup_time"><span class="label-name-left auto-width">Pickup time:</span>{{job.pickup_time | date: \'short\'}}</div><div class="info" ng-show="job.key_tag.length &gt; 0"><span class="label-name-left auto-width">Key Tag:</span><span class="inline" style="max-width: 200px">{{job.key_tag}}</span></div><div class="info"><span class="label-name-left auto-width">Odometer:</span><span ng-show="job.odometer">{{job.odometer|number}} {{job.vehicle.odometer_unit}}</span><span ng-hide="job.odometer">(Not Available)</span></div><div class="info" ng-show="asset_property_set().machine_hours"><span class="label-name-left auto-width">Machine Hours:</span><span ng-show="job.machine_hours">{{job.machine_hours|number}} hr(s)</span><span ng-hide="job.machine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().engine_hours"><span class="label-name-left auto-width">Engine Hours:</span><span ng-show="job.engine_hours">{{job.engine_hours|number}} hr(s)</span><span ng-hide="job.engine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().port_engine_hours"><span class="label-name-left auto-width">Port Engine Hours:</span><span ng-show="job.port_engine_hours">{{job.port_engine_hours|number}} hr(s)</span><span ng-hide="job.port_engine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().starboard_engine_hours"><span class="label-name-left auto-width">Starboard Engine Hours:</span><span ng-show="job.starboard_engine_hours">{{job.starboard_engine_hours|number}} hr(s)</span><span ng-hide="job.starboard_engine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().sleeper_air_engine_hours"><span class="label-name-left auto-width">Sleeper Air Engine Hours:</span><span ng-show="job.sleeper_air_engine_hours">{{job.sleeper_air_engine_hours|number}} hr(s)</span><span ng-hide="job.sleeper_air_engine_hours">(Not Available)</span></div><div class="info" ng-show="show_hubodometer()"><span class="label-name-left auto-width">Hubodometer:</span><span ng-show="job.hubodometer">{{job.hubodometer|number}} {{job.vehicle.odometer_unit}}</span><span ng-hide="job.hubodometer">(Not Available)</span></div><div ng-show="job.finished_time"><div class="info"><span class="label-name-left auto-width">Finished:</span>{{job.finished_time | date: \'mediumDate\'}}</div></div><div class="info" ng-show="job.employee"><span class="label-name-left auto-width">Finished By:</span>{{job.employee.name}}</div></div></div><div class="editing-item" ng-show="job.editing_job_details"><form class="form-horizontal" name="job_details_form" novalidate="true"><div class="control-group"><label class="control-label">Description</label><div class="controls"><input class="input" ng-model="job.editing_job_details.description" type="text" /></div></div><div class="control-group"><label class="control-label">Order Number</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.order_number" type="text" /></div></div><div class="control-group"><label class="control-label">Job Number</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.number" type="text" /></div></div><div class="control-group"><label class="control-label">Start Time</label><div class="controls"><ad-datepicker error="top" ng-model="job.editing_job_details.time"></ad-datepicker><ad-timepicker error="top" ng-model="job.editing_job_details.time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimate</label><div class="controls"><div class="input-append"><input class="input-small" ng-model="job.editing_job_details.total_hours" step="any" type="number" /><span class="add-on">hours</span></div></div></div><div class="control-group"><label class="control-label">Pickup time</label><div class="controls"><ad-datepicker error="top" ng-model="job.editing_job_details.pickup_time"></ad-datepicker><ad-timepicker error="top" ng-model="job.editing_job_details.pickup_time"></ad-timepicker></div></div><div class="control-group" ng-show="asset_property_set().key_tag"><label class="control-label">Key Tag</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.key_tag" type="text" /></div></div><div class="control-group"><label class="control-label">Odometer:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.odometer" type="text" /></div></div><div class="control-group" ng-show="show_hubodometer()"><label class="control-label">Hubodometer:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.hubodometer" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().machine_hours"><label class="control-label">Machine Hours:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.machine_hours" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_hours"><label class="control-label">Engine Hours:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.engine_hours" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().sleeper_air_engine_hours"><label class="control-label">Sleeper Air Enghine Hours:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.sleeper_air_engine_hours" type="text" /></div></div><div class="control-group"><label class="control-label">Finished Time:</label><div class="controls"><ad-datepicker error="top" ng-model="job.editing_job_details.finished_time"></ad-datepicker><ad-timepicker error="top" ng-model="job.editing_job_details.finished_time"></ad-timepicker></div></div><div class="control-group" ng-show="courtesy_vehicles().length == 0"><label class="control-label">Courtesy {{asset_name()}}:</label><div class="controls"><input ng-model="job.editing_job_details.replacement_provided" type="checkbox" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_job_details()">Save</button><button class="btn" ng-click="cancel(job, &#39;editing_job_details&#39;)">Cancel</button><div class="spinner" id="job-update-details-spinner"></div></div></div></form></div><br /><div class="editable" ng-click="edit_job_mechanics()" ng-hide="job.editing_mechanics"><div><div class="info"><span class="label-name-left auto-width">Mechanics:</span><span>{{employee_names()|na}}</span></div></div></div><div class="editing-item" ng-show="job.editing_mechanics"><form><div><label class="label-name-left">Mechanic 1:</label><select ng-model="mechanic_1_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(1)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 2:</label><select ng-model="mechanic_2_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(2)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 3:</label><select ng-model="mechanic_3_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(3)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 4:</label><select ng-model="mechanic_4_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(4)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left"></label><div><button class="btn btn-success" ng-click="save_job_mechanics()">Save</button><button class="btn" ng-click="cancel(job, &#39;editing_mechanics&#39;)">Cancel</button></div></div></form></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/job_files.html",'<div class="sub-header"><div class="inline" id="job-photos">Photos/Documents</div><div class="pull-right" ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_job_files()">Upload</button></div></div><div class="job-files" ng-hide="uploading_files"><div class="pull-right"></div><div class="inline job-photo" ng-repeat="photo in job.photos" style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><div ng-show="job.documents.length &gt; 0"><div class="bold">Documents</div><div ng-repeat="document in job.documents"><div class="editable" ng-click="edit_file(document)" ng-hide="document.editing"><span>{{document.file_name}} &nbsp;</span><a ng-href="{{document.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="document.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="document.editing.file_name" type="text" /></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(document)">Save</button><button class="btn" ng-click="cancel_edit_file(document)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(document)">Remove</button></div></form></div></div></div></div><div id="photo-viewer"><div class="popover fade right in" style="width: 800px; height: 1000px"><div class="popover-title"><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="full_size_photo()">Full Size</button><button class="btn btn-primary" ng-click="close_photo_viewer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div style="height: 750px"><carousel><slide active="photo.active" ng-repeat="photo in job.photos"><img ng-src="{{photo.url}}" style="margin:auto; max-width: 100%; max-height:750px;" /></slide></carousel></div></div><div class="row-fluid"><center><div class="inline job-photo" ng-class="{&#39;job-photo-active&#39;: photo.active}" ng-repeat="photo in job.photos"><div style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><button class="btn btn-danger" ng-click="remove_photo(photo)" ng-show="photo.active">Remove</button></div></center></div></div></div></div><form action="/jobs/{{job.id}}/upload_files" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /></div><br /><div class="inline" id="upload-photos-spinner"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/job_list.html",'<div class="spinner" id="current-jobs-spinner"></div><div class="content-box"><div class="page-header">Current Jobs<div class="pull-right" ng-hide="restricted_to_create_jobs()"><a class="btn btn-primary" href="#/jobs/new"><i class="icon icon-wrench"></i><span>New Job</span></a><a class="btn btn-primary" href="#/bookings/new"><i class="icon icon-calendar"></i><span>New Booking</span></a></div></div><div><div class="pull-left"><label class="checkbox"><input ng-model="only_on_hold" type="checkbox" />Only  On Hold</label></div><div class="pull-right"><div class="input-append"><input id="jobs-search-input" ng-model="current_job_search" type="text" /><span class="add-on"><i class="icon icon-search"></i></span></div></div></div><table class="table table-striped"><tbody><tr class="goto" ng-repeat="job in current_jobs(page_number)"><td class="current-job-content"><div class="spinner" id="job-{{job.id}}"></div><div class="row-fluid"><div class="dashboard-job-number"><div><div class="dropdown inline" id="actions-job-{{job.id}}"><a dropdown-toggle="true"><span><i class="icon icon-reorder"></i></span></a><ul class="dropdown-menu"><li><button class="btn btn-link"><a ng-href="/jobs/{{job.id}}/print.pdf" target="_blank"><i class="icon-print"></i><span>Print</span></a></button></li><li><button class="btn btn-link" id="put-on-hold-{{job.id}}" ng-click="put_on_hold(job)"><i class="icon-pause"></i><span>Put On Hold</span></button></li><li><button class="btn btn-link" id="send-sms-{{job.id}}" ng-click="send_sms(job)"><i class="icon icon-mobile-phone"></i><span>SMS</span></button></li><li><button class="btn btn-link" id="send-email-{{job.id}}" ng-click="send_email(job)"><i class="icon icon-envelope"></i><span>Email</span></button></li><li><button class="btn btn-link" id="tag-{{job.id}}" ng-click="tag(job)"><i class="icon icon-tags"></i><span>Tags</span></button></li><li><button class="btn btn-link" id="assign-{{job.id}}" ng-click="assign(job)"><i class="icon icon-wrench"></i><span>Assign To</span></button></li></ul></div><div class="inline">#{{job.number}}</div></div><div ng-show="job.tags.length &gt; 0"><div ad-tag-icons="true" owner="job"></div></div></div><a class="goto" ng-href="#/jobs/{{job.id}}"><div class="dashboard-job-types"><div>{{job.full_description}}</div><div ng-show="job.key_tag.length &gt; 0">Key Tag: {{job.key_tag}}</div><div class="italic" ng-show="job.employees.length &gt; 0">({{job.employees|comma_seperated: \'name\'}})</div></div><div class="dashboard-vehicle"><div>{{job.vehicle|vehicle_title}}</div><div ng-show="job.vehicle.fleet_number">Fleet No.: {{job.vehicle.fleet_number}} </div><div ng-show="job.vehicle.vin">VIN: {{job.vehicle.vin}} </div></div><div class="dashboard-customer text-align-right"><div>{{job.customer.name}}</div><div>{{job.customer|phone_number}}</div></div></a></div></td></tr></tbody></table><div ng-show="total_pages() &gt; 1"><pagination boundary-links="true" current-page="page_number" max-size="30" num-pages="total_pages()" on-select-page="show(page)" rotate="false"></pagination></div><div class="page-header">Jobs On Hold</div><table class="table table-striped"><tbody><tr class="goto" ng-repeat="job in on_hold_jobs()"><td class="current-job-content"><div class="spinner" id="job-{{job.id}}"></div><div class="row-fluid"><div class="dashboard-job-number"><div><div class="inline"><div class="dropdown" id="actions-job-{{job.id}}"><a dropdown-toggle="true"><i class="icon icon-reorder"></i></a><ul class="dropdown-menu"><li><button class="btn btn-link"><a ng-href="/jobs/{{job.id}}/print.pdf" target="_blank"><i class="icon-print"></i><span>Print</span></a></button></li><li><button class="btn btn-link" id="put-on-hold-{{job.id}}" ng-click="continue(job)"><i class="icon-play"></i><span>Continue</span></button></li><li><button class="btn btn-link" id="send-sms-{{job.id}}" ng-click="send_sms(job)"><i class="icon icon-mobile-phone"></i><span>SMS</span></button></li><li><button class="btn btn-link" id="send-email-{{job.id}}" ng-click="send_email(job)"><i class="icon icon-envelope"></i><span>Email</span></button></li><li><button class="btn btn-link" id="tag-{{job.id}}" ng-click="tag(job)"><i class="icon icon-tags"></i><span>Tags</span></button></li><li><button class="btn btn-link" id="assign-{{job.id}}" ng-click="assign(job)"><i class="icon icon-wrench"></i><span>Assign To</span></button></li></ul></div></div><div class="inline">#{{job.number}}</div></div><div ng-show="job.tags.length &gt; 0"><div ad-tag-icons="true" owner="job"></div></div><div class="label label-warning" tooltip="{{job.on_hold_reason}}">On Hold</div><div ng-show="job.status == &#39;preparing&#39;"><div class="label label-info">Preparing</div></div></div><a class="goto" href="javascript:void(0)" ng-click="open_job(job)"><div class="dashboard-job-types"><div class="orange">{{job.on_hold_reason}}</div><div>{{job.full_description}}</div><div class="italic" ng-show="job.employees.length &gt; 0">({{job.employees|comma_seperated: \'name\'}})</div></div><div class="dashboard-vehicle"><div>{{job.vehicle|vehicle_title}}</div><div ng-show="job.vehicle.fleet_number">Fleet No.: {{job.vehicle.fleet_number}} </div><div ng-show="job.vehicle.vin">VIN: {{job.vehicle.vin}} </div></div><div class="dashboard-customer text-align-right"><div>{{job.customer.name}}</div><div>{{job.customer.phone}}</div></div></a></div></td></tr></tbody></table></div><div class="spinner" id="upcoming-bookings-spinner"></div><div class="content-box"><div class="row-fluid"><div class="pull-left"><div class="page-header">Upcoming Bookings (next 7 days)</div></div><div class="pull-right"><a ng-href="#/bookings/">All Bookings</a></div></div><table class="table table-striped upcoming-bookings"><tbody><tr ng-repeat="booking in filtered_bookings()"><td><div class="dashboard-booking-time"><div class="bold"><div><span>{{booking.time | date: \'mediumTime\'}}<br />{{booking.time | date: \'mediumDate\'}}</span></div><div><div>By {{booking.created_by}}</div></div></div><div ng-show="booking.status == &#39;preparing&#39;"><label class="label label-info">Preparing</label></div></div><div class="dashboard-job-types">{{booking.full_description}}<div class="italic" ng-show="booking.employees.length &gt; 0">({{booking.employees|comma_seperated:\'name\'}})</div></div><div class="dashboard-vehicle"><div>{{booking.vehicle.title}}</div><div ng-show="booking.vehicle.fleet_number">Fleet No.: {{booking.vehicle.fleet_number}} </div></div><div class="dashboard-customer text-align-right">{{booking.name}}<br />{{booking.mobile || booking.phone}}</div><br /><br /><div><div class="inline" ng-hide="booking.job_id"><a href="#/bookings/{{booking.id}}/edit"><i class="icon-pencil"></i>Edit</a><span>&nbsp;&nbsp;</span><a class="btn btn-link" href="#/jobs/new?booking={{booking.id}}&amp;prepare=true"><i class="icon-wrench"></i>Prepare</a><span>&nbsp;&nbsp;</span><a class="btn btn-link" href="#/jobs/new?booking={{booking.id}}"><i class="icon-ok green"></i>Start</a></div><div class="inline" ng-show="booking.job_id"><a href="#/bookings/{{booking.id}}/edit"><i class="icon-pencil"></i>Edit</a><span>&nbsp;&nbsp;</span><a class="btn btn-link" href="#/jobs/{{booking.job_id}}"><i class="icon-ok green"></i>Prepare/Start</a></div><span>&nbsp;&nbsp;</span><div class="inline"><button class="btn btn-link" ng-click="cancel_booking(booking)"><i class="icon-remove red"></i>Cancel</button></div></div></td></tr></tbody></table></div><div ad-put-on-hold="true" anchor-element="actions_job_anchor" ng-model="action_job" placement="top" showing="putting_on_hold"></div><div ad-send-email="true" anchor-element="actions_job_anchor" customer="action_job.customer" job="action_job" placement="top" showing="sending_email" vehicle="action_job.vehicle"></div><div ad-send-sms="true" anchor-element="actions_job_anchor" customer="action_job.customer" job="action_job" placement="top" showing="sending_sms" vehicle="action_job.vehicle"></div><div ad-tags="true" anchor-element="actions_job_anchor" owner="action_job" placement="top" resource="Job" showing="tagging_job"></div><div ad-assign-employees="true" anchor-element="actions_job_anchor" job="action_job" placement="top" showing="assigning_job"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/loading.html",'<div ng-controller="LoadingJobController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="spinner" id="job-loading"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/new.html",'<ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div ng-controller="NewJobController"><div class="page-header">New Job</div><div class="content-box"><div class="row-fluid"><div class="column span7"><form class="form-horizontal" name="job_form" novalidate="true"><input ng-model="job.customer.id" type="hidden" /><input ng-model="job.vehicle.id" type="hidden" /><div ad-customer-vehicle-form="true" customer="job.customer" recommendations="recommendations" selection="selection" vehicle="job.vehicle"></div><div class="sub-header">Job</div><div class="control-group"><label class="control-label"></label></div><div class="controls"><div id="current-jobs-notification" ng-show="current_jobs.length &gt; 0"><span style="color: red">Ongoing job exists for this vehicle</span><button class="btn btn-link" ng-click="open_current_jobs()">Click Here To Show Them</button></div></div><div class="control-group"><label class="control-label"><div>Invoice To 3rd Party</div><div ad-3rd-party-explain="true"></div></label><div class="controls"><insurerpicker ng-model="job.job.insurer_id"></insurerpicker></div></div><div ng-model="job.job" royaltypicker="true"></div><div class="control-group"><label class="control-label">Short Description</label><div class="controls"><input class="input span12" maxlength="255" ng-model="job.job.description" type="text" /></div></div><div class="control-group"><label class="control-label">Note/More Details</label><div class="controls"><button class="btn btn-link" ng-click="add_note()" ng-hide="show_note" type="button">Add a note</button><textarea class="note" ng-model="job.job.note" ng-show="show_note" type="text"></textarea></div></div><div class="control-group"><label class="control-label">Job Types</label><div class="controls"><div ad-job-type-selection="true" ng-model="job.job.job_type_ids" on-change="calculate_estimate_work_hours(old, value)"></div></div></div><div class="control-group" ng-show="job.job.insurer_id"><label class="control-label">Claim No.#</label><div class="controls"><input ng-model="job.job.claim_number" type="text" /></div></div><div class="control-group" ng-show="job.job.insurer_id"><label class="control-label">Account No.#</label><div class="controls"><input ng-model="job.job.account_number" type="text" /></div></div><div class="control-group" ng-show="job.job.insurer_id"><label class="control-label">Excess</label><div class="controls"><input ng-model="job.job.excess" type="text" /></div></div><div class="control-group"><label class="control-label">Mechanics</label><div class="controls"><span ad-employee-tag="true" employees="booking.employees" empty=""></span><button class="btn btn-link" ng-click="show_assign_to_mechanics()" ng-hide="showing_assign_to_mechanics">Assign</button><div ng-show="showing_assign_to_mechanics"><button class="btn btn-link" ng-click="show_schedule()">Show Schedule</button><div id="show-schedule-position" style="position: absolute, margin-left: 500px; visibility: hidden"></div><div><label class="label-name-left">Mechanic 1:</label><select ng-model="job.mechanic_1_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(1)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 2:</label><select ng-model="job.mechanic_2_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(2)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 3:</label><select ng-model="job.mechanic_3_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(3)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 4:</label><select ng-model="job.mechanic_4_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(4)"><div class="icon icon-remove red"></div></a></div></div></div></div><div class="control-group"><label class="control-label">Start Time</label><div class="controls"><div id="show-courtesy-booking-form-position" style="position: absolute, margin-left: 500px; visibility: hidden"></div><ad-datepicker error="top" ng-model="job.job.time"></ad-datepicker><ad-timepicker ng-model="job.job.time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimated Finished Time</label><div class="controls"><ad-datepicker error="top" ng-model="job.job.finished_time"></ad-datepicker><ad-timepicker ng-model="job.job.finished_time"></ad-timepicker></div></div><div class="control-group" ng-hide="provide_mobile_service()"><label class="control-label">Pickup time</label><div class="controls"><ad-datepicker error="top" ng-model="job.job.pickup_time"></ad-datepicker><ad-timepicker ng-model="job.job.pickup_time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimated work hours</label><div class="controls"><input class="input-small" ng-model="job.job.total_hours" step="any" type="number" /></div></div><div class="control-group"><label class="control-label">Order Number</label><div class="controls"><input class="input-small" ng-model="job.job.order_number" type="text" /></div></div><div class="control-group" ng-show="manual_job_number()"><label class="control-label">Job Number</label><div class="controls"><input class="input-small" ng-model="job.job.number" type="text" /></div></div><div class="control-group"><label class="control-label">Odometer</label><div class="controls"><input class="input-small" ng-model="job.job.odometer" step="any" type="number" /></div></div><div class="control-group" ng-show="show_hubodometer()"><label class="control-label">Hubodometer</label><div class="controls"><input class="input-small" ng-model="job.job.hubodometer" step="any" type="number" /></div></div><div class="control-group" ng-show="asset_property_set().engine_hours"><label class="control-label">Engine Hours</label><div class="controls"><input class="input-small" ng-model="job.job.engine_hours" step="any" type="number" /></div></div><div class="control-group" ng-show="asset_property_set().machine_hours"><label class="control-label">Machine Hours</label><div class="controls"><input class="input-small" ng-model="job.job.machine_hours" step="any" type="number" /></div></div><div class="control-group" ng-show="asset_property_set().key_tag"><label class="control-label">Key Tag</label><div class="controls"><input class="input-small" ng-model="job.job.key_tag" type="text" /></div></div><div class="control-group"><label class="control-label">Courtesy {{asset_name()}}</label><div class="controls"><input id="job-courtesy-vehicle-checkbox" ng-click="toggle_courtesy_vehicle_bookings()" ng-model="job.job.replacement_provided" style="margin-right: 10px;" type="checkbox" /><div ng-show="job.job.courtesy_vehicle_booking.vehicle" style="margin-left: 20px; margin-top: -17px;"><div class="inline">Booking selected for {{job.job.courtesy_vehicle_booking.vehicle.title}}</div><a class="inline" href="javascript:void(0)" ng-click="show_courtesy_vehicle_bookings()" style="margin-left: 5px;" target="_blank">Edit</a></div></div></div><div class="control-group"><label class="control-label"><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="job.job" placement="top" showing="x_tags"></div></label><div class="controls"><div ad-tag-labels="true" owner="job.job"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="job.job"></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-primary" id="create-new-job" ng-click="create()" type="submit">Save</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="new-job-spinner"></div></div></div></form><div id="courtesy-vehicle-booking-form"><div class="popover fade top in" style="min-width: 900px; width: 50%"><div class="arrow"></div><div class="popover-title"><div class="sub-header">Courtesy {{asset_name()}} Booking<div class="pull-right"><button class="btn" ng-click="hide_courtesy_vehicle_bookings()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div class="column span12"><div ad-courtesy-vehicle-availability="true" job="job.job" on-select-vehicle="on_book_courtesy_vehicle()"></div></div></div><div class="row-fluid"><button class="btn" ng-click="hide_courtesy_vehicle_bookings()"><i class="icon-remove"></i>Close</button></div></div></div></div></div><div class="column span5"><div ad-customer-vehicle-recommendations="true" ng-model="recommendations" owner="job.job" selection="selection"></div></div></div></div><div modal="showing_data_alert" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Confirmation</h3></div><div class="modal-body"><div class="warning" ng-hide="is_present(job.customer)">There is no data for customer</div><div class="warning" ng-hide="is_present(job.vehicle)"> There is no data for vehicle</div><div class="warning">Are you sure you want to create the job?</div></div><div class="modal-footer"><button class="btn btn-success" ng-click="do_save_job()">Yes, Create It</button><button class="btn" ng-click="cancel_save_job()">No</button></div></div><div id="vehicle-current-jobs-popover"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">{{job.vehicle.title}}\'s Current Jobs</div></div><div class="popover-content"><div class="content-box"><table class="table table-striped"><tbody><tr ng-repeat="job in current_jobs"><td><a class="goto" href="#/jobs/{{job.id}}" target="_blank"><span>{{job.title}}</span></a></td></tr></tbody></table></div><div class="buttons"><button class="btn" ng-click="close_current_jobs()">Close</button></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/notes.html",'<div class="sub-header">Notes</div><ad-notes enable-workshop-only="true" model-type="job" ng-model="job"></ad-notes>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/owner_detail.html",'<div class="vehicle-owner-details goto" id="vehicle-owner" ng-click="show_customer()"><div class="info"><span class="label-name-left auto-width">Customer:</span>{{customer.name | na}}</div><div class="info" ng-show="customer.contact_name"><span class="label-name-left auto-width">Contact Person:</span>{{customer.contact_name}}</div><div class="info"><span class="label-name-left auto-width">Email:</span>{{customer.email | na}}</div><div class="info"><span class="label-name-left auto-width">Mobile:</span>{{customer.mobile | na}}</div><div class="info" ng-show="customer.phone"><span class="label-name-left auto-width">Phone:</span>{{customer.phone}}</div></div><div ng-switch="pop_customer"><div ng-switch-when="true"><div id="customer"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{$parent.customer.name}}<div class="pull-right"><button class="btn btn-danger" ng-click="$parent.change_job_customer()"><i class="icon-refresh"></i>Change Customer</button><a class="btn" ng-href="#/customers/{{$parent.customer.id}}"><i class="icon-external-link"></i><span>Full Details</span></a><button class="btn" ng-click="$parent.close_customer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><br /><ad-customer ng-model="$parent.customer" on-save="$parent.customer_updated()" on-select-vehicle="$parent.goto_vehicle(vehicle)"></ad-customer></div></div></div></div><div ad-change-customer="true" anchor-element="#vehicle-owner" customer="$parent.customer" job="$parent.job" on-transfer-vehicle="$parent.fetch_vehicle()" showing="$parent.changing_job_customer" vehicle="$parent.job.vehicle"></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/purchases.html",'<div id="purchase-list"></div><div class="content-box"><div class="row-fluid"><div class="pull-left"><div class="sub-header">Purchase Orders</div></div><div class="pull-right"><button class="btn btn-link" id="new-purchase-order-button" ng-click="$parent.add_purchase_order()">New Purchase Order</button></div></div><table class="table table-striped table-bordered"><tbody><tr ng-repeat="purchase in $parent.job.purchases"><td id="purchase-{{purchase.id}}"><div class="row-fluid"><div class="pull-left"><div class="inline" style="width: 100px">#{{purchase.number}}</div><div class="inline"><span class="bold">Supplier:&nbsp;</span><span>{{purchase.supplier.name}}</span></div></div><div class="pull-left"><div class="inline" style="margin-left: 20px"><span class="bold">Date:&nbsp;</span><span>{{purchase.date|date}}</span></div><div class="inline" style="margin-left: 20px"><span class="bold">Due Date:&nbsp;</span><span>{{purchase.due_date|date}}</span></div></div><div class="pull-right" style="text-align: right"><div class="btn-group" style="margin-left: 10px"><a class="btn btn-link dropdown-toggle" data-toggle="dropdown" href="#"><span>Actions</span><span class="caret"></span></a><ul class="dropdown-menu" style="text-align: left;"><li ng-show="$parent.repco_account() &amp;&amp; $parent.repco_supplier(purchase)"><button class="btn btn-link" ng-click="$parent.order_repco(purchase, $parent.repco_account())"><img src="/assets/repco_navigator-8e21ef0b294533a128d4feada69c8241.png" style="height: 20px;" /></button></li><li ng-show="$parent.quantum_account() &amp;&amp; $parent.quantum_supplier(purchase)"><button class="btn btn-link" ng-click="$parent.order_repco(purchase, $parent.quantum_account())"><img src="/assets/quantum_pro-5e21beca4f69abf19b557f26df4871f2.png" style="height: 20px;" /></button></li><li ng-show="$parent.pro_link_account() &amp;&amp; $parent.pro_link_supplier(purchase)"><button class="btn btn-link" ng-click="$parent.order_repco(purchase, $parent.pro_link_account())"><img src="/assets/pro_link-ed0e9bca251211f98062a43051fa0baf.png" style="height: 20px;" /></button></li><li ng-show="$parent.motospecs_account() &amp;&amp; $parent.motospecs_supplier(purchase)"><button class="btn btn-link" ng-click="$parent.order_repco(purchase, $parent.motospecs_account())"><img src="/assets/motospecs-a9a4edc7104b920de0eeb485620ff60b.jpg" style="height: 30px;" /></button></li><li><a ng-href="/purchases/{{purchase.id}}/print_order.pdf" target="_blank"><i class="icon icon-print"></i><span>Print Order</span></a></li><li><a href="javascript:void(0)" id="email-purchase-order" ng-click="$parent.send_purchase_order(purchase)"><i class="icon icon-envelope"></i><span>Email Order</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.edit_purchase(purchase)"><i class="icon icon-pencil"></i><span>Edit/Details</span></a></li><li ng-hide="purchase.processed || $parent.restricted_to_process_purchase_orders()"><a href="javascript:void(0)" ng-click="$parent.process_purchase_order(purchase)"><i class="icon icon-retweet"></i><span>Process</span></a></li><li ng-hide="$parent.restricted_to_enter_bills()"><a href="javascript:void(0)" ng-click="$parent.add_purchase_bill(purchase)" ng-hide="purchase.billed"><i class="icon icon-dollar"></i><span>Add Bill</span></a><a ng-href="#/bills/{{purchase.bill_id}}" ng-show="purchase.bill_id"><i class="icon icon-dollar"></i><span>Bill Details</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.remove_purchase_order(purchase)"><i class="icon icon-remove red"></i><span>Remove</span></a></li></ul></div><span ng-show="purchase.processed"><span class="badge badge-info">Processed</span><span>&nbsp;</span></span><span class="badge" ng-class="{&#39;badge-info&#39;: purchase.status == &#39;sent&#39;, &#39;badge-success&#39;: purchase.status == &#39;billed&#39; || purchase.status == &#39;paid&#39;}" ng-hide="purchase.status == &#39;processed&#39;">{{purchase.status}}</span></div></div><div class="row-fluid" ng-show="purchase.tags.length &gt; 0"><label class="label" ng-repeat="tag in purchase.tags" style="height: 25px; background-color: {{tag.color_code}}; margin-left: 2px; margin-right: 2px">{{tag.name}}</label></div><hr /><div class="row-fluid" ng-repeat="item in purchase.purchase_items" ng-show="item.job &amp;&amp; item.job.id == $parent.job.id"><div class="column span6">{{item.description}}</div><div class="column span6" style="font-size: 80%"><div class="pull-right"><div ng-show="item.unit_price &gt; 0"><div class="inline bold">Buy:</div> <div class="inline">{{item.unit_price|currency}} x {{item.quantity}}</div><div class="inline" style="width: 120px; text-align: right"><span>&#61 {{item.unit_price * item.quantity|currency}}</span> <span ng-show="item.included_gst">(incl. gst)</span></div></div><div ng-hide="item.unit_price &gt; 0"><div class="inline bold">Quantity: {{item.quantity}}</div> </div><div ng-show="item.sell_price &amp;&amp; item.sell_price &gt; 0"><div class="inline bold">Sell:</div> <div class="inline">{{item.sell_price|currency}} x {{item.quantity}}</div><div class="inline" style="width: 120px; text-align: right"><span>&#61 {{item.sell_price * item.quantity |currency}}</span> <span ng-show="item.included_gst">(incl. gst)</span></div></div></div></div></div><div class="row-fluid" ng-show="purchase.details"><pre class="no-style">{{purchase.details}}</pre></div></td></tr></tbody></table><div id="new-purchase-order-popover"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="sub-header">Purchase Order</div></div><div class="popover-content"><div class="content-box"><div ad-purchase-order-form="true" invoice="$parent.job.invoice" job="$parent.job" ng-model="$parent.new_purchase_order" on-cancel="$parent.cancel_add_purchase_order()" on-save="$parent.insert_new_purchase_order($parent.new_purchase)"></div></div></div></div></div><div id="purchase-order-popover"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="pull-right"><i class="icon icon-remove goto" ng-click="$parent.close_edit_purchase()"></i></div><div class="sub-header">Purchase Order</div></div><div class="popover-content"><div class="row-fluid"><div class="pull-right"><div ad-tag-labels="true" class="inline" owner="$parent.editing_purchase"></div><button class="btn btn-link" id="purchase-tags" ng-click="$parent.p_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#purchase-tags&#39;" owner="$parent.editing_purchase" placement="left" resource="Purchase" showing="$parent.p_tags"></div></div></div><div class="content-box"><div ad-purchase="true" job="$parent.job" ng-model="$parent.editing_purchase" template="simple"></div></div><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="$parent.close_edit_purchase()">Close</button><button class="btn btn-primary" ng-click="$parent.close_edit_and_send_purchase()">Close And Send</button></div></div></div></div></div></div><div ad-email-purchase-order="true" anchor-element="#purchase-list" ng-model="$parent.sending_purchase" placement="bottom" showing="$parent.sending_purchase"></div><div ad-purchase-order-bill-form="true" anchor-element="#purchase-list" ng-model="$parent.billed_purchase" on-save="$parent.refresh_invoice()" placement="bottom" showing="$parent.billed_purchase"></div><div modal="$parent.deleting_purchase" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this purchase</h3></div><div class="modal-body"><div>Are you sure you want to delete this Purchase ?</div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="$parent.do_delete_purchase()">Yes, Delete It</button><button class="btn" ng-click="$parent.cancel_delete_purchase()">Cancel</button></div></div><div ad-process-purchase-order="true" anchor-element="#purchase-list" ng-model="$parent.processing_purchase" on-processed="$parent.refresh_invoice()" placement="bottom" showing="$parent.processing_purchase"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/quote.html",'<div class="content-box" id="quote-page"><div class="spinner" id="quote-page-spinner"></div><div class="job-quote"><div class="row-fluid"><div class="pull-left"><div class="sub-header" id="quote-header">Quote #{{$parent.job.quote.number}}</div></div><div class="pull-right" style="text-align: right"><div ng-hide="$parent.job.quote"><button class="btn btn-link" ng-click="$parent.create_quote()">Create Quote</button><span>&nbsp;::&nbsp;</span><button class="btn btn-link" id="add-existing-quote-button" ng-click="$parent.add_existing_quote()">Add Existing Quote</button><div class="spinner" id="create-quote-spinner"></div></div><div ng-show="$parent.job.quote"><div class="inline"><span class="label label-info" ng-class="{&#39;label-success&#39;: $parent.job.quote.last_email.status == &#39;delivered&#39;}">{{$parent.job.quote.last_email.status}}</span></div><div class="btn-group" id="quote-actions"><a class="btn btn-link dropdown-toggle" data-toggle="dropdown" href="#"><span>Actions</span><span class="caret"></span></a><ul class="dropdown-menu pull-right" style="text-align: left;"><li><a ng-href="/quotes/{{$parent.job.quote.id}}/print.pdf" target="_blank"><i class="icon icon-print"></i><span>Print</span></a></li><li><a href="javascript:void(0)" id="email-quote-button" ng-click="$parent.send_quote()"><i class="icon icon-envelope"></i><span>Email Quote</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.transfer_quote_to_invoice()"><i class="icon icon-arrow-right"></i><span>Transfer to invoice</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.copy_from_invoice()"><i class="icon icon-arrow-left"></i><span>Copy from invoice</span></a></li><li><a ng-href="#/quotes/{{$parent.job.quote.id}}"><i class="icon icon-external-link"></i><span>Full Details</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.delete_quote()"><i class="icon icon-remove red"></i><span>Remove</span></a></li></ul></div></div></div></div><div ng-show="$parent.job.quote"><div ad-quote="true" ng-model="$parent.job.quote"></div><div ad-email-quote="true" anchor-element="#quote-header" job="$parent.job" ng-model="$parent.job.quote" placement="bottom" showing="$parent.sending_quote"></div></div></div><div id="add-existing-quote-popover"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="pull-right"><i class="icon icon-remove goto" ng-click="$parent.close_add_existing_quote()"></i></div><div class="sub-header">Add Existing Quote</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><label>Quote: &nbsp;</label><div ad-quotepicker="true" class="inline" ng-model="$parent.added_quote.id" quote="$parent.added_quote"></div></div></div><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="$parent.do_add_existing_quote()">Add</button><button class="btn btn-primary" ng-click="$parent.close_add_existing_quote()">Cancel</button><div class="spinner" id="adding-quote-spinner"></div></div></div></div></div></div></div><div modal="$parent.showing_delete_quote_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this quote</h3></div><div class="modal-body"><div>Are you sure you want to delete this quote</div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="$parent.do_delete_quote()">Yes, Delete It</button><button class="btn" ng-click="$parent.cancel_delete_quote()">Cancel</button></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/show.html",'<div ng-controller="ShowJobController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div ng-hide="job &amp;&amp; job.id"><div class="spinner" id="job-loading"></div></div><div ng-show="job &amp;&amp; job.id"><img class="done-sign" ng-show="job &amp;&amp; job.status == &#39;finished&#39;" ng-src="/assets/completed-db7f0f84520f48344132128dbeb76d73.gif" /><img class="paid-sign" ng-show="job.invoice.paid" ng-src="/assets/paid-d5240fc8cfeec7b14de62c19cf6d9848.gif" /><div class="deleted-sign" ng-show="job.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><div class="row-fluid"><div class="pull-left"><div class="page-header"><div class="inline">{{job.title}}</div></div></div><div class="pull-right"><div ad-tag-labels="true" class="inline" owner="job"></div><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="job" placement="left" resource="Job" showing="x_tags"></div></div></div><center><div class="row-fluid well" ng-show="job.on_hold" style="width: 90%; text-align: center;"><label class="label label-warning">ON HOLD</label><span class="bold">&nbsp; {{job.on_hold_reason}}</span></div></center><div class="row-fluid"><div class="pull-left"><div ng-switch="configurations.allow_sub_jobs"><div ng-switch-when="true"><div class="dropdown inline" id="sub-job-actions" ng-show="!$parent.job.master_job_id"><a class="btn" dropdown-toggle="true"><i class="icon icon-plus"></i><span>Add Sub Job</span></a><ul class="dropdown-menu top-dropdown"><li><a id="add-new-sub-job-button" ng-href="#/jobs/new?master_job_id={{$parent.job.id}}&amp;customer_id={{$parent.job.customer.id}}&amp;vehicle_id={{$parent.job.vehicle.id}}"><span>Create New Sub Job</span></a></li><li><a href="javascript:void(0);" id="add-existing-sub-job-button" ng-click="$parent.add_existing_sub_job()"><span>Add Existing Job</span></a></li></ul></div><div class="inline" ng-show="$parent.job.sub_jobs.length &gt; 0"><a href="javascript:void(0)" id="show-sub-jobs-list" ng-click="$parent.show_sub_jobs_list()">Sub Jobs List</a></div><a class="btn" ng-href="#/jobs/{{$parent.job.master_job_id}}" ng-show="$parent.job.master_job_id">Master Job</a><a class="btn" ng-click="$parent.promote()" ng-show="$parent.job.master_job_id"><i class="icon icon-arrow-up"></i><span>Promote</span></a><div id="sub-jobs-list"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="pull-right"><button class="btn btn-primary" ng-click="$parent.close_sub_jobs_list()"><i class="icon icon-remove"></i> <span>Close</span></button></div><div class="sub-header">Sub Job List</div></div><div class="popover-content"><div class="content-box"><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span3">Job No.</div><div class="column span3">Vehicle</div><div class="column span6">Description</div></div></th></tr></thead><tbody><tr ng-repeat="sub_job in $parent.job.sub_jobs"><td><a class="goto" ng-href="#/jobs/{{sub_job.id}}"><div class="row-fluid"><div class="column span3">{{sub_job.number}}</div><div class="column span3">{{sub_job.vehicle|vehicle_title}}</div><div class="column span6">{{sub_job.full_description}}</div></div></a></td></tr></tbody></table></div><button class="btn btn-primary" ng-click="$parent.close_sub_jobs_list()"><i class="icon icon-remove"></i> <span>Close</span></button></div></div></div><div id="add-existing-sub-job"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="sub-header">Add sub job</div></div><div class="popover-content"><div class="content-box"><div>Select a job to add as sub job</div><div ad-jobpicker="true" job="$parent.existing_sub_job" ng-model="$parent.existing_sub_job.id"></div></div><div class="buttons"><button class="btn btn-success" ng-click="$parent.add_sub_job()">Add Sub Job</button><button class="btn" ng-click="$parent.hide_add_existing_sub_job()">Cancel</button><div class="spinner" id="adding-existing-sub-job"></div></div></div></div></div></div></div></div><div class="pull-right"><div class="inline"><a class="btn" ng-href="/jobs/{{job.id}}/print.pdf" target="_blank"><i class="icon-print"></i><span>Print Job Card</span></a><a class="btn" href="javascript:void(0);" id="email-job-card" ng-click="email_job_card()"><i class="icon icon-envelope"></i><span>Email Job Card</span></a><div class="dropdown inline" id="communication-actions"><a class="btn" dropdown-toggle="true"><i class="icon icon-share-alt"></i><span>Send...</span></a><ul class="dropdown-menu top-dropdown"><li><a href="javascript:void(0);" id="send-sms-button" ng-click="send_sms()"><i class="icon icon-mobile-phone"></i><span>Send SMS</span></a></li><li><a href="javascript:void(0);" id="send-email-button" ng-click="send_email()"><i class="icon icon-envelope"></i><span>Send Email</span></a></li></ul></div><button class="btn btn-warning" id="put-on-hold" ng-click="put_on_hold()" ng-hide="job.deleted || job.finished || job.on_hold"><i class="icon icon-stop"></i>Put On Hold</button><button class="btn btn-success" id="continue" ng-click="continue()" ng-hide="!job.on_hold"><i class="icon icon-play"></i>Continue</button><button class="btn btn-primary" id="finish" ng-click="finish()" ng-hide="job.deleted || job.finished"><i class="icon-ok"></i>Finish</button><button class="btn" id="unfinish" ng-click="unfinish()" ng-show="job.finished">Unfinish</button><div id="job-send-email"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Email Job Card</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form><div class="pull-right"><div class="inline" id="job-send-email-spinner"></div></div><label>Email</label><input class="span9" id="job-send-email-address" ng-model="email" type="text" /><div class="pull-right"><div class="inline" contactpicker="true" model-type="customer" ng-model="job.customer" on-select="email_select_contact(contacts)" show-email="true"></div></div><label>Subject</label><input class="span12" id="job-send-email-subject" ng-model="subject" type="text" /><label><span>Message</span><span ad-saved-texts-button="true" job="job" ng-model="message"></span></label> <textarea class="span12" id="job-send-email-message" ng-model="message" rows="5" type="text"></textarea><div><label class="checkbox"><input ng-model="delivery_notification_required" type="checkbox" /><span>Send me a notification on delivery</span></label></div><div><label class="checkbox"><input ng-model="attached_files" type="checkbox" /><span>Attach Files</span></label></div><div ng-show="attached_files"><table class="table table-striped"><tbody><tr ng-repeat="file in job.photos"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in job.documents"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr></tbody></table></div><div><button class="btn btn-success" ng-click="send_job_card()">Send</button><button class="btn" ng-click="cancel_email_job_card()">Cancel</button></div></form></div></div></div></div></div><div ad-put-on-hold="true" anchor-element="put_on_hold_anchor" ng-model="job" placement="bottom" showing="putting_on_hold"></div><div ad-finish-job="true" anchor-element="#finish" ng-model="job" on-paying="pay()" showing="finishing" vehicle="vehicle"></div><div ad-pay-invoice="true" anchor-element="#pay" ng-model="job.invoice" showing="paying"></div><div ad-send-email="true" anchor-element="&#39;#communication-actions&#39;" customer="job.customer" job="job" placement="left" showing="show_send_email" vehicle="job.vehicle"></div><div ad-send-sms="true" anchor-element="&#39;#communication-actions&#39;" customer="job.customer" job="job" placement="left" showing="show_send_sms" vehicle="job.vehicle"></div><div modal="showing_delete_job_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this job</h3></div><div class="modal-body"><div>Are you sure you want to delete this Job?</div><div ng-show="job.booking"><label class="checkbox"><input ng-model="delete_booking" type="checkbox" />Also delete the job\'s booking</label></div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><div class="spinner" id="delete-job-spinner"></div><button class="btn btn-danger" ng-click="do_delete_job()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_job()">Cancel</button></div></div><div id="in-progress-work-hours"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">You are current clocked on to another job</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div>You are current clocked on the the following jobs</div><br /><br /><div class="spinner" id="in-progress-clocking-spinner"></div><table class="table table-striped"><tr ng-repeat="work_hour in in_progress_work_hours"><td>{{work_hour.job.title}}</td><td><button class="btn btn-link" ng-click="clock_off_in_progress(work_hour)" ng-hide="require_timesheet_description(work_hour)">Clock Off</button></td><td><div class="pull-right"><a class="btn btn-link" ng-href="#/jobs/{{work_hour.job.id}}" target="_blank">Open</a></div></td></tr></table></div><button class="btn" ng-click="close_in_progress_work_hours()">Close</button></div></div></div></div></div><div class="inline"><button class="btn btn-primary" id="pay" ng-click="pay()" ng-hide="job.deleted || job.invoice.paid || !job.invoice || restricted_to_enter_payment()"><i class="icon-dollar"></i>Pay</button></div><div class="inline" ng-show="!job.deleted &amp;&amp; job.invoice.id"><div ad-invoice-actions="true" email="job.invoice.customer.email" job="job" ng-model="job.invoice"></div></div><button class="btn btn-delete btn-danger" ng-click="delete_job()" ng-hide="job.deleted || restricted_to(&#39;deletion&#39;)">Delete</button></div></div><br /><div class="row-fluid"><div class="column span6"><div class="content-box"><div class="row-fluid"><div class="pull-left"><div class="sub-header">Job Card</div></div></div><div class="row-fluid"><div class="pull-left"><div class="job-details" ng-click="edit_job_types()" ng-hide="job.editing_job_types"><div class="editable"><div class="info"><span class="label-name-left auto-width">Job Type:</span><span class="inline" style="max-width: 200px">{{job.job_types_title|na}}</span></div></div></div><div class="editing-item" ng-show="job.editing_job_types"><form class="form-horizontal" name="job_types_form" novalidate="true"><div class="control-group"><label class="control-label" style="width: 80px">Job Types</label><div class="controls" style="margin-left: 100px; min-width: 320px"><div ad-job-type-selection="true" ng-model="job.editing_job_types.job_type_ids"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_job_types()">Save</button><button class="btn" ng-click="cancel(job, &#39;editing_job_types&#39;)">Cancel</button><div class="spinner" id="job-update-job-types-spinner"></div></div></div></form></div><div class="job-details" ng-click="edit_job_details()" ng-hide="job.editing_job_details"><div class="editable"><div class="info" ng-show="job.order_number"><span class="label-name-left auto-width">Order Number:</span>{{job.order_number}}</div><div class="info" ng-show="job.quote"><span class="label-name-left auto-width">Quote Number:</span>{{job.quote.number}}</div><div class="info" ng-show="job.created_by"><span class="label-name-left auto-width">Booked In By:</span>{{job.created_by }}</div><div class="info" ng-show="job.time"><span class="label-name-left auto-width">Time:</span>{{job.time | date: \'short\'}}</div><div class="info" ng-show="job.total_hours"><span class="label-name-left auto-width">Estimate:</span>{{job.total_hours}} hours</div><div class="info" ng-show="job.pickup_time"><span class="label-name-left auto-width">Pickup time:</span>{{job.pickup_time | date: \'short\'}}</div><div class="info" ng-show="job.key_tag.length &gt; 0"><span class="label-name-left auto-width">Key Tag:</span><span class="inline" style="max-width: 200px">{{job.key_tag}}</span></div><div class="info"><span class="label-name-left auto-width">Odometer:</span><span ng-show="job.odometer">{{job.odometer|number}} {{job.vehicle.odometer_unit}}</span><span ng-hide="job.odometer">(Not Available)</span></div><div class="info" ng-show="asset_property_set().machine_hours"><span class="label-name-left auto-width">Machine Hours:</span><span ng-show="job.machine_hours">{{job.machine_hours|number}} hr(s)</span><span ng-hide="job.machine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().engine_hours"><span class="label-name-left auto-width">Engine Hours:</span><span ng-show="job.engine_hours">{{job.engine_hours|number}} hr(s)</span><span ng-hide="job.engine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().port_engine_hours"><span class="label-name-left auto-width">Port Engine Hours:</span><span ng-show="job.port_engine_hours">{{job.port_engine_hours|number}} hr(s)</span><span ng-hide="job.port_engine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().starboard_engine_hours"><span class="label-name-left auto-width">Starboard Engine Hours:</span><span ng-show="job.starboard_engine_hours">{{job.starboard_engine_hours|number}} hr(s)</span><span ng-hide="job.starboard_engine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().sleeper_air_engine_hours"><span class="label-name-left auto-width">Sleeper Air Engine Hours:</span><span ng-show="job.sleeper_air_engine_hours">{{job.sleeper_air_engine_hours|number}} hr(s)</span><span ng-hide="job.sleeper_air_engine_hours">(Not Available)</span></div><div class="info" ng-show="show_hubodometer()"><span class="label-name-left auto-width">Hubodometer:</span><span ng-show="job.hubodometer">{{job.hubodometer|number}} {{job.vehicle.odometer_unit}}</span><span ng-hide="job.hubodometer">(Not Available)</span></div><div ng-show="job.finished_time"><div class="info"><span class="label-name-left auto-width">Finished:</span>{{job.finished_time | date: \'mediumDate\'}}</div></div><div class="info" ng-show="job.employee"><span class="label-name-left auto-width">Finished By:</span>{{job.employee.name}}</div></div></div><div class="editing-item" ng-show="job.editing_job_details"><form class="form-horizontal" name="job_details_form" novalidate="true"><div class="control-group"><label class="control-label">Description</label><div class="controls"><input class="input" ng-model="job.editing_job_details.description" type="text" /></div></div><div class="control-group"><label class="control-label">Order Number</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.order_number" type="text" /></div></div><div class="control-group"><label class="control-label">Job Number</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.number" type="text" /></div></div><div class="control-group"><label class="control-label">Start Time</label><div class="controls"><ad-datepicker error="top" ng-model="job.editing_job_details.time"></ad-datepicker><ad-timepicker error="top" ng-model="job.editing_job_details.time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimate</label><div class="controls"><div class="input-append"><input class="input-small" ng-model="job.editing_job_details.total_hours" step="any" type="number" /><span class="add-on">hours</span></div></div></div><div class="control-group"><label class="control-label">Pickup time</label><div class="controls"><ad-datepicker error="top" ng-model="job.editing_job_details.pickup_time"></ad-datepicker><ad-timepicker error="top" ng-model="job.editing_job_details.pickup_time"></ad-timepicker></div></div><div class="control-group" ng-show="asset_property_set().key_tag"><label class="control-label">Key Tag</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.key_tag" type="text" /></div></div><div class="control-group"><label class="control-label">Odometer:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.odometer" type="text" /></div></div><div class="control-group" ng-show="show_hubodometer()"><label class="control-label">Hubodometer:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.hubodometer" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().machine_hours"><label class="control-label">Machine Hours:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.machine_hours" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_hours"><label class="control-label">Engine Hours:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.engine_hours" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().sleeper_air_engine_hours"><label class="control-label">Sleeper Air Enghine Hours:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.sleeper_air_engine_hours" type="text" /></div></div><div class="control-group"><label class="control-label">Finished Time:</label><div class="controls"><ad-datepicker error="top" ng-model="job.editing_job_details.finished_time"></ad-datepicker><ad-timepicker error="top" ng-model="job.editing_job_details.finished_time"></ad-timepicker></div></div><div class="control-group" ng-show="courtesy_vehicles().length == 0"><label class="control-label">Courtesy {{asset_name()}}:</label><div class="controls"><input ng-model="job.editing_job_details.replacement_provided" type="checkbox" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_job_details()">Save</button><button class="btn" ng-click="cancel(job, &#39;editing_job_details&#39;)">Cancel</button><div class="spinner" id="job-update-details-spinner"></div></div></div></form></div><br /><div class="editable" ng-click="edit_job_mechanics()" ng-hide="job.editing_mechanics"><div><div class="info"><span class="label-name-left auto-width">Mechanics:</span><span>{{employee_names()|na}}</span></div></div></div><div class="editing-item" ng-show="job.editing_mechanics"><form><div><label class="label-name-left">Mechanic 1:</label><select ng-model="mechanic_1_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(1)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 2:</label><select ng-model="mechanic_2_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(2)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 3:</label><select ng-model="mechanic_3_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(3)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 4:</label><select ng-model="mechanic_4_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(4)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left"></label><div><button class="btn btn-success" ng-click="save_job_mechanics()">Save</button><button class="btn" ng-click="cancel(job, &#39;editing_mechanics&#39;)">Cancel</button></div></div></form></div><br /></div><div class="pull-right"><div class="vehicle-owner-details goto" id="vehicle-owner" ng-click="show_customer()"><div class="info"><span class="label-name-left auto-width">Customer:</span>{{customer.name | na}}</div><div class="info" ng-show="customer.contact_name"><span class="label-name-left auto-width">Contact Person:</span>{{customer.contact_name}}</div><div class="info"><span class="label-name-left auto-width">Email:</span>{{customer.email | na}}</div><div class="info"><span class="label-name-left auto-width">Mobile:</span>{{customer.mobile | na}}</div><div class="info" ng-show="customer.phone"><span class="label-name-left auto-width">Phone:</span>{{customer.phone}}</div></div><div ng-switch="pop_customer"><div ng-switch-when="true"><div id="customer"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{$parent.customer.name}}<div class="pull-right"><button class="btn btn-danger" ng-click="$parent.change_job_customer()"><i class="icon-refresh"></i>Change Customer</button><a class="btn" ng-href="#/customers/{{$parent.customer.id}}"><i class="icon-external-link"></i><span>Full Details</span></a><button class="btn" ng-click="$parent.close_customer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><br /><ad-customer ng-model="$parent.customer" on-save="$parent.customer_updated()" on-select-vehicle="$parent.goto_vehicle(vehicle)"></ad-customer></div></div></div></div><div ad-change-customer="true" anchor-element="#vehicle-owner" customer="$parent.customer" job="$parent.job" on-transfer-vehicle="$parent.fetch_vehicle()" showing="$parent.changing_job_customer" vehicle="$parent.job.vehicle"></div></div></div><br /><div class="vehicle-details goto" id="vehicle-details" ng-click="show_vehicle()" ng-show="vehicle"><div class="info" ng-show="vehicle.service_note.length &gt; 0"><span class="label label-info">Next Service Note/TODO</span></div><div class="info"><span class="label-name-left auto-width">Make:</span>{{vehicle.make}} {{vehicle.model}} {{vehicle.year}}</div><div class="info"><span class="label-name-left auto-width">Reg. No#:</span>{{vehicle.registration_number | na: \'short\'}}</div><div class="info" ng-show="vehicle.registration_due_date"><span class="label-name-left auto-width">Reg. Due Date:</span>{{vehicle.registration_due_date | date: \'mediumDate\'}}</div><div class="info" ng-show="vehicle.engine_number"><span class="label-name-left auto-width">Engine No#:</span>{{vehicle.engine_number | na: \'short\'}}</div><div class="info" ng-show="vehicle.vin"><span class="label-name-left auto-width">VIN:</span>{{vehicle.vin}}</div><div class="info" ng-show="vehicle.fleet_number"><span class="label-name-left auto-width">Fleet No#:</span>{{vehicle.fleet_number | na: \'short\'}}</div><div class="info" ng-show="vehicle.fleet_number"><span class="label-name-left auto-width">Driver Name:</span>{{vehicle.driver_name}}</div><div class="info" ng-show="vehicle.driver_phone"><span class="label-name-left auto-width">Driver Phone:</span>{{vehicle.driver_phone}}</div><div class="info" ng-show="vehicle.driver_email"><span class="label-name-left auto-width">Driver Email:</span>{{vehicle.driver_email}}</div><div class="info" ng-show="vehicle.location"><span class="label-name-left auto-width">Location:</span>{{vehicle.location}}</div></div><div ng-switch="pop_vehicle"><div ng-switch-when="true"><div id="vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{$parent.vehicle.title}}<div class="pull-right"><button class="btn btn-danger" ng-click="$parent.change_vehicle()"><i class="icon-refresh"></i>Change To Different {{$parent.asset_name()}}</button><button class="btn" ng-click="$parent.close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-vehicle="true" ng-hide="$parent.new_vehicle" ng-model="$parent.vehicle" on-save="$parent.close_vehicle()"></div></div></div></div></div><div id="change-vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">{{$parent.vehicle.title}}<div class="pull-right"><button class="btn" ng-click="$parent.show_vehicle()">Show Current {{$parent.asset_name()}}</button><button class="btn" ng-click="$parent.close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-change-vehicle="true" model-type="job" ng-model="$parent.job" on-cancel="$parent.show_vehicle()" on-save="$parent.vehicle_changed()" showing="$parent.changing_vehicle" vehicle="$parent.job.vehicle"></div></div></div></div></div></div></div></div></div><div class="row-fluid"><br /><div class="sub-header">Notes</div><ad-notes enable-workshop-only="true" model-type="job" ng-model="job"></ad-notes></div><hr /><div class="row-fluid"><div class="spinner" id="work-spinner"></div><div class="row-fluid"><div class="pull-left"><div class="sub-header">Check Sheet</div></div><div class="pull-right"><span class="goto" ng-click="close_checksheet = true" ng-hide="close_checksheet">Close</span><span class="goto" ng-click="close_checksheet = false" ng-hide="!close_checksheet">Open</span></div></div><div class="row-fluid" ng-hide="close_checksheet"><ul class="work-check-list" id="work-check-list" ng-model="job.works" ui-sortable="work_sortable_options"><li id="work-{{work.id}}" ng-hide="work.editing" ng-repeat="work in job.works"><div class="editable" ng-click="edit_work(work)" ng-show="work.header"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline bold">{{work.title}}</div></div><div ng-hide="work.header"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline work-check"><span>&nbsp;&nbsp;</span><i class="icon-check green pointer" ng-click="toggle_work(work)" ng-show="work.status == &#39;yes&#39;"></i><i class="icon-unchecked pointer" ng-click="toggle_work(work)" ng-show="work.status==&#39;unset&#39;"></i><i class="icon-remove red pointer" ng-click="toggle_work(work)" ng-show="work.status==&#39;no&#39;"></i><i class="icon-exclamation darkorange pointer" ng-click="toggle_work(work)" ng-show="work.status==&#39;cautious&#39;"></i></div><div class="inline work-title editable" ng-click="edit_work(work)"><pre class="no-style">{{work.title}}</pre><div class="work-description" ng-show="work.description"><span>Comment: {{work.description}}</span></div></div></div></li><li id="editing-work" ng-show="editing_work"><div class="row-fluid editing-item" ng-show="editing_work.editing"><form name="work_form" novalidate="true"><div class="error" ng-show="work_form.work_title.$invalid">Work\'s title cannot be empty</div><textarea auto-rows="15" class="span12" name="work_title" ng-model="editing_work.editing.title" required="true" type="text"></textarea><div ng-hide="editing_work.header"><label>Comment</label><textarea auto-rows="15" class="span12" name="work_description" ng-model="editing_work.editing.description" type="text"></textarea></div><div ng-show="editing_work.header &amp;&amp; editing_work.editing.confirm_deletion"><label class="checkbox"><input ng-model="editing_work.editing.delete_children" type="checkbox" />Also Remove items within this header</label></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_work(work_form, editing_work)"><i class="icon-ok"></i><span>Save</span></button><button class="btn" ng-click="cancel_edit_work(editing_work)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="remove_work(editing_work)"><i class="icon-remove"></i><span>Remove</span></button></div></div></form></div></li></ul><div ng-hide="new_work"><button class="btn btn-link" id="add-checklist-item" ng-click="add_work()">Add Item</button><span>&nbsp;::&nbsp;</span><button class="btn btn-link" ng-click="add_work_header()">Add Header</button><span>&nbsp;::&nbsp;</span><button class="btn btn-link" ng-click="copy_invoice_items_to_job_card()">Copy invoice items</button><div class="pull-right"><div class="btn-group" id="works-more-actions" style="margin-left: 10px"><a class="btn btn-link dropdown-toggle" data-toggle="dropdown" href="#"><span>More Actions</span> <span class="caret"></span></a><ul class="dropdown-menu" style="text-align: left;"><li><button class="btn btn-link" ng-click="bulk_tick_works()">Check all</button></li><li><button class="btn btn-link" ng-click="bulk_remove_works()"><i class="icon icon-remove red"></i><span>Remove all</span></button></li><li><button class="btn btn-link" ng-click="transfer_checksheet()">Transfer to invoice</button></li></ul></div></div></div><br /><br /><div ng-show="job.checksheet_text"><div class="pull-right"><button class="btn btn-link" ng-click="remove_checksheet_text()"><i class="icon icon-remove red"></i>Remove checksheet</button></div><br /><div ng-bind-html-unsafe="job.checksheet_text"></div></div><div ng-show="new_work"><div class="row-fluid editing-item"><form name="new_work_form" novalidate="true"><div class="error" ng-show="new_work_form.work_title.$invalid">Work\'s title cannot be empty</div><textarea auto-rows="15" class="span12" id="new-work-title" name="work_title" ng-model="new_work.title" required="true" select-text="true" type="text"></textarea><div ng-hide="new_work.header"><label>Comment</label><textarea auto-rows="15" class="span12" name="work_description" ng-model="new_work.description" type="text"></textarea></div><button class="btn btn-success" ng-click="save_new_work()"><i class="icon-ok"></i>Save</button><button class="btn" ng-click="cancel_new_work()">Cancel</button></form></div></div><div ng-show="digital_signature_enabled()"><div class="sub-header">Customer Signature {{digital_signature_message()}}</div><div id="customer-sign" ng-show="job.last_signature"><div class="inline">Customer signed at {{job.last_signature.created_at|date:\'mediumTime\'}} on {{job.last_signature.created_at|date: \'fullDate\'}}</div><a ng-href="{{job.last_signature.url}}" style="margin-left: 10px" target="_blank">Signed document</a></div><a class="inline" ng-href="/jobs/{{job.id}}/sign_form" target="_blank">Sign Now</a></div></div></div><hr /><div class="row-fluid"><div class="sub-header"><div class="inline" id="job-photos">Photos/Documents</div><div class="pull-right" ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_job_files()">Upload</button></div></div><div class="job-files" ng-hide="uploading_files"><div class="pull-right"></div><div class="inline job-photo" ng-repeat="photo in job.photos" style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><div ng-show="job.documents.length &gt; 0"><div class="bold">Documents</div><div ng-repeat="document in job.documents"><div class="editable" ng-click="edit_file(document)" ng-hide="document.editing"><span>{{document.file_name}} &nbsp;</span><a ng-href="{{document.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="document.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="document.editing.file_name" type="text" /></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(document)">Save</button><button class="btn" ng-click="cancel_edit_file(document)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(document)">Remove</button></div></form></div></div></div></div><div id="photo-viewer"><div class="popover fade right in" style="width: 800px; height: 1000px"><div class="popover-title"><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="full_size_photo()">Full Size</button><button class="btn btn-primary" ng-click="close_photo_viewer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div style="height: 750px"><carousel><slide active="photo.active" ng-repeat="photo in job.photos"><img ng-src="{{photo.url}}" style="margin:auto; max-width: 100%; max-height:750px;" /></slide></carousel></div></div><div class="row-fluid"><center><div class="inline job-photo" ng-class="{&#39;job-photo-active&#39;: photo.active}" ng-repeat="photo in job.photos"><div style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><button class="btn btn-danger" ng-click="remove_photo(photo)" ng-show="photo.active">Remove</button></div></center></div></div></div></div><form action="/jobs/{{job.id}}/upload_files" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /></div><br /><div class="inline" id="upload-photos-spinner"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form></div></div><div class="content-box" ng-hide="no_access_to_timesheets()"><div class="sub-header" id="time-sheet">Timesheet<div class="pull-right"><button class="btn btn-primary" id="clock-on-button" ng-click="clock_on()" ng-hide="pending_work_hour()"><i class="icon icon-time"></i>Clock On</button><button class="btn btn-success" ng-click="clock_off()" ng-show="pending_work_hour()"><i class="icon icon-time"></i>Clock Off</button><div class="spinner" id="clocking-spinner"></div></div></div><br /><div class="work_hour-check-list" id="work-hour-list"><div class="row-fluid" ng-show="job.work_hours.length &gt; 0"><div class="column span3"><span class="bold">Date</span></div><div class="column span3"><span class="bold">Mechanic</span></div><div class="column span2"><span class="bold">Started</span></div><div class="column span2"><span class="bold">Ended</span></div><div class="column span2"><span class="bold">Total</span></div></div><div id="work-hour-{{work_hour.id}}" ng-repeat="work_hour in job.work_hours"><div ng-hide="work_hour.editing"><div ng-class="{&#39;editable&#39;: work_hour_editable(work_hour)}" ng-click="work_hour_editable(work_hour) &amp;&amp; edit_work_hour(work_hour)"><div class="row-fluid" tooltip="{{work_hour.display_description}}"><div class="column span3"><span>{{work_hour.started_at|date: \'mediumDate\'}}</span></div><div class="column span3"><span>{{work_hour.employee.name}}</span><span class="orange" ng-show="work_hour.overtime">(ot)</span></div><div class="column span2"><span>{{work_hour.started_at|date: \'H:mm\'}}</span></div><div class="column span2"><span>{{work_hour.ended_at|date: \'H:mm\'}}</span></div><div class="column span2"><span ng-show="work_hour.hour &amp;&amp; work_hour.hour &gt; 0">{{work_hour.hour}} h</span><span ng-hide="work_hour.ended_at">&nbsp;<span class="label label-info" tooltip="In Progress">In Progress</span></span><span ng-show="work_hour.no_charge">&nbsp;<span class="label label-warning" tooltip="Internal work, no charge out">I</span></span><div class="pull-right"><span ng-show="work_hour.display_description" title="{{work_hour.display_description}}">...</span></div></div></div></div></div></div><div class="row-fluid editing-item" id="editing-work-hour" ng-show="editing_work_hour.editing"><form name="work_hour_form" novalidate="true"><div class="row-fluid"><div class="column span3"><div>Date</div><ad-datepicker ng-model="editing_work_hour.editing.started_at"></ad-datepicker></div><div class="column span3"><div>Start</div><ad-timepicker ng-model="editing_work_hour.editing.started_at" on-select="update_duration(editing_work_hour.editing)"></ad-timepicker></div><div class="column span3"><div>End</div><ad-timepicker ng-model="editing_work_hour.editing.ended_at" on-select="update_duration(editing_work_hour.editing)"></ad-timepicker></div><div class="column span3"><div>Total (hour)</div><input class="input-tiny" ng-change="update_ended_at(editing_work_hour.editing)" ng-model="editing_work_hour.editing.hour" step="any" type="number" /></div></div><div class="row-fluid"><div class="column span6"><div ng-show="can_assign_employee()"><div>Mechanic</div><select class="inline" name="employee" ng-change="select_work_hour_employee(editing_work_hour.editing)" ng-model="editing_work_hour.editing.employee_id" ng-options="employee.id as employee.name for employee in employees()" required="true"><option value=""></option></select></div></div><div class="column span6" ng-show="allow_invoice_item_on_timesheet()"><label>Related Invoice Item</label><select class="inline" name="employ_item_id" ng-model="editing_work_hour.editing.invoice_item_id" ng-options="item.id as item.description for item in selectable_items()"><option value=""></option></select></div></div><div class="row-fluid"> <label class="inline">Comment/Note:</label><textarea class="span12" id="new-work_hour-description" name="work_hour_description" ng-model="editing_work_hour.editing.description"></textarea></div><div class="row-fluid"><label class="checkbox"><input ng-model="editing_work_hour.editing.overtime" type="checkbox" /><span>Overtime</span></label></div><div class="row-fluid"><label class="checkbox"><input ng-model="editing_work_hour.editing.no_charge" type="checkbox" /><span>Internal, No charge-out</span></label><br /></div><div class="row-fluid"><div class="pull-left"><button class="btn btn-success" ng-click="save_work_hour(work_hour_form)"><i class="icon-ok"></i><span>Save</span></button><button class="btn" ng-click="cancel_edit_work_hour(editing_work_hour)">Cancel</button></div><div class="pull-right"><button class="btn btn-danger" ng-click="remove_work_hour(editing_work_hour)"><i class="icon-remove"></i><span>Remove</span></button></div></div></form></div></div><div class="editing-item" ng-show="new_work_hour"><form name="new_work_hour_form" novalidate="true"><div class="row-fluid"><div class="column span3"><div>Date</div><ad-datepicker ng-model="new_work_hour.started_at" on-select="update_duration(new_work_hour)"></ad-datepicker></div><div class="column span3"><div>Start</div><ad-timepicker ng-model="new_work_hour.started_at" on-select="update_duration(new_work_hour)"></ad-timepicker></div><div class="column span3"><div>End</div><ad-timepicker ng-model="new_work_hour.ended_at" on-select="update_duration(new_work_hour)"></ad-timepicker></div><div class="column span3"><label>Total (hour)</label><input class="input-tiny" ng-change="update_ended_at(new_work_hour)" ng-model="new_work_hour.hour" step="any" type="number" /></div></div><div class="row-fluid"><div class="column span6"><div ng-show="can_assign_employee()"><label>Mechanic</label><select class="inline" name="employee" ng-change="select_work_hour_employee(new_work_hour)" ng-model="new_work_hour.employee_id" ng-options="employee.id as employee.name for employee in employees()"><option value=""></option></select></div></div><div class="column span6" ng-show="allow_invoice_item_on_timesheet()"><div><label>Related Invoice Item</label><select class="inline" name="employ_item_id" ng-model="new_work_hour.invoice_item_id" ng-options="item.id as item.description for item in selectable_items()"><option value=""></option></select></div></div></div><div class="row-fluid"> <label class="inline">Comment/Note:</label><textarea class="span12" id="new-work_hour-description" name="work_hour_description" ng-model="new_work_hour.description"></textarea></div><div class="row-fluid"><label class="checkbox"><input ng-model="new_work_hour.overtime" type="checkbox" /><span>Overtime</span></label></div><div class="row-fluid"><label class="checkbox"><input ng-model="new_work_hour.no_charge" type="checkbox" /><span>Internal, No charge-out</span></label><br /></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_new_work_hour()"><i class="icon-ok"></i>Save</button><button class="btn btn-success" ng-click="save_new_work_hour(true)"><i class="icon-plus"></i>Save And New</button><button class="btn" ng-click="cancel_new_work_hour()">Cancel</button></div></form></div><div class="row-fluid"><div class="column span10 text-align-right bold">Total:</div><div class="column span2">{{total_work_hours()}} h</div></div><hr /><div class="row-fluid"><div class="pull-left" ng-hide="new_work_hour"><button class="btn btn-link" ng-click="add_work_hour()">Add</button></div><div class="pull-right" ng-show="job.work_hours.length &gt; 0"><div class="spinner" id="transfer-work-hours-spinner"></div><div class="btn-group" style="margin-left: 10px"><a class="btn btn-link dropdown-toggle" data-toggle="dropdown" href="#"><span>Transfer to invoice</span> <span class="caret"></span></a><ul class="dropdown-menu" style="text-align: left;"><li><button class="btn btn-link" ng-click="transfer_work_hours(&#39;as_one_line_item&#39;)">Transfer as one line</button></li><li><button class="btn btn-link" ng-click="transfer_work_hours(&#39;per_employee&#39;)">Transfer per employee</button></li><li><button class="btn btn-link" ng-click="transfer_work_hours(&#39;as_one_line_per_item&#39;)">Transfer one line per item</button></li></ul></div></div></div></div></div><div class="column span6"><div class="content-nav"><ul><li ng-class="{active: right_side==&#39;invoice&#39;}" ng-click="show_right_side(&#39;invoice&#39;)"><a>Invoice</a></li><li ng-class="{active: right_side==&#39;quote&#39;}" ng-click="show_right_side(&#39;quote&#39;)"><a>Quote</a></li><li id="purchase-orders" ng-class="{active: right_side==&#39;purchases&#39;}" ng-click="show_right_side(&#39;purchases&#39;)"><a>Purchase Orders ({{job.purchases.length}})</a></li><li ng-class="{active: right_side==&#39;bills&#39;}" ng-click="show_right_side(&#39;bills&#39;)"><a>Bills ({{job.invoice.related_bills.length}})</a></li><li ng-class="{active: right_side==&#39;cogs&#39;}" ng-click="show_right_side(&#39;cogs&#39;)" ng-show="show_cogs()"><a>COGS</a></li></ul></div><div ng-show="right_side == &#39;invoice&#39;"><div ng-hide="job.invoice.id || adding_invoice"><div class="content-box" style="min-height: 400px"><center><br /><br /><br /><div class="goto" ng-click="create_invoice()" style="border: solid 1px; border-color: #AAA; width: 70%; background-color: white"><br /><div class="bold">Create Invoice</div><br /></div><center><div class="spinner" id="create-invoice-spinner"></div></center><br /><br /></center></div></div><div ng-show="adding_invoice"><div class="content-box" style="min-height: 400px"></div><div class="bold">Invoice</div><div invoicepicker="true" ng-model="adding_invoice"></div><div class="button-panel"><button class="btn btn-success" ng-click="add_invoice()">Add</button><button class="btn" ng-click="cancel_add_invoice()">Cancel</button></div></div><div ng-show="job.invoice.id"><div class="content-box job-invoice"><div class="row-fluid"><div class="column span3"><div class="spinner" id="invoice-spinner"></div><div class="sub-header">Invoice</div></div><div class="column span9"><div class="pull-right" ng-show="job.invoice.id"><div ad-tag-labels="true" class="inline" owner="job.invoice"></div><div ad-tags="true" class="inline" owner="job.invoice" resource="Invoice"></div><button class="btn btn-link" id="invoice-tags" ng-click="i_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#invoice-tags&#39;" owner="job.invoice" placement="left" resource="Invoice" showing="i_tags"></div></div></div></div><div class="row-fluid"><div class="column span6"><div ng-show="job.invoice.customer"><span class="label-name-left auto-width">Bill To:</span><span>{{job.invoice.customer.name}}</span><div ng-show="job.invoice.customer.phone || job.invoice.customer.mobile"><span class="label-name-left auto-width">Tel:</span><span ng-show="job.invoice.customer.phone">{{job.invoice.customer.phone}}</span><span ng-hide="job.invoice.customer.phone">{{job.invoice.customer.mobile}}</span></div><div><a href="javascript:void(0)" id="change-invoice-customer-button" ng-click="change_customer()">Change</a></div></div></div><div class="column span6"><div class="pull-right"><div ad-invoice-details="true" ng-model="job.invoice"></div><div><a ng-href="#/invoices/{{job.invoice.id}}">Details</a></div></div></div></div><div ad-invoice="true" job="job" ng-model="job.invoice" on-oscar-success="oscar_invoice_success(account)" on-repco-success="repco_invoice_success()"></div></div><div class="content-box"><div ad-invoice-payments="true" ng-model="job.invoice"></div></div><div ad-change-customer="true" anchor-element="#change-invoice-customer-button" invoice="job.invoice" showing="changing_invoice_customer"></div></div></div><div ng-switch="right_side"><div ng-switch-when="quote"><div class="content-box" id="quote-page"><div class="spinner" id="quote-page-spinner"></div><div class="job-quote"><div class="row-fluid"><div class="pull-left"><div class="sub-header" id="quote-header">Quote #{{$parent.job.quote.number}}</div></div><div class="pull-right" style="text-align: right"><div ng-hide="$parent.job.quote"><button class="btn btn-link" ng-click="$parent.create_quote()">Create Quote</button><span>&nbsp;::&nbsp;</span><button class="btn btn-link" id="add-existing-quote-button" ng-click="$parent.add_existing_quote()">Add Existing Quote</button><div class="spinner" id="create-quote-spinner"></div></div><div ng-show="$parent.job.quote"><div class="inline"><span class="label label-info" ng-class="{&#39;label-success&#39;: $parent.job.quote.last_email.status == &#39;delivered&#39;}">{{$parent.job.quote.last_email.status}}</span></div><div class="btn-group" id="quote-actions"><a class="btn btn-link dropdown-toggle" data-toggle="dropdown" href="#"><span>Actions</span><span class="caret"></span></a><ul class="dropdown-menu pull-right" style="text-align: left;"><li><a ng-href="/quotes/{{$parent.job.quote.id}}/print.pdf" target="_blank"><i class="icon icon-print"></i><span>Print</span></a></li><li><a href="javascript:void(0)" id="email-quote-button" ng-click="$parent.send_quote()"><i class="icon icon-envelope"></i><span>Email Quote</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.transfer_quote_to_invoice()"><i class="icon icon-arrow-right"></i><span>Transfer to invoice</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.copy_from_invoice()"><i class="icon icon-arrow-left"></i><span>Copy from invoice</span></a></li><li><a ng-href="#/quotes/{{$parent.job.quote.id}}"><i class="icon icon-external-link"></i><span>Full Details</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.delete_quote()"><i class="icon icon-remove red"></i><span>Remove</span></a></li></ul></div></div></div></div><div ng-show="$parent.job.quote"><div ad-quote="true" ng-model="$parent.job.quote"></div><div ad-email-quote="true" anchor-element="#quote-header" job="$parent.job" ng-model="$parent.job.quote" placement="bottom" showing="$parent.sending_quote"></div></div></div><div id="add-existing-quote-popover"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="pull-right"><i class="icon icon-remove goto" ng-click="$parent.close_add_existing_quote()"></i></div><div class="sub-header">Add Existing Quote</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><label>Quote: &nbsp;</label><div ad-quotepicker="true" class="inline" ng-model="$parent.added_quote.id" quote="$parent.added_quote"></div></div></div><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="$parent.do_add_existing_quote()">Add</button><button class="btn btn-primary" ng-click="$parent.close_add_existing_quote()">Cancel</button><div class="spinner" id="adding-quote-spinner"></div></div></div></div></div></div></div><div modal="$parent.showing_delete_quote_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this quote</h3></div><div class="modal-body"><div>Are you sure you want to delete this quote</div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="$parent.do_delete_quote()">Yes, Delete It</button><button class="btn" ng-click="$parent.cancel_delete_quote()">Cancel</button></div></div></div><div ng-switch-when="purchases"><div id="purchase-list"></div><div class="content-box"><div class="row-fluid"><div class="pull-left"><div class="sub-header">Purchase Orders</div></div><div class="pull-right"><button class="btn btn-link" id="new-purchase-order-button" ng-click="$parent.add_purchase_order()">New Purchase Order</button></div></div><table class="table table-striped table-bordered"><tbody><tr ng-repeat="purchase in $parent.job.purchases"><td id="purchase-{{purchase.id}}"><div class="row-fluid"><div class="pull-left"><div class="inline" style="width: 100px">#{{purchase.number}}</div><div class="inline"><span class="bold">Supplier:&nbsp;</span><span>{{purchase.supplier.name}}</span></div></div><div class="pull-left"><div class="inline" style="margin-left: 20px"><span class="bold">Date:&nbsp;</span><span>{{purchase.date|date}}</span></div><div class="inline" style="margin-left: 20px"><span class="bold">Due Date:&nbsp;</span><span>{{purchase.due_date|date}}</span></div></div><div class="pull-right" style="text-align: right"><div class="btn-group" style="margin-left: 10px"><a class="btn btn-link dropdown-toggle" data-toggle="dropdown" href="#"><span>Actions</span><span class="caret"></span></a><ul class="dropdown-menu" style="text-align: left;"><li ng-show="$parent.repco_account() &amp;&amp; $parent.repco_supplier(purchase)"><button class="btn btn-link" ng-click="$parent.order_repco(purchase, $parent.repco_account())"><img src="/assets/repco_navigator-8e21ef0b294533a128d4feada69c8241.png" style="height: 20px;" /></button></li><li ng-show="$parent.quantum_account() &amp;&amp; $parent.quantum_supplier(purchase)"><button class="btn btn-link" ng-click="$parent.order_repco(purchase, $parent.quantum_account())"><img src="/assets/quantum_pro-5e21beca4f69abf19b557f26df4871f2.png" style="height: 20px;" /></button></li><li ng-show="$parent.pro_link_account() &amp;&amp; $parent.pro_link_supplier(purchase)"><button class="btn btn-link" ng-click="$parent.order_repco(purchase, $parent.pro_link_account())"><img src="/assets/pro_link-ed0e9bca251211f98062a43051fa0baf.png" style="height: 20px;" /></button></li><li ng-show="$parent.motospecs_account() &amp;&amp; $parent.motospecs_supplier(purchase)"><button class="btn btn-link" ng-click="$parent.order_repco(purchase, $parent.motospecs_account())"><img src="/assets/motospecs-a9a4edc7104b920de0eeb485620ff60b.jpg" style="height: 30px;" /></button></li><li><a ng-href="/purchases/{{purchase.id}}/print_order.pdf" target="_blank"><i class="icon icon-print"></i><span>Print Order</span></a></li><li><a href="javascript:void(0)" id="email-purchase-order" ng-click="$parent.send_purchase_order(purchase)"><i class="icon icon-envelope"></i><span>Email Order</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.edit_purchase(purchase)"><i class="icon icon-pencil"></i><span>Edit/Details</span></a></li><li ng-hide="purchase.processed || $parent.restricted_to_process_purchase_orders()"><a href="javascript:void(0)" ng-click="$parent.process_purchase_order(purchase)"><i class="icon icon-retweet"></i><span>Process</span></a></li><li ng-hide="$parent.restricted_to_enter_bills()"><a href="javascript:void(0)" ng-click="$parent.add_purchase_bill(purchase)" ng-hide="purchase.billed"><i class="icon icon-dollar"></i><span>Add Bill</span></a><a ng-href="#/bills/{{purchase.bill_id}}" ng-show="purchase.bill_id"><i class="icon icon-dollar"></i><span>Bill Details</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.remove_purchase_order(purchase)"><i class="icon icon-remove red"></i><span>Remove</span></a></li></ul></div><span ng-show="purchase.processed"><span class="badge badge-info">Processed</span><span>&nbsp;</span></span><span class="badge" ng-class="{&#39;badge-info&#39;: purchase.status == &#39;sent&#39;, &#39;badge-success&#39;: purchase.status == &#39;billed&#39; || purchase.status == &#39;paid&#39;}" ng-hide="purchase.status == &#39;processed&#39;">{{purchase.status}}</span></div></div><div class="row-fluid" ng-show="purchase.tags.length &gt; 0"><label class="label" ng-repeat="tag in purchase.tags" style="height: 25px; background-color: {{tag.color_code}}; margin-left: 2px; margin-right: 2px">{{tag.name}}</label></div><hr /><div class="row-fluid" ng-repeat="item in purchase.purchase_items" ng-show="item.job &amp;&amp; item.job.id == $parent.job.id"><div class="column span6">{{item.description}}</div><div class="column span6" style="font-size: 80%"><div class="pull-right"><div ng-show="item.unit_price &gt; 0"><div class="inline bold">Buy:</div> <div class="inline">{{item.unit_price|currency}} x {{item.quantity}}</div><div class="inline" style="width: 120px; text-align: right"><span>&#61 {{item.unit_price * item.quantity|currency}}</span> <span ng-show="item.included_gst">(incl. gst)</span></div></div><div ng-hide="item.unit_price &gt; 0"><div class="inline bold">Quantity: {{item.quantity}}</div> </div><div ng-show="item.sell_price &amp;&amp; item.sell_price &gt; 0"><div class="inline bold">Sell:</div> <div class="inline">{{item.sell_price|currency}} x {{item.quantity}}</div><div class="inline" style="width: 120px; text-align: right"><span>&#61 {{item.sell_price * item.quantity |currency}}</span> <span ng-show="item.included_gst">(incl. gst)</span></div></div></div></div></div><div class="row-fluid" ng-show="purchase.details"><pre class="no-style">{{purchase.details}}</pre></div></td></tr></tbody></table><div id="new-purchase-order-popover"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="sub-header">Purchase Order</div></div><div class="popover-content"><div class="content-box"><div ad-purchase-order-form="true" invoice="$parent.job.invoice" job="$parent.job" ng-model="$parent.new_purchase_order" on-cancel="$parent.cancel_add_purchase_order()" on-save="$parent.insert_new_purchase_order($parent.new_purchase)"></div></div></div></div></div><div id="purchase-order-popover"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="pull-right"><i class="icon icon-remove goto" ng-click="$parent.close_edit_purchase()"></i></div><div class="sub-header">Purchase Order</div></div><div class="popover-content"><div class="row-fluid"><div class="pull-right"><div ad-tag-labels="true" class="inline" owner="$parent.editing_purchase"></div><button class="btn btn-link" id="purchase-tags" ng-click="$parent.p_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#purchase-tags&#39;" owner="$parent.editing_purchase" placement="left" resource="Purchase" showing="$parent.p_tags"></div></div></div><div class="content-box"><div ad-purchase="true" job="$parent.job" ng-model="$parent.editing_purchase" template="simple"></div></div><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="$parent.close_edit_purchase()">Close</button><button class="btn btn-primary" ng-click="$parent.close_edit_and_send_purchase()">Close And Send</button></div></div></div></div></div></div><div ad-email-purchase-order="true" anchor-element="#purchase-list" ng-model="$parent.sending_purchase" placement="bottom" showing="$parent.sending_purchase"></div><div ad-purchase-order-bill-form="true" anchor-element="#purchase-list" ng-model="$parent.billed_purchase" on-save="$parent.refresh_invoice()" placement="bottom" showing="$parent.billed_purchase"></div><div modal="$parent.deleting_purchase" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this purchase</h3></div><div class="modal-body"><div>Are you sure you want to delete this Purchase ?</div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="$parent.do_delete_purchase()">Yes, Delete It</button><button class="btn" ng-click="$parent.cancel_delete_purchase()">Cancel</button></div></div><div ad-process-purchase-order="true" anchor-element="#purchase-list" ng-model="$parent.processing_purchase" on-processed="$parent.refresh_invoice()" placement="bottom" showing="$parent.processing_purchase"></div></div><div ng-switch-when="bills"><div class="content-box"><div class="sub-header">Bills</div><table class="table table-striped table-bordered"><tbody><tr ng-repeat="bill in $parent.job.invoice.related_bills"><td id="bill-{{bill.id}}"><a class="goto" ng-href="#/bills/{{bill.id}}"><div><div class="inline" style="width: 120px">Bill No: #{{bill.number}}</div></div><div><div class="inline" style="width: 120px">Ref: #{{bill.reference}}</div><div class="inline"><span class="bold">Supplier:&nbsp;</span><span>{{bill.supplier.name}}</span></div></div><div class="pull-right"><span>{{bill.total_amount|currency}} &nbsp;</span><span class="badge badge-success" ng-show="bill.finalized">Finalized</span></div></a></td></tr></tbody></table></div></div><div ng-switch-when="cogs"><div class="content-box"><div ad-invoice-cogs="true" ng-model="$parent.job.invoice"></div></div></div></div></div></div></div><div id="repco-response"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header">Please Confirm...</div></div><div class="popover-content"><div class="content-box"><div ng-show="waiting_repco_response"><div class="spinner inline" id="waiting-repco-response"></div><span>Please waiting while we receive data</span></div><div ng-hide="waiting_repco_response"><div class="bold">Do you want to create purchase order for the parts now?</div><br /><br /><button class="btn btn-primary" ng-click="create_purchase_order(active_repco_account())">Yes</button><button class="btn" ng-click="cancel_create_purchase_order()">No</button></div></div></div></div></div><div id="oscar-response"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header">Please Confirm...</div></div><div class="popover-content"><div class="content-box"><div ng-show="waiting_oscar_response"><div class="spinner inline" id="waiting-oscar-response"></div><span>Please waiting while we receive data</span></div><div ng-hide="waiting_oscar_response"><div class="bold">Do you want to create purchase order for the parts now?</div><br /><br /><button class="btn btn-primary" ng-click="create_purchase_order(active_oscar_account())">Yes</button><button class="btn" ng-click="cancel_create_purchase_order()">No</button></div></div></div></div></div><div ad-stock-info="true"></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/simple.html",'<div ng-controller="ShowJobController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div ng-hide="job &amp;&amp; job.id"><div class="spinner" id="job-loading"></div></div><div ng-show="job &amp;&amp; job.id"><img class="done-sign" ng-show="job &amp;&amp; job.status == &#39;finished&#39;" ng-src="/assets/completed-db7f0f84520f48344132128dbeb76d73.gif" /><img class="paid-sign" ng-show="job.invoice.paid" ng-src="/assets/paid-d5240fc8cfeec7b14de62c19cf6d9848.gif" /><div class="deleted-sign" ng-show="job.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><div class="row-fluid"><div class="pull-left"><div class="page-header"><div class="inline">{{job.title}}</div></div></div><div class="pull-right"><div ad-tag-labels="true" class="inline" owner="job"></div><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="job" placement="left" resource="Job" showing="x_tags"></div></div></div><center><div class="row-fluid well" ng-show="job.on_hold" style="width: 90%; text-align: center;"><label class="label label-warning">ON HOLD</label><span class="bold">&nbsp; {{job.on_hold_reason}}</span></div></center><div class="row-fluid"><div class="pull-right"><div class="inline"><a class="btn" ng-href="/jobs/{{job.id}}/print.pdf" target="_blank"><i class="icon-print"></i><span>Print Job Card</span></a><a class="btn" href="javascript:void(0);" id="email-job-card" ng-click="email_job_card()"><i class="icon icon-envelope"></i><span>Email Job Card</span></a><div class="dropdown inline" id="communication-actions"><a class="btn" dropdown-toggle="true"><i class="icon icon-share-alt"></i><span>Send...</span></a><ul class="dropdown-menu top-dropdown"><li><a href="javascript:void(0);" id="send-sms-button" ng-click="send_sms()"><i class="icon icon-mobile-phone"></i><span>Send SMS</span></a></li><li><a href="javascript:void(0);" id="send-email-button" ng-click="send_email()"><i class="icon icon-envelope"></i><span>Send Email</span></a></li></ul></div><button class="btn btn-warning" id="put-on-hold" ng-click="put_on_hold()" ng-hide="job.deleted || job.finished || job.on_hold"><i class="icon icon-stop"></i>Put On Hold</button><button class="btn btn-success" id="continue" ng-click="continue()" ng-hide="!job.on_hold"><i class="icon icon-play"></i>Continue</button><button class="btn btn-primary" id="finish" ng-click="finish()" ng-hide="job.deleted || job.finished"><i class="icon-ok"></i>Finish</button><button class="btn" id="unfinish" ng-click="unfinish()" ng-show="job.finished">Unfinish</button><div id="job-send-email"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Email Job Card</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form><div class="pull-right"><div class="inline" id="job-send-email-spinner"></div></div><label>Email</label><input class="span9" id="job-send-email-address" ng-model="email" type="text" /><div class="pull-right"><div class="inline" contactpicker="true" model-type="customer" ng-model="job.customer" on-select="email_select_contact(contacts)" show-email="true"></div></div><label>Subject</label><input class="span12" id="job-send-email-subject" ng-model="subject" type="text" /><label><span>Message</span><span ad-saved-texts-button="true" job="job" ng-model="message"></span></label> <textarea class="span12" id="job-send-email-message" ng-model="message" rows="5" type="text"></textarea><div><label class="checkbox"><input ng-model="delivery_notification_required" type="checkbox" /><span>Send me a notification on delivery</span></label></div><div><label class="checkbox"><input ng-model="attached_files" type="checkbox" /><span>Attach Files</span></label></div><div ng-show="attached_files"><table class="table table-striped"><tbody><tr ng-repeat="file in job.photos"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in job.documents"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr></tbody></table></div><div><button class="btn btn-success" ng-click="send_job_card()">Send</button><button class="btn" ng-click="cancel_email_job_card()">Cancel</button></div></form></div></div></div></div></div><div ad-put-on-hold="true" anchor-element="put_on_hold_anchor" ng-model="job" placement="bottom" showing="putting_on_hold"></div><div ad-finish-job="true" anchor-element="#finish" ng-model="job" on-paying="pay()" showing="finishing" vehicle="vehicle"></div><div ad-pay-invoice="true" anchor-element="#pay" ng-model="job.invoice" showing="paying"></div><div ad-send-email="true" anchor-element="&#39;#communication-actions&#39;" customer="job.customer" job="job" placement="left" showing="show_send_email" vehicle="job.vehicle"></div><div ad-send-sms="true" anchor-element="&#39;#communication-actions&#39;" customer="job.customer" job="job" placement="left" showing="show_send_sms" vehicle="job.vehicle"></div><div modal="showing_delete_job_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this job</h3></div><div class="modal-body"><div>Are you sure you want to delete this Job?</div><div ng-show="job.booking"><label class="checkbox"><input ng-model="delete_booking" type="checkbox" />Also delete the job\'s booking</label></div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><div class="spinner" id="delete-job-spinner"></div><button class="btn btn-danger" ng-click="do_delete_job()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_job()">Cancel</button></div></div><div id="in-progress-work-hours"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">You are current clocked on to another job</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div>You are current clocked on the the following jobs</div><br /><br /><div class="spinner" id="in-progress-clocking-spinner"></div><table class="table table-striped"><tr ng-repeat="work_hour in in_progress_work_hours"><td>{{work_hour.job.title}}</td><td><button class="btn btn-link" ng-click="clock_off_in_progress(work_hour)" ng-hide="require_timesheet_description(work_hour)">Clock Off</button></td><td><div class="pull-right"><a class="btn btn-link" ng-href="#/jobs/{{work_hour.job.id}}" target="_blank">Open</a></div></td></tr></table></div><button class="btn" ng-click="close_in_progress_work_hours()">Close</button></div></div></div></div></div><div class="inline"><button class="btn btn-primary" id="pay" ng-click="pay()" ng-hide="job.deleted || job.invoice.paid || !job.invoice || restricted_to_enter_payment()"><i class="icon-dollar"></i>Pay</button></div><div class="inline" ng-show="!job.deleted &amp;&amp; job.invoice.id"><div ad-invoice-actions="true" email="job.invoice.customer.email" job="job" ng-model="job.invoice"></div></div><button class="btn btn-delete btn-danger" ng-click="delete_job()" ng-hide="job.deleted || restricted_to(&#39;deletion&#39;)">Delete</button></div></div><br /><div class="row-fluid"><div class="column span6"><div class="content-box"><div class="row-fluid"><div class="pull-left"><div class="sub-header">Job Card</div></div></div><div class="row-fluid"><div class="pull-left"><div class="job-details" ng-click="edit_job_types()" ng-hide="job.editing_job_types"><div class="editable"><div class="info"><span class="label-name-left auto-width">Job Type:</span><span class="inline" style="max-width: 200px">{{job.job_types_title|na}}</span></div></div></div><div class="editing-item" ng-show="job.editing_job_types"><form class="form-horizontal" name="job_types_form" novalidate="true"><div class="control-group"><label class="control-label" style="width: 80px">Job Types</label><div class="controls" style="margin-left: 100px; min-width: 320px"><div ad-job-type-selection="true" ng-model="job.editing_job_types.job_type_ids"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_job_types()">Save</button><button class="btn" ng-click="cancel(job, &#39;editing_job_types&#39;)">Cancel</button><div class="spinner" id="job-update-job-types-spinner"></div></div></div></form></div><div class="job-details" ng-click="edit_job_details()" ng-hide="job.editing_job_details"><div class="editable"><div class="info" ng-show="job.order_number"><span class="label-name-left auto-width">Order Number:</span>{{job.order_number}}</div><div class="info" ng-show="job.quote"><span class="label-name-left auto-width">Quote Number:</span>{{job.quote.number}}</div><div class="info" ng-show="job.created_by"><span class="label-name-left auto-width">Booked In By:</span>{{job.created_by }}</div><div class="info" ng-show="job.time"><span class="label-name-left auto-width">Time:</span>{{job.time | date: \'short\'}}</div><div class="info" ng-show="job.total_hours"><span class="label-name-left auto-width">Estimate:</span>{{job.total_hours}} hours</div><div class="info" ng-show="job.pickup_time"><span class="label-name-left auto-width">Pickup time:</span>{{job.pickup_time | date: \'short\'}}</div><div class="info" ng-show="job.key_tag.length &gt; 0"><span class="label-name-left auto-width">Key Tag:</span><span class="inline" style="max-width: 200px">{{job.key_tag}}</span></div><div class="info"><span class="label-name-left auto-width">Odometer:</span><span ng-show="job.odometer">{{job.odometer|number}} {{job.vehicle.odometer_unit}}</span><span ng-hide="job.odometer">(Not Available)</span></div><div class="info" ng-show="asset_property_set().machine_hours"><span class="label-name-left auto-width">Machine Hours:</span><span ng-show="job.machine_hours">{{job.machine_hours|number}} hr(s)</span><span ng-hide="job.machine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().engine_hours"><span class="label-name-left auto-width">Engine Hours:</span><span ng-show="job.engine_hours">{{job.engine_hours|number}} hr(s)</span><span ng-hide="job.engine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().port_engine_hours"><span class="label-name-left auto-width">Port Engine Hours:</span><span ng-show="job.port_engine_hours">{{job.port_engine_hours|number}} hr(s)</span><span ng-hide="job.port_engine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().starboard_engine_hours"><span class="label-name-left auto-width">Starboard Engine Hours:</span><span ng-show="job.starboard_engine_hours">{{job.starboard_engine_hours|number}} hr(s)</span><span ng-hide="job.starboard_engine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().sleeper_air_engine_hours"><span class="label-name-left auto-width">Sleeper Air Engine Hours:</span><span ng-show="job.sleeper_air_engine_hours">{{job.sleeper_air_engine_hours|number}} hr(s)</span><span ng-hide="job.sleeper_air_engine_hours">(Not Available)</span></div><div class="info" ng-show="show_hubodometer()"><span class="label-name-left auto-width">Hubodometer:</span><span ng-show="job.hubodometer">{{job.hubodometer|number}} {{job.vehicle.odometer_unit}}</span><span ng-hide="job.hubodometer">(Not Available)</span></div><div ng-show="job.finished_time"><div class="info"><span class="label-name-left auto-width">Finished:</span>{{job.finished_time | date: \'mediumDate\'}}</div></div><div class="info" ng-show="job.employee"><span class="label-name-left auto-width">Finished By:</span>{{job.employee.name}}</div></div></div><div class="editing-item" ng-show="job.editing_job_details"><form class="form-horizontal" name="job_details_form" novalidate="true"><div class="control-group"><label class="control-label">Description</label><div class="controls"><input class="input" ng-model="job.editing_job_details.description" type="text" /></div></div><div class="control-group"><label class="control-label">Order Number</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.order_number" type="text" /></div></div><div class="control-group"><label class="control-label">Job Number</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.number" type="text" /></div></div><div class="control-group"><label class="control-label">Start Time</label><div class="controls"><ad-datepicker error="top" ng-model="job.editing_job_details.time"></ad-datepicker><ad-timepicker error="top" ng-model="job.editing_job_details.time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimate</label><div class="controls"><div class="input-append"><input class="input-small" ng-model="job.editing_job_details.total_hours" step="any" type="number" /><span class="add-on">hours</span></div></div></div><div class="control-group"><label class="control-label">Pickup time</label><div class="controls"><ad-datepicker error="top" ng-model="job.editing_job_details.pickup_time"></ad-datepicker><ad-timepicker error="top" ng-model="job.editing_job_details.pickup_time"></ad-timepicker></div></div><div class="control-group" ng-show="asset_property_set().key_tag"><label class="control-label">Key Tag</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.key_tag" type="text" /></div></div><div class="control-group"><label class="control-label">Odometer:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.odometer" type="text" /></div></div><div class="control-group" ng-show="show_hubodometer()"><label class="control-label">Hubodometer:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.hubodometer" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().machine_hours"><label class="control-label">Machine Hours:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.machine_hours" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_hours"><label class="control-label">Engine Hours:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.engine_hours" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().sleeper_air_engine_hours"><label class="control-label">Sleeper Air Enghine Hours:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.sleeper_air_engine_hours" type="text" /></div></div><div class="control-group"><label class="control-label">Finished Time:</label><div class="controls"><ad-datepicker error="top" ng-model="job.editing_job_details.finished_time"></ad-datepicker><ad-timepicker error="top" ng-model="job.editing_job_details.finished_time"></ad-timepicker></div></div><div class="control-group" ng-show="courtesy_vehicles().length == 0"><label class="control-label">Courtesy {{asset_name()}}:</label><div class="controls"><input ng-model="job.editing_job_details.replacement_provided" type="checkbox" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_job_details()">Save</button><button class="btn" ng-click="cancel(job, &#39;editing_job_details&#39;)">Cancel</button><div class="spinner" id="job-update-details-spinner"></div></div></div></form></div><br /><div class="editable" ng-click="edit_job_mechanics()" ng-hide="job.editing_mechanics"><div><div class="info"><span class="label-name-left auto-width">Mechanics:</span><span>{{employee_names()|na}}</span></div></div></div><div class="editing-item" ng-show="job.editing_mechanics"><form><div><label class="label-name-left">Mechanic 1:</label><select ng-model="mechanic_1_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(1)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 2:</label><select ng-model="mechanic_2_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(2)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 3:</label><select ng-model="mechanic_3_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(3)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 4:</label><select ng-model="mechanic_4_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(4)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left"></label><div><button class="btn btn-success" ng-click="save_job_mechanics()">Save</button><button class="btn" ng-click="cancel(job, &#39;editing_mechanics&#39;)">Cancel</button></div></div></form></div><br /></div><div class="pull-right"><div class="vehicle-owner-details goto" id="vehicle-owner" ng-click="show_customer()"><div class="info"><span class="label-name-left auto-width">Customer:</span>{{customer.name | na}}</div><div class="info" ng-show="customer.contact_name"><span class="label-name-left auto-width">Contact Person:</span>{{customer.contact_name}}</div><div class="info"><span class="label-name-left auto-width">Email:</span>{{customer.email | na}}</div><div class="info"><span class="label-name-left auto-width">Mobile:</span>{{customer.mobile | na}}</div><div class="info" ng-show="customer.phone"><span class="label-name-left auto-width">Phone:</span>{{customer.phone}}</div></div><div ng-switch="pop_customer"><div ng-switch-when="true"><div id="customer"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{$parent.customer.name}}<div class="pull-right"><button class="btn btn-danger" ng-click="$parent.change_job_customer()"><i class="icon-refresh"></i>Change Customer</button><a class="btn" ng-href="#/customers/{{$parent.customer.id}}"><i class="icon-external-link"></i><span>Full Details</span></a><button class="btn" ng-click="$parent.close_customer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><br /><ad-customer ng-model="$parent.customer" on-save="$parent.customer_updated()" on-select-vehicle="$parent.goto_vehicle(vehicle)"></ad-customer></div></div></div></div><div ad-change-customer="true" anchor-element="#vehicle-owner" customer="$parent.customer" job="$parent.job" on-transfer-vehicle="$parent.fetch_vehicle()" showing="$parent.changing_job_customer" vehicle="$parent.job.vehicle"></div></div></div><br /><div class="vehicle-details goto" id="vehicle-details" ng-click="show_vehicle()" ng-show="vehicle"><div class="info" ng-show="vehicle.service_note.length &gt; 0"><span class="label label-info">Next Service Note/TODO</span></div><div class="info"><span class="label-name-left auto-width">Make:</span>{{vehicle.make}} {{vehicle.model}} {{vehicle.year}}</div><div class="info"><span class="label-name-left auto-width">Reg. No#:</span>{{vehicle.registration_number | na: \'short\'}}</div><div class="info" ng-show="vehicle.registration_due_date"><span class="label-name-left auto-width">Reg. Due Date:</span>{{vehicle.registration_due_date | date: \'mediumDate\'}}</div><div class="info" ng-show="vehicle.engine_number"><span class="label-name-left auto-width">Engine No#:</span>{{vehicle.engine_number | na: \'short\'}}</div><div class="info" ng-show="vehicle.vin"><span class="label-name-left auto-width">VIN:</span>{{vehicle.vin}}</div><div class="info" ng-show="vehicle.fleet_number"><span class="label-name-left auto-width">Fleet No#:</span>{{vehicle.fleet_number | na: \'short\'}}</div><div class="info" ng-show="vehicle.fleet_number"><span class="label-name-left auto-width">Driver Name:</span>{{vehicle.driver_name}}</div><div class="info" ng-show="vehicle.driver_phone"><span class="label-name-left auto-width">Driver Phone:</span>{{vehicle.driver_phone}}</div><div class="info" ng-show="vehicle.driver_email"><span class="label-name-left auto-width">Driver Email:</span>{{vehicle.driver_email}}</div><div class="info" ng-show="vehicle.location"><span class="label-name-left auto-width">Location:</span>{{vehicle.location}}</div></div><div ng-switch="pop_vehicle"><div ng-switch-when="true"><div id="vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{$parent.vehicle.title}}<div class="pull-right"><button class="btn btn-danger" ng-click="$parent.change_vehicle()"><i class="icon-refresh"></i>Change To Different {{$parent.asset_name()}}</button><button class="btn" ng-click="$parent.close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-vehicle="true" ng-hide="$parent.new_vehicle" ng-model="$parent.vehicle" on-save="$parent.close_vehicle()"></div></div></div></div></div><div id="change-vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">{{$parent.vehicle.title}}<div class="pull-right"><button class="btn" ng-click="$parent.show_vehicle()">Show Current {{$parent.asset_name()}}</button><button class="btn" ng-click="$parent.close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-change-vehicle="true" model-type="job" ng-model="$parent.job" on-cancel="$parent.show_vehicle()" on-save="$parent.vehicle_changed()" showing="$parent.changing_vehicle" vehicle="$parent.job.vehicle"></div></div></div></div></div></div></div></div></div><div class="row-fluid"><br /><div class="sub-header">Notes</div><ad-notes enable-workshop-only="true" model-type="job" ng-model="job"></ad-notes></div><hr /><div class="row-fluid"><div class="spinner" id="work-spinner"></div><div class="row-fluid"><div class="pull-left"><div class="sub-header">Check Sheet</div></div><div class="pull-right"><span class="goto" ng-click="close_checksheet = true" ng-hide="close_checksheet">Close</span><span class="goto" ng-click="close_checksheet = false" ng-hide="!close_checksheet">Open</span></div></div><div class="row-fluid" ng-hide="close_checksheet"><ul class="work-check-list" id="work-check-list" ng-model="job.works" ui-sortable="work_sortable_options"><li id="work-{{work.id}}" ng-hide="work.editing" ng-repeat="work in job.works"><div class="editable" ng-click="edit_work(work)" ng-show="work.header"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline bold">{{work.title}}</div></div><div ng-hide="work.header"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline work-check"><span>&nbsp;&nbsp;</span><i class="icon-check green pointer" ng-click="toggle_work(work)" ng-show="work.status == &#39;yes&#39;"></i><i class="icon-unchecked pointer" ng-click="toggle_work(work)" ng-show="work.status==&#39;unset&#39;"></i><i class="icon-remove red pointer" ng-click="toggle_work(work)" ng-show="work.status==&#39;no&#39;"></i><i class="icon-exclamation darkorange pointer" ng-click="toggle_work(work)" ng-show="work.status==&#39;cautious&#39;"></i></div><div class="inline work-title editable" ng-click="edit_work(work)"><pre class="no-style">{{work.title}}</pre><div class="work-description" ng-show="work.description"><span>Comment: {{work.description}}</span></div></div></div></li><li id="editing-work" ng-show="editing_work"><div class="row-fluid editing-item" ng-show="editing_work.editing"><form name="work_form" novalidate="true"><div class="error" ng-show="work_form.work_title.$invalid">Work\'s title cannot be empty</div><textarea auto-rows="15" class="span12" name="work_title" ng-model="editing_work.editing.title" required="true" type="text"></textarea><div ng-hide="editing_work.header"><label>Comment</label><textarea auto-rows="15" class="span12" name="work_description" ng-model="editing_work.editing.description" type="text"></textarea></div><div ng-show="editing_work.header &amp;&amp; editing_work.editing.confirm_deletion"><label class="checkbox"><input ng-model="editing_work.editing.delete_children" type="checkbox" />Also Remove items within this header</label></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_work(work_form, editing_work)"><i class="icon-ok"></i><span>Save</span></button><button class="btn" ng-click="cancel_edit_work(editing_work)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="remove_work(editing_work)"><i class="icon-remove"></i><span>Remove</span></button></div></div></form></div></li></ul><div ng-hide="new_work"><button class="btn btn-link" id="add-checklist-item" ng-click="add_work()">Add Item</button><span>&nbsp;::&nbsp;</span><button class="btn btn-link" ng-click="add_work_header()">Add Header</button><span>&nbsp;::&nbsp;</span><button class="btn btn-link" ng-click="copy_invoice_items_to_job_card()">Copy invoice items</button><div class="pull-right"><div class="btn-group" id="works-more-actions" style="margin-left: 10px"><a class="btn btn-link dropdown-toggle" data-toggle="dropdown" href="#"><span>More Actions</span> <span class="caret"></span></a><ul class="dropdown-menu" style="text-align: left;"><li><button class="btn btn-link" ng-click="bulk_tick_works()">Check all</button></li><li><button class="btn btn-link" ng-click="bulk_remove_works()"><i class="icon icon-remove red"></i><span>Remove all</span></button></li><li><button class="btn btn-link" ng-click="transfer_checksheet()">Transfer to invoice</button></li></ul></div></div></div><br /><br /><div ng-show="job.checksheet_text"><div class="pull-right"><button class="btn btn-link" ng-click="remove_checksheet_text()"><i class="icon icon-remove red"></i>Remove checksheet</button></div><br /><div ng-bind-html-unsafe="job.checksheet_text"></div></div><div ng-show="new_work"><div class="row-fluid editing-item"><form name="new_work_form" novalidate="true"><div class="error" ng-show="new_work_form.work_title.$invalid">Work\'s title cannot be empty</div><textarea auto-rows="15" class="span12" id="new-work-title" name="work_title" ng-model="new_work.title" required="true" select-text="true" type="text"></textarea><div ng-hide="new_work.header"><label>Comment</label><textarea auto-rows="15" class="span12" name="work_description" ng-model="new_work.description" type="text"></textarea></div><button class="btn btn-success" ng-click="save_new_work()"><i class="icon-ok"></i>Save</button><button class="btn" ng-click="cancel_new_work()">Cancel</button></form></div></div><div ng-show="digital_signature_enabled()"><div class="sub-header">Customer Signature {{digital_signature_message()}}</div><div id="customer-sign" ng-show="job.last_signature"><div class="inline">Customer signed at {{job.last_signature.created_at|date:\'mediumTime\'}} on {{job.last_signature.created_at|date: \'fullDate\'}}</div><a ng-href="{{job.last_signature.url}}" style="margin-left: 10px" target="_blank">Signed document</a></div><a class="inline" ng-href="/jobs/{{job.id}}/sign_form" target="_blank">Sign Now</a></div></div></div><hr /><div class="row-fluid"><div class="sub-header"><div class="inline" id="job-photos">Photos/Documents</div><div class="pull-right" ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_job_files()">Upload</button></div></div><div class="job-files" ng-hide="uploading_files"><div class="pull-right"></div><div class="inline job-photo" ng-repeat="photo in job.photos" style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><div ng-show="job.documents.length &gt; 0"><div class="bold">Documents</div><div ng-repeat="document in job.documents"><div class="editable" ng-click="edit_file(document)" ng-hide="document.editing"><span>{{document.file_name}} &nbsp;</span><a ng-href="{{document.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="document.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="document.editing.file_name" type="text" /></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(document)">Save</button><button class="btn" ng-click="cancel_edit_file(document)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(document)">Remove</button></div></form></div></div></div></div><div id="photo-viewer"><div class="popover fade right in" style="width: 800px; height: 1000px"><div class="popover-title"><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="full_size_photo()">Full Size</button><button class="btn btn-primary" ng-click="close_photo_viewer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div style="height: 750px"><carousel><slide active="photo.active" ng-repeat="photo in job.photos"><img ng-src="{{photo.url}}" style="margin:auto; max-width: 100%; max-height:750px;" /></slide></carousel></div></div><div class="row-fluid"><center><div class="inline job-photo" ng-class="{&#39;job-photo-active&#39;: photo.active}" ng-repeat="photo in job.photos"><div style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><button class="btn btn-danger" ng-click="remove_photo(photo)" ng-show="photo.active">Remove</button></div></center></div></div></div></div><form action="/jobs/{{job.id}}/upload_files" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /></div><br /><div class="inline" id="upload-photos-spinner"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form></div></div></div><div class="column span6"><div class="content-nav"><ul><li ng-class="{active: right_side==&#39;invoice&#39;}" ng-click="show_right_side(&#39;invoice&#39;)"><a>Invoice</a></li><li ng-class="{active: right_side==&#39;quote&#39;}" ng-click="show_right_side(&#39;quote&#39;)"><a>Quote</a></li></ul></div><div ng-show="right_side==&#39;invoice&#39;"><div ng-hide="job.invoice.id || adding_invoice"><div class="content-box" style="min-height: 400px"><center><br /><br /><br /><div class="goto" ng-click="create_invoice()" style="border: solid 1px; border-color: #AAA; width: 70%; background-color: white"><br /><div class="bold">Create Invoice</div><br /></div><center><div class="spinner" id="create-invoice-spinner"></div></center><br /><br /></center></div></div><div ng-show="adding_invoice"><div class="content-box" style="min-height: 400px"></div><div class="bold">Invoice</div><div invoicepicker="true" ng-model="adding_invoice"></div><div class="button-panel"><button class="btn btn-success" ng-click="add_invoice()">Add</button><button class="btn" ng-click="cancel_add_invoice()">Cancel</button></div></div><div ng-show="job.invoice.id"><div class="content-box job-invoice"><div class="row-fluid"><div class="column span3"><div class="spinner" id="invoice-spinner"></div><div class="sub-header">Invoice</div></div><div class="column span9"><div class="pull-right" ng-show="job.invoice.id"><div ad-tag-labels="true" class="inline" owner="job.invoice"></div><div ad-tags="true" class="inline" owner="job.invoice" resource="Invoice"></div><button class="btn btn-link" id="invoice-tags" ng-click="i_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#invoice-tags&#39;" owner="job.invoice" placement="left" resource="Invoice" showing="i_tags"></div></div></div></div><div class="row-fluid"><div class="column span6"><div ng-show="job.invoice.customer"><span class="label-name-left auto-width">Bill To:</span><span>{{job.invoice.customer.name}}</span><div ng-show="job.invoice.customer.phone || job.invoice.customer.mobile"><span class="label-name-left auto-width">Tel:</span><span ng-show="job.invoice.customer.phone">{{job.invoice.customer.phone}}</span><span ng-hide="job.invoice.customer.phone">{{job.invoice.customer.mobile}}</span></div><div><a href="javascript:void(0)" id="change-invoice-customer-button" ng-click="change_customer()">Change</a></div></div></div><div class="column span6"><div class="pull-right"><div ad-invoice-details="true" ng-model="job.invoice"></div><div><a ng-href="#/invoices/{{job.invoice.id}}">Details</a></div></div></div></div><div ad-invoice="true" job="job" ng-model="job.invoice" on-oscar-success="oscar_invoice_success(account)" on-repco-success="repco_invoice_success()"></div></div><div class="content-box"><div ad-invoice-payments="true" ng-model="job.invoice"></div></div><div ad-change-customer="true" anchor-element="#change-invoice-customer-button" invoice="job.invoice" showing="changing_invoice_customer"></div></div></div><div ng-show="right_side==&#39;quote&#39;"><div class="content-box" id="quote-page"><div class="spinner" id="quote-page-spinner"></div><div class="job-quote"><div class="row-fluid"><div class="pull-left"><div class="sub-header" id="quote-header">Quote #{{$parent.job.quote.number}}</div></div><div class="pull-right" style="text-align: right"><div ng-hide="$parent.job.quote"><button class="btn btn-link" ng-click="$parent.create_quote()">Create Quote</button><span>&nbsp;::&nbsp;</span><button class="btn btn-link" id="add-existing-quote-button" ng-click="$parent.add_existing_quote()">Add Existing Quote</button><div class="spinner" id="create-quote-spinner"></div></div><div ng-show="$parent.job.quote"><div class="inline"><span class="label label-info" ng-class="{&#39;label-success&#39;: $parent.job.quote.last_email.status == &#39;delivered&#39;}">{{$parent.job.quote.last_email.status}}</span></div><div class="btn-group" id="quote-actions"><a class="btn btn-link dropdown-toggle" data-toggle="dropdown" href="#"><span>Actions</span><span class="caret"></span></a><ul class="dropdown-menu pull-right" style="text-align: left;"><li><a ng-href="/quotes/{{$parent.job.quote.id}}/print.pdf" target="_blank"><i class="icon icon-print"></i><span>Print</span></a></li><li><a href="javascript:void(0)" id="email-quote-button" ng-click="$parent.send_quote()"><i class="icon icon-envelope"></i><span>Email Quote</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.transfer_quote_to_invoice()"><i class="icon icon-arrow-right"></i><span>Transfer to invoice</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.copy_from_invoice()"><i class="icon icon-arrow-left"></i><span>Copy from invoice</span></a></li><li><a ng-href="#/quotes/{{$parent.job.quote.id}}"><i class="icon icon-external-link"></i><span>Full Details</span></a></li><li><a href="javascript:void(0)" ng-click="$parent.delete_quote()"><i class="icon icon-remove red"></i><span>Remove</span></a></li></ul></div></div></div></div><div ng-show="$parent.job.quote"><div ad-quote="true" ng-model="$parent.job.quote"></div><div ad-email-quote="true" anchor-element="#quote-header" job="$parent.job" ng-model="$parent.job.quote" placement="bottom" showing="$parent.sending_quote"></div></div></div><div id="add-existing-quote-popover"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="pull-right"><i class="icon icon-remove goto" ng-click="$parent.close_add_existing_quote()"></i></div><div class="sub-header">Add Existing Quote</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><label>Quote: &nbsp;</label><div ad-quotepicker="true" class="inline" ng-model="$parent.added_quote.id" quote="$parent.added_quote"></div></div></div><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="$parent.do_add_existing_quote()">Add</button><button class="btn btn-primary" ng-click="$parent.close_add_existing_quote()">Cancel</button><div class="spinner" id="adding-quote-spinner"></div></div></div></div></div></div></div><div modal="$parent.showing_delete_quote_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this quote</h3></div><div class="modal-body"><div>Are you sure you want to delete this quote</div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="$parent.do_delete_quote()">Yes, Delete It</button><button class="btn" ng-click="$parent.cancel_delete_quote()">Cancel</button></div></div></div></div></div><div modal="showing_delete_quote_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this quote</h3></div><div class="modal-body"><div>Are you sure you want to delete this quote</div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_quote()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_quote()">Cancel</button></div></div></div><div id="repco-response"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header">Please Confirm...</div></div><div class="popover-content"><div class="content-box"><div ng-show="waiting_repco_response"><div class="spinner inline" id="waiting-repco-response"></div><span>Please waiting while we receive data</span></div><div ng-hide="waiting_repco_response"><div class="bold">Do you want to create purchase order for the parts now?</div><br /><br /><button class="btn btn-primary" ng-click="create_purchase_order(active_repco_account())">Yes</button><button class="btn" ng-click="cancel_create_purchase_order()">No</button></div></div></div></div></div><div id="oscar-response"><div class="popover fade left in" style="width: 700px"><div class="popover-title"><div class="sub-header">Please Confirm...</div></div><div class="popover-content"><div class="content-box"><div ng-show="waiting_oscar_response"><div class="spinner inline" id="waiting-oscar-response"></div><span>Please waiting while we receive data</span></div><div ng-hide="waiting_oscar_response"><div class="bold">Do you want to create purchase order for the parts now?</div><br /><br /><button class="btn btn-primary" ng-click="create_purchase_order(active_oscar_account())">Yes</button><button class="btn" ng-click="cancel_create_purchase_order()">No</button></div></div></div></div></div><div ad-stock-info="true"></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/sub_jobs.html",'<div ng-switch="configurations.allow_sub_jobs"><div ng-switch-when="true"><div class="dropdown inline" id="sub-job-actions" ng-show="!$parent.job.master_job_id"><a class="btn" dropdown-toggle="true"><i class="icon icon-plus"></i><span>Add Sub Job</span></a><ul class="dropdown-menu top-dropdown"><li><a id="add-new-sub-job-button" ng-href="#/jobs/new?master_job_id={{$parent.job.id}}&amp;customer_id={{$parent.job.customer.id}}&amp;vehicle_id={{$parent.job.vehicle.id}}"><span>Create New Sub Job</span></a></li><li><a href="javascript:void(0);" id="add-existing-sub-job-button" ng-click="$parent.add_existing_sub_job()"><span>Add Existing Job</span></a></li></ul></div><div class="inline" ng-show="$parent.job.sub_jobs.length &gt; 0"><a href="javascript:void(0)" id="show-sub-jobs-list" ng-click="$parent.show_sub_jobs_list()">Sub Jobs List</a></div><a class="btn" ng-href="#/jobs/{{$parent.job.master_job_id}}" ng-show="$parent.job.master_job_id">Master Job</a><a class="btn" ng-click="$parent.promote()" ng-show="$parent.job.master_job_id"><i class="icon icon-arrow-up"></i><span>Promote</span></a><div id="sub-jobs-list"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="pull-right"><button class="btn btn-primary" ng-click="$parent.close_sub_jobs_list()"><i class="icon icon-remove"></i> <span>Close</span></button></div><div class="sub-header">Sub Job List</div></div><div class="popover-content"><div class="content-box"><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span3">Job No.</div><div class="column span3">Vehicle</div><div class="column span6">Description</div></div></th></tr></thead><tbody><tr ng-repeat="sub_job in $parent.job.sub_jobs"><td><a class="goto" ng-href="#/jobs/{{sub_job.id}}"><div class="row-fluid"><div class="column span3">{{sub_job.number}}</div><div class="column span3">{{sub_job.vehicle|vehicle_title}}</div><div class="column span6">{{sub_job.full_description}}</div></div></a></td></tr></tbody></table></div><button class="btn btn-primary" ng-click="$parent.close_sub_jobs_list()"><i class="icon icon-remove"></i> <span>Close</span></button></div></div></div><div id="add-existing-sub-job"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="sub-header">Add sub job</div></div><div class="popover-content"><div class="content-box"><div>Select a job to add as sub job</div><div ad-jobpicker="true" job="$parent.existing_sub_job" ng-model="$parent.existing_sub_job.id"></div></div><div class="buttons"><button class="btn btn-success" ng-click="$parent.add_sub_job()">Add Sub Job</button><button class="btn" ng-click="$parent.hide_add_existing_sub_job()">Cancel</button><div class="spinner" id="adding-existing-sub-job"></div></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/vehicle_detail.html",'<div class="vehicle-details goto" id="vehicle-details" ng-click="show_vehicle()" ng-show="vehicle"><div class="info" ng-show="vehicle.service_note.length &gt; 0"><span class="label label-info">Next Service Note/TODO</span></div><div class="info"><span class="label-name-left auto-width">Make:</span>{{vehicle.make}} {{vehicle.model}} {{vehicle.year}}</div><div class="info"><span class="label-name-left auto-width">Reg. No#:</span>{{vehicle.registration_number | na: \'short\'}}</div><div class="info" ng-show="vehicle.registration_due_date"><span class="label-name-left auto-width">Reg. Due Date:</span>{{vehicle.registration_due_date | date: \'mediumDate\'}}</div><div class="info" ng-show="vehicle.engine_number"><span class="label-name-left auto-width">Engine No#:</span>{{vehicle.engine_number | na: \'short\'}}</div><div class="info" ng-show="vehicle.vin"><span class="label-name-left auto-width">VIN:</span>{{vehicle.vin}}</div><div class="info" ng-show="vehicle.fleet_number"><span class="label-name-left auto-width">Fleet No#:</span>{{vehicle.fleet_number | na: \'short\'}}</div><div class="info" ng-show="vehicle.fleet_number"><span class="label-name-left auto-width">Driver Name:</span>{{vehicle.driver_name}}</div><div class="info" ng-show="vehicle.driver_phone"><span class="label-name-left auto-width">Driver Phone:</span>{{vehicle.driver_phone}}</div><div class="info" ng-show="vehicle.driver_email"><span class="label-name-left auto-width">Driver Email:</span>{{vehicle.driver_email}}</div><div class="info" ng-show="vehicle.location"><span class="label-name-left auto-width">Location:</span>{{vehicle.location}}</div></div><div ng-switch="pop_vehicle"><div ng-switch-when="true"><div id="vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{$parent.vehicle.title}}<div class="pull-right"><button class="btn btn-danger" ng-click="$parent.change_vehicle()"><i class="icon-refresh"></i>Change To Different {{$parent.asset_name()}}</button><button class="btn" ng-click="$parent.close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-vehicle="true" ng-hide="$parent.new_vehicle" ng-model="$parent.vehicle" on-save="$parent.close_vehicle()"></div></div></div></div></div><div id="change-vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">{{$parent.vehicle.title}}<div class="pull-right"><button class="btn" ng-click="$parent.show_vehicle()">Show Current {{$parent.asset_name()}}</button><button class="btn" ng-click="$parent.close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-change-vehicle="true" model-type="job" ng-model="$parent.job" on-cancel="$parent.show_vehicle()" on-save="$parent.vehicle_changed()" showing="$parent.changing_vehicle" vehicle="$parent.job.vehicle"></div></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/work_hours.html",'<div class="work_hour-check-list" id="work-hour-list"><div class="row-fluid" ng-show="job.work_hours.length &gt; 0"><div class="column span3"><span class="bold">Date</span></div><div class="column span3"><span class="bold">Mechanic</span></div><div class="column span2"><span class="bold">Started</span></div><div class="column span2"><span class="bold">Ended</span></div><div class="column span2"><span class="bold">Total</span></div></div><div id="work-hour-{{work_hour.id}}" ng-repeat="work_hour in job.work_hours"><div ng-hide="work_hour.editing"><div ng-class="{&#39;editable&#39;: work_hour_editable(work_hour)}" ng-click="work_hour_editable(work_hour) &amp;&amp; edit_work_hour(work_hour)"><div class="row-fluid" tooltip="{{work_hour.display_description}}"><div class="column span3"><span>{{work_hour.started_at|date: \'mediumDate\'}}</span></div><div class="column span3"><span>{{work_hour.employee.name}}</span><span class="orange" ng-show="work_hour.overtime">(ot)</span></div><div class="column span2"><span>{{work_hour.started_at|date: \'H:mm\'}}</span></div><div class="column span2"><span>{{work_hour.ended_at|date: \'H:mm\'}}</span></div><div class="column span2"><span ng-show="work_hour.hour &amp;&amp; work_hour.hour &gt; 0">{{work_hour.hour}} h</span><span ng-hide="work_hour.ended_at">&nbsp;<span class="label label-info" tooltip="In Progress">In Progress</span></span><span ng-show="work_hour.no_charge">&nbsp;<span class="label label-warning" tooltip="Internal work, no charge out">I</span></span><div class="pull-right"><span ng-show="work_hour.display_description" title="{{work_hour.display_description}}">...</span></div></div></div></div></div></div><div class="row-fluid editing-item" id="editing-work-hour" ng-show="editing_work_hour.editing"><form name="work_hour_form" novalidate="true"><div class="row-fluid"><div class="column span3"><div>Date</div><ad-datepicker ng-model="editing_work_hour.editing.started_at"></ad-datepicker></div><div class="column span3"><div>Start</div><ad-timepicker ng-model="editing_work_hour.editing.started_at" on-select="update_duration(editing_work_hour.editing)"></ad-timepicker></div><div class="column span3"><div>End</div><ad-timepicker ng-model="editing_work_hour.editing.ended_at" on-select="update_duration(editing_work_hour.editing)"></ad-timepicker></div><div class="column span3"><div>Total (hour)</div><input class="input-tiny" ng-change="update_ended_at(editing_work_hour.editing)" ng-model="editing_work_hour.editing.hour" step="any" type="number" /></div></div><div class="row-fluid"><div class="column span6"><div ng-show="can_assign_employee()"><div>Mechanic</div><select class="inline" name="employee" ng-change="select_work_hour_employee(editing_work_hour.editing)" ng-model="editing_work_hour.editing.employee_id" ng-options="employee.id as employee.name for employee in employees()" required="true"><option value=""></option></select></div></div><div class="column span6" ng-show="allow_invoice_item_on_timesheet()"><label>Related Invoice Item</label><select class="inline" name="employ_item_id" ng-model="editing_work_hour.editing.invoice_item_id" ng-options="item.id as item.description for item in selectable_items()"><option value=""></option></select></div></div><div class="row-fluid"> <label class="inline">Comment/Note:</label><textarea class="span12" id="new-work_hour-description" name="work_hour_description" ng-model="editing_work_hour.editing.description"></textarea></div><div class="row-fluid"><label class="checkbox"><input ng-model="editing_work_hour.editing.overtime" type="checkbox" /><span>Overtime</span></label></div><div class="row-fluid"><label class="checkbox"><input ng-model="editing_work_hour.editing.no_charge" type="checkbox" /><span>Internal, No charge-out</span></label><br /></div><div class="row-fluid"><div class="pull-left"><button class="btn btn-success" ng-click="save_work_hour(work_hour_form)"><i class="icon-ok"></i><span>Save</span></button><button class="btn" ng-click="cancel_edit_work_hour(editing_work_hour)">Cancel</button></div><div class="pull-right"><button class="btn btn-danger" ng-click="remove_work_hour(editing_work_hour)"><i class="icon-remove"></i><span>Remove</span></button></div></div></form></div></div><div class="editing-item" ng-show="new_work_hour"><form name="new_work_hour_form" novalidate="true"><div class="row-fluid"><div class="column span3"><div>Date</div><ad-datepicker ng-model="new_work_hour.started_at" on-select="update_duration(new_work_hour)"></ad-datepicker></div><div class="column span3"><div>Start</div><ad-timepicker ng-model="new_work_hour.started_at" on-select="update_duration(new_work_hour)"></ad-timepicker></div><div class="column span3"><div>End</div><ad-timepicker ng-model="new_work_hour.ended_at" on-select="update_duration(new_work_hour)"></ad-timepicker></div><div class="column span3"><label>Total (hour)</label><input class="input-tiny" ng-change="update_ended_at(new_work_hour)" ng-model="new_work_hour.hour" step="any" type="number" /></div></div><div class="row-fluid"><div class="column span6"><div ng-show="can_assign_employee()"><label>Mechanic</label><select class="inline" name="employee" ng-change="select_work_hour_employee(new_work_hour)" ng-model="new_work_hour.employee_id" ng-options="employee.id as employee.name for employee in employees()"><option value=""></option></select></div></div><div class="column span6" ng-show="allow_invoice_item_on_timesheet()"><div><label>Related Invoice Item</label><select class="inline" name="employ_item_id" ng-model="new_work_hour.invoice_item_id" ng-options="item.id as item.description for item in selectable_items()"><option value=""></option></select></div></div></div><div class="row-fluid"> <label class="inline">Comment/Note:</label><textarea class="span12" id="new-work_hour-description" name="work_hour_description" ng-model="new_work_hour.description"></textarea></div><div class="row-fluid"><label class="checkbox"><input ng-model="new_work_hour.overtime" type="checkbox" /><span>Overtime</span></label></div><div class="row-fluid"><label class="checkbox"><input ng-model="new_work_hour.no_charge" type="checkbox" /><span>Internal, No charge-out</span></label><br /></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_new_work_hour()"><i class="icon-ok"></i>Save</button><button class="btn btn-success" ng-click="save_new_work_hour(true)"><i class="icon-plus"></i>Save And New</button><button class="btn" ng-click="cancel_new_work_hour()">Cancel</button></div></form></div><div class="row-fluid"><div class="column span10 text-align-right bold">Total:</div><div class="column span2">{{total_work_hours()}} h</div></div><hr /><div class="row-fluid"><div class="pull-left" ng-hide="new_work_hour"><button class="btn btn-link" ng-click="add_work_hour()">Add</button></div><div class="pull-right" ng-show="job.work_hours.length &gt; 0"><div class="spinner" id="transfer-work-hours-spinner"></div><div class="btn-group" style="margin-left: 10px"><a class="btn btn-link dropdown-toggle" data-toggle="dropdown" href="#"><span>Transfer to invoice</span> <span class="caret"></span></a><ul class="dropdown-menu" style="text-align: left;"><li><button class="btn btn-link" ng-click="transfer_work_hours(&#39;as_one_line_item&#39;)">Transfer as one line</button></li><li><button class="btn btn-link" ng-click="transfer_work_hours(&#39;per_employee&#39;)">Transfer per employee</button></li><li><button class="btn btn-link" ng-click="transfer_work_hours(&#39;as_one_line_per_item&#39;)">Transfer one line per item</button></li></ul></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/current_jobs/works.html",'<div class="spinner" id="work-spinner"></div><div class="row-fluid"><div class="pull-left"><div class="sub-header">Check Sheet</div></div><div class="pull-right"><span class="goto" ng-click="close_checksheet = true" ng-hide="close_checksheet">Close</span><span class="goto" ng-click="close_checksheet = false" ng-hide="!close_checksheet">Open</span></div></div><div class="row-fluid" ng-hide="close_checksheet"><ul class="work-check-list" id="work-check-list" ng-model="job.works" ui-sortable="work_sortable_options"><li id="work-{{work.id}}" ng-hide="work.editing" ng-repeat="work in job.works"><div class="editable" ng-click="edit_work(work)" ng-show="work.header"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline bold">{{work.title}}</div></div><div ng-hide="work.header"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline work-check"><span>&nbsp;&nbsp;</span><i class="icon-check green pointer" ng-click="toggle_work(work)" ng-show="work.status == &#39;yes&#39;"></i><i class="icon-unchecked pointer" ng-click="toggle_work(work)" ng-show="work.status==&#39;unset&#39;"></i><i class="icon-remove red pointer" ng-click="toggle_work(work)" ng-show="work.status==&#39;no&#39;"></i><i class="icon-exclamation darkorange pointer" ng-click="toggle_work(work)" ng-show="work.status==&#39;cautious&#39;"></i></div><div class="inline work-title editable" ng-click="edit_work(work)"><pre class="no-style">{{work.title}}</pre><div class="work-description" ng-show="work.description"><span>Comment: {{work.description}}</span></div></div></div></li><li id="editing-work" ng-show="editing_work"><div class="row-fluid editing-item" ng-show="editing_work.editing"><form name="work_form" novalidate="true"><div class="error" ng-show="work_form.work_title.$invalid">Work\'s title cannot be empty</div><textarea auto-rows="15" class="span12" name="work_title" ng-model="editing_work.editing.title" required="true" type="text"></textarea><div ng-hide="editing_work.header"><label>Comment</label><textarea auto-rows="15" class="span12" name="work_description" ng-model="editing_work.editing.description" type="text"></textarea></div><div ng-show="editing_work.header &amp;&amp; editing_work.editing.confirm_deletion"><label class="checkbox"><input ng-model="editing_work.editing.delete_children" type="checkbox" />Also Remove items within this header</label></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_work(work_form, editing_work)"><i class="icon-ok"></i><span>Save</span></button><button class="btn" ng-click="cancel_edit_work(editing_work)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="remove_work(editing_work)"><i class="icon-remove"></i><span>Remove</span></button></div></div></form></div></li></ul><div ng-hide="new_work"><button class="btn btn-link" id="add-checklist-item" ng-click="add_work()">Add Item</button><span>&nbsp;::&nbsp;</span><button class="btn btn-link" ng-click="add_work_header()">Add Header</button><span>&nbsp;::&nbsp;</span><button class="btn btn-link" ng-click="copy_invoice_items_to_job_card()">Copy invoice items</button><div class="pull-right"><div class="btn-group" id="works-more-actions" style="margin-left: 10px"><a class="btn btn-link dropdown-toggle" data-toggle="dropdown" href="#"><span>More Actions</span> <span class="caret"></span></a><ul class="dropdown-menu" style="text-align: left;"><li><button class="btn btn-link" ng-click="bulk_tick_works()">Check all</button></li><li><button class="btn btn-link" ng-click="bulk_remove_works()"><i class="icon icon-remove red"></i><span>Remove all</span></button></li><li><button class="btn btn-link" ng-click="transfer_checksheet()">Transfer to invoice</button></li></ul></div></div></div><br /><br /><div ng-show="job.checksheet_text"><div class="pull-right"><button class="btn btn-link" ng-click="remove_checksheet_text()"><i class="icon icon-remove red"></i>Remove checksheet</button></div><br /><div ng-bind-html-unsafe="job.checksheet_text"></div></div><div ng-show="new_work"><div class="row-fluid editing-item"><form name="new_work_form" novalidate="true"><div class="error" ng-show="new_work_form.work_title.$invalid">Work\'s title cannot be empty</div><textarea auto-rows="15" class="span12" id="new-work-title" name="work_title" ng-model="new_work.title" required="true" select-text="true" type="text"></textarea><div ng-hide="new_work.header"><label>Comment</label><textarea auto-rows="15" class="span12" name="work_description" ng-model="new_work.description" type="text"></textarea></div><button class="btn btn-success" ng-click="save_new_work()"><i class="icon-ok"></i>Save</button><button class="btn" ng-click="cancel_new_work()">Cancel</button></form></div></div><div ng-show="digital_signature_enabled()"><div class="sub-header">Customer Signature {{digital_signature_message()}}</div><div id="customer-sign" ng-show="job.last_signature"><div class="inline">Customer signed at {{job.last_signature.created_at|date:\'mediumTime\'}} on {{job.last_signature.created_at|date: \'fullDate\'}}</div><a ng-href="{{job.last_signature.url}}" style="margin-left: 10px" target="_blank">Signed document</a></div><a class="inline" ng-href="/jobs/{{job.id}}/sign_form" target="_blank">Sign Now</a></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/finished_jobs/index.html",'<div ng-controller="FinishedJobsController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="content-box" ng-show="query.deleted"><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span1"><div class="job-list-item">Job No#</div></div><div class="column span4"><div class="job-list-item">Description</div></div><div class="column span2"><div class="job-list-item">Customer</div></div><div class="column span2"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span2"><div class="job-list-item">Deletion entry</div></div><div class="column span1"></div></div></th></tr></thead><tbody><tr ng-repeat="job in jobs"><td><div class="row-fluid"><div class="column span1"><div class="job-list-item">#{{job.number}}</div></div><div class="column span4"><div class="job-list-item-description">{{job.full_description}}</div></div><div class="column span2"><div class="job-list-item">{{job.customer.name}}</div></div><div class="column span2"><div class="job-list-item">{{job.vehicle|vehicle_title: \'withoutRego\'}}</div></div><div class="column span2"><div class="job-list-item-alert">By {{job.deleted_by.name}}</div><div class="job-list-item-alert">On {{job.deleted_at | date: \'mediumDate\'}}</div><div class="job-list-item">{{job.deleted_reason}}</div></div><div class="column span1"><button class="btn btn-info" ng-click="undelete(job)" ng-show="can_undelete_job()">Undelete</button></div></div></td></tr></tbody></table></div><div class="content-box" ng-hide="query.deleted"><div class="spinner" id="finished-jobs-spinner"></div><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span1"><div class="job-list-item">Job No#</div></div><div class="column span1"><div class="job-list-item">Start</div></div><div class="column span1"><div class="job-list-item">Finished</div></div><div class="column span3"><div class="job-list-item">Description</div></div><div class="column span2"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span1"><div class="job-list-item">Reg No.</div></div><div class="column span1"><div class="job-list-item" ng-show="asset_property_set().fleet_number">Fleet No.</div></div><div class="column span2"><div class="job-list-item">Customer</div></div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="job in jobs"><td><a class="goto" ng-href="#/jobs/{{job.id}}"><div class="row-fluid"><div class="column span1"><div class="job-list-item"><div>{{job.number}}</div><div class="label label-warning" ng-show="job.on_hold" tooltip="{{job.on_hold_reason}}">On Hold</div></div></div><div class="column span1"><div class="job-list-item">{{job.time | date: \'shortDate\'}}</div></div><div class="column span1"><div class="job-list-item" ng-show="job.status == &#39;finished&#39;">{{job.finished_time | date: \'shortDate\'}}</div></div><div class="column span3"><div class="job-list-item-description" ng-show="job.full_description">{{job.full_description}}</div><div class="job-list-item-order-number" ng-show="job.order_number">Order #: {{job.order_number}}</div><div class="job-list-item-order-number" ng-show="job.key_tag.length &gt; 0">Key Tag: {{job.key_tag}}</div><div ad-tag-icons="true" class="job-list-item" owner="job"></div></div><div class="column span2"><div class="job-list-item">{{job.vehicle|vehicle_title: \'withoutRego\'}}</div></div><div class="column span1"><div class="job-list-item">{{job.vehicle.registration_number}}</div></div><div class="column span1"><div class="job-list-item" ng-show="asset_property_set().fleet_number">{{job.vehicle.fleet_number}}</div></div><div class="column span2"><div class="job-list-item">{{job.customer.name}}</div><div class="job-list-item">{{job.customer.phone || job.customer.mobile}}</div></div></div></a></td></tr></tbody></table></div><div ng-show="total_pages &gt; 1"><pagination boundary-links="true" current-page="page_number" max-size="20" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/finished_jobs/long_job_list.html",'<div class="content-box" ng-show="query.deleted"><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span1"><div class="job-list-item">Job No#</div></div><div class="column span4"><div class="job-list-item">Description</div></div><div class="column span2"><div class="job-list-item">Customer</div></div><div class="column span2"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span2"><div class="job-list-item">Deletion entry</div></div><div class="column span1"></div></div></th></tr></thead><tbody><tr ng-repeat="job in jobs"><td><div class="row-fluid"><div class="column span1"><div class="job-list-item">#{{job.number}}</div></div><div class="column span4"><div class="job-list-item-description">{{job.full_description}}</div></div><div class="column span2"><div class="job-list-item">{{job.customer.name}}</div></div><div class="column span2"><div class="job-list-item">{{job.vehicle|vehicle_title: \'withoutRego\'}}</div></div><div class="column span2"><div class="job-list-item-alert">By {{job.deleted_by.name}}</div><div class="job-list-item-alert">On {{job.deleted_at | date: \'mediumDate\'}}</div><div class="job-list-item">{{job.deleted_reason}}</div></div><div class="column span1"><button class="btn btn-info" ng-click="undelete(job)" ng-show="can_undelete_job()">Undelete</button></div></div></td></tr></tbody></table></div><div class="content-box" ng-hide="query.deleted"><div class="spinner" id="finished-jobs-spinner"></div><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span1"><div class="job-list-item">Job No#</div></div><div class="column span1"><div class="job-list-item">Start</div></div><div class="column span1"><div class="job-list-item">Finished</div></div><div class="column span3"><div class="job-list-item">Description</div></div><div class="column span2"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span1"><div class="job-list-item">Reg No.</div></div><div class="column span1"><div class="job-list-item" ng-show="asset_property_set().fleet_number">Fleet No.</div></div><div class="column span2"><div class="job-list-item">Customer</div></div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="job in jobs"><td><a class="goto" ng-href="#/jobs/{{job.id}}"><div class="row-fluid"><div class="column span1"><div class="job-list-item"><div>{{job.number}}</div><div class="label label-warning" ng-show="job.on_hold" tooltip="{{job.on_hold_reason}}">On Hold</div></div></div><div class="column span1"><div class="job-list-item">{{job.time | date: \'shortDate\'}}</div></div><div class="column span1"><div class="job-list-item" ng-show="job.status == &#39;finished&#39;">{{job.finished_time | date: \'shortDate\'}}</div></div><div class="column span3"><div class="job-list-item-description" ng-show="job.full_description">{{job.full_description}}</div><div class="job-list-item-order-number" ng-show="job.order_number">Order #: {{job.order_number}}</div><div class="job-list-item-order-number" ng-show="job.key_tag.length &gt; 0">Key Tag: {{job.key_tag}}</div><div ad-tag-icons="true" class="job-list-item" owner="job"></div></div><div class="column span2"><div class="job-list-item">{{job.vehicle|vehicle_title: \'withoutRego\'}}</div></div><div class="column span1"><div class="job-list-item">{{job.vehicle.registration_number}}</div></div><div class="column span1"><div class="job-list-item" ng-show="asset_property_set().fleet_number">{{job.vehicle.fleet_number}}</div></div><div class="column span2"><div class="job-list-item">{{job.customer.name}}</div><div class="job-list-item">{{job.customer.phone || job.customer.mobile}}</div></div></div></a></td></tr></tbody></table></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/finished_jobs/short_job_list.html",'<div class="content-box" ng-show="query.deleted"><div class="container-fluid"><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span2"><div class="job-list-item">Job No#</div></div><div class="column span4"><div class="job-list-item">Description</div></div><div class="column span3"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span3"><div class="job-list-item">Customer</div></div></div></th></tr></thead><tbody><tr ng-repeat="job in jobs"><td><div class="row-fluid"><div class="column span2"><div class="job-list-item">#{{job.number}}</div></div><div class="column span4"><div class="job-list-item">{{job.full_description}}</div></div><div class="column span3"><div class="job-list-item">{{job.vehicle.title}}</div></div><div class="column span3"><div class="job-list-item">{{job.customer.name}}</div></div></div></td></tr></tbody></table></div></div><div class="content-box" ng-hide="query.deleted"><div class="spinner" id="finished-jobs-spinner"></div><div class="container-fluid"><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span2"><div class="job-list-item">Job No#</div></div><div class="column span4"><div class="job-list-item">Description</div></div><div class="column span3"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span3"><div class="job-list-item">Customer</div></div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="job in jobs"><td><a class="goto" ng-href="#/jobs/{{job.id}}"><div class="row-fluid"><div class="column span2"><div class="job-list-item">{{job.number}}</div></div><div class="column span4"><div class="job-list-item">{{job.full_description}}</div></div><div class="column span3"><div class="job-list-item">{{vehicle.title}}</div><div class="job-list-item" ng-show="asset_property_set().fleet_number">{{job.vehicle.fleet_number}}</div></div><div class="column span3"><div class="job-list-item">{{job.customer.name}}</div><div class="job-lsit-item">{{job.customer.phone || job.customer.mobile}}</div></div></div></a></td></tr></tbody></table></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("jobs/tabs.html",'<ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("mapp/jobs/finished_jobs.html",'<div ng-controller="AllJobsController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="content-box" ng-show="query.deleted"><div class="container-fluid"><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span2"><div class="job-list-item">Job No#</div></div><div class="column span4"><div class="job-list-item">Description</div></div><div class="column span3"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span3"><div class="job-list-item">Customer</div></div></div></th></tr></thead><tbody><tr ng-repeat="job in jobs"><td><div class="row-fluid"><div class="column span2"><div class="job-list-item">#{{job.number}}</div></div><div class="column span4"><div class="job-list-item">{{job.full_description}}</div></div><div class="column span3"><div class="job-list-item">{{job.vehicle.title}}</div></div><div class="column span3"><div class="job-list-item">{{job.customer.name}}</div></div></div></td></tr></tbody></table></div></div><div class="content-box" ng-hide="query.deleted"><div class="spinner" id="all-jobs-spinner"></div><div class="container-fluid"><table class="table table-striped job-list"><thead><tr><th><div class="row-fluid"><div class="column span2"><div class="job-list-item">Job No#</div></div><div class="column span4"><div class="job-list-item">Description</div></div><div class="column span3"><div class="job-list-item">{{asset_name()}}</div></div><div class="column span3"><div class="job-list-item">Customer</div></div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="job in jobs"><td><a class="goto" ng-href="#/jobs/{{job.id}}"><div class="row-fluid"><div class="column span2"><div class="job-list-item">{{job.number}}</div></div><div class="column span4"><div class="job-list-item">{{job.full_description}}</div></div><div class="column span3"><div class="job-list-item">{{vehicle.title}}</div><div class="job-list-item" ng-show="asset_property_set().fleet_number">{{job.vehicle.fleet_number}}</div></div><div class="column span3"><div class="job-list-item">{{job.customer.name}}</div><div class="job-lsit-item">{{job.customer.phone || job.customer.mobile}}</div></div></div></a></td></tr></tbody></table></div></div><pagination boundary-links="true" current-page="page_number" max-size="20" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("mapp/jobs/index.html",'<div ng-controller="JobsController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="spinner" id="current-jobs-spinner"></div><div class="content-box"><div class="page-header">Current Jobs<div class="pull-right" ng-hide="restricted_to_create_jobs()"><a class="btn btn-primary" href="#/jobs/new"><i class="icon icon-wrench"></i><span>New Job</span></a><a class="btn btn-primary" href="#/bookings/new"><i class="icon icon-calendar"></i><span>New Booking</span></a></div></div><div><div class="pull-left"><label class="checkbox"><input ng-model="only_on_hold" type="checkbox" />Only  On Hold</label></div><div class="pull-right"><div class="input-append"><input id="jobs-search-input" ng-model="current_job_search" type="text" /><span class="add-on"><i class="icon icon-search"></i></span></div></div></div><table class="table table-striped"><tbody><tr class="goto" ng-repeat="job in current_jobs(page_number)"><td class="current-job-content"><div class="spinner" id="job-{{job.id}}"></div><div class="row-fluid"><div class="dashboard-job-number"><div><div class="dropdown inline" id="actions-job-{{job.id}}"><a dropdown-toggle="true"><span><i class="icon icon-reorder"></i></span></a><ul class="dropdown-menu"><li><button class="btn btn-link"><a ng-href="/jobs/{{job.id}}/print.pdf" target="_blank"><i class="icon-print"></i><span>Print</span></a></button></li><li><button class="btn btn-link" id="put-on-hold-{{job.id}}" ng-click="put_on_hold(job)"><i class="icon-pause"></i><span>Put On Hold</span></button></li><li><button class="btn btn-link" id="send-sms-{{job.id}}" ng-click="send_sms(job)"><i class="icon icon-mobile-phone"></i><span>SMS</span></button></li><li><button class="btn btn-link" id="send-email-{{job.id}}" ng-click="send_email(job)"><i class="icon icon-envelope"></i><span>Email</span></button></li><li><button class="btn btn-link" id="tag-{{job.id}}" ng-click="tag(job)"><i class="icon icon-tags"></i><span>Tags</span></button></li><li><button class="btn btn-link" id="assign-{{job.id}}" ng-click="assign(job)"><i class="icon icon-wrench"></i><span>Assign To</span></button></li></ul></div><div class="inline">#{{job.number}}</div></div><div ng-show="job.tags.length &gt; 0"><div ad-tag-icons="true" owner="job"></div></div></div><a class="goto" ng-href="#/jobs/{{job.id}}"><div class="dashboard-job-types"><div>{{job.full_description}}</div><div ng-show="job.key_tag.length &gt; 0">Key Tag: {{job.key_tag}}</div><div class="italic" ng-show="job.employees.length &gt; 0">({{job.employees|comma_seperated: \'name\'}})</div></div><div class="dashboard-vehicle"><div>{{job.vehicle|vehicle_title}}</div><div ng-show="job.vehicle.fleet_number">Fleet No.: {{job.vehicle.fleet_number}} </div><div ng-show="job.vehicle.vin">VIN: {{job.vehicle.vin}} </div></div><div class="dashboard-customer text-align-right"><div>{{job.customer.name}}</div><div>{{job.customer|phone_number}}</div></div></a></div></td></tr></tbody></table><div ng-show="total_pages() &gt; 1"><pagination boundary-links="true" current-page="page_number" max-size="30" num-pages="total_pages()" on-select-page="show(page)" rotate="false"></pagination></div><div class="page-header">Jobs On Hold</div><table class="table table-striped"><tbody><tr class="goto" ng-repeat="job in on_hold_jobs()"><td class="current-job-content"><div class="spinner" id="job-{{job.id}}"></div><div class="row-fluid"><div class="dashboard-job-number"><div><div class="inline"><div class="dropdown" id="actions-job-{{job.id}}"><a dropdown-toggle="true"><i class="icon icon-reorder"></i></a><ul class="dropdown-menu"><li><button class="btn btn-link"><a ng-href="/jobs/{{job.id}}/print.pdf" target="_blank"><i class="icon-print"></i><span>Print</span></a></button></li><li><button class="btn btn-link" id="put-on-hold-{{job.id}}" ng-click="continue(job)"><i class="icon-play"></i><span>Continue</span></button></li><li><button class="btn btn-link" id="send-sms-{{job.id}}" ng-click="send_sms(job)"><i class="icon icon-mobile-phone"></i><span>SMS</span></button></li><li><button class="btn btn-link" id="send-email-{{job.id}}" ng-click="send_email(job)"><i class="icon icon-envelope"></i><span>Email</span></button></li><li><button class="btn btn-link" id="tag-{{job.id}}" ng-click="tag(job)"><i class="icon icon-tags"></i><span>Tags</span></button></li><li><button class="btn btn-link" id="assign-{{job.id}}" ng-click="assign(job)"><i class="icon icon-wrench"></i><span>Assign To</span></button></li></ul></div></div><div class="inline">#{{job.number}}</div></div><div ng-show="job.tags.length &gt; 0"><div ad-tag-icons="true" owner="job"></div></div><div class="label label-warning" tooltip="{{job.on_hold_reason}}">On Hold</div><div ng-show="job.status == &#39;preparing&#39;"><div class="label label-info">Preparing</div></div></div><a class="goto" href="javascript:void(0)" ng-click="open_job(job)"><div class="dashboard-job-types"><div class="orange">{{job.on_hold_reason}}</div><div>{{job.full_description}}</div><div class="italic" ng-show="job.employees.length &gt; 0">({{job.employees|comma_seperated: \'name\'}})</div></div><div class="dashboard-vehicle"><div>{{job.vehicle|vehicle_title}}</div><div ng-show="job.vehicle.fleet_number">Fleet No.: {{job.vehicle.fleet_number}} </div><div ng-show="job.vehicle.vin">VIN: {{job.vehicle.vin}} </div></div><div class="dashboard-customer text-align-right"><div>{{job.customer.name}}</div><div>{{job.customer.phone}}</div></div></a></div></td></tr></tbody></table></div><div class="spinner" id="upcoming-bookings-spinner"></div><div class="content-box"><div class="row-fluid"><div class="pull-left"><div class="page-header">Upcoming Bookings (next 7 days)</div></div><div class="pull-right"><a ng-href="#/bookings/">All Bookings</a></div></div><table class="table table-striped upcoming-bookings"><tbody><tr ng-repeat="booking in filtered_bookings()"><td><div class="dashboard-booking-time"><div class="bold"><div><span>{{booking.time | date: \'mediumTime\'}}<br />{{booking.time | date: \'mediumDate\'}}</span></div><div><div>By {{booking.created_by}}</div></div></div><div ng-show="booking.status == &#39;preparing&#39;"><label class="label label-info">Preparing</label></div></div><div class="dashboard-job-types">{{booking.full_description}}<div class="italic" ng-show="booking.employees.length &gt; 0">({{booking.employees|comma_seperated:\'name\'}})</div></div><div class="dashboard-vehicle"><div>{{booking.vehicle.title}}</div><div ng-show="booking.vehicle.fleet_number">Fleet No.: {{booking.vehicle.fleet_number}} </div></div><div class="dashboard-customer text-align-right">{{booking.name}}<br />{{booking.mobile || booking.phone}}</div><br /><br /><div><div class="inline" ng-hide="booking.job_id"><a href="#/bookings/{{booking.id}}/edit"><i class="icon-pencil"></i>Edit</a><span>&nbsp;&nbsp;</span><a class="btn btn-link" href="#/jobs/new?booking={{booking.id}}&amp;prepare=true"><i class="icon-wrench"></i>Prepare</a><span>&nbsp;&nbsp;</span><a class="btn btn-link" href="#/jobs/new?booking={{booking.id}}"><i class="icon-ok green"></i>Start</a></div><div class="inline" ng-show="booking.job_id"><a href="#/bookings/{{booking.id}}/edit"><i class="icon-pencil"></i>Edit</a><span>&nbsp;&nbsp;</span><a class="btn btn-link" href="#/jobs/{{booking.job_id}}"><i class="icon-ok green"></i>Prepare/Start</a></div><span>&nbsp;&nbsp;</span><div class="inline"><button class="btn btn-link" ng-click="cancel_booking(booking)"><i class="icon-remove red"></i>Cancel</button></div></div></td></tr></tbody></table></div><div ad-put-on-hold="true" anchor-element="actions_job_anchor" ng-model="action_job" placement="top" showing="putting_on_hold"></div><div ad-send-email="true" anchor-element="actions_job_anchor" customer="action_job.customer" job="action_job" placement="top" showing="sending_email" vehicle="action_job.vehicle"></div><div ad-send-sms="true" anchor-element="actions_job_anchor" customer="action_job.customer" job="action_job" placement="top" showing="sending_sms" vehicle="action_job.vehicle"></div><div ad-tags="true" anchor-element="actions_job_anchor" owner="action_job" placement="top" resource="Job" showing="tagging_job"></div><div ad-assign-employees="true" anchor-element="actions_job_anchor" job="action_job" placement="top" showing="assigning_job"></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("mapp/jobs/show.html",'<div ng-controller="ShowJobController"><div ng-hide="job &amp;&amp; job.id"><div class="spinner" id="job-loading"></div></div><div ng-show="job &amp;&amp; job.id"><img class="done-sign" ng-show="job &amp;&amp; job.status == &#39;finished&#39;" ng-src="/assets/completed-db7f0f84520f48344132128dbeb76d73.gif" /><img class="paid-sign" ng-show="job.invoice.paid" ng-src="/assets/paid-d5240fc8cfeec7b14de62c19cf6d9848.gif" /><div class="deleted-sign" ng-show="job.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><div class="row-fluid"><div class="pull-left"><div class="page-header"><div class="inline">{{job.title}}</div></div></div><div class="pull-right"><div ad-tag-labels="true" class="inline" owner="job"></div><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="job" placement="left" resource="Job" showing="x_tags"></div></div></div><center><div class="row-fluid well" ng-show="job.on_hold" style="width: 90%; text-align: center;"><label class="label label-warning">ON HOLD</label><span class="bold">&nbsp; {{job.on_hold_reason}}</span></div></center><div class="row-fluid"><div class="pull-left"><div class="dropdown inline" id="sub-job-actions" ng-show="configurations.allow_sub_jobs &amp;&amp; !job.master_job_id"><a class="btn" dropdown-toggle="true"><i class="icon icon-plus"></i><span>Add Sub Job</span></a><ul class="dropdown-menu top-dropdown"><li><a id="add-new-sub-job-button" ng-href="#/jobs/new?master_job_id={{job.id}}&amp;customer_id={{job.customer.id}}&amp;vehicle_id={{job.vehicle.id}}"><span>Create New Sub Job</span></a></li><li><a href="javascript:void(0);" id="add-existing-sub-job-button" ng-click="add_existing_sub_job()"><span>Add Existing Job</span></a></li></ul></div><div class="inline" ng-show="job.sub_jobs.length &gt; 0"><a href="javascript:void(0)" id="show-sub-jobs-list" ng-click="show_sub_jobs_list()">Sub Jobs List</a></div><a class="btn" ng-href="#/jobs/{{job.master_job_id}}" ng-show="job.master_job_id">Master Job</a><a class="btn" ng-click="promote()" ng-show="job.master_job_id"><i class="icon icon-arrow-up"></i><span>Promote</span></a></div><div class="pull-right"><div class="spinner" id="clocking-spinner"></div><button class="btn btn-primary" id="clock-on-button" ng-click="clock_on()" ng-hide="pending_work_hour()"><i class="icon icon-time"></i>Clock On</button><button class="btn btn-success" ng-click="clock_off()" ng-show="pending_work_hour()"><i class="icon icon-time"></i>Clock Off</button><a class="btn" ng-href="/jobs/{{job.id}}/print.pdf" target="_blank"><i class="icon-print"></i><span>Print Job Card</span></a><a class="btn" href="javascript:void(0);" id="email-job-card" ng-click="email_job_card()"><i class="icon icon-envelope"></i><span>Email Job Card</span></a><div class="dropdown inline" id="communication-actions"><a class="btn" dropdown-toggle="true"><i class="icon icon-share-alt"></i><span>Send...</span></a><ul class="dropdown-menu top-dropdown"><li><a href="javascript:void(0);" id="send-sms-button" ng-click="send_sms()"><i class="icon icon-mobile-phone"></i><span>Send SMS</span></a></li><li><a href="javascript:void(0);" id="send-email-button" ng-click="send_email()"><i class="icon icon-envelope"></i><span>Send Email</span></a></li></ul></div><button class="btn btn-warning" id="put-on-hold" ng-click="put_on_hold()" ng-hide="job.deleted || job.finished || job.on_hold"><i class="icon icon-stop"></i>Put On Hold</button><button class="btn btn-success" id="continue" ng-click="continue()" ng-hide="!job.on_hold"><i class="icon icon-play"></i>Continue</button><button class="btn btn-primary" id="finish" ng-click="finish()" ng-hide="job.deleted || job.finished"><i class="icon-ok"></i>Finish</button><button class="btn" id="unfinish" ng-click="unfinish()" ng-show="job.finished">Unfinish</button><div id="job-send-email"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Email Job Card</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form><div class="pull-right"><div class="inline" id="job-send-email-spinner"></div></div><label>Email</label><input class="span9" id="job-send-email-address" ng-model="email" type="text" /><div class="pull-right"><div class="inline" contactpicker="true" model-type="customer" ng-model="job.customer" on-select="email_select_contact(contacts)" show-email="true"></div></div><label>Subject</label><input class="span12" id="job-send-email-subject" ng-model="subject" type="text" /><label><span>Message</span><span ad-saved-texts-button="true" job="job" ng-model="message"></span></label> <textarea class="span12" id="job-send-email-message" ng-model="message" rows="5" type="text"></textarea><div><label class="checkbox"><input ng-model="delivery_notification_required" type="checkbox" /><span>Send me a notification on delivery</span></label></div><div><label class="checkbox"><input ng-model="attached_files" type="checkbox" /><span>Attach Files</span></label></div><div ng-show="attached_files"><table class="table table-striped"><tbody><tr ng-repeat="file in job.photos"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr><tr ng-repeat="file in job.documents"><td><label class="checkbox"><input ng-model="file.attached" type="checkbox" /><a ng-href="{{file.url}}" target="_blank">{{file.file_name}}</a></label></td></tr></tbody></table></div><div><button class="btn btn-success" ng-click="send_job_card()">Send</button><button class="btn" ng-click="cancel_email_job_card()">Cancel</button></div></form></div></div></div></div></div><div ad-put-on-hold="true" anchor-element="put_on_hold_anchor" ng-model="job" placement="bottom" showing="putting_on_hold"></div><div ad-finish-job="true" anchor-element="#finish" ng-model="job" on-paying="pay()" showing="finishing" vehicle="vehicle"></div><div ad-pay-invoice="true" anchor-element="#pay" ng-model="job.invoice" showing="paying"></div><div ad-send-email="true" anchor-element="&#39;#communication-actions&#39;" customer="job.customer" job="job" placement="left" showing="show_send_email" vehicle="job.vehicle"></div><div ad-send-sms="true" anchor-element="&#39;#communication-actions&#39;" customer="job.customer" job="job" placement="left" showing="show_send_sms" vehicle="job.vehicle"></div><div modal="showing_delete_job_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this job</h3></div><div class="modal-body"><div>Are you sure you want to delete this Job?</div><div ng-show="job.booking"><label class="checkbox"><input ng-model="delete_booking" type="checkbox" />Also delete the job\'s booking</label></div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><div class="spinner" id="delete-job-spinner"></div><button class="btn btn-danger" ng-click="do_delete_job()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_job()">Cancel</button></div></div><div id="in-progress-work-hours"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">You are current clocked on to another job</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div>You are current clocked on the the following jobs</div><br /><br /><div class="spinner" id="in-progress-clocking-spinner"></div><table class="table table-striped"><tr ng-repeat="work_hour in in_progress_work_hours"><td>{{work_hour.job.title}}</td><td><button class="btn btn-link" ng-click="clock_off_in_progress(work_hour)" ng-hide="require_timesheet_description(work_hour)">Clock Off</button></td><td><div class="pull-right"><a class="btn btn-link" ng-href="#/jobs/{{work_hour.job.id}}" target="_blank">Open</a></div></td></tr></table></div><button class="btn" ng-click="close_in_progress_work_hours()">Close</button></div></div></div></div></div></div><br /><div class="content-nav"><ul><li ng-class="{active: left_side==&#39;job&#39;}" ng-click="show_left_side(&#39;job&#39;)"><a>Job Details</a></li><li ng-class="{active: left_side==&#39;files&#39;}" ng-click="show_left_side(&#39;files&#39;)"><a>Files</a></li><li ng-class="{active: left_side==&#39;work_hours&#39;}" ng-click="show_left_side(&#39;work_hours&#39;)" ng-hide="no_access_to_timesheets()"><a>Timesheet</a></li></ul></div><div ng-show="left_side==&#39;job&#39;"><div class="content-box"><div class="row-fluid"><div class="pull-left"><div class="job-details" ng-click="edit_job_types()" ng-hide="job.editing_job_types"><div class="editable"><div class="info"><span class="label-name-left auto-width">Job Type:</span><span class="inline" style="max-width: 200px">{{job.job_types_title|na}}</span></div></div></div><div class="editing-item" ng-show="job.editing_job_types"><form class="form-horizontal" name="job_types_form" novalidate="true"><div class="control-group"><label class="control-label" style="width: 80px">Job Types</label><div class="controls" style="margin-left: 100px; min-width: 320px"><div ad-job-type-selection="true" ng-model="job.editing_job_types.job_type_ids"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_job_types()">Save</button><button class="btn" ng-click="cancel(job, &#39;editing_job_types&#39;)">Cancel</button><div class="spinner" id="job-update-job-types-spinner"></div></div></div></form></div><div class="job-details" ng-click="edit_job_details()" ng-hide="job.editing_job_details"><div class="editable"><div class="info" ng-show="job.order_number"><span class="label-name-left auto-width">Order Number:</span>{{job.order_number}}</div><div class="info" ng-show="job.quote"><span class="label-name-left auto-width">Quote Number:</span>{{job.quote.number}}</div><div class="info" ng-show="job.created_by"><span class="label-name-left auto-width">Booked In By:</span>{{job.created_by }}</div><div class="info" ng-show="job.time"><span class="label-name-left auto-width">Time:</span>{{job.time | date: \'short\'}}</div><div class="info" ng-show="job.total_hours"><span class="label-name-left auto-width">Estimate:</span>{{job.total_hours}} hours</div><div class="info" ng-show="job.pickup_time"><span class="label-name-left auto-width">Pickup time:</span>{{job.pickup_time | date: \'short\'}}</div><div class="info" ng-show="job.key_tag.length &gt; 0"><span class="label-name-left auto-width">Key Tag:</span><span class="inline" style="max-width: 200px">{{job.key_tag}}</span></div><div class="info"><span class="label-name-left auto-width">Odometer:</span><span ng-show="job.odometer">{{job.odometer|number}} {{job.vehicle.odometer_unit}}</span><span ng-hide="job.odometer">(Not Available)</span></div><div class="info" ng-show="asset_property_set().machine_hours"><span class="label-name-left auto-width">Machine Hours:</span><span ng-show="job.machine_hours">{{job.machine_hours|number}} hr(s)</span><span ng-hide="job.machine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().engine_hours"><span class="label-name-left auto-width">Engine Hours:</span><span ng-show="job.engine_hours">{{job.engine_hours|number}} hr(s)</span><span ng-hide="job.engine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().port_engine_hours"><span class="label-name-left auto-width">Port Engine Hours:</span><span ng-show="job.port_engine_hours">{{job.port_engine_hours|number}} hr(s)</span><span ng-hide="job.port_engine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().starboard_engine_hours"><span class="label-name-left auto-width">Starboard Engine Hours:</span><span ng-show="job.starboard_engine_hours">{{job.starboard_engine_hours|number}} hr(s)</span><span ng-hide="job.starboard_engine_hours">(Not Available)</span></div><div class="info" ng-show="asset_property_set().sleeper_air_engine_hours"><span class="label-name-left auto-width">Sleeper Air Engine Hours:</span><span ng-show="job.sleeper_air_engine_hours">{{job.sleeper_air_engine_hours|number}} hr(s)</span><span ng-hide="job.sleeper_air_engine_hours">(Not Available)</span></div><div class="info" ng-show="show_hubodometer()"><span class="label-name-left auto-width">Hubodometer:</span><span ng-show="job.hubodometer">{{job.hubodometer|number}} {{job.vehicle.odometer_unit}}</span><span ng-hide="job.hubodometer">(Not Available)</span></div><div ng-show="job.finished_time"><div class="info"><span class="label-name-left auto-width">Finished:</span>{{job.finished_time | date: \'mediumDate\'}}</div></div><div class="info" ng-show="job.employee"><span class="label-name-left auto-width">Finished By:</span>{{job.employee.name}}</div></div></div><div class="editing-item" ng-show="job.editing_job_details"><form class="form-horizontal" name="job_details_form" novalidate="true"><div class="control-group"><label class="control-label">Description</label><div class="controls"><input class="input" ng-model="job.editing_job_details.description" type="text" /></div></div><div class="control-group"><label class="control-label">Order Number</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.order_number" type="text" /></div></div><div class="control-group"><label class="control-label">Job Number</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.number" type="text" /></div></div><div class="control-group"><label class="control-label">Start Time</label><div class="controls"><ad-datepicker error="top" ng-model="job.editing_job_details.time"></ad-datepicker><ad-timepicker error="top" ng-model="job.editing_job_details.time"></ad-timepicker></div></div><div class="control-group"><label class="control-label">Estimate</label><div class="controls"><div class="input-append"><input class="input-small" ng-model="job.editing_job_details.total_hours" step="any" type="number" /><span class="add-on">hours</span></div></div></div><div class="control-group"><label class="control-label">Pickup time</label><div class="controls"><ad-datepicker error="top" ng-model="job.editing_job_details.pickup_time"></ad-datepicker><ad-timepicker error="top" ng-model="job.editing_job_details.pickup_time"></ad-timepicker></div></div><div class="control-group" ng-show="asset_property_set().key_tag"><label class="control-label">Key Tag</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.key_tag" type="text" /></div></div><div class="control-group"><label class="control-label">Odometer:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.odometer" type="text" /></div></div><div class="control-group" ng-show="show_hubodometer()"><label class="control-label">Hubodometer:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.hubodometer" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().machine_hours"><label class="control-label">Machine Hours:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.machine_hours" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_hours"><label class="control-label">Engine Hours:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.engine_hours" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().sleeper_air_engine_hours"><label class="control-label">Sleeper Air Enghine Hours:</label><div class="controls"><input class="input-small" ng-model="job.editing_job_details.sleeper_air_engine_hours" type="text" /></div></div><div class="control-group"><label class="control-label">Finished Time:</label><div class="controls"><ad-datepicker error="top" ng-model="job.editing_job_details.finished_time"></ad-datepicker><ad-timepicker error="top" ng-model="job.editing_job_details.finished_time"></ad-timepicker></div></div><div class="control-group" ng-show="courtesy_vehicles().length == 0"><label class="control-label">Courtesy {{asset_name()}}:</label><div class="controls"><input ng-model="job.editing_job_details.replacement_provided" type="checkbox" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_job_details()">Save</button><button class="btn" ng-click="cancel(job, &#39;editing_job_details&#39;)">Cancel</button><div class="spinner" id="job-update-details-spinner"></div></div></div></form></div><br /><div class="editable" ng-click="edit_job_mechanics()" ng-hide="job.editing_mechanics"><div><div class="info"><span class="label-name-left auto-width">Mechanics:</span><span>{{employee_names()|na}}</span></div></div></div><div class="editing-item" ng-show="job.editing_mechanics"><form><div><label class="label-name-left">Mechanic 1:</label><select ng-model="mechanic_1_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(1)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 2:</label><select ng-model="mechanic_2_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(2)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 3:</label><select ng-model="mechanic_3_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(3)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Mechanic 4:</label><select ng-model="mechanic_4_id" ng-options="mechanic.id as mechanic.name for mechanic in employees()" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(4)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left"></label><div><button class="btn btn-success" ng-click="save_job_mechanics()">Save</button><button class="btn" ng-click="cancel(job, &#39;editing_mechanics&#39;)">Cancel</button></div></div></form></div><br /></div><div class="pull-right"><div class="vehicle-owner-details goto" id="vehicle-owner" ng-click="show_customer()"><div class="info"><span class="label-name-left auto-width">Customer:</span>{{customer.name | na}}</div><div class="info" ng-show="customer.contact_name"><span class="label-name-left auto-width">Contact Person:</span>{{customer.contact_name}}</div><div class="info"><span class="label-name-left auto-width">Email:</span>{{customer.email | na}}</div><div class="info"><span class="label-name-left auto-width">Mobile:</span>{{customer.mobile | na}}</div><div class="info" ng-show="customer.phone"><span class="label-name-left auto-width">Phone:</span>{{customer.phone}}</div></div><div ng-switch="pop_customer"><div ng-switch-when="true"><div id="customer"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{$parent.customer.name}}<div class="pull-right"><button class="btn btn-danger" ng-click="$parent.change_job_customer()"><i class="icon-refresh"></i>Change Customer</button><a class="btn" ng-href="#/customers/{{$parent.customer.id}}"><i class="icon-external-link"></i><span>Full Details</span></a><button class="btn" ng-click="$parent.close_customer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><br /><ad-customer ng-model="$parent.customer" on-save="$parent.customer_updated()" on-select-vehicle="$parent.goto_vehicle(vehicle)"></ad-customer></div></div></div></div><div ad-change-customer="true" anchor-element="#vehicle-owner" customer="$parent.customer" job="$parent.job" on-transfer-vehicle="$parent.fetch_vehicle()" showing="$parent.changing_job_customer" vehicle="$parent.job.vehicle"></div></div></div><br /><div class="vehicle-details goto" id="vehicle-details" ng-click="show_vehicle()" ng-show="vehicle"><div class="info" ng-show="vehicle.service_note.length &gt; 0"><span class="label label-info">Next Service Note/TODO</span></div><div class="info"><span class="label-name-left auto-width">Make:</span>{{vehicle.make}} {{vehicle.model}} {{vehicle.year}}</div><div class="info"><span class="label-name-left auto-width">Reg. No#:</span>{{vehicle.registration_number | na: \'short\'}}</div><div class="info" ng-show="vehicle.registration_due_date"><span class="label-name-left auto-width">Reg. Due Date:</span>{{vehicle.registration_due_date | date: \'mediumDate\'}}</div><div class="info" ng-show="vehicle.engine_number"><span class="label-name-left auto-width">Engine No#:</span>{{vehicle.engine_number | na: \'short\'}}</div><div class="info" ng-show="vehicle.vin"><span class="label-name-left auto-width">VIN:</span>{{vehicle.vin}}</div><div class="info" ng-show="vehicle.fleet_number"><span class="label-name-left auto-width">Fleet No#:</span>{{vehicle.fleet_number | na: \'short\'}}</div><div class="info" ng-show="vehicle.fleet_number"><span class="label-name-left auto-width">Driver Name:</span>{{vehicle.driver_name}}</div><div class="info" ng-show="vehicle.driver_phone"><span class="label-name-left auto-width">Driver Phone:</span>{{vehicle.driver_phone}}</div><div class="info" ng-show="vehicle.driver_email"><span class="label-name-left auto-width">Driver Email:</span>{{vehicle.driver_email}}</div><div class="info" ng-show="vehicle.location"><span class="label-name-left auto-width">Location:</span>{{vehicle.location}}</div></div><div ng-switch="pop_vehicle"><div ng-switch-when="true"><div id="vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{$parent.vehicle.title}}<div class="pull-right"><button class="btn btn-danger" ng-click="$parent.change_vehicle()"><i class="icon-refresh"></i>Change To Different {{$parent.asset_name()}}</button><button class="btn" ng-click="$parent.close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-vehicle="true" ng-hide="$parent.new_vehicle" ng-model="$parent.vehicle" on-save="$parent.close_vehicle()"></div></div></div></div></div><div id="change-vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">{{$parent.vehicle.title}}<div class="pull-right"><button class="btn" ng-click="$parent.show_vehicle()">Show Current {{$parent.asset_name()}}</button><button class="btn" ng-click="$parent.close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-change-vehicle="true" model-type="job" ng-model="$parent.job" on-cancel="$parent.show_vehicle()" on-save="$parent.vehicle_changed()" showing="$parent.changing_vehicle" vehicle="$parent.job.vehicle"></div></div></div></div></div></div></div></div></div><div class="row-fluid"><br /><div class="sub-header">Notes</div><ad-notes enable-workshop-only="true" model-type="job" ng-model="job"></ad-notes><hr /></div><div class="row-fluid"><div class="spinner" id="work-spinner"></div><div class="row-fluid"><div class="pull-left"><div class="sub-header">Check Sheet</div></div><div class="pull-right"><span class="goto" ng-click="close_checksheet = true" ng-hide="close_checksheet">Close</span><span class="goto" ng-click="close_checksheet = false" ng-hide="!close_checksheet">Open</span></div></div><div class="row-fluid" ng-hide="close_checksheet"><ul class="work-check-list" id="work-check-list" ng-model="job.works" ui-sortable="work_sortable_options"><li id="work-{{work.id}}" ng-hide="work.editing" ng-repeat="work in job.works"><div class="editable" ng-click="edit_work(work)" ng-show="work.header"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline bold">{{work.title}}</div></div><div ng-hide="work.header"><div class="dragable-handle" tooltip="Drag and drop to re-order">&#58;&#58;&#58;</div><div class="inline work-check"><span>&nbsp;&nbsp;</span><i class="icon-check green pointer" ng-click="toggle_work(work)" ng-show="work.status == &#39;yes&#39;"></i><i class="icon-unchecked pointer" ng-click="toggle_work(work)" ng-show="work.status==&#39;unset&#39;"></i><i class="icon-remove red pointer" ng-click="toggle_work(work)" ng-show="work.status==&#39;no&#39;"></i><i class="icon-exclamation darkorange pointer" ng-click="toggle_work(work)" ng-show="work.status==&#39;cautious&#39;"></i></div><div class="inline work-title editable" ng-click="edit_work(work)"><pre class="no-style">{{work.title}}</pre><div class="work-description" ng-show="work.description"><span>Comment: {{work.description}}</span></div></div></div></li><li id="editing-work" ng-show="editing_work"><div class="row-fluid editing-item" ng-show="editing_work.editing"><form name="work_form" novalidate="true"><div class="error" ng-show="work_form.work_title.$invalid">Work\'s title cannot be empty</div><textarea auto-rows="15" class="span12" name="work_title" ng-model="editing_work.editing.title" required="true" type="text"></textarea><div ng-hide="editing_work.header"><label>Comment</label><textarea auto-rows="15" class="span12" name="work_description" ng-model="editing_work.editing.description" type="text"></textarea></div><div ng-show="editing_work.header &amp;&amp; editing_work.editing.confirm_deletion"><label class="checkbox"><input ng-model="editing_work.editing.delete_children" type="checkbox" />Also Remove items within this header</label></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_work(work_form, editing_work)"><i class="icon-ok"></i><span>Save</span></button><button class="btn" ng-click="cancel_edit_work(editing_work)">Cancel</button><div class="pull-right"><button class="btn btn-danger" ng-click="remove_work(editing_work)"><i class="icon-remove"></i><span>Remove</span></button></div></div></form></div></li></ul><div ng-hide="new_work"><button class="btn btn-link" id="add-checklist-item" ng-click="add_work()">Add Item</button><span>&nbsp;::&nbsp;</span><button class="btn btn-link" ng-click="add_work_header()">Add Header</button><span>&nbsp;::&nbsp;</span><button class="btn btn-link" ng-click="copy_invoice_items_to_job_card()">Copy invoice items</button><div class="pull-right"><div class="btn-group" id="works-more-actions" style="margin-left: 10px"><a class="btn btn-link dropdown-toggle" data-toggle="dropdown" href="#"><span>More Actions</span> <span class="caret"></span></a><ul class="dropdown-menu" style="text-align: left;"><li><button class="btn btn-link" ng-click="bulk_tick_works()">Check all</button></li><li><button class="btn btn-link" ng-click="bulk_remove_works()"><i class="icon icon-remove red"></i><span>Remove all</span></button></li><li><button class="btn btn-link" ng-click="transfer_checksheet()">Transfer to invoice</button></li></ul></div></div></div><br /><br /><div ng-show="job.checksheet_text"><div class="pull-right"><button class="btn btn-link" ng-click="remove_checksheet_text()"><i class="icon icon-remove red"></i>Remove checksheet</button></div><br /><div ng-bind-html-unsafe="job.checksheet_text"></div></div><div ng-show="new_work"><div class="row-fluid editing-item"><form name="new_work_form" novalidate="true"><div class="error" ng-show="new_work_form.work_title.$invalid">Work\'s title cannot be empty</div><textarea auto-rows="15" class="span12" id="new-work-title" name="work_title" ng-model="new_work.title" required="true" select-text="true" type="text"></textarea><div ng-hide="new_work.header"><label>Comment</label><textarea auto-rows="15" class="span12" name="work_description" ng-model="new_work.description" type="text"></textarea></div><button class="btn btn-success" ng-click="save_new_work()"><i class="icon-ok"></i>Save</button><button class="btn" ng-click="cancel_new_work()">Cancel</button></form></div></div><div ng-show="digital_signature_enabled()"><div class="sub-header">Customer Signature {{digital_signature_message()}}</div><div id="customer-sign" ng-show="job.last_signature"><div class="inline">Customer signed at {{job.last_signature.created_at|date:\'mediumTime\'}} on {{job.last_signature.created_at|date: \'fullDate\'}}</div><a ng-href="{{job.last_signature.url}}" style="margin-left: 10px" target="_blank">Signed document</a></div><a class="inline" ng-href="/jobs/{{job.id}}/sign_form" target="_blank">Sign Now</a></div></div></div></div><div class="content-box"><div class="row-fluid"><div class="sub-header">Parts Used/Invoiced Items</div><div ad-invoice-restricted="true" job="job" ng-model="job.invoice" on-oscar-success="oscar_invoice_success()" on-repco-success="repco_invoice_success()"></div></div></div></div><div ng-show="left_side==&#39;work_hours&#39;"><div class="content-box"><div class="row-fluid"><div class="work_hour-check-list" id="work-hour-list"><div class="row-fluid" ng-show="job.work_hours.length &gt; 0"><div class="column span3"><span class="bold">Date</span></div><div class="column span3"><span class="bold">Mechanic</span></div><div class="column span2"><span class="bold">Started</span></div><div class="column span2"><span class="bold">Ended</span></div><div class="column span2"><span class="bold">Total</span></div></div><div id="work-hour-{{work_hour.id}}" ng-repeat="work_hour in job.work_hours"><div ng-hide="work_hour.editing"><div ng-class="{&#39;editable&#39;: work_hour_editable(work_hour)}" ng-click="work_hour_editable(work_hour) &amp;&amp; edit_work_hour(work_hour)"><div class="row-fluid" tooltip="{{work_hour.display_description}}"><div class="column span3"><span>{{work_hour.started_at|date: \'mediumDate\'}}</span></div><div class="column span3"><span>{{work_hour.employee.name}}</span><span class="orange" ng-show="work_hour.overtime">(ot)</span></div><div class="column span2"><span>{{work_hour.started_at|date: \'H:mm\'}}</span></div><div class="column span2"><span>{{work_hour.ended_at|date: \'H:mm\'}}</span></div><div class="column span2"><span ng-show="work_hour.hour &amp;&amp; work_hour.hour &gt; 0">{{work_hour.hour}} h</span><span ng-hide="work_hour.ended_at">&nbsp;<span class="label label-info" tooltip="In Progress">In Progress</span></span><span ng-show="work_hour.no_charge">&nbsp;<span class="label label-warning" tooltip="Internal work, no charge out">I</span></span><div class="pull-right"><span ng-show="work_hour.display_description" title="{{work_hour.display_description}}">...</span></div></div></div></div></div></div><div class="row-fluid editing-item" id="editing-work-hour" ng-show="editing_work_hour.editing"><form name="work_hour_form" novalidate="true"><div class="row-fluid"><div class="column span3"><div>Date</div><ad-datepicker ng-model="editing_work_hour.editing.started_at"></ad-datepicker></div><div class="column span3"><div>Start</div><ad-timepicker ng-model="editing_work_hour.editing.started_at" on-select="update_duration(editing_work_hour.editing)"></ad-timepicker></div><div class="column span3"><div>End</div><ad-timepicker ng-model="editing_work_hour.editing.ended_at" on-select="update_duration(editing_work_hour.editing)"></ad-timepicker></div><div class="column span3"><div>Total (hour)</div><input class="input-tiny" ng-change="update_ended_at(editing_work_hour.editing)" ng-model="editing_work_hour.editing.hour" step="any" type="number" /></div></div><div class="row-fluid"><div class="column span6"><div ng-show="can_assign_employee()"><div>Mechanic</div><select class="inline" name="employee" ng-change="select_work_hour_employee(editing_work_hour.editing)" ng-model="editing_work_hour.editing.employee_id" ng-options="employee.id as employee.name for employee in employees()" required="true"><option value=""></option></select></div></div><div class="column span6" ng-show="allow_invoice_item_on_timesheet()"><label>Related Invoice Item</label><select class="inline" name="employ_item_id" ng-model="editing_work_hour.editing.invoice_item_id" ng-options="item.id as item.description for item in selectable_items()"><option value=""></option></select></div></div><div class="row-fluid"> <label class="inline">Comment/Note:</label><textarea class="span12" id="new-work_hour-description" name="work_hour_description" ng-model="editing_work_hour.editing.description"></textarea></div><div class="row-fluid"><label class="checkbox"><input ng-model="editing_work_hour.editing.overtime" type="checkbox" /><span>Overtime</span></label></div><div class="row-fluid"><label class="checkbox"><input ng-model="editing_work_hour.editing.no_charge" type="checkbox" /><span>Internal, No charge-out</span></label><br /></div><div class="row-fluid"><div class="pull-left"><button class="btn btn-success" ng-click="save_work_hour(work_hour_form)"><i class="icon-ok"></i><span>Save</span></button><button class="btn" ng-click="cancel_edit_work_hour(editing_work_hour)">Cancel</button></div><div class="pull-right"><button class="btn btn-danger" ng-click="remove_work_hour(editing_work_hour)"><i class="icon-remove"></i><span>Remove</span></button></div></div></form></div></div><div class="editing-item" ng-show="new_work_hour"><form name="new_work_hour_form" novalidate="true"><div class="row-fluid"><div class="column span3"><div>Date</div><ad-datepicker ng-model="new_work_hour.started_at" on-select="update_duration(new_work_hour)"></ad-datepicker></div><div class="column span3"><div>Start</div><ad-timepicker ng-model="new_work_hour.started_at" on-select="update_duration(new_work_hour)"></ad-timepicker></div><div class="column span3"><div>End</div><ad-timepicker ng-model="new_work_hour.ended_at" on-select="update_duration(new_work_hour)"></ad-timepicker></div><div class="column span3"><label>Total (hour)</label><input class="input-tiny" ng-change="update_ended_at(new_work_hour)" ng-model="new_work_hour.hour" step="any" type="number" /></div></div><div class="row-fluid"><div class="column span6"><div ng-show="can_assign_employee()"><label>Mechanic</label><select class="inline" name="employee" ng-change="select_work_hour_employee(new_work_hour)" ng-model="new_work_hour.employee_id" ng-options="employee.id as employee.name for employee in employees()"><option value=""></option></select></div></div><div class="column span6" ng-show="allow_invoice_item_on_timesheet()"><div><label>Related Invoice Item</label><select class="inline" name="employ_item_id" ng-model="new_work_hour.invoice_item_id" ng-options="item.id as item.description for item in selectable_items()"><option value=""></option></select></div></div></div><div class="row-fluid"> <label class="inline">Comment/Note:</label><textarea class="span12" id="new-work_hour-description" name="work_hour_description" ng-model="new_work_hour.description"></textarea></div><div class="row-fluid"><label class="checkbox"><input ng-model="new_work_hour.overtime" type="checkbox" /><span>Overtime</span></label></div><div class="row-fluid"><label class="checkbox"><input ng-model="new_work_hour.no_charge" type="checkbox" /><span>Internal, No charge-out</span></label><br /></div><div class="row-fluid"><button class="btn btn-success" ng-click="save_new_work_hour()"><i class="icon-ok"></i>Save</button><button class="btn btn-success" ng-click="save_new_work_hour(true)"><i class="icon-plus"></i>Save And New</button><button class="btn" ng-click="cancel_new_work_hour()">Cancel</button></div></form></div><div class="row-fluid"><div class="column span10 text-align-right bold">Total:</div><div class="column span2">{{total_work_hours()}} h</div></div><hr /><div class="row-fluid"><div class="pull-left" ng-hide="new_work_hour"><button class="btn btn-link" ng-click="add_work_hour()">Add</button></div><div class="pull-right" ng-show="job.work_hours.length &gt; 0"><div class="spinner" id="transfer-work-hours-spinner"></div><div class="btn-group" style="margin-left: 10px"><a class="btn btn-link dropdown-toggle" data-toggle="dropdown" href="#"><span>Transfer to invoice</span> <span class="caret"></span></a><ul class="dropdown-menu" style="text-align: left;"><li><button class="btn btn-link" ng-click="transfer_work_hours(&#39;as_one_line_item&#39;)">Transfer as one line</button></li><li><button class="btn btn-link" ng-click="transfer_work_hours(&#39;per_employee&#39;)">Transfer per employee</button></li><li><button class="btn btn-link" ng-click="transfer_work_hours(&#39;as_one_line_per_item&#39;)">Transfer one line per item</button></li></ul></div></div></div></div></div></div><div ng-show="left_side==&#39;files&#39;"><div class="content-box"><div class="row-fluid"><div class="sub-header"><div class="inline" id="job-photos">Photos/Documents</div><div class="pull-right" ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_job_files()">Upload</button></div></div><div class="job-files" ng-hide="uploading_files"><div class="pull-right"></div><div class="inline job-photo" ng-repeat="photo in job.photos" style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><div ng-show="job.documents.length &gt; 0"><div class="bold">Documents</div><div ng-repeat="document in job.documents"><div class="editable" ng-click="edit_file(document)" ng-hide="document.editing"><span>{{document.file_name}} &nbsp;</span><a ng-href="{{document.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="document.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="document.editing.file_name" type="text" /></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(document)">Save</button><button class="btn" ng-click="cancel_edit_file(document)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(document)">Remove</button></div></form></div></div></div></div><div id="photo-viewer"><div class="popover fade right in" style="width: 800px; height: 1000px"><div class="popover-title"><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="full_size_photo()">Full Size</button><button class="btn btn-primary" ng-click="close_photo_viewer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div style="height: 750px"><carousel><slide active="photo.active" ng-repeat="photo in job.photos"><img ng-src="{{photo.url}}" style="margin:auto; max-width: 100%; max-height:750px;" /></slide></carousel></div></div><div class="row-fluid"><center><div class="inline job-photo" ng-class="{&#39;job-photo-active&#39;: photo.active}" ng-repeat="photo in job.photos"><div style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><button class="btn btn-danger" ng-click="remove_photo(photo)" ng-show="photo.active">Remove</button></div></center></div></div></div></div><form action="/jobs/{{job.id}}/upload_files" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /></div><br /><div class="inline" id="upload-photos-spinner"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form></div></div></div></div><div id="sub-jobs-list"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="pull-right"><button class="btn btn-primary" ng-click="close_sub_jobs_list()"><i class="icon icon-remove"></i> <span>Close</span></button></div><div class="sub-header">Sub Job List</div></div><div class="popover-content"><div class="content-box"><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span3">Job No.</div><div class="column span3">Vehicle</div><div class="column span6">Description</div></div></th></tr></thead><tbody><tr ng-repeat="sub_job in job.sub_jobs"><td><a class="goto" ng-href="#/jobs/{{sub_job.id}}"><div class="row-fluid"><div class="column span3">{{sub_job.number}}</div><div class="column span3">{{sub_job.vehicle|vehicle_title}}</div><div class="column span6">{{sub_job.full_description}}</div></div></a></td></tr></tbody></table></div><button class="btn btn-primary" ng-click="close_sub_jobs_list()"><i class="icon icon-remove"></i> <span>Close</span></button></div></div></div><div id="add-existing-sub-job"><div class="popover fade right in" style="width: 800px"><div class="popover-title"><div class="sub-header">Add sub job</div></div><div class="popover-content"><div class="content-box"><div>Select a job to add as sub job</div><div ad-jobpicker="true" job="existing_sub_job" ng-model="existing_sub_job.id"></div></div><div class="buttons"><button class="btn btn-success" ng-click="add_sub_job()">Add Sub Job</button><button class="btn" ng-click="hide_add_existing_sub_job()">Cancel</button><div class="spinner" id="adding-existing-sub-job"></div></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("mapp/stocks/index.html",'<div ng-controller="StocksController"><div class="page-header">Stocks<div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="search-description" ng-show="keyword">Search "{{keyword}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="spinner" id="stock-list-spinner"></div><div class="content-box"><table class="table table-striped"><thead><tr><th><div class="row-fluid"><div class="column span2 column-sortable" ng-click="sort(&#39;stock_number&#39;)" style="min-width: 150px">Stock No#</div><div class="column span2 column-sortable" ng-click="sort(&#39;name&#39;)">Name</div><div class="column span2 column-sortable">Category</div><div class="column span3 column-sortable" ng-click="sort(&#39;brand&#39;)">Brand/Model/Size</div><div class="column span1">Location</div><div class="column span1 column-sortable" ng-click="sort(&#39;quantity&#39;)">Qty.</div><div class="column span1"><div>Price</div><div>(Incl. {{tax_name()}})</div></div></div></th></tr></thead><tbody><tr ng-repeat="stock in stocks"><td><div class="row-fluid"><div class="column span2">{{stock.stock_number}}</div><div class="column span2">{{stock.name}}</div><div class="column span2">{{stock.stock_category.name}}</div><div class="column span3">{{stock.brand}} {{stock.model}} {{stock.size}}</div><div class="column span1">{{stock.location}}</div><div class="column span1">{{stock.quantity}}</div><div class="column span1">{{stock.sell_price_included_gst|currency}}</div></div></td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("messages/index.html",'<div ng-controller="MessagesController"><ul class="sub-nav" ng-controller="CustomersNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">Messages<div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="search-description" ng-show="keyword">Search "{{query}}"</div><div class="row-fluid"><div class="column span6"><div class="content-box"><div class="spinner" id="emails-spinner"></div><div class="sub-header">Emails</div><table class="table table-striped" style="word-break: break-all;"><thead><tr><th><div class="inline" style="width: 18%">Date</div><div class="inline" style="width: 52%">Sent To</div><div class="inline" style="width: 30%">Status</div></th></tr></thead><tbody><tr ng-repeat="email in emails"><td><div class="italic"><div class="inline" style="width: 18%"><div>{{email.created_at|date: \'shortDate\'}}</div><div>{{email.created_at|date: \'shortTime\'}}</div></div><div class="inline" style="width: 52%"><div class="truncate">{{email.to}}</div><div>{{email.customer.name}}</div></div><div class="inline text-align-right" style="width: 30%">{{email.status}}</div></div><br /><div><div class="italic" ng-show="email.employee">Sent by {{email.employee.name}}</div><div class="bold">Subject: {{email.subject}}</div><br /><pre class="no-style">{{email.message}}</pre></div></td></tr></tbody></table><pagination boundary-links="true" current-page="email_page_number" max-size="15" num-pages="email_total_pages" on-select-page="fetch_emails(page)" rotate="false"></pagination></div></div><div class="column span6"><div class="content-box"><div class="spinner" id="sms-spinner"></div><div class="sub-header">SMS<div class="pull-right"><span class="bold">Balance: {{sms_unpaid_amount|currency}}</span></div></div><table class="table table-striped" style="word-break: break-word;"><thead><tr><th><div class="inline" style="width: 18%">Date</div><div class="inline" style="width: 42%">Sent To</div><div class="inline" style="width: 20%">Status</div><div class="inline" style="width: 20%">Billing Status</div></th></tr></thead><tbody><tr ng-repeat="sms in smses"><td><div class="italic"><div class="inline" style="width: 18%"><div>{{sms.created_at|date: \'shortDate\'}}</div><div>{{sms.created_at|date: \'shortTime\'}}</div></div><div class="inline" style="width: 42%"><div>{{sms.to|comma_seperated}}</div><div>{{sms.customer.name}}</div></div><div class="inline" style="width: 20%">{{sms.status}}</div><div class="inline" style="width: 20%">{{sms.billing_status}}</div></div><br /><div><div class="bold" ng-show="failed_reason">{{sms.failed_reason}}</div><pre class="no-style">{{sms.message}}</pre></div></td></tr></tbody></table><pagination boundary-links="true" current-page="sms_page_number" max-size="15" num-pages="sms_total_pages" on-select-page="fetch_sms(page)" rotate="false"></pagination></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("notifications/index.html",'<div ng-controller="NotificationsController"><div class="tab-content"><div class="tab-pane active" id="#/notifications"><div class="page-header">Notifications<div class="pull-right"><button class="btn" ng-click="bulk_print()"><i class="icon icon-printer"></i><span>Print</span></button><button class="btn" ng-click="bulk_read()">Mark as read</button><button class="btn btn-danger" ng-click="bulk_delete()">Delete</button></div></div><div class="spinner" id="notification-spinner"></div><div class="content-box"><table class="table table-striped"><tbody><tr ng-show="notifications.length &gt; 0"><td colspan="2"><label class="checkbox"><input ng-click="toggle_select_all()" type="checkbox">Select All</input></label></td></tr><tr ng-repeat="notification in notifications"><td style="width: 80%"><label class="checkbox"><input check-list="ids" type="checkbox" value="{{notification.id}}" /><a href="#/notifications/{{notification.id}}" ng-class="{bold: !notification.read, italic: !notification.read}">{{notification.title}}</a></label></td><td>{{notification.updated_at | date: \'short\'}}</td></tr></tbody></table></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("notifications/notification.html",'<hr /><br /><pre class="no-style" ng-bind-html-unsafe="notification.data"></pre>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("notifications/show.html",'<div ng-controller="ShowNotificationController"><div class="tab-content"><div class="tab-pane active"><div class="page-header">{{notification.title}}<div class="pull-right"><a class="btn" href="#/notifications"><i class="icon-arrow-left"></i>Back</a></div></div><div ng-switch="notification_template"><div ng-include="&#39;notifications/&#39; + notification_template"></div></div></div></div><div id="image-lightbox"><div class="popover fade left in" style="width: 600px"><div class="popover-title"></div><div class="popover-content"><img ng-href="{{showing_image_path}}" /></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("notifications/software_update.html",'<div><b>If you have any concern about this update please send us an email at support@mechanicdesk.com.au</b></div><hr /><br /><div ng-bind-html-unsafe="notification.software_update.content"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("notifications/welcome.html",'<div class="content-box welcome-notification" ng-controller="WelcomeNotificationController"><p>Welcome to MechanicDesk, we hope to bring to you the best workshop management platform.</p><p>Your auto workshop id is &nbsp;<span class="label-strong">{{session.auto_workshop_id}}</span>, Your username is &nbsp;<span class="label-strong">{{session.username}}</span>&nbsp; and your password is the one with which you registered.<br>Please remember this information as you will need it to login.</br></p><div ng-hide="completed()"><p>Please add some basic information about your workshop using the form below</p><form class="form-horizontal" name="setup_autoworkshop"><div class="control-group"><label class="control-label">Name</label><div class="controls"><input class="input-xlarge" ng-model="auto_workshop.editing.name" type="text" /><span class="warning" ng-hide="auto_workshop.editing.name">Please provide a name</span></div></div><div class="control-group"><label class="control-label">Business Name</label><div class="controls"><input class="input-xlarge" ng-model="auto_workshop.editing.registered_name" type="text" /><span class="warning" ng-hide="auto_workshop.editing.registered_name">Please provide a Business Name</span></div></div><div class="control-group" ng-show="country() == &#39;au&#39;"><label class="control-label">ABN</label><div class="controls"><input ng-model="auto_workshop.editing.abn" type="text" /></div></div><div class="control-group" ng-show="country() == &#39;au&#39;"><label class="control-label">ACN</label><div class="controls"><input ng-model="auto_workshop.editing.acn" type="text" /></div></div><div class="control-group" ng-show="country() == &#39;nz&#39;"><label class="control-label">{{tax_name()}} Reg. No#</label><div class="controls"><input ng-model="auto_workshop.editing.registration_number" type="text" /></div></div><div class="control-group"><label class="control-label">Phone</label><div class="controls"><div class="warning" ng-hide="auto_workshop.editing.phone">Please provide the phone number</div><input ng-model="auto_workshop.editing.phone" type="text" /></div></div><div class="control-group"><label class="control-label">Fax</label><div class="controls"><input ng-model="auto_workshop.editing.fax" type="text" /></div></div><div class="control-group"><label></label><div class="controls"><div class="warning" ng-hide="auto_workshop.editing.address.street_line">Please provide the address</div></div></div><addresspicker ng-model="auto_workshop.editing.address"></addresspicker><div class="control-group"><label class="control-label">Next Invoice Number</label><div class="controls"><div class="error" ng-show="auto_workshop.editing.errors">{{auto_workshop.editing.errors.next_invoice_number|error}}</div><input ng-model="auto_workshop.editing.next_invoice_number" type="number" /></div></div><div class="control-group"><label class="control-label">Invoice template</label><div class="controls"><div style="padding-top: 5px;"><span>{{auto_workshop.invoice_template}}</span><span>&nbsp;</span><a ng-click="select_invoice_template()">Select</a><div class="row-fluid"><div class="pull-right"><div id="select-invoice-template-link"></div><div ad-select-invoice-template="true" anchor-element="#select-invoice-template-link" ng-model="auto_workshop" showing="selecting_invoice_template" templates="invoice_templates"></div></div></div></div></div></div><div class="control-group"><label></label><div class="controls"><button class="btn btn-success" ng-click="setup_auto_workshop()">Save</button></div></div></form></div><div ng-show="completed()"><div>Your auto workshop has been successfully setup.<br />You can make futher changes by going to &nbsp;<a href="#/auto_workshop_details">Settings</a>&nbsp; on the top menu. For now we recommend that you have a look at the &nbsp;<a href="#/helps">Help</a>&nbsp; section for more information about the system.</div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("payments/details.html",'<div class="sub-header">Payment Details</div><div class="info" ng-show="payment.original_payment_id"><a ng-href="#/payments/{{payment.original_payment_id}}">Original Payment</a></div><div class="info" ng-show="payment.credit_note_id"><a ng-href="#/credit_notes/{{payment.credit_note_id}}">Original Credit Note</a></div><br /><div class="editable" ng-click="edit_payment()" ng-hide="payment.editing"><div class="info"><label class="label-name-left auto-width">Customer:</label><span>{{payment.customer.name}}</span></div><div class="info"><label class="label-name-left auto-width">Reference:</label><span>{{payment.reference}}</span></div><div class="info"><label class="label-name-left auto-width">Date:</label><span>{{payment.date | date: \'mediumDate\'}}</span></div><div class="info"><label class="label-name-left auto-width">Amount:</label><span class="bold">{{payment.amount|currency}}</span></div><div class="info"><label class="label-name-left auto-width">Payment Type:</label><span>{{payment.payment_type_name}}</span></div><div class="info" ng-show="payment.accounting_account_id"><label class="label-name-left auto-width">Account:</label><span class="bold">{{payment.accounting_account.title}}</span></div><div class="info" ng-show="payment.invoice_id"><label class="label-name-left auto-width">Paid Invoice:</label><span><a ng-href="#/invoices/{{payment.invoice_id}}" stop-event="click" target="_blank">Invoice #{{payment.invoice.number}} - {{payment.invoice.description}}</a></span></div><div class="info" ng-show="payment.created_by"><label class="label-name-left auto-width">Entered By:</label><span>{{payment.created_by.name}}</span></div><div class="info"><label class="label-name-left auto-width">Unallocated Amount:</label><span class="bold">{{payment.unallocated_amount|currency}}</span><div class="inline red" ng-show="payment.unallocated_amount &lt; 0">&nbsp; Total Allocation is more than the payment\'s amount. Please review</div></div><div class="info" ng-show="payment.payment_allocations"></div></div><div class="editing-item" ng-show="payment.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Customer</label><div class="controls"><span>{{payment.customer.name}}</span></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><div class="input-append"><input ng-model="payment.editing.reference" type="text" /></div></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="payment.editing.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Payment Type</label><div class="controls"><select ng-model="payment.editing.payment_method_id" ng-options="pt.id as pt.name for pt in payment_methods" type="text"></select><button class="btn btn-link" ng-click="choose_specific_bank_account = true" ng-show="bank_accounts().length &gt; 1 &amp;&amp; !payment.accounting_account_id">Select specific bank account</button></div></div><div class="control-group" ng-show="show_select_bank_account() || choose_specific_bank_account"><label class="control-label">Payment Account</label><div class="controls"><div accounts="bank_accounts()" ad-accounting-account-picker="true" ng-model="payment.editing.accounting_account_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_payment()">Save</button><button class="btn" ng-click="cancel_edit_payment()">Cancel</button></div></div></form></div><br /><div ad-notes="true" model-type="payment" ng-model="payment"></div><br /><div ng-hide="payment.invoice_id"><div ng-hide="payment.finalized"><span class="label label-info">In progress</span><button class="btn btn-link" ng-click="finalize()">Finalize</button></div><div ng-show="payment.finalized"><span class="label label-success">Finalized</span></div><div></div></div><hr /><table class="table table-striped" ng-show="payment.allocated_payments.length &gt; 0"><thead><tr><th>Invoice No#</th><th>Date</th><th>Amount</th><th>Allocated Amount</th><th class="actions"></th></tr></thead><tbody><tr ng-repeat="bpayment in payment.allocated_payments"><td>{{bpayment.invoice.number}}</td><td>{{bpayment.invoice.issue_date|date:\'mediumDate\'}}</td><td>{{bpayment.invoice.total_amount|currency}}</td><td>{{bpayment.amount|currency}}</td><td><div class="pull-right"><a ng-href="#/invoices/{{bpayment.invoice.id}}" stop-event="click">Invoice details</a><span>&nbsp;::&nbsp;</span><a class="red" href="javascript:void(0);" ng-click="remove_bpayment(bpayment)"><i class="icon icon-remove"></i><span>Remove</span></a></div></td></tr></tbody></table><a href="javascript:void(0);" id="add-invoices-button" ng-click="add_invoices()" ng-show="payment.unallocated_amount &gt; 0 &amp;&amp; !payment.original_payment_id">Allocate to invoices</a><div ad-invoice-selection="true" anchor-element="#add-invoices-button" available-amount="payment.unallocated_amount" customer="payment.customer" on-select="save_selected_invoices()" placement="right" selection="selected_invoices" showing="showing_related_invoices"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("payments/index.html",'<div ng-controller="PaymentsController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="page-header">Customer Payments<div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="row-fluid"><div class="pull-right"><a class="btn btn-primary" ng-href="#/payments/new"><span>New Payment</span></a></div></div><br /></div><div class="search-description" ng-show="keyword">Search "{{keyword}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="spinner" id="payments-spinner"></div><div class="row-fluid"><label class="checkbox"><input ng-click="search()" ng-model="query.unallocated" type="checkbox" /><span>Show</span> <span class="label label-info">Unallocated</span> <span>Payments Only</span></label><label class="checkbox"><input ng-click="search()" ng-model="query.deleted" type="checkbox" /><span>Show</span> <span class="label">Deleted</span> <span>Payments Only</span></label></div><div class="content-box"><table class="table table-striped" ng-show="query.deleted"><thead><tr><th>Payment No.#</th><th>Date</th><th>Customer</th><th>Received Amount</th><th>Payment Type</th><th>Reference</th><th>Invoice No.#</th><th>Deleted By</th><th>Delete Reason</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/payments/&#39; + payment.id)" ng-repeat="payment in payments"><td><div>#{{payment.number}}</div> <div class="label label-info" ng-show="payment.original_payment_id || payment.credit_note_id">Payment Allocation</div></td><td>{{payment.date |date: \'shortDate\'}}</td><td>{{payment.customer.name}}</td><td>{{payment.amount|currency}}</td><td>{{payment.payment_type_name}}</td><td>{{payment.reference}}</td><td>{{payment.invoice.number}}</td><td>{{payment.deleted_by.name}}</td><td>{{payment.deleted_reason}}</td></tr></tbody></table><table class="table table-striped" ng-hide="query.deleted"><thead><tr><th>Payment No.#</th><th>Date</th><th>Customer</th><th>Received Amount</th><th>Allocated</th><th>Remaining</th><th>Payment Type</th><th>Reference</th><th>Invoice No.#</th><th>Entered By</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/payments/&#39; + payment.id)" ng-repeat="payment in payments"><td><div>#{{payment.number}}</div> <div class="label label-info" ng-show="payment.original_payment_id || payment.credit_note_id">Payment Allocation</div></td><td>{{payment.date |date: \'shortDate\'}}</td><td>{{payment.customer.name}}</td><td>{{payment.amount|currency}}</td><td>{{payment.allocated_amount|currency}}</td><td>{{payment.unallocated_amount|currency}}</td><td>{{payment.payment_type_name}}</td><td>{{payment.reference}}</td><td>{{payment.invoice.number}}</td><td>{{payment.created_by.name}}</td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("payments/new.html",'<div ng-controller="NewPaymentController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">New Payment</div><div class="row-fluid"><div class="content-box"><form autocomplete="off" class="form-horizontal"><div class="control-group"><div class="controls"><div ad-credit-note-available="" showing="credit_available" transactions="transactions"></div></div></div><div class="control-group"><label class="control-label">Customer</label><div class="controls"><div customer="selected_customer" customerpicker="true" on-select="select_customer()" with-balances="true"></div></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><input ng-model="payment.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="payment.date"><span class="add-on"><i class="icon-calendar"></i></span></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><div class="input-append"><input class="input-small" ng-model="payment.amount" type="text" /></div></div></div><div class="control-group"><label class="control-label">Payment Type</label><div class="controls"><select ng-model="payment.payment_method_id" ng-options="pt.id as pt.name for pt in payment_methods" type="text"></select><button class="btn btn-link" ng-click="choose_specific_bank_account = true" ng-show="show_select_bank_account()">Select specific bank account</button></div></div><div class="control-group" ng-show="show_select_bank_account() &amp;&amp; choose_specific_bank_account"><label class="control-label">Payment Account</label><div class="controls"><div accounts="bank_accounts()" ad-accounting-account-picker="true" ng-model="payment.accounting_account_id"></div></div></div><br /><br /><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_payment()">Continue</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="saving-payment"></div></div></div></form></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("payments/show.html",'<div ng-controller="ShowPaymentController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div ng-hide="payment &amp;&amp; payment.id"><div class="spinner" id="payment-loading"></div></div><div ng-show="payment &amp;&amp; payment.id"><div class="deleted-sign" ng-show="payment.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><div class="row-fluid"><div class="page-header">Payment #{{payment.number}}</div></div><div class="row-fluid"><div class="pull-right"><button class="btn" id="send-payment" ng-click="open_email_payment()" ng-hide="payment.deleted" target="_blank"><i class="icon icon-envelop"></i><span>Send Receipt</span></button><a class="btn" ng-hide="payment.deleted" ng-href="/payments/{{payment.id}}/print.pdf" target="_blank"><i class="icon icon-print"></i><span>Print Receipt</span></a><button class="btn btn-danger" ng-click="open_delete_dialog()" ng-hide="payment.deleted || restricted_to(&#39;enter_payments&#39;, &#39;deletion&#39;)">Delete</button></div></div><br /><div class="row-fluid"><div class="content-box"><div class="sub-header">Payment Details</div><div class="info" ng-show="payment.original_payment_id"><a ng-href="#/payments/{{payment.original_payment_id}}">Original Payment</a></div><div class="info" ng-show="payment.credit_note_id"><a ng-href="#/credit_notes/{{payment.credit_note_id}}">Original Credit Note</a></div><br /><div class="editable" ng-click="edit_payment()" ng-hide="payment.editing"><div class="info"><label class="label-name-left auto-width">Customer:</label><span>{{payment.customer.name}}</span></div><div class="info"><label class="label-name-left auto-width">Reference:</label><span>{{payment.reference}}</span></div><div class="info"><label class="label-name-left auto-width">Date:</label><span>{{payment.date | date: \'mediumDate\'}}</span></div><div class="info"><label class="label-name-left auto-width">Amount:</label><span class="bold">{{payment.amount|currency}}</span></div><div class="info"><label class="label-name-left auto-width">Payment Type:</label><span>{{payment.payment_type_name}}</span></div><div class="info" ng-show="payment.accounting_account_id"><label class="label-name-left auto-width">Account:</label><span class="bold">{{payment.accounting_account.title}}</span></div><div class="info" ng-show="payment.invoice_id"><label class="label-name-left auto-width">Paid Invoice:</label><span><a ng-href="#/invoices/{{payment.invoice_id}}" stop-event="click" target="_blank">Invoice #{{payment.invoice.number}} - {{payment.invoice.description}}</a></span></div><div class="info" ng-show="payment.created_by"><label class="label-name-left auto-width">Entered By:</label><span>{{payment.created_by.name}}</span></div><div class="info"><label class="label-name-left auto-width">Unallocated Amount:</label><span class="bold">{{payment.unallocated_amount|currency}}</span><div class="inline red" ng-show="payment.unallocated_amount &lt; 0">&nbsp; Total Allocation is more than the payment\'s amount. Please review</div></div><div class="info" ng-show="payment.payment_allocations"></div></div><div class="editing-item" ng-show="payment.editing"><form class="form-horizontal"><div class="control-group"><label class="control-label">Customer</label><div class="controls"><span>{{payment.customer.name}}</span></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><div class="input-append"><input ng-model="payment.editing.reference" type="text" /></div></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="payment.editing.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Payment Type</label><div class="controls"><select ng-model="payment.editing.payment_method_id" ng-options="pt.id as pt.name for pt in payment_methods" type="text"></select><button class="btn btn-link" ng-click="choose_specific_bank_account = true" ng-show="bank_accounts().length &gt; 1 &amp;&amp; !payment.accounting_account_id">Select specific bank account</button></div></div><div class="control-group" ng-show="show_select_bank_account() || choose_specific_bank_account"><label class="control-label">Payment Account</label><div class="controls"><div accounts="bank_accounts()" ad-accounting-account-picker="true" ng-model="payment.editing.accounting_account_id"></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_payment()">Save</button><button class="btn" ng-click="cancel_edit_payment()">Cancel</button></div></div></form></div><br /><div ad-notes="true" model-type="payment" ng-model="payment"></div><br /><div ng-hide="payment.invoice_id"><div ng-hide="payment.finalized"><span class="label label-info">In progress</span><button class="btn btn-link" ng-click="finalize()">Finalize</button></div><div ng-show="payment.finalized"><span class="label label-success">Finalized</span></div><div></div></div><hr /><table class="table table-striped" ng-show="payment.allocated_payments.length &gt; 0"><thead><tr><th>Invoice No#</th><th>Date</th><th>Amount</th><th>Allocated Amount</th><th class="actions"></th></tr></thead><tbody><tr ng-repeat="bpayment in payment.allocated_payments"><td>{{bpayment.invoice.number}}</td><td>{{bpayment.invoice.issue_date|date:\'mediumDate\'}}</td><td>{{bpayment.invoice.total_amount|currency}}</td><td>{{bpayment.amount|currency}}</td><td><div class="pull-right"><a ng-href="#/invoices/{{bpayment.invoice.id}}" stop-event="click">Invoice details</a><span>&nbsp;::&nbsp;</span><a class="red" href="javascript:void(0);" ng-click="remove_bpayment(bpayment)"><i class="icon icon-remove"></i><span>Remove</span></a></div></td></tr></tbody></table><a href="javascript:void(0);" id="add-invoices-button" ng-click="add_invoices()" ng-show="payment.unallocated_amount &gt; 0 &amp;&amp; !payment.original_payment_id">Allocate to invoices</a><div ad-invoice-selection="true" anchor-element="#add-invoices-button" available-amount="payment.unallocated_amount" customer="payment.customer" on-select="save_selected_invoices()" placement="right" selection="selected_invoices" showing="showing_related_invoices"></div></div><div class="content-box" ng-show="payment.remote_id"><div class="sub-header">Accounting Integration</div><div>Synced To ID {{payment.remote_id}}</div><div ng-show="payment.remote_url"><span>Please click </span> <a ng-href="{{payment.remote_url}}" target="_blank">Here</a> <span>to access the payment in Accounting Software</span></div></div></div><div modal="showing_delete_payment_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete This Payment</h3></div><div class="modal-body"><div>Are you sure you want to delete this payment?</div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_payment()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_payment()">Cancel</button><div class="spinner" id="delete-payment-spinner"></div></div></div><div id="payment-send-email"><div class="popover fade left in" style="width: 400px"><div class="popover-title"><div class="sub-header">Send Email</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form><div class="pull-right"><div class="inline" id="payment-send-email-spinner"></div></div><label>Email</label><input class="span12" id="payment-send-email-address" ng-model="email_payment_to" type="text" /><label>Subject</label><input class="span12" id="payment-send-email-address" ng-model="email_payment_subject" type="text" /><label>Message</label><textarea class="span12" id="payment-send-email-message" ng-model="email_payment_message" rows="4" type="text"></textarea><div><button class="btn btn-success" ng-click="email_payment()">Send</button><button class="btn" ng-click="cancel_email_payment()">Cancel</button></div></form></div></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("pos/index.html",'<div ng-controller="PosController"><div class="row-fluid no-print"><div class="column span7"><div class="content-box"><div class="row-fluid"><div class="inline"><div class="inline bold">Customer(Optional):</div> <div customer="customer" customerpicker="true" on-select="check_credit_limit()" with-balances="true"></div><div>Source Of Business</div> <div businesssourcepicker="true" ng-model="invoice.business_source_id"></div><div ng-show="allow_salesperson_selection_on_pos()"><div>Salesperson</div> <select ng-model="invoice.employee_id" ng-options="employee.id as employee.name for employee in employees()"></select></div></div><div class="pull-right"><label class="checkbox"><input ng-click="toggle_normal_invoice_for_pos()" ng-model="use_normal_invoice_for_pos" type="checkbox" /><span class="bold">Use A4 Invoice Template</span></label></div></div><hr /><table class="table table-striped" style="width: 100%"><thead><tr style="width: 100%"><th style="width: 100%"><div class="pos-item-description">Item</div><div class="pos-item-quantity">Qty.</div><div class="pos-item-price"><div>Price</div><div>(tax inc.)</div></div><div class="pos-item-total">Total</div><div class="pos-item-action"></div></th></tr></thead><tbody><tr style="width: 100%"><td style="width: 100%"><form autocomplete="off" class="form-inline"><div class="pos-item-description"><div class="input-append"><input autocomplete="off" class="span12" enable-submit="true" id="new-invoice-item-description" name="description" ng-maxlength="255" ng-model="new_invoice_item.description" required="true" type="text" typeahead="item.lookup_text for item in lookup_items($viewValue)" typeahead-on-select="select_item($item, $model, $label, selected_item)" typeahead-wait-ms="300" /><span class="add-on"><i class="icon icon-search" id="pos-lookup-item-icon"></i><div class="spinner spinner-small" id="pos-lookup-item-spinner"></div></span></div></div><div class="pos-item-quantity"><input class="span12" ng-model="new_invoice_item.quantity" step="any" type="number" /></div><div class="pos-item-price"><input class="span12" ng-model="new_invoice_item.unit_price" step="any" type="number" /><div ng-show="new_invoice_item.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices  </span> <i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in new_invoice_item.prices"><a href="javascript:void(0);" ng-click="select_price_level(price)"><span>{{price|currency}}</span></a></li></ul></div></div></div><div class="pos-item-total text-align-right"><span>{{item_total_amount(new_invoice_item).round(2) | currency}}</span></div><div class="pull-right"><button class="inline btn btn-primary" ng-click="add_invoice_item()" style="margin-left: 20px; vertical-align: top" type="submit">Add</button></div></form></td></tr><tr ng-repeat="item in invoice.items" style="width: 100%"><td style="width: 100%"><div class="pos-item-description"><div class="inline" ng-show="item.looking_up"><img src="/assets/littlespinner-b053f26fde4de42a09c6c20272ce08ba.gif" /></div><span>{{item.description}}</span></div><div class="pos-item-quantity">{{item.quantity}}</div><div class="pos-item-price">{{item.unit_price|currency}}</div><div class="pos-item-total">{{item_total_amount(item)|currency}}</div><div class="pull-right"><i class="red icon icon-remove goto" ng-click="remove_item(item)"></i></div></td></tr><tr style="width: 100%"><td style="width: 100%"><div class="pos-item-description"><textarea class="span12" ng-model="invoice.details" ng-show="add_invoice_details" rows="4"></textarea><button class="btn btn-link" ng-click="add_invoice_details = true" ng-hide="add_invoice_details">Add Invoice Note</button></div><div class="pos-item-quantity"></div><div class="pos-item-price bold"><div>Subtotal</div><div>{{tax_name()}}</div><div ng-hide="rounding_amount(invoice) == 0">Rounding</div><div>Total</div></div><div class="pos-item-total bold"><div>{{sub_total(invoice) | currency}}</div><div>{{gst(invoice) | currency}}</div><div ng-hide="rounding_amount(invoice) == 0">{{rounding_amount(invoice) | currency}}</div><div>{{total(invoice) | currency}}</div></div></td></tr></tbody></table><div class="button-panel"><button class="btn" ng-click="park()">Park (F5)</button><button class="btn btn-success" id="pos-pay-button" ng-click="pay()">Pay (F4)</button><button class="btn" ng-click="print(false)">Print</button><div class="pull-right"><button class="btn btn-danger" ng-click="clear()">Clear</button></div></div></div><div ng-switch="tyro_ready()"><div ng-switch-when="true"><div ad-tyro-payment="true"></div></div></div><div ng-switch="payment_express_ready()"><div ng-switch-when="true"><div ad-payment-express="true"></div></div></div></div><div class="column span5"><div class="content-box"><div class="bold">NOTE: </div><div><span>Point Of Sales needs to be run with </span> <span class="bold">Chrome Browser. </span> <span>If you\'re having problem getting it to work with your barcode scanner or receipt printer. contact our support team for setup information and recommended hardware</span> </div><br /><div class="bold">NOTE: </div><div><span>Invoices from POS will be</span> <span class="bold">finalized</span> <span>as soon as the payment is made.</span> </div></div><div class="content-box"><div class="sub-header">Parked Sales</div><table class="table table-striped"><tbody><tr class="goto" ng-click="open(invoice)" ng-repeat="invoice in parks"><td>{{total(invoice) | currency}}</td></tr></tbody></table></div><div class="content-box"><div class="sub-header">Closed Sales<div class="pull-right"><input class="search-query" ng-model="search_sales" type="text" /><br /><br /></div></div><table class="table table-striped"><tbody><thead ng-show="sales.length &gt; 0"><th>Invoice #</th><th>Total</th><th></th></thead><tr ng-repeat="invoice in sales | filter: search_sales"><td>{{invoice.number}}</td><td>{{invoice.total_amount | currency}}</td><td><div class="pull-right"><button class="btn btn-link" ng-click="display_invoice(invoice)">Open</button></div></td></tr></tbody></table></div></div></div><div id="pos-finish"><div class="popover fade left in" style="width: 400px"><div class="popover-title"><div class="sub-header">Change</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><ng-form><div><span>Have you issued the customer change of</span> <span class="bold">{{change_amount | currency}}?</span></div><br /><button class="btn btn-success" id="pos-confirm-change" ng-click="new_invoice()" type="submit">Yes</button></ng-form></div></div></div></div></div><div id="pos-pay"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Pay</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form style="font-size: 110%"><div class="spinner" id="create-invoice-spinner"></div><div class="bold"><span>To Pay:</span> <span class="underlined" style="font-size: 110%">{{total(invoice)|currency}}</span></div><br /><label class="bold" style="font-size: 110%">Amount tendered:</label><input class="span12" id="pos-payment-amount" ng-model="payment" step="any" type="number" /><br /><br /><div ng-show="credit_card_surcharge_amount() &gt; 0 || waive_surcharge"><div ng-class="{&#39;cross&#39;: waive_surcharge}"><div class="bold">Note: If pay by Credit Card</div><span>Surcharge of</span> <span class="bold">{{credit_card_surcharge()}}% or {{credit_card_surcharge_amount()|currency}} &nbsp;</span><span>will be applied, making the total amount charged</span> <span class="bold">{{payment_with_credit_card_surcharge()|currency}}</span></div><br /><div><label class="checkbox"><input ng-model="waive_surcharge" type="checkbox" />Waived</label></div></div><br /><br /><div><button class="btn btn-success" ng-click="payment_made(method.payment_type)" ng-repeat="method in payment_methods">{{method.name}}</button><button class="btn btn-success" ng-click="put_on_account()">Account</button><button class="btn" ng-click="cancel_payment()">Close</button></div></form></div></div></div></div></div><div class="row-fluid pos-print-invoice"><center><h3>{{workshop_name()}}</h3><h6>{{tax_registration_number()}}</h6><div style="line-height: 15px"><div ng-show="workshop_address()">{{workshop_address().full_address}}</div><div ng-show="workshop_phone()">Phone: {{workshop_phone()}}</div><div ng-show="workshop_email()">Email: {{workshop_email()}}</div><div ng-show="workshop_website()">Website: {{workshop_website()}}</div></div></center><hr class="dotted-hr" /><h5>RECEIPT / TAX INVOICE</h5><div class="row-fluid"><div>Invoice #: {{invoice.number}}</div><div ng-show="customer &amp;&amp; !customer.is_pos">Bill To: {{customer.name}}</div></div><br /><table class="table" style="border-top: 1px solid black"><tbody><tr ng-repeat="item in invoice.items"><td>{{item.description}}</td><td class="price text-align-right" style="width: 60px">{{item.quantity}} x {{item.unit_price|currency}}</td><td class="price text-align-right">{{item_total_amount(item) | currency}}</td></tr></tbody></table><div class="row-fluid"><div class="pull-left"><pre class="no-style">{{invoice.details}}</pre></div><div class="pull-right"><table class="table inline"><tbody><tr><td class="bold total">Subtotal</td><td></td><td class="text-align-right bold">{{sub_total(invoice) | currency}}</td></tr><tr><td class="bold total">Tax({{tax_name()}})</td><td></td><td class="text-align-right bold">{{gst(invoice) | currency}}</td></tr><tr><td class="bold total"> TOTAL</td><td></td><td class="text-align-right bold">{{total(invoice) | currency}}</td></tr><tr ng-show="invoice.id"><td class="bold total"> Paid</td><td></td><td class="text-align-right bold">{{invoice.paid_amount | currency}}</td></tr><tr ng-show="invoice.id"><td class="bold total"> BALANCE DUE</td><td></td><td class="text-align-right bold">{{invoice.unpaid_amount | currency}}</td></tr></tbody></table></div></div><hr class="dotted-hr" /><center><h5>Thank you for stopping by</h5></center><hr class="dotted-hr" /><div class="row-fluid"><div ng-show="invoice.payments[0].terminal_brand"><div ng-show="invoice.payments[0].merchant_id">Merchant ID: {{invoice.payments[0].merchant_id}}</div><div>Terminal ID: {{invoice.payments[0].terminal_id}}</div><div>Card Type: {{invoice.payments[0].card_type}}</div><div>Card No.: {{invoice.payments[0].card_number}}</div><div>Transaction Ref: {{invoice.payments[0].transaction_ref}}</div><div>Authorisation No.: {{invoice.payments[0].authorization_number}}</div><div>{{current|date: \'time\'}}</div></div><div class="pull-right"><div>{{today|date}}</div></div><div>Retain copy for your records</div></div></div><div class="no-print" id="pos-show-invoice"><div class="popover fade left in" style="width: 800px"><div class="popover-title"><div class="sub-header">Invoice #{{showing_invoice.number}}</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><table class="table table-striped"><tbody><tr ng-repeat="item in showing_invoice.items"><td><div ng-hide="item.returning || item.returned"><a href="javascript:void(0)" ng-click="return_item(item)">Return</a></div><div ng-show="item.returning"><span class="yellow">Returning</span> <a href="javascript:void(0)" ng-click="cancel_return(item)">Cancel</a></div><div ng-show="item.returned"><span class="yellow">Returned</span> </div></td><td>{{item.description}}</td><td class="price text-align-right" style="width: 200px">{{item.quantity}} x {{item.unit_price|currency}}</td><td class="price text-align-right">{{item_total_amount(item) | currency}}</td></tr></tbody></table><div class="row-fluid"><div class="pull-right"><table class="table"><tbody><tr><td class="bold total">Subtotal</td><td></td><td class="text-align-right bold">{{sub_total(showing_invoice) | currency}}</td></tr><tr><td class="bold total">Tax({{tax_name()}})</td><td></td><td class="text-align-right bold">{{gst(showing_invoice) | currency}}</td></tr><tr><td class="bold total"> TOTAL</td><td></td><td class="text-align-right bold">{{line_total(showing_invoice) | currency}}</td></tr><tr ng-show="showing_invoice.id"><td class="bold total"> Paid</td><td></td><td class="text-align-right bold">{{showing_invoice.paid_amount | currency}}</td></tr><tr ng-show="showing_invoice.id"><td class="bold total"> BALANCE DUE</td><td></td><td class="text-align-right bold">{{showing_invoice.unpaid_amount | currency}}</td></tr></tbody></table></div></div><div class="row-fluid" ng-show="total_refund_amount() &gt; 0"><div class="bold">Total Refund Amount: {{total_refund_amount()|currency}}</div><div class="red" ng-show="showing_invoice.id &amp;&amp; showing_invoice.unpaid_amount &gt; 0">This invoice is not fully paid, please process return by creating customer credit note</div><div ng-show="showing_invoice.id &amp;&amp; showing_invoice.unpaid_amount == 0"><div>Refund Payment Type</div><select ng-model="refund_payment_method.id" ng-options="pt.id as pt.name for pt in payment_methods" type="text"></select></div></div><br /><div class="row-fluid"><button class="btn btn-primary" ng-click="return_and_refund()" ng-show="showing_invoice.id &amp;&amp; showing_invoice.unpaid_amount == 0">Return & Refund</button><button class="btn btn" ng-click="cancel_display_invoice()">Cancel</button></div></div></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("price_groups/index.html",'<div ng-controller="PriceGroupsController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="page-header">Price Groups</div><div class="pull-right"><a class="btn btn-primary" href="javascript:void(0);" id="new-price-group-button" ng-click="new()">New Price Group</a></div></div><br /><div class="row-fluid"><div class="spinner" id="price-groups-spinner"></div><div class="content-box" ng-hide="price_groups.length &gt; 0"><p>Price groups allow you to configure different price mark up structures for your inventory</p></div></div><div class="row-fluid" ng-show="price_groups.length &gt; 0"><div class="content-box"><table class="table table-striped"><tbody><tr class="goto" ng-repeat="price_group in price_groups"><td><a class="goto" ng-href="#/price_groups/{{price_group.id}}"><div class="row-fluid"><div class="inline column" style="width: 12%">{{price_group.name}}</div><div class="inline column" style="width: 12%"><div ng-show="price_group.markup_percentage">Markup 1: {{price_group.markup_percentage|percentage}}</div><div ng-show="price_group.markup_percentage">Margin 1: {{margin(price_group.markup_percentage) | percentage}}</div></div><div class="inline column" style="width: 12%"><div ng-show="price_group.markup_percentage2">Markup 2: {{price_group.markup_percentage2|percentage}}</div><div ng-show="price_group.markup_percentage2">Margin 2: {{margin(price_group.markup_percentage2) | percentage}}</div></div><div class="inline column" style="width: 12%"><div ng-show="price_group.markup_percentage3">Markup 3: {{price_group.markup_percentage3|percentage}}</div><div ng-show="price_group.markup_percentage3">Margin 3: {{margin(price_group.markup_percentage3) | percentage}}</div></div><div class="inline column" style="width: 12%"><div ng-show="price_group.markup_percentage4">Markup 4: {{price_group.markup_percentage4|percentage}}</div><div ng-show="price_group.markup_percentage4">Margin 4: {{margin(price_group.markup_percentage4) | percentage}}</div></div><div class="inline column" style="width: 12%"><div ng-show="price_group.markup_percentage5">Markup 5: {{price_group.markup_percentage5|percentage}}</div><div ng-show="price_group.markup_percentage5">Margin 5: {{margin(price_group.markup_percentage5) | percentage}}</div></div><div class="inline column" style="width: 12%"><div ng-show="price_group.markup_percentage6">Markup 6: {{price_group.markup_percentage6|percentage}}</div><div ng-show="price_group.markup_percentage6">Margin 6: {{margin(price_group.markup_percentage6) | percentage}}</div></div><div class="inline column" style="width: 12%"><div ng-show="price_group.markup_percentage7">Markup 7: {{price_group.markup_percentage7|percentage}}</div><div ng-show="price_group.markup_percentage7">Margin 7: {{margin(price_group.markup_percentage7) | percentage}}</div></div></div></a></td></tr></tbody></table></div></div><div id="new-price-group-popover"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">New Price Group</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div ad-price-group-form="true" ng-model="new_price_group" on-cancel="after_cancel()" on-save="after_create()"></div></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("price_groups/show.html",'<div ng-controller="PriceGroupController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="spinner" id="price-group-spinner"></div><div ng-show="price_group.id"><div class="row-fluid"><div class="page-header">{{price_group.name}}<div class="deleted-sign" ng-show="price_group.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div></div><div class="pull-right"><a class="btn btn-primary" href="javascript:void(0);" id="price-group-update-items-button" ng-click="open_update_items()">Update Items\' Prices</a><a class="btn btn-danger" href="javascript:void(0);" id="delete-price-group-button" ng-click="open_delete()">Delete</a></div></div><br /><div class="row-fluid"><div class="column span6"><div class="content-box"><div class="editable" ng-click="edit_price_group()" ng-hide="price_group.editing"><div class="info"><label class="label-name-left auto-width">Name:</label><span>{{price_group.name}}</span></div><div class="info"><label class="label-name-left auto-width">Markup 1:</label><span>{{price_group.markup_percentage|percentage}}</span><label class="label-name-left auto-width">- Margin:</label><span>{{margin(price_group.markup_percentage)|percentage}}</span></div><div class="info"><label class="label-name-left auto-width">Markup 2:</label><span>{{price_group.markup_percentage2|percentage}}</span><label class="label-name-left auto-width">- Margin:</label><span>{{margin(price_group.markup_percentage2)|percentage}}</span></div><div class="info"><label class="label-name-left auto-width">Markup 3:</label><span>{{price_group.markup_percentage3|percentage}}</span><label class="label-name-left auto-width">- Margin:</label><span>{{margin(price_group.markup_percentage3)|percentage}}</span></div><div class="info"><label class="label-name-left auto-width">Markup 4:</label><span>{{price_group.markup_percentage4|percentage}}</span><label class="label-name-left auto-width">- Margin:</label><span>{{margin(price_group.markup_percentage4)|percentage}}</span></div><div class="info"><label class="label-name-left auto-width">Markup 5:</label><span>{{price_group.markup_percentage5|percentage}}</span><label class="label-name-left auto-width">- Margin:</label><span>{{margin(price_group.markup_percentage5)|percentage}}</span></div><div class="info"><label class="label-name-left auto-width">Markup 6:</label><span>{{price_group.markup_percentage6|percentage}}</span><label class="label-name-left auto-width">- Margin:</label><span>{{margin(price_group.markup_percentage6)|percentage}}</span></div><div class="info"><label class="label-name-left auto-width">Markup 7:</label><span>{{price_group.markup_percentage7|percentage}}</span><label class="label-name-left auto-width">- Margin:</label><span>{{margin(price_group.markup_percentage7)|percentage}}</span></div></div><div class="editing-item" ng-show="price_group.editing"><form class="form-horizontal"><div ad-price-group-form="true" ng-model="price_group.editing" on-cancel="cancel_edit_price_group()" on-save="save_price_group()"></div></form></div></div></div><div class="column span6"><div class="content-box"><div class="sub-header">Stocks</div><table class="table table-striped" ng-show="stocks.stocks.length &gt; 0"><thead><tr><th><div class="row-fluid"><div class="column span3">Stock Number</div><div class="column span9">Name</div></div></th></tr></thead><tbody><tr ng-repeat="stock in stocks.stocks"><td><a ng-href="#/stocks/{{stock.id}}" target="_blank"><div class="row-fluid"><div class="column span3">{{stock.stock_number}}</div><div class="column span9">{{stock.name}}</div></div></a></td></tr></tbody></table><div ng-show="stocks.meta.total_pages &gt; 1"><pagination boundary-links="true" current-page="stocks.meta.page_number" max-size="10" num-pages="stocks.meta.total_pages" on-select-page="fetch_stocks(page)" rotate="false"></pagination></div></div></div></div></div><div modal="showing_delete_quote_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete This Price Group?</h3></div><div class="modal-body"><div class="bold">Are you sure you want to delete this price group?</div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea><br /><div class="bold">What do you want to do with the items in this price group?</div><label class="radio"><input name="decision" ng-model="deletion_solution" type="radio" value="unset" />Set to no price group</label><label class="radio"><input name="decision" ng-model="deletion_solution" type="radio" value="move_update" />Move to a different price group - Recalculate sell prices based on buy price</label><label class="radio"><input name="decision" ng-model="deletion_solution" type="radio" value="move" />Move to a different price group - Leave the sell prices as is.</label><div ng-show="deletion_solution==&#39;move&#39; || deletion_solution == &#39;move_update&#39;"><div class="bold">Move To:</div><pricegrouppicker ng-model="deletion_new_price_group_id"></pricegrouppicker></div></div><div class="modal-footer"><div class="spinner" id="delete-price-group-spinner"></div><button class="btn btn-danger" ng-click="delete()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete()">Cancel</button></div></div><div id="price-group-update-prices"><div class="popover fade left in" style="width: 600px"><div class="popover-title"><div class="sub-header">Update Items\' prices</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div class="bold">Do you really want to recalculate the price group\'s items sell prices based on their buy price ?</div></div><div class="spinner" id="price-group-update-items-spinner"></div><button class="btn btn-danger" ng-click="update_items()">Update</button><button class="btn" ng-click="hide_update_items()">Cancel</button></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("purchases/index.html",'<div ng-controller="PurchasesController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="page-header">Purchase Orders<div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="row-fluid"><div class="pull-right"><a class="btn btn-primary" ng-href="#/purchases/new"><span>New Purchase Order</span></a></div></div><br /></div><div class="search-description" ng-show="keyword">Search "{{keyword}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="row-fluid" style="margin-top: 10px"><div class="column span3"><label class="checkbox"><input ng-change="toggle_open()" ng-model="query.open" type="checkbox" /><span class="label label-info">Open</span> <span>purchase orders only</span></label><label class="checkbox"><input ng-change="toggle_processed()" ng-model="query.processed" type="checkbox" /><span class="label label-success">Processed</span> <span>purchase orders only</span></label></div><div class="column span3"><label class="checkbox"><input ng-change="toggle_overdue()" ng-model="query.overdue" type="checkbox" /><span class="label label-warning">Overdue</span> <span>purchase orders only</span></label><label class="checkbox"><input ng-click="toggle_deleted()" ng-model="query.deleted" type="checkbox" /><span>Showing</span> <span class="label label-important">deleted</span> <span>purchase orders only</span></label></div><div class="column span3"><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div></div><div class="spinner" id="purchase-list-spinner"></div><div class="content-box"><table class="table table-striped"><thead><tr><th>Purchase Order No.</th><th>Date</th><th>Due Date</th><th>Supplier</th><th>Items</th><th>Job</th><th>Vehicle</th><th>Total</th><th>Status</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/purchases/&#39; + purchase.id)" ng-repeat="purchase in purchases"><td><div>#{{purchase.number}}</div><div ad-tag-icons="true" owner="purchase"></div></td><td>{{purchase.date |date: \'mediumDate\'}}</td><td>{{purchase.due_date |date: \'mediumDate\'}}</td><td>{{purchase.supplier.name}}</td><td>{{purchase.stock_names}}</td><td>{{purchase.job_title}}</td><td>{{purchase.vehicle_title}}</td><td>{{purchase.total_amount|currency}}</td><td><div ng-class="{&#39;green&#39;: purchase.status == &#39;paid&#39; || purchase.status == &#39;billed&#39; || purchase.status == &#39;processed&#39;}">{{purchase.status}}</div><button class="btn btn-info" ng-click="undelete(purchase)" ng-show="can_undelete_purchase() &amp;&amp; purchase.deleted" stop-event="click">Undelete</button></td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("purchases/new.html",'<div ng-controller="NewPurchaseController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">New Purchase Order</div><div class="row-fluid"><div class="content-box"><form class="form-horizontal"><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><supplierpicker ng-model="purchase.supplier_id" supplier="purchase.supplier"></supplierpicker></div></div><div class="control-group"><label class="control-label">Creditor/Buying Group</label><div class="controls"><creditorpicker ng-model="purchase.creditor_id"></creditorpicker></div></div><div class="control-group"><label class="control-label">Order Date</label><div class="controls"><ad-datepicker ng-model="purchase.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Due Date</label><div class="controls"><ad-datepicker ng-model="purchase.due_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Description/Note</label><div class="controls"><textarea ng-model="purchase.description" type="text"></textarea></div></div><div class="control-group"><label class="control-label">Order Number</label><div class="controls"><input ng-model="purchase.reference" type="text" /><span>&nbsp; (auto generated if left blank)</span></div></div><div class="control-group"><label class="control-label">Title</label><div class="controls"><select ng-model="purchase.title"><option value="Purchase Order">Purchase Order</option><option value="Price And Availability Request">Price And Availability Request</option></select></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="true" ng-model="purchase"></div></div><br /><br /><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_purchase()">Continue</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="saving-purchase"></div></div></div></form></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("purchases/show.html",'<div ng-controller="ShowPurchaseController"><ul class="sub-nav" ng-controller="InventoryNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="deleted-sign" ng-show="purchase.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><div ng-hide="purchase &amp;&amp; purchase.id"><div class="spinner" id="purchase-loading"></div></div><div ng-show="purchase &amp;&amp; purchase.id"><img class="processed-sign" ng-show="purchase.processed" ng-src="/assets/processed-37dcfb929ae91e45b911296ade4eef24.png" /><div class="row-fluid"><div class="pull-left"><div class="page-header">Purchase Order #{{purchase.number}}</div></div><div class="pull-right"><div ad-tag-labels="true" class="inline" owner="purchase"></div><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="purchase" placement="left" resource="Purchase" showing="x_tags"></div></div></div><br /><div class="row-fluid"><div class="pull-right"><div class="inline" ng-show="purchase.job_id"></div><a class="btn" ng-href="#/jobs/{{purchase.job_id}}"><i class="icon icon-arrow-left"></i><span>Back To Job</span></a><a class="btn" ng-href="/purchases/{{purchase.id}}/print_location_list.pdf" target="_blank"><i class="icon icon-print"></i><span>Print Location List</span></a><a class="btn" ng-href="/purchases/{{purchase.id}}/print_order.pdf" target="_blank"><i class="icon icon-print"></i><span>Print Order</span></a><button class="btn" id="email-purchase-order" ng-click="send_purchase_order()"><i class="icon icon-envelope"></i><span>Email Order</span></button><button class="btn btn-primary" id="process-purchase-order" ng-click="process_purchase_order()" ng-hide="purchase.processed || restricted_to_process_purchase_orders()"><i class="icon icon-retweet"></i><span>Process</span></button><a class="btn" id="order-repco-button" ng-click="order_repco(repco_account())" ng-show="repco_account() &amp;&amp; repco_supplier()"><img src="/assets/repco_navigator-8e21ef0b294533a128d4feada69c8241.png" style="height: 20px;" /></a><a class="btn" id="order-quantum-button" ng-click="order_repco(quantum_account())" ng-show="quantum_account() &amp;&amp; repco_supplier()"><img src="/assets/quantum_pro-5e21beca4f69abf19b557f26df4871f2.png" style="height: 20px;" /></a><a class="btn" id="order-pro-link-button" ng-click="order_repco(pro_link_account())" ng-show="pro_link_account() &amp;&amp; repco_supplier()"><img src="/assets/pro_link-ed0e9bca251211f98062a43051fa0baf.png" style="height: 20px;" /></a><a class="btn" id="order-motospecs-button" ng-click="order_repco(motospecs_account())" ng-show="motospecs_account() &amp;&amp; repco_supplier()"><img src="/assets/motospecs-a9a4edc7104b920de0eeb485620ff60b.jpg" style="height: 20px;" /></a><button class="btn btn-danger" ng-click="open_delete_dialog()" ng-hide="purchase.deleted || restricted_to(&#39;deletion&#39;)">Delete</button></div></div><br /><div class="row-fluid"><div class="column span7"><div class="content-box"><div ad-purchase="true" ng-model="purchase" template="full"></div></div></div><div class="column span5"><div class="content-box"><div class="row-fluid"><div class="pull-left"><div class="sub-header">Related Bills</div></div><div class="pull-right" ng-hide="purchase.billed || restricted_to_enter_bills()"><a ng-href="#/bills/new?purchase_id={{purchase.id}}">Add Bill</a></div></div><table class="table table-striped" ng-show="purchase.bills.length &gt; 0"><thead><tr><th><div class="row-fluid"><div class="column span4">Date</div><div class="column span4">Reference</div><div class="column span4">Total</div></div></th></tr></thead><tbody><tr ng-repeat="bill in purchase.bills"><td><a class="goto" ng-href="#/bills/{{bill.id}}"><div class="row-fluid"><div class="column span4"><div><span>{{bill.date|date: \'mediumDate\'}}</span></div></div><div class="column span4"><div><span>{{bill.reference}}</span></div></div><div class="column span4"><span>{{bill.total_amount|currency}}</span></div></div></a></td></tr></tbody></table></div><div class="content-box"><div class="sub-header">Payment</div></div><div class="content-box"><div ad-files="true" ng-model="purchase" title="Purchase Order Documents/Photos" upload-url="&#39;/purchases/&#39; + purchase.id +&#39;/upload_files&#39;"></div></div></div></div><div modal="showing_delete_purchase_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this purchase</h3></div><div class="modal-body"><div>Are you sure you want to delete this Purchase ?</div></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_purchase()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_purchase()">Cancel</button></div></div><div ad-email-purchase-order="true" anchor-element="#email-purchase-order" ng-model="purchase" placement="bottom" showing="show_send_purchase_order"></div><div ad-process-purchase-order="true" anchor-element="#process-purchase-order" ng-model="purchase" on-processed="load()" placement="left" showing="show_process_purchase_order"></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("quotes/index.html",'<div ng-controller="QuotesController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="spinner" id="quotes-spinner"></div><div class="page-header"><span>Quotes</span><div class="pull-right"><form class="form-search form-inline form-search-quote"><div class="inline"><div class="inline search-box"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></div></div></form></div></div><div class="search-description" ng-show="keyword">Search "{{keyword}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="row-fluid"><div class="column span12"><div class="pull-right"><a class="btn btn-primary" ng-href="#/quotes/new">New Quote</a><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div></div><br /><div class="row-fluid" style="margin-top: 10px"><div class="column span3"><label class="checkbox"><input ng-click="toggle_active()" ng-model="query.active" type="checkbox" /><span>Show</span> <span class="label label-info">Active</span> <span>Quotes Only</span></label><label class="checkbox"><input ng-click="toggle_deleted()" ng-model="query.deleted" type="checkbox" /><span>Show</span> <span class="label label-important">Deleted</span> <span>Quotes Only</span></label></div><div class="column span4"><div ng-show="tags().length &gt; 0"><select class="inline" ng-change="search()" ng-model="query.tag" ng-options="tag.name as tag.name for tag in tags()"><option value="">Tagged With</option></select></div></div></div><div class="content-box"><table class="table table-striped quote-list" ng-hide="query.deleted"><thead><tr><th><div class="row-fluid"><div class="column span1"><div class="quote-list-item">Quote No.</div></div><div class="column span2"><div class="quote-list-item">Issue Date</div></div><div class="column span3"><div class="quote-list-item">Description</div></div><div class="column span2"><div class="quote-list-item">{{asset_name()}}</div></div><div class="column span2"><div class="quote-list-item">Customer</div></div><div class="column span2"><div class="pull-right"><div class="quote-list-item">Amount</div></div></div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="quote in quotes"><td><a class="goto" ng-href="{{quote_path(quote)}}"><div class="row-fluid"><div class="column span1"><div class="quote-list-item-number">#{{quote.number}}</div><div class="quote-list-item"><span class="label label-success" ng-show="quote.status!=&#39;quoted&#39; &amp;&amp; quote.status != &#39;deleted&#39; &amp;&amp; quote.status != &#39;cancelled&#39;">{{quote.status}}</span><span class="label" ng-show="quote.status==&#39;quoted&#39;">{{quote.status}}</span><span class="label label-warning" ng-show="quote.status==&#39;cancelled&#39;">{{quote.status}}</span></div></div><div class="column span2"><div class="quote-list-item">{{quote.issue_date | date: \'mediumDate\'}}</div></div><div class="column span3"><div class="quote-list-item-description" ng-show="quote.description">{{quote.description}}</div><div class="quote-list-item"><div ad-tag-icons="true" class="inline" owner="quote"></div></div></div><div class="column span2"><div class="quote-list-item"><div>{{quote.vehicle | vehicle_title}}&nbsp;</div><div ng-show="quote.vehicle.vin">VIN: {{quote.vehicle.vin}}</div></div><div class="quote-list-item" ng-show="asset_property_set().registration_number">{{quote.vehicle.registration_number}}</div><div class="quote-list-item" ng-show="asset_property_set().fleet_number">{{quote.vehicle.fleet_number}}</div></div><div class="column span2"><div class="quote-list-item">{{quote.customer.name}}</div></div><div class="column span2"><div class="pull-right"><div class="quote-list-item">{{quote.total_amount|currency}}</div></div></div></div></a></td></tr></tbody></table><table class="table table-striped quote-list" ng-show="query.deleted"><thead><tr><th><div class="row-fluid"><div class="column span1"><div class="quote-list-item">Quote No.</div></div><div class="column span2"><div class="quote-list-item">Issue Date</div></div><div class="column span3"><div class="quote-list-item">Description</div></div><div class="column span2"><div class="quote-list-item">{{asset_name()}}</div></div><div class="column span2"><div class="quote-list-item">Customer</div></div><div class="column span2"><div class="pull-right"><div class="quote-list-item">Amount</div></div></div></div></th></tr></thead><tbody><tr class="goto" ng-repeat="quote in quotes"><td><div class="row-fluid"><div class="column span1"><div class="quote-list-item-number">#{{quote.number}}</div><div class="quote-list-item"><span class="label label-success" ng-show="quote.status!=&#39;quoted&#39; &amp;&amp; quote.status != &#39;deleted&#39;">{{quote.status}}</span><span class="label" ng-show="quote.status==&#39;quoted&#39;">{{quote.status}}</span><span class="label label-important" ng-show="quote.status==&#39;deleted&#39;">{{quote.status}}</span></div></div><div class="column span2"><div class="quote-list-item">{{quote.issue_date | date: \'mediumDate\'}}</div></div><div class="column span3"><div class="quote-list-item-description" ng-show="quote.description">{{quote.description}}</div><div class="quote-list-item"><div ad-tag-icons="true" class="inline" owner="quote"></div></div></div><div class="column span2"><div class="quote-list-item">{{quote.vehicle | vehicle_title}}&nbsp;</div><div class="quote-list-item" ng-show="asset_property_set().registration_number">{{quote.vehicle.registration_number}}</div><div class="quote-list-item" ng-show="asset_property_set().fleet_number">{{quote.vehicle.fleet_number}}</div></div><div class="column span2"><div class="quote-list-item">{{quote.customer.name}}</div></div><div class="column span2"><div class="pull-right"><div class="quote-list-item">{{quote.total_amount|currency}}</div><button class="btn btn-info" ng-click="undelete(quote)" ng-show="can_undelete_quote()">Undelete</button></div></div></div></td></tr></tbody><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></table></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("quotes/new.html",'<div ng-controller="NewQuoteController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">New Quote</div><div class="content-box new-quote"><div class="row-fluid"><div class="column span7"><form class="form form-horizontal" name="new_quote_form" novalidate="true"><div ad-customer-vehicle-form="true" customer="quote.customer" recommendations="recommendations" selection="selection" vehicle="quote.vehicle"></div><div class="sub-header">Quotes Details</div><div class="control-group"><label class="control-label">Type</label><div class="controls"><select ng-model="quote.quote_type" ng-options="quote_type for quote_type in quote_types"></select></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><input class="input span12" ng-model="quote.description" type="text" /></div></div><div class="control-group"><label class="control-label"><div>Invoice To 3rd Party</div><div ad-3rd-party-explain="true"></div></label><div class="controls"><insurerpicker ng-model="quote.insurer_id"></insurerpicker></div></div><div ng-model="quote" royaltypicker="true"></div><div class="control-group" ng-show="quote.insurer_id"><label class="control-label">Claim No.#</label><div class="controls"><input ng-model="quote.claim_number" type="text" /></div></div><div class="control-group" ng-show="quote.insurer_id"><label class="control-label">Account No.#</label><div class="controls"><input ng-model="quote.account_number" type="text" /></div></div><div class="control-group" ng-show="quote.insurer_id"><label class="control-label">Excess</label><div class="controls"><input ng-model="quote.excess" type="text" /></div></div><div class="control-group"><label class="control-label">Issue Date</label><div class="controls"><ad-datepicker ng-model="quote.issue_date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Job Types</label><div class="controls"><div ad-job-type-selection="true" ng-model="quote.job_type_ids"></div></div></div><div class="control-group"><label class="control-label">Assessed By</label><div class="controls"><select ng-model="quote.assessed_by_id" ng-options="mechanic.id as mechanic.name for mechanic in employees" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(&#39;assessed_by_id&#39;)" ng-show="quote.assessed_by_id"><div class="icon icon-remove red"></div></a></div></div><div class="control-group"><label class="control-label">Estimated By</label><div class="controls"><select ng-model="quote.estimated_by_id" ng-options="mechanic.id as mechanic.name for mechanic in employees" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(&#39;estimated_by_id&#39;)" ng-show="quote.estimated_by_id"><div class="icon icon-remove red"></div></a></div></div><div class="control-group"><label class="control-label">Order Number:</label><div class="controls"><input ng-model="quote.order_number" type="text" /></div></div><div class="control-group"><label class="control-label">Odometer:</label><div class="controls"><input ng-model="quote.odometer" step="any" type="number" /></div></div><div class="control-group" ng-show="asset_property_set().machine_hours"><label class="control-label">Machine Hours</label><div class="controls"><input class="input-small" ng-model="quote.machine_hours" type="text" /></div></div><div class="control-group" ng-show="asset_property_set().engine_hours"><label class="control-label">Engine Hours</label><div class="controls"><input class="input-small" ng-model="quote.engine_hours" type="text" /></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="true" ng-model="quote"></div></div><br /><br /><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_quote()">Continue</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="new-quote-spinner"></div></div></div></form></div><div class="column span5"><div ad-customer-vehicle-recommendations="true" ng-model="recommendations" owner="quote" selection="selection"></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("quotes/note.html",'<hr class="divider" /><div class="sub-header">Quote Note<div class="pull-right"><button class="btn btn-link" ng-click="edit_quote_details()">Add Quote Details</button></div></div><div class="editable note" ng-click="edit_quote_details()" ng-hide="quote.editing_details"><pre class="no-style" ng-show="quote.details">{{quote.details}}</pre></div><div class="editing-item" ng-show="quote.editing_details"><textarea class="span12" id="edit-quote-details" ng-model="quote.editing_details.details"></textarea><button class="btn btn-primary" ng-click="save_quote_details()">Save</button><button class="btn btn-danger" ng-click="clear_quote_details()">Remove</button><button class="btn" ng-click="cancel_edit_quote_details()">Cancel</button></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("quotes/quote_details.html",'<div class="row-fluid"><div class="column span7"><div ng-show="quote.logo_url"><img class="logo" ng-src="{{quote.logo_url}}" style="max-height: 200px" /></div><div ng-hide="quote.logo_url"><div class="registered-name">{{auto_workshop.registered_name}}</div></div><br /><br /><div class="bold" ng-bind-html-unsafe="auto_workshop.address|address" ng-show="auto_workshop.address.street_line"></div><div ng-show="auto_workshop.abn"><span class="label-name-left auto-width">ABN:</span>{{auto_workshop.abn}}</div><div ng-show="auto_workshop.acn"><span class="label-name-left auto-width">ACN:</span>{{auto_workshop.acn}}</div><div ng-show="auto_workshop.phone"><span class="label-name-left auto-width">Tel:</span>{{auto_workshop.phone}}</div><div ng-show="auto_workshop.mobile"><span class="label-name-left auto-width">Mobile:</span>{{auto_workshop.mobile}}</div><div ng-show="auto_workshop.fax"><span class="label-name-left auto-width">Fax:</span>{{auto_workshop.fax}}</div><div ng-show="auto_workshop.email"><span class="label-name-left auto-width">Email:</span>{{auto_workshop.email}}</div><div ng-show="auto_workshop.website"><span class="label-name-left auto-width">Website:</span>{{auto_workshop.website}}</div></div><div class="column span5"><div class="quote-word span12">{{quote.title}}</div><div class="editable" ng-click="edit_quote_info()" ng-hide="quote.editing_quote_info"><div><span class="label-name-left">Type:</span><span> {{quote.quote_type}}</span></div><div><span class="label-name-left">Issue Date:</span><span>{{quote.issue_date|date: \'mediumDate\'}}</span></div><div><span class="label-name-left">Order Number:</span><span>{{quote.order_number}}</span></div></div><div class="editing-item" ng-show="quote.editing_quote_info"><form name="edit_quote_info_form" novalidate="true"><div><span class="label-name-left" style="width: 100px">Type:</span><div class="inline"><select ng-model="quote.editing_quote_info.quote_type" ng-options="quote_type for quote_type in quote_types" style="width: 120px"></select></div></div></form><div><span class="label-name-left" style="width: 100px">Issue Date:</span><div ad-datepicker="true" class="inline" error="top" name="issue_date" ng-model="quote.editing_quote_info.issue_date"></div></div><div><span class="label-name-left" style="width: 100px">Order Number:</span><div class="inline"><input class="input input-small" name="order_number" ng-model="quote.editing_quote_info.order_number" type="text" /></div></div><br /><div><button class="btn btn-success" ng-click="save_quote_info()">Save</button><button class="btn" ng-click="cancel_edit_quote_info()">Cancel</button></div></div><div><div class="editable" ng-click="edit_mechanics()" ng-hide="quote.editing_mechanics"><div><div class="info"><span class="label-name-left auto-width">Assessed By:</span><span>{{quote.assessed_by.name}}</span></div></div><div><div class="info"><span class="label-name-left auto-width">Estimated By:</span><span>{{quote.estimated_by.name}}</span></div></div></div><div class="editing-item" ng-show="quote.editing_mechanics"><form><div><label class="label-name-left">Assessed By:</label><select ng-model="mechanic_1_id" ng-options="mechanic.id as mechanic.name for mechanic in employees" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(1)" ng-show="mechanic_1_id"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Estimated By:</label><select ng-model="mechanic_2_id" ng-options="mechanic.id as mechanic.name for mechanic in employees" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(2)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left"></label><div><button class="btn btn-success" ng-click="save_mechanics()">Save</button><button class="btn" ng-click="cancel_edit_mechanics()">Cancel</button></div></div></form></div></div><div><div class="editable" ng-click="edit_tracking_category()" ng-show="enable_tracking_category_selection()"><span class="label-name-left auto-width">Tracking Categories:</span><div class="inline" style="min-width: 40px;">{{quote.tracking_categories|comma_seperated: \'option\'}}</div></div><div class="inline editing-item" ng-show="quote.editing_tracking_category"><form class="inline form form-inline" name="edit_tracking_category_form" novalidate="true"><div ad-tracking-category-selection="true" ng-model="quote.editing_tracking_category"></div>&nbsp;<button class="btn btn-success" ng-click="save_tracking_category()">Save</button><button class="btn" ng-click="cancel_edit_tracking_category()">Cancel</button></form></div></div></div></div><div class="row-fluid customer-detail"><div class="column span7"><div class="goto" id="quote-customer" ng-click="show_customer()"><div class="bold">PREPARED FOR:</div><div class="bold" id="quote-customer-name">{{quote.paying_customer.name}}</div><div class="address"><div ng-bind-html-unsafe="quote.paying_customer.address|address" ng-show="quote.paying_customer.address.street_line"></div></div><div ng-show="quote.paying_customer.phone || quote.paying_customer.mobile"><span class="label-name-left auto-width">Tel:</span>{{quote.paying_customer | phone_number}}</div></div><div><a href="javascript:void(0)" id="change-quote-customer-button" ng-click="change_customer()">Change</a></div><div ng-show="quote.customer.id != quote.paying_customer.id"><br /><br /><div class="bold">VEHICLE OWNER:</div><div class="bold">{{quote.customer.name}}</div><div class="address"><div ng-bind-html-unsafe="quote.customer.address|address" ng-show="quote.customer.address.street_line"></div></div><div ng-show="quote.customer.phone || quote.customer.mobile"><span class="label-name-left auto-width">Tel:</span>{{quote.customer | phone_number}}</div></div></div><div class="column span5"><div class="bold">FOR:</div><div class="editable" ng-click="edit_quote_description()" ng-hide="quote.editing_description"><div ng-show="quote.description">{{quote.description}}</div><div ng-hide="quote.description">(Description Not Available)</div><div ng-show="quote.paying_customer.is_insurer"><div><span class="label-name-left auto-width">Claim No.#:</span>{{quote.claim_number}}</div><div><span class="label-name-left auto-width">Account No.#:</span>{{quote.account_number}}</div><div><span class="label-name-left auto-width">Excess:</span>{{quote.excess|currency}}</div></div></div><div class="editing-item" ng-show="quote.editing_description"><form class="form form-inline"><input ng-model="quote.editing_description.description" type="text" />&nbsp;<div ng-show="quote.paying_customer.is_insurer"><div><div>Claim No.#:</div><input ng-model="quote.editing_description.claim_number" type="text" /></div><div><div>Excess:</div><input ng-model="quote.editing_description.excess" type="text" /></div><br /><br /></div><button class="btn btn-success" ng-click="save_quote_description()">Save</button><button class="btn" ng-click="cancel_edit_quote_description()" stopevent="click">Cancel</button></form></div><div class="goto vehicle-details" ng-click="show_vehicle()" ng-show="quote.vehicle"><div ng-show="quote.vehicle.registration_number"><span class="label-name-left auto-width">Reg No.:</span>{{quote.vehicle.registration_number}}</div><div ng-show="quote.vehicle.fleet_number"><span class="label-name-left auto-width">Fleet No.:</span>{{quote.vehicle.fleet_number}}</div><div ng-show="quote.vehicle.make"><span class="label-name-left auto-width">Model:</span>{{quote.vehicle.title}}</div><div ng-show="quote.vehicle.body"><span class="label-name-left auto-width">Body Type:</span>{{quote.vehicle.body}}</div><div ng-show="quote.vehicle.vin"><span class="label-name-left auto-width">VIN:</span>{{quote.vehicle.vin}}</div><div ng-show="quote.vehicle.location"><span class="label-name-left auto-width">Location:</span>{{quote.vehicle.location}}</div></div><div class="editable" ng-click="edit_odometer()" ng-hide="quote.editing_odometer"><span class="label-name-left auto-width">Odometer:</span>{{quote.odometer|number}} {{quote.vehicle.odometer_unit}}</div><div class="editing-item" ng-show="quote.editing_odometer"><span class="label-name-left auto-width">Odometer:</span><input ng-model="quote.editing_odometer.odometer" step="any" type="number" /><br /><button class="btn btn-success" ng-click="save_odometer()">Save</button><button class="btn" ng-click="cancel_edit_odometer()">Cancel</button></div><div ng-show="asset_property_set().machine_hours"><div class="editable" ng-click="edit_machine_hours()" ng-hide="quote.editing_machine_hours"><span class="label-name-left auto-width">Machine Hours:</span>{{quote.machine_hours|number}} Hr(s)</div><div class="editing-item" ng-show="quote.editing_machine_hours"><span class="label-name-left auto-width">Machine Hours:</span><input ng-model="quote.editing_machine_hours.machine_hours" step="any" type="number" /><br /><button class="btn btn-success" ng-click="save_machine_hours()">Save</button><button class="btn" ng-click="cancel_edit_machine_hours()">Cancel</button></div></div><div ng-show="asset_property_set().engine_hours"><div class="editable" ng-click="edit_engine_hours()" ng-hide="quote.editing_engine_hours"><span class="label-name-left auto-width">Engine Hours:</span>{{quote.engine_hours|number}} Hr(s)</div><div class="editing-item" ng-show="quote.editing_engine_hours"><span class="label-name-left auto-width">Engine Hours:</span><input ng-model="quote.editing_engine_hours.engine_hours" step="any" type="number" /><br /><button class="btn btn-success" ng-click="save_engine_hours()">Save</button><button class="btn" ng-click="cancel_edit_engine_hours()">Cancel</button></div></div><div id="vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">{{quote.vehicle.title}}<div class="pull-right"><button class="btn btn-danger" ng-click="change_vehicle()"><i class="icon-refresh"></i>Change To Different {{asset_name()}}</button><button class="btn" ng-click="close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><ad-vehicle ng-model="quote.vehicle" on-save="close_vehicle()"></ad-vehicle></div></div></div></div><div id="change-vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">{{vehicle.title}}<div class="pull-right"><button class="btn" ng-click="show_vehicle()">Show Current {{asset_name()}}</button><button class="btn" ng-click="close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-change-vehicle="true" model-type="quote" ng-model="quote" on-cancel="show_vehicle()" on-save="close_vehicle()" showing="changing_vehicle" vehicle="quote.vehicle"></div></div></div></div></div><div ad-change-customer="true" anchor-element="#change-quote-customer-button" customer="quote.paying_customer" quote="quote" showing="changing_customer"></div><div id="quote-paying-customer"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{customer.name}}<div class="pull-right"><a class="btn" ng-href="#/customers/{{quote.paying_customer.id}}"><i class="icon-external-link"></i><span>Full Details</span></a><button class="btn" ng-click="close_customer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><ad-customer ng-model="quote.paying_customer" on-save="close_customer()" on-select-vehicle="goto_vehicle(vehicle)"></ad-customer></div></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("quotes/quote_files.html",'<div class="sub-header"><div class="inline" id="quote-photos">Photos/Documents</div><div class="pull-right" ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_quote_files()">Upload</button></div></div><div class="quote-files" ng-hide="uploading_files"><div class="pull-right"></div><div class="inline quote-photo" ng-repeat="photo in quote.photos" style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><div ng-show="quote.documents.length &gt; 0"><div class="bold">Documents</div><div ng-repeat="document in quote.documents"><div class="editable" ng-click="edit_file(document)" ng-hide="document.editing"><span>{{document.file_name}} &nbsp;</span><a ng-href="{{document.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="document.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="document.editing.file_name" type="text" /></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(document)">Save</button><button class="btn" ng-click="cancel_edit_file(document)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(document)">Remove</button></div></form></div></div></div></div><div id="photo-viewer"><div class="popover fade right in" style="width: 800px; height: 1000px"><div class="popover-title"><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="full_size_photo()">Full Size</button><button class="btn" ng-click="close_photo_viewer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div style="height: 750px"><carousel><slide active="photo.active" ng-repeat="photo in quote.photos"><img ng-src="{{photo.url}}" style="margin:auto; max-width: 100%; max-height:750px;" /></slide></carousel></div></div><div class="row-fluid"><center><div class="inline job-photo" ng-class="{&#39;quote-photo-active&#39;: photo.active}" ng-repeat="photo in quote.photos"><div style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><button class="btn btn-danger" ng-click="remove_photo(photo)" ng-show="photo.active">Remove</button></div></center></div></div></div></div><form action="/quotes/{{quote.id}}/upload_files" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /></div><br /><div class="inline" id="upload-photos-spinner"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("quotes/show.html",'<div class="quote" ng-controller="QuoteController"><ul class="sub-nav" ng-controller="JobNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links()"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="deleted-sign" ng-show="quote.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><div class="deleted-sign" ng-show="quote.cancelled"><img ng-src="/assets/cancelled-2828afcc792b6ebc55c1ed7e9e305cdd.png" /></div><div class="row-fluid"><div class="spinner" id="quote-spinner"></div><div class="page-header inline"><span>{{quote.title}}</span><span ng-show="job">- {{job.title}}</span></div><div class="pull-right"><div ad-tag-labels="true" class="inline" owner="quote"></div><button class="btn btn-link" id="tags" ng-click="x_tags = true"><i class="icon icon-tags"></i>Tags</button><div ad-tags="true" anchor-element="&#39;#tags&#39;" owner="quote" placement="left" resource="Quote" showing="x_tags"></div></div></div><div class="row-fluid" ng-hide="quote.deleted"><div class="pull-right"><a class="btn" href="#/jobs/{{job.id}}" ng-show="quote.job"><i class="icon-arrow-left"></i>Back To Job</a><div class="inline" ng-show="quote.invoices.length == 0"><button class="btn btn-primary" ng-click="create_job()">Start Job</button><button class="btn btn-primary" ng-click="create_invoice()">Create Invoice</button><button class="btn btn-primary" ng-click="create_booking()">Create Booking</button></div><a class="btn" ng-href="/quotes/{{quote.id}}/print.pdf" target="_blank"><i class="icon-print"></i>Print</a><button class="btn" id="quote-send-email-button" ng-click="send_email()"><i class="icon-print"></i>Email Quote</button><a class="btn" ng-href="#/quotes/new?copy_from_quote_id={{quote.id}}">Copy</a><a class="btn" ng-href="/quotes/{{quote.id}}/print_item_list.pdf" target="_blank">Print Item List</a><button class="btn btn-danger btn-delete" ng-click="cancel_quote()" ng-hide="quote.cancelled || restricted_to(&#39;deletion&#39;)">Cancel</button><button class="btn btn-danger btn-delete" ng-click="delete_quote()" ng-hide="quote.deleted || restricted_to(&#39;deletion&#39;)">Delete</button></div></div><br /><div class="row-fluid"><div class="column span7"><div class="content-box quote"><div class="row-fluid"><div class="column span7"><div ng-show="quote.logo_url"><img class="logo" ng-src="{{quote.logo_url}}" style="max-height: 200px" /></div><div ng-hide="quote.logo_url"><div class="registered-name">{{auto_workshop.registered_name}}</div></div><br /><br /><div class="bold" ng-bind-html-unsafe="auto_workshop.address|address" ng-show="auto_workshop.address.street_line"></div><div ng-show="auto_workshop.abn"><span class="label-name-left auto-width">ABN:</span>{{auto_workshop.abn}}</div><div ng-show="auto_workshop.acn"><span class="label-name-left auto-width">ACN:</span>{{auto_workshop.acn}}</div><div ng-show="auto_workshop.phone"><span class="label-name-left auto-width">Tel:</span>{{auto_workshop.phone}}</div><div ng-show="auto_workshop.mobile"><span class="label-name-left auto-width">Mobile:</span>{{auto_workshop.mobile}}</div><div ng-show="auto_workshop.fax"><span class="label-name-left auto-width">Fax:</span>{{auto_workshop.fax}}</div><div ng-show="auto_workshop.email"><span class="label-name-left auto-width">Email:</span>{{auto_workshop.email}}</div><div ng-show="auto_workshop.website"><span class="label-name-left auto-width">Website:</span>{{auto_workshop.website}}</div></div><div class="column span5"><div class="quote-word span12">{{quote.title}}</div><div class="editable" ng-click="edit_quote_info()" ng-hide="quote.editing_quote_info"><div><span class="label-name-left">Type:</span><span> {{quote.quote_type}}</span></div><div><span class="label-name-left">Issue Date:</span><span>{{quote.issue_date|date: \'mediumDate\'}}</span></div><div><span class="label-name-left">Order Number:</span><span>{{quote.order_number}}</span></div></div><div class="editing-item" ng-show="quote.editing_quote_info"><form name="edit_quote_info_form" novalidate="true"><div><span class="label-name-left" style="width: 100px">Type:</span><div class="inline"><select ng-model="quote.editing_quote_info.quote_type" ng-options="quote_type for quote_type in quote_types" style="width: 120px"></select></div></div></form><div><span class="label-name-left" style="width: 100px">Issue Date:</span><div ad-datepicker="true" class="inline" error="top" name="issue_date" ng-model="quote.editing_quote_info.issue_date"></div></div><div><span class="label-name-left" style="width: 100px">Order Number:</span><div class="inline"><input class="input input-small" name="order_number" ng-model="quote.editing_quote_info.order_number" type="text" /></div></div><br /><div><button class="btn btn-success" ng-click="save_quote_info()">Save</button><button class="btn" ng-click="cancel_edit_quote_info()">Cancel</button></div></div><div><div class="editable" ng-click="edit_mechanics()" ng-hide="quote.editing_mechanics"><div><div class="info"><span class="label-name-left auto-width">Assessed By:</span><span>{{quote.assessed_by.name}}</span></div></div><div><div class="info"><span class="label-name-left auto-width">Estimated By:</span><span>{{quote.estimated_by.name}}</span></div></div></div><div class="editing-item" ng-show="quote.editing_mechanics"><form><div><label class="label-name-left">Assessed By:</label><select ng-model="mechanic_1_id" ng-options="mechanic.id as mechanic.name for mechanic in employees" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(1)" ng-show="mechanic_1_id"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left">Estimated By:</label><select ng-model="mechanic_2_id" ng-options="mechanic.id as mechanic.name for mechanic in employees" type="text"></select><span>&nbsp;</span><a href="javascript:void(0);" ng-click="remove_mechanic(2)"><div class="icon icon-remove red"></div></a></div><div><label class="label-name-left"></label><div><button class="btn btn-success" ng-click="save_mechanics()">Save</button><button class="btn" ng-click="cancel_edit_mechanics()">Cancel</button></div></div></form></div></div><div><div class="editable" ng-click="edit_tracking_category()" ng-show="enable_tracking_category_selection()"><span class="label-name-left auto-width">Tracking Categories:</span><div class="inline" style="min-width: 40px;">{{quote.tracking_categories|comma_seperated: \'option\'}}</div></div><div class="inline editing-item" ng-show="quote.editing_tracking_category"><form class="inline form form-inline" name="edit_tracking_category_form" novalidate="true"><div ad-tracking-category-selection="true" ng-model="quote.editing_tracking_category"></div>&nbsp;<button class="btn btn-success" ng-click="save_tracking_category()">Save</button><button class="btn" ng-click="cancel_edit_tracking_category()">Cancel</button></form></div></div></div></div><div class="row-fluid customer-detail"><div class="column span7"><div class="goto" id="quote-customer" ng-click="show_customer()"><div class="bold">PREPARED FOR:</div><div class="bold" id="quote-customer-name">{{quote.paying_customer.name}}</div><div class="address"><div ng-bind-html-unsafe="quote.paying_customer.address|address" ng-show="quote.paying_customer.address.street_line"></div></div><div ng-show="quote.paying_customer.phone || quote.paying_customer.mobile"><span class="label-name-left auto-width">Tel:</span>{{quote.paying_customer | phone_number}}</div></div><div><a href="javascript:void(0)" id="change-quote-customer-button" ng-click="change_customer()">Change</a></div><div ng-show="quote.customer.id != quote.paying_customer.id"><br /><br /><div class="bold">VEHICLE OWNER:</div><div class="bold">{{quote.customer.name}}</div><div class="address"><div ng-bind-html-unsafe="quote.customer.address|address" ng-show="quote.customer.address.street_line"></div></div><div ng-show="quote.customer.phone || quote.customer.mobile"><span class="label-name-left auto-width">Tel:</span>{{quote.customer | phone_number}}</div></div></div><div class="column span5"><div class="bold">FOR:</div><div class="editable" ng-click="edit_quote_description()" ng-hide="quote.editing_description"><div ng-show="quote.description">{{quote.description}}</div><div ng-hide="quote.description">(Description Not Available)</div><div ng-show="quote.paying_customer.is_insurer"><div><span class="label-name-left auto-width">Claim No.#:</span>{{quote.claim_number}}</div><div><span class="label-name-left auto-width">Account No.#:</span>{{quote.account_number}}</div><div><span class="label-name-left auto-width">Excess:</span>{{quote.excess|currency}}</div></div></div><div class="editing-item" ng-show="quote.editing_description"><form class="form form-inline"><input ng-model="quote.editing_description.description" type="text" />&nbsp;<div ng-show="quote.paying_customer.is_insurer"><div><div>Claim No.#:</div><input ng-model="quote.editing_description.claim_number" type="text" /></div><div><div>Excess:</div><input ng-model="quote.editing_description.excess" type="text" /></div><br /><br /></div><button class="btn btn-success" ng-click="save_quote_description()">Save</button><button class="btn" ng-click="cancel_edit_quote_description()" stopevent="click">Cancel</button></form></div><div class="goto vehicle-details" ng-click="show_vehicle()" ng-show="quote.vehicle"><div ng-show="quote.vehicle.registration_number"><span class="label-name-left auto-width">Reg No.:</span>{{quote.vehicle.registration_number}}</div><div ng-show="quote.vehicle.fleet_number"><span class="label-name-left auto-width">Fleet No.:</span>{{quote.vehicle.fleet_number}}</div><div ng-show="quote.vehicle.make"><span class="label-name-left auto-width">Model:</span>{{quote.vehicle.title}}</div><div ng-show="quote.vehicle.body"><span class="label-name-left auto-width">Body Type:</span>{{quote.vehicle.body}}</div><div ng-show="quote.vehicle.vin"><span class="label-name-left auto-width">VIN:</span>{{quote.vehicle.vin}}</div><div ng-show="quote.vehicle.location"><span class="label-name-left auto-width">Location:</span>{{quote.vehicle.location}}</div></div><div class="editable" ng-click="edit_odometer()" ng-hide="quote.editing_odometer"><span class="label-name-left auto-width">Odometer:</span>{{quote.odometer|number}} {{quote.vehicle.odometer_unit}}</div><div class="editing-item" ng-show="quote.editing_odometer"><span class="label-name-left auto-width">Odometer:</span><input ng-model="quote.editing_odometer.odometer" step="any" type="number" /><br /><button class="btn btn-success" ng-click="save_odometer()">Save</button><button class="btn" ng-click="cancel_edit_odometer()">Cancel</button></div><div ng-show="asset_property_set().machine_hours"><div class="editable" ng-click="edit_machine_hours()" ng-hide="quote.editing_machine_hours"><span class="label-name-left auto-width">Machine Hours:</span>{{quote.machine_hours|number}} Hr(s)</div><div class="editing-item" ng-show="quote.editing_machine_hours"><span class="label-name-left auto-width">Machine Hours:</span><input ng-model="quote.editing_machine_hours.machine_hours" step="any" type="number" /><br /><button class="btn btn-success" ng-click="save_machine_hours()">Save</button><button class="btn" ng-click="cancel_edit_machine_hours()">Cancel</button></div></div><div ng-show="asset_property_set().engine_hours"><div class="editable" ng-click="edit_engine_hours()" ng-hide="quote.editing_engine_hours"><span class="label-name-left auto-width">Engine Hours:</span>{{quote.engine_hours|number}} Hr(s)</div><div class="editing-item" ng-show="quote.editing_engine_hours"><span class="label-name-left auto-width">Engine Hours:</span><input ng-model="quote.editing_engine_hours.engine_hours" step="any" type="number" /><br /><button class="btn btn-success" ng-click="save_engine_hours()">Save</button><button class="btn" ng-click="cancel_edit_engine_hours()">Cancel</button></div></div><div id="vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">{{quote.vehicle.title}}<div class="pull-right"><button class="btn btn-danger" ng-click="change_vehicle()"><i class="icon-refresh"></i>Change To Different {{asset_name()}}</button><button class="btn" ng-click="close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><ad-vehicle ng-model="quote.vehicle" on-save="close_vehicle()"></ad-vehicle></div></div></div></div><div id="change-vehicle"><div class="popover fade bottom in" style="width: 600px"><div class="arrow"></div><div class="popover-title"><div class="sub-header">{{vehicle.title}}<div class="pull-right"><button class="btn" ng-click="show_vehicle()">Show Current {{asset_name()}}</button><button class="btn" ng-click="close_vehicle()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div ad-change-vehicle="true" model-type="quote" ng-model="quote" on-cancel="show_vehicle()" on-save="close_vehicle()" showing="changing_vehicle" vehicle="quote.vehicle"></div></div></div></div></div><div ad-change-customer="true" anchor-element="#change-quote-customer-button" customer="quote.paying_customer" quote="quote" showing="changing_customer"></div><div id="quote-paying-customer"><div class="popover fade bottom in" style="width: 600px"><div class="popover-title"><div class="sub-header">{{customer.name}}<div class="pull-right"><a class="btn" ng-href="#/customers/{{quote.paying_customer.id}}"><i class="icon-external-link"></i><span>Full Details</span></a><button class="btn" ng-click="close_customer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><ad-customer ng-model="quote.paying_customer" on-save="close_customer()" on-select-vehicle="goto_vehicle(vehicle)"></ad-customer></div></div></div></div></div></div><div class="row-fluid"><div class="pull-right"><div ng-show="quote.last_email" style="vertical-align: top">Email: &nbsp;<span class="label label-info" ng-class="{&#39;label-success&#39;: quote.last_email.status ==&#39;delivered&#39;}">{{quote.last_email.status}}</span></div></div></div><hr /><div ad-quote="true" ng-model="quote"></div></div></div><div class="column span5"><div class="content-box quote"><div class="sub-header">Invoices</div><table class="table table-striped"><tbody><tr ng-repeat="invoice in quote.invoices"><td class="goto" ng-click="select_invoice(invoice)"><div class="row-fluid"><div class="pull-left"><span>#{{invoice.number}}</span></div><div class="pull-right"><span class="bold">Total: {{invoice.total_amount|currency}}</span></div></div><hr /><div class="row-fluid">{{invoice.description}}</div></td></tr><tr><td><br /><a href="javascript:void(0);" ng-click="create_booking()">+ Booking</a><span>&nbsp;::&nbsp;</span><a href="javascript:void(0);" ng-click="create_invoice()">+ Invoice</a><span>&nbsp;::&nbsp;</span><a href="javascript:void(0);" ng-click="create_job()">+ Job</a></td></tr></tbody></table></div><div class="content-box quote"><div class="sub-header"><div class="inline" id="quote-photos">Photos/Documents</div><div class="pull-right" ng-hide="uploading_files"><button class="btn btn-link" ng-click="upload_quote_files()">Upload</button></div></div><div class="quote-files" ng-hide="uploading_files"><div class="pull-right"></div><div class="inline quote-photo" ng-repeat="photo in quote.photos" style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><div ng-show="quote.documents.length &gt; 0"><div class="bold">Documents</div><div ng-repeat="document in quote.documents"><div class="editable" ng-click="edit_file(document)" ng-hide="document.editing"><span>{{document.file_name}} &nbsp;</span><a ng-href="{{document.url}}" stop-event="click" target="_blank">(open)</a></div><div class="editing-item" ng-show="document.editing"><form><div><label class="inline">Name</label><input class="span12" ng-model="document.editing.file_name" type="text" /></div><div class="action-buttons"><button class="btn btn-success" ng-click="rename_file(document)">Save</button><button class="btn" ng-click="cancel_edit_file(document)">Cancel</button><button class="btn btn-danger" ng-click="remove_file(document)">Remove</button></div></form></div></div></div></div><div id="photo-viewer"><div class="popover fade right in" style="width: 800px; height: 1000px"><div class="popover-title"><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="full_size_photo()">Full Size</button><button class="btn" ng-click="close_photo_viewer()"><i class="icon-remove"></i>Close</button></div></div></div><div class="popover-content"><div class="row-fluid"><div style="height: 750px"><carousel><slide active="photo.active" ng-repeat="photo in quote.photos"><img ng-src="{{photo.url}}" style="margin:auto; max-width: 100%; max-height:750px;" /></slide></carousel></div></div><div class="row-fluid"><center><div class="inline job-photo" ng-class="{&#39;quote-photo-active&#39;: photo.active}" ng-repeat="photo in quote.photos"><div style="width: 90px; height: 120px;"><img class="goto" ng-click="view_photo(photo, $event)" ng-src="{{photo.thumbnail_url}}" /></div><button class="btn btn-danger" ng-click="remove_photo(photo)" ng-show="photo.active">Remove</button></div></center></div></div></div></div><form action="/quotes/{{quote.id}}/upload_files" class="editing-item" method="POST" ng-show="uploading_files" ng-upload="files_uploaded(content)" upload-options-enable-rails-csrf="true"><input name="csrf_token" type="hidden" value="{{csrf_value}}" /><div><label class="inline">Please Note *: Each file should be maximum 1 Mb</label></div><br /><div><label class="inline">File 1: &nbsp;</label><input id="upload-file1" name="files[]" type="file" /></div><br /><div><label class="inline">File 2: &nbsp;</label><input id="upload-file2" name="files[]" type="file" /></div><br /><div><label class="inline">File 3: &nbsp;</label><input id="upload-file3" name="files[]" type="file" /></div><br /><div class="inline" id="upload-photos-spinner"></div><br /><button class="btn btn-success" ng-click="start_uploading()" ng-disabled="$isLoading" type="submit">Save</button><button class="btn" ng-click="cancel_upload_files($event)" type="button">Cancel</button></form></div><div class="content-box"><div class="sub-header">Office Notes</div><div ad-notes="true" model-type="quote" ng-model="quote"></div></div><div class="content-box"><div class="sub-header">COGS<div class="pull-right"><button class="btn btn-link" ng-click="open_cogs()" ng-hide="cogs_opened">Open</button><button class="btn btn-link" ng-click="close_cogs()" ng-show="cogs_opened">Close</button></div><hr /></div><div ng-show="cogs_opened"><div ad-quote-cogs="true" ng-model="quote"></div></div></div></div></div><div ad-pay-quote="true" anchor-element="#pay" ng-model="quote" showing="paying"></div><div ad-email-quote="true" anchor-element="#quote-send-email-button" ng-model="quote" placement="left" showing="email_quote"></div><div modal="showing_delete_quote_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete this quote</h3></div><div class="modal-body"><div>Are you sure you want to delete this quote</div></div><div class="modal-footer"><div class="spinner" id="delete-quote-spinner"></div><button class="btn btn-danger" ng-click="do_delete_quote()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_quote()">Cancel</button></div></div><div ad-stock-info="true"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/ams.html",'<div ng-controller="AmsReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Incomes</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="download()"><i class="icon icon-download"></i><span>Download</span></button></div></div><br /><div class="content-box"><table class="table table-striped"><thead><tr><th>Date</th><th class="text-align-right">No.#</th><th class="text-align-right">Customer </th><th class="text-align-right">Total</th><th class="text-align-right">Discount</th><th class="text-align-right">COGS</th><th class="text-align-right">Profit Margin</th></tr></thead><tbody><tr class="goto" ng-click="open_invoice(invoice)" ng-repeat="invoice in data.invoices"><td>{{invoice.date|date: \'mediumDate\'}}</td><td class="text-align-right">{{invoice.number}}</td><td class="text-align-right">{{invoice.customer_name}}</td><td class="text-align-right">{{invoice.total_amount|round_currency}}</td><td class="text-align-right">{{invoice.discount_amount|round_currency}}</td><td class="text-align-right">{{invoice.total_cost|round_currency}}</td><td class="text-align-right">{{invoice.profit_margin|round_currency}}</td></tr><tr><td></td><td></td><td class="bold text-align-right">Total</td><td class="text-align-right bold">{{data.total_amount|round_currency}}</td><td class="text-align-right">{{data.total_discount_amount|round_currency}}</td><td class="text-align-right bold">{{data.total_cost|round_currency}}</td><td class="text-align-right bold"><div>{{data.total_profit_margin|round_currency}}</div><div>{{data.total_profit_margin_percentage}}%</div></td></tr></tbody></table></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/bills.html",'<div ng-controller="BillsReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Bills</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="content-box"><table class="table table-striped"><thead><tr><th>Date</th><th>Type</th><th class="text-align-right">No.#</th><th class="text-align-right">Reference</th><th class="text-align-right">Supplier </th><th class="text-align-right">{{tax_name()}}</th><th class="text-align-right">Total</th><th class="text-align-right">Remain</th></tr></thead><tbody><tr class="goto" ng-click="open_bill(bill)" ng-repeat="bill in data.bills"><td>{{bill.date|date: \'mediumDate\'}}</td><td><span ng-show="bill.type == &#39;bill&#39;">Bill</span><span ng-show="bill.type == &#39;supplier_credit_note&#39;">Credit Note</span></td><td class="text-align-right">{{bill.number}}</td><td class="text-align-right">{{bill.reference}}</td><td class="text-align-right">{{bill.supplier_name}}</td><td class="text-align-right">{{bill.gst_amount|round_currency}}</td><td class="text-align-right">{{bill.total_amount|round_currency}}</td><td class="text-align-right">{{bill.unpaid_amount|round_currency}}</td></tr><tr><td></td><td></td><td></td><td></td><td class="bold text-align-right">Total</td><td class="text-align-right bold">{{data.total_gst_amount|round_currency}}</td><td class="text-align-right bold">{{data.total_amount|round_currency}}</td><td class="text-align-right bold">{{data.total_remaining_amount|round_currency}}</td></tr></tbody></table></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/buyin.html",'<div ng-controller="BuyinReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Buyin Report</div><div class="row-fluid"><label>Buyin Stock:&nbsp;</label><div class="inline"><div ad-stockpicker="true" input-id="stockpicker-input" ng-model="stock" on-select="filter_report()"></div></div><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div></div></div><br /><div class="content-box" ng-show="stock.id"><div class="sub-header">Purchases</div><table class="table table-striped"><thead><tr><th>Date</th><th>Supplier</th><th>Bill Ref</th><th>Item</th><th>Qty.</th><th></th></tr></thead><tbody><tr class="goto" ng-click="open_purchase(purchase)" ng-repeat="purchase in data.purchases"><td>{{purchase.date|date: \'shortDate\'}}</td><td>{{purchase.supplier}}</td><td>{{purchase.bill_reference}}</td><td>{{purchase.description}}</td><td>{{purchase.quantity}}</td><td><div ng-show="purchase.invoice_number"><a ng-href="#/invoices/{{purchase.invoice_number}}" stop-event="click" target="_blank"><span class="badge badge-info">Invoice {{purchase.invoice_number}} - Qty. {{purchase.invoice_quantity}}</span></a></div></td></tr></tbody></table><div ng-show="data.customer_returns.length &gt; 0"><br /><hr /><br /><div class="sub-header">Customer Returns</div><table class="table table-striped"><thead><tr><th>Date</th><th>Customer</th><th>Credit Note No.#</th><th>Item</th><th>Qty.</th><th></th></tr></thead><tbody><tr class="goto" ng-click="open_customer_return(ri)" ng-repeat="ri in data.customer_returns"><td>{{ri.date|date: \'shortDate\'}}</td><td>{{ri.customer}}</td><td>{{ri.credit_note_number}}</td><td>{{ri.description}}</td><td>{{ri.quantity}}</td></tr></tbody></table></div></div><br /><div class="content-box"><div class="sub-header">Returned</div><table class="table table-striped"><thead><tr><th>Date</th><th>Supplier</th><th>Supplier Credit Note</th><th>Item</th><th>Qty.</th><th></th></tr></thead><tbody><tr class="goto" ng-click="open_return(ri)" ng-repeat="ri in data.returns"><td>{{ri.date|date: \'shortDate\'}}</td><td>{{ri.supplier}}</td><td>{{ri.supplier_credit_note_reference}}</td><td>{{ri.description}}</td><td>{{ri.quantity}}</td></tr></tbody></table></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/change_logs.html",'<div ng-controller="ChangeLogsReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Stock Changes</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div></div></div><br /><div class="row-fluid"><div class="pull-right"><div class="bold">Note:</div><pre>Please note that not all changes are logged. The system will only lock the changes of important attributes such as stock number, stock name, quantity, creation and deletion, prices and accounting settings.</pre></div></div><div class="row-fluid"><div class="controls"><div class="inline">Show Manually changed made by &nbsp;</div><div class="inline"><select class="inline" name="employee" ng-change="filter_report()" ng-model="query.employee_id" ng-options="employee.id as employee.name for employee in employees()"><option value=""></option></select></div></div></div><div class="content-box"><table class="table table-striped"><thead><tr><th>Date</th><th>Stock No.</th><th>Stock Name</th><th>Description</th><th>Changes</th><th>Changed By</th></tr></thead><tbody><tr class="goto" ng-repeat="change_log in data.change_logs"><td><div>{{change_log.date|date: \'shortDate\'}}</div><div>{{change_log.date|date: \'shortTime\'}}</div></td><td>{{change_log.stock.stock_number}}</td><td>{{change_log.stock.name}}</td><td>{{change_log.description}}</td><td><div ng-repeat="attribute_change in change_log.attribute_changes"><span>{{attribute_change.attribute}} changed to {{attribute_change.new_value}}</span></div></td><td>{{change_log.employee.name || \'System\'}}</td></tr></tbody></table></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/commission.html",'<div ng-controller="CommissionReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Commission Report</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button></div></div><br /><div class="report report-pie" id="commission-report"></div><div class="content-box" ng-hide="showing_employee"><div class="row-fluid"><table class="table table-striped"><thead><tr><th>Salesperson Name </th><th class="text-align-right" ng-show="show_quote_amount" style="width: 150px">Total Quote</th><th class="text-align-right" style="width: 150px">Total Net</th><th class="text-align-right">{{tax_name()}}</th><th class="text-align-right" style="width: 150px">Total</th><th class="text-align-right" ng-hide="show_quote_amount" style="width: 150px">Profit Margin</th><th class="text-align-right" style="width: 150px">Commission</th></tr></thead><tbody><tr class="goto" ng-click="open_employee(item)" ng-repeat="item in data.data"><td>{{item.name}}</td><td class="text-align-right" ng-show="show_quote_amount">{{item.total_net_amount|round_currency}}</td><td class="text-align-right">{{item.total_net_amount|round_currency}}</td><td class="text-align-right">{{item.total_gst_amount|round_currency}}</td><td class="text-align-right">{{item.total_amount|round_currency}}</td><td class="text-align-right" ng-hide="show_quote_amount">{{item.profit_margin|round_currency}}</td><td class="text-align-right"><span ng-show="item.commission != 0">{{item.commission|round_currency}}</span><span ng-hide="item.commission != 0">N/A</span></td></tr><tr><td class="bold text-align-right">TOTAL:&nbsp;</td><td class="bold text-align-right" ng-show="show_quote_amount">{{data.total_quote_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_net_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_gst_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_amount|round_currency}}</td><td class="bold text-align-right" ng-hide="show_quote_amount"><div>{{data.total_profit_margin|round_currency}}</div><div>{{data.profit_margin_percentage}}%</div></td><td class="bold text-align-right"><span ng-show="data.total_commission != 0">{{data.total_commission|round_currency}}</span><span ng-hide="data.total_commission != 0">N/A</span></td></tr></tbody></table></div></div><div class="inline" ng-show="showing_employee" style="margin-left: 15px"><label class="label label-info">Showing {{showing_employee.name}}</label><button class="btn btn-link" ng-click="close_employee()">Summary</button></div><div class="content-box" ng-show="showing_employee"><div class="row-fluid"><table class="table table-striped"><thead><tr><th>Invoice</th><th class="text-align-right" ng-show="show_quote_amount" style="width: 150px">Total Quote</th><th class="text-align-right" style="width: 150px">Total Net</th><th class="text-align-right">{{tax_name()}}</th><th class="text-align-right" style="width: 150px">Total</th><th class="text-align-right" ng-hide="show_quote_amount" style="width: 150px">Profit Margin</th><th class="text-align-right" style="width: 150px">Commission</th></tr></thead><tbody><tr class="goto" ng-click="open_invoice(item)" ng-repeat="item in showing_employee.invoices"><td>{{item.description}}</td><td class="text-align-right" ng-show="show_quote_amount">{{item.quote_amount|round_currency}}</td><td class="text-align-right">{{item.net_amount|round_currency}}</td><td class="text-align-right">{{item.gst_amount|round_currency}}</td><td class="text-align-right">{{item.total_amount|round_currency}}</td><td class="text-align-right" ng-hide="show_quote_amount">{{item.profit_margin|round_currency}}</td><td class="text-align-right"><span ng-show="item.commission != 0">{{item.commission|round_currency}}</span><span ng-hide="item.commission != 0">N/A</span></td></tr><tr><td class="bold text-align-right">TOTAL:&nbsp;</td><td class="text-align-right" ng-show="show_quote_amount">{{showing_employee.total_quote_amount|round_currency}}</td><td class="bold text-align-right">{{showing_employee.total_net_amount|round_currency}}</td><td class="bold text-align-right">{{showing_employee.total_gst_amount|round_currency}}</td><td class="bold text-align-right">{{showing_employee.total_amount|round_currency}}</td><td class="bold text-align-right" ng-hide="show_quote_amount"><div>{{showing_employee.total_profit_margin|round_currency}}</div><div>{{showing_employee.profit_margin_percentage}}%</div></td><td class="bold text-align-right"><span ng-show="showing_employee.commission != 0">{{showing_employee.commission|round_currency}}</span><span ng-hide="showing_employee.commission != 0">N/A</span></td></tr></tbody></table></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/daily_income.html",'<div ng-controller="DailyIncomeReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Received Payments</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="content-box"><div ng-show="data.data.length == 0"><span>No data available in this reporting period</span></div><div class="report report-pie" id="income-payment-method-report"></div><br /><br /><div class="row-fluid"><div class="pull-right"><div>Note: click on the rows to show payments on that day</div></div></div><table class="table table-striped" ng-hide="showing_day"><thead><tr><th>Date</th><th class="text-align-right" ng-repeat="payment_type in data.payment_types">{{payment_type.label}}</th><th class="text-align-right">Total</th></tr></thead><tbody><tr class="goto" ng-click="show_day(day)" ng-repeat="day in data.days"><td>{{day.date|date}}</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: day.summary[payment_type.payment_type] &gt; 0}" ng-repeat="payment_type in data.payment_types">{{day.summary[payment_type.payment_type]|round_currency}}</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: day.summary.total &gt; 0}">{{day.summary.total|round_currency}}</td></tr><tr class="bold"><td>Total</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: data.summary[payment_type.payment_type] &gt; 0}" ng-repeat="payment_type in data.payment_types">{{data.summary[payment_type.payment_type]|round_currency}}</td><td class="text-align-right" ng-class="{&#39;report-highlight&#39;: data.total &gt; 0}">{{data.total|round_currency}}</td></tr></tbody></table><div ng-show="showing_day"><label class="label label-info">Showing {{showing_day.date|date}}</label><button class="btn btn-link" ng-click="show_summary()">Summary</button><table class="table table-striped"><thead><tr><th>Customer</th><th>Payment Type</th><th class="text-align-right">Amount</th><th>Reference</th><th>Invoice No.</th></tr></thead><tbody><tr ng-click="open_payment(payment)" ng-repeat="payment in showing_day.payments"><td>{{payment.customer_name}}</td><td><span>{{payment.payment_type_name}}</span><span ng-show="payment.type == &#39;refund&#39;">&nbsp; Refund</span></td><td class="text-align-right" ng-class="{&#39;red&#39;: payment.type == &#39;refund&#39;}">{{payment.amount|round_currency}}</td><td>{{payment.reference}}</td><td>{{payment.invoice}}</td></tr></tbody></table></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/debtors.html",'<div ng-controller="DebtorsReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Customer Statements</div><div class="row-fluid"><div class="pull-right search-form"><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print List</span></button><button class="btn" ng-click="print_statements()"><i class="icon icon-print"></i><span>Bulk Print Statements</span></button><button class="btn" ng-click="send_statements()"><i class="icon icon-mail"></i><span>Send Statements</span></button></div></div><br /><div ng-show="message"><div class="label label-info">{{message}}</div><br /><br /></div><div class="content-box"><div class="report report-pie" id="debtors-report"></div><br /><br /><table class="table table-striped"><thead><tr><th><label class="checkbox"><input ng-click="toggle_select_all()" type="checkbox" /><span>All</span></label></th><th>Name </th><th>Account</th><th>Phone </th><th>Email </th><th class="text-align-right">Current</th><th class="text-align-right">1 Month</th><th class="text-align-right">2 Month</th><th class="text-align-right">3 Month & Over</th><th class="text-align-right">Balance</th><th class="text-align-right">Payable</th><th class="text-align-right">Overdue</th></tr></thead><tbody><tr ng-repeat="account in data.customer_accounts"><td><input ng-model="account.customer.selected" type="checkbox" /></td><td>{{account.customer.name}}</td><td>{{account.customer.payment_term_name}}</td><td>{{account.customer.mobile || customer.phone}}</td><td>{{account.customer.email}}</td><td class="text-align-right">{{account.current_balance|round_currency}}</td><td class="text-align-right">{{account.one_month_balance|round_currency}}</td><td class="text-align-right">{{account.two_month_balance|round_currency}}</td><td class="text-align-right">{{account.three_month_and_over_balance|round_currency}}</td><td class="text-align-right">{{account.finalized_balance|round_currency}}</td><td class="text-align-right">{{account.total_payable|round_currency}}</td><td class="text-align-right">{{account.total_overdue|round_currency}}</td></tr><tr><td class="text-align-right bold" colspan="5">Total</td><td class="text-align-right bold">{{data.current_balance|round_currency}}</td><td class="text-align-right bold">{{data.one_month_balance|round_currency}}</td><td class="text-align-right bold">{{data.two_month_balance|round_currency}}</td><td class="text-align-right bold">{{data.three_month_and_over_balance|round_currency}}</td><td class="text-align-right bold">{{data.total_finalized_balance|round_currency}}</td><td class="text-align-right bold">{{data.total_receivable_amount|round_currency}}</td><td class="text-align-right bold">{{data.total_overdue_amount|round_currency}}</td></tr></tbody></table></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/efficiency.html",'<div ng-controller="EfficiencyReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Efficiency Report</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div></div></div><br /><div class="report report-pie" id="efficiency-category-report"></div><br /><label class="checkbox"><input ng-change="filter_report()" ng-model="include_in_progress_jobs" type="checkbox" />Include In Progress Jobs</label><div class="content-box"><table class="table table-striped" ng-hide="employee"><thead><tr><th class="column-sortable" ng-click="sort(&#39;name&#39;)" style="min-width: 150px">Employee</th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_hours&#39;)">Total Hours</th><th class="text-align-right">Charged Amount</th><th class="text-align-right">Effective Hours</th><th class="text-align-right">Efficiency</th></tr></thead><tbody><tr class="goto" ng-click="open_employee(employee)" ng-repeat="employee in data.data"><td class="column-sortable" style="min-width: 150px">{{employee.name}}</td><td class="column text-align-right">{{employee.total_hours.round(2)}}</td><td class="text-align-right">{{employee.total_charged_amount|round_currency}}</td><td class="text-align-right">{{employee.total_effective_charge_out_hours.round(2)}}</td><td class="text-align-right">{{percentage(employee)}}</td></tr></tbody></table><div ng-show="employee"><div class="inline">Showing {{employee.name}}</div><button class="btn btn-link" ng-click="summary()">All</button><table class="table table-striped"><thead><tr><th class="column" style="min-width: 150px">Date</th><th class="column">Job</th><th class="text-align-right">Hours</th><th class="text-align-right">Effective Hours</th><th class="text-align-right">Description</th><th class="text-align-right">Type</th></tr></thead><tbody><tr class="goto" ng-click="open_wh(wh)" ng-repeat="wh in data.data[0].work_hours"><td class="column" style="min-width: 150px">{{wh.started_at|date}}</td><td class="column">{{wh.job}}</td><td class="column text-align-right">{{wh.hour}}h</td><td class="column text-align-right">{{wh.effective_charge_out_hours.round(2)}}h</td><td class="column text-align-right"><pre class="no-style">{{wh.description}}</pre><div>{{wh.started_at | date:\'shortTime\'}} - {{wh.ended_at | date:\'shortTime\'}} </div></td><td class="text-align-right"><span class="label label-warning" ng-show="wh.overtime">Overtime</span><span class="label" ng-show="wh.no_charge">Internal, Non-charge</span><span class="label label-success" ng-hide="wh.no_charge">Charge</span></td></tr></tbody></table></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/income_by_job_type.html",'<div ng-controller="IncomeByJobTypeReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Incomes By Job Type</div><div class="row-fluid"><div class="pull-right search-form"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div></div><br /><div class="content-box"><div ng-show="data.income_by_job_types.length == 0"><span>No data available in this reporting period</span></div><div class="report report-pie" id="income-job-type-report"></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/income_paid_unpaid.html",'<div ng-controller="IncomePaidUnpaidReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Income Paid/Unpaid</div><div class="row-fluid"><div class="pull-right search-form"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div></div><br /><div class="content-box"><div ng-show="data.income_by_statuses.length == 0"><span>No data available in this reporting period</span></div><div class="report report-pie" id="income-status-report"></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/income_weekly_monthly.html",'<div ng-controller="IncomeWeeklyMonthlyReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Incomes</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="content-box"><div class="row-fluid"><div class="column span12 income-report-by-time-selection"><div class="form-inline"><div class="sub-header inline">Income by:</div><label class="radio"><input ng-model="by_time" type="radio" value="week" />Week</label><label class="radio"><input ng-model="by_time" type="radio" value="month" />Month</label></div></div></div><div class="row-fluid income-report-by-time"><div class="column span12 report-container"><div ng-show="by_time==&#39;week&#39; &amp;&amp; data.income_by_week.length &gt; 0"><div class="report report-bar" id="income-by-week-report"></div></div><div ng-show="by_time==&#39;week&#39; &amp;&amp; data.income_by_week.length == 0"><span>No data available in this reporting period</span></div><div ng-show="by_time==&#39;month&#39; &amp;&amp; data.income_by_month.length &gt; 0"><div class="report report-bar" id="income-by-month-report"></div></div><div ng-show="by_time==&#39;month&#39; &amp;&amp; data.income_by_month.length == 0"><span>No data available in this reporting period</span></div></div></div><br /><br /><table class="table table-striped"><thead><tr><th>Date</th><th class="text-align-right">No.#</th><th class="text-align-right">Customer </th><th class="text-align-right">{{tax_name()}}</th><th class="text-align-right">Total</th><th class="text-align-right">COGS</th><th class="text-align-right">Profit Margin</th><th class="text-align-right">Paid</th><th class="text-align-right">Remain</th></tr></thead><tbody><tr class="goto" ng-click="open_invoice(invoice)" ng-repeat="invoice in data.invoices"><td>{{invoice.date|date: \'mediumDate\'}}</td><td class="text-align-right">{{invoice.number}}</td><td class="text-align-right">{{invoice.customer_name}}</td><td class="text-align-right">{{invoice.gst_amount|round_currency}}</td><td class="text-align-right">{{invoice.total_amount|round_currency}}</td><td class="text-align-right">{{invoice.total_cost|round_currency}}</td><td class="text-align-right">{{invoice.profit_margin|round_currency}}</td><td class="text-align-right">{{invoice.paid_amount|round_currency}}</td><td class="text-align-right">{{invoice.unpaid_amount|round_currency}}</td></tr><tr><td></td><td></td><td class="bold text-align-right">Total</td><td class="text-align-right bold">{{data.total_gst_amount|round_currency}}</td><td class="text-align-right bold">{{data.total_receivable_amount|round_currency}}</td><td class="text-align-right bold">{{data.total_cost|round_currency}}</td><td class="text-align-right bold"><div>{{data.total_profit_margin|round_currency}}</div><div>{{data.total_profit_margin_percentage}}%</div></td><td class="text-align-right bold">{{data.total_received_amount|round_currency}}</td><td class="text-align-right bold">{{data.total_remaining_amount|round_currency}}</td></tr></tbody></table><h4>Summary </h4><div><span class="bold">Total Invoice:&nbsp;</span><span>{{data.invoices.length}}</span></div><div><span class="bold">Average Total (Inc. GST):&nbsp;</span><span>{{average_total()|currency}}</span></div><div><span class="bold">Average Margin:&nbsp;</span><span>{{average_margin()|currency}} ({{average_margin_percentage()}}%)</span></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/job.html",'<div ng-controller="JobReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="page-header" id="lead-report-header">Job Report</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="row-fluid"><div class="column span3"><label class="checkbox"><input ng-change="filter_report()" ng-model="query.include_unfinished" type="checkbox" />Include in progress jobs</label></div><div class="column span9"><span>Assigned To: &nbsp;</span><div class="inline"></div><select ng-change="filter_report()" ng-model="query.employee_id" ng-options="employee.id as employee.name for employee in employees()"><option value=""></option></select></div></div><div class="row-fluid content-box"><div class="spinner" id="report-spinner"></div><table class="table table-striped"><thead><tr><th>Date</th><th>Job No.</th><th>Inv No.</th><th>Mechanics</th><th>Description</th><th>Customer</th><th>Source Of Business</th><th>Vehicle</th><th class="text-align-right">Quoted Amount</th><th class="text-align-right">Total</th><th class="text-align-right">Paid</th><th class="text-align-right">Payment Method</th><th class="text-align-right">Outstanding</th></tr></thead><tbody><tr class="goto" ng-click="open(job)" ng-repeat="job in report.jobs"><td>{{job.time|date:\'shortDate\'}}</td><td>{{job.number}}</td><td>{{job.invoice.number}}</td><td><div ng-repeat="employee in job.employees">{{employee.name}}</div></td><td><div>{{job.description}}</div><div ng-show="job.tags.length &gt; 0"><div ad-tag-icons="true" owner="job"></div></div></td><td><div>{{job.customer.name}}</div><div ng-show="job.customer.special_account_number">Special Account No.: {{job.customer.special_account_number}}</div><div ng-show="job.customer.address">Billing Address: {{job.customer.address}}</div><div ng-show="job.customer.street_address">Street Address: {{job.customer.street_address}}</div><div ng-show="job.customer.mobile">Mobile: {{job.customer.mobile}}</div><div ng-show="job.customer.phone">Phone: {{job.customer.phone}}</div></td><td>{{job.customer.business_source}}</td><td><div>{{job.vehicle.title}}</div></td><td class="text-align-right"><span ng-show="job.quote">{{job.quote.total_amount|currency}}</span></td><td class="text-align-right">{{job.invoice.total_amount|currency}}</td><td class="text-align-right">{{job.invoice.paid_amount|currency}}</td><td class="text-align-right">{{job.invoice.payments|comma_seperated: \'payment_method\'}}</td><td class="text-align-right">{{job.invoice.unpaid_amount|currency}}</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td class="text-align-right">{{report.total_quote_amount|currency}}</td><td class="text-align-right">{{report.total_amount|currency}}</td><td class="text-align-right">{{report.total_paid_amount|currency}}</td><td></td><td class="text-align-right">{{report.total_unpaid_amount|currency}}</td></tr></tbody></table></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/lead.html",'<div ng-controller="LeadReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="page-header" id="lead-report-header">Lead Report</div><div class="row-fluid"><div class="pull-right search-form"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div></div><br /><div class="content-box" style="min-height: 200px"><div class="spinner" id="lead-new-customer-report-spinner"></div><div class="inline sub-header" id="new-customers-header"><span>New Customers</span><div class="inline"><button class="btn-link" ng-click="show_new_customers_details()">Details</button></div></div><div ng-show="data.length == 0"><span>No data available in this reporting period</span></div><div class="report report-pie" id="lead-new-customer-report"></div></div><br /><div class="content-box" style="min-height: 200px"><div class="spinner" id="report-spinner"></div><div class="inline sub-header" id="income-by-source-header"><span>Income By Source Of Business </span><div class="inline"><button class="btn-link" ng-click="show_income_by_source_details()">Details</button></div></div><div ng-show="data.length == 0"><span>No data available in this reporting period</span></div><div class="report report-pie" id="lead-report"></div><br /><div class="bold">Please Note: Only the first invoice is considered from the source, all subsequence invoices are grouped into "Repeated Customers"</div></div><br /><div class="content-box"><div class="spinner" id="report-spinner"></div><div class="inline sub-header" id="income-by-original-header"><span>Income By Original Source Of Business </span><div class="inline"><button class="btn-link" ng-click="show_income_by_original_details()">Details</button></div></div><div ng-show="data.original_source_data.length == 0"><span>No data available in this reporting period</span></div><div class="report report-pie" id="original-lead-report"></div><br /></div></div></div><div id="new-customers-details-popover"><div class="popover fade left in" style="width: 800px"><div class="popover-title"><div class="sub-header">New Customer</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div ng-repeat="source in new_customers.data"><div class="bold">{{source.label}}</div><table class="table table-striped"><thead><tr><th>Source</th><th>Customer</th><th>Created At</th></tr></thead><tbody><tr ng-repeat="customer in source.customers"><td>{{customer.source}}</td><td>{{customer.name}}</td><td>{{customer.created_at | date}}</td></tr></tbody></table><br /></div></div><button class="btn btn-success" ng-click="hide_new_customers_details()">Close</button></div></div></div></div><div id="income-by-source-details-popover"><div class="popover fade left in" style="width: 900px"><div class="popover-title"><div class="sub-header">Income By Sources</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div ng-repeat="source in by_source.data"><div class="bold">{{source.label}}</div><table class="table table-striped"><thead><tr><th>Source</th><th>Invoice#</th><th>Date</th><th>Description</th><th>Customer</th><th>Amount</th></tr></thead><tbody><tr class="goto" ng-click="goto(invoice)" ng-repeat="invoice in source.invoices"><td>{{invoice.source}}</td><td>{{invoice.number}}</td><td>{{invoice.date | date: \'shortDate\'}}</td><td>{{invoice.description}}</td><td>{{invoice.customer}}</td><td>{{invoice.total_amount|round_currency}}</td></tr></tbody></table><br /></div></div><button class="btn btn-success" ng-click="hide_income_by_source_details()">Close</button></div></div></div></div><div id="income-by-original-details-popover"><div class="popover fade left in" style="width: 900px"><div class="popover-title"><div class="sub-header">Income By Original Sources</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><div ng-repeat="source in by_source.original_source_data"><div class="bold">{{source.label}}</div><table class="table table-striped"><thead><tr><th>Source</th><th>Invoice#</th><th>Date</th><th>Description</th><th>Customer</th><th>Amount</th><th>Remaining Amount</th></tr></thead><tbody><tr class="goto" ng-click="preview(invoice)" ng-repeat="invoice in source.invoices"><td>{{invoice.source}}</td><td>{{invoice.number}}</td><td>{{invoice.date | date: \'shortDate\'}}</td><td>{{invoice.description}}</td><td>{{invoice.customer}}</td><td>{{invoice.total_amount|round_currency}}</td><td>{{invoice.remaining_amount|round_currency}}</td></tr></tbody></table><br /></div></div><button class="btn btn-success" ng-click="hide_income_by_original_details()">Close</button></div></div></div></div><div ad-invoice-viewer="true" anchor-element="&#39;#lead-report-header&#39;" invoice="previewed_invoice" placement="bottom" showing="previewed_invoice"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/nav.html",'<ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/productivity.html",'<div ng-controller="ProductivityReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Productivity Report</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div></div></div><br /><div class="report report-pie" id="productivity-category-report"></div><br /><label class="checkbox"><input ng-change="filter_report()" ng-model="include_in_progress_jobs" type="checkbox" />Include In Progress Jobs</label><div class="content-box"><table class="table table-striped" ng-hide="employee"><thead><tr><th class="column-sortable" ng-click="sort(&#39;name&#39;)" style="min-width: 150px">Employee</th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_hours&#39;)">Total Hours</th><th class="text-align-right">Charged Hours</th><th class="text-align-right">Non-Charged Hours</th><th class="text-align-right">Percentage</th></tr></thead><tbody><tr class="goto" ng-click="open_employee(employee)" ng-repeat="employee in data.data"><td class="column-sortable" style="min-width: 150px">{{employee.name}}</td><td class="column text-align-right">{{employee.total_hours.round(2)}}</td><td class="text-align-right">{{employee.total_charged_hours.round(2)}}</td><td class="text-align-right">{{employee.total_non_charged_hours.round(2)}}</td><td class="text-align-right">{{percentage(employee)}}</td></tr></tbody></table><div ng-show="employee"><div class="inline">Showing {{employee.name}}</div><button class="btn btn-link" ng-click="summary()">All</button><table class="table table-striped"><thead><tr><th class="column" style="min-width: 150px">Date</th><th class="column">Job</th><th class="text-align-right">Hours</th><th class="text-align-right">Description</th><th class="text-align-right">Type</th></tr></thead><tbody><tr class="goto" ng-click="open_wh(wh)" ng-repeat="wh in data.data[0].work_hours"><td class="column" style="min-width: 150px">{{wh.started_at|date}}</td><td class="column">{{wh.job}}</td><td class="column text-align-right">{{wh.hour}}h</td><td class="column text-align-right"><pre class="no-style">{{wh.description}}</pre></td><td class="text-align-right"><span class="label" ng-show="wh.no_charge">Internal, Non-charge</span><span class="label label-success" ng-hide="wh.no_charge">Charge</span></td></tr></tbody></table></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/purchases.html",'<div ng-controller="PurchasesReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Purchase/Expense Report</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="report report-pie" id="purchase-category-report"></div><label class="checkbox inline"><input ng-model="show_category_data" type="checkbox" /><span>Grouped by Categories</span></label><label class="checkbox inline"><input ng-model="show_brand_data" type="checkbox" /><span>Grouped by Brand</span></label><div class="inline" ng-show="showing_category" style="margin-left: 15px"><label class="label label-info">Showing {{showing_category.name}}</label><button class="btn btn-link" ng-click="close_category()">Summary</button></div><div ng-hide="show_brand_data || showing_brand"><div class="content-box" ng-hide="show_category_data &amp;&amp; !showing_category"><table class="table table-striped"><thead><tr><th class="column sortable" ng-click="sort(&#39;stock_number&#39;)" style="min-width: 150px">Stock No#</th><th class="column-sortable" ng-click="sort(&#39;name&#39;)">Name </th><th class="column-sortable text-align-right" ng-click="sort(&#39;quantity&#39;)">Quantity </th><th class="column-sortable text-align-right" ng-click="sort(&#39;return&#39;)">Returned </th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_amount&#39;)" style="width: 150px">Subtotal</th><th class="text-align-right">{{tax_name()}}</th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_amount&#39;)" style="width: 150px">Total</th></tr></thead><tbody><tr class="goto" ng-click="open_item(item)" ng-repeat="item in item_list()"><td>{{item.stock_number}}</td><td>{{item.name}}</td><td class="text-align-right">{{item.quantity}}</td><td class="text-align-right">{{item.return}}</td><td class="text-align-right">{{item.total_net_amount|round_currency}}</td><td class="text-align-right">{{item.total_gst_amount|round_currency}}</td><td class="text-align-right">{{item.total_amount|round_currency}}</td></tr><tr ng-hide="showing_category"><td class="bold text-align-right" colspan="4">TOTAL:&nbsp;</td><td class="bold text-align-right">{{data.total_net_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_gst_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_amount|round_currency}}</td></tr><tr ng-show="showing_category"><td class="bold text-align-right" colspan="4">TOTAL:&nbsp;</td><td class="bold text-align-right">{{showing_category.total_net_amount|round_currency}}</td><td class="bold text-align-right">{{showing_category.total_gst_amount|round_currency}}</td><td class="bold text-align-right">{{showing_category.total_amount|round_currency}}</td></tr></tbody></table></div><div class="content-box" ng-show="show_category_data &amp;&amp; !showing_category"><table class="table table-striped"><thead><tr><th class="column-sortable" ng-click="sort_categories(&#39;name&#39;)" style="min-width: 150px">Category</th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;quantity&#39;)">Quantity </th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;return&#39;)">Return </th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;total_amount&#39;)" style="width: 150px">Subtotal</th><th class="text-align-right">{{tax_name()}}</th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;total_amount&#39;)" style="width: 150px">Total</th></tr></thead><tbody><tr class="goto" ng-click="open_category(item)" ng-repeat="item in categories" tooltip="click to show purchases of this category"><td>{{item.name}}</td><td class="text-align-right">{{item.quantity}}</td><td class="text-align-right">{{item.return}}</td><td class="text-align-right">{{item.total_net_amount|round_currency}}</td><td class="text-align-right">{{item.total_gst_amount|round_currency}}</td><td class="text-align-right">{{item.total_amount|round_currency}}</td></tr><tr><td class="bold text-align-right" colspan="3">TOTAL:&nbsp;</td><td class="bold text-align-right">{{data.total_net_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_gst_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_amount|round_currency}}</td></tr></tbody></table></div></div><div class="inline" ng-show="showing_brand" style="margin-left: 15px"><label class="label label-info">Showing {{showing_brand.name}}</label><button class="btn btn-link" ng-click="close_brand()">Summary</button></div><div ng-show="show_brand_data || showing_brand"><div class="content-box" ng-hide="show_brand_data &amp;&amp; !showing_brand"><table class="table table-striped"><thead><tr><th class="column sortable" ng-click="sort(&#39;stock_number&#39;)" style="min-width: 150px">Stock No#</th><th class="column-sortable" ng-click="sort(&#39;name&#39;)">Name </th><th class="column-sortable text-align-right" ng-click="sort(&#39;quantity&#39;)">Quantity </th><th class="column-sortable text-align-right" ng-click="sort(&#39;return&#39;)">Returned </th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_amount&#39;)" style="width: 150px">Subtotal</th><th class="text-align-right">{{tax_name()}}</th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_amount&#39;)" style="width: 150px">Total</th></tr></thead><tbody><tr class="goto" ng-click="open_item(item)" ng-repeat="item in item_list()"><td>{{item.stock_number}}</td><td>{{item.name}}</td><td class="text-align-right">{{item.quantity}}</td><td class="text-align-right">{{item.return}}</td><td class="text-align-right">{{item.total_net_amount|round_currency}}</td><td class="text-align-right">{{item.total_gst_amount|round_currency}}</td><td class="text-align-right">{{item.total_amount|round_currency}}</td></tr><tr ng-hide="showing_brand"><td class="bold text-align-right" colspan="4">TOTAL:&nbsp;</td><td class="bold text-align-right">{{data.total_net_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_gst_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_amount|round_currency}}</td></tr><tr ng-show="showing_brand"><td class="bold text-align-right" colspan="4">TOTAL:&nbsp;</td><td class="bold text-align-right">{{showing_brand.total_net_amount|round_currency}}</td><td class="bold text-align-right">{{showing_brand.total_gst_amount|round_currency}}</td><td class="bold text-align-right">{{showing_brand.total_amount|round_currency}}</td></tr></tbody></table></div><div class="content-box" ng-show="show_brand_data &amp;&amp; !showing_brand"><table class="table table-striped"><thead><tr><th class="column-sortable" ng-click="sort_brand(&#39;name&#39;)" style="min-width: 150px">Brand</th><th class="column-sortable text-align-right" ng-click="sort_brand(&#39;quantity&#39;)">Quantity</th><th class="column-sortable text-align-right" ng-click="sort_brand(&#39;return&#39;)">Return</th><th class="column-sortable text-align-right" ng-click="sort_brand(&#39;total_amount&#39;)" style="width: 150px">Subtotal</th><th class="text-align-right">{{tax_name()}}</th><th class="column-sortable text-align-right" ng-click="sort_brand(&#39;total_amount&#39;)" style="width: 150px">Total</th></tr></thead><tbody><tr class="goto" ng-click="open_brand(item)" ng-repeat="item in brands" tooltip="click to show purchases of this brand"><td>{{item.name}}</td><td class="text-align-right">{{item.quantity}}</td><td class="text-align-right">{{item.return}}</td><td class="text-align-right">{{item.total_net_amount|round_currency}}</td><td class="text-align-right">{{item.total_gst_amount|round_currency}}</td><td class="text-align-right">{{item.total_amount|round_currency}}</td></tr><tr><td class="bold text-align-right" colspan="3">TOTAL:&nbsp;</td><td class="bold text-align-right">{{data.total_net_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_gst_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_amount|round_currency}}</td></tr></tbody></table></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/quote.html",'<div ng-controller="QuoteReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="page-header" id="lead-report-header">Quote Report</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="content-box"><div class="report report-pie" id="value-report"></div><br /><div class="report report-pie" id="count-report"></div><br /><div class="row-fluid"><table class="table table-striped"><thead><tr><th>Date</th><th>Quote No.</th><th>Description</th><th>Customer</th><th>Vehicle</th><th class="text-align-right">Total</th><th class="text-align-right">Status</th></tr></thead><tbody><tr class="goto" ng-click="open(quote)" ng-repeat="quote in quotes"><td>{{quote.date|date}}</td><td>{{quote.number}}</td><td>{{quote.description}}</td><td>{{quote.customer}}</td><td>{{quote.vehicle}}</td><td class="text-align-right">{{quote.total_amount|currency}}</td><td class="text-align-right">{{quote.status}}</td></tr></tbody></table></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/reporting_period_selection.html",'<div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/sales.html",'<div ng-controller="SalesReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Sales Report</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="report report-pie" id="sale-category-report"></div><div class="row-fluid"><div class="column span9"><label class="checkbox inline"><input ng-model="show_category_data" type="checkbox" /><span>Grouped by Categories</span></label><div class="inline" ng-show="showing_category" style="margin-left: 15px"><label class="label label-info">Showing {{showing_category.name}}</label><button class="btn btn-link" ng-click="close_category()">Summary</button></div></div><div class="column span3"><div class="pull-right"><label class="checkbox"><input ng-change="filter_report()" ng-model="include_unfinalized" type="checkbox" />Include Unfinalized Invoices</label></div></div></div><div class="content-box" ng-hide="show_category_data &amp;&amp; !showing_category"><div class="row-fluid"><table class="table table-striped"><thead><tr><th class="column-sortable" ng-click="sort(&#39;stock_number&#39;)" style="min-width: 150px">Stock No#</th><th class="column-sortable" ng-click="sort(&#39;name&#39;)">Name </th><th class="column-sortable text-align-right" ng-click="sort(&#39;quantity&#39;)">Quantity </th><th class="column-sortable text-align-right" ng-click="sort(&#39;return&#39;)">Returned </th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_amount&#39;)" style="width: 150px">Subtotal</th><th class="text-align-right">{{tax_name()}}</th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_amount&#39;)" style="width: 150px">Total</th><th class="column-sortable text-align-right" ng-click="sort(&#39;profit_margin&#39;)" style="width: 150px">Profit Margin</th><th class="text-align-right" style="width: 150px">Average Cost</th><th class="text-align-right" style="width: 150px">Average Sell</th><th class="text-align-right" style="width: 150px">Average Profit</th></tr></thead><tbody><tr class="goto" ng-click="open_item(item)" ng-repeat="item in item_list()"><td>{{item.stock_number}}</td><td>{{item.name}}</td><td class="text-align-right">{{item.quantity}}</td><td class="text-align-right">{{item.return}}</td><td class="text-align-right">{{item.total_net_amount|round_currency}}</td><td class="text-align-right">{{item.total_gst_amount|round_currency}}</td><td class="text-align-right">{{item.total_amount|round_currency}}</td><td class="text-align-right">{{item.profit_margin|round_currency}}</td><td class="text-align-right">{{average_cost(item)|round_currency}}</td><td class="text-align-right">{{average_sell(item)|round_currency}}</td><td class="text-align-right">{{average_profit(item)|round_currency}}</td></tr><tr ng-hide="showing_category"><td class="bold text-align-right" colspan="4">TOTAL:&nbsp;</td><td class="bold text-align-right">{{data.total_net_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_gst_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_amount|round_currency}}</td><td class="bold text-align-right"><div>{{data.total_profit_margin|round_currency}}</div><div>{{data.profit_margin_percentage}}%</div></td><td></td><td></td><td></td></tr><tr ng-show="showing_category"><td class="bold text-align-right" colspan="4">TOTAL:&nbsp;</td><td class="bold text-align-right">{{showing_category.total_net_amount|round_currency}}</td><td class="bold text-align-right">{{showing_category.total_gst_amount|round_currency}}</td><td class="bold text-align-right">{{showing_category.total_amount|round_currency}}</td><td class="bold text-align-right"><div>{{showing_category.total_profit_margin|round_currency}}</div><div>{{showing_category.profit_margin_percentage|round_currency}}%</div></td><td></td><td></td><td></td></tr></tbody></table></div></div><div class="content-box" ng-show="show_category_data &amp;&amp; !showing_category"><div class="row-fluid"><table class="table table-striped"><thead><tr><th class="column-sortable" ng-click="sort_categories(&#39;name&#39;)" style="min-width: 150px">Category</th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;quantity&#39;)">Quantity </th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;return&#39;)">Return </th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;total_amount&#39;)" style="width: 150px">Subtotal</th><th class="text-align-right">{{tax_name()}}</th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;total_amount&#39;)" style="width: 150px">Total</th><th class="column-sortable text-align-right" ng-click="sort_categories(&#39;profit_margin&#39;)" style="width: 150px">Profit Margin</th><th class="text-align-right" style="width: 150px">Average Cost</th><th class="text-align-right" style="width: 150px">Average Sell</th><th class="text-align-right" style="width: 150px">Average Profit</th></tr></thead><tbody><tr class="goto" ng-click="open_category(item)" ng-repeat="item in categories" tooltip="click to show sales of this category"><td>{{item.name}}</td><td class="text-align-right">{{item.quantity}}</td><td class="text-align-right">{{item.return}}</td><td class="text-align-right">{{item.total_net_amount|round_currency}}</td><td class="text-align-right">{{item.total_gst_amount|round_currency}}</td><td class="text-align-right">{{item.total_amount|round_currency}}</td><td class="text-align-right">{{item.profit_margin|round_currency}}</td><td class="text-align-right">{{average_cost(item)|round_currency}}</td><td class="text-align-right">{{average_sell(item)|round_currency}}</td><td class="text-align-right">{{average_profit(item)|round_currency}}</td></tr><tr><td class="bold text-align-right" colspan="3">TOTAL:&nbsp;</td><td class="bold text-align-right">{{data.total_net_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_gst_amount|round_currency}}</td><td class="bold text-align-right">{{data.total_amount|round_currency}}</td><td class="bold text-align-right"><div>{{data.total_profit_margin|round_currency}}</div><div>{{data.profit_margin_percentage|round_currency}}%</div></td><td></td><td></td><td></td></tr></tbody></table></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/stock_value.html",'<div ng-controller="StockValueReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="page-header">Stock Value Report</div><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="content-box"><div class="spinner" id="report-spinner"></div><div class="sub-header">Stock Value</div><div ng-show="data.length == 0"><span>No data available in this reporting period</span></div><div class="report report-pie" id="stock-value-report"></div></div><br /><label class="checkbox"><input ng-change="filter_report()" ng-model="include_negative_quantity" type="checkbox" />Include Stocks With Negative Quantity</label><div class="content-box" ng-hide="category"><div class="sub-header">Value By Category</div><table class="table table-striped"><thead><tr><th>Category</th><th class="text-align-right">Total Value</th><th class="text-align-right">Unallocated Value</th></tr></thead><tbody><tr class="goto" ng-click="show_category(category)" ng-repeat="category in data.data"><td>{{category.label}}</td><td class="text-align-right">{{category.data|round_currency}}</td><td class="text-align-right">{{category.unallocated_value|round_currency}}</td></tr><tr><td class="bold text-align-right">TOTAL</td><td class="text-align-right">{{data.total_value|round_currency}}</td><td class="text-align-right">{{data.total_unallocated_value|round_currency}}</td></tr></tbody></table></div><div class="content-box" ng-show="category"><div class="sub-header"><span>Showing &nbsp;</span><button class="btn btn-link" ng-click="goto_category(category)">{{category.name}}</button><span>&nbsp;::&nbsp</span><button class="btn btn-link" ng-click="show_summary()">Summary</button></div><table class="table table-striped"><thead><tr><th>Stock Number</th><th>Name</th><th class="text-align-right">Total Quantity</th><th class="text-align-right">Total Value</th><th class="text-align-right">Unallocated Quantity</th><th class="text-align-right">Unallocated Value</th></tr></thead><tbody><tr class="goto" ng-click="goto_stock(stock)" ng-repeat="stock in category.stocks"><td>{{stock.stock_number}}</td><td>{{stock.name}}</td><td class="text-align-right">{{stock.quantity}}</td><td class="text-align-right">{{stock.value|round_currency}}</td><td class="text-align-right">{{stock.available_quantity}}</td><td class="text-align-right">{{stock.unallocated_value|round_currency}}</td></tr><tr><td class="bold text-align-right" colspan="3">TOTAL</td><td class="text-align-right">{{category.data|round_currency}}</td><td class="text-align-right">&nbsp;</td><td class="text-align-right">{{category.unallocated_value|round_currency}}</td></tr></tbody></table></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/suppliers.html",'<div ng-controller="SuppliersReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Suppliers</div><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><br /><div class="content-box"><div class="report report-pie" id="suppliers-report"></div><br /><br /><table class="table table-striped"><thead><tr><th>Supplier. No#</th><th>Name </th><th>Phone </th><th>Email </th><th>Address </th><th class="text-align-right">Balance</th><th class="text-align-right">Overdue</th></tr></thead><tbody><tr ng-repeat="supplier in data.suppliers"><td>{{supplier.number}}</td><td>{{supplier.name}}</td><td>{{supplier.mobile || supplier.phone}}</td><td>{{supplier.email}}</td><td>{{supplier.address.full_address}}</td><td class="text-align-right">{{supplier.balance|round_currency}}</td><td class="text-align-right">{{supplier.overdue_balance|round_currency}}</td></tr><tr><td class="text-align-right bold" colspan="5">Total</td><td class="text-align-right bold">{{data.total_payable_amount|round_currency}}</td><td class="text-align-right bold">{{data.total_overdue_amount|round_currency}}</td></tr></tbody></table></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/wip.html",'<div ng-controller="WipReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Work In Progress Report</div><div class="row-fluid"><div class="pull-right"><form class="form-inline"><label>Reporting Date: &nbsp;</label><ad-datepicker ng-model="date"></ad-datepicker><span>&nbsp;</span><button class="btn btn-primary" ng-click="filter_report()" type="button"><span>Show</span></button><button class="btn" ng-click="print()" type="button"><i class="icon icon-print"></i><span>Print</span></button><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></form></div></div><br /><div class="content-box"><table class="table table-striped"><thead><tr><th class="column">Job No.#</th><th class="column-sortable" ng-click="sort(&#39;date&#39;)">Start Date</th><th class="column-sortable" ng-click="sort(&#39;customer&#39;)">Customer </th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_labour_cost&#39;)" style="width: 150px">Total Labour Cost</th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_stock_cost&#39;)" style="width: 150px">Total Stock Cost</th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_buyin_cost&#39;)" style="width: 150px">Total Buyin Cost</th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_non_stock_cost&#39;)" style="width: 150px">Total Non Stock Cost</th><th class="column-sortable text-align-right" ng-click="sort(&#39;grand_total_cost&#39;)" style="width: 150px">Total WIP</th><th class="column-sortable text-align-right" ng-click="sort(&#39;remaining_timesheet_amount&#39;)" style="width: 150px">Remaining Timesheet Amount</th><th class="column-sortable text-align-right" ng-click="sort(&#39;grand_total_amount&#39;)" style="width: 150px">Invoice Total</th></tr></thead><tbody><tr class="goto" ng-click="open(item)" ng-repeat="item in data.data"><td><span ng-show="item.job_number">Job#{{item.job_number}}</span></td><td>{{item.date|date: \'shortDate\'}}</td><td>{{item.customer}}</td><td class="text-align-right">{{item.total_labour_cost|round_currency}}</td><td class="text-align-right">{{item.total_stock_cost|round_currency}}</td><td class="text-align-right">{{item.total_buyin_cost|round_currency}}</td><td class="text-align-right">{{item.total_non_stock_cost|round_currency}}</td><td class="text-align-right">{{item.grand_total_cost|round_currency}}</td><td class="text-align-right">{{item.remaining_timesheet_amount|round_currency}}</td><td class="text-align-right">{{item.grand_total_amount|round_currency}}</td></tr><tr><td></td><td></td><td></td><td class="bold text-align-right">{{data.total_labour_cost|round_currency}}</td><td class="bold text-align-right">{{data.total_stock_cost|round_currency}}</td><td class="bold text-align-right">{{data.total_buyin_cost|round_currency}}</td><td class="bold text-align-right">{{data.total_non_stock_cost|round_currency}}</td><td class="bold text-align-right">{{data.grand_total_cost|round_currency}}</td><td class="bold text-align-right">{{data.remaining_timesheet_amount|round_currency}}</td><td class="bold text-align-right">{{data.grand_total_amount|round_currency}}</td></tr></tbody></table></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/wip_invoice.html",'<div ng-controller="WipInvoiceReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Work In Progress Report</div><div class="row-fluid"><div class="pull-right"><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button></div></div><br /><div class="content-box"><table class="table table-striped"><thead><tr><th class="column">Job/Invoice No.#</th><th class="column-sortable" ng-click="sort(&#39;date&#39;)">Date</th><th class="column-sortable" ng-click="sort(&#39;customer&#39;)">Customer </th><th>Description</th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_amount&#39;)" style="width: 150px">Invoice Total</th><th class="column-sortable text-align-right" ng-click="sort(&#39;remaining_timesheet_amount&#39;)" style="width: 150px">Remaining Timesheet Amount</th><th class="column-sortable text-align-right" ng-click="sort(&#39;grand_total&#39;)" style="width: 150px">Total</th><th class="column-sortable text-align-right" ng-click="sort(&#39;total_buyin_cost&#39;)" style="width: 150px">Total Buyin</th><th class="column-sortable text-align-right" ng-click="sort(&#39;grand_total_cost&#39;)" style="width: 150px">COGS</th></tr></thead><tbody><tr class="goto" ng-click="open(item)" ng-repeat="item in data.data"><td><span ng-show="item.job_number">Job#{{item.job_number}}</span><span ng-hide="item.job_number">Invoice#{{item.invoice_number}}</span></td><td>{{item.date|date: \'shortDate\'}}</td><td>{{item.customer}}</td><td>{{item.description}}</td><td class="text-align-right">{{item.total_amount|round_currency}}</td><td class="text-align-right">{{item.remaining_timesheet_amount|round_currency}}</td><td class="text-align-right">{{item.grand_total_amount|round_currency}}</td><td class="text-align-right">{{item.total_buyin_cost|round_currency}}</td><td class="text-align-right">{{item.grand_total_cost|round_currency}}</td></tr><tr><td></td><td></td><td></td><td></td><td class="bold text-align-right">{{data.total_amount|round_currency}}</td><td class="bold text-align-right">{{data.remaining_timesheet_amount|round_currency}}</td><td class="bold text-align-right">{{data.grand_total_amount|round_currency}}</td><td class="bold text-align-right">     {{data.total_buyin_cost|round_currency}}</td><td class="bold text-align-right">{{data.grand_total_cost|round_currency}}</td></tr></tbody></table></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("reports/workshop_efficiency.html",'<div ng-controller="WorkshopEfficiencyReportController"><div class="row-fluid"><div class="column span3"><ul class="nav nav-list side-nav no-print" ng-controller="ReportsNavController"><li class="nav-header">Income Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in income_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Expense Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in expense_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Work Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in work_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Employee Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in employee_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Marketing Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in marketing_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li><hr class="divider" /><li class="nav-header">Inventory Reports</li><li class="{{isActive(report.name)}}" ng-repeat="report in inventory_reports"><a href="#/reports/{{report.path}}">{{report.name}}</a></li></ul></div><div class="column span9"><div class="spinner" id="report-spinner"></div><div class="page-header">Efficiency Report</div><div class="row-fluid"><div class="pull-right search-form"><div class="inline"><div class="form-inline"><div ad-date-range-selection="true" class="inline" from="query.from" on-select="filter_report()" to="query.to"></div><label>Reporting period: &nbsp;</label><ad-datepicker ng-model="query.from"></ad-datepicker>&nbsp;<label>To:</label>&nbsp;<ad-datepicker ng-model="query.to"></ad-datepicker>&nbsp;<button class="btn btn-primary" ng-click="filter_report()">Show Report</button></div></div><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button></div></div><br /><div class="content-box"><table class="table table-striped" ng-hide="employee"><thead><tr><th class="column-sortable" ng-click="sort(&#39;job_number&#39;)">Job No.</th><th class="column-sortable" ng-click="sort(&#39;date&#39;)">Date</th><th class="column-sortable" ng-click="sort(&#39;job_type_title&#39;)">Job Type</th><th>Description</th><th>Customer</th><th class="text-align-right">Profit</th><th class="text-align-right">Total Hours</th><th class="text-align-right">Profit Per Hour</th></tr></thead><tbody><tr class="goto" ng-repeat="job in data.data"><td>{{job.job_number}}</td><td>{{job.date|date}}</td><td>{{job.job_type_title}}</td><td>{{job.description}}</td><td>{{job.customer}}</td><td class="text-align-right">{{job.profit_margin|currency}}</td><td class="text-align-right">{{job.total_labour_hours}} hr(s)</td><td class="text-align-right">{{job.profit_per_hour|currency}}/hr</td></tr><tr><td></td><td></td><td></td><td></td><td class="bold">Summary</td><td class="bold text-align-right">{{data.total_profit_margin|currency}}</td><td class="bold text-align-right">{{data.total_labour_hours}} hr(s)</td><td class="bold text-align-right">{{data.average_profit_per_hour|currency}}/hr</td></tr></tbody></table></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("service_schedules/overdue_registrations.html",'<div ng-controller="OverdueRegistrationsController"><ul class="sub-nav" ng-controller="ServiceScheduleNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span8"><div class="page-header"><Registration>Overdues</Registration><div class="pull-right"><form class="form-inline search-form"><label>Over due by: &nbsp;</label><div class="input-append"><input class="input-tiny" ng-model="query.over_due_days" type="number" /><span class="add-on">days</span></div>&nbsp;&nbsp;<label class="control-label">Reminder sent over: &nbsp;</label><div class="input-append"><input class="input-tiny" ng-model="query.last_reminder_days" type="number" /><span class="add-on">days</span></div>&nbsp;<button class="btn btn-primary" ng-click="search()" type="submit">Search</button></form></div></div><div class="row-fluid"><div class="column span8"><div class="pull-right"><div ng-show="sending"><span class="alert alert-success">Service Reminder Scheduled. You can check its status on the right panel</span><br /><br /></div></div></div><div class="column span4"><div class="pull-right"><div class="sub-header"><div ng-hide="sending"><span>Selected: {{selected_service_schedule_ids.length}} &nbsp;</span><button class="btn btn-success" id="send-reminder-button" ng-click="show_send_service_reminder_popover()" ng-show="service_schedules.length &gt; 0 &amp;&amp; !sending">Send Reminder</button></div></div></div></div></div></div><div class="column span4"><div class="pull-right"><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button><button class="btn" ng-click="download()"><i class="icon icon-download"></i><span>Download(Excel)</span></button></div></div></div><div class="row-fluid"><div class="column span8"><div class="spinner" id="service-schedule-spinner"></div><div ad-service-schedule-list="true" ng-model="service_schedules" selected-service-schedule-ids="selected_service_schedule_ids" service-type="registration"></div><pagination boundary-links="true" current-page="page_number" max-size="10" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div><div class="column span4"><div ad-customer-communications="true" ng-model="customer_communications"></div></div></div><div ad-customer-communication="true" anchor-element="#send-reminder-button" customer-communication-type="customer_communication_type" ng-model="customer_communinication" on-save="service_reminder_created()" placement="bottom" service-schedule-ids="selected_service_schedule_ids" showing="showing_service_reminder_dialog"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("service_schedules/overdue_services.html",'<div ng-controller="OverdueServicesController"><ul class="sub-nav" ng-controller="ServiceScheduleNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span8"><div class="page-header">Overdue Services<div class="pull-right"><form class="form-inline search-form"><label>Service Over due by: &nbsp;</label><div class="input-append"><input class="input-tiny" ng-model="query.over_due_days" type="number" /><span class="add-on">days</span></div>&nbsp;&nbsp;<label class="control-label">Reminder sent over: &nbsp;</label><div class="input-append"><input class="input-tiny" ng-model="query.last_reminder_days" type="number" /><span class="add-on">days</span></div>&nbsp;<button class="btn btn-primary" ng-click="search()" type="submit">Search</button></form></div></div><div class="sub-header"><div class="row-fluid"><div class="pull-right"><div ng-hide="sending"><span>Selected: {{selected_service_schedule_ids.length}} &nbsp;</span><button class="btn btn-success" id="send-reminder-button" ng-click="show_send_service_reminder_popover()" ng-show="service_schedules.length &gt; 0 &amp;&amp; !sending">Send Reminder</button></div><div ng-show="sending"><span class="alert alert-success">Service Reminder Scheduled. You can check its status on the right hand side panel</span></div></div></div></div></div><div class="column span4"><div class="pull-right"><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button><button class="btn" ng-click="download()"><i class="icon icon-download"></i><span>Download(Excel)</span></button></div></div></div><div class="row-fluid"><div class="column span8"><div ad-service-schedule-list="true" ng-model="service_schedules" selected-service-schedule-ids="selected_service_schedule_ids" service-type="service"></div><pagination boundary-links="true" current-page="page_number" max-size="10" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div><div class="column span4"><div ad-customer-communications="true" ng-model="customer_communications"></div></div></div><div ad-customer-communication="true" anchor-element="#send-reminder-button" customer-communication-type="customer_communication_type" ng-model="customer_communinication" on-save="service_reminder_created()" placement="bottom" service-schedule-ids="selected_service_schedule_ids" showing="showing_service_reminder_dialog"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("service_schedules/tabs.html",'<ul class="sub-nav" ng-controller="ServiceScheduleNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("service_schedules/upcoming_registrations.html",'<div ng-controller="UpcomingRegistrationsController"><ul class="sub-nav" ng-controller="ServiceScheduleNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span8"><div class="page-header">Upcoming Registrations<div class="pull-right"><form class="form-inline search-form"><label>Due within next: &nbsp;</label><div class="input-append"><input class="input-tiny" ng-model="query.due_within_days" type="number" /><span class="add-on">days</span></div>&nbsp;&nbsp;<label class="control-label">Reminder sent over: &nbsp;</label><div class="input-append"><input class="input-tiny" ng-model="query.last_reminder_days" type="number" /><span class="add-on">days</span></div>&nbsp;<button class="btn btn-primary" ng-click="search()" type="submit">Search</button></form></div></div><div class="sub-header"><div class="row-fluid"><div class="pull-right"><div ng-hide="sending"><span>Selected: {{selected_service_schedule_ids.length}} &nbsp;</span><button class="btn btn-success" id="send-reminder-button" ng-click="show_send_service_reminder_popover()" ng-show="service_schedules.length &gt; 0 &amp;&amp; !sending">Send Reminder</button></div><div ng-show="sending"><span class="alert alert-success">Registration Reminder Scheduled. You can check its status on the right hand side panel</span></div></div></div></div></div><div class="column span4"><div class="pull-right"><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button><button class="btn" ng-click="download()"><i class="icon icon-download"></i><span>Download(Excel)</span></button></div></div></div><div class="row-fluid"><div class="column span8"><div ad-service-schedule-list="true" ng-model="service_schedules" selected-service-schedule-ids="selected_service_schedule_ids" service-type="registration"></div><pagination boundary-links="true" current-page="page_number" max-size="10" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div><div class="column span4"><div ad-customer-communications="true" ng-model="customer_communications"></div></div></div><div ad-customer-communication="true" anchor-element="#send-reminder-button" customer-communication-type="customer_communication_type" ng-model="customer_communinication" on-save="service_reminder_created()" placement="bottom" service-schedule-ids="selected_service_schedule_ids" showing="showing_service_reminder_dialog"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("service_schedules/upcoming_services.html",'<div ng-controller="UpcomingServicesController"><ul class="sub-nav" ng-controller="ServiceScheduleNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span8"><div class="page-header">Upcoming Services<div class="pull-right"><form class="form-inline search-form"><label>Services due within next: &nbsp;</label><div class="input-append"><input class="input-tiny" ng-model="query.due_within_days" type="number" /><span class="add-on">days</span></div>&nbsp;&nbsp;<label class="control-label">Reminder sent over: &nbsp;</label><div class="input-append"><input class="input-tiny" ng-model="query.last_reminder_days" type="number" /><span class="add-on">days</span></div>&nbsp;<button class="btn btn-primary" ng-click="search()" type="submit">Search</button></form></div></div><div class="sub-header"><div class="row-fluid"><div class="pull-right"><div ng-hide="sending"><span>Selected: {{selected_service_schedule_ids.length}} &nbsp;</span><button class="btn btn-success" id="send-reminder-button" ng-click="show_send_service_reminder_popover()" ng-show="service_schedules.length &gt; 0 &amp;&amp; !sending">Send Reminder</button></div><div ng-show="sending"><span class="alert alert-success">Service Reminder Scheduled. You can check its status on the right hand side panel</span></div></div></div></div></div><div class="column span4"><div class="pull-right"><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button><button class="btn" ng-click="download()"><i class="icon icon-download"></i><span>Download(Excel)</span></button></div></div></div><div class="row-fluid"><div class="column span8"><div ad-service-schedule-list="true" ng-model="service_schedules" selected-service-schedule-ids="selected_service_schedule_ids" service-type="service"></div><pagination boundary-links="true" current-page="page_number" max-size="10" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div><div class="column span4"><div ad-customer-communications="true" ng-model="customer_communications"></div></div></div><div ad-customer-communication="true" anchor-element="#send-reminder-button" customer-communication-type="customer_communication_type" ng-model="customer_communinication" on-save="service_reminder_created()" placement="bottom" service-schedule-ids="selected_service_schedule_ids" showing="showing_service_reminder_dialog"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("service_schedules/wof_overdue_services.html",'<div ng-controller="WofOverdueServicesController"><ul class="sub-nav" ng-controller="ServiceScheduleNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span8"><div class="page-header">{{wof_name()}} Overdues<div class="pull-right"><form class="form-inline search-form"><label>Service Over due by: &nbsp;</label><div class="input-append"><input class="input-tiny" ng-model="query.over_due_days" type="number" /><span class="add-on">days</span></div>&nbsp;&nbsp;<label class="control-label">Reminder sent over: &nbsp;</label><div class="input-append"><input class="input-tiny" ng-model="query.last_reminder_days" type="number" /><span class="add-on">days</span></div>&nbsp;<button class="btn btn-primary" ng-click="search()" type="submit">Search</button></form></div></div><div class="row-fluid"><div class="column span8"><div class="pull-right"><div ng-show="sending"><span class="alert alert-success">Service Reminder Scheduled. You can check its status on the right panel</span><br /><br /></div></div></div><div class="column span4"><div class="pull-right"><div class="sub-header"><div ng-hide="sending"><span>Selected: {{selected_service_schedule_ids.length}} &nbsp;</span><button class="btn btn-success" id="send-reminder-button" ng-click="show_send_service_reminder_popover()" ng-show="service_schedules.length &gt; 0 &amp;&amp; !sending">Send Reminder</button></div></div></div></div></div></div><div class="column span4"><div class="pull-right"><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button><button class="btn" ng-click="download()"><i class="icon icon-download"></i><span>Download(Excel)</span></button></div></div></div><div class="row-fluid"><div class="column span8"><div class="spinner" id="service-schedule-spinner"></div><div ad-service-schedule-list="true" ng-model="service_schedules" selected-service-schedule-ids="selected_service_schedule_ids" service-type="wof"></div><pagination boundary-links="true" current-page="page_number" max-size="10" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div><div class="column span4"><div ad-customer-communications="true" ng-model="customer_communications"></div></div></div><div ad-customer-communication="true" anchor-element="#send-reminder-button" customer-communication-type="customer_communication_type" ng-model="customer_communinication" on-save="service_reminder_created()" placement="bottom" service-schedule-ids="selected_service_schedule_ids" showing="showing_service_reminder_dialog"></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("service_schedules/wof_upcoming_services.html",'<div ng-controller="WofUpcomingServicesController"><ul class="sub-nav" ng-controller="ServiceScheduleNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="column span8"><div class="page-header">Upcoming {{wof_name()}} Due<div class="pull-right"><form class="form-inline search-form"><label>{{wof_name()}} due within next: &nbsp;</label><div class="input-append"><input class="input-tiny" ng-model="query.due_within_days" type="number" /><span class="add-on">days</span></div>&nbsp;&nbsp;<label class="control-label">Reminder sent over: &nbsp;</label><div class="input-append"><input class="input-tiny" ng-model="query.last_reminder_days" type="number" /><span class="add-on">days</span></div>&nbsp;<button class="btn btn-primary" ng-click="search()" type="submit">Search</button></form></div></div><div class="row-fluid"><div class="column span8"><div ng-show="sending"><span class="alert alert-success">{{wof_name()}} Reminder Scheduled. You can check its status on the right panel</span><br /><br /></div></div><div class="colun span4"><div class="pull-right"><div ng-hide="sending"><div class="sub-header"><span>Selected: {{selected_service_schedule_ids.length}} &nbsp;</span><button class="btn btn-success" id="send-reminder-button" ng-click="show_send_service_reminder_popover()" ng-show="service_schedules.length &gt; 0 &amp;&amp; !sending">Send Reminder</button></div></div></div></div></div></div><div class="column span4"><div class="pull-right"><button class="btn" ng-click="print()"><i class="icon icon-print"></i><span>Print</span></button><button class="btn" ng-click="download()"><i class="icon icon-download"></i><span>Download(Excel)</span></button></div></div></div><div class="row-fluid"><div class="column span8"><div class="spinner" id="service-schedule-spinner"></div><div ad-service-schedule-list="true" ng-model="service_schedules" selected-service-schedule-ids="selected_service_schedule_ids" service-type="wof"></div><pagination boundary-links="true" current-page="page_number" max-size="10" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div><div class="column span4"><div ad-customer-communications="true" ng-model="customer_communications"></div></div></div><div ad-customer-communication="true" anchor-element="#send-reminder-button" customer-communication-type="customer_communication_type" ng-model="customer_communinication" on-save="service_reminder_created()" placement="bottom" service-schedule-ids="selected_service_schedule_ids" showing="showing_service_reminder_dialog"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("supplier_credit_notes/allocations.html",'<div ng-show="credit_note.supplier_refunds.length &gt; 0"><div class="sub-header">Refunds</div><table class="table table-striped"><thead><tr><th>Date</th><th>Amount</th><th>Payment Type</th></tr></thead><tbody><tr ng-repeat="refund in credit_note.supplier_refunds"><td>{{refund.date|date: \'mediumDate\'}}</td><td>{{refund.amount|currency}}</td><td>{{refund.payment_type_name}}</td></tr></tbody></table><hr /></div><div class="sub-header">Allocations</div><table class="table table-striped" ng-show="credit_note.allocated_bill_payments.length &gt; 0"><thead><tr><th>Bill Reference#</th><th>Date</th><th>Amount</th><th>Allocated</th><th class="actions"></th></tr></thead><tbody><tr ng-repeat="bpayment in credit_note.allocated_bill_payments"><td>{{bpayment.bill.reference}}</td><td>{{bpayment.bill.date|date:\'mediumDate\'}}</td><td>{{bpayment.bill.total_amount|currency}}</td><td>{{bpayment.amount|currency}} </td><td><div class="pull-right"><a ng-href="#/bills/{{bpayment.bill.id}}" stop-event="click">Bill details</a><span>&nbsp;::&nbsp;</span><a class="red" href="javascript:void(0);" ng-click="remove_bpayment(bpayment)"><i class="icon icon-remove"></i><span>Remove</span></a></div></td></tr></tbody></table><a href="javascript:void(0);" id="add-bills-button" ng-click="add_bills()" ng-show="credit_note.unallocated_amount &gt; 0">Allocate to bills</a><div ad-bill-selection="true" anchor-element="#add-bills-button" credit-note="credit_note" on-select="save_selected_bills()" placement="right" selection="selected_bills" showing="showing_related_bills" supplier="credit_note.billing_supplier"></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("supplier_credit_notes/bill_items.html",'<div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Rate</div><div class="total">Total</div><div class="included-gst"></div></div><div class="cost" ng-repeat="bill_item in credit_note.items"><div class="editable" ng-click="edit_bill_item(bill_item)" ng-hide="bill_item.editing"><div class="description">{{bill_item.description}}<button class="btn btn-link" ng-click="show_bill_item_details(bill_item)" ng-show="bill_item.details &amp;&amp; !bill_item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button><button class="btn btn-link" ng-click="hide_bill_item_details(bill_item)" ng-show="bill_item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button></div><div class="quantity">{{bill_item.quantity}}</div><div class="rate">{{bill_item.unit_price|currency}}</div><div class="total">{{bill_item_total(bill_item) | currency}}</div><div class="included-gst" ng-hide="credit_note.not_registered_for_gst"><span ng-show="bill_item.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="bill_item.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span></div><div class="details" ng-show="bill_item.show_details"><pre class="no-style">{{bill_item.details}}</pre></div></div><div class="editing-item" ng-show="bill_item.editing"><form autocomplete="off" name="edit_bill_item_form" novalidate="true"><div class="error" ng-show="edit_bill_item_form.description.$error.required">description is required</div><div class="error" ng-show="edit_bill_item_form.description.$error.maxlength">description\'s max length is 225 characters, click on "More Details" to add detailed description. </div><div class="error" ng-show="edit_bill_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="edit_bill_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" bill="credit_note" ng-model="bill_item.editing"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_bill_item_amount(bill_item.editing)" ng-model="bill_item.editing.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-change="update_bill_item_amount(bill_item.editing)" ng-model="bill_item.editing.unit_price" required="true" step="any" type="number" /><div ng-show="bill_item.editing.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices  </span> <i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in bill_item.editing.prices"><a href="javascript:void(0);" ng-click="select_price_level(bill_item.editing, price)"><span>{{price|currency}}</span></a></li></ul></div></div></div><div class="total"><input class="input-mini" readonly="true" step="any" type="number" value="{{bill_item_total(bill_item.editing)}}" /></div><br /><div><div class="row-fluid"><a ng-click="edit_bill_item_details(bill_item.editing)" ng-hide="bill_item.details || bill_item.editing.edit_details">More Details</a><div class="pull-right" ng-hide="credit_note.not_registered_for_gst"><div><label class="checkbox"><input ng-model="bill_item.editing.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="bill_item.editing.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><div class="details" ng-show="bill_item.details || bill_item.editing.edit_details"><textarea ng-model="bill_item.editing.details" style="width: 97%; height: 150px;"></textarea></div></div><div class="button-panel"><button class="btn btn-success" ng-click="save_bill_item(edit_bill_item_form, bill_item)">Save</button><button class="btn btn-danger" ng-click="remove_bill_item(bill_item)">Remove</button><button class="btn" ng-click="cancel_edit_bill_item(bill_item)">Cancel</button></div></form></div></div><div ng-hide="new_bill_item"><a href="javascript: void(0);" id="add-item-button" ng-click="add_bill_item()">Add Item</a><span ng-show="credit_note.original_bill"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-bill-item-button" ng-click="add_item_from_bill()">From Bill</a></span></div><div class="bill_item" ng-show="new_bill_item"><form autocomplete="off" name="new_bill_item_form" novalidate="true"><div class="editing-item"><div class="error" ng-show="new_bill_item_form.description.$error.required">description is required</div><div class="error" ng-show="new_bill_item_form.description.$error.maxlength">description\'s max length is 225 characters, click on "More Details" to add detailed description. </div><div class="error" ng-show="new_bill_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="new_bill_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" bill="credit_note" input-id="new-credit-note-item-description" ng-model="new_bill_item"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_bill_item_amount(new_bill_item)" ng-model="new_bill_item.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini inline" name="unit_price" ng-change="update_bill_item_amount(new_bill_item)" ng-model="new_bill_item.unit_price" required="true" step="any" type="number" /><div ng-show="new_bill_item.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices&nbsp;  </span><i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in new_bill_item.prices"><a href="javascript:void(0);" ng-click="select_price_level(new_bill_item, price)"><span>{{price|currency}}</span></a></li></ul></div></div></div><div class="total"><input class="input-mini" readonly="true" step="any" type="number" value="{{bill_item_total(new_bill_item)}}" /></div><br /><div><div class="row-fluid"><a ng-click="edit_bill_item_details(new_bill_item)" ng-hide="new_bill_item.details || new_bill_item.edit_details">More Details</a><div class="pull-right" ng-hide="credit_note.not_registered_for_gst"><div><label class="checkbox inline"><input ng-model="new_bill_item.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="new_bill_item.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><div class="details" ng-show="new_bill_item.details || new_bill_item.edit_details"><textarea ng-model="new_bill_item.details" style="width: 95%; height: 150px;"></textarea></div></div><br /><br /><div><button class="btn btn-success" ng-click="save_new_bill_item()">Save</button><button class="btn" ng-click="cancel_add_bill_item()">Cancel</button><div class="pull-right"><div ad-new-stock="true" generic-item="new_bill_item" is-a-purchase="true" ng-model="new_stock" on-save="select_new_stock()"></div></div></div></div></form></div><div class="summary"><div><div class="title">Total Excl. {{tax_name()}}:</div> <div class="value">{{credit_note.net_amount | currency}}</div></div><div><div class="title">{{tax_name()}}:&nbsp;</div><div class="value">{{credit_note.gst_amount | currency}}</div></div><div ng-show="credit_note.discount_amount"><div class="title">Discount:</div> <div class="value">- {{credit_note.discount_amount | currency}}</div></div><div><div class="title">Total Incl. {{tax_name()}}:</div> <div class="value">{{credit_note.total_item_amount | currency}}</div></div><hr class="divider" /><div class="sub-header">Note To Supplier<div class="pull-right"><button class="btn btn-link" ng-click="edit_credit_note_details()">Add Note To Supplier</button></div></div><div class="editable note" ng-click="edit_credit_note_details()" ng-hide="credit_note.editing_details"><pre class="no-style" ng-show="credit_note.details">{{credit_note.details}}</pre></div><div class="editing-item" ng-show="credit_note.editing_details"><textarea auto-rows="15" class="span12" id="edit-credit_note-details" ng-model="credit_note.editing_details.details"></textarea><button class="btn btn-primary" ng-click="save_credit_note_details()">Save</button><button class="btn btn-danger" ng-click="clear_credit_note_details()">Remove</button><button class="btn" ng-click="cancel_edit_credit_note_details()">Cancel</button></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("supplier_credit_notes/details.html",'<div class="invoice"><div class="spinner" id="credit-note-spinner" style="z-index: 1000"></div><div class="row-fluid editable" ng-click="edit_credit_note()" ng-hide="credit_note.editing"><div class="column span7"><div class="info"><label class="label-name-left auto-width">Supplier:</label><span>{{credit_note.supplier.name}}</span></div><div class="info" ng-show="credit_note.billing_supplier &amp;&amp; credit_note.billing_supplier_id != credit_note.supplier_id"><label class="label-name-left auto-width">Creditor/Buying Group:</label><span>{{credit_note.billing_supplier.name}}</span></div><div class="info" ng-show="credit_note.reference"><span class="label-name-left auto-width">Reference:</span>{{credit_note.reference}}</div><div class="info" ng-show="credit_note.original_bill.id"><span class="label-name-left auto-width">Credit From Bill:</span><a ng-href="#bills/{{credit_note.original_bill_id}}" stop-event="click">Bill #{{credit_note.original_bill.reference || credit_note.original_bill.number}}</a></div><div class="info"><span class="label-name-left auto-width">Date:</span>{{credit_note.date | date: \'mediumDate\'}}</div><div class="info"><span class="label-name-left auto-width">Description:</span>{{credit_note.description}}</div><div class="info"><span class="label-name-left auto-width">Total amount:</span>{{credit_note.total_amount | currency}}</div><div class="info"><span class="label-name-left auto-width">Unallocate amount:</span>{{credit_note.unallocated_amount | currency}}</div><div class="info" ng-show="credit_note.accounting_account"><label class="label-name-left auto-width">Account:</label><span class="bold">{{credit_note.accounting_account.title}}</span></div><div class="info" ng-show="enable_tracking_category_selection()"><span class="label-name-left auto-width">Tracking Categories</span><div class="inline" style="min-width: 40px;">{{credit_note.tracking_categories|comma_seperated: \'option\'}}</div></div></div><div class="column span5"><div class="pull-right pointer" ng-click="show_supplier()"><div id="supplier-details"></div><div class="info"><span class="label-name-left auto-width">Supplier:</span>{{credit_note.supplier.name | na}}</div><div class="info"><span class="label-name-left auto-width">Email:</span>{{credit_note.supplier.email | na}}</div><div class="info"><span class="label-name-left auto-width">Mobile:</span>{{credit_note.supplier.mobile | na}}</div><div class="info" ng-show="supplier.phone"><span class="label-name-left auto-width">Phone:</span>{{credit_note.supplier.phone | na}}</div><div class="info" ng-show="supplier.fax"><span class="label-name-left auto-width">Fax:</span>{{credit_note.supplier.fax | na}}</div></div></div></div><div class="row-fluid" ng-show="credit_note.editing"><div class="editing-item"><form class="form-horizontal"><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><div ng-model="credit_note.editing.supplier_id" supplier="credit_note.editing.supplier" supplierpicker="true"></div></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><div class="error" ng-show="credit_note.editing.errors.reference">{{credit_note.editing.errors.reference|error}}</div><input class="input-small" ng-model="credit_note.editing.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Credit From Bill</label><div class="controls"><div ad-billpicker="true" bill="credit_note.editing.original_bill" ng-model="credit_note.editing.original_bill_id" supplier="credit_note.editing.supplier" supplier-id="credit_note.editing.supplier_id"></div></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="credit_note.editing.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><input class="input-small" ng-model="credit_note.editing.total_amount" type="text" /></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><input ng-model="credit_note.editing.description" type="text" /></div></div><div class="control-group"><label class="control-label">Creditor/Buying Group</label><div class="controls"><div creditorpicker="true" ng-model="credit_note.editing.billing_supplier_id"></div></div></div><div class="control-group"><label class="control-label">Expense/Purchase Account</label><div class="controls"><div accounts="input_accounts" ad-accounting-account-picker="true" ng-model="credit_note.editing.accounting_account_id"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="credit_note.editing"></div></div><br /><br /><div class="action-buttons"><button class="btn btn-success" ng-click="save_credit_note()">Save</button><button class="btn" ng-click="cancel_edit_credit_card()">Cancel</button></div></form></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("supplier_credit_notes/index.html",'<div ng-controller="SupplierCreditNotesController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="page-header">Supplier Credit Notes<div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query.query" type="text" />&nbsp;<button class="btn" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="row-fluid"><div class="pull-right"><a class="btn btn-primary" ng-href="#/supplier_credit_notes/new"><span>New Supplier Credit Note</span></a></div></div><div class="row-fluid"><div class="column span4"><label class="checkbox"><input ng-click="toggle_unallocated()" ng-model="query.unallocated" type="checkbox" /><span>Show</span> <span class="label label-info">Unallocated</span> <span>Credit Notes Only</span></label><label class="checkbox"><input ng-click="toggle_deleted()" ng-model="query.deleted" type="checkbox" /><span>Show</span> <span class="label">Deleted</span> <span>Credit Notes Only</span></label></div><div class="column span4"><div><label class="checkbox"><input ng-click="toggle_finalized()" ng-model="query.finalized" type="checkbox" /><span>Show</span> <span class="label label-success">Finalized</span> <span>Credit Notes Only</span></label></div><div><label class="checkbox"><input ng-click="toggle_in_progress()" ng-model="query.in_progress" type="checkbox" /><span>Show</span> <span class="label label-info">In Progress</span> <span>Credit Notes Only</span></label></div></div></div><br /></div><div class="search-description" ng-show="keyword">Search "{{keyword}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="content-box"><div class="spinner" id="supplier-credit-notes-spinner"></div><table class="table table-striped" ng-show="query.deleted"><thead><tr><th>Supplier</th><th>Date</th><th>Amount</th><th>Unallocated amount</th><th>Reference</th><th>Deleted By</th><th>Deleted Reason</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/supplier_credit_notes/&#39; + credit_note.id)" ng-repeat=" credit_note in credit_notes"><td>{{credit_note.supplier.name}}</td><td>{{credit_note.date |date: \'mediumDate\'}}</td><td>{{credit_note.total_amount|currency}}</td><td>{{credit_note.unallocated_amount|currency}}</td><td>{{credit_note.reference}}</td><td>{{credit_note.deleted_by.name}}</td><td>{{credit_note.deleted_reason}}</td></tr></tbody></table><table class="table table-striped" ng-hide="query.deleted"><thead><tr><th>Supplier</th><th>Date</th><th>Amount</th><th>Unallocated amount</th><th>Reference</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/supplier_credit_notes/&#39; + credit_note.id)" ng-repeat=" credit_note in credit_notes"><td>{{credit_note.supplier.name}}</td><td>{{credit_note.date |date: \'mediumDate\'}}</td><td>{{credit_note.total_amount|currency}}</td><td>{{credit_note.unallocated_amount|currency}}</td><td>{{credit_note.reference}}</td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="10" num-pages="total_pages" on-select-page="search(page)" rotate="false"></pagination></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("supplier_credit_notes/new.html",'<div ng-controller="NewSupplierCreditNoteController"><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header">New Supplier Credit Note</div><div class="content-box"><div class="row-fluid"><div class="column span7"><form autocomplete="off" class="form-horizontal"><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><div ng-model="credit_note.supplier_id" supplier="credit_note.supplier" supplierpicker="true"></div></div></div></form><form class="form-horizontal"><div class="control-group"><label class="control-label">Reference</label><div class="controls"><div class="error" ng-show="credit_note.errors.reference">{{credit_note.errors.reference|error}}</div><input ng-model="credit_note.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Credit From Bill</label><div class="controls"><div ad-billpicker="true" bill="credit_note.bill" ng-model="credit_note.original_bill_id" supplier="credit_note.supplier" supplier-id="credit_note.supplier_id"></div></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="credit_note.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><input class="input-small" ng-model="credit_note.total_amount" type="text" /></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><input class="span8" ng-model="credit_note.description" type="text" /></div></div><div class="control-group"><label class="control-label">Creditor/Buying Group</label><div class="controls"><div creditorpicker="true" ng-model="credit_note.billing_supplier_id"></div></div></div><div class="control-group"><label class="control-label">Expense/Purchase Account</label><div class="controls"><div accounts="input_accounts" ad-accounting-account-picker="true" ng-model="credit_note.accounting_account_id"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="credit_note"></div></div><br /><br /><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="save_credit_note()">Continue</button><button class="btn" ng-click="back()">Cancel</button><div class="spinner" id="new-supplier-credit-note-spinner"></div></div></div></form></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("supplier_credit_notes/show.html",'<div ng-controller="SupplierCreditNoteController"><div class="deleted-sign" ng-show="credit_note.deleted"><img ng-src="/assets/deleted-ebc9c967802c758f084cb68b1966dcdf.png" /></div><ul class="sub-nav" ng-controller="AccountingNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="row-fluid"><div class="page-header">Supplier Credit Note #{{credit_note.reference}}</div></div><div class="row-fluid"><div class="pull-right"><button class="btn" id="create-refund-button" ng-click="open_refund()" ng-hide="credit_note.deleted || credit_note.unallocated_amount &lt;= 0"><i class="icon icon-dollar"></i><span>Refund</span></button><a class="btn" ng-hide="credit_note.deleted" ng-href="/supplier_credit_notes/{{credit_note.id}}/print.pdf" target="_blank"><i class="icon icon-print"></i><span>Print</span></a><button class="btn" id="supplier-credit-note-send-email-button" ng-click="open_send_email()" ng-hide="credit_note.deleted"><i class="icon-print"></i>Email Return Advice</button><button class="btn btn-danger" ng-click="open_delete_dialog()" ng-hide="credit_note.deleted">Delete</button></div></div><br /><div class="row-fluid"><div class="column span6"><div class="content-box"><div class="invoice"><div class="spinner" id="credit-note-spinner" style="z-index: 1000"></div><div class="row-fluid editable" ng-click="edit_credit_note()" ng-hide="credit_note.editing"><div class="column span7"><div class="info"><label class="label-name-left auto-width">Supplier:</label><span>{{credit_note.supplier.name}}</span></div><div class="info" ng-show="credit_note.billing_supplier &amp;&amp; credit_note.billing_supplier_id != credit_note.supplier_id"><label class="label-name-left auto-width">Creditor/Buying Group:</label><span>{{credit_note.billing_supplier.name}}</span></div><div class="info" ng-show="credit_note.reference"><span class="label-name-left auto-width">Reference:</span>{{credit_note.reference}}</div><div class="info" ng-show="credit_note.original_bill.id"><span class="label-name-left auto-width">Credit From Bill:</span><a ng-href="#bills/{{credit_note.original_bill_id}}" stop-event="click">Bill #{{credit_note.original_bill.reference || credit_note.original_bill.number}}</a></div><div class="info"><span class="label-name-left auto-width">Date:</span>{{credit_note.date | date: \'mediumDate\'}}</div><div class="info"><span class="label-name-left auto-width">Description:</span>{{credit_note.description}}</div><div class="info"><span class="label-name-left auto-width">Total amount:</span>{{credit_note.total_amount | currency}}</div><div class="info"><span class="label-name-left auto-width">Unallocate amount:</span>{{credit_note.unallocated_amount | currency}}</div><div class="info" ng-show="credit_note.accounting_account"><label class="label-name-left auto-width">Account:</label><span class="bold">{{credit_note.accounting_account.title}}</span></div><div class="info" ng-show="enable_tracking_category_selection()"><span class="label-name-left auto-width">Tracking Categories</span><div class="inline" style="min-width: 40px;">{{credit_note.tracking_categories|comma_seperated: \'option\'}}</div></div></div><div class="column span5"><div class="pull-right pointer" ng-click="show_supplier()"><div id="supplier-details"></div><div class="info"><span class="label-name-left auto-width">Supplier:</span>{{credit_note.supplier.name | na}}</div><div class="info"><span class="label-name-left auto-width">Email:</span>{{credit_note.supplier.email | na}}</div><div class="info"><span class="label-name-left auto-width">Mobile:</span>{{credit_note.supplier.mobile | na}}</div><div class="info" ng-show="supplier.phone"><span class="label-name-left auto-width">Phone:</span>{{credit_note.supplier.phone | na}}</div><div class="info" ng-show="supplier.fax"><span class="label-name-left auto-width">Fax:</span>{{credit_note.supplier.fax | na}}</div></div></div></div><div class="row-fluid" ng-show="credit_note.editing"><div class="editing-item"><form class="form-horizontal"><div class="control-group"><label class="control-label">Supplier</label><div class="controls"><div ng-model="credit_note.editing.supplier_id" supplier="credit_note.editing.supplier" supplierpicker="true"></div></div></div><div class="control-group"><label class="control-label">Reference</label><div class="controls"><div class="error" ng-show="credit_note.editing.errors.reference">{{credit_note.editing.errors.reference|error}}</div><input class="input-small" ng-model="credit_note.editing.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Credit From Bill</label><div class="controls"><div ad-billpicker="true" bill="credit_note.editing.original_bill" ng-model="credit_note.editing.original_bill_id" supplier="credit_note.editing.supplier" supplier-id="credit_note.editing.supplier_id"></div></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="credit_note.editing.date"></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><input class="input-small" ng-model="credit_note.editing.total_amount" type="text" /></div></div><div class="control-group"><label class="control-label">Description</label><div class="controls"><input ng-model="credit_note.editing.description" type="text" /></div></div><div class="control-group"><label class="control-label">Creditor/Buying Group</label><div class="controls"><div creditorpicker="true" ng-model="credit_note.editing.billing_supplier_id"></div></div></div><div class="control-group"><label class="control-label">Expense/Purchase Account</label><div class="controls"><div accounts="input_accounts" ad-accounting-account-picker="true" ng-model="credit_note.editing.accounting_account_id"></div></div></div><div ng-show="enable_tracking_category_selection()"><div ad-tracking-category-selection="" ng-model="credit_note.editing"></div></div><br /><br /><div class="action-buttons"><button class="btn btn-success" ng-click="save_credit_note()">Save</button><button class="btn" ng-click="cancel_edit_credit_card()">Cancel</button></div></form></div></div></div><hr /><div ng-show="credit_note.supplier_refunds.length &gt; 0"><div class="sub-header">Refunds</div><table class="table table-striped"><thead><tr><th>Date</th><th>Amount</th><th>Payment Type</th></tr></thead><tbody><tr ng-repeat="refund in credit_note.supplier_refunds"><td>{{refund.date|date: \'mediumDate\'}}</td><td>{{refund.amount|currency}}</td><td>{{refund.payment_type_name}}</td></tr></tbody></table><hr /></div><div class="sub-header">Allocations</div><table class="table table-striped" ng-show="credit_note.allocated_bill_payments.length &gt; 0"><thead><tr><th>Bill Reference#</th><th>Date</th><th>Amount</th><th>Allocated</th><th class="actions"></th></tr></thead><tbody><tr ng-repeat="bpayment in credit_note.allocated_bill_payments"><td>{{bpayment.bill.reference}}</td><td>{{bpayment.bill.date|date:\'mediumDate\'}}</td><td>{{bpayment.bill.total_amount|currency}}</td><td>{{bpayment.amount|currency}} </td><td><div class="pull-right"><a ng-href="#/bills/{{bpayment.bill.id}}" stop-event="click">Bill details</a><span>&nbsp;::&nbsp;</span><a class="red" href="javascript:void(0);" ng-click="remove_bpayment(bpayment)"><i class="icon icon-remove"></i><span>Remove</span></a></div></td></tr></tbody></table><a href="javascript:void(0);" id="add-bills-button" ng-click="add_bills()" ng-show="credit_note.unallocated_amount &gt; 0">Allocate to bills</a><div ad-bill-selection="true" anchor-element="#add-bills-button" credit-note="credit_note" on-select="save_selected_bills()" placement="right" selection="selected_bills" showing="showing_related_bills" supplier="credit_note.billing_supplier"></div></div></div><div class="column span6"><div class="content-box"><div ng-show="credit_note.id"><div ng-hide="credit_note.finalized"><span class="label label-info">In progress</span><button class="btn btn-link" ng-click="finalize()">Finalize</button></div><div ng-show="credit_note.finalized"><span class="label label-success">Finalized</span></div></div><div class="row-fluid" ng-show="total_amount_match_total_item_amount"><div class="red">Credit note amount, {{credit_note.total_amount|currency}}, does not match total item amount, {{credit_note.total_item_amount|currency}}</div></div><br /><hr /><div class="cost-table"><div class="header"><div class="description">Description</div><div class="quantity">Qty.</div><div class="rate">Rate</div><div class="total">Total</div><div class="included-gst"></div></div><div class="cost" ng-repeat="bill_item in credit_note.items"><div class="editable" ng-click="edit_bill_item(bill_item)" ng-hide="bill_item.editing"><div class="description">{{bill_item.description}}<button class="btn btn-link" ng-click="show_bill_item_details(bill_item)" ng-show="bill_item.details &amp;&amp; !bill_item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button><button class="btn btn-link" ng-click="hide_bill_item_details(bill_item)" ng-show="bill_item.show_details" stop-event="click"><i class="icon icon-info-sign"></i></button></div><div class="quantity">{{bill_item.quantity}}</div><div class="rate">{{bill_item.unit_price|currency}}</div><div class="total">{{bill_item_total(bill_item) | currency}}</div><div class="included-gst" ng-hide="credit_note.not_registered_for_gst"><span ng-show="bill_item.included_gst">&nbsp; (incl. {{tax_name()|lowercase}})</span><span ng-show="bill_item.gst_free">&nbsp; ({{tax_name()|lowercase}} free)</span></div><div class="details" ng-show="bill_item.show_details"><pre class="no-style">{{bill_item.details}}</pre></div></div><div class="editing-item" ng-show="bill_item.editing"><form autocomplete="off" name="edit_bill_item_form" novalidate="true"><div class="error" ng-show="edit_bill_item_form.description.$error.required">description is required</div><div class="error" ng-show="edit_bill_item_form.description.$error.maxlength">description\'s max length is 225 characters, click on "More Details" to add detailed description. </div><div class="error" ng-show="edit_bill_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="edit_bill_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" bill="credit_note" ng-model="bill_item.editing"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_bill_item_amount(bill_item.editing)" ng-model="bill_item.editing.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini" name="unit_price" ng-change="update_bill_item_amount(bill_item.editing)" ng-model="bill_item.editing.unit_price" required="true" step="any" type="number" /><div ng-show="bill_item.editing.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices  </span> <i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in bill_item.editing.prices"><a href="javascript:void(0);" ng-click="select_price_level(bill_item.editing, price)"><span>{{price|currency}}</span></a></li></ul></div></div></div><div class="total"><input class="input-mini" readonly="true" step="any" type="number" value="{{bill_item_total(bill_item.editing)}}" /></div><br /><div><div class="row-fluid"><a ng-click="edit_bill_item_details(bill_item.editing)" ng-hide="bill_item.details || bill_item.editing.edit_details">More Details</a><div class="pull-right" ng-hide="credit_note.not_registered_for_gst"><div><label class="checkbox"><input ng-model="bill_item.editing.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="bill_item.editing.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><div class="details" ng-show="bill_item.details || bill_item.editing.edit_details"><textarea ng-model="bill_item.editing.details" style="width: 97%; height: 150px;"></textarea></div></div><div class="button-panel"><button class="btn btn-success" ng-click="save_bill_item(edit_bill_item_form, bill_item)">Save</button><button class="btn btn-danger" ng-click="remove_bill_item(bill_item)">Remove</button><button class="btn" ng-click="cancel_edit_bill_item(bill_item)">Cancel</button></div></form></div></div><div ng-hide="new_bill_item"><a href="javascript: void(0);" id="add-item-button" ng-click="add_bill_item()">Add Item</a><span ng-show="credit_note.original_bill"><span>&nbsp; :: &nbsp;</span><a href="javascript: void(0);" id="add-bill-item-button" ng-click="add_item_from_bill()">From Bill</a></span></div><div class="bill_item" ng-show="new_bill_item"><form autocomplete="off" name="new_bill_item_form" novalidate="true"><div class="editing-item"><div class="error" ng-show="new_bill_item_form.description.$error.required">description is required</div><div class="error" ng-show="new_bill_item_form.description.$error.maxlength">description\'s max length is 225 characters, click on "More Details" to add detailed description. </div><div class="error" ng-show="new_bill_item_form.quantity.$invalid">quantity must be a number</div><div class="error" ng-show="new_bill_item_form.unit_price.$invalid">unit price must be a number</div><div class="description"><div ad-invoice-item-input="true" bill="credit_note" input-id="new-credit-note-item-description" ng-model="new_bill_item"></div></div><div class="quantity"><input class="input-tiny" name="quantity" ng-change="update_bill_item_amount(new_bill_item)" ng-model="new_bill_item.quantity" required="true" step="any" type="number" /></div><div class="rate"><input class="input-mini inline" name="unit_price" ng-change="update_bill_item_amount(new_bill_item)" ng-model="new_bill_item.unit_price" required="true" step="any" type="number" /><div ng-show="new_bill_item.prices.length &gt; 1"><div class="dropdown inline"><a class="btn-top" dropdown-toggle="true"><span style="color: black">Prices&nbsp;  </span><i class="icon icon-caret-down" style="color: black"></i></a><ul class="dropdown-menu top-dropdown"><li ng-repeat="price in new_bill_item.prices"><a href="javascript:void(0);" ng-click="select_price_level(new_bill_item, price)"><span>{{price|currency}}</span></a></li></ul></div></div></div><div class="total"><input class="input-mini" readonly="true" step="any" type="number" value="{{bill_item_total(new_bill_item)}}" /></div><br /><div><div class="row-fluid"><a ng-click="edit_bill_item_details(new_bill_item)" ng-hide="new_bill_item.details || new_bill_item.edit_details">More Details</a><div class="pull-right" ng-hide="credit_note.not_registered_for_gst"><div><label class="checkbox inline"><input ng-model="new_bill_item.included_gst" type="checkbox" /><span class="bold">Incl. {{tax_name()}}</span></label></div><div><label class="checkbox"><input ng-model="new_bill_item.gst_free" type="checkbox" /><span class="bold">{{tax_name()}} Free</span></label></div></div></div><div class="details" ng-show="new_bill_item.details || new_bill_item.edit_details"><textarea ng-model="new_bill_item.details" style="width: 95%; height: 150px;"></textarea></div></div><br /><br /><div><button class="btn btn-success" ng-click="save_new_bill_item()">Save</button><button class="btn" ng-click="cancel_add_bill_item()">Cancel</button><div class="pull-right"><div ad-new-stock="true" generic-item="new_bill_item" is-a-purchase="true" ng-model="new_stock" on-save="select_new_stock()"></div></div></div></div></form></div><div class="summary"><div><div class="title">Total Excl. {{tax_name()}}:</div> <div class="value">{{credit_note.net_amount | currency}}</div></div><div><div class="title">{{tax_name()}}:&nbsp;</div><div class="value">{{credit_note.gst_amount | currency}}</div></div><div ng-show="credit_note.discount_amount"><div class="title">Discount:</div> <div class="value">- {{credit_note.discount_amount | currency}}</div></div><div><div class="title">Total Incl. {{tax_name()}}:</div> <div class="value">{{credit_note.total_item_amount | currency}}</div></div><hr class="divider" /><div class="sub-header">Note To Supplier<div class="pull-right"><button class="btn btn-link" ng-click="edit_credit_note_details()">Add Note To Supplier</button></div></div><div class="editable note" ng-click="edit_credit_note_details()" ng-hide="credit_note.editing_details"><pre class="no-style" ng-show="credit_note.details">{{credit_note.details}}</pre></div><div class="editing-item" ng-show="credit_note.editing_details"><textarea auto-rows="15" class="span12" id="edit-credit_note-details" ng-model="credit_note.editing_details.details"></textarea><button class="btn btn-primary" ng-click="save_credit_note_details()">Save</button><button class="btn btn-danger" ng-click="clear_credit_note_details()">Remove</button><button class="btn" ng-click="cancel_edit_credit_note_details()">Cancel</button></div></div></div></div><div class="content-box" ng-show="credit_note.remote_id"><div class="sub-header">Accounting Integration</div><div>Synced To ID {{credit_note.remote_id}}</div><div ng-show="credit_note.remote_url"><span>Please click </span> <a ng-href="{{credit_note.remote_url}}" target="_blank">Here</a> <span>to access the Credit Note in Accounting Software</span></div></div></div></div><div modal="showing_delete_credit_note_dialog" options="{&#39;dialogClass&#39;: &#39;modal&#39;}"><div class="modal-header"><h3>Delete This Supplier Credit Note</h3></div><div class="modal-body"><div>Are you sure you want to delete this supplier credit note?</div><br /><div class="bold">Delete Reason</div><textarea ng-model="deleted_reason" style="width: 90%"></textarea></div><div class="modal-footer"><button class="btn btn-danger" ng-click="do_delete_credit_note()">Yes, Delete It</button><button class="btn" ng-click="cancel_delete_credit_note()">Cancel</button></div></div><div id="create-refund"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">Refund</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form class="form-horizontal"><div class="control-group"><label class="control-label">Payment Type</label><div class="controls"><div class="input-append"><select ng-model="refund.payment_method_id" ng-options="pt.id as pt.name for pt in payment_methods" type="text"></select></div></div></div></form><form class="form-horizontal"><div class="control-group"><label class="control-label">Reference</label><div class="controls"><input ng-model="refund.reference" type="text" /></div></div><div class="control-group"><label class="control-label">Date</label><div class="controls"><ad-datepicker ng-model="refund.date"><span class="add-on"><i class="icon-calendar"></i></span></ad-datepicker></div></div><div class="control-group"><label class="control-label">Amount</label><div class="controls"><div class="input-append"><input class="input-small" ng-model="refund.amount" type="text" /></div></div></div><div class="control-group" ng-show="show_select_bank_account()"><label class="control-label">Refund From Account</label><div class="controls"><button class="btn btn-link" ng-click="choose_specific_bank_account = true" ng-hide="choose_specific_bank_account">Choose specific bank account</button><div ng-show="choose_specific_bank_account"><div accounts="bank_accounts()" ad-accounting-account-picker="true" ng-model="refund.accounting_account_id"></div></div></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn btn-success" ng-click="do_refund()">Refund</button><button class="btn" ng-click="close_refund()">Cancel</button></div></div></form></div></div></div></div></div><div id="supplier-credit-note-send-email"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">Send Email</div></div><div class="popover-content"><div class="row-fluid"><div class="content-box"><form><div class="pull-right"><div class="inline" id="supplier-credit-note-send-email-spinner"></div></div><label>Email</label><input class="span9" id="supplier-credit-note-send-email-address" ng-model="email" type="text" /><label>Subject</label><input class="span12" id="supplier-credit-note-send-email-address" ng-model="subject" type="text" /><label>Message</label><textarea class="span12" id="supplier-credit-note-send-email-message" ng-model="message" rows="6" type="text"></textarea><div><button class="btn btn-success" ng-click="send_email()">Send</button><button class="btn" ng-click="cancel()">Cancel</button></div></form></div></div></div></div></div><div id="return-item-selection"><div class="popover fade left in" style="width: 750px"><div class="popover-title"><div class="sub-header">Returning items...</div></div><div class="popover-content"><div class="content-box"><table class="table"><thead><tr><td class="bold">Description</td><td class="bold">Quantity</td><td class="bold">Unit Price</td><td class="bold">Returning</td></tr></thead><tbody><tr class="goto" ng-click="toggle_item_from_bill(item)" ng-hide="item.header" ng-repeat="item in credit_note.original_bill.bill_items"><td>{{item.description}}</td><td>{{item.quantity}}</td><td>{{item.unit_price}}</td><td><span ng-show="item.selected"><input class="input input-tiny" ng-model="item.returning_quantity" step="any" stop-event="click" type="number" /><span class="red" ng-show="item.returning_quantity &gt; item.quantity">Cannot > Bill quantity</span></span></td></tr></tbody></table><br /></div><div class="buttons"><button class="btn btn-success" ng-click="do_select_item_from_bill()">Select</button><button class="btn" ng-click="close_add_item_from_bill()">Cancel</button><div class="spinner" id="returning-items-spinner"></div></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("support_portal/dashboard/actions.html",'<div class="row-fluid" ng-show="current_auto_workshop.id"><div class="column span4"><div ng-show="view == &#39;basic&#39;"><div class="sub-header">ADMIN</div><div class="control-group"><div class="controls"><button class="btn btn-danger inline" ng-click="lock_auto_workshop()" ng-hide="auto_workshop.locked" style="width: 75%">Lock</button><div>&nbsp;</div><button class="btn btn-default inline" ng-click="unlock_auto_workshop()" ng-show="auto_workshop.locked" style="width: 75%">Unlock</button></div></div><div class="control-group" ng-hide="auto_workshop.locked"><label class="control-label"><span>Locking Reason </span><span class="error">(SEEN BY CUSTOMER)</span></label><div class="controls"><input class="no-margin" ng-hide="auto_workshop.locked" ng-model="locking_reason" /></div></div><div ng-show="auto_workshop.owing"><div>Last invoice created: {{auto_workshop.last_invoice_creation_date | date : "dd/MM/yyyy" }}</div><div>Last MD invoice: {{auto_workshop.last_MD_invoice_date | date : "dd/MM/yyyy" }}</div><div># of MD invoices: {{auto_workshop.number_of_MD_invoices}}</div></div></div><div ng-show="view == &#39;advsettings&#39;"><div class="sub-header">ADV SETTINGS</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;manual_job_number&#39;, auto_workshop.manual_job_number)" ng-model="auto_workshop.manual_job_number" type="checkbox" /><span>&nbsp; Manual Job Number</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;allow_invoice_item_on_timesheet&#39;, auto_workshop.allow_invoice_item_on_timesheet)" ng-model="auto_workshop.allow_invoice_item_on_timesheet" type="checkbox" /><span>&nbsp; Inv. Item on Timesheet</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;no_courtesy_vehicle&#39;, auto_workshop.no_courtesy_vehicle)" ng-model="auto_workshop.no_courtesy_vehicle" type="checkbox" /><span>&nbsp; No Courtesy Vehicle</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;show_quantity_on_stock_selection&#39;, auto_workshop.show_quantity_on_stock_selection)" ng-model="auto_workshop.show_quantity_on_stock_selection" type="checkbox" /><span>&nbsp; Show Quantity on Stock Selection</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;simple_stock_lookup&#39;, auto_workshop.simple_stock_lookup)" ng-model="auto_workshop.simple_stock_lookup" type="checkbox" /><span>&nbsp; Simple Stock Lookup</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;allow_sub_jobs&#39;, auto_workshop.allow_sub_jobs)" ng-model="auto_workshop.allow_sub_jobs" type="checkbox" /><span>&nbsp; Allow Sub Jobs</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;enable_undelete&#39;, auto_workshop.enable_undelete)" ng-model="auto_workshop.enable_undelete" type="checkbox" /><span>&nbsp; Allow Undelete</span></div></div><div ng-show="view == &#39;psettings&#39;"><div class="sub-header">PAGE SETTINGS</div><div class="bold">Printing Templates</div><div><div>&nbsp; Invoice Template</div><input class="no-margin" ng-model="auto_workshop.invoice_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;invoice_template&#39;, auto_workshop.invoice_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Job Card Template</div><input class="no-margin" ng-model="auto_workshop.job_card_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;job_card_template&#39;, auto_workshop.job_card_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Quote Template</div><input class="no-margin" ng-model="auto_workshop.quote_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;quote_template&#39;, auto_workshop.quote_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Payment Template</div><input class="no-margin" ng-model="auto_workshop.payment_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;payment_template&#39;, auto_workshop.payment_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Barcode Template</div><input class="no-margin" ng-model="auto_workshop.barcode_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;barcode_template&#39;, auto_workshop.barcode_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Label Template</div><input class="no-margin" ng-model="auto_workshop.label_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;label_template&#39;, auto_workshop.label_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Runsheet Template</div><input class="no-margin" ng-model="auto_workshop.run_sheet_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;run_sheet_template&#39;, auto_workshop.run_sheet_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><br /><div class="bold">Page Setup</div><div><input class="no-margin" ng-model="auto_workshop.print_margin_top" style="width: 25px;" type="text" /><span>&nbsp; px Top Margin</span><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;print_margin_top&#39;, auto_workshop.print_margin_top)">&nbsp; Set</a></div><div><input class="no-margin" ng-model="auto_workshop.print_margin_bottom" style="width: 25px;" type="text" /><span>&nbsp; px Bottom Margin</span><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;print_margin_bottom&#39;, auto_workshop.print_margin_bottom)">&nbsp; Set</a></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_use_letter_head&#39;, auto_workshop.print_use_letter_head)" ng-model="auto_workshop.print_use_letter_head" type="checkbox" /><span>&nbsp; Use Letterheads</span></div><br /><div class="bold">Logo Settings</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;use_full_size_logo&#39;, auto_workshop.use_full_size_logo)" ng-model="auto_workshop.use_full_size_logo" type="checkbox" /><span>&nbsp; Use Full Size Logo</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;use_large_logo&#39;, auto_workshop.use_large_logo)" ng-model="auto_workshop.use_large_logo" type="checkbox" /><span>&nbsp; Use Large Logo</span></div></div></div><div class="column span4"><div ng-show="view == &#39;basic&#39;"><div class="sub-header">ADDRESS</div><div ng-hide="current_auto_workshop.id">&nbsp;</div><div ng-show="current_auto_workshop.id">{{auto_workshop.address.full_address}}</div><br /><div class="sub-header">EMPLOYEES</div><div ng-repeat="employee in auto_workshop.employees"><a href="javascript:void(0)" ng-click="show_change_password(employee.id)" style="color: {{role_color(employee.role)}}; width: 100%" tooltip="ID: {{employee.id}} -- {{employee.role}}"><span class="bold">n:>&nbsp; </span><span>{{employee.name}}&nbsp;</span><span class="bold">&nbsp;&nbsp;u:>&nbsp;</span><span>{{employee.username}}</span></a><div class="control-group" ng-show="changing_password == employee.id"><div>Update password</div><div class="ok" ng-show="password_changed">Password update successful</div><div class="controls"><input class="no-margin" ng-model="current_auto_workshop.new_password" style="width: 45%" type="text" /><button class="btn btn-danger inline" ng-click="change_password(employee.id)" style="margin-rigth: 5px; margin-left: 5px;">Update</button><button class="btn btn-default inline" ng-click="cancel_change_password()">Cancel</button></div></div></div></div><div ng-show="view == &#39;advsettings&#39;"><div class="sub-header">ADV SETTINGS</div><div><div>&nbsp; Timesheet Item Stock ID</div><input class="no-margin" ng-model="auto_workshop.timesheet_item_stock_id" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;timesheet_item_stock_id&#39;, auto_workshop.timesheet_item_stock_id)">&nbsp; Set</a></div><br /><div id="md-invoices">&nbsp; Account invoices</div><div class="container-fluid"><div class="row-fluid"><div class="column span2">No.</div><div class="column span6">Description</div><div class="column span2">Amount</div></div><div class="row-fluid" ng-click="confirm_delete_md_invoice(invoice.id)" ng-mouseleave="bgColour={&#39;background-color&#39;: &#39;none&#39;}" ng-mouseover="bgColour={&#39;background-color&#39;: &#39;orange&#39;}" ng-repeat="invoice in auto_workshop.mechanic_desk_invoices" ng-style="bgColour"><div class="column span2"><a href="javascript:void(0)">{{invoice.number}}</a></div><div class="column span6"><a href="javascript:void(0)">{{invoice.description}}</a></div><div class="column span2"><a href="javascript:void(0)">{{invoice.total_amount}}</a></div></div></div><div id="delete-md-invoice"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">Delete MD Invoice {{md_invoice}}. Are you sure?</div></div><div class="popover-content"><div class="content-box"><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn" ng-click="close_confirm_delete_md_invoice()">Cancel</button><button class="btn btn-danger" ng-click="delete_md_invoice(md_invoice)">Delete</button></div></div></div></div></div></div></div><div ng-show="view == &#39;psettings&#39;"><div class="sub-header">CONTENT SETTINGS</div><div class="bold">Content Settings - Customer</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_customer_address_on_job_card&#39;, auto_workshop.print_customer_address_on_job_card)" ng-model="auto_workshop.print_customer_address_on_job_card" type="checkbox" /><span>&nbsp; Customer Address on Job Card</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_show_customer_number&#39;, auto_workshop.print_show_customer_number)" ng-model="auto_workshop.print_show_customer_number" type="checkbox" /><span>&nbsp; Show Customer Number</span></div><br /><div class="bold">Content Settings - Job Card</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_job_card_name_only&#39;, auto_workshop.print_job_card_name_only)" ng-model="auto_workshop.print_job_card_name_only" type="checkbox" /><span>&nbsp; Print Job Card Name Only</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_job_start_date&#39;, auto_workshop.print_job_start_date)" ng-model="auto_workshop.print_job_start_date" type="checkbox" /><span>&nbsp; Print Job Start Date</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_hide_description&#39;, auto_workshop.print_hide_description)" ng-model="auto_workshop.print_hide_description" type="checkbox" /><span>&nbsp; Hide Description</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_timesheet&#39;, auto_workshop.print_timesheet)" ng-model="auto_workshop.print_timesheet" type="checkbox" /><span>&nbsp; Print Timesheets</span></div><br /><div class="bold">Content Settings - Invoices, Bills, Quotes</div><div><div>&nbsp; Quote Title</div><input class="no-margin" ng-model="auto_workshop.quote_title" type="text" /><a href="set_workshop_attribute(&#39;quote_title&#39;, auto_workshop.quote_title)">&nbsp; Set</a></div><br /><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_hide_item_with_zero_price&#39;, auto_workshop.print_hide_item_with_zero_price)" ng-model="auto_workshop.print_hide_item_with_zero_price" type="checkbox" /><span>&nbsp; Hide Zero Price Item</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_invoice_price_include_gst&#39;, auto_workshop.print_invoice_price_include_gst)" ng-model="auto_workshop.print_invoice_price_include_gst" type="checkbox" /><span>&nbsp; Print Invoice Prices GST Inclusive</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_without_invoice_details&#39;, auto_workshop.print_without_invoice_details)" ng-model="auto_workshop.print_without_invoice_details" type="checkbox" /><span>&nbsp; Print Without Invoice Details</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_quote_price_include_gst&#39;, auto_workshop.print_quote_price_include_gst)" ng-model="auto_workshop.print_quote_price_include_gst" type="checkbox" /><span>&nbsp; Print Quote Prices GST Inclusive</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_price_on_header_item&#39;, auto_workshop.print_price_on_header_item)" ng-model="auto_workshop.print_price_on_header_item" type="checkbox" /><span>&nbsp; Print Price On Header Items</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_unit_price_two_decimal&#39;, auto_workshop.print_unit_price_two_decimal)" ng-model="auto_workshop.print_unit_price_two_decimal" type="checkbox" /><span>&nbsp; Unit Prices To 2 Decimal Places</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_with_payment_term&#39;, auto_workshop.print_with_payment_term)" ng-model="auto_workshop.print_with_payment_term" type="checkbox" /><span>&nbsp; Print Payment Terms</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_without_stock_number&#39;, auto_workshop.print_without_stock_number)" ng-model="auto_workshop.print_without_stock_number" type="checkbox" /><span>&nbsp; Print Without Stock Number</span></div><br /><div class="bold">Content Settings - PO</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;disable_purchase_order_item_price&#39;, auto_workshop.disable_purchase_order_item_price)" ng-model="auto_workshop.disable_purchase_order_item_price" type="checkbox" /><span>&nbsp; Hide Prices On Purchase Orders</span></div></div></div><div class="column span4"><div class="sub-header">SETTINGS</div><div class="control-group"><div class="controls"><i class="icon icon-chevron-left" ng-show="view == &#39;basic&#39;" style="color: orange; margin-right: 5px;"></i><div class="inline" ng-show="view == &#39;basic&#39;" style="width: 15px;">&nbsp;</div><div class="inline" ng-hide="view == &#39;basic&#39;" style="width: 25px;">&nbsp;</div><button class="btn btn-default inline" ng-click="view_switch(&#39;basic&#39;)">BASIC</button></div></div><div class="control-group"><div class="controls"><i class="icon icon-chevron-left" ng-show="view == &#39;advsettings&#39;" style="color: orange; margin-right: 5px;"></i><div class="inline" ng-show="view == &#39;advsettings&#39;" style="width: 15px;">&nbsp;</div><div class="inline" ng-hide="view == &#39;advsettings&#39;" style="width: 25px;">&nbsp;</div><button class="btn btn-default inline" ng-click="view_switch(&#39;advsettings&#39;)">ADV</button></div></div><div class="control-group"><div class="controls"><i class="icon icon-chevron-left" ng-show="view == &#39;psettings&#39;" style="color: orange; margin-right: 5px;"></i><div class="inline" ng-show="view == &#39;psettings&#39;" style="width: 15px;">&nbsp;</div><div class="inline" ng-hide="view == &#39;psettings&#39;" style="width: 25px;">&nbsp;</div><button class="btn btn-default inline" ng-click="view_switch(&#39;psettings&#39;)">PRINT</button></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("support_portal/dashboard/adv_settings_left.html",'<div><input class="no-margin" ng-click="set_workshop_attribute(&#39;manual_job_number&#39;, auto_workshop.manual_job_number)" ng-model="auto_workshop.manual_job_number" type="checkbox" /><span>&nbsp; Manual Job Number</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;allow_invoice_item_on_timesheet&#39;, auto_workshop.allow_invoice_item_on_timesheet)" ng-model="auto_workshop.allow_invoice_item_on_timesheet" type="checkbox" /><span>&nbsp; Inv. Item on Timesheet</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;no_courtesy_vehicle&#39;, auto_workshop.no_courtesy_vehicle)" ng-model="auto_workshop.no_courtesy_vehicle" type="checkbox" /><span>&nbsp; No Courtesy Vehicle</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;show_quantity_on_stock_selection&#39;, auto_workshop.show_quantity_on_stock_selection)" ng-model="auto_workshop.show_quantity_on_stock_selection" type="checkbox" /><span>&nbsp; Show Quantity on Stock Selection</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;simple_stock_lookup&#39;, auto_workshop.simple_stock_lookup)" ng-model="auto_workshop.simple_stock_lookup" type="checkbox" /><span>&nbsp; Simple Stock Lookup</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;allow_sub_jobs&#39;, auto_workshop.allow_sub_jobs)" ng-model="auto_workshop.allow_sub_jobs" type="checkbox" /><span>&nbsp; Allow Sub Jobs</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;enable_undelete&#39;, auto_workshop.enable_undelete)" ng-model="auto_workshop.enable_undelete" type="checkbox" /><span>&nbsp; Allow Undelete</span></div><div id="add-custom-attribute"><a href="javascript:void(0)" ng-click="confirm_add_custom_attribute()">Add Custom Attribute</a></div><div id="add-custom-attribute-dialogue"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">Supply name and value of custom attribute to add</div></div><div class="popover-content"><div class="content-box"><div class="control-group"><label class="control-label">Attribute Name</label><div class="controls"><input ng-model="custom_attribute_name" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn" ng-click="add_custom_attribute()" ng-show="custom_attribute_name">Add</button><button class="btn btn-danger" ng-click="close_add_custom_attribute()">Cancel</button></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("support_portal/dashboard/adv_settings_right.html",'<div><div>&nbsp; Timesheet Item Stock ID</div><input class="no-margin" ng-model="auto_workshop.timesheet_item_stock_id" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;timesheet_item_stock_id&#39;, auto_workshop.timesheet_item_stock_id)">&nbsp; Set</a></div><div><div>&nbsp; Timesheet Invoice Line Item Description</div><input class="no-margin" ng-model="auto_workshop.timesheet_invoice_line_item_description" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;timesheet_invoice_line_item_description&#39;, auto_workshop.timesheet_invoice_line_item_description)">&nbsp; Set</a></div><br /><div id="md-invoices">&nbsp; Account invoices</div><div class="container-fluid"><div class="row-fluid"><div class="column span2">No.</div><div class="column span6">Description</div><div class="column span2">Amount</div></div><div class="row-fluid" ng-click="confirm_delete_md_invoice(invoice.id)" ng-mouseleave="bgColour={&#39;background-color&#39;: &#39;none&#39;}" ng-mouseover="bgColour={&#39;background-color&#39;: &#39;orange&#39;}" ng-repeat="invoice in auto_workshop.mechanic_desk_invoices" ng-style="bgColour"><div class="column span2"><a href="javascript:void(0)">{{invoice.number}}</a></div><div class="column span6"><a href="javascript:void(0)">{{invoice.description}}</a></div><div class="column span2"><a href="javascript:void(0)">{{invoice.total_amount}}</a></div></div></div><div id="delete-md-invoice"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">Delete MD Invoice {{md_invoice}}. Are you sure?</div></div><div class="popover-content"><div class="content-box"><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn" ng-click="close_confirm_delete_md_invoice()">Cancel</button><button class="btn btn-danger" ng-click="delete_md_invoice(md_invoice)">Delete</button></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("support_portal/dashboard/index.html",'<div ng-controller="DashboardController"><br /><div class="container-fluid"><div class="spinner" id="support-spinner"></div><div class="row-fluid"><div class="column span4"><div class="sub-header">WORKSHOP</div><div ad-sp-workshop-finder="" auto-workshop="auto_workshop" current-auto-workshop="current_auto_workshop" error="error" search-result="auto_workshop_search_result" show-adv-search="true"></div></div><div class="column span2" style="text-align: right"><div class="bold">ID</div><div>Name </div><div>Phone </div><div>Email</div><div>ABN</div><div>ACN</div><div>Time Zone</div><div>Tax rate</div><div class="ok">Credit</div><div ng-show="edit_credit">&nbsp;</div><div class="ok">Trial Exp.</div><div ng-show="edit_exp_date">&nbsp;</div><br /><div>Pricing Plan</div><div ng-show="current_auto_workshop.id &amp;&amp; auto_workshop.is_paying_customer">Last Bill Status</div><div ng-hide="!current_auto_workshop.id || auto_workshop.is_paying_customer" style="color: orange">Lead</div><div>WS Status</div><div class="ok">Note</div></div><div class="column span6"><div class="bold">{{auto_workshop.id}} &nbsp;</div><div>{{auto_workshop.name}} &nbsp;</div><div>{{auto_workshop.phone}} &nbsp;</div><div>{{auto_workshop.email}} &nbsp;</div><div>{{auto_workshop.abn}} &nbsp;</div><div>{{auto_workshop.acn}} &nbsp;</div><div><span>{{auto_workshop.time_zone}}</span><span>&nbsp;</span><span class="ok" ng-show="auto_workshop.time_difference &gt;= 0">[{{auto_workshop.time_difference}}]</span><span class="error" ng-show="auto_workshop.time_difference &lt; 0">[{{auto_workshop.time_difference}}]</span></div><div>{{auto_workshop.tax_rate}} &nbsp;</div><div ng-click="edit_credit = true; workshop_credit = 0" ng-hide="edit_credit">{{auto_workshop.credit}} &nbsp;</div><div ng-show="edit_credit"><div>Add how much (in local workshop currency)? &nbsp;</div><input class="no-margin" ng-model="workshop_credit" /><div class="inline"><a class="ok inline" ng-click="add_workshop_credit(workshop_credit); edit_credit = false">Add</a><span>&nbsp;</span><a class="error inline" href="javascript:void(0)" ng-click="edit_credit = false">Cancel</a></div></div><div ng-click="edit_exp_date = true" ng-hide="edit_exp_date">{{auto_workshop.trial_expired_at | date : "dd.MM.yyyy"}} &nbsp;</div><div ng-show="edit_exp_date"><ad-datepicker ng-model="auto_workshop.trial_expired_at"></ad-datepicker><div><a class="ok inline" ng-click="set_workshop_attribute(&#39;trial_expired_at&#39;, auto_workshop.trial_expired_at); edit_exp_date = false">Set</a><span>&nbsp;</span><a class="error inline" href="javascript:void(0)" ng-click="edit_exp_date = false">Cancel</a></div></div><br /><div class="ok" ng-show="auto_workshop.pricing_plan">{{auto_workshop.pricing_plan}} &nbsp;</div><div class="error" ng-hide="auto_workshop.pricing_plan || !current_auto_workshop.id">None</div><div ng-show="current_auto_workshop.id &amp;&amp; auto_workshop.is_paying_customer"><div class="error" ng-show="auto_workshop.owing">Owing</div><div class="ok" ng-hide="auto_workshop.owing">Good standing</div></div><div ng-hide="!current_auto_workshop.id || auto_workshop.is_paying_customer">&nbsp;</div><div ng-show="current_auto_workshop.id"><div ng-show="auto_workshop.locked"><div class="bold" style="color: red">Locked - {{auto_workshop.locking_reason}}</div></div><div class="ok" ng-show="!auto_workshop.locked">Open</div></div><div ng-click="edit_note = true" ng-hide="edit_note">{{auto_workshop.note || "N/A"}}</div><div ng-show="edit_note"><input class="no-margin" ng-model="auto_workshop.note" /><div><a class="ok inline" ng-click="set_workshop_attribute(&#39;note&#39;, auto_workshop.note); edit_note = false">Set</a><span>&nbsp;</span><a class="error inline" href="javascript:void(0)" ng-click="edit_note = false">Cancel</a></div></div></div></div><br /><div style="width: 100%; height: 3px; background: orange"></div><br /><div id="auto-workshop-search" ng-show="auto_workshop_search_result"><div class="sub-header"><span id="search-legend">SEARCH HITS</span><span>&nbsp;</span><i class="icon icon-question-sign inline" ng-click="show_search_legend = true"></i><i class="icon icon-remove inline" ng-click="show_search_legend = false" ng-show="show_search_legend"></i></div><div class="row-fluid" ng-show="show_search_legend"><div class="column span2"><span style="border: 1px solid black; background: lightgrey; border-radius: 5px;">&nbsp; </span><span>&nbsp; </span><span>Locked</span></div><div class="column span2"><span style="border: 1px solid black; background: red; border-radius: 5px;">&nbsp; </span><span>&nbsp; </span><span>Owing</span></div><div class="column span2"><span style="border: 1px solid black; background: green; border-radius: 5px;">&nbsp; </span><span>&nbsp; </span><span>Good standing</span></div><div class="column span2"><span style="border: 1px solid black; background: orange; border-radius: 5px;">&nbsp; </span><span>&nbsp; </span><span>Trialled - has plan</span></div><div class="column span2"><span style="border: 1px solid black; background: darkgoldenrod; border-radius: 5px;">&nbsp; </span><span>&nbsp; </span><span>Trialled - no plan</span></div><div class="column span2"><span style="border: 1px solid black; background: cornflowerblue; border-radius: 5px;">&nbsp; </span><span>&nbsp; </span><span>Trialling</span></div></div><br /><div class="row-fluid"><div class="column span1">ID</div><div class="column span4">NAME</div><div class="column span2">PHONE</div><div class="column span3">EMAIL</div><div class="column span2">ABN</div></div><br /><div class="row-fluid" ng-click="get_auto_workshop(auto_workshop.id)" ng-mouseleave="bgColour=&#39;none&#39;" ng-mouseover="bgColour=&#39;lightgreen&#39;" ng-repeat="auto_workshop in auto_workshop_search_result" ng-style="{&#39;background-color&#39;:bgColour}"><div class="column span1"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}">{{auto_workshop.id}}</a></div><div class="column span4"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}">{{auto_workshop.name}}</a></div><div class="column span2"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}">{{auto_workshop.phone}}</a></div><div class="column span3"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}"><div style="width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{auto_workshop.email}}</div></a></div><div class="column span2"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}">{{auto_workshop.abn}}</a></div></div></div><div ng-hide="auto_workshop_search_result"><div class="row-fluid" ng-show="current_auto_workshop.id"><div class="column span4"><div ng-show="view == &#39;basic&#39;"><div class="sub-header">ADMIN</div><div class="control-group"><div class="controls"><button class="btn btn-danger inline" ng-click="lock_auto_workshop()" ng-hide="auto_workshop.locked" style="width: 75%">Lock</button><div>&nbsp;</div><button class="btn btn-default inline" ng-click="unlock_auto_workshop()" ng-show="auto_workshop.locked" style="width: 75%">Unlock</button></div></div><div class="control-group" ng-hide="auto_workshop.locked"><label class="control-label"><span>Locking Reason </span><span class="error">(SEEN BY CUSTOMER)</span></label><div class="controls"><input class="no-margin" ng-hide="auto_workshop.locked" ng-model="locking_reason" /></div></div><div ng-show="auto_workshop.owing"><div>Last invoice created: {{auto_workshop.last_invoice_creation_date | date : "dd/MM/yyyy" }}</div><div>Last MD invoice: {{auto_workshop.last_MD_invoice_date | date : "dd/MM/yyyy" }}</div><div># of MD invoices: {{auto_workshop.number_of_MD_invoices}}</div></div></div><div ng-show="view == &#39;advsettings&#39;"><div class="sub-header">ADV SETTINGS</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;manual_job_number&#39;, auto_workshop.manual_job_number)" ng-model="auto_workshop.manual_job_number" type="checkbox" /><span>&nbsp; Manual Job Number</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;allow_invoice_item_on_timesheet&#39;, auto_workshop.allow_invoice_item_on_timesheet)" ng-model="auto_workshop.allow_invoice_item_on_timesheet" type="checkbox" /><span>&nbsp; Inv. Item on Timesheet</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;no_courtesy_vehicle&#39;, auto_workshop.no_courtesy_vehicle)" ng-model="auto_workshop.no_courtesy_vehicle" type="checkbox" /><span>&nbsp; No Courtesy Vehicle</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;show_quantity_on_stock_selection&#39;, auto_workshop.show_quantity_on_stock_selection)" ng-model="auto_workshop.show_quantity_on_stock_selection" type="checkbox" /><span>&nbsp; Show Quantity on Stock Selection</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;simple_stock_lookup&#39;, auto_workshop.simple_stock_lookup)" ng-model="auto_workshop.simple_stock_lookup" type="checkbox" /><span>&nbsp; Simple Stock Lookup</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;allow_sub_jobs&#39;, auto_workshop.allow_sub_jobs)" ng-model="auto_workshop.allow_sub_jobs" type="checkbox" /><span>&nbsp; Allow Sub Jobs</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;enable_undelete&#39;, auto_workshop.enable_undelete)" ng-model="auto_workshop.enable_undelete" type="checkbox" /><span>&nbsp; Allow Undelete</span></div><div id="add-custom-attribute"><a href="javascript:void(0)" ng-click="confirm_add_custom_attribute()">Add Custom Attribute</a></div><div id="add-custom-attribute-dialogue"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">Supply name and value of custom attribute to add</div></div><div class="popover-content"><div class="content-box"><div class="control-group"><label class="control-label">Attribute Name</label><div class="controls"><input ng-model="custom_attribute_name" /></div></div><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn" ng-click="add_custom_attribute()" ng-show="custom_attribute_name">Add</button><button class="btn btn-danger" ng-click="close_add_custom_attribute()">Cancel</button></div></div></div></div></div></div></div><div ng-show="view == &#39;psettings&#39;"><div class="sub-header">PAGE SETTINGS</div><div class="bold">Printing Templates</div><div><div>&nbsp; Invoice Template</div><input class="no-margin" ng-model="auto_workshop.invoice_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;invoice_template&#39;, auto_workshop.invoice_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Job Card Template</div><input class="no-margin" ng-model="auto_workshop.job_card_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;job_card_template&#39;, auto_workshop.job_card_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Quote Template</div><input class="no-margin" ng-model="auto_workshop.quote_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;quote_template&#39;, auto_workshop.quote_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Payment Template</div><input class="no-margin" ng-model="auto_workshop.payment_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;payment_template&#39;, auto_workshop.payment_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Barcode Template</div><input class="no-margin" ng-model="auto_workshop.barcode_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;barcode_template&#39;, auto_workshop.barcode_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Label Template</div><input class="no-margin" ng-model="auto_workshop.label_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;label_template&#39;, auto_workshop.label_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Runsheet Template</div><input class="no-margin" ng-model="auto_workshop.run_sheet_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;run_sheet_template&#39;, auto_workshop.run_sheet_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><br /><div class="bold">Page Setup</div><div><input class="no-margin" ng-model="auto_workshop.print_margin_top" style="width: 25px;" type="text" /><span>&nbsp; px Top Margin</span><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;print_margin_top&#39;, auto_workshop.print_margin_top)">&nbsp; Set</a></div><div><input class="no-margin" ng-model="auto_workshop.print_margin_bottom" style="width: 25px;" type="text" /><span>&nbsp; px Bottom Margin</span><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;print_margin_bottom&#39;, auto_workshop.print_margin_bottom)">&nbsp; Set</a></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_use_letter_head&#39;, auto_workshop.print_use_letter_head)" ng-model="auto_workshop.print_use_letter_head" type="checkbox" /><span>&nbsp; Use Letterheads</span></div><br /><div class="bold">Logo Settings</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;use_full_size_logo&#39;, auto_workshop.use_full_size_logo)" ng-model="auto_workshop.use_full_size_logo" type="checkbox" /><span>&nbsp; Use Full Size Logo</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;use_large_logo&#39;, auto_workshop.use_large_logo)" ng-model="auto_workshop.use_large_logo" type="checkbox" /><span>&nbsp; Use Large Logo</span></div></div></div><div class="column span4"><div ng-show="view == &#39;basic&#39;"><div class="sub-header">ADDRESS</div><div ng-hide="current_auto_workshop.id">&nbsp;</div><div ng-show="current_auto_workshop.id">{{auto_workshop.address.full_address}}</div><br /><div class="sub-header">EMPLOYEES</div><div ng-repeat="employee in auto_workshop.employees"><a href="javascript:void(0)" ng-click="show_change_password(employee.id)" style="color: {{role_color(employee.role)}}; width: 100%" tooltip="ID: {{employee.id}} -- {{employee.role}}"><span class="bold">n:>&nbsp; </span><span>{{employee.name}}&nbsp;</span><span class="bold">&nbsp;&nbsp;u:>&nbsp;</span><span>{{employee.username}}</span></a><div class="control-group" ng-show="changing_password == employee.id"><div>Update password</div><div class="ok" ng-show="password_changed">Password update successful</div><div class="controls"><input class="no-margin" ng-model="current_auto_workshop.new_password" style="width: 45%" type="text" /><button class="btn btn-danger inline" ng-click="change_password(employee.id)" style="margin-rigth: 5px; margin-left: 5px;">Update</button><button class="btn btn-default inline" ng-click="cancel_change_password()">Cancel</button></div></div></div></div><div ng-show="view == &#39;advsettings&#39;"><div class="sub-header">ADV SETTINGS</div><div><div>&nbsp; Timesheet Item Stock ID</div><input class="no-margin" ng-model="auto_workshop.timesheet_item_stock_id" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;timesheet_item_stock_id&#39;, auto_workshop.timesheet_item_stock_id)">&nbsp; Set</a></div><div><div>&nbsp; Timesheet Invoice Line Item Description</div><input class="no-margin" ng-model="auto_workshop.timesheet_invoice_line_item_description" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;timesheet_invoice_line_item_description&#39;, auto_workshop.timesheet_invoice_line_item_description)">&nbsp; Set</a></div><br /><div id="md-invoices">&nbsp; Account invoices</div><div class="container-fluid"><div class="row-fluid"><div class="column span2">No.</div><div class="column span6">Description</div><div class="column span2">Amount</div></div><div class="row-fluid" ng-click="confirm_delete_md_invoice(invoice.id)" ng-mouseleave="bgColour={&#39;background-color&#39;: &#39;none&#39;}" ng-mouseover="bgColour={&#39;background-color&#39;: &#39;orange&#39;}" ng-repeat="invoice in auto_workshop.mechanic_desk_invoices" ng-style="bgColour"><div class="column span2"><a href="javascript:void(0)">{{invoice.number}}</a></div><div class="column span6"><a href="javascript:void(0)">{{invoice.description}}</a></div><div class="column span2"><a href="javascript:void(0)">{{invoice.total_amount}}</a></div></div></div><div id="delete-md-invoice"><div class="popover fade left in" style="width: 500px"><div class="popover-title"><div class="sub-header">Delete MD Invoice {{md_invoice}}. Are you sure?</div></div><div class="popover-content"><div class="content-box"><div class="control-group"><label class="control-label"></label><div class="controls"><button class="btn" ng-click="close_confirm_delete_md_invoice()">Cancel</button><button class="btn btn-danger" ng-click="delete_md_invoice(md_invoice)">Delete</button></div></div></div></div></div></div></div><div ng-show="view == &#39;psettings&#39;"><div class="sub-header">CONTENT SETTINGS</div><div class="bold">Content Settings - Customer</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_customer_address_on_job_card&#39;, auto_workshop.print_customer_address_on_job_card)" ng-model="auto_workshop.print_customer_address_on_job_card" type="checkbox" /><span>&nbsp; Customer Address on Job Card</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_show_customer_number&#39;, auto_workshop.print_show_customer_number)" ng-model="auto_workshop.print_show_customer_number" type="checkbox" /><span>&nbsp; Show Customer Number</span></div><br /><div class="bold">Content Settings - Job Card</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_job_card_name_only&#39;, auto_workshop.print_job_card_name_only)" ng-model="auto_workshop.print_job_card_name_only" type="checkbox" /><span>&nbsp; Print Job Card Name Only</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_job_start_date&#39;, auto_workshop.print_job_start_date)" ng-model="auto_workshop.print_job_start_date" type="checkbox" /><span>&nbsp; Print Job Start Date</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_hide_description&#39;, auto_workshop.print_hide_description)" ng-model="auto_workshop.print_hide_description" type="checkbox" /><span>&nbsp; Hide Description</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_timesheet&#39;, auto_workshop.print_timesheet)" ng-model="auto_workshop.print_timesheet" type="checkbox" /><span>&nbsp; Print Timesheets</span></div><br /><div class="bold">Content Settings - Invoices, Bills, Quotes</div><div><div>&nbsp; Quote Title</div><input class="no-margin" ng-model="auto_workshop.quote_title" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;quote_title&#39;, auto_workshop.quote_title)">&nbsp; Set</a></div><br /><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_hide_item_with_zero_price&#39;, auto_workshop.print_hide_item_with_zero_price)" ng-model="auto_workshop.print_hide_item_with_zero_price" type="checkbox" /><span>&nbsp; Hide Zero Price Item</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_invoice_price_include_gst&#39;, auto_workshop.print_invoice_price_include_gst)" ng-model="auto_workshop.print_invoice_price_include_gst" type="checkbox" /><span>&nbsp; Print Invoice Prices GST Inclusive</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_without_invoice_details&#39;, auto_workshop.print_without_invoice_details)" ng-model="auto_workshop.print_without_invoice_details" type="checkbox" /><span>&nbsp; Print Without Invoice Details</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_quote_price_include_gst&#39;, auto_workshop.print_quote_price_include_gst)" ng-model="auto_workshop.print_quote_price_include_gst" type="checkbox" /><span>&nbsp; Print Quote Prices GST Inclusive</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_price_on_header_item&#39;, auto_workshop.print_price_on_header_item)" ng-model="auto_workshop.print_price_on_header_item" type="checkbox" /><span>&nbsp; Print Price On Header Items</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_unit_price_two_decimal&#39;, auto_workshop.print_unit_price_two_decimal)" ng-model="auto_workshop.print_unit_price_two_decimal" type="checkbox" /><span>&nbsp; Unit Prices To 2 Decimal Places</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_with_payment_term&#39;, auto_workshop.print_with_payment_term)" ng-model="auto_workshop.print_with_payment_term" type="checkbox" /><span>&nbsp; Print Payment Terms</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_without_stock_number&#39;, auto_workshop.print_without_stock_number)" ng-model="auto_workshop.print_without_stock_number" type="checkbox" /><span>&nbsp; Print Without Stock Number</span></div><br /><div class="bold">Content Settings - PO</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;disable_purchase_order_item_price&#39;, auto_workshop.disable_purchase_order_item_price)" ng-model="auto_workshop.disable_purchase_order_item_price" type="checkbox" /><span>&nbsp; Hide Prices On Purchase Orders</span></div></div></div><div class="column span4"><div class="sub-header">SETTINGS</div><div class="control-group"><div class="controls"><i class="icon icon-chevron-left" ng-show="view == &#39;basic&#39;" style="color: orange; margin-right: 5px;"></i><div class="inline" ng-show="view == &#39;basic&#39;" style="width: 15px;">&nbsp;</div><div class="inline" ng-hide="view == &#39;basic&#39;" style="width: 25px;">&nbsp;</div><button class="btn btn-default inline" ng-click="view_switch(&#39;basic&#39;)">BASIC</button></div></div><div class="control-group"><div class="controls"><i class="icon icon-chevron-left" ng-show="view == &#39;advsettings&#39;" style="color: orange; margin-right: 5px;"></i><div class="inline" ng-show="view == &#39;advsettings&#39;" style="width: 15px;">&nbsp;</div><div class="inline" ng-hide="view == &#39;advsettings&#39;" style="width: 25px;">&nbsp;</div><button class="btn btn-default inline" ng-click="view_switch(&#39;advsettings&#39;)">ADV</button></div></div><div class="control-group"><div class="controls"><i class="icon icon-chevron-left" ng-show="view == &#39;psettings&#39;" style="color: orange; margin-right: 5px;"></i><div class="inline" ng-show="view == &#39;psettings&#39;" style="width: 15px;">&nbsp;</div><div class="inline" ng-hide="view == &#39;psettings&#39;" style="width: 25px;">&nbsp;</div><button class="btn btn-default inline" ng-click="view_switch(&#39;psettings&#39;)">PRINT</button></div></div></div></div></div><br /><div style="width: 100%; height: 3px; background: orange"></div><br /><div id="follow-up-list" ng-show="auto_workshop.follow_up_workshops"><div class="sub-header inline" style="margin-bottom: 0px">TO FOLLOW UP</div><span>&nbsp;</span><i class="icon icon-remove inline" ng-click="auto_workshop.follow_up_workshops = null" style="color: red"></i><br /><div class="row-fluid"><div class="column span1">ID</div><div class="column span4">NAME</div><div class="column span2">PHONE</div><div class="column span3">EMAIL</div><div class="column span2">ABN</div></div><br /><div class="row-fluid" ng-click="get_auto_workshop(auto_workshop.id)" ng-mouseleave="bgColour={&#39;background-color&#39;: &#39;none&#39;}" ng-mouseover="bgColour={&#39;background-color&#39;: &#39;lightgreen&#39;}" ng-repeat="auto_workshop in auto_workshop.follow_up_workshops" ng-style="bgColour"><div class="column span1"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}">{{auto_workshop.id}}</a></div><div class="column span4"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}">{{auto_workshop.name}}</a></div><div class="column span2"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}">{{auto_workshop.phone}}</a></div><div class="column span3"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}"><div style="width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{auto_workshop.email}}</div></a></div><div class="column span2"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}">{{auto_workshop.abn}}</a></div></div></div><div id="owing-list" ng-show="auto_workshop.owing_workshops"><div class="sub-header inline" style="margin-bottom: 0px">OWING</div><span>&nbsp;</span><i class="icon icon-remove inline" ng-click="auto_workshop.owing_workshops = null" style="color: red"></i><br /><div class="row-fluid"><div class="column span1">ID</div><div class="column span4">NAME</div><div class="column span2">PHONE</div><div class="column span3">EMAIL</div><div class="column span2">ABN</div></div><br /><div class="row-fluid" ng-click="get_auto_workshop(auto_workshop.id)" ng-mouseleave="bgColour={&#39;background-color&#39;: &#39;none&#39;}" ng-mouseover="bgColour={&#39;background-color&#39;: &#39;lightgreen&#39;}" ng-repeat="auto_workshop in auto_workshop.owing_workshops" ng-style="bgColour"><div class="column span1"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}">{{auto_workshop.id}}</a></div><div class="column span4"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}">{{auto_workshop.name}}</a></div><div class="column span2"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}">{{auto_workshop.phone}}</a></div><div class="column span3"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}"><div style="width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">{{auto_workshop.email}}</div></a></div><div class="column span2"><a href="javascript:void(0)" style="color: {{ws_status_color(auto_workshop)}}">{{auto_workshop.abn}}</a></div></div></div></div></div>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("support_portal/dashboard/print_settings_left.html",'<div class="bold">Printing Templates</div><div><div>&nbsp; Invoice Template</div><input class="no-margin" ng-model="auto_workshop.invoice_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;invoice_template&#39;, auto_workshop.invoice_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Job Card Template</div><input class="no-margin" ng-model="auto_workshop.job_card_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;job_card_template&#39;, auto_workshop.job_card_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Quote Template</div><input class="no-margin" ng-model="auto_workshop.quote_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;quote_template&#39;, auto_workshop.quote_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Payment Template</div><input class="no-margin" ng-model="auto_workshop.payment_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;payment_template&#39;, auto_workshop.payment_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Barcode Template</div><input class="no-margin" ng-model="auto_workshop.barcode_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;barcode_template&#39;, auto_workshop.barcode_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Label Template</div><input class="no-margin" ng-model="auto_workshop.label_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;label_template&#39;, auto_workshop.label_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><div><div>&nbsp; Runsheet Template</div><input class="no-margin" ng-model="auto_workshop.run_sheet_template" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;run_sheet_template&#39;, auto_workshop.run_sheet_template)">&nbsp; Set</a><a href="javascript:void(0)" ng-click="">&nbsp; View</a></div><br /><div class="bold">Page Setup</div><div><input class="no-margin" ng-model="auto_workshop.print_margin_top" style="width: 25px;" type="text" /><span>&nbsp; px Top Margin</span><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;print_margin_top&#39;, auto_workshop.print_margin_top)">&nbsp; Set</a></div><div><input class="no-margin" ng-model="auto_workshop.print_margin_bottom" style="width: 25px;" type="text" /><span>&nbsp; px Bottom Margin</span><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;print_margin_bottom&#39;, auto_workshop.print_margin_bottom)">&nbsp; Set</a></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_use_letter_head&#39;, auto_workshop.print_use_letter_head)" ng-model="auto_workshop.print_use_letter_head" type="checkbox" /><span>&nbsp; Use Letterheads</span></div><br /><div class="bold">Logo Settings</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;use_full_size_logo&#39;, auto_workshop.use_full_size_logo)" ng-model="auto_workshop.use_full_size_logo" type="checkbox" /><span>&nbsp; Use Full Size Logo</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;use_large_logo&#39;, auto_workshop.use_large_logo)" ng-model="auto_workshop.use_large_logo" type="checkbox" /><span>&nbsp; Use Large Logo</span></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("support_portal/dashboard/print_settings_right.html",'<div class="bold">Content Settings - Customer</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_customer_address_on_job_card&#39;, auto_workshop.print_customer_address_on_job_card)" ng-model="auto_workshop.print_customer_address_on_job_card" type="checkbox" /><span>&nbsp; Customer Address on Job Card</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_show_customer_number&#39;, auto_workshop.print_show_customer_number)" ng-model="auto_workshop.print_show_customer_number" type="checkbox" /><span>&nbsp; Show Customer Number</span></div><br /><div class="bold">Content Settings - Job Card</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_job_card_name_only&#39;, auto_workshop.print_job_card_name_only)" ng-model="auto_workshop.print_job_card_name_only" type="checkbox" /><span>&nbsp; Print Job Card Name Only</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_job_start_date&#39;, auto_workshop.print_job_start_date)" ng-model="auto_workshop.print_job_start_date" type="checkbox" /><span>&nbsp; Print Job Start Date</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_hide_description&#39;, auto_workshop.print_hide_description)" ng-model="auto_workshop.print_hide_description" type="checkbox" /><span>&nbsp; Hide Description</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_timesheet&#39;, auto_workshop.print_timesheet)" ng-model="auto_workshop.print_timesheet" type="checkbox" /><span>&nbsp; Print Timesheets</span></div><br /><div class="bold">Content Settings - Invoices, Bills, Quotes</div><div><div>&nbsp; Quote Title</div><input class="no-margin" ng-model="auto_workshop.quote_title" type="text" /><a href="javascript:void(0)" ng-click="set_workshop_attribute(&#39;quote_title&#39;, auto_workshop.quote_title)">&nbsp; Set</a></div><br /><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_hide_item_with_zero_price&#39;, auto_workshop.print_hide_item_with_zero_price)" ng-model="auto_workshop.print_hide_item_with_zero_price" type="checkbox" /><span>&nbsp; Hide Zero Price Item</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_invoice_price_include_gst&#39;, auto_workshop.print_invoice_price_include_gst)" ng-model="auto_workshop.print_invoice_price_include_gst" type="checkbox" /><span>&nbsp; Print Invoice Prices GST Inclusive</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_without_invoice_details&#39;, auto_workshop.print_without_invoice_details)" ng-model="auto_workshop.print_without_invoice_details" type="checkbox" /><span>&nbsp; Print Without Invoice Details</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_quote_price_include_gst&#39;, auto_workshop.print_quote_price_include_gst)" ng-model="auto_workshop.print_quote_price_include_gst" type="checkbox" /><span>&nbsp; Print Quote Prices GST Inclusive</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_price_on_header_item&#39;, auto_workshop.print_price_on_header_item)" ng-model="auto_workshop.print_price_on_header_item" type="checkbox" /><span>&nbsp; Print Price On Header Items</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_unit_price_two_decimal&#39;, auto_workshop.print_unit_price_two_decimal)" ng-model="auto_workshop.print_unit_price_two_decimal" type="checkbox" /><span>&nbsp; Unit Prices To 2 Decimal Places</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_with_payment_term&#39;, auto_workshop.print_with_payment_term)" ng-model="auto_workshop.print_with_payment_term" type="checkbox" /><span>&nbsp; Print Payment Terms</span></div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;print_without_stock_number&#39;, auto_workshop.print_without_stock_number)" ng-model="auto_workshop.print_without_stock_number" type="checkbox" /><span>&nbsp; Print Without Stock Number</span></div><br /><div class="bold">Content Settings - PO</div><div><input class="no-margin" ng-click="set_workshop_attribute(&#39;disable_purchase_order_item_price&#39;, auto_workshop.disable_purchase_order_item_price)" ng-model="auto_workshop.disable_purchase_order_item_price" type="checkbox" /><span>&nbsp; Hide Prices On Purchase Orders</span></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("support_portal/object_reassociation/current_object.html",'<div class="sub-header" ng-hide="show_data" style="border-right: 3px solid orange; border-bottom: 3px solid orange"><div>Summary</div><br /></div><div class="sub-header" ng-click="dump_show_data()" ng-show="show_data" style="border-right: 3px solid orange; margin-bottom: 0px;">Summary -- {{show_data.klass}}</div><div ng-show="show_data" style="font-weight: bold; border-right: 3px solid orange; border-bottom: 3px solid orange;"><div class="ok"><div>ID: {{show_data.raw.id}}</div><div>{{show_data.klass}} No.{{show_data.raw.number || \'NA\'}}    </div><div class="error" ng-show="show_data.raw.deleted">Deleted</div><div class="error" ng-show="show_data.raw.deleted">Reason: {{show_data.raw.deleted_reason}}</div></div><br /><div id="customer" ng-show="show_data.klass == &#39;Customer&#39;"><div>Name: {{show_data.raw.name || \'NA\'}}</div><div class="error" ng-show="show_data.raw.is_company">Company: {{show_data.raw.is_company}}</div><div class="ok" ng-hide="show_data.raw.is_company">Company: {{show_data.raw.is_company}}</div><div class="error" ng-show="show_data.raw.is_insurer">3rd Pty: {{show_data.raw.is_insurer}}</div><div class="ok" ng-hide="show_data.raw.is_insurer">3rd Pty: {{show_data.raw.is_insurer}}</div><div>Vehicles:</div><div ng-repeat="vehicle in show_data.raw.vehicles" style="color: orange"><div>&nbsp; &#61;&#62; ID.{{vehicle.id}} -- {{vehicle.registration_number}} -- {{vehicle.make}} {{vehicle.model}} {{vehicle.year}}</div></div><br /></div><div id="vehicle" ng-show="show_data.klass == &#39;Vehicle&#39;"><div>Rego: {{show_data.raw.registration_number || \'NA\'}}</div><div>Customer: {{show_data.raw.customer.name}} -- ID.{{show_data.raw.customer.id}} -- No.{{show_data.raw.customer.number}}</div><br /></div><div id="job" ng-show="show_data.klass == &#39;Job&#39;"><div>Customer: {{show_data.raw.customer.name}} -- ID.{{show_data.raw.customer.id}} -- No.{{show_data.raw.customer.number}}</div><div>Vehicle: {{show_data.raw.vehicle.registration_number}} -- ID.{{show_data.raw.vehicle.id}} -- No.{{show_data.raw.vehicle.number}}</div><div>Invoice: ID.{{show_data.raw.invoice.id}} -- No.{{show_data.raw.invoice.number}}</div><div>Status: {{show_data.raw.status}}</div><br /></div><div id="invoice" ng-show="show_data.klass == &#39;Invoice&#39;"><div>Customer: {{show_data.raw.customer.name}} -- ID.{{show_data.raw.customer.id}} -- No.{{show_data.raw.customer.number}}</div><div>Vehicle: {{show_data.raw.vehicle.registration_number}} -- ID.{{show_data.raw.vehicle.id}} -- No.{{show_data.raw.vehicle.number}}</div><div>Issue: {{show_data.raw.issue_date | date : "dd.MM.yyyy"}} -- Due: {{show_data.raw.due_date | date : "dd.MM.yyyy"}}</div><div class="ok" ng-show="show_data.raw.finalized">Finalised: {{show_data.raw.finalized}}</div><div class="error" ng-hide="show_data.raw.finalized">Finalised: {{show_data.raw.finalized}}</div><div>Status: {{show_data.raw.paid}}</div><br /><div>Total: {{show_data.raw.total_amount}}</div><div>Paid: {{show_data.raw.paid_amount}}</div><div class="error" ng-show="show_data.raw.unpaid_amount &gt; 0">Unpaid: {{show_data.raw.unpaid_amount}}</div><div class="ok" ng-hide="show_data.raw.unpaid_amount &gt; 0">Unpaid: {{show_data.raw.unpaid_amount}}</div><div>Payments:</div><div ng-repeat="payment in show_data.raw.payments" style="color: orange"><div>&nbsp; &#61;&#62; ID.{{payment.id}} -- No.{{payment.number}} -- Val.{{payment.amount}}</div></div><br /></div><div id="bill" ng-show="show_data.klass == &#39;Bill&#39;"><div>Supplier: {{show_data.raw.supplier.name}} -- ID.{{show_data.raw.supplier.id}} -- No.{{show_data.raw.supplier.number}}</div><div>Billing Supplier: {{show_data.raw.billing_supplier.name}} -- ID.{{show_data.raw.billing_supplier.id}} -- No.{{show_data.raw.billing_supplier.number}}</div><div>Issue: {{show_data.raw.date | date : "dd.MM.yyyy"}} -- Due: {{show_data.raw.due_date | date : "dd.MM.yyyy"}}</div><div class="ok" ng-show="show_data.raw.finalized">Finalised: {{show_data.raw.finalized}}</div><div class="error" ng-hide="show_data.raw.finalized">Finalised: {{show_data.raw.finalized}}</div><div>Status: {{show_data.raw.status}}</div><br /><div>Total: {{show_data.raw.total_amount}}</div><div>Paid: {{show_data.raw.paid_amount}}</div><div class="error" ng-show="show_data.raw.unpaid_amount &gt; 0">Unpaid: {{show_data.raw.unpaid_amount}}</div><div class="ok" ng-hide="show_data.raw.unpaid_amount &gt; 0">Unpaid: {{show_data.raw.unpaid_amount}}</div><div>Payments:</div><div ng-repeat="payment in show_data.raw.payments" style="color: orange"><div>&nbsp; &#61;&#62; ID.{{payment.id}} -- No.{{payment.number}} -- Val.{{payment.amount}}</div></div><br /></div></div><br /><div class="sub-header">Raw</div><div ng-show="current_auto_workshop.focused_raw_key" style="border: 1px solid orange"><div class="bold" ng-click="current_auto_workshop.focused_raw_key=null; current_auto_workshop.focused_raw_value=null">&nbsp; {{current_auto_workshop.focused_raw_key}}</div><div ng-repeat="(subkey, subvalue) in current_auto_workshop.focused_raw_value"><span>&nbsp; {{subkey}}: {{subvalue}}</span></div></div><br /><div ng-repeat="(key, value) in show_data.raw" ng-show="show_data"><div ng-click="current_auto_workshop.focused_raw_key=key; current_auto_workshop.focused_raw_value=value">{{key}}: {{value}}</div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("support_portal/object_reassociation/index.html",'<div ng-controller="ObjectReassociationController"><br /><div class="container-fluid"><div class="row"><div class="column span4"><div class="sub-header">WORKSHOP</div><div ad-sp-workshop-finder="" auto-workshop="auto_workshop" current-auto-workshop="current_auto_workshop" error="error" search-result="auto_workshop_search_result" show-adv-search="false"></div></div><div class="column span8"><div class="sub-header" ng-hide="current_auto_workshop.id">&nbsp;</div><div class="sub-header" ng-show="current_auto_workshop.id" style="color: red">SELECTED WORKSHOP {{current_auto_workshop.id}}</div><div><div class="inline" style="width: 30%"><div class="bold">Subject</div><div ng-click="toggle_assignment(&#39;subject&#39;)"><div class="ok" ng-show="reassociator.subject_id &amp;&amp; assigning != &#39;subject&#39;">{{reassociator.subject_klass}} -- ID {{reassociator.subject_id}}</div><div ng-show="assigning == &#39;subject&#39;" style="color: orange">Standby</div><div class="error" ng-hide="reassociator.subject_id || assigning == &#39;subject&#39;">Unassigned</div></div></div><div class="inline" width="width: 5%">&nbsp;</div><div class="inline" style="width: 30%"><div><i class="icon icon-chevron-left"></i><div class="inline">&nbsp;</div><div class="bold inline">Attribute</div></div><div class="ok" ng-show="reassociator.subject_attribute">{{reassociator.subject_attribute}}</div><div ng-show="!reassociator.subject_attribute &amp;&amp; reassociator.subject_id" style="color: orange">Standby</div><div class="error" ng-hide="reassociator.subject_id">Unassigned</div></div><div class="inline" width="width: 5%">&nbsp;</div><div class="inline" style="width: 25%"><div class="bold">Object</div><div ng-click="toggle_assignment(&#39;object&#39;)"><div class="ok" ng-show="reassociator.object_id &amp;&amp; reassociator.object_klass != &#39;String&#39; &amp;&amp; assigning != &#39;object&#39;">{{reassociator.object_klass}} -- ID {{reassociator.object_id}}</div><div class="ok" ng-show="reassociator.object_id &amp;&amp; reassociator.object_klass == &#39;String&#39; &amp;&amp; assigning != &#39;object&#39;">{{reassociator.object_klass}} -- {{reassociator.object_id}}</div><div ng-show="assigning == &#39;object&#39;" style="color: orange">Standby</div><div class="error" ng-hide="reassociator.object_id || assigning == &#39;object&#39;">Unassigned</div></div></div><div class="inline" style="width: 5%"><i class="icon icon-ok" ng-show="success == &#39;ok&#39;" style="color: green;"></i><i class="icon icon-remove" ng-show="success == &#39;failed&#39;" style="color: red;"></i></div></div><br /><div class="inline" style="width: 20%">{{data_list.object_klass}} Attr.</div><div class="control-group inline" style="text-align: right; width: 80%"><div class="control"><select class="inline" ng-model="current_object.attribute" ng-options="attr for attr in data_list.attributes" style="width: 60%; margin: 0px;"></select><span>&nbsp;</span><button class="btn btn-default" ng-click="set_subject_attribute()" style="width: 20%">Set</button></div></div><br /><div class="inline" style="width: 20%">Object Lookup</div><div class="control-group inline" style="text-align: right; width: 80%"><div class="control"><input class="no-margin" ng-model="search_term" style="width: 40%" type="text" /><span>&nbsp;</span><button class="btn btn-default" ng-click="object_search()" style="width: 20%;">Search</button></div></div><br /><div class="inline" style="width: 20%">String Value</div><div class="control-group inline" style="text-align: right; width: 80%"><div class="control"><input class="no-margin" ng-model="string_value" style="width: 40%" type="text" /><span>&nbsp;</span><button class="btn btn-default" ng-click="set_string_value()" style="width: 20%;">Set</button></div></div><br /><div class="pull-right" ng-hide="reassociator.subject_id &amp;&amp; reassociator.object_id &amp;&amp; reassociator.subject_attribute" style="color: orange;">STANDBY</div><div class="control-group" ng-show="reassociator.subject_id &amp;&amp; reassociator.object_id &amp;&amp; reassociator.subject_attribute" style="text-align: right"><div class="control"><button class="btn btn-default" ng-click="reassociate()">Reassociate</button></div></div><button class="btn btn-danger" ng-click="init()">MASTER CLR</button></div></div><br /><div class="inline" style="width: 100%; height: 3px; background: orange"></div><br /><div class="row"><div class="column span6"><div class="sub-header" ng-hide="show_data" style="border-right: 3px solid orange; border-bottom: 3px solid orange"><div>Summary</div><br /></div><div class="sub-header" ng-click="dump_show_data()" ng-show="show_data" style="border-right: 3px solid orange; margin-bottom: 0px;">Summary -- {{show_data.klass}}</div><div ng-show="show_data" style="font-weight: bold; border-right: 3px solid orange; border-bottom: 3px solid orange;"><div class="ok"><div>ID: {{show_data.raw.id}}</div><div>{{show_data.klass}} No.{{show_data.raw.number || \'NA\'}}    </div><div class="error" ng-show="show_data.raw.deleted">Deleted</div><div class="error" ng-show="show_data.raw.deleted">Reason: {{show_data.raw.deleted_reason}}</div></div><br /><div id="customer" ng-show="show_data.klass == &#39;Customer&#39;"><div>Name: {{show_data.raw.name || \'NA\'}}</div><div class="error" ng-show="show_data.raw.is_company">Company: {{show_data.raw.is_company}}</div><div class="ok" ng-hide="show_data.raw.is_company">Company: {{show_data.raw.is_company}}</div><div class="error" ng-show="show_data.raw.is_insurer">3rd Pty: {{show_data.raw.is_insurer}}</div><div class="ok" ng-hide="show_data.raw.is_insurer">3rd Pty: {{show_data.raw.is_insurer}}</div><div>Vehicles:</div><div ng-repeat="vehicle in show_data.raw.vehicles" style="color: orange"><div>&nbsp; &#61;&#62; ID.{{vehicle.id}} -- {{vehicle.registration_number}} -- {{vehicle.make}} {{vehicle.model}} {{vehicle.year}}</div></div><br /></div><div id="vehicle" ng-show="show_data.klass == &#39;Vehicle&#39;"><div>Rego: {{show_data.raw.registration_number || \'NA\'}}</div><div>Customer: {{show_data.raw.customer.name}} -- ID.{{show_data.raw.customer.id}} -- No.{{show_data.raw.customer.number}}</div><br /></div><div id="job" ng-show="show_data.klass == &#39;Job&#39;"><div>Customer: {{show_data.raw.customer.name}} -- ID.{{show_data.raw.customer.id}} -- No.{{show_data.raw.customer.number}}</div><div>Vehicle: {{show_data.raw.vehicle.registration_number}} -- ID.{{show_data.raw.vehicle.id}} -- No.{{show_data.raw.vehicle.number}}</div><div>Invoice: ID.{{show_data.raw.invoice.id}} -- No.{{show_data.raw.invoice.number}}</div><div>Status: {{show_data.raw.status}}</div><br /></div><div id="invoice" ng-show="show_data.klass == &#39;Invoice&#39;"><div>Customer: {{show_data.raw.customer.name}} -- ID.{{show_data.raw.customer.id}} -- No.{{show_data.raw.customer.number}}</div><div>Vehicle: {{show_data.raw.vehicle.registration_number}} -- ID.{{show_data.raw.vehicle.id}} -- No.{{show_data.raw.vehicle.number}}</div><div>Issue: {{show_data.raw.issue_date | date : "dd.MM.yyyy"}} -- Due: {{show_data.raw.due_date | date : "dd.MM.yyyy"}}</div><div class="ok" ng-show="show_data.raw.finalized">Finalised: {{show_data.raw.finalized}}</div><div class="error" ng-hide="show_data.raw.finalized">Finalised: {{show_data.raw.finalized}}</div><div>Status: {{show_data.raw.paid}}</div><br /><div>Total: {{show_data.raw.total_amount}}</div><div>Paid: {{show_data.raw.paid_amount}}</div><div class="error" ng-show="show_data.raw.unpaid_amount &gt; 0">Unpaid: {{show_data.raw.unpaid_amount}}</div><div class="ok" ng-hide="show_data.raw.unpaid_amount &gt; 0">Unpaid: {{show_data.raw.unpaid_amount}}</div><div>Payments:</div><div ng-repeat="payment in show_data.raw.payments" style="color: orange"><div>&nbsp; &#61;&#62; ID.{{payment.id}} -- No.{{payment.number}} -- Val.{{payment.amount}}</div></div><br /></div><div id="bill" ng-show="show_data.klass == &#39;Bill&#39;"><div>Supplier: {{show_data.raw.supplier.name}} -- ID.{{show_data.raw.supplier.id}} -- No.{{show_data.raw.supplier.number}}</div><div>Billing Supplier: {{show_data.raw.billing_supplier.name}} -- ID.{{show_data.raw.billing_supplier.id}} -- No.{{show_data.raw.billing_supplier.number}}</div><div>Issue: {{show_data.raw.date | date : "dd.MM.yyyy"}} -- Due: {{show_data.raw.due_date | date : "dd.MM.yyyy"}}</div><div class="ok" ng-show="show_data.raw.finalized">Finalised: {{show_data.raw.finalized}}</div><div class="error" ng-hide="show_data.raw.finalized">Finalised: {{show_data.raw.finalized}}</div><div>Status: {{show_data.raw.status}}</div><br /><div>Total: {{show_data.raw.total_amount}}</div><div>Paid: {{show_data.raw.paid_amount}}</div><div class="error" ng-show="show_data.raw.unpaid_amount &gt; 0">Unpaid: {{show_data.raw.unpaid_amount}}</div><div class="ok" ng-hide="show_data.raw.unpaid_amount &gt; 0">Unpaid: {{show_data.raw.unpaid_amount}}</div><div>Payments:</div><div ng-repeat="payment in show_data.raw.payments" style="color: orange"><div>&nbsp; &#61;&#62; ID.{{payment.id}} -- No.{{payment.number}} -- Val.{{payment.amount}}</div></div><br /></div></div><br /><div class="sub-header">Raw</div><div ng-show="current_auto_workshop.focused_raw_key" style="border: 1px solid orange"><div class="bold" ng-click="current_auto_workshop.focused_raw_key=null; current_auto_workshop.focused_raw_value=null">&nbsp; {{current_auto_workshop.focused_raw_key}}</div><div ng-repeat="(subkey, subvalue) in current_auto_workshop.focused_raw_value"><span>&nbsp; {{subkey}}: {{subvalue}}</span></div></div><br /><div ng-repeat="(key, value) in show_data.raw" ng-show="show_data"><div ng-click="current_auto_workshop.focused_raw_key=key; current_auto_workshop.focused_raw_value=value">{{key}}: {{value}}</div></div></div><div class="column span4"><div class="sub-header inline">CLIPBOARD &nbsp;</div><div class="inline" style="margin-bottom: 10px; color: red"><i class="icon icon-remove inline" ng-click="dump_clipboard()"></i></div><div ng-repeat="data in saved_data_list"><a class="inline" href="javascript:void(0)" ng-click="show_saved($index)">{{data.object_klass}} -- {{data.data.id}} -- No.{{data.data.number || \'NA\'}}</a><div class="pull-right"><a class="inline" href="javascript:void(0)" ng-click="select_saved($index)">Select</a></div></div></div><div class="column span2"><div class="sub-header">SEARCH RESULT</div><div ng-repeat="data in data_list.data"><a class="inline" href="javascript:void(0)" ng-click="show($index)" style="color: {{status_color(data.deleted)}}">&#92;&#92;&#61;&#62; {{data.id}}</a><div class="pull-right"><a class="inline" href="javascript:void(0)" ng-click="select($index)">Select</a></div></div></div></div></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("timesheets/index.html",'<div ng-controller="TimesheetsController"><div id="middle-screen" style="position: absolute; left: 50%; top: 20%"></div><div class="page-header">Timesheets</div><div class="row-fluid"><div class="pull-right"><button class="btn btn-primary" ng-click="new_item()">New Item</button><button class="btn" ng-click="download()"><i class="icon-download-alt"></i>Download (Excel)</button></div></div><div class="row-fluid"><div class="column" ng-class="{span2: showing_employee_list}" ng-show="showing_employee_list"><div class="bold">Employees</div><br /><label class="checkbox"><input ng-click="toggle_select_all()" ng-model="selecting_all" type="checkbox" /><span>All</span></label><div ng-repeat="employee in employees"><label class="checkbox"><input check-list="showing_employees" type="checkbox" value="{{employee.id}}" /><span>{{employee.name}}</span></label></div><a href="javascript:void(0);" ng-click="hide_employee_list()">Hide</a></div><div class="column" ng-class="{span10: showing_employee_list}"><button class="btn btn-link" ng-click="show_employee_list()" ng-hide="showing_employee_list">Filtered by staff members</button><br /><div class="row-fluid"><div class="column span8"><div class="content-box" style="height: 130px"><div class="sub-header">Filter</div><div class="inline" style="margin-right: 20px"><div><label class="inline radio" style="margin-right: 10px"><input ng-model="timesheet.group_by" type="radio" value="date" /><span>Date</span> </label><label class="inline radio"><input ng-model="timesheet.group_by" type="radio" value="job" /><span>Job</span> </label></div><div><div class="inline" style="margin-right: 10px"><div ng-show="custom_range"><div class="inline" style="margin-right: 10px"><span>From</span> <ad-datepicker ng-model="timesheet.from"></ad-datepicker></div><div class="inline"><span>To</span> <ad-datepicker ng-model="timesheet.date"></ad-datepicker></div></div><div ng-hide="custom_range"><select ng-model="quick_range" ng-options="range.value as range.name for range in quick_ranges"></select></div></div><button class="btn btn-primary" ng-click="search()" style="vertical-align: top">Search</button></div><button class="btn btn-link" ng-click="show_custom_range()" ng-hide="custom_range">Specific range</button><button class="btn btn-link" ng-click="hide_custom_range()" ng-show="custom_range">Quick ranges</button></div></div></div><div class="column span4"><div class="content-box" style="height: 130px"><div class="sub-header">Summary</div><div><span class="lable-name-left no-width">Total Hrs Spent:</span> <span class="bold">{{total_hours(filtered_timesheet)}}h</span></div><div><span class="lable-name-left no-width">Total Hrs/Qty. Charged:</span> <span class="bold">{{total_hours_charged(filtered_timesheet)}}h</span></div><div><span class="lable-name-left no-width">Total Amount:</span> <span class="bold">{{total_amount(filtered_timesheet) | currency}}</span></div><div><span class="lable-name-left no-width">Total Effective Hrs:</span> <span class="bold">{{total_effective_hours(filtered_timesheet)}}h</span></div></div></div></div><div class="row-fluid"><div class="content-box"><div class="spinner" id="work-hour-spinner"></div><div ng-show="filtered_timesheet.timesheets.length == 0"><span>No Data</span></div><div ng-hide="sheet.work_hours.length == 0" ng-repeat="sheet in filtered_timesheet.timesheets"><div ng-hide="sheet.job" style="background-color: white"><div class="bold">{{sheet.date | date: \'fullDate\'}}</div><br /><table class="table"><thead><tr><th style="width: 150px">Employee</th><th style="width: 200px">Job</th><th style="width: 65px">Start</th><th style="width: 65px">End</th><th class="text-align-right" style="width: 80px">Total Hrs</th><th class="text-align-right" style="width: 100px">Hrs/Qty. Charged</th><th class="text-align-right" style="width: 100px">Amt. Charged</th><th class="text-align-right" style="width: 80px">Eff. Hrs</th><th class="text-align-right">Comment</th></tr></thead><tbody><tr ng-click="edit_work_hour(work_hour)" ng-repeat="work_hour in sheet.work_hours"><td><span>{{work_hour.employee.name}}</span><span class="orange" ng-show="work_hour.overtime">(ot)</span></td><td><div>{{work_hour.job.title}}</div><a ng-href="#/jobs/{{work_hour.job.id}}" target="_blank">Job Details</a></td><td>{{work_hour.started_at | date: \'shortTime\'}}</td><td>{{work_hour.ended_at | date: \'shortTime\'}}</td><td class="text-align-right"><span>{{work_hour.hour}}h</span></td><th class="text-align-right"><span>{{work_hour.charge_out_hours}}h</span></th><td class="text-align-right"><span>{{work_hour.total_amount | currency}}</span></td><td class="text-align-right"><span>{{work_hour.effective_charge_out_hours}}h</span></td><td class="text-align-right" style="max-width: 40px"><span>{{work_hour.description}}</span></td></tr><tr><td colspan="4"></td><td class="text-align-right"><span class="bold">{{total_hours(sheet)}}h</span></td><th class="text-align-right"><span>{{total_hours_charged(sheet)}}h</span></th><td class="text-align-right"><span class="bold">{{total_amount(sheet) | currency}}</span></td><td class="text-align-right"><span class="bold">{{total_effective_hours(sheet)}}h</span></td><td>&nbsp;</td></tr></tbody></table></div><div ng-show="sheet.job" style="background-color: white"><div class="bold">{{sheet.job.title}}</div><br /><table class="table"><thead><tr><th style="width: 70px">Date</th><th style="width: 150px">Employee</th><th style="width: 65px">Start</th><th style="width: 65px">End</th><th class="text-align-right" style="width: 80px">Total Hrs</th><th class="text-align-right" style="width: 120px">Hrs/Qty. Charged</th><th class="text-align-right" style="width: 100px">Amt Charged</th><th class="text-align-right" style="width: 80px">Eff. Hrs</th><th class="text-align-right">Comment</th></tr></thead><tbody><tr ng-click="edit_work_hour(work_hour)" ng-repeat="work_hour in sheet.work_hours"><td>{{work_hour.started_at|date: \'shortDate\'}}</td><td><span>{{work_hour.employee.name}}</span><span class="orange" ng-show="work_hour.overtime">(ot)</span></td><td>{{work_hour.started_at | date: \'shortTime\'}}</td><td>{{work_hour.ended_at | date: \'shortTime\'}}</td><td class="text-align-right"><span>{{work_hour.hour}}h</span></td><th class="text-align-right"><span>{{work_hour.charge_out_hours}}h</span></th><td class="text-align-right"><span>{{work_hour.total_amount | currency}}</span></td><td class="text-align-right"><span>{{work_hour.effective_charge_out_hours}}h</span></td><td class="text-align-right" style="max-width: 150px"><span>{{work_hour.description}}</span></td></tr><tr><td><a ng-href="#/jobs/{{sheet.job.id}}" target="_blank">Job Details</a></td><td colspan="3"></td><td class="text-align-right"><span class="bold">{{total_hours(sheet)}}h</span></td><th class="text-align-right"><span>{{total_hours_charged(sheet)}}h</span></th><td class="text-align-right"><span class="bold">{{total_amount(sheet) | currency}}</span></td><td class="text-align-right"><span class="bold">{{total_effective_hours(sheet)}}h</span></td><td></td></tr></tbody></table></div><br /></div></div></div></div></div><div ad-work-hour-form="true" anchor-element="#middle-screen" employees="employees" on-delete="search()" on-save="search()" placement="bottom" showing="editing_work_hour" work-hour="editing_work_hour"></div></div>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("timesheets/timesheets_by_date.html",'<div class="bold">{{sheet.date | date: \'fullDate\'}}</div><br /><table class="table"><thead><tr><th style="width: 150px">Employee</th><th style="width: 200px">Job</th><th style="width: 65px">Start</th><th style="width: 65px">End</th><th class="text-align-right" style="width: 80px">Total Hrs</th><th class="text-align-right" style="width: 100px">Hrs/Qty. Charged</th><th class="text-align-right" style="width: 100px">Amt. Charged</th><th class="text-align-right" style="width: 80px">Eff. Hrs</th><th class="text-align-right">Comment</th></tr></thead><tbody><tr ng-click="edit_work_hour(work_hour)" ng-repeat="work_hour in sheet.work_hours"><td><span>{{work_hour.employee.name}}</span><span class="orange" ng-show="work_hour.overtime">(ot)</span></td><td><div>{{work_hour.job.title}}</div><a ng-href="#/jobs/{{work_hour.job.id}}" target="_blank">Job Details</a></td><td>{{work_hour.started_at | date: \'shortTime\'}}</td><td>{{work_hour.ended_at | date: \'shortTime\'}}</td><td class="text-align-right"><span>{{work_hour.hour}}h</span></td><th class="text-align-right"><span>{{work_hour.charge_out_hours}}h</span></th><td class="text-align-right"><span>{{work_hour.total_amount | currency}}</span></td><td class="text-align-right"><span>{{work_hour.effective_charge_out_hours}}h</span></td><td class="text-align-right" style="max-width: 40px"><span>{{work_hour.description}}</span></td></tr><tr><td colspan="4"></td><td class="text-align-right"><span class="bold">{{total_hours(sheet)}}h</span></td><th class="text-align-right"><span>{{total_hours_charged(sheet)}}h</span></th><td class="text-align-right"><span class="bold">{{total_amount(sheet) | currency}}</span></td><td class="text-align-right"><span class="bold">{{total_effective_hours(sheet)}}h</span></td><td>&nbsp;</td></tr></tbody></table>')
}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("timesheets/timesheets_by_job.html",'<div class="bold">{{sheet.job.title}}</div><br /><table class="table"><thead><tr><th style="width: 70px">Date</th><th style="width: 150px">Employee</th><th style="width: 65px">Start</th><th style="width: 65px">End</th><th class="text-align-right" style="width: 80px">Total Hrs</th><th class="text-align-right" style="width: 120px">Hrs/Qty. Charged</th><th class="text-align-right" style="width: 100px">Amt Charged</th><th class="text-align-right" style="width: 80px">Eff. Hrs</th><th class="text-align-right">Comment</th></tr></thead><tbody><tr ng-click="edit_work_hour(work_hour)" ng-repeat="work_hour in sheet.work_hours"><td>{{work_hour.started_at|date: \'shortDate\'}}</td><td><span>{{work_hour.employee.name}}</span><span class="orange" ng-show="work_hour.overtime">(ot)</span></td><td>{{work_hour.started_at | date: \'shortTime\'}}</td><td>{{work_hour.ended_at | date: \'shortTime\'}}</td><td class="text-align-right"><span>{{work_hour.hour}}h</span></td><th class="text-align-right"><span>{{work_hour.charge_out_hours}}h</span></th><td class="text-align-right"><span>{{work_hour.total_amount | currency}}</span></td><td class="text-align-right"><span>{{work_hour.effective_charge_out_hours}}h</span></td><td class="text-align-right" style="max-width: 150px"><span>{{work_hour.description}}</span></td></tr><tr><td><a ng-href="#/jobs/{{sheet.job.id}}" target="_blank">Job Details</a></td><td colspan="3"></td><td class="text-align-right"><span class="bold">{{total_hours(sheet)}}h</span></td><th class="text-align-right"><span>{{total_hours_charged(sheet)}}h</span></th><td class="text-align-right"><span class="bold">{{total_amount(sheet) | currency}}</span></td><td class="text-align-right"><span class="bold">{{total_effective_hours(sheet)}}h</span></td><td></td></tr></tbody></table>')}]),angular.module("templates").run(["$templateCache",function($templateCache){$templateCache.put("vehicles/index.html",'<div ng-controller="VehiclesController"><ul class="sub-nav" ng-controller="CustomersNavController"><li class="{{isActive(link.name)}}" ng-repeat="link in links"><a ng-href="{{link.href}}"><i class="{{link.icon}}"></i>{{link.name}}</a></li></ul><div class="page-header"><span>{{asset_name_plural()}}</span><div class="pull-right"><form class="form-search"><input class="search-query" ng-model="query" type="text" />&nbsp;<button class="btn btn-primary" ng-click="search()"><i class="icon-search"></i>Search</button></form></div></div><div class="search-description" ng-show="keyword">Search "{{query}}"<br />Page {{page_number}} of {{total_pages}}</div><div class="row-fluid"><div class="spinner" id="vehicle-list-spinner"></div><div class="content-box"><table class="table table-striped"><thead><tr><th ng-show="asset_property_set().sequence_number">Vehicle No#</th><th class="column-sortable" ng-click="sort(&#39;registration_number&#39;)" ng-show="asset_property_set().registration_number">Reg No#</th><th class="column-sortable" ng-click="sort(&#39;fleet_number&#39;)" ng-show="asset_property_set().fleet_number">Fleet Number</th><th ng-show="asset_property_set().serial_number">Serial No#</th><th ng-show="asset_property_set().product_number">Product No#</th><th ng-show="asset_property_set().boat_name">Boat Name</th><th>Make</th><th>Model</th><th>Year</th><th>Owner Name</th><th>Phone</th><th>Last Job Date</th><th>Next Service</th></tr></thead><tbody><tr class="goto" ng-click="goto(&#39;/customers/&#39; + vehicle.customer.id + &#39;/vehicles/&#39; + vehicle.id)" ng-repeat="vehicle in vehicles"><td ng-show="asset_property_set().sequence_number">{{vehicle.number}}</td><td ng-show="asset_property_set().registration_number">{{vehicle.registration_number}}</td><td ng-show="asset_property_set().fleet_number">{{vehicle.fleet_number}}</td><td ng-show="asset_property_set().serial_number">{{vehicle.serial_number}}</td><td ng-show="asset_property_set().product_number">{{vehicle.product_number}}</td><td ng-show="asset_property_set().boat_name">{{vehicle.boat_name}}</td><td>{{vehicle.make}}</td><td>{{vehicle.model}}</td><td>{{vehicle.year}}</td><td>{{vehicle.customer.name}}</td><td>{{vehicle.customer.phone}}</td><td>{{vehicle.service_schedule.last_service_date|date:\'mediumDate\'}}</td><td>{{vehicle.service_schedule.next_service_date|date:\'mediumDate\'}}</td></tr></tbody></table></div><pagination boundary-links="true" current-page="page_number" max-size="15" num-pages="total_pages" on-select-page="selectPage(page)" rotate="false"></pagination></div></div>')}]);