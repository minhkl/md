window.tinymce=window.tinymce||{base:"/assets/tinymce",suffix:""},function(exports,undefined){"use strict";function require(ids,callback){for(var module,defs=[],i=0;i<ids.length;++i){if(module=modules[ids[i]]||resolve(ids[i]),!module)throw"module definition dependecy not found: "+ids[i];defs.push(module)}callback.apply(null,defs)}function define(id,dependencies,definition){if("string"!=typeof id)throw"invalid module definition, module id must be defined and be a string";if(dependencies===undefined)throw"invalid module definition, dependencies must be specified";if(definition===undefined)throw"invalid module definition, definition function must be specified";require(dependencies,function(){modules[id]=definition.apply(null,arguments)})}function resolve(id){for(var target=exports,fragments=id.split(/[.\/]/),fi=0;fi<fragments.length;++fi){if(!target[fragments[fi]])return;target=target[fragments[fi]]}return target}function expose(ids){for(var i=0;i<ids.length;i++){for(var target=exports,id=ids[i],fragments=id.split(/[.\/]/),fi=0;fi<fragments.length-1;++fi)target[fragments[fi]]===undefined&&(target[fragments[fi]]={}),target=target[fragments[fi]];target[fragments[fragments.length-1]]=modules[id]}}var modules={};/**
 * EventUtils.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/dom/EventUtils",[],function(){function addEvent(target,name,callback,capture){target.addEventListener?target.addEventListener(name,callback,capture||!1):target.attachEvent&&target.attachEvent("on"+name,callback)}function removeEvent(target,name,callback,capture){target.removeEventListener?target.removeEventListener(name,callback,capture||!1):target.detachEvent&&target.detachEvent("on"+name,callback)}function fix(originalEvent,data){function returnFalse(){return!1}function returnTrue(){return!0}var name,undef,event=data||{};for(name in originalEvent)deprecated[name]||(event[name]=originalEvent[name]);if(event.target||(event.target=event.srcElement||document),originalEvent&&mouseEventRe.test(originalEvent.type)&&originalEvent.pageX===undef&&originalEvent.clientX!==undef){var eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body;event.pageX=originalEvent.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=originalEvent.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}return event.preventDefault=function(){event.isDefaultPrevented=returnTrue,originalEvent&&(originalEvent.preventDefault?originalEvent.preventDefault():originalEvent.returnValue=!1)},event.stopPropagation=function(){event.isPropagationStopped=returnTrue,originalEvent&&(originalEvent.stopPropagation?originalEvent.stopPropagation():originalEvent.cancelBubble=!0)},event.stopImmediatePropagation=function(){event.isImmediatePropagationStopped=returnTrue,event.stopPropagation()},event.isDefaultPrevented||(event.isDefaultPrevented=returnFalse,event.isPropagationStopped=returnFalse,event.isImmediatePropagationStopped=returnFalse),event}function bindOnReady(win,callback,eventUtils){function readyHandler(){eventUtils.domLoaded||(eventUtils.domLoaded=!0,callback(event))}function waitForDomLoaded(){("complete"===doc.readyState||"interactive"===doc.readyState&&doc.body)&&(removeEvent(doc,"readystatechange",waitForDomLoaded),readyHandler())}function tryScroll(){try{doc.documentElement.doScroll("left")}catch(ex){return setTimeout(tryScroll,0),void 0}readyHandler()}var doc=win.document,event={type:"ready"};return eventUtils.domLoaded?(callback(event),void 0):(doc.addEventListener?"complete"===doc.readyState?readyHandler():addEvent(win,"DOMContentLoaded",readyHandler):(addEvent(doc,"readystatechange",waitForDomLoaded),doc.documentElement.doScroll&&win.self===win.top&&tryScroll()),addEvent(win,"load",readyHandler),void 0)}function EventUtils(){function executeHandlers(evt,id){var callbackList,i,l,callback,container=events[id];if(callbackList=container&&container[evt.type])for(i=0,l=callbackList.length;l>i;i++)if(callback=callbackList[i],callback&&callback.func.call(callback.scope,evt)===!1&&evt.preventDefault(),evt.isImmediatePropagationStopped())return}var count,expando,hasFocusIn,hasMouseEnterLeave,mouseEnterLeave,self=this,events={};expando=eventExpandoPrefix+(+new Date).toString(32),hasMouseEnterLeave="onmouseenter"in document.documentElement,hasFocusIn="onfocusin"in document.documentElement,mouseEnterLeave={mouseenter:"mouseover",mouseleave:"mouseout"},count=1,self.domLoaded=!1,self.events=events,self.bind=function(target,names,callback,scope){function defaultNativeHandler(evt){executeHandlers(fix(evt||win.event),id)}var id,callbackList,i,name,fakeName,nativeHandler,capture,win=window;if(target&&3!==target.nodeType&&8!==target.nodeType){for(target[expando]?id=target[expando]:(id=count++,target[expando]=id,events[id]={}),scope=scope||target,names=names.split(" "),i=names.length;i--;)name=names[i],nativeHandler=defaultNativeHandler,fakeName=capture=!1,"DOMContentLoaded"===name&&(name="ready"),self.domLoaded&&"ready"===name&&"complete"==target.readyState?callback.call(scope,fix({type:name})):(hasMouseEnterLeave||(fakeName=mouseEnterLeave[name],fakeName&&(nativeHandler=function(evt){var current,related;if(current=evt.currentTarget,related=evt.relatedTarget,related&&current.contains)related=current.contains(related);else for(;related&&related!==current;)related=related.parentNode;related||(evt=fix(evt||win.event),evt.type="mouseout"===evt.type?"mouseleave":"mouseenter",evt.target=current,executeHandlers(evt,id))})),hasFocusIn||"focusin"!==name&&"focusout"!==name||(capture=!0,fakeName="focusin"===name?"focus":"blur",nativeHandler=function(evt){evt=fix(evt||win.event),evt.type="focus"===evt.type?"focusin":"focusout",executeHandlers(evt,id)}),callbackList=events[id][name],callbackList?"ready"===name&&self.domLoaded?callback({type:name}):callbackList.push({func:callback,scope:scope}):(events[id][name]=callbackList=[{func:callback,scope:scope}],callbackList.fakeName=fakeName,callbackList.capture=capture,callbackList.nativeHandler=nativeHandler,"ready"===name?bindOnReady(target,nativeHandler,self):addEvent(target,fakeName||name,nativeHandler,capture)));return target=callbackList=0,callback}},self.unbind=function(target,names,callback){var id,callbackList,i,ci,name,eventMap;if(!target||3===target.nodeType||8===target.nodeType)return self;if(id=target[expando]){if(eventMap=events[id],names){for(names=names.split(" "),i=names.length;i--;)if(name=names[i],callbackList=eventMap[name]){if(callback)for(ci=callbackList.length;ci--;)if(callbackList[ci].func===callback){var nativeHandler=callbackList.nativeHandler;callbackList=callbackList.slice(0,ci).concat(callbackList.slice(ci+1)),callbackList.nativeHandler=nativeHandler,eventMap[name]=callbackList}callback&&0!==callbackList.length||(delete eventMap[name],removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture))}}else{for(name in eventMap)callbackList=eventMap[name],removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture);eventMap={}}for(name in eventMap)return self;delete events[id];try{delete target[expando]}catch(ex){target[expando]=null}}return self},self.fire=function(target,name,args){var id;if(!target||3===target.nodeType||8===target.nodeType)return self;args=fix(null,args),args.type=name,args.target=target;do id=target[expando],id&&executeHandlers(args,id),target=target.parentNode||target.ownerDocument||target.defaultView||target.parentWindow;while(target&&!args.isPropagationStopped());return self},self.clean=function(target){var i,children,unbind=self.unbind;if(!target||3===target.nodeType||8===target.nodeType)return self;if(target[expando]&&unbind(target),target.getElementsByTagName||(target=target.document),target&&target.getElementsByTagName)for(unbind(target),children=target.getElementsByTagName("*"),i=children.length;i--;)target=children[i],target[expando]&&unbind(target);return self},self.destroy=function(){events={}},self.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1}}var eventExpandoPrefix="mce-data-",mouseEventRe=/^(?:mouse|contextmenu)|click/,deprecated={keyLocation:1,layerX:1,layerY:1,returnValue:1};return EventUtils.Event=new EventUtils,EventUtils.Event.bind(window,"ready",function(){}),EventUtils}),/**
 * Sizzle.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 *
 * @ignore-file
 */
/*
 * Sizzle CSS Selector Engine
 *  Copyright, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
define("tinymce/dom/Sizzle",[],function(){function isNative(fn){return rnative.test(fn+"")}function createCache(){var cache,keys=[];return cache=function(key,value){return keys.push(key+=" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key]=value,value}}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div=null}}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=context.nodeType)&&9!==nodeType)return[];if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&!rbuggyQSA.test(selector)){if(old=!0,nid=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&context.parentNode||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function siblingCheck(a,b){var cur=b&&a,diff=cur&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var data,cache,outerCache,dirkey=dirruns+" "+doneName;if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(outerCache=elem[expando]||(elem[expando]={}),(cache=outerCache[dir])&&cache[0]===dirkey){if((data=cache[1])===!0||data===cachedruns)return data===!0}else if(cache=outerCache[dir]=[dirkey],cache[1]=matcher(elem,context,xml)||cachedruns,cache[1]===!0)return!0}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1)).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var matcherCachedRuns=0,bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,expandContext){var elem,j,matcher,setMatched=[],matchedCount=0,i="0",unmatched=seed&&[],outermost=null!=expandContext,contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",expandContext&&context.parentNode||context),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1;for(outermost&&(outermostContext=context!==document&&context,cachedruns=matcherCachedRuns);null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique,cachedruns=++matcherCachedRuns)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);if(!seed&&1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&context.parentNode||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return compile(selector,match)(seed,context,!documentIsHTML,results,rsibling.test(selector)),results}function setFilters(){}var i,cachedruns,Expr,getText,isXML,compile,outermostContext,recompare,sortInput,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,support={},dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),hasDuplicate=!1,sortOrder=function(){return 0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){for(var i=0,len=this.length;len>i;i++)if(this[i]===elem)return i;return-1},whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),operators="([*^$|!~]?=)",attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:"+operators+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([\\x20\\t\\r\\n\\f>+~])"+whitespace+"*"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),NAME:new RegExp("^\\[name=['\"]?("+characterEncoding+")['\"]?\\]"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rsibling=/[\x20\t\r\n\f]*[+~]/,rnative=/^[^{]+\{\s*\[native code/,rquickExpr=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rescape=/'|\\/g,rattributeQuotes=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,runescape=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,funescape=function(_,escaped){var high="0x"+escaped-65536;return high!==high?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(55296|high>>10,56320|1023&high)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},setDocument=Sizzle.setDocument=function(node){var doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,documentIsHTML=!isXML(doc),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.attributes=assert(function(div){div.innerHTML="<select></select>";var type=typeof div.lastChild.getAttribute("multiple");return"boolean"!==type&&"string"!==type}),support.getElementsByClassName=assert(function(div){return div.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",div.getElementsByClassName&&div.getElementsByClassName("e").length?(div.lastChild.className="e",2===div.getElementsByClassName("e").length):!1}),support.getByName=assert(function(div){div.id=expando+0,div.appendChild(document.createElement("a")).setAttribute("name",expando),div.appendChild(document.createElement("i")).setAttribute("name",expando),docElem.appendChild(div);var pass=doc.getElementsByName&&doc.getElementsByName(expando).length===2+doc.getElementsByName(expando+0).length;return docElem.removeChild(div),pass}),support.sortDetached=assert(function(div1){return div1.compareDocumentPosition&&1&div1.compareDocumentPosition(document.createElement("div"))}),Expr.attrHandle=assert(function(div){return div.innerHTML="<a href='#'></a>",div.firstChild&&typeof div.firstChild.getAttribute!==strundefined&&"#"===div.firstChild.getAttribute("href")})?{}:{href:function(elem){return elem.getAttribute("href",2)},type:function(elem){return elem.getAttribute("type")}},support.getByName?(Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m?m.id===id||typeof m.getAttributeNode!==strundefined&&m.getAttributeNode("id").value===id?[m]:undefined:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.NAME=support.getByName&&function(tag,context){return typeof context.getElementsByName!==strundefined?context.getElementsByName(name):void 0},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return typeof context.getElementsByClassName!==strundefined&&documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[":focus"],(support.qsa=isNative(doc.querySelectorAll))&&(assert(function(div){div.innerHTML="<select><option selected=''></option></select>",div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked")}),assert(function(div){div.innerHTML="<input type='hidden' i=''/>",div.querySelectorAll("[i^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:\"\"|'')"),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=isNative(matches=docElem.matchesSelector||docElem.mozMatchesSelector||docElem.webkitMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),contains=isNative(docElem.contains)||docElem.compareDocumentPosition?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=docElem.compareDocumentPosition?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b);return compare?1&compare||recompare&&b.compareDocumentPosition(a)===compare?a===doc||contains(preferredDoc,a)?-1:b===doc||contains(preferredDoc,b)?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0:4&compare?-1:1:a.compareDocumentPosition?-1:1}:function(a,b){var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(a===b)return hasDuplicate=!0,0;if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},document):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&!rbuggyQSA.test(expr))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){var val;return(elem.ownerDocument||elem)!==document&&setDocument(elem),documentIsHTML&&(name=name.toLowerCase()),(val=Expr.attrHandle[name])?val(elem):!documentIsHTML||support.attributes?elem.getAttribute(name):((val=elem.getAttributeNode(name))||elem.getAttribute(name))&&elem[name]===!0?name:val&&val.specified?val.value:null},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,recompare=!support.sortDetached,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i];i++)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[4]?match[2]=match[4]:unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeName){return"*"===nodeName?function(){return!0}:(nodeName=nodeName.replace(runescape,funescape).toLowerCase(),function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName})},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||0===diff%first&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf.call(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeName>"@"||3===elem.nodeType||4===elem.nodeType)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||attr.toLowerCase()===elem.type)},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}};for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);return compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(group||(group=tokenize(selector)),i=group.length;i--;)cached=matcherFromTokens(group[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))}return cached},Expr.pseudos.nth=Expr.pseudos.eq,setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,support.sortStable=expando.split("").sort(sortOrder).join("")===expando,setDocument(),[0,0].sort(sortOrder),support.detectDuplicates=hasDuplicate,Sizzle}),/**
 * DomQuery.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 *
 * Some of this logic is based on jQuery code that is released under
 * MIT license that grants us to sublicense it under LGPL.
 *
 * @ignore-file
 */
define("tinymce/dom/DomQuery",["tinymce/dom/EventUtils","tinymce/dom/Sizzle"],function(EventUtils,Sizzle){function isDefined(obj){return"undefined"!=typeof obj}function isString(obj){return"string"==typeof obj}function createFragment(html){var frag,node,container;for(container=doc.createElement("div"),frag=doc.createDocumentFragment(),container.innerHTML=html;node=container.firstChild;)frag.appendChild(node);return frag}function domManipulate(targetNodes,sourceItem,callback){var i;if("string"==typeof sourceItem)sourceItem=createFragment(sourceItem);else if(sourceItem.length){for(i=0;i<sourceItem.length;i++)domManipulate(targetNodes,sourceItem[i],callback);return targetNodes}for(i=targetNodes.length;i--;)callback.call(targetNodes[i],sourceItem.parentNode?sourceItem:sourceItem);return targetNodes}function hasClass(node,className){return node&&className&&-1!==(" "+node.className+" ").indexOf(" "+className+" ")}function makeMap(items,map){var i;for(items=items||[],"string"==typeof items&&(items=items.split(" ")),map=map||{},i=items.length;i--;)map[items[i]]={};return map}function DomQuery(selector,context){return new DomQuery.fn.init(selector,context)}function extend(target){var arg,i,key,args=arguments;for(i=1;i<args.length;i++){arg=args[i];for(key in arg)target[key]=arg[key]}return target}function toArray(obj){var i,l,array=[];for(i=0,l=obj.length;l>i;i++)array[i]=obj[i];return array}function inArray(item,array){var i;if(array.indexOf)return array.indexOf(item);for(i=array.length;i--;)if(array[i]===item)return i;return-1}function each(obj,callback){var length,key,i,undef,value;if(obj)if(length=obj.length,length===undef){for(key in obj)if(obj.hasOwnProperty(key)&&(value=obj[key],callback.call(value,value,key)===!1))break}else for(i=0;length>i&&(value=obj[i],callback.call(value,value,key)!==!1);i++);return obj}function dir(el,prop,until){for(var matched=[],cur=el[prop];cur&&9!==cur.nodeType&&(until===undefined||1!==cur.nodeType||!DomQuery(cur).is(until));)1===cur.nodeType&&matched.push(cur),cur=cur[prop];return matched}function sibling(n,el,siblingName,nodeType){for(var r=[];n;n=n[siblingName])nodeType&&n.nodeType!==nodeType||n===el||r.push(n);return r}var doc=document,push=Array.prototype.push,slice=Array.prototype.slice,rquickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Event=EventUtils.Event,numericCssMap=makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"),isArray=Array.isArray||function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},whiteSpaceRegExp=/^\s*|\s*$/g,trim=function(str){return null===str||str===undefined?"":(""+str).replace(whiteSpaceRegExp,"")};return DomQuery.fn=DomQuery.prototype={constructor:DomQuery,selector:"",length:0,init:function(selector,context){var match,node,self=this;if(!selector)return self;if(selector.nodeType)return self.context=self[0]=selector,self.length=1,self;if(isString(selector)){if(match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match)return DomQuery(context||document).find(selector);if(match[1])for(node=createFragment(selector).firstChild;node;)this.add(node),node=node.nextSibling;else{if(node=doc.getElementById(match[2]),node.id!==match[2])return self.find(selector);self.length=1,self[0]=node}}else this.add(selector);return self},toArray:function(){return toArray(this)},add:function(items){var self=this;return isArray(items)?push.apply(self,items):items instanceof DomQuery?self.add(items.toArray()):push.call(self,items),self},attr:function(name,value){var self=this;if("object"==typeof name)each(name,function(value,name){self.attr(name,value)});else{if(!isDefined(value))return self[0]&&1===self[0].nodeType?self[0].getAttribute(name):undefined;this.each(function(){1===this.nodeType&&this.setAttribute(name,value)})}return self},css:function(name,value){var self=this;if("object"==typeof name)each(name,function(value,name){self.css(name,value)});else{if(name=name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()}),!isDefined(value))return self[0]?self[0].style[name]:undefined;"number"!=typeof value||numericCssMap[name]||(value+="px"),self.each(function(){var style=this.style;"opacity"===name&&this.runtimeStyle&&"undefined"==typeof this.runtimeStyle.opacity&&(style.filter=""===value?"":"alpha(opacity="+100*value+")");try{style[name]=value}catch(ex){}})}return self},remove:function(){for(var node,self=this,i=this.length;i--;)node=self[i],Event.clean(node),node.parentNode&&node.parentNode.removeChild(node);return this},empty:function(){for(var node,self=this,i=this.length;i--;)for(node=self[i];node.firstChild;)node.removeChild(node.firstChild);return this},html:function(value){var i,self=this;if(isDefined(value)){for(i=self.length;i--;)self[i].innerHTML=value;return self}return self[0]?self[0].innerHTML:""},text:function(value){var i,self=this;if(isDefined(value)){for(i=self.length;i--;)self[i].innerText=self[0].textContent=value;return self}return self[0]?self[0].innerText||self[0].textContent:""},append:function(){return domManipulate(this,arguments,function(node){1===this.nodeType&&this.appendChild(node)})},prepend:function(){return domManipulate(this,arguments,function(node){1===this.nodeType&&this.insertBefore(node,this.firstChild)})},before:function(){var self=this;return self[0]&&self[0].parentNode?domManipulate(self,arguments,function(node){this.parentNode.insertBefore(node,this.nextSibling)}):self},after:function(){var self=this;return self[0]&&self[0].parentNode?domManipulate(self,arguments,function(node){this.parentNode.insertBefore(node,this)}):self},appendTo:function(val){return DomQuery(val).append(this),this},addClass:function(className){return this.toggleClass(className,!0)},removeClass:function(className){return this.toggleClass(className,!1)},toggleClass:function(className,state){var self=this;return-1!==className.indexOf(" ")?each(className.split(" "),function(){self.toggleClass(this,state)}):self.each(function(){var existingClassName,node=this;hasClass(node,className)!==state&&(existingClassName=node.className,state?node.className+=existingClassName?" "+className:className:node.className=trim((" "+existingClassName+" ").replace(" "+className+" "," ")))}),self},hasClass:function(className){return hasClass(this[0],className)},each:function(callback){return each(this,callback)},on:function(name,callback){return this.each(function(){Event.bind(this,name,callback)})},off:function(name,callback){return this.each(function(){Event.unbind(this,name,callback)})},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new DomQuery(slice.apply(this,arguments))},eq:function(index){return-1===index?this.slice(index):this.slice(index,+index+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},replaceWith:function(content){var self=this;return self[0]&&self[0].parentNode.replaceChild(DomQuery(content)[0],self[0]),self},wrap:function(wrapper){return wrapper=DomQuery(wrapper)[0],this.each(function(){var self=this,newWrapper=wrapper.cloneNode(!1);self.parentNode.insertBefore(newWrapper,self),newWrapper.appendChild(self)})},unwrap:function(){return this.each(function(){for(var currentNode,self=this,node=self.firstChild;node;)currentNode=node,node=node.nextSibling,self.parentNode.insertBefore(currentNode,self)})},clone:function(){var result=[];return this.each(function(){result.push(this.cloneNode(!0))}),DomQuery(result)},find:function(selector){var i,l,ret=[];for(i=0,l=this.length;l>i;i++)DomQuery.find(selector,this[i],ret);return DomQuery(ret)},push:push,sort:[].sort,splice:[].splice},extend(DomQuery,{extend:extend,toArray:toArray,inArray:inArray,isArray:isArray,each:each,trim:trim,makeMap:makeMap,find:Sizzle,expr:Sizzle.selectors,unique:Sizzle.uniqueSort,text:Sizzle.getText,isXMLDoc:Sizzle.isXML,contains:Sizzle.contains,filter:function(expr,elems,not){return not&&(expr=":not("+expr+")"),1===elems.length?DomQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:DomQuery.find.matches(expr,elems)}}),each({parent:function(node){var parent=node.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(node){return dir(node,"parentNode")},parentsUntil:function(node,until){return dir(node,"parentNode",until)},next:function(node){return sibling(node,"nextSibling",1)},prev:function(node){return sibling(node,"previousSibling",1)},nextNodes:function(node){return sibling(node,"nextSibling")},prevNodes:function(node){return sibling(node,"previousSibling")},children:function(node){return sibling(node.firstChild,"nextSibling",1)},contents:function(node){return toArray(("iframe"===node.nodeName?node.contentDocument||node.contentWindow.document:node).childNodes)}},function(name,fn){DomQuery.fn[name]=function(selector){var result,self=this;if(self.length>1)throw new Error("DomQuery only supports traverse functions on a single node.");return self[0]&&(result=fn(self[0],selector)),result=DomQuery(result),selector&&"parentsUntil"!==name?result.filter(selector):result}}),DomQuery.fn.filter=function(selector){return DomQuery.filter(selector)},DomQuery.fn.is=function(selector){return!!selector&&this.filter(selector).length>0},DomQuery.fn.init.prototype=DomQuery.fn,DomQuery}),/**
 * Styles.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/html/Styles",[],function(){return function(settings,schema){function toHex(match,r,g,b){function hex(val){return val=parseInt(val,10).toString(16),val.length>1?val:"0"+val}return"#"+hex(r)+hex(g)+hex(b)}var undef,i,encodingItems,rgbRegExp=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,urlOrStrRegExp=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,styleRegExp=/\s*([^:]+):\s*([^;]+);?/g,trimRightRegExp=/\s+$/,encodingLookup={},invisibleChar="﻿";for(settings=settings||{},encodingItems=("\\\" \\' \\; \\: ; : "+invisibleChar).split(" "),i=0;i<encodingItems.length;i++)encodingLookup[encodingItems[i]]=invisibleChar+i,encodingLookup[invisibleChar+i]=encodingItems[i];return{toHex:function(color){return color.replace(rgbRegExp,toHex)},parse:function(css){function compress(prefix,suffix,noJoin){var top,right,bottom,left;if(top=styles[prefix+"-top"+suffix],top&&(right=styles[prefix+"-right"+suffix],right&&(bottom=styles[prefix+"-bottom"+suffix],bottom&&(left=styles[prefix+"-left"+suffix])))){var box=[top,right,bottom,left];for(i=box.length-1;i--&&box[i]===box[i+1];);i>-1&&noJoin||(styles[prefix+suffix]=-1==i?box[0]:box.join(" "),delete styles[prefix+"-top"+suffix],delete styles[prefix+"-right"+suffix],delete styles[prefix+"-bottom"+suffix],delete styles[prefix+"-left"+suffix])}}function canCompress(key){var i,value=styles[key];if(value){for(value=value.split(" "),i=value.length;i--;)if(value[i]!==value[0])return!1;return styles[key]=value[0],!0}}function compress2(target,a,b,c){canCompress(a)&&canCompress(b)&&canCompress(c)&&(styles[target]=styles[a]+" "+styles[b]+" "+styles[c],delete styles[a],delete styles[b],delete styles[c])}function encode(str){return isEncoded=!0,encodingLookup[str]}function decode(str,keep_slashes){return isEncoded&&(str=str.replace(/\uFEFF[0-9]/g,function(str){return encodingLookup[str]})),keep_slashes||(str=str.replace(/\\([\'\";:])/g,"$1")),str}function processUrl(match,url,url2,url3,str,str2){return(str=str||str2)?(str=decode(str),"'"+str.replace(/\'/g,"\\'")+"'"):(url=decode(url||url2||url3),!settings.allow_script_urls&&/(java|vb)script:/i.test(url.replace(/[\s\r\n]+/,""))?"":(urlConverter&&(url=urlConverter.call(urlConverterScope,url,"style")),"url('"+url.replace(/\'/g,"\\'")+"')"))}var matches,name,value,isEncoded,styles={},urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope||this;if(css){for(css=css.replace(/[\u0000-\u001F]/g,""),css=css.replace(/\\[\"\';:\uFEFF]/g,encode).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(str){return str.replace(/[;:]/g,encode)});matches=styleRegExp.exec(css);){if(name=matches[1].replace(trimRightRegExp,"").toLowerCase(),value=matches[2].replace(trimRightRegExp,""),name&&value.length>0){if(!settings.allow_script_urls&&("behavior"==name||/expression\s*\(/.test(value)))continue;"font-weight"===name&&"700"===value?value="bold":("color"===name||"background-color"===name)&&(value=value.toLowerCase()),value=value.replace(rgbRegExp,toHex),value=value.replace(urlOrStrRegExp,processUrl),styles[name]=isEncoded?decode(value,!0):value}styleRegExp.lastIndex=matches.index+matches[0].length}compress("border","",!0),compress("border","-width"),compress("border","-color"),compress("border","-style"),compress("padding",""),compress("margin",""),compress2("border","border-width","border-style","border-color"),"medium none"===styles.border&&delete styles.border,"none"===styles["border-image"]&&delete styles["border-image"]}return styles},serialize:function(styles,element_name){function serializeStyles(name){var styleList,i,l,value;if(styleList=schema.styles[name])for(i=0,l=styleList.length;l>i;i++)name=styleList[i],value=styles[name],value!==undef&&value.length>0&&(css+=(css.length>0?" ":"")+name+": "+value+";")}var name,value,css="";if(element_name&&schema&&schema.styles)serializeStyles("*"),serializeStyles(element_name);else for(name in styles)value=styles[name],value!==undef&&value.length>0&&(css+=(css.length>0?" ":"")+name+": "+value+";");return css}}}}),/**
 * TreeWalker.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/dom/TreeWalker",[],function(){return function(start_node,root_node){function findSibling(node,start_name,sibling_name,shallow){var sibling,parent;if(node){if(!shallow&&node[start_name])return node[start_name];if(node!=root_node){if(sibling=node[sibling_name])return sibling;for(parent=node.parentNode;parent&&parent!=root_node;parent=parent.parentNode)if(sibling=parent[sibling_name])return sibling}}}var node=start_node;this.current=function(){return node},this.next=function(shallow){return node=findSibling(node,"firstChild","nextSibling",shallow)},this.prev=function(shallow){return node=findSibling(node,"lastChild","previousSibling",shallow)}}}),/**
 * Tools.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/util/Tools",[],function(){function is(o,t){return t?"array"==t&&isArray(o)?!0:typeof o==t:o!==undefined}function toArray(obj){var i,l,array=[];for(i=0,l=obj.length;l>i;i++)array[i]=obj[i];return array}function makeMap(items,delim,map){var i;for(items=items||[],delim=delim||",","string"==typeof items&&(items=items.split(delim)),map=map||{},i=items.length;i--;)map[items[i]]={};return map}function each(o,cb,s){var n,l;if(!o)return 0;if(s=s||o,o.length!==undefined){for(n=0,l=o.length;l>n;n++)if(cb.call(s,o[n],n,o)===!1)return 0}else for(n in o)if(o.hasOwnProperty(n)&&cb.call(s,o[n],n,o)===!1)return 0;return 1}function map(a,f){var o=[];return each(a,function(v){o.push(f(v))}),o}function grep(a,f){var o=[];return each(a,function(v){(!f||f(v))&&o.push(v)}),o}function create(s,p,root){var sp,ns,cn,scn,c,t=this,de=0;if(s=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(s),cn=s[3].match(/(^|\.)(\w+)$/i)[2],ns=t.createNS(s[3].replace(/\.\w+$/,""),root),!ns[cn]){if("static"==s[2])return ns[cn]=p,this.onCreate&&this.onCreate(s[2],s[3],ns[cn]),void 0;p[cn]||(p[cn]=function(){},de=1),ns[cn]=p[cn],t.extend(ns[cn].prototype,p),s[5]&&(sp=t.resolve(s[5]).prototype,scn=s[5].match(/\.(\w+)$/i)[1],c=ns[cn],ns[cn]=de?function(){return sp[scn].apply(this,arguments)}:function(){return this.parent=sp[scn],c.apply(this,arguments)},ns[cn].prototype[cn]=ns[cn],t.each(sp,function(f,n){ns[cn].prototype[n]=sp[n]}),t.each(p,function(f,n){sp[n]?ns[cn].prototype[n]=function(){return this.parent=sp[n],f.apply(this,arguments)}:n!=cn&&(ns[cn].prototype[n]=f)})),t.each(p["static"],function(f,n){ns[cn][n]=f})}}function inArray(a,v){var i,l;if(a)for(i=0,l=a.length;l>i;i++)if(a[i]===v)return i;return-1}function extend(obj,ext){var i,l,name,value,args=arguments;for(i=1,l=args.length;l>i;i++){ext=args[i];for(name in ext)ext.hasOwnProperty(name)&&(value=ext[name],value!==undefined&&(obj[name]=value))}return obj}function walk(o,f,n,s){s=s||this,o&&(n&&(o=o[n]),each(o,function(o,i){return f.call(s,o,i,n)===!1?!1:(walk(o,f,n,s),void 0)}))}function createNS(n,o){var i,v;for(o=o||window,n=n.split("."),i=0;i<n.length;i++)v=n[i],o[v]||(o[v]={}),o=o[v];return o}function resolve(n,o){var i,l;for(o=o||window,n=n.split("."),i=0,l=n.length;l>i&&(o=o[n[i]],o);i++);return o}function explode(s,d){return!s||is(s,"array")?s:map(s.split(d||","),trim)}var whiteSpaceRegExp=/^\s*|\s*$/g,trim=function(str){return null===str||str===undefined?"":(""+str).replace(whiteSpaceRegExp,"")},isArray=Array.isArray||function(obj){return"[object Array]"===Object.prototype.toString.call(obj)};return{trim:trim,isArray:isArray,is:is,toArray:toArray,makeMap:makeMap,each:each,map:map,grep:grep,inArray:inArray,extend:extend,create:create,walk:walk,createNS:createNS,resolve:resolve,explode:explode}}),/**
 * Range.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/dom/Range",["tinymce/util/Tools"],function(Tools){function Range(dom){function createDocumentFragment(){return doc.createDocumentFragment()}function setStart(n,o){_setEndPoint(TRUE,n,o)}function setEnd(n,o){_setEndPoint(FALSE,n,o)}function setStartBefore(n){setStart(n.parentNode,nodeIndex(n))}function setStartAfter(n){setStart(n.parentNode,nodeIndex(n)+1)}function setEndBefore(n){setEnd(n.parentNode,nodeIndex(n))}function setEndAfter(n){setEnd(n.parentNode,nodeIndex(n)+1)}function collapse(ts){ts?(t[END_CONTAINER]=t[START_CONTAINER],t[END_OFFSET]=t[START_OFFSET]):(t[START_CONTAINER]=t[END_CONTAINER],t[START_OFFSET]=t[END_OFFSET]),t.collapsed=TRUE}function selectNode(n){setStartBefore(n),setEndAfter(n)}function selectNodeContents(n){setStart(n,0),setEnd(n,1===n.nodeType?n.childNodes.length:n.nodeValue.length)}function compareBoundaryPoints(h,r){var sc=t[START_CONTAINER],so=t[START_OFFSET],ec=t[END_CONTAINER],eo=t[END_OFFSET],rsc=r.startContainer,rso=r.startOffset,rec=r.endContainer,reo=r.endOffset;return 0===h?_compareBoundaryPoints(sc,so,rsc,rso):1===h?_compareBoundaryPoints(ec,eo,rsc,rso):2===h?_compareBoundaryPoints(ec,eo,rec,reo):3===h?_compareBoundaryPoints(sc,so,rec,reo):void 0}function deleteContents(){_traverse(DELETE)}function extractContents(){return _traverse(EXTRACT)}function cloneContents(){return _traverse(CLONE)}function insertNode(n){var nn,o,startContainer=this[START_CONTAINER],startOffset=this[START_OFFSET];3!==startContainer.nodeType&&4!==startContainer.nodeType||!startContainer.nodeValue?(startContainer.childNodes.length>0&&(o=startContainer.childNodes[startOffset]),o?startContainer.insertBefore(n,o):3==startContainer.nodeType?dom.insertAfter(n,startContainer):startContainer.appendChild(n)):startOffset?startOffset>=startContainer.nodeValue.length?dom.insertAfter(n,startContainer):(nn=startContainer.splitText(startOffset),startContainer.parentNode.insertBefore(n,nn)):startContainer.parentNode.insertBefore(n,startContainer)}function surroundContents(n){var f=t.extractContents();t.insertNode(n),n.appendChild(f),t.selectNode(n)}function cloneRange(){return extend(new Range(dom),{startContainer:t[START_CONTAINER],startOffset:t[START_OFFSET],endContainer:t[END_CONTAINER],endOffset:t[END_OFFSET],collapsed:t.collapsed,commonAncestorContainer:t.commonAncestorContainer})}function _getSelectedNode(container,offset){var child;if(3==container.nodeType)return container;if(0>offset)return container;for(child=container.firstChild;child&&offset>0;)--offset,child=child.nextSibling;return child?child:container}function _isCollapsed(){return t[START_CONTAINER]==t[END_CONTAINER]&&t[START_OFFSET]==t[END_OFFSET]}function _compareBoundaryPoints(containerA,offsetA,containerB,offsetB){var c,offsetC,n,cmnRoot,childA,childB;if(containerA==containerB)return offsetA==offsetB?0:offsetB>offsetA?-1:1;for(c=containerB;c&&c.parentNode!=containerA;)c=c.parentNode;if(c){for(offsetC=0,n=containerA.firstChild;n!=c&&offsetA>offsetC;)offsetC++,n=n.nextSibling;return offsetC>=offsetA?-1:1}for(c=containerA;c&&c.parentNode!=containerB;)c=c.parentNode;if(c){for(offsetC=0,n=containerB.firstChild;n!=c&&offsetB>offsetC;)offsetC++,n=n.nextSibling;return offsetB>offsetC?-1:1}for(cmnRoot=dom.findCommonAncestor(containerA,containerB),childA=containerA;childA&&childA.parentNode!=cmnRoot;)childA=childA.parentNode;for(childA||(childA=cmnRoot),childB=containerB;childB&&childB.parentNode!=cmnRoot;)childB=childB.parentNode;if(childB||(childB=cmnRoot),childA==childB)return 0;for(n=cmnRoot.firstChild;n;){if(n==childA)return-1;if(n==childB)return 1;n=n.nextSibling}}function _setEndPoint(st,n,o){var ec,sc;for(st?(t[START_CONTAINER]=n,t[START_OFFSET]=o):(t[END_CONTAINER]=n,t[END_OFFSET]=o),ec=t[END_CONTAINER];ec.parentNode;)ec=ec.parentNode;for(sc=t[START_CONTAINER];sc.parentNode;)sc=sc.parentNode;sc==ec?_compareBoundaryPoints(t[START_CONTAINER],t[START_OFFSET],t[END_CONTAINER],t[END_OFFSET])>0&&t.collapse(st):t.collapse(st),t.collapsed=_isCollapsed(),t.commonAncestorContainer=dom.findCommonAncestor(t[START_CONTAINER],t[END_CONTAINER])}function _traverse(how){var c,p,depthDiff,startNode,endNode,sp,ep,endContainerDepth=0,startContainerDepth=0;if(t[START_CONTAINER]==t[END_CONTAINER])return _traverseSameContainer(how);for(c=t[END_CONTAINER],p=c.parentNode;p;c=p,p=p.parentNode){if(p==t[START_CONTAINER])return _traverseCommonStartContainer(c,how);++endContainerDepth}for(c=t[START_CONTAINER],p=c.parentNode;p;c=p,p=p.parentNode){if(p==t[END_CONTAINER])return _traverseCommonEndContainer(c,how);++startContainerDepth}for(depthDiff=startContainerDepth-endContainerDepth,startNode=t[START_CONTAINER];depthDiff>0;)startNode=startNode.parentNode,depthDiff--;for(endNode=t[END_CONTAINER];0>depthDiff;)endNode=endNode.parentNode,depthDiff++;for(sp=startNode.parentNode,ep=endNode.parentNode;sp!=ep;sp=sp.parentNode,ep=ep.parentNode)startNode=sp,endNode=ep;return _traverseCommonAncestors(startNode,endNode,how)}function _traverseSameContainer(how){var frag,s,sub,n,cnt,sibling,xferNode,start,len;if(how!=DELETE&&(frag=createDocumentFragment()),t[START_OFFSET]==t[END_OFFSET])return frag;if(3==t[START_CONTAINER].nodeType){if(s=t[START_CONTAINER].nodeValue,sub=s.substring(t[START_OFFSET],t[END_OFFSET]),how!=CLONE&&(n=t[START_CONTAINER],start=t[START_OFFSET],len=t[END_OFFSET]-t[START_OFFSET],0===start&&len>=n.nodeValue.length-1?n.parentNode.removeChild(n):n.deleteData(start,len),t.collapse(TRUE)),how==DELETE)return;return sub.length>0&&frag.appendChild(doc.createTextNode(sub)),frag}for(n=_getSelectedNode(t[START_CONTAINER],t[START_OFFSET]),cnt=t[END_OFFSET]-t[START_OFFSET];n&&cnt>0;)sibling=n.nextSibling,xferNode=_traverseFullySelected(n,how),frag&&frag.appendChild(xferNode),--cnt,n=sibling;return how!=CLONE&&t.collapse(TRUE),frag}function _traverseCommonStartContainer(endAncestor,how){var frag,n,endIdx,cnt,sibling,xferNode;if(how!=DELETE&&(frag=createDocumentFragment()),n=_traverseRightBoundary(endAncestor,how),frag&&frag.appendChild(n),endIdx=nodeIndex(endAncestor),cnt=endIdx-t[START_OFFSET],0>=cnt)return how!=CLONE&&(t.setEndBefore(endAncestor),t.collapse(FALSE)),frag;for(n=endAncestor.previousSibling;cnt>0;)sibling=n.previousSibling,xferNode=_traverseFullySelected(n,how),frag&&frag.insertBefore(xferNode,frag.firstChild),--cnt,n=sibling;return how!=CLONE&&(t.setEndBefore(endAncestor),t.collapse(FALSE)),frag}function _traverseCommonEndContainer(startAncestor,how){var frag,startIdx,n,cnt,sibling,xferNode;for(how!=DELETE&&(frag=createDocumentFragment()),n=_traverseLeftBoundary(startAncestor,how),frag&&frag.appendChild(n),startIdx=nodeIndex(startAncestor),++startIdx,cnt=t[END_OFFSET]-startIdx,n=startAncestor.nextSibling;n&&cnt>0;)sibling=n.nextSibling,xferNode=_traverseFullySelected(n,how),frag&&frag.appendChild(xferNode),--cnt,n=sibling;return how!=CLONE&&(t.setStartAfter(startAncestor),t.collapse(TRUE)),frag}function _traverseCommonAncestors(startAncestor,endAncestor,how){var n,frag,commonParent,startOffset,endOffset,cnt,sibling,nextSibling;for(how!=DELETE&&(frag=createDocumentFragment()),n=_traverseLeftBoundary(startAncestor,how),frag&&frag.appendChild(n),commonParent=startAncestor.parentNode,startOffset=nodeIndex(startAncestor),endOffset=nodeIndex(endAncestor),++startOffset,cnt=endOffset-startOffset,sibling=startAncestor.nextSibling;cnt>0;)nextSibling=sibling.nextSibling,n=_traverseFullySelected(sibling,how),frag&&frag.appendChild(n),sibling=nextSibling,--cnt;return n=_traverseRightBoundary(endAncestor,how),frag&&frag.appendChild(n),how!=CLONE&&(t.setStartAfter(startAncestor),t.collapse(TRUE)),frag}function _traverseRightBoundary(root,how){var parent,clonedParent,prevSibling,clonedChild,clonedGrandParent,next=_getSelectedNode(t[END_CONTAINER],t[END_OFFSET]-1),isFullySelected=next!=t[END_CONTAINER];if(next==root)return _traverseNode(next,isFullySelected,FALSE,how);for(parent=next.parentNode,clonedParent=_traverseNode(parent,FALSE,FALSE,how);parent;){for(;next;)prevSibling=next.previousSibling,clonedChild=_traverseNode(next,isFullySelected,FALSE,how),how!=DELETE&&clonedParent.insertBefore(clonedChild,clonedParent.firstChild),isFullySelected=TRUE,next=prevSibling;if(parent==root)return clonedParent;next=parent.previousSibling,parent=parent.parentNode,clonedGrandParent=_traverseNode(parent,FALSE,FALSE,how),how!=DELETE&&clonedGrandParent.appendChild(clonedParent),clonedParent=clonedGrandParent}}function _traverseLeftBoundary(root,how){var parent,clonedParent,nextSibling,clonedChild,clonedGrandParent,next=_getSelectedNode(t[START_CONTAINER],t[START_OFFSET]),isFullySelected=next!=t[START_CONTAINER];if(next==root)return _traverseNode(next,isFullySelected,TRUE,how);for(parent=next.parentNode,clonedParent=_traverseNode(parent,FALSE,TRUE,how);parent;){for(;next;)nextSibling=next.nextSibling,clonedChild=_traverseNode(next,isFullySelected,TRUE,how),how!=DELETE&&clonedParent.appendChild(clonedChild),isFullySelected=TRUE,next=nextSibling;if(parent==root)return clonedParent;next=parent.nextSibling,parent=parent.parentNode,clonedGrandParent=_traverseNode(parent,FALSE,TRUE,how),how!=DELETE&&clonedGrandParent.appendChild(clonedParent),clonedParent=clonedGrandParent}}function _traverseNode(n,isFullySelected,isLeft,how){var txtValue,newNodeValue,oldNodeValue,offset,newNode;if(isFullySelected)return _traverseFullySelected(n,how);if(3==n.nodeType){if(txtValue=n.nodeValue,isLeft?(offset=t[START_OFFSET],newNodeValue=txtValue.substring(offset),oldNodeValue=txtValue.substring(0,offset)):(offset=t[END_OFFSET],newNodeValue=txtValue.substring(0,offset),oldNodeValue=txtValue.substring(offset)),how!=CLONE&&(n.nodeValue=oldNodeValue),how==DELETE)return;return newNode=dom.clone(n,FALSE),newNode.nodeValue=newNodeValue,newNode}if(how!=DELETE)return dom.clone(n,FALSE)}function _traverseFullySelected(n,how){return how!=DELETE?how==CLONE?dom.clone(n,TRUE):n:(n.parentNode.removeChild(n),void 0)}function toStringIE(){return dom.create("body",null,cloneContents()).outerText}var t=this,doc=dom.doc,EXTRACT=0,CLONE=1,DELETE=2,TRUE=!0,FALSE=!1,START_OFFSET="startOffset",START_CONTAINER="startContainer",END_CONTAINER="endContainer",END_OFFSET="endOffset",extend=Tools.extend,nodeIndex=dom.nodeIndex;return extend(t,{startContainer:doc,startOffset:0,endContainer:doc,endOffset:0,collapsed:TRUE,commonAncestorContainer:doc,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:setStart,setEnd:setEnd,setStartBefore:setStartBefore,setStartAfter:setStartAfter,setEndBefore:setEndBefore,setEndAfter:setEndAfter,collapse:collapse,selectNode:selectNode,selectNodeContents:selectNodeContents,compareBoundaryPoints:compareBoundaryPoints,deleteContents:deleteContents,extractContents:extractContents,cloneContents:cloneContents,insertNode:insertNode,surroundContents:surroundContents,cloneRange:cloneRange,toStringIE:toStringIE}),t}return Range.prototype.toString=function(){return this.toStringIE()},Range}),/**
 * Entities.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/html/Entities",["tinymce/util/Tools"],function(Tools){function nativeDecode(text){var elm;return elm=document.createElement("div"),elm.innerHTML=text,elm.textContent||elm.innerText||text}function buildEntitiesLookup(items,radix){var i,chr,entity,lookup={};if(items){for(items=items.split(","),radix=radix||10,i=0;i<items.length;i+=2)chr=String.fromCharCode(parseInt(items[i],radix)),baseEntities[chr]||(entity="&"+items[i+1]+";",lookup[chr]=entity,lookup[entity]=chr);return lookup}}var namedEntities,baseEntities,reverseEntities,makeMap=Tools.makeMap,attrsCharsRegExp=/[&<>\"\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,textCharsRegExp=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rawCharsRegExp=/[<>&\"\']/g,entityRegExp=/&(#x|#)?([\w]+);/g,asciiMap={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"};baseEntities={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"},reverseEntities={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},namedEntities=buildEntitiesLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var Entities={encodeRaw:function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeAllRaw:function(text){return(""+text).replace(rawCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeNumeric:function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return chr.length>1?"&#"+(1024*(chr.charCodeAt(0)-55296)+(chr.charCodeAt(1)-56320)+65536)+";":baseEntities[chr]||"&#"+chr.charCodeAt(0)+";"})},encodeNamed:function(text,attr,entities){return entities=entities||namedEntities,text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||chr})},getEncodeFunc:function(name,entities){function encodeNamedAndNumeric(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||"&#"+chr.charCodeAt(0)+";"||chr})}function encodeCustomNamed(text,attr){return Entities.encodeNamed(text,attr,entities)}return entities=buildEntitiesLookup(entities)||namedEntities,name=makeMap(name.replace(/\+/g,",")),name.named&&name.numeric?encodeNamedAndNumeric:name.named?entities?encodeCustomNamed:Entities.encodeNamed:name.numeric?Entities.encodeNumeric:Entities.encodeRaw},decode:function(text){return text.replace(entityRegExp,function(all,numeric,value){return numeric?(value=parseInt(value,2===numeric.length?16:10),value>65535?(value-=65536,String.fromCharCode(55296+(value>>10),56320+(1023&value))):asciiMap[value]||String.fromCharCode(value)):reverseEntities[all]||namedEntities[all]||nativeDecode(all)})}};return Entities}),/**
 * Env.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/Env",[],function(){var opera,webkit,ie,ie11,gecko,mac,iDevice,nav=navigator,userAgent=nav.userAgent;opera=window.opera&&window.opera.buildNumber,webkit=/WebKit/.test(userAgent),ie=!webkit&&!opera&&/MSIE/gi.test(userAgent)&&/Explorer/gi.test(nav.appName),ie=ie&&/MSIE (\w+)\./.exec(userAgent)[1],ie11=-1==userAgent.indexOf("Trident/")||-1==userAgent.indexOf("rv:")&&-1==nav.appName.indexOf("Netscape")?!1:11,ie=ie||ie11,gecko=!webkit&&!ie11&&/Gecko/.test(userAgent),mac=-1!=userAgent.indexOf("Mac"),iDevice=/(iPad|iPhone)/.test(userAgent);var contentEditable=!iDevice||userAgent.match(/AppleWebKit\/(\d*)/)[1]>=534;return{opera:opera,webkit:webkit,ie:ie,gecko:gecko,mac:mac,iOS:iDevice,contentEditable:contentEditable,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:8!=ie,range:window.getSelection&&"Range"in window,documentMode:ie?document.documentMode||7:10}}),/**
 * StyleSheetLoader.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/dom/StyleSheetLoader",[],function(){return function(document,settings){function appendToHead(node){document.getElementsByTagName("head")[0].appendChild(node)}function load(url,loadedCallback,errorCallback){function passed(){for(var callbacks=state.passed,i=callbacks.length;i--;)callbacks[i]();state.status=2,state.passed=[],state.failed=[]}function failed(){for(var callbacks=state.failed,i=callbacks.length;i--;)callbacks[i]();state.status=3,state.passed=[],state.failed=[]}function isOldWebKit(){var webKitChunks=navigator.userAgent.match(/WebKit\/(\d*)/);return!!(webKitChunks&&webKitChunks[1]<536)}function wait(testCallback,waitCallback){testCallback()||((new Date).getTime()-startTime<maxLoadTime?window.setTimeout(waitCallback,0):failed())}function waitForWebKitLinkLoaded(){wait(function(){for(var styleSheet,owner,styleSheets=document.styleSheets,i=styleSheets.length;i--;)if(styleSheet=styleSheets[i],owner=styleSheet.ownerNode?styleSheet.ownerNode:styleSheet.owningElement,owner&&owner.id===link.id)return passed(),!0},waitForWebKitLinkLoaded)}function waitForGeckoLinkLoaded(){wait(function(){try{var cssRules=style.sheet.cssRules;return passed(),!!cssRules}catch(ex){}},waitForGeckoLinkLoaded)}var link,style,startTime,state;if(loadedStates[url]?state=loadedStates[url]:(state={passed:[],failed:[]},loadedStates[url]=state),loadedCallback&&state.passed.push(loadedCallback),errorCallback&&state.failed.push(errorCallback),1!=state.status){if(2==state.status)return passed(),void 0;if(3==state.status)return failed(),void 0;if(state.status=1,link=document.createElement("link"),link.rel="stylesheet",link.type="text/css",link.id="u"+idCount++,link.async=!1,link.defer=!1,startTime=(new Date).getTime(),"onload"in link&&!isOldWebKit())link.onload=waitForWebKitLinkLoaded,link.onerror=failed;else{if(navigator.userAgent.indexOf("Firefox")>0)return style=document.createElement("style"),style.textContent='@import "'+url+'"',waitForGeckoLinkLoaded(),appendToHead(style),void 0;waitForWebKitLinkLoaded()}appendToHead(link),link.href=url}}var maxLoadTime,idCount=0,loadedStates={};settings=settings||{},maxLoadTime=settings.maxLoadTime||5e3,this.load=load}}),/**
 * DOMUtils.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/dom/DOMUtils",["tinymce/dom/Sizzle","tinymce/html/Styles","tinymce/dom/EventUtils","tinymce/dom/TreeWalker","tinymce/dom/Range","tinymce/html/Entities","tinymce/Env","tinymce/util/Tools","tinymce/dom/StyleSheetLoader"],function(Sizzle,Styles,EventUtils,TreeWalker,Range,Entities,Env,Tools,StyleSheetLoader){function DOMUtils(doc,settings){var blockElementsMap,self=this;self.doc=doc,self.win=window,self.files={},self.counter=0,self.stdMode=!isIE||doc.documentMode>=8,self.boxModel=!isIE||"CSS1Compat"==doc.compatMode||self.stdMode,self.hasOuterHTML="outerHTML"in doc.createElement("a"),self.styleSheetLoader=new StyleSheetLoader(doc),this.boundEvents=[],self.settings=settings=extend({keep_values:!1,hex_colors:1},settings),self.schema=settings.schema,self.styles=new Styles({url_converter:settings.url_converter,url_converter_scope:settings.url_converter_scope},settings.schema),self.fixDoc(doc),self.events=settings.ownEvents?new EventUtils(settings.proxy):EventUtils.Event,blockElementsMap=settings.schema?settings.schema.getBlockElements():{},self.isBlock=function(node){if(!node)return!1;var type=node.nodeType;return type?!(1!==type||!blockElementsMap[node.nodeName]):!!blockElementsMap[node]}}var each=Tools.each,is=Tools.is,grep=Tools.grep,trim=Tools.trim,extend=Tools.extend,isWebKit=Env.webkit,isIE=Env.ie,simpleSelectorRe=/^([a-z0-9],?)+$/i,whiteSpaceRegExp=/^[ \t\r\n]*$/,numericCssMap=Tools.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," ");return DOMUtils.prototype={root:null,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"},fixDoc:function(doc){var name,settings=this.settings;if(isIE&&settings.schema){"abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video".replace(/\w+/g,function(name){doc.createElement(name)});for(name in settings.schema.getCustomElements())doc.createElement(name)}},clone:function(node,deep){var clone,doc,self=this;return!isIE||1!==node.nodeType||deep?node.cloneNode(deep):(doc=self.doc,deep?clone.firstChild:(clone=doc.createElement(node.nodeName),each(self.getAttribs(node),function(attr){self.setAttrib(clone,attr.nodeName,self.getAttrib(node,attr.nodeName))}),clone))},getRoot:function(){var self=this;return self.get(self.settings.root_element)||self.doc.body},getViewPort:function(win){var doc,rootElm;return win=win?win:this.win,doc=win.document,rootElm=this.boxModel?doc.documentElement:doc.body,{x:win.pageXOffset||rootElm.scrollLeft,y:win.pageYOffset||rootElm.scrollTop,w:win.innerWidth||rootElm.clientWidth,h:win.innerHeight||rootElm.clientHeight}},getRect:function(elm){var pos,size,self=this;return elm=self.get(elm),pos=self.getPos(elm),size=self.getSize(elm),{x:pos.x,y:pos.y,w:size.w,h:size.h}},getSize:function(elm){var w,h,self=this;return elm=self.get(elm),w=self.getStyle(elm,"width"),h=self.getStyle(elm,"height"),-1===w.indexOf("px")&&(w=0),-1===h.indexOf("px")&&(h=0),{w:parseInt(w,10)||elm.offsetWidth||elm.clientWidth,h:parseInt(h,10)||elm.offsetHeight||elm.clientHeight}},getParent:function(node,selector,root){return this.getParents(node,selector,root,!1)},getParents:function(node,selector,root,collect){var selectorVal,self=this,result=[];for(node=self.get(node),collect=collect===undefined,root=root||("BODY"!=self.getRoot().nodeName?self.getRoot().parentNode:null),is(selector,"string")&&(selectorVal=selector,selector="*"===selector?function(node){return 1==node.nodeType}:function(node){return self.is(node,selectorVal)});node&&node!=root&&node.nodeType&&9!==node.nodeType;){if(!selector||selector(node)){if(!collect)return node;result.push(node)}node=node.parentNode}return collect?result:null},get:function(elm){var name;return elm&&this.doc&&"string"==typeof elm&&(name=elm,elm=this.doc.getElementById(elm),elm&&elm.id!==name)?this.doc.getElementsByName(name)[1]:elm},getNext:function(node,selector){return this._findSib(node,selector,"nextSibling")},getPrev:function(node,selector){return this._findSib(node,selector,"previousSibling")},select:function(selector,scope){var self=this;return Sizzle(selector,self.get(scope)||self.get(self.settings.root_element)||self.doc,[])},is:function(elm,selector){var i;if(elm.length===undefined){if("*"===selector)return 1==elm.nodeType;if(simpleSelectorRe.test(selector)){for(selector=selector.toLowerCase().split(/,/),elm=elm.nodeName.toLowerCase(),i=selector.length-1;i>=0;i--)if(selector[i]==elm)return!0;return!1}}return elm.nodeType&&1!=elm.nodeType?!1:Sizzle.matches(selector,elm.nodeType?[elm]:elm).length>0},add:function(parentElm,name,attrs,html,create){var self=this;return this.run(parentElm,function(parentElm){var newElm;return newElm=is(name,"string")?self.doc.createElement(name):name,self.setAttribs(newElm,attrs),html&&(html.nodeType?newElm.appendChild(html):self.setHTML(newElm,html)),create?newElm:parentElm.appendChild(newElm)})},create:function(name,attrs,html){return this.add(this.doc.createElement(name),name,attrs,html,1)},createHTML:function(name,attrs,html){var key,outHtml="";outHtml+="<"+name;for(key in attrs)attrs.hasOwnProperty(key)&&null!==attrs[key]&&(outHtml+=" "+key+'="'+this.encode(attrs[key])+'"');return"undefined"!=typeof html?outHtml+">"+html+"</"+name+">":outHtml+" />"},createFragment:function(html){var frag,node,container,doc=this.doc;for(container=doc.createElement("div"),frag=doc.createDocumentFragment(),html&&(container.innerHTML=html);node=container.firstChild;)frag.appendChild(node);return frag},remove:function(node,keep_children){return this.run(node,function(node){var child,parent=node.parentNode;if(!parent)return null;if(keep_children)for(;child=node.firstChild;)!isIE||3!==child.nodeType||child.nodeValue?parent.insertBefore(child,node):node.removeChild(child);return parent.removeChild(node)})},setStyle:function(elm,name,value){return this.run(elm,function(elm){var style,key,self=this;if(name)if("string"==typeof name){style=elm.style,name=name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()}),"number"!=typeof value||numericCssMap[name]||(value+="px"),"opacity"===name&&elm.runtimeStyle&&"undefined"==typeof elm.runtimeStyle.opacity&&(style.filter=""===value?"":"alpha(opacity="+100*value+")"),"float"==name&&(name="cssFloat"in elm.style?"cssFloat":"styleFloat");try{style[name]=value}catch(ex){}self.settings.update_styles&&elm.removeAttribute("data-mce-style")}else for(key in name)self.setStyle(elm,key,name[key])})},getStyle:function(elm,name,computed){if(elm=this.get(elm)){if(this.doc.defaultView&&computed){name=name.replace(/[A-Z]/g,function(a){return"-"+a});try{return this.doc.defaultView.getComputedStyle(elm,null).getPropertyValue(name)}catch(ex){return null}}return name=name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()}),"float"==name&&(name=isIE?"styleFloat":"cssFloat"),elm.currentStyle&&computed?elm.currentStyle[name]:elm.style?elm.style[name]:undefined}},setStyles:function(elm,styles){this.setStyle(elm,styles)},css:function(elm,name,value){this.setStyle(elm,name,value)},removeAllAttribs:function(e){return this.run(e,function(e){var i,attrs=e.attributes;for(i=attrs.length-1;i>=0;i--)e.removeAttributeNode(attrs.item(i))})},setAttrib:function(e,n,v){var t=this;if(e&&n)return this.run(e,function(e){var s=t.settings,originalValue=e.getAttribute(n);if(null!==v)switch(n){case"style":if(!is(v,"string"))return each(v,function(v,n){t.setStyle(e,n,v)}),void 0;s.keep_values&&(v?e.setAttribute("data-mce-style",v,2):e.removeAttribute("data-mce-style",2)),e.style.cssText=v;break;case"class":e.className=v||"";break;case"src":case"href":s.keep_values&&(s.url_converter&&(v=s.url_converter.call(s.url_converter_scope||t,v,n,e)),t.setAttrib(e,"data-mce-"+n,v,2));break;case"shape":e.setAttribute("data-mce-style",v)}is(v)&&null!==v&&0!==v.length?e.setAttribute(n,""+v,2):e.removeAttribute(n,2),originalValue!=v&&s.onSetAttrib&&s.onSetAttrib({attrElm:e,attrName:n,attrValue:v})})},setAttribs:function(elm,attrs){var self=this;return this.run(elm,function(elm){each(attrs,function(value,name){self.setAttrib(elm,name,value)})})},getAttrib:function(elm,name,defaultVal){var value,undef,self=this;if(elm=self.get(elm),!elm||1!==elm.nodeType)return defaultVal===undef?!1:defaultVal;if(is(defaultVal)||(defaultVal=""),/^(src|href|style|coords|shape)$/.test(name)&&(value=elm.getAttribute("data-mce-"+name)))return value;if(isIE&&self.props[name]&&(value=elm[self.props[name]],value=value&&value.nodeValue?value.nodeValue:value),value||(value=elm.getAttribute(name,2)),/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(name))return elm[self.props[name]]===!0&&""===value?name:value?name:"";if("FORM"===elm.nodeName&&elm.getAttributeNode(name))return elm.getAttributeNode(name).nodeValue;if("style"===name&&(value=value||elm.style.cssText,value&&(value=self.serializeStyle(self.parseStyle(value),elm.nodeName),self.settings.keep_values&&elm.setAttribute("data-mce-style",value))),isWebKit&&"class"===name&&value&&(value=value.replace(/(apple|webkit)\-[a-z\-]+/gi,"")),isIE)switch(name){case"rowspan":case"colspan":1===value&&(value="");break;case"size":("+0"===value||20===value||0===value)&&(value="");break;case"width":case"height":case"vspace":case"checked":case"disabled":case"readonly":0===value&&(value="");break;case"hspace":-1===value&&(value="");break;case"maxlength":case"tabindex":(32768===value||2147483647===value||"32768"===value)&&(value="");break;case"multiple":case"compact":case"noshade":case"nowrap":return 65535===value?name:defaultVal;case"shape":value=value.toLowerCase();break;default:0===name.indexOf("on")&&value&&(value=(""+value).replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1"))}return value!==undef&&null!==value&&""!==value?""+value:defaultVal},getPos:function(elm,rootElm){var offsetParent,pos,self=this,x=0,y=0,doc=self.doc;if(elm=self.get(elm),rootElm=rootElm||doc.body,elm){if(rootElm===doc.body&&elm.getBoundingClientRect)return pos=elm.getBoundingClientRect(),rootElm=self.boxModel?doc.documentElement:doc.body,x=pos.left+(doc.documentElement.scrollLeft||doc.body.scrollLeft)-rootElm.clientLeft,y=pos.top+(doc.documentElement.scrollTop||doc.body.scrollTop)-rootElm.clientTop,{x:x,y:y};for(offsetParent=elm;offsetParent&&offsetParent!=rootElm&&offsetParent.nodeType;)x+=offsetParent.offsetLeft||0,y+=offsetParent.offsetTop||0,offsetParent=offsetParent.offsetParent;for(offsetParent=elm.parentNode;offsetParent&&offsetParent!=rootElm&&offsetParent.nodeType;)x-=offsetParent.scrollLeft||0,y-=offsetParent.scrollTop||0,offsetParent=offsetParent.parentNode}return{x:x,y:y}},parseStyle:function(cssText){return this.styles.parse(cssText)},serializeStyle:function(styles,name){return this.styles.serialize(styles,name)},addStyle:function(cssText){var head,styleElm,self=this,doc=self.doc;if(self!==DOMUtils.DOM&&doc===document){var addedStyles=DOMUtils.DOM.addedStyles;if(addedStyles=addedStyles||[],addedStyles[cssText])return;addedStyles[cssText]=!0,DOMUtils.DOM.addedStyles=addedStyles}styleElm=doc.getElementById("mceDefaultStyles"),styleElm||(styleElm=doc.createElement("style"),styleElm.id="mceDefaultStyles",styleElm.type="text/css",head=doc.getElementsByTagName("head")[0],head.firstChild?head.insertBefore(styleElm,head.firstChild):head.appendChild(styleElm)),styleElm.styleSheet?styleElm.styleSheet.cssText+=cssText:styleElm.appendChild(doc.createTextNode(cssText))},loadCSS:function(url){var head,self=this,doc=self.doc;return self!==DOMUtils.DOM&&doc===document?(DOMUtils.DOM.loadCSS(url),void 0):(url||(url=""),head=doc.getElementsByTagName("head")[0],each(url.split(","),function(url){var link;self.files[url]||(self.files[url]=!0,link=self.create("link",{rel:"stylesheet",href:url}),isIE&&doc.documentMode&&doc.recalc&&(link.onload=function(){doc.recalc&&doc.recalc(),link.onload=null}),head.appendChild(link))}),void 0)},addClass:function(elm,cls){return this.run(elm,function(elm){var clsVal;return cls?this.hasClass(elm,cls)?elm.className:(clsVal=this.removeClass(elm,cls),elm.className=clsVal=(""!==clsVal?clsVal+" ":"")+cls,clsVal):0})},removeClass:function(elm,cls){var re,self=this;return self.run(elm,function(elm){var val;return self.hasClass(elm,cls)?(re||(re=new RegExp("(^|\\s+)"+cls+"(\\s+|$)","g")),val=elm.className.replace(re," "),val=trim(" "!=val?val:""),elm.className=val,val||(elm.removeAttribute("class"),elm.removeAttribute("className")),val):elm.className})},hasClass:function(elm,cls){return elm=this.get(elm),elm&&cls?-1!==(" "+elm.className+" ").indexOf(" "+cls+" "):!1},toggleClass:function(elm,cls,state){state=state===undefined?!this.hasClass(elm,cls):state,this.hasClass(elm,cls)!==state&&(state?this.addClass(elm,cls):this.removeClass(elm,cls))},show:function(elm){return this.setStyle(elm,"display","block")},hide:function(elm){return this.setStyle(elm,"display","none")},isHidden:function(elm){return elm=this.get(elm),!elm||"none"==elm.style.display||"none"==this.getStyle(elm,"display")},uniqueId:function(prefix){return(prefix?prefix:"mce_")+this.counter++},setHTML:function(element,html){var self=this;return self.run(element,function(element){if(isIE){for(;element.firstChild;)element.removeChild(element.firstChild);try{element.innerHTML="<br />"+html,element.removeChild(element.firstChild)}catch(ex){var newElement=self.create("div");newElement.innerHTML="<br />"+html,each(grep(newElement.childNodes),function(node,i){i&&element.canHaveHTML&&element.appendChild(node)})}}else element.innerHTML=html;return html})},getOuterHTML:function(elm){var doc,self=this;return(elm=self.get(elm))?1===elm.nodeType&&self.hasOuterHTML?elm.outerHTML:(doc=(elm.ownerDocument||self.doc).createElement("body"),doc.appendChild(elm.cloneNode(!0)),doc.innerHTML):null},setOuterHTML:function(elm,html,doc){var self=this;return self.run(elm,function(elm){function set(){var node,tempElm;for(tempElm=doc.createElement("body"),tempElm.innerHTML=html,node=tempElm.lastChild;node;)self.insertAfter(node.cloneNode(!0),elm),node=node.previousSibling;self.remove(elm)}if(1==elm.nodeType)if(doc=doc||elm.ownerDocument||self.doc,isIE)try{1==elm.nodeType&&self.hasOuterHTML?elm.outerHTML=html:set()}catch(ex){set()}else set()})},decode:Entities.decode,encode:Entities.encodeAllRaw,insertAfter:function(node,reference_node){return reference_node=this.get(reference_node),this.run(node,function(node){var parent,nextSibling;return parent=reference_node.parentNode,nextSibling=reference_node.nextSibling,nextSibling?parent.insertBefore(node,nextSibling):parent.appendChild(node),node})},replace:function(newElm,oldElm,keepChildren){var self=this;return self.run(oldElm,function(oldElm){return is(oldElm,"array")&&(newElm=newElm.cloneNode(!0)),keepChildren&&each(grep(oldElm.childNodes),function(node){newElm.appendChild(node)}),oldElm.parentNode.replaceChild(newElm,oldElm)})},rename:function(elm,name){var newElm,self=this;return elm.nodeName!=name.toUpperCase()&&(newElm=self.create(name),each(self.getAttribs(elm),function(attr_node){self.setAttrib(newElm,attr_node.nodeName,self.getAttrib(elm,attr_node.nodeName))}),self.replace(newElm,elm,1)),newElm||elm},findCommonAncestor:function(a,b){for(var pe,ps=a;ps;){for(pe=b;pe&&ps!=pe;)pe=pe.parentNode;if(ps==pe)break;ps=ps.parentNode}return!ps&&a.ownerDocument?a.ownerDocument.documentElement:ps},toHex:function(rgbVal){return this.styles.toHex(Tools.trim(rgbVal))},run:function(elm,func,scope){var result,self=this;return"string"==typeof elm&&(elm=self.get(elm)),elm?(scope=scope||this,elm.nodeType||!elm.length&&0!==elm.length?func.call(scope,elm):(result=[],each(elm,function(elm,i){elm&&("string"==typeof elm&&(elm=self.get(elm)),result.push(func.call(scope,elm,i)))}),result)):!1},getAttribs:function(elm){var attrs;if(elm=this.get(elm),!elm)return[];if(isIE){if(attrs=[],"OBJECT"==elm.nodeName)return elm.attributes;"OPTION"===elm.nodeName&&this.getAttrib(elm,"selected")&&attrs.push({specified:1,nodeName:"selected"});var attrRegExp=/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi;return elm.cloneNode(!1).outerHTML.replace(attrRegExp,"").replace(/[\w:\-]+/gi,function(a){attrs.push({specified:1,nodeName:a})}),attrs}return elm.attributes},isEmpty:function(node,elements){var i,attributes,type,walker,name,self=this,brCount=0;if(node=node.firstChild){walker=new TreeWalker(node,node.parentNode),elements=elements||self.schema?self.schema.getNonEmptyElements():null;do{if(type=node.nodeType,1===type){if(node.getAttribute("data-mce-bogus"))continue;if(name=node.nodeName.toLowerCase(),elements&&elements[name]){if("br"===name){brCount++;continue}return!1}for(attributes=self.getAttribs(node),i=node.attributes.length;i--;)if(name=node.attributes[i].nodeName,"name"===name||"data-mce-bookmark"===name)return!1}if(8==type)return!1;if(3===type&&!whiteSpaceRegExp.test(node.nodeValue))return!1}while(node=walker.next())}return 1>=brCount},createRng:function(){var doc=this.doc;return doc.createRange?doc.createRange():new Range(this)},nodeIndex:function(node,normalized){var lastNodeType,lastNode,nodeType,idx=0;if(node)for(lastNodeType=node.nodeType,node=node.previousSibling,lastNode=node;node;node=node.previousSibling)nodeType=node.nodeType,(!normalized||3!=nodeType||nodeType!=lastNodeType&&node.nodeValue.length)&&(idx++,lastNodeType=nodeType);return idx},split:function(parentElm,splitElm,replacementElm){function trimNode(node){function surroundedBySpans(node){var previousIsSpan=node.previousSibling&&"SPAN"==node.previousSibling.nodeName,nextIsSpan=node.nextSibling&&"SPAN"==node.nextSibling.nodeName;return previousIsSpan&&nextIsSpan}var i,children=node.childNodes,type=node.nodeType;if(1!=type||"bookmark"!=node.getAttribute("data-mce-type")){for(i=children.length-1;i>=0;i--)trimNode(children[i]);if(9!=type){if(3==type&&node.nodeValue.length>0){var trimmedLength=trim(node.nodeValue).length;if(!self.isBlock(node.parentNode)||trimmedLength>0||0===trimmedLength&&surroundedBySpans(node))return}else if(1==type&&(children=node.childNodes,1==children.length&&children[0]&&1==children[0].nodeType&&"bookmark"==children[0].getAttribute("data-mce-type")&&node.parentNode.insertBefore(children[0],node),children.length||/^(br|hr|input|img)$/i.test(node.nodeName)))return;self.remove(node)}return node}}var bef,aft,pa,self=this,r=self.createRng();return parentElm&&splitElm?(r.setStart(parentElm.parentNode,self.nodeIndex(parentElm)),r.setEnd(splitElm.parentNode,self.nodeIndex(splitElm)),bef=r.extractContents(),r=self.createRng(),r.setStart(splitElm.parentNode,self.nodeIndex(splitElm)+1),r.setEnd(parentElm.parentNode,self.nodeIndex(parentElm)+1),aft=r.extractContents(),pa=parentElm.parentNode,pa.insertBefore(trimNode(bef),parentElm),replacementElm?pa.replaceChild(replacementElm,splitElm):pa.insertBefore(splitElm,parentElm),pa.insertBefore(trimNode(aft),parentElm),self.remove(parentElm),replacementElm||splitElm):void 0},bind:function(target,name,func,scope){var self=this;if(Tools.isArray(target)){for(var i=target.length;i--;)target[i]=self.bind(target[i],name,func,scope);return target}return!self.settings.collect||target!==self.doc&&target!==self.win||self.boundEvents.push([target,name,func,scope]),self.events.bind(target,name,func,scope||self)},unbind:function(target,name,func){var i,self=this;if(Tools.isArray(target)){for(i=target.length;i--;)target[i]=self.unbind(target[i],name,func);return target}if(self.boundEvents&&(target===self.doc||target===self.win))for(i=self.boundEvents.length;i--;){var item=self.boundEvents[i];target!=item[0]||name&&name!=item[1]||func&&func!=item[2]||this.events.unbind(item[0],item[1],item[2])}return this.events.unbind(target,name,func)},fire:function(target,name,evt){return this.events.fire(target,name,evt)},getContentEditable:function(node){var contentEditable;return 1!=node.nodeType?null:(contentEditable=node.getAttribute("data-mce-contenteditable"),contentEditable&&"inherit"!==contentEditable?contentEditable:"inherit"!==node.contentEditable?node.contentEditable:null)},destroy:function(){var self=this;if(self.boundEvents){for(var i=self.boundEvents.length;i--;){var item=self.boundEvents[i];this.events.unbind(item[0],item[1],item[2])}self.boundEvents=null}Sizzle.setDocument&&Sizzle.setDocument(),self.win=self.doc=self.root=self.events=self.frag=null},dumpRng:function(r){return"startContainer: "+r.startContainer.nodeName+", startOffset: "+r.startOffset+", endContainer: "+r.endContainer.nodeName+", endOffset: "+r.endOffset},_findSib:function(node,selector,name){var self=this,func=selector;if(node)for("string"==typeof func&&(func=function(node){return self.is(node,selector)}),node=node[name];node;node=node[name])if(func(node))return node;return null}},DOMUtils.DOM=new DOMUtils(document),DOMUtils}),/**
 * ScriptLoader.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/dom/ScriptLoader",["tinymce/dom/DOMUtils","tinymce/util/Tools"],function(DOMUtils,Tools){function ScriptLoader(){function loadScript(url,callback){function done(){dom.remove(id),elm&&(elm.onreadystatechange=elm.onload=elm=null),callback()}function error(){"undefined"!=typeof console&&console.log&&console.log("Failed to load: "+url)}var elm,id,dom=DOM;id=dom.uniqueId(),elm=document.createElement("script"),elm.id=id,elm.type="text/javascript",elm.src=url,"onreadystatechange"in elm?elm.onreadystatechange=function(){/loaded|complete/.test(elm.readyState)&&done()}:elm.onload=done,elm.onerror=error,(document.getElementsByTagName("head")[0]||document.body).appendChild(elm)}var undef,QUEUED=0,LOADING=1,LOADED=2,states={},queue=[],scriptLoadedCallbacks={},queueLoadedCallbacks=[],loading=0;this.isDone=function(url){return states[url]==LOADED},this.markDone=function(url){states[url]=LOADED},this.add=this.load=function(url,callback,scope){var state=states[url];state==undef&&(queue.push(url),states[url]=QUEUED),callback&&(scriptLoadedCallbacks[url]||(scriptLoadedCallbacks[url]=[]),scriptLoadedCallbacks[url].push({func:callback,scope:scope||this}))},this.loadQueue=function(callback,scope){this.loadScripts(queue,callback,scope)},this.loadScripts=function(scripts,callback,scope){function execScriptLoadedCallbacks(url){each(scriptLoadedCallbacks[url],function(callback){callback.func.call(callback.scope)}),scriptLoadedCallbacks[url]=undef}var loadScripts;queueLoadedCallbacks.push({func:callback,scope:scope||this}),loadScripts=function(){var loadingScripts=grep(scripts);scripts.length=0,each(loadingScripts,function(url){return states[url]==LOADED?(execScriptLoadedCallbacks(url),void 0):(states[url]!=LOADING&&(states[url]=LOADING,loading++,loadScript(url,function(){states[url]=LOADED,loading--,execScriptLoadedCallbacks(url),loadScripts()})),void 0)}),loading||(each(queueLoadedCallbacks,function(callback){callback.func.call(callback.scope)}),queueLoadedCallbacks.length=0)},loadScripts()}}var DOM=DOMUtils.DOM,each=Tools.each,grep=Tools.grep;return ScriptLoader.ScriptLoader=new ScriptLoader,ScriptLoader}),/**
 * AddOnManager.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/AddOnManager",["tinymce/dom/ScriptLoader","tinymce/util/Tools"],function(ScriptLoader,Tools){function AddOnManager(){var self=this;self.items=[],self.urls={},self.lookup={}}var each=Tools.each;return AddOnManager.prototype={get:function(name){return this.lookup[name]?this.lookup[name].instance:undefined},dependencies:function(name){var result;return this.lookup[name]&&(result=this.lookup[name].dependencies),result||[]},requireLangPack:function(name,languages){if(AddOnManager.language&&AddOnManager.languageLoad!==!1){if(languages&&new RegExp("([, ]|\\b)"+AddOnManager.language+"([, ]|\\b)").test(languages)===!1)return;ScriptLoader.ScriptLoader.add(this.urls[name]+"/langs/"+AddOnManager.language+".js")}},add:function(id,addOn,dependencies){return this.items.push(addOn),this.lookup[id]={instance:addOn,dependencies:dependencies},addOn},createUrl:function(baseUrl,dep){return"object"==typeof dep?dep:{prefix:baseUrl.prefix,resource:dep,suffix:baseUrl.suffix}},addComponents:function(pluginName,scripts){var pluginUrl=this.urls[pluginName];each(scripts,function(script){ScriptLoader.ScriptLoader.add(pluginUrl+"/"+script)})},load:function(n,u,cb,s){function loadDependencies(){var dependencies=t.dependencies(n);each(dependencies,function(dep){var newUrl=t.createUrl(u,dep);t.load(newUrl.resource,newUrl,undefined,undefined)}),cb&&(s?cb.call(s):cb.call(ScriptLoader))}var t=this,url=u;t.urls[n]||("object"==typeof u&&(url=u.prefix+u.resource+u.suffix),0!==url.indexOf("/")&&-1==url.indexOf("://")&&(url=AddOnManager.baseURL+"/"+url),t.urls[n]=url.substring(0,url.lastIndexOf("/")),t.lookup[n]?loadDependencies():ScriptLoader.ScriptLoader.add(url,loadDependencies,s))}},AddOnManager.PluginManager=new AddOnManager,AddOnManager.ThemeManager=new AddOnManager,AddOnManager}),/**
 * Node.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/html/Node",[],function(){function walk(node,root_node,prev){var sibling,parent,startName=prev?"lastChild":"firstChild",siblingName=prev?"prev":"next";if(node[startName])return node[startName];if(node!==root_node){if(sibling=node[siblingName])return sibling;for(parent=node.parent;parent&&parent!==root_node;parent=parent.parent)if(sibling=parent[siblingName])return sibling}}function Node(name,type){this.name=name,this.type=type,1===type&&(this.attributes=[],this.attributes.map={})}var whiteSpaceRegExp=/^[ \t\r\n]*$/,typeLookup={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};return Node.prototype={replace:function(node){var self=this;return node.parent&&node.remove(),self.insert(node,self),self.remove(),self},attr:function(name,value){var attrs,i,undef,self=this;if("string"!=typeof name){for(i in name)self.attr(i,name[i]);return self}if(attrs=self.attributes){if(value!==undef){if(null===value){if(name in attrs.map)for(delete attrs.map[name],i=attrs.length;i--;)if(attrs[i].name===name)return attrs=attrs.splice(i,1),self;return self}if(name in attrs.map){for(i=attrs.length;i--;)if(attrs[i].name===name){attrs[i].value=value;break}}else attrs.push({name:name,value:value});return attrs.map[name]=value,self}return attrs.map[name]}},clone:function(){var i,l,selfAttrs,selfAttr,cloneAttrs,self=this,clone=new Node(self.name,self.type);if(selfAttrs=self.attributes){for(cloneAttrs=[],cloneAttrs.map={},i=0,l=selfAttrs.length;l>i;i++)selfAttr=selfAttrs[i],"id"!==selfAttr.name&&(cloneAttrs[cloneAttrs.length]={name:selfAttr.name,value:selfAttr.value},cloneAttrs.map[selfAttr.name]=selfAttr.value);clone.attributes=cloneAttrs}return clone.value=self.value,clone.shortEnded=self.shortEnded,clone},wrap:function(wrapper){var self=this;return self.parent.insert(wrapper,self),wrapper.append(self),self},unwrap:function(){var node,next,self=this;for(node=self.firstChild;node;)next=node.next,self.insert(node,self,!0),node=next;self.remove()},remove:function(){var self=this,parent=self.parent,next=self.next,prev=self.prev;return parent&&(parent.firstChild===self?(parent.firstChild=next,next&&(next.prev=null)):prev.next=next,parent.lastChild===self?(parent.lastChild=prev,prev&&(prev.next=null)):next.prev=prev,self.parent=self.next=self.prev=null),self},append:function(node){var last,self=this;return node.parent&&node.remove(),last=self.lastChild,last?(last.next=node,node.prev=last,self.lastChild=node):self.lastChild=self.firstChild=node,node.parent=self,node},insert:function(node,ref_node,before){var parent;return node.parent&&node.remove(),parent=ref_node.parent||this,before?(ref_node===parent.firstChild?parent.firstChild=node:ref_node.prev.next=node,node.prev=ref_node.prev,node.next=ref_node,ref_node.prev=node):(ref_node===parent.lastChild?parent.lastChild=node:ref_node.next.prev=node,node.next=ref_node.next,node.prev=ref_node,ref_node.next=node),node.parent=parent,node},getAll:function(name){var node,self=this,collection=[];for(node=self.firstChild;node;node=walk(node,self))node.name===name&&collection.push(node);return collection},empty:function(){var nodes,i,node,self=this;if(self.firstChild){for(nodes=[],node=self.firstChild;node;node=walk(node,self))nodes.push(node);for(i=nodes.length;i--;)node=nodes[i],node.parent=node.firstChild=node.lastChild=node.next=node.prev=null}return self.firstChild=self.lastChild=null,self},isEmpty:function(elements){var i,name,self=this,node=self.firstChild;if(node)do{if(1===node.type){if(node.attributes.map["data-mce-bogus"])continue;if(elements[node.name])return!1;for(i=node.attributes.length;i--;)if(name=node.attributes[i].name,"name"===name||0===name.indexOf("data-mce-"))return!1}if(8===node.type)return!1;if(3===node.type&&!whiteSpaceRegExp.test(node.value))return!1}while(node=walk(node,self));return!0},walk:function(prev){return walk(this,null,prev)}},Node.create=function(name,attrs){var node,attrName;if(node=new Node(name,typeLookup[name]||1),attrs)for(attrName in attrs)node.attr(attrName,attrs[attrName]);return node},Node}),/**
 * Schema.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/html/Schema",["tinymce/util/Tools"],function(Tools){function split(items,delim){return items?items.split(delim||" "):[]}function compileSchema(type){function add(name,attributes,children){function arrayToMap(array){var i,l,map={};for(i=0,l=array.length;l>i;i++)map[array[i]]={};return map}var ni,i,attributesOrder,args=arguments;for(children=children||[],attributes=attributes||"","string"==typeof children&&(children=split(children)),i=3;i<args.length;i++)"string"==typeof args[i]&&(args[i]=split(args[i])),children.push.apply(children,args[i]);for(name=split(name),ni=name.length;ni--;)attributesOrder=[].concat(globalAttributes,split(attributes)),schema[name[ni]]={attributes:arrayToMap(attributesOrder),attributesOrder:attributesOrder,children:arrayToMap(children)}}function addAttrs(name,attributes){var ni,schemaItem,i,l;for(name=split(name),ni=name.length,attributes=split(attributes);ni--;)for(schemaItem=schema[name[ni]],i=0,l=attributes.length;l>i;i++)schemaItem.attributes[attributes[i]]={},schemaItem.attributesOrder.push(attributes[i])}var globalAttributes,eventAttributes,blockContent,phrasingContent,flowContent,html4BlockContent,html4PhrasingContent,schema={};return mapCache[type]?mapCache[type]:(globalAttributes=split("id accesskey class dir lang style tabindex title"),eventAttributes=split("onabort onblur oncancel oncanplay oncanplaythrough onchange onclick onclose oncontextmenu oncuechange ondblclick ondrag ondragend ondragenter ondragleave ondragover ondragstart ondrop ondurationchange onemptied onended onerror onfocus oninput oninvalid onkeydown onkeypress onkeyup onload onloadeddata onloadedmetadata onloadstart onmousedown onmousemove onmouseout onmouseover onmouseup onmousewheel onpause onplay onplaying onprogress onratechange onreset onscroll onseeked onseeking onseeking onselect onshow onstalled onsubmit onsuspend ontimeupdate onvolumechange onwaiting"),blockContent=split("address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul"),phrasingContent=split("a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment"),"html4"!=type&&(globalAttributes.push.apply(globalAttributes,split("contenteditable contextmenu draggable dropzone hidden spellcheck translate")),blockContent.push.apply(blockContent,split("article aside details dialog figure header footer hgroup section nav")),phrasingContent.push.apply(phrasingContent,split("audio canvas command datalist mark meter output progress time wbr video ruby bdi keygen"))),"html5-strict"!=type&&(globalAttributes.push("xml:lang"),html4PhrasingContent=split("acronym applet basefont big font strike tt"),phrasingContent.push.apply(phrasingContent,html4PhrasingContent),each(html4PhrasingContent,function(name){add(name,"",phrasingContent)}),html4BlockContent=split("center dir isindex noframes"),blockContent.push.apply(blockContent,html4BlockContent),flowContent=[].concat(blockContent,phrasingContent),each(html4BlockContent,function(name){add(name,"",flowContent)})),flowContent=flowContent||[].concat(blockContent,phrasingContent),add("html","manifest","head body"),add("head","","base command link meta noscript script style title"),add("title hr noscript br"),add("base","href target"),add("link","href rel media hreflang type sizes hreflang"),add("meta","name http-equiv content charset"),add("style","media type scoped"),add("script","src async defer type charset"),add("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",flowContent),add("address dt dd div caption","",flowContent),add("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",phrasingContent),add("blockquote","cite",flowContent),add("ol","reversed start type","li"),add("ul","","li"),add("li","value",flowContent),add("dl","","dt dd"),add("a","href target rel media hreflang type",phrasingContent),add("q","cite",phrasingContent),add("ins del","cite datetime",flowContent),add("img","src alt usemap ismap width height"),add("iframe","src name width height",flowContent),add("embed","src type width height"),add("object","data type typemustmatch name usemap form width height",flowContent,"param"),add("param","name value"),add("map","name",flowContent,"area"),add("area","alt coords shape href target rel media hreflang type"),add("table","border","caption colgroup thead tfoot tbody tr"+("html4"==type?" col":"")),add("colgroup","span","col"),add("col","span"),add("tbody thead tfoot","","tr"),add("tr","","td th"),add("td","colspan rowspan headers",flowContent),add("th","colspan rowspan headers scope abbr",flowContent),add("form","accept-charset action autocomplete enctype method name novalidate target",flowContent),add("fieldset","disabled form name",flowContent,"legend"),add("label","form for",phrasingContent),add("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),add("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"==type?flowContent:phrasingContent),add("select","disabled form multiple name required size","option optgroup"),add("optgroup","disabled label","option"),add("option","disabled label selected value"),add("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),add("menu","type label",flowContent,"li"),add("noscript","",flowContent),"html4"!=type&&(add("wbr"),add("ruby","",phrasingContent,"rt rp"),add("figcaption","",flowContent),add("mark rt rp summary bdi","",phrasingContent),add("canvas","width height",flowContent),add("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height",flowContent,"track source"),add("audio","src crossorigin preload autoplay mediagroup loop muted controls",flowContent,"track source"),add("source","src type media"),add("track","kind src srclang label default"),add("datalist","",phrasingContent,"option"),add("article section nav aside header footer","",flowContent),add("hgroup","","h1 h2 h3 h4 h5 h6"),add("figure","",flowContent,"figcaption"),add("time","datetime",phrasingContent),add("dialog","open",flowContent),add("command","type label icon disabled checked radiogroup command"),add("output","for form name",phrasingContent),add("progress","value max",phrasingContent),add("meter","value min max low high optimum",phrasingContent),add("details","open",flowContent,"summary"),add("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!=type&&(addAttrs("script","language xml:space"),addAttrs("style","xml:space"),addAttrs("object","declare classid codebase codetype archive standby align border hspace vspace"),addAttrs("param","valuetype type"),addAttrs("a","charset name rev shape coords"),addAttrs("br","clear"),addAttrs("applet","codebase archive code object alt name width height align hspace vspace"),addAttrs("img","name longdesc align border hspace vspace"),addAttrs("iframe","longdesc frameborder marginwidth marginheight scrolling align"),addAttrs("font basefont","size color face"),addAttrs("input","usemap align"),addAttrs("select","onchange"),addAttrs("textarea"),addAttrs("h1 h2 h3 h4 h5 h6 div p legend caption","align"),addAttrs("ul","type compact"),addAttrs("li","type"),addAttrs("ol dl menu dir","compact"),addAttrs("pre","width xml:space"),addAttrs("hr","align noshade size width"),addAttrs("isindex","prompt"),addAttrs("table","summary width frame rules cellspacing cellpadding align bgcolor"),addAttrs("col","width align char charoff valign"),addAttrs("colgroup","width align char charoff valign"),addAttrs("thead","align char charoff valign"),addAttrs("tr","align char charoff valign bgcolor"),addAttrs("th","axis align char charoff valign nowrap bgcolor width height"),addAttrs("form","accept"),addAttrs("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),addAttrs("tfoot","align char charoff valign"),addAttrs("tbody","align char charoff valign"),addAttrs("area","nohref"),addAttrs("body","background bgcolor text link vlink alink")),"html4"!=type&&(addAttrs("input button select textarea","autofocus"),addAttrs("input textarea","placeholder"),addAttrs("a","download"),addAttrs("link script img","crossorigin"),addAttrs("iframe","srcdoc sandbox seamless allowfullscreen")),each(split("a form meter progress dfn"),function(name){schema[name]&&delete schema[name].children[name]}),delete schema.caption.children.table,mapCache[type]=schema,schema)}var mapCache={},makeMap=Tools.makeMap,each=Tools.each,extend=Tools.extend,explode=Tools.explode,inArray=Tools.inArray;return function(settings){function createLookupTable(option,default_value,extendWith){var value=settings[option];return value?value=makeMap(value,",",makeMap(value.toUpperCase()," ")):(value=mapCache[option],value||(value=makeMap(default_value," ",makeMap(default_value.toUpperCase()," ")),value=extend(value,extendWith),mapCache[option]=value)),value}function patternToRegExp(str){return new RegExp("^"+str.replace(/([?+*])/g,".$1")+"$")}function addValidElements(valid_elements){var ei,el,ai,al,matches,element,attr,attrData,elementName,attrName,attrType,attributes,attributesOrder,prefix,outputName,globalAttributes,globalAttributesOrder,key,value,elementRuleRegExp=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,attrRuleRegExp=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,hasPatternsRegExp=/[*?+]/;if(valid_elements)for(valid_elements=split(valid_elements,","),elements["@"]&&(globalAttributes=elements["@"].attributes,globalAttributesOrder=elements["@"].attributesOrder),ei=0,el=valid_elements.length;el>ei;ei++)if(matches=elementRuleRegExp.exec(valid_elements[ei])){if(prefix=matches[1],elementName=matches[2],outputName=matches[3],attrData=matches[5],attributes={},attributesOrder=[],element={attributes:attributes,attributesOrder:attributesOrder},"#"===prefix&&(element.paddEmpty=!0),"-"===prefix&&(element.removeEmpty=!0),"!"===matches[4]&&(element.removeEmptyAttrs=!0),globalAttributes){for(key in globalAttributes)attributes[key]=globalAttributes[key];attributesOrder.push.apply(attributesOrder,globalAttributesOrder)}if(attrData)for(attrData=split(attrData,"|"),ai=0,al=attrData.length;al>ai;ai++)if(matches=attrRuleRegExp.exec(attrData[ai])){if(attr={},attrType=matches[1],attrName=matches[2].replace(/::/g,":"),prefix=matches[3],value=matches[4],"!"===attrType&&(element.attributesRequired=element.attributesRequired||[],element.attributesRequired.push(attrName),attr.required=!0),"-"===attrType){delete attributes[attrName],attributesOrder.splice(inArray(attributesOrder,attrName),1);continue}prefix&&("="===prefix&&(element.attributesDefault=element.attributesDefault||[],element.attributesDefault.push({name:attrName,value:value}),attr.defaultValue=value),":"===prefix&&(element.attributesForced=element.attributesForced||[],element.attributesForced.push({name:attrName,value:value}),attr.forcedValue=value),"<"===prefix&&(attr.validValues=makeMap(value,"?"))),hasPatternsRegExp.test(attrName)?(element.attributePatterns=element.attributePatterns||[],attr.pattern=patternToRegExp(attrName),element.attributePatterns.push(attr)):(attributes[attrName]||attributesOrder.push(attrName),attributes[attrName]=attr)}globalAttributes||"@"!=elementName||(globalAttributes=attributes,globalAttributesOrder=attributesOrder),outputName&&(element.outputName=elementName,elements[outputName]=element),hasPatternsRegExp.test(elementName)?(element.pattern=patternToRegExp(elementName),patternElements.push(element)):elements[elementName]=element}}function setValidElements(valid_elements){elements={},patternElements=[],addValidElements(valid_elements),each(schemaItems,function(element,name){children[name]=element.children})}function addCustomElements(custom_elements){var customElementRegExp=/^(~)?(.+)$/;custom_elements&&each(split(custom_elements,","),function(rule){var matches=customElementRegExp.exec(rule),inline="~"===matches[1],cloneName=inline?"span":"div",name=matches[2];if(children[name]=children[cloneName],customElementsMap[name]=cloneName,inline||(blockElementsMap[name.toUpperCase()]={},blockElementsMap[name]={}),!elements[name]){var customRule=elements[cloneName];customRule=extend({},customRule),delete customRule.removeEmptyAttrs,delete customRule.removeEmpty,elements[name]=customRule}each(children,function(element){element[cloneName]&&(element[name]=element[cloneName])})})}function addValidChildren(valid_children){var childRuleRegExp=/^([+\-]?)(\w+)\[([^\]]+)\]$/;valid_children&&each(split(valid_children,","),function(rule){var parent,prefix,matches=childRuleRegExp.exec(rule);matches&&(prefix=matches[1],parent=prefix?children[matches[2]]:children[matches[2]]={"#comment":{}},parent=children[matches[2]],each(split(matches[3],"|"),function(child){"-"===prefix?delete parent[child]:parent[child]={}}))})}function getElementRule(name){var i,element=elements[name];if(element)return element;for(i=patternElements.length;i--;)if(element=patternElements[i],element.pattern.test(name))return element}var validStyles,schemaItems,whiteSpaceElementsMap,selfClosingElementsMap,shortEndedElementsMap,boolAttrMap,blockElementsMap,nonEmptyElementsMap,textBlockElementsMap,self=this,elements={},children={},patternElements=[],customElementsMap={},specialElements={};settings=settings||{},schemaItems=compileSchema(settings.schema),settings.verify_html===!1&&(settings.valid_elements="*[*]"),settings.valid_styles&&(validStyles={},each(settings.valid_styles,function(value,key){validStyles[key]=explode(value)})),whiteSpaceElementsMap=createLookupTable("whitespace_elements","pre script noscript style textarea video audio iframe object"),selfClosingElementsMap=createLookupTable("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),shortEndedElementsMap=createLookupTable("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),boolAttrMap=createLookupTable("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),nonEmptyElementsMap=createLookupTable("non_empty_elements","td th iframe video audio object script",shortEndedElementsMap),textBlockElementsMap=createLookupTable("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside nav figure"),blockElementsMap=createLookupTable("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup",textBlockElementsMap),each((settings.special||"script noscript style textarea").split(" "),function(name){specialElements[name]=new RegExp("</"+name+"[^>]*>","gi")}),settings.valid_elements?setValidElements(settings.valid_elements):(each(schemaItems,function(element,name){elements[name]={attributes:element.attributes,attributesOrder:element.attributesOrder},children[name]=element.children}),"html5"!=settings.schema&&each(split("strong/b em/i"),function(item){item=split(item,"/"),elements[item[1]].outputName=item[0]}),elements.img.attributesDefault=[{name:"alt",value:""}],each(split("ol ul sub sup blockquote span font a table tbody tr strong em b i"),function(name){elements[name]&&(elements[name].removeEmpty=!0)}),each(split("p h1 h2 h3 h4 h5 h6 th td pre div address caption"),function(name){elements[name].paddEmpty=!0}),each(split("span"),function(name){elements[name].removeEmptyAttrs=!0})),addCustomElements(settings.custom_elements),addValidChildren(settings.valid_children),addValidElements(settings.extended_valid_elements),addValidChildren("+ol[ul|ol],+ul[ul|ol]"),settings.invalid_elements&&each(explode(settings.invalid_elements),function(item){elements[item]&&delete elements[item]}),getElementRule("span")||addValidElements("span[!data-mce-type|*]"),self.children=children,self.styles=validStyles,self.getBoolAttrs=function(){return boolAttrMap},self.getBlockElements=function(){return blockElementsMap},self.getTextBlockElements=function(){return textBlockElementsMap},self.getShortEndedElements=function(){return shortEndedElementsMap},self.getSelfClosingElements=function(){return selfClosingElementsMap},self.getNonEmptyElements=function(){return nonEmptyElementsMap},self.getWhiteSpaceElements=function(){return whiteSpaceElementsMap},self.getSpecialElements=function(){return specialElements},self.isValidChild=function(name,child){var parent=children[name];return!(!parent||!parent[child])},self.isValid=function(name,attr){var attrPatterns,i,rule=getElementRule(name);if(rule){if(!attr)return!0;if(rule.attributes[attr])return!0;if(attrPatterns=rule.attributePatterns)for(i=attrPatterns.length;i--;)if(attrPatterns[i].pattern.test(name))return!0}return!1},self.getElementRule=getElementRule,self.getCustomElements=function(){return customElementsMap},self.addValidElements=addValidElements,self.setValidElements=setValidElements,self.addCustomElements=addCustomElements,self.addValidChildren=addValidChildren,self.elements=elements}}),/**
 * SaxParser.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/html/SaxParser",["tinymce/html/Schema","tinymce/html/Entities","tinymce/util/Tools"],function(Schema,Entities,Tools){var each=Tools.each;return function(settings,schema){var self=this,noop=function(){};settings=settings||{},self.schema=schema=schema||new Schema,settings.fix_self_closing!==!1&&(settings.fix_self_closing=!0),each("comment cdata text start end pi doctype".split(" "),function(name){name&&(self[name]=settings[name]||noop)}),self.parse=function(html){function processEndTag(name){var pos,i;for(pos=stack.length;pos--&&stack[pos].name!==name;);if(pos>=0){for(i=stack.length-1;i>=pos;i--)name=stack[i],name.valid&&self.end(name.name);stack.length=pos}}function parseAttribute(match,name,value,val2,val3){var attrRule,i,trimRegExp=/[\s\u0000-\u001F]+/g;if(name=name.toLowerCase(),value=name in fillAttrsMap?name:decode(value||val2||val3||""),validate&&!isInternalElement&&0!==name.indexOf("data-")){if(attrRule=validAttributesMap[name],!attrRule&&validAttributePatterns){for(i=validAttributePatterns.length;i--&&(attrRule=validAttributePatterns[i],!attrRule.pattern.test(name)););-1===i&&(attrRule=null)}if(!attrRule)return;if(attrRule.validValues&&!(value in attrRule.validValues))return}if(filteredUrlAttrs[name]&&!settings.allow_script_urls){var uri=value.replace(trimRegExp,"");try{if(uri=decodeURIComponent(uri),scriptUriRegExp.test(uri))return}catch(ex){if(uri=unescape(uri),scriptUriRegExp.test(uri))return}}attrList.map[name]=value,attrList.push({name:name,value:value})}var matches,value,endRegExp,attrList,i,text,name,isInternalElement,removeInternalElements,shortEndedElements,fillAttrsMap,isShortEnded,validate,elementRule,isValidElement,attr,attribsValue,validAttributesMap,validAttributePatterns,attributesRequired,attributesDefault,attributesForced,anyAttributesRequired,selfClosing,tokenRegExp,attrRegExp,specialElements,attrValue,fixSelfClosing,self=this,index=0,stack=[],idCount=0,decode=Entities.decode,filteredUrlAttrs=Tools.makeMap("src,href"),scriptUriRegExp=/(java|vb)script:/i;for(tokenRegExp=new RegExp("<(?:(?:!--([\\w\\W]*?)-->)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([A-Za-z0-9\\-\\:\\.]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),attrRegExp=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,shortEndedElements=schema.getShortEndedElements(),selfClosing=settings.self_closing_elements||schema.getSelfClosingElements(),fillAttrsMap=schema.getBoolAttrs(),validate=settings.validate,removeInternalElements=settings.remove_internals,fixSelfClosing=settings.fix_self_closing,specialElements=schema.getSpecialElements();matches=tokenRegExp.exec(html);){if(index<matches.index&&self.text(decode(html.substr(index,matches.index-index))),value=matches[6])value=value.toLowerCase(),":"===value.charAt(0)&&(value=value.substr(1)),processEndTag(value);else if(value=matches[7]){if(value=value.toLowerCase(),":"===value.charAt(0)&&(value=value.substr(1)),isShortEnded=value in shortEndedElements,fixSelfClosing&&selfClosing[value]&&stack.length>0&&stack[stack.length-1].name===value&&processEndTag(value),!validate||(elementRule=schema.getElementRule(value))){if(isValidElement=!0,validate&&(validAttributesMap=elementRule.attributes,validAttributePatterns=elementRule.attributePatterns),(attribsValue=matches[8])?(isInternalElement=-1!==attribsValue.indexOf("data-mce-type"),isInternalElement&&removeInternalElements&&(isValidElement=!1),attrList=[],attrList.map={},attribsValue.replace(attrRegExp,parseAttribute)):(attrList=[],attrList.map={}),validate&&!isInternalElement){if(attributesRequired=elementRule.attributesRequired,attributesDefault=elementRule.attributesDefault,attributesForced=elementRule.attributesForced,anyAttributesRequired=elementRule.removeEmptyAttrs,anyAttributesRequired&&!attrList.length&&(isValidElement=!1),attributesForced)for(i=attributesForced.length;i--;)attr=attributesForced[i],name=attr.name,attrValue=attr.value,"{$uid}"===attrValue&&(attrValue="mce_"+idCount++),attrList.map[name]=attrValue,attrList.push({name:name,value:attrValue});if(attributesDefault)for(i=attributesDefault.length;i--;)attr=attributesDefault[i],name=attr.name,name in attrList.map||(attrValue=attr.value,"{$uid}"===attrValue&&(attrValue="mce_"+idCount++),attrList.map[name]=attrValue,attrList.push({name:name,value:attrValue}));if(attributesRequired){for(i=attributesRequired.length;i--&&!(attributesRequired[i]in attrList.map););-1===i&&(isValidElement=!1)}attrList.map["data-mce-bogus"]&&(isValidElement=!1)}isValidElement&&self.start(value,attrList,isShortEnded)}else isValidElement=!1;if(endRegExp=specialElements[value]){endRegExp.lastIndex=index=matches.index+matches[0].length,(matches=endRegExp.exec(html))?(isValidElement&&(text=html.substr(index,matches.index-index)),index=matches.index+matches[0].length):(text=html.substr(index),index=html.length),isValidElement&&(text.length>0&&self.text(text,!0),self.end(value)),tokenRegExp.lastIndex=index;continue}isShortEnded||(attribsValue&&attribsValue.indexOf("/")==attribsValue.length-1?isValidElement&&self.end(value):stack.push({name:value,valid:isValidElement}))}else(value=matches[1])?(">"===value.charAt(0)&&(value=" "+value),settings.allow_conditional_comments||"[if"!==value.substr(0,3)||(value=" "+value),self.comment(value)):(value=matches[2])?self.cdata(value):(value=matches[3])?self.doctype(value):(value=matches[4])&&self.pi(value,matches[5]);index=matches.index+matches[0].length}for(index<html.length&&self.text(decode(html.substr(index))),i=stack.length-1;i>=0;i--)value=stack[i],value.valid&&self.end(value.name)}}}),/**
 * DomParser.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/html/DomParser",["tinymce/html/Node","tinymce/html/Schema","tinymce/html/SaxParser","tinymce/util/Tools"],function(Node,Schema,SaxParser,Tools){var makeMap=Tools.makeMap,each=Tools.each,explode=Tools.explode,extend=Tools.extend;return function(settings,schema){function fixInvalidChildren(nodes){var ni,node,parent,parents,newParent,currentNode,tempNode,childNode,i,nonEmptyElements,nonSplitableElements,textBlockElements,sibling,nextNode;for(nonSplitableElements=makeMap("tr,td,th,tbody,thead,tfoot,table"),nonEmptyElements=schema.getNonEmptyElements(),textBlockElements=schema.getTextBlockElements(),ni=0;ni<nodes.length;ni++)if(node=nodes[ni],node.parent&&!node.fixed)if(textBlockElements[node.name]&&"li"==node.parent.name){for(sibling=node.next;sibling&&textBlockElements[sibling.name];)sibling.name="li",sibling.fixed=!0,node.parent.insert(sibling,node.parent),sibling=sibling.next;node.unwrap(node)}else{for(parents=[node],parent=node.parent;parent&&!schema.isValidChild(parent.name,node.name)&&!nonSplitableElements[parent.name];parent=parent.parent)parents.push(parent);if(parent&&parents.length>1){for(parents.reverse(),newParent=currentNode=self.filterNode(parents[0].clone()),i=0;i<parents.length-1;i++){for(schema.isValidChild(currentNode.name,parents[i].name)?(tempNode=self.filterNode(parents[i].clone()),currentNode.append(tempNode)):tempNode=currentNode,childNode=parents[i].firstChild;childNode&&childNode!=parents[i+1];)nextNode=childNode.next,tempNode.append(childNode),childNode=nextNode;currentNode=tempNode}newParent.isEmpty(nonEmptyElements)?parent.insert(node,parents[0],!0):(parent.insert(newParent,parents[0],!0),parent.insert(node,newParent)),parent=parents[0],(parent.isEmpty(nonEmptyElements)||parent.firstChild===parent.lastChild&&"br"===parent.firstChild.name)&&parent.empty().remove()}else if(node.parent){if("li"===node.name){if(sibling=node.prev,sibling&&("ul"===sibling.name||"ul"===sibling.name)){sibling.append(node);continue}if(sibling=node.next,sibling&&("ul"===sibling.name||"ul"===sibling.name)){sibling.insert(node,sibling.firstChild,!0);continue}node.wrap(self.filterNode(new Node("ul",1)));continue}schema.isValidChild(node.parent.name,"div")&&schema.isValidChild("div",node.name)?node.wrap(self.filterNode(new Node("div",1))):"style"===node.name||"script"===node.name?node.empty().remove():node.unwrap()}}}var self=this,nodeFilters={},attributeFilters=[],matchedNodes={},matchedAttributes={};settings=settings||{},settings.validate="validate"in settings?settings.validate:!0,settings.root_name=settings.root_name||"body",self.schema=schema=schema||new Schema,self.filterNode=function(node){var i,name,list;name in nodeFilters&&(list=matchedNodes[name],list?list.push(node):matchedNodes[name]=[node]),i=attributeFilters.length;for(;i--;)name=attributeFilters[i].name,name in node.attributes.map&&(list=matchedAttributes[name],list?list.push(node):matchedAttributes[name]=[node]);return node},self.addNodeFilter=function(name,callback){each(explode(name),function(name){var list=nodeFilters[name];list||(nodeFilters[name]=list=[]),list.push(callback)})},self.addAttributeFilter=function(name,callback){each(explode(name),function(name){var i;for(i=0;i<attributeFilters.length;i++)if(attributeFilters[i].name===name)return attributeFilters[i].callbacks.push(callback),void 0;attributeFilters.push({name:name,callbacks:[callback]})})},self.parse=function(html,args){function addRootBlocks(){function trim(rootBlockNode){rootBlockNode&&(node=rootBlockNode.firstChild,node&&3==node.type&&(node.value=node.value.replace(startWhiteSpaceRegExp,"")),node=rootBlockNode.lastChild,node&&3==node.type&&(node.value=node.value.replace(endWhiteSpaceRegExp,"")))}var next,rootBlockNode,node=rootNode.firstChild;if(schema.isValidChild(rootNode.name,rootBlockName.toLowerCase())){for(;node;)next=node.next,3==node.type||1==node.type&&"p"!==node.name&&!blockElements[node.name]&&!node.attr("data-mce-type")?rootBlockNode?rootBlockNode.append(node):(rootBlockNode=createNode(rootBlockName,1),rootBlockNode.attr(settings.forced_root_block_attrs),rootNode.insert(rootBlockNode,node),rootBlockNode.append(node)):(trim(rootBlockNode),rootBlockNode=null),node=next;trim(rootBlockNode)}}function createNode(name,type){var list,node=new Node(name,type);return name in nodeFilters&&(list=matchedNodes[name],list?list.push(node):matchedNodes[name]=[node]),node}function removeWhitespaceBefore(node){var textNode,textVal,sibling;for(textNode=node.prev;textNode&&3===textNode.type;)textVal=textNode.value.replace(endWhiteSpaceRegExp,""),textVal.length>0?(textNode.value=textVal,textNode=textNode.prev):(sibling=textNode.prev,textNode.remove(),textNode=sibling)}function cloneAndExcludeBlocks(input){var name,output={};for(name in input)"li"!==name&&"p"!=name&&(output[name]=input[name]);return output}var parser,rootNode,node,nodes,i,l,fi,fl,list,name,validate,blockElements,startWhiteSpaceRegExp,isInWhiteSpacePreservedElement,endWhiteSpaceRegExp,allWhiteSpaceRegExp,isAllWhiteSpaceRegExp,whiteSpaceElements,children,nonEmptyElements,rootBlockName,invalidChildren=[];if(args=args||{},matchedNodes={},matchedAttributes={},blockElements=extend(makeMap("script,style,head,html,body,title,meta,param"),schema.getBlockElements()),nonEmptyElements=schema.getNonEmptyElements(),children=schema.children,validate=settings.validate,rootBlockName="forced_root_block"in args?args.forced_root_block:settings.forced_root_block,whiteSpaceElements=schema.getWhiteSpaceElements(),startWhiteSpaceRegExp=/^[ \t\r\n]+/,endWhiteSpaceRegExp=/[ \t\r\n]+$/,allWhiteSpaceRegExp=/[ \t\r\n]+/g,isAllWhiteSpaceRegExp=/^[ \t\r\n]+$/,parser=new SaxParser({validate:validate,allow_script_urls:settings.allow_script_urls,allow_conditional_comments:settings.allow_conditional_comments,self_closing_elements:cloneAndExcludeBlocks(schema.getSelfClosingElements()),cdata:function(text){node.append(createNode("#cdata",4)).value=text},text:function(text,raw){var textNode;isInWhiteSpacePreservedElement||(text=text.replace(allWhiteSpaceRegExp," "),node.lastChild&&blockElements[node.lastChild.name]&&(text=text.replace(startWhiteSpaceRegExp,""))),0!==text.length&&(textNode=createNode("#text",3),textNode.raw=!!raw,node.append(textNode).value=text)},comment:function(text){node.append(createNode("#comment",8)).value=text},pi:function(name,text){node.append(createNode(name,7)).value=text,removeWhitespaceBefore(node)},doctype:function(text){var newNode;newNode=node.append(createNode("#doctype",10)),newNode.value=text,removeWhitespaceBefore(node)},start:function(name,attrs,empty){var newNode,attrFiltersLen,elementRule,attrName,parent;if(elementRule=validate?schema.getElementRule(name):{}){for(newNode=createNode(elementRule.outputName||name,1),newNode.attributes=attrs,newNode.shortEnded=empty,node.append(newNode),parent=children[node.name],parent&&children[newNode.name]&&!parent[newNode.name]&&invalidChildren.push(newNode),attrFiltersLen=attributeFilters.length;attrFiltersLen--;)attrName=attributeFilters[attrFiltersLen].name,attrName in attrs.map&&(list=matchedAttributes[attrName],list?list.push(newNode):matchedAttributes[attrName]=[newNode]);blockElements[name]&&removeWhitespaceBefore(newNode),empty||(node=newNode),!isInWhiteSpacePreservedElement&&whiteSpaceElements[name]&&(isInWhiteSpacePreservedElement=!0)}},end:function(name){var textNode,elementRule,text,sibling,tempNode;if(elementRule=validate?schema.getElementRule(name):{}){if(blockElements[name]&&!isInWhiteSpacePreservedElement){if(textNode=node.firstChild,textNode&&3===textNode.type)if(text=textNode.value.replace(startWhiteSpaceRegExp,""),text.length>0)textNode.value=text,textNode=textNode.next;else for(sibling=textNode.next,textNode.remove(),textNode=sibling;textNode&&3===textNode.type;)text=textNode.value,sibling=textNode.next,(0===text.length||isAllWhiteSpaceRegExp.test(text))&&(textNode.remove(),textNode=sibling),textNode=sibling;if(textNode=node.lastChild,textNode&&3===textNode.type)if(text=textNode.value.replace(endWhiteSpaceRegExp,""),text.length>0)textNode.value=text,textNode=textNode.prev;else for(sibling=textNode.prev,textNode.remove(),textNode=sibling;textNode&&3===textNode.type;)text=textNode.value,sibling=textNode.prev,(0===text.length||isAllWhiteSpaceRegExp.test(text))&&(textNode.remove(),textNode=sibling),textNode=sibling}if(isInWhiteSpacePreservedElement&&whiteSpaceElements[name]&&(isInWhiteSpacePreservedElement=!1),(elementRule.removeEmpty||elementRule.paddEmpty)&&node.isEmpty(nonEmptyElements))if(elementRule.paddEmpty)node.empty().append(new Node("#text","3")).value=" ";else if(!node.attributes.map.name&&!node.attributes.map.id)return tempNode=node.parent,node.empty().remove(),node=tempNode,void 0;node=node.parent}}},schema),rootNode=node=new Node(args.context||settings.root_name,11),parser.parse(html),validate&&invalidChildren.length&&(args.context?args.invalid=!0:fixInvalidChildren(invalidChildren)),rootBlockName&&("body"==rootNode.name||args.isRootContent)&&addRootBlocks(),!args.invalid){for(name in matchedNodes){for(list=nodeFilters[name],nodes=matchedNodes[name],fi=nodes.length;fi--;)nodes[fi].parent||nodes.splice(fi,1);for(i=0,l=list.length;l>i;i++)list[i](nodes,name,args)}for(i=0,l=attributeFilters.length;l>i;i++)if(list=attributeFilters[i],list.name in matchedAttributes){for(nodes=matchedAttributes[list.name],fi=nodes.length;fi--;)nodes[fi].parent||nodes.splice(fi,1);for(fi=0,fl=list.callbacks.length;fl>fi;fi++)list.callbacks[fi](nodes,list.name,args)}}return rootNode},settings.remove_trailing_brs&&self.addNodeFilter("br",function(nodes){var i,node,parent,lastParent,prev,prevName,elementRule,textNode,l=nodes.length,blockElements=extend({},schema.getBlockElements()),nonEmptyElements=schema.getNonEmptyElements();for(blockElements.body=1,i=0;l>i;i++)if(node=nodes[i],parent=node.parent,blockElements[node.parent.name]&&node===parent.lastChild){for(prev=node.prev;prev;){if(prevName=prev.name,"span"!==prevName||"bookmark"!==prev.attr("data-mce-type")){if("br"!==prevName)break;if("br"===prevName){node=null;break}}prev=prev.prev}node&&(node.remove(),parent.isEmpty(nonEmptyElements)&&(elementRule=schema.getElementRule(parent.name),elementRule&&(elementRule.removeEmpty?parent.remove():elementRule.paddEmpty&&(parent.empty().append(new Node("#text",3)).value=" "))))}else{for(lastParent=node;parent&&parent.firstChild===lastParent&&parent.lastChild===lastParent&&(lastParent=parent,!blockElements[parent.name]);)parent=parent.parent;lastParent===parent&&(textNode=new Node("#text",3),textNode.value=" ",node.replace(textNode))}}),settings.allow_html_in_named_anchor||self.addAttributeFilter("id,name",function(nodes){for(var sibling,prevSibling,parent,node,i=nodes.length;i--;)if(node=nodes[i],"a"===node.name&&node.firstChild&&!node.attr("href")){parent=node.parent,sibling=node.lastChild;do prevSibling=sibling.prev,parent.insert(sibling,node),sibling=prevSibling;while(sibling)}})}}),/**
 * Writer.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/html/Writer",["tinymce/html/Entities","tinymce/util/Tools"],function(Entities,Tools){var makeMap=Tools.makeMap;return function(settings){var indent,indentBefore,indentAfter,encode,htmlOutput,html=[];return settings=settings||{},indent=settings.indent,indentBefore=makeMap(settings.indent_before||""),indentAfter=makeMap(settings.indent_after||""),encode=Entities.getEncodeFunc(settings.entity_encoding||"raw",settings.entities),htmlOutput="html"==settings.element_format,{start:function(name,attrs,empty){var i,l,attr,value;if(indent&&indentBefore[name]&&html.length>0&&(value=html[html.length-1],value.length>0&&"\n"!==value&&html.push("\n")),html.push("<",name),attrs)for(i=0,l=attrs.length;l>i;i++)attr=attrs[i],html.push(" ",attr.name,'="',encode(attr.value,!0),'"');html[html.length]=!empty||htmlOutput?">":" />",empty&&indent&&indentAfter[name]&&html.length>0&&(value=html[html.length-1],value.length>0&&"\n"!==value&&html.push("\n"))},end:function(name){var value;html.push("</",name,">"),indent&&indentAfter[name]&&html.length>0&&(value=html[html.length-1],value.length>0&&"\n"!==value&&html.push("\n"))},text:function(text,raw){text.length>0&&(html[html.length]=raw?text:encode(text))},cdata:function(text){html.push("<![CDATA[",text,"]]>")},comment:function(text){html.push("<!--",text,"-->")},pi:function(name,text){text?html.push("<?",name," ",text,"?>"):html.push("<?",name,"?>"),indent&&html.push("\n")},doctype:function(text){html.push("<!DOCTYPE",text,">",indent?"\n":"")},reset:function(){html.length=0},getContent:function(){return html.join("").replace(/\n$/,"")}}}}),/**
 * Serializer.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/html/Serializer",["tinymce/html/Writer","tinymce/html/Schema"],function(Writer,Schema){return function(settings,schema){var self=this,writer=new Writer(settings);settings=settings||{},settings.validate="validate"in settings?settings.validate:!0,self.schema=schema=schema||new Schema,self.writer=writer,self.serialize=function(node){function walk(node){var name,isEmpty,attrs,attrName,attrValue,sortedAttrs,i,l,elementRule,handler=handlers[node.type];if(handler)handler(node);else{if(name=node.name,isEmpty=node.shortEnded,attrs=node.attributes,validate&&attrs&&attrs.length>1){for(sortedAttrs=[],sortedAttrs.map={},elementRule=schema.getElementRule(node.name),i=0,l=elementRule.attributesOrder.length;l>i;i++)attrName=elementRule.attributesOrder[i],attrName in attrs.map&&(attrValue=attrs.map[attrName],sortedAttrs.map[attrName]=attrValue,sortedAttrs.push({name:attrName,value:attrValue}));for(i=0,l=attrs.length;l>i;i++)attrName=attrs[i].name,attrName in sortedAttrs.map||(attrValue=attrs.map[attrName],sortedAttrs.map[attrName]=attrValue,sortedAttrs.push({name:attrName,value:attrValue}));attrs=sortedAttrs}if(writer.start(node.name,attrs,isEmpty),!isEmpty){if(node=node.firstChild)do walk(node);while(node=node.next);writer.end(name)}}}var handlers,validate;return validate=settings.validate,handlers={3:function(node){writer.text(node.value,node.raw)},8:function(node){writer.comment(node.value)},7:function(node){writer.pi(node.name,node.value)},10:function(node){writer.doctype(node.value)},4:function(node){writer.cdata(node.value)},11:function(node){if(node=node.firstChild)do walk(node);while(node=node.next)}},writer.reset(),1!=node.type||settings.inner?handlers[11](node):walk(node),writer.getContent()}}}),/**
 * Serializer.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/dom/Serializer",["tinymce/dom/DOMUtils","tinymce/html/DomParser","tinymce/html/Entities","tinymce/html/Serializer","tinymce/html/Node","tinymce/html/Schema","tinymce/Env","tinymce/util/Tools"],function(DOMUtils,DomParser,Entities,Serializer,Node,Schema,Env,Tools){var each=Tools.each,trim=Tools.trim,DOM=DOMUtils.DOM;return function(settings,editor){var dom,schema,htmlParser;return editor&&(dom=editor.dom,schema=editor.schema),dom=dom||DOM,schema=schema||new Schema(settings),settings.entity_encoding=settings.entity_encoding||"named",settings.remove_trailing_brs="remove_trailing_brs"in settings?settings.remove_trailing_brs:!0,htmlParser=new DomParser(settings,schema),htmlParser.addAttributeFilter("src,href,style",function(nodes,name){for(var node,value,undef,i=nodes.length,internalName="data-mce-"+name,urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope;i--;)node=nodes[i],value=node.attributes.map[internalName],value!==undef?(node.attr(name,value.length>0?value:null),node.attr(internalName,null)):(value=node.attributes.map[name],"style"===name?value=dom.serializeStyle(dom.parseStyle(value),node.name):urlConverter&&(value=urlConverter.call(urlConverterScope,value,name,node.name)),node.attr(name,value.length>0?value:null))}),htmlParser.addAttributeFilter("class",function(nodes){for(var node,value,i=nodes.length;i--;)node=nodes[i],value=node.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),node.attr("class",value.length>0?value:null)}),htmlParser.addAttributeFilter("data-mce-type",function(nodes,name,args){for(var node,i=nodes.length;i--;)node=nodes[i],"bookmark"!==node.attributes.map["data-mce-type"]||args.cleanup||node.remove()}),htmlParser.addAttributeFilter("data-mce-expando",function(nodes,name){for(var i=nodes.length;i--;)nodes[i].attr(name,null)}),htmlParser.addNodeFilter("noscript",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i].firstChild,node&&(node.value=Entities.decode(node.value))}),htmlParser.addNodeFilter("script,style",function(nodes,name){function trim(value){return value.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")}for(var node,value,i=nodes.length;i--;)if(node=nodes[i],value=node.firstChild?node.firstChild.value:"","script"===name){var type=(node.attr("type")||"text/javascript").replace(/^mce\-/,"");node.attr("type","text/javascript"===type?null:type),value.length>0&&(node.firstChild.value="// <![CDATA[\n"+trim(value)+"\n// ]]>")}else value.length>0&&(node.firstChild.value="<!--\n"+trim(value)+"\n-->")}),htmlParser.addNodeFilter("#comment",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],0===node.value.indexOf("[CDATA[")?(node.name="#cdata",node.type=4,node.value=node.value.replace(/^\[CDATA\[|\]\]$/g,"")):0===node.value.indexOf("mce:protected ")&&(node.name="#text",node.type=3,node.raw=!0,node.value=unescape(node.value).substr(14))}),htmlParser.addNodeFilter("xml:namespace,input",function(nodes,name){for(var node,i=nodes.length;i--;)node=nodes[i],7===node.type?node.remove():1===node.type&&("input"!==name||"type"in node.attributes.map||node.attr("type","text"))}),settings.fix_list_elements&&htmlParser.addNodeFilter("ul,ol",function(nodes){for(var node,parentNode,i=nodes.length;i--;)node=nodes[i],parentNode=node.parent,("ul"===parentNode.name||"ol"===parentNode.name)&&node.prev&&"li"===node.prev.name&&node.prev.append(node)}),htmlParser.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected",function(nodes,name){for(var i=nodes.length;i--;)nodes[i].attr(name,null)}),{schema:schema,addNodeFilter:htmlParser.addNodeFilter,addAttributeFilter:htmlParser.addAttributeFilter,serialize:function(node,args){var impl,doc,oldDoc,htmlSerializer,content,self=this;return Env.ie&&dom.select("script,style,select,map").length>0?(content=node.innerHTML,node=node.cloneNode(!1),dom.setHTML(node,content)):node=node.cloneNode(!0),impl=node.ownerDocument.implementation,impl.createHTMLDocument&&(doc=impl.createHTMLDocument(""),each("BODY"==node.nodeName?node.childNodes:[node],function(node){doc.body.appendChild(doc.importNode(node,!0))}),node="BODY"!=node.nodeName?doc.body.firstChild:doc.body,oldDoc=dom.doc,dom.doc=doc),args=args||{},args.format=args.format||"html",args.selection&&(args.forced_root_block=""),args.no_events||(args.node=node,self.onPreProcess(args)),htmlSerializer=new Serializer(settings,schema),args.content=htmlSerializer.serialize(htmlParser.parse(trim(args.getInner?node.innerHTML:dom.getOuterHTML(node)),args)),args.cleanup||(args.content=args.content.replace(/\uFEFF/g,"")),args.no_events||self.onPostProcess(args),oldDoc&&(dom.doc=oldDoc),args.node=null,args.content},addRules:function(rules){schema.addValidElements(rules)},setRules:function(rules){schema.setValidElements(rules)},onPreProcess:function(args){editor&&editor.fire("PreProcess",args)},onPostProcess:function(args){editor&&editor.fire("PostProcess",args)}}}}),/**
 * TridentSelection.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/dom/TridentSelection",[],function(){function Selection(selection){function getPosition(rng,start){var checkRng,endIndex,inside,children,child,offset,index,parent,startIndex=0,position=-1;if(checkRng=rng.duplicate(),checkRng.collapse(start),parent=checkRng.parentElement(),parent.ownerDocument===selection.dom.doc){for(;"false"===parent.contentEditable;)parent=parent.parentNode;if(!parent.hasChildNodes())return{node:parent,inside:1};for(children=parent.children,endIndex=children.length-1;endIndex>=startIndex;)if(index=Math.floor((startIndex+endIndex)/2),child=children[index],checkRng.moveToElementText(child),position=checkRng.compareEndPoints(start?"StartToStart":"EndToEnd",rng),position>0)endIndex=index-1;else{if(!(0>position))return{node:child};startIndex=index+1}if(0>position)for(child?checkRng.collapse(!1):(checkRng.moveToElementText(parent),checkRng.collapse(!0),child=parent,inside=!0),offset=0;0!==checkRng.compareEndPoints(start?"StartToStart":"StartToEnd",rng)&&0!==checkRng.move("character",1)&&parent==checkRng.parentElement();)offset++;else for(checkRng.collapse(!0),offset=0;0!==checkRng.compareEndPoints(start?"StartToStart":"StartToEnd",rng)&&0!==checkRng.move("character",-1)&&parent==checkRng.parentElement();)offset++;return{node:child,position:position,offset:offset,inside:inside}}}function getRange(){function findEndPoint(start){var container,offset,sibling,undef,nodeValue,endPoint=getPosition(ieRange,start),textNodeOffset=0;if(container=endPoint.node,offset=endPoint.offset,endPoint.inside&&!container.hasChildNodes())return domRange[start?"setStart":"setEnd"](container,0),void 0;if(offset===undef)return domRange[start?"setStartBefore":"setEndAfter"](container),void 0;if(endPoint.position<0){if(sibling=endPoint.inside?container.firstChild:container.nextSibling,!sibling)return domRange[start?"setStartAfter":"setEndAfter"](container),void 0;if(!offset)return 3==sibling.nodeType?domRange[start?"setStart":"setEnd"](sibling,0):domRange[start?"setStartBefore":"setEndBefore"](sibling),void 0;for(;sibling;){if(nodeValue=sibling.nodeValue,textNodeOffset+=nodeValue.length,textNodeOffset>=offset){container=sibling,textNodeOffset-=offset,textNodeOffset=nodeValue.length-textNodeOffset;break}sibling=sibling.nextSibling}}else{if(sibling=container.previousSibling,!sibling)return domRange[start?"setStartBefore":"setEndBefore"](container);if(!offset)return 3==container.nodeType?domRange[start?"setStart":"setEnd"](sibling,container.nodeValue.length):domRange[start?"setStartAfter":"setEndAfter"](sibling),void 0;for(;sibling;){if(textNodeOffset+=sibling.nodeValue.length,textNodeOffset>=offset){container=sibling,textNodeOffset-=offset;break}sibling=sibling.previousSibling}}domRange[start?"setStart":"setEnd"](container,textNodeOffset)}var element,collapsed,tmpRange,element2,bookmark,ieRange=selection.getRng(),domRange=dom.createRng();if(element=ieRange.item?ieRange.item(0):ieRange.parentElement(),element.ownerDocument!=dom.doc)return domRange;if(collapsed=selection.isCollapsed(),ieRange.item)return domRange.setStart(element.parentNode,dom.nodeIndex(element)),domRange.setEnd(domRange.startContainer,domRange.startOffset+1),domRange;try{findEndPoint(!0),collapsed||findEndPoint()}catch(ex){if(-2147024809!=ex.number)throw ex;bookmark=self.getBookmark(2),tmpRange=ieRange.duplicate(),tmpRange.collapse(!0),element=tmpRange.parentElement(),collapsed||(tmpRange=ieRange.duplicate(),tmpRange.collapse(!1),element2=tmpRange.parentElement(),element2.innerHTML=element2.innerHTML),element.innerHTML=element.innerHTML,self.moveToBookmark(bookmark),ieRange=selection.getRng(),findEndPoint(!0),collapsed||findEndPoint()}return domRange}var self=this,dom=selection.dom,FALSE=!1;this.getBookmark=function(type){function getIndexes(node){var parent,root,children,i,indexes=[];for(parent=node.parentNode,root=dom.getRoot().parentNode;parent!=root&&9!==parent.nodeType;){for(children=parent.children,i=children.length;i--;)if(node===children[i]){indexes.push(i);break}node=parent,parent=parent.parentNode}return indexes}function getBookmarkEndPoint(start){var position;return position=getPosition(rng,start),position?{position:position.position,offset:position.offset,indexes:getIndexes(position.node),inside:position.inside}:void 0}var rng=selection.getRng(),bookmark={};return 2===type&&(rng.item?bookmark.start={ctrl:!0,indexes:getIndexes(rng.item(0))}:(bookmark.start=getBookmarkEndPoint(!0),selection.isCollapsed()||(bookmark.end=getBookmarkEndPoint()))),bookmark},this.moveToBookmark=function(bookmark){function resolveIndexes(indexes){var node,i,idx,children;for(node=dom.getRoot(),i=indexes.length-1;i>=0;i--)children=node.children,idx=indexes[i],idx<=children.length-1&&(node=children[idx]);return node}function setBookmarkEndPoint(start){var moveLeft,moveRng,undef,offset,endPoint=bookmark[start?"start":"end"];endPoint&&(moveLeft=endPoint.position>0,moveRng=body.createTextRange(),moveRng.moveToElementText(resolveIndexes(endPoint.indexes)),offset=endPoint.offset,offset!==undef?(moveRng.collapse(endPoint.inside||moveLeft),moveRng.moveStart("character",moveLeft?-offset:offset)):moveRng.collapse(start),rng.setEndPoint(start?"StartToStart":"EndToStart",moveRng),start&&rng.collapse(!0))}var rng,body=dom.doc.body;bookmark.start&&(bookmark.start.ctrl?(rng=body.createControlRange(),rng.addElement(resolveIndexes(bookmark.start.indexes)),rng.select()):(rng=body.createTextRange(),setBookmarkEndPoint(!0),setBookmarkEndPoint(),rng.select()))},this.addRange=function(rng){function setEndPoint(start){var container,offset,marker,tmpRng,nodes;marker=dom.create("a"),container=start?startContainer:endContainer,offset=start?startOffset:endOffset,tmpRng=ieRng.duplicate(),(container==doc||container==doc.documentElement)&&(container=body,offset=0),3==container.nodeType?(container.parentNode.insertBefore(marker,container),tmpRng.moveToElementText(marker),tmpRng.moveStart("character",offset),dom.remove(marker),ieRng.setEndPoint(start?"StartToStart":"EndToEnd",tmpRng)):(nodes=container.childNodes,nodes.length?(offset>=nodes.length?dom.insertAfter(marker,nodes[nodes.length-1]):container.insertBefore(marker,nodes[offset]),tmpRng.moveToElementText(marker)):container.canHaveHTML&&(container.innerHTML="<span>&#xFEFF;</span>",marker=container.firstChild,tmpRng.moveToElementText(marker),tmpRng.collapse(FALSE)),ieRng.setEndPoint(start?"StartToStart":"EndToEnd",tmpRng),dom.remove(marker))}var ieRng,ctrlRng,startContainer,startOffset,endContainer,endOffset,sibling,nativeRng,ctrlElm,doc=selection.dom.doc,body=doc.body;if(startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,ieRng=body.createTextRange(),startContainer==endContainer&&1==startContainer.nodeType){if(startOffset==endOffset&&!startContainer.hasChildNodes()){if(startContainer.canHaveHTML)return sibling=startContainer.previousSibling,sibling&&!sibling.hasChildNodes()&&dom.isBlock(sibling)?sibling.innerHTML="&#xFEFF;":sibling=null,startContainer.innerHTML="<span>&#xFEFF;</span><span>&#xFEFF;</span>",ieRng.moveToElementText(startContainer.lastChild),ieRng.select(),dom.doc.selection.clear(),startContainer.innerHTML="",sibling&&(sibling.innerHTML=""),void 0;startOffset=dom.nodeIndex(startContainer),startContainer=startContainer.parentNode}if(startOffset==endOffset-1)try{if(ctrlElm=startContainer.childNodes[startOffset],ctrlRng=body.createControlRange(),ctrlRng.addElement(ctrlElm),ctrlRng.select(),nativeRng=selection.getRng(),nativeRng.item&&ctrlElm===nativeRng.item(0))return}catch(ex){}}setEndPoint(!0),setEndPoint(),ieRng.select()},this.getRangeAt=getRange}return Selection}),/**
 * VK.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/util/VK",["tinymce/Env"],function(Env){return{BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey},metaKeyPressed:function(e){return(Env.mac?e.metaKey:e.ctrlKey)&&!e.altKey}}}),/**
 * ControlSelection.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/dom/ControlSelection",["tinymce/util/VK","tinymce/util/Tools","tinymce/Env"],function(VK,Tools,Env){return function(selection,editor){function isResizable(elm){return editor.settings.object_resizing===!1?!1:/TABLE|IMG|DIV/.test(elm.nodeName)?"false"===elm.getAttribute("data-mce-resize")?!1:!0:!1}function resizeGhostElement(e){var deltaX,deltaY;deltaX=e.screenX-startX,deltaY=e.screenY-startY,width=deltaX*selectedHandle[2]+startW,height=deltaY*selectedHandle[3]+startH,width=5>width?5:width,height=5>height?5:height,(VK.modifierPressed(e)||"IMG"==selectedElm.nodeName&&0!==selectedHandle[2]*selectedHandle[3])&&(width=Math.round(height/ratio),height=Math.round(width*ratio)),dom.setStyles(selectedElmGhost,{width:width,height:height}),selectedHandle[2]<0&&selectedElmGhost.clientWidth<=width&&dom.setStyle(selectedElmGhost,"left",selectedElmX+(startW-width)),selectedHandle[3]<0&&selectedElmGhost.clientHeight<=height&&dom.setStyle(selectedElmGhost,"top",selectedElmY+(startH-height)),resizeStarted||(editor.fire("ObjectResizeStart",{target:selectedElm,width:startW,height:startH}),resizeStarted=!0)}function endGhostResize(){function setSizeProp(name,value){value&&(selectedElm.style[name]||!editor.schema.isValid(selectedElm.nodeName.toLowerCase(),name)?dom.setStyle(selectedElm,name,value):dom.setAttrib(selectedElm,name,value))}resizeStarted=!1,setSizeProp("width",width),setSizeProp("height",height),dom.unbind(editableDoc,"mousemove",resizeGhostElement),dom.unbind(editableDoc,"mouseup",endGhostResize),rootDocument!=editableDoc&&(dom.unbind(rootDocument,"mousemove",resizeGhostElement),dom.unbind(rootDocument,"mouseup",endGhostResize)),dom.remove(selectedElmGhost),isIE&&"TABLE"!=selectedElm.nodeName||showResizeRect(selectedElm),editor.fire("ObjectResized",{target:selectedElm,width:width,height:height}),editor.nodeChanged()}function showResizeRect(targetElm,mouseDownHandleName,mouseDownEvent){var position,targetWidth,targetHeight,e,rect,offsetParent=editor.getBody();position=dom.getPos(targetElm,offsetParent),selectedElmX=position.x,selectedElmY=position.y,rect=targetElm.getBoundingClientRect(),targetWidth=rect.width||rect.right-rect.left,targetHeight=rect.height||rect.bottom-rect.top,selectedElm!=targetElm&&(detachResizeStartListener(),selectedElm=targetElm,width=height=0),e=editor.fire("ObjectSelected",{target:targetElm}),isResizable(targetElm)&&!e.isDefaultPrevented()?each(resizeHandles,function(handle,name){function startDrag(e){startX=e.screenX,startY=e.screenY,startW=selectedElm.clientWidth,startH=selectedElm.clientHeight,ratio=startH/startW,selectedHandle=handle,selectedElmGhost=selectedElm.cloneNode(!0),dom.addClass(selectedElmGhost,"mce-clonedresizable"),selectedElmGhost.contentEditable=!1,selectedElmGhost.unSelectabe=!0,dom.setStyles(selectedElmGhost,{left:selectedElmX,top:selectedElmY,margin:0}),selectedElmGhost.removeAttribute("data-mce-selected"),editor.getBody().appendChild(selectedElmGhost),dom.bind(editableDoc,"mousemove",resizeGhostElement),dom.bind(editableDoc,"mouseup",endGhostResize),rootDocument!=editableDoc&&(dom.bind(rootDocument,"mousemove",resizeGhostElement),dom.bind(rootDocument,"mouseup",endGhostResize))}var handleElm,handlerContainerElm;return mouseDownHandleName?(name==mouseDownHandleName&&startDrag(mouseDownEvent),void 0):(handleElm=dom.get("mceResizeHandle"+name),handleElm?dom.show(handleElm):(handlerContainerElm=editor.getBody(),handleElm=dom.add(handlerContainerElm,"div",{id:"mceResizeHandle"+name,"data-mce-bogus":!0,"class":"mce-resizehandle",unselectable:!0,style:"cursor:"+name+"-resize; margin:0; padding:0"}),Env.ie&&(handleElm.contentEditable=!1),dom.bind(handleElm,"mousedown",function(e){e.stopImmediatePropagation(),e.preventDefault(),startDrag(e)})),dom.setStyles(handleElm,{left:targetWidth*handle[0]+selectedElmX-handleElm.offsetWidth/2,top:targetHeight*handle[1]+selectedElmY-handleElm.offsetHeight/2}),void 0)}):hideResizeRect(),selectedElm.setAttribute("data-mce-selected","1")}function hideResizeRect(){var name,handleElm;selectedElm&&selectedElm.removeAttribute("data-mce-selected");for(name in resizeHandles)handleElm=dom.get("mceResizeHandle"+name),handleElm&&(dom.unbind(handleElm),dom.remove(handleElm))}function updateResizeRect(e){function isChildOrEqual(node,parent){if(node)do if(node===parent)return!0;while(node=node.parentNode)}var controlElm;return each(dom.select("img[data-mce-selected],hr[data-mce-selected]"),function(img){img.removeAttribute("data-mce-selected")}),controlElm="mousedown"==e.type?e.target:selection.getNode(),controlElm=dom.getParent(controlElm,isIE?"table":"table,img,hr"),isChildOrEqual(controlElm,editor.getBody())&&(disableGeckoResize(),isChildOrEqual(selection.getStart(),controlElm)&&isChildOrEqual(selection.getEnd(),controlElm)&&(!isIE||controlElm!=selection.getStart()&&"IMG"!==selection.getStart().nodeName))?(showResizeRect(controlElm),void 0):(hideResizeRect(),void 0)}function attachEvent(elm,name,func){elm&&elm.attachEvent&&elm.attachEvent("on"+name,func)}function detachEvent(elm,name,func){elm&&elm.detachEvent&&elm.detachEvent("on"+name,func)}function resizeNativeStart(e){var pos,name,corner,cornerX,cornerY,relativeX,relativeY,target=e.srcElement;pos=target.getBoundingClientRect(),relativeX=lastMouseDownEvent.clientX-pos.left,relativeY=lastMouseDownEvent.clientY-pos.top;for(name in resizeHandles)if(corner=resizeHandles[name],cornerX=target.offsetWidth*corner[0],cornerY=target.offsetHeight*corner[1],Math.abs(cornerX-relativeX)<8&&Math.abs(cornerY-relativeY)<8){selectedHandle=corner;break}resizeStarted=!0,editor.getDoc().selection.empty(),showResizeRect(target,name,lastMouseDownEvent)}function nativeControlSelect(e){var target=e.srcElement;if(target!=selectedElm){if(detachResizeStartListener(),0===target.id.indexOf("mceResizeHandle"))return e.returnValue=!1,void 0;("IMG"==target.nodeName||"TABLE"==target.nodeName)&&(hideResizeRect(),selectedElm=target,attachEvent(target,"resizestart",resizeNativeStart))}}function detachResizeStartListener(){detachEvent(selectedElm,"resizestart",resizeNativeStart)}function disableGeckoResize(){try{editor.getDoc().execCommand("enableObjectResizing",!1,!1)}catch(ex){}}function controlSelect(elm){var ctrlRng;if(isIE){ctrlRng=editableDoc.body.createControlRange();try{return ctrlRng.addElement(elm),ctrlRng.select(),!0}catch(ex){}}}function destroy(){selectedElm=selectedElmGhost=null,isIE&&(detachResizeStartListener(),detachEvent(editor.getBody(),"controlselect",nativeControlSelect))}var selectedElm,selectedElmGhost,resizeHandles,selectedHandle,lastMouseDownEvent,startX,startY,selectedElmX,selectedElmY,startW,startH,ratio,resizeStarted,width,height,dom=editor.dom,each=Tools.each,editableDoc=editor.getDoc(),rootDocument=document,isIE=Env.ie&&Env.ie<11;resizeHandles={n:[.5,0,0,-1],e:[1,.5,1,0],s:[.5,1,0,1],w:[0,.5,-1,0],nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var rootClass=".mce-content-body";return editor.contentStyles.push(rootClass+" div.mce-resizehandle {"+"position: absolute;"+"border: 1px solid black;"+"background: #FFF;"+"width: 5px;"+"height: 5px;"+"z-index: 10000"+"}"+rootClass+" .mce-resizehandle:hover {"+"background: #000"+"}"+rootClass+" img[data-mce-selected], hr[data-mce-selected] {"+"outline: 1px solid black;"+"resize: none"+"}"+rootClass+" .mce-clonedresizable {"+"position: absolute;"+(Env.gecko?"":"outline: 1px dashed black;")+"opacity: .5;"+"filter: alpha(opacity=50);"+"z-index: 10000"+"}"),editor.on("init",function(){isIE?(editor.on("ObjectResized",function(e){"TABLE"!=e.target.nodeName&&(hideResizeRect(),controlSelect(e.target))}),attachEvent(editor.getBody(),"controlselect",nativeControlSelect),editor.on("mousedown",function(e){lastMouseDownEvent=e})):(disableGeckoResize(),Env.ie>=11&&(editor.on("mouseup",function(e){var nodeName=e.target.nodeName;/^(TABLE|IMG|HR)$/.test(nodeName)&&(editor.selection.select(e.target,"TABLE"==nodeName),editor.nodeChanged())}),editor.dom.bind(editor.getBody(),"mscontrolselect",function(e){/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&e.preventDefault()}))),editor.on("nodechange mousedown mouseup ResizeEditor",updateResizeRect),editor.on("keydown keyup",function(e){selectedElm&&"TABLE"==selectedElm.nodeName&&updateResizeRect(e)})}),{isResizable:isResizable,showResizeRect:showResizeRect,hideResizeRect:hideResizeRect,updateResizeRect:updateResizeRect,controlSelect:controlSelect,destroy:destroy}}}),/**
 * Range.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/dom/RangeUtils",["tinymce/util/Tools","tinymce/dom/TreeWalker"],function(Tools,TreeWalker){function RangeUtils(dom){this.walk=function(rng,callback){function exclude(nodes){var node;return node=nodes[0],3===node.nodeType&&node===startContainer&&startOffset>=node.nodeValue.length&&nodes.splice(0,1),node=nodes[nodes.length-1],0===endOffset&&nodes.length>0&&node===endContainer&&3===node.nodeType&&nodes.splice(nodes.length-1,1),nodes}function collectSiblings(node,name,end_node){for(var siblings=[];node&&node!=end_node;node=node[name])siblings.push(node);return siblings}function findEndPoint(node,root){do{if(node.parentNode==root)return node;node=node.parentNode}while(node)}function walkBoundary(start_node,end_node,next){var siblingName=next?"nextSibling":"previousSibling";for(node=start_node,parent=node.parentNode;node&&node!=end_node;node=parent)parent=node.parentNode,siblings=collectSiblings(node==start_node?node:node[siblingName],siblingName),siblings.length&&(next||siblings.reverse(),callback(exclude(siblings)))}var ancestor,startPoint,endPoint,node,parent,siblings,nodes,startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;if(nodes=dom.select("td.mce-item-selected,th.mce-item-selected"),nodes.length>0)return each(nodes,function(node){callback([node])}),void 0;if(1==startContainer.nodeType&&startContainer.hasChildNodes()&&(startContainer=startContainer.childNodes[startOffset]),1==endContainer.nodeType&&endContainer.hasChildNodes()&&(endContainer=endContainer.childNodes[Math.min(endOffset-1,endContainer.childNodes.length-1)]),startContainer==endContainer)return callback(exclude([startContainer]));for(ancestor=dom.findCommonAncestor(startContainer,endContainer),node=startContainer;node;node=node.parentNode){if(node===endContainer)return walkBoundary(startContainer,ancestor,!0);if(node===ancestor)break}for(node=endContainer;node;node=node.parentNode){if(node===startContainer)return walkBoundary(endContainer,ancestor);if(node===ancestor)break}startPoint=findEndPoint(startContainer,ancestor)||startContainer,endPoint=findEndPoint(endContainer,ancestor)||endContainer,walkBoundary(startContainer,startPoint,!0),siblings=collectSiblings(startPoint==startContainer?startPoint:startPoint.nextSibling,"nextSibling",endPoint==endContainer?endPoint.nextSibling:endPoint),siblings.length&&callback(exclude(siblings)),walkBoundary(endContainer,endPoint)},this.split=function(rng){function splitText(node,offset){return node.splitText(offset)}var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;return startContainer==endContainer&&3==startContainer.nodeType?startOffset>0&&startOffset<startContainer.nodeValue.length&&(endContainer=splitText(startContainer,startOffset),startContainer=endContainer.previousSibling,endOffset>startOffset?(endOffset-=startOffset,startContainer=endContainer=splitText(endContainer,endOffset).previousSibling,endOffset=endContainer.nodeValue.length,startOffset=0):endOffset=0):(3==startContainer.nodeType&&startOffset>0&&startOffset<startContainer.nodeValue.length&&(startContainer=splitText(startContainer,startOffset),startOffset=0),3==endContainer.nodeType&&endOffset>0&&endOffset<endContainer.nodeValue.length&&(endContainer=splitText(endContainer,endOffset).previousSibling,endOffset=endContainer.nodeValue.length)),{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}},this.normalize=function(rng){function normalizeEndPoint(start){function hasBrBeforeAfter(node,left){for(var walker=new TreeWalker(node,dom.getParent(node.parentNode,dom.isBlock)||body);node=walker[left?"prev":"next"]();)if("BR"===node.nodeName)return!0}function isPrevNode(node,name){return node.previousSibling&&node.previousSibling.nodeName==name}function findTextNodeRelative(left,startNode){var walker,lastInlineElement,parentBlockContainer;if(startNode=startNode||container,parentBlockContainer=dom.getParent(startNode.parentNode,dom.isBlock)||body,left&&"BR"==startNode.nodeName&&isAfterNode&&dom.isEmpty(parentBlockContainer))return container=startNode.parentNode,offset=dom.nodeIndex(startNode),normalized=!0,void 0;for(walker=new TreeWalker(startNode,parentBlockContainer);node=walker[left?"prev":"next"]();){if(3===node.nodeType&&node.nodeValue.length>0)return container=node,offset=left?node.nodeValue.length:0,normalized=!0,void 0;if(dom.isBlock(node)||nonEmptyElementsMap[node.nodeName.toLowerCase()])return;lastInlineElement=node}collapsed&&lastInlineElement&&(container=lastInlineElement,normalized=!0,offset=0)}var container,offset,walker,node,nonEmptyElementsMap,nodeName,directionLeft,isAfterNode,body=dom.getRoot();if(container=rng[(start?"start":"end")+"Container"],offset=rng[(start?"start":"end")+"Offset"],isAfterNode=1==container.nodeType&&offset===container.childNodes.length,nonEmptyElementsMap=dom.schema.getNonEmptyElements(),directionLeft=start,1==container.nodeType&&offset>container.childNodes.length-1&&(directionLeft=!1),9===container.nodeType&&(container=dom.getRoot(),offset=0),container===body){if(directionLeft&&(node=container.childNodes[offset>0?offset-1:0],node&&(nodeName=node.nodeName.toLowerCase(),nonEmptyElementsMap[node.nodeName]||"TABLE"==node.nodeName)))return;if(container.hasChildNodes()&&(offset=Math.min(!directionLeft&&offset>0?offset-1:offset,container.childNodes.length-1),container=container.childNodes[offset],offset=0,container.hasChildNodes()&&!/TABLE/.test(container.nodeName))){node=container,walker=new TreeWalker(container,body);do{if(3===node.nodeType&&node.nodeValue.length>0){offset=directionLeft?0:node.nodeValue.length,container=node,normalized=!0;break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]){offset=dom.nodeIndex(node),container=node.parentNode,"IMG"!=node.nodeName||directionLeft||offset++,normalized=!0;break}}while(node=directionLeft?walker.next():walker.prev())}}collapsed&&(3===container.nodeType&&0===offset&&findTextNodeRelative(!0),1===container.nodeType&&(node=container.childNodes[offset],node||(node=container.childNodes[offset-1]),!node||"BR"!==node.nodeName||isPrevNode(node,"A")||hasBrBeforeAfter(node)||hasBrBeforeAfter(node,!0)||findTextNodeRelative(!0,node))),directionLeft&&!collapsed&&3===container.nodeType&&offset===container.nodeValue.length&&findTextNodeRelative(!1),normalized&&rng["set"+(start?"Start":"End")](container,offset)}var normalized,collapsed;return collapsed=rng.collapsed,normalizeEndPoint(!0),collapsed||normalizeEndPoint(),normalized&&collapsed&&rng.collapse(!0),normalized}}var each=Tools.each;return RangeUtils.compareRanges=function(rng1,rng2){if(rng1&&rng2){if(!rng1.item&&!rng1.duplicate)return rng1.startContainer==rng2.startContainer&&rng1.startOffset==rng2.startOffset;if(rng1.item&&rng2.item&&rng1.item(0)===rng2.item(0))return!0;if(rng1.isEqual&&rng2.isEqual&&rng2.isEqual(rng1))return!0}return!1},RangeUtils}),/**
 * Selection.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/dom/Selection",["tinymce/dom/TreeWalker","tinymce/dom/TridentSelection","tinymce/dom/ControlSelection","tinymce/dom/RangeUtils","tinymce/Env","tinymce/util/Tools"],function(TreeWalker,TridentSelection,ControlSelection,RangeUtils,Env,Tools){function Selection(dom,win,serializer,editor){var self=this;self.dom=dom,self.win=win,self.serializer=serializer,self.editor=editor,self.controlSelection=new ControlSelection(self,editor),self.win.getSelection||(self.tridentSel=new TridentSelection(self))}var each=Tools.each,grep=Tools.grep,trim=Tools.trim,isIE=Env.ie,isOpera=Env.opera;return Selection.prototype={setCursorLocation:function(node,offset){var self=this,rng=self.dom.createRng();node?(rng.setStart(node,offset),rng.setEnd(node,offset),self.setRng(rng),self.collapse(!1)):(self._moveEndPoint(rng,self.editor.getBody(),!0),self.setRng(rng))},getContent:function(args){var whiteSpaceBefore,whiteSpaceAfter,fragment,self=this,rng=self.getRng(),tmpElm=self.dom.create("body"),se=self.getSel();return args=args||{},whiteSpaceBefore=whiteSpaceAfter="",args.get=!0,args.format=args.format||"html",args.selection=!0,self.editor.fire("BeforeGetContent",args),"text"==args.format?self.isCollapsed()?"":rng.text||(se.toString?se.toString():""):(rng.cloneContents?(fragment=rng.cloneContents(),fragment&&tmpElm.appendChild(fragment)):rng.item!==undefined||rng.htmlText!==undefined?(tmpElm.innerHTML="<br>"+(rng.item?rng.item(0).outerHTML:rng.htmlText),tmpElm.removeChild(tmpElm.firstChild)):tmpElm.innerHTML=rng.toString(),/^\s/.test(tmpElm.innerHTML)&&(whiteSpaceBefore=" "),/\s+$/.test(tmpElm.innerHTML)&&(whiteSpaceAfter=" "),args.getInner=!0,args.content=self.isCollapsed()?"":whiteSpaceBefore+self.serializer.serialize(tmpElm,args)+whiteSpaceAfter,self.editor.fire("GetContent",args),args.content)},setContent:function(content,args){var caretNode,frag,temp,self=this,rng=self.getRng(),doc=self.win.document;if(args=args||{format:"html"},args.set=!0,args.selection=!0,content=args.content=content,args.no_events||self.editor.fire("BeforeSetContent",args),content=args.content,rng.insertNode){content+='<span id="__caret">_</span>',rng.startContainer==doc&&rng.endContainer==doc?doc.body.innerHTML=content:(rng.deleteContents(),0===doc.body.childNodes.length?doc.body.innerHTML=content:rng.createContextualFragment?rng.insertNode(rng.createContextualFragment(content)):(frag=doc.createDocumentFragment(),temp=doc.createElement("div"),frag.appendChild(temp),temp.outerHTML=content,rng.insertNode(frag))),caretNode=self.dom.get("__caret"),rng=doc.createRange(),rng.setStartBefore(caretNode),rng.setEndBefore(caretNode),self.setRng(rng),self.dom.remove("__caret");try{self.setRng(rng)}catch(ex){}}else rng.item&&(doc.execCommand("Delete",!1,null),rng=self.getRng()),/^\s+/.test(content)?(rng.pasteHTML('<span id="__mce_tmp">_</span>'+content),self.dom.remove("__mce_tmp")):rng.pasteHTML(content);args.no_events||self.editor.fire("SetContent",args)},getStart:function(){var startElement,parentElement,checkRng,node,self=this,rng=self.getRng();if(rng.duplicate||rng.item){if(rng.item)return rng.item(0);for(checkRng=rng.duplicate(),checkRng.collapse(1),startElement=checkRng.parentElement(),startElement.ownerDocument!==self.dom.doc&&(startElement=self.dom.getRoot()),parentElement=node=rng.parentElement();node=node.parentNode;)if(node==startElement){startElement=parentElement;break}return startElement}return startElement=rng.startContainer,1==startElement.nodeType&&startElement.hasChildNodes()&&(startElement=startElement.childNodes[Math.min(startElement.childNodes.length-1,rng.startOffset)]),startElement&&3==startElement.nodeType?startElement.parentNode:startElement},getEnd:function(){var endElement,endOffset,self=this,rng=self.getRng();return rng.duplicate||rng.item?rng.item?rng.item(0):(rng=rng.duplicate(),rng.collapse(0),endElement=rng.parentElement(),endElement.ownerDocument!==self.dom.doc&&(endElement=self.dom.getRoot()),endElement&&"BODY"==endElement.nodeName?endElement.lastChild||endElement:endElement):(endElement=rng.endContainer,endOffset=rng.endOffset,1==endElement.nodeType&&endElement.hasChildNodes()&&(endElement=endElement.childNodes[endOffset>0?endOffset-1:endOffset]),endElement&&3==endElement.nodeType?endElement.parentNode:endElement)},getBookmark:function(type,normalized){function findIndex(name,element){var index=0;return each(dom.select(name),function(node,i){node==element&&(index=i)}),index}function normalizeTableCellSelection(rng){function moveEndPoint(start){var container,offset,childNodes,prefix=start?"start":"end";container=rng[prefix+"Container"],offset=rng[prefix+"Offset"],1==container.nodeType&&"TR"==container.nodeName&&(childNodes=container.childNodes,container=childNodes[Math.min(start?offset:offset-1,childNodes.length-1)],container&&(offset=start?0:container.childNodes.length,rng["set"+(start?"Start":"End")](container,offset)))}return moveEndPoint(!0),moveEndPoint(),rng}function getLocation(){function getPoint(rng,start){var node,childNodes,container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],point=[],after=0;if(3==container.nodeType){if(normalized)for(node=container.previousSibling;node&&3==node.nodeType;node=node.previousSibling)offset+=node.nodeValue.length;point.push(offset)}else childNodes=container.childNodes,offset>=childNodes.length&&childNodes.length&&(after=1,offset=Math.max(0,childNodes.length-1)),point.push(t.dom.nodeIndex(childNodes[offset],normalized)+after);for(;container&&container!=root;container=container.parentNode)point.push(t.dom.nodeIndex(container,normalized));return point}var rng=t.getRng(!0),root=dom.getRoot(),bookmark={};return bookmark.start=getPoint(rng,!0),t.isCollapsed()||(bookmark.end=getPoint(rng)),bookmark}var rng,rng2,id,collapsed,name,element,styles,t=this,dom=t.dom,chr="&#xFEFF;";if(2==type)return element=t.getNode(),name=element?element.nodeName:null,"IMG"==name?{name:name,index:findIndex(name,element)}:t.tridentSel?t.tridentSel.getBookmark(type):getLocation();if(type)return{rng:t.getRng()};if(rng=t.getRng(),id=dom.uniqueId(),collapsed=t.isCollapsed(),styles="overflow:hidden;line-height:0px",rng.duplicate||rng.item){if(rng.item)return element=rng.item(0),name=element.nodeName,{name:name,index:findIndex(name,element)};rng2=rng.duplicate();try{rng.collapse(),rng.pasteHTML('<span data-mce-type="bookmark" id="'+id+'_start" style="'+styles+'">'+chr+"</span>"),collapsed||(rng2.collapse(!1),rng.moveToElementText(rng2.parentElement()),0===rng.compareEndPoints("StartToEnd",rng2)&&rng2.move("character",-1),rng2.pasteHTML('<span data-mce-type="bookmark" id="'+id+'_end" style="'+styles+'">'+chr+"</span>"))}catch(ex){return null}}else{if(element=t.getNode(),name=element.nodeName,"IMG"==name)return{name:name,index:findIndex(name,element)};rng2=normalizeTableCellSelection(rng.cloneRange()),collapsed||(rng2.collapse(!1),rng2.insertNode(dom.create("span",{"data-mce-type":"bookmark",id:id+"_end",style:styles},chr))),rng=normalizeTableCellSelection(rng),rng.collapse(!0),rng.insertNode(dom.create("span",{"data-mce-type":"bookmark",id:id+"_start",style:styles},chr))}return t.moveToBookmark({id:id,keep:1}),{id:id}},moveToBookmark:function(bookmark){function setEndPoint(start){var i,node,offset,children,point=bookmark[start?"start":"end"];if(point){for(offset=point[0],node=root,i=point.length-1;i>=1;i--){if(children=node.childNodes,point[i]>children.length-1)return;node=children[point[i]]}3===node.nodeType&&(offset=Math.min(point[0],node.nodeValue.length)),1===node.nodeType&&(offset=Math.min(point[0],node.childNodes.length)),start?rng.setStart(node,offset):rng.setEnd(node,offset)}return!0}function restoreEndPoint(suffix){var node,idx,next,prev,marker=dom.get(bookmark.id+"_"+suffix),keep=bookmark.keep;if(marker&&(node=marker.parentNode,"start"==suffix?(keep?(node=marker.firstChild,idx=1):idx=dom.nodeIndex(marker),startContainer=endContainer=node,startOffset=endOffset=idx):(keep?(node=marker.firstChild,idx=1):idx=dom.nodeIndex(marker),endContainer=node,endOffset=idx),!keep)){for(prev=marker.previousSibling,next=marker.nextSibling,each(grep(marker.childNodes),function(node){3==node.nodeType&&(node.nodeValue=node.nodeValue.replace(/\uFEFF/g,""))});marker=dom.get(bookmark.id+"_"+suffix);)dom.remove(marker,1);prev&&next&&prev.nodeType==next.nodeType&&3==prev.nodeType&&!isOpera&&(idx=prev.nodeValue.length,prev.appendData(next.nodeValue),dom.remove(next),"start"==suffix?(startContainer=endContainer=prev,startOffset=endOffset=idx):(endContainer=prev,endOffset=idx))}}function addBogus(node){return!dom.isBlock(node)||node.innerHTML||isIE||(node.innerHTML='<br data-mce-bogus="1" />'),node}var rng,root,startContainer,endContainer,startOffset,endOffset,t=this,dom=t.dom;if(bookmark)if(bookmark.start){if(rng=dom.createRng(),root=dom.getRoot(),t.tridentSel)return t.tridentSel.moveToBookmark(bookmark);setEndPoint(!0)&&setEndPoint()&&t.setRng(rng)}else bookmark.id?(restoreEndPoint("start"),restoreEndPoint("end"),startContainer&&(rng=dom.createRng(),rng.setStart(addBogus(startContainer),startOffset),rng.setEnd(addBogus(endContainer),endOffset),t.setRng(rng))):bookmark.name?t.select(dom.select(bookmark.name)[bookmark.index]):bookmark.rng&&t.setRng(bookmark.rng)},select:function(node,content){var idx,self=this,dom=self.dom,rng=dom.createRng();if(self.lastFocusBookmark=null,node){if(!content&&self.controlSelection.controlSelect(node))return;idx=dom.nodeIndex(node),rng.setStart(node.parentNode,idx),rng.setEnd(node.parentNode,idx+1),content&&(self._moveEndPoint(rng,node,!0),self._moveEndPoint(rng,node)),self.setRng(rng)}return node},isCollapsed:function(){var self=this,rng=self.getRng(),sel=self.getSel();return!rng||rng.item?!1:rng.compareEndPoints?0===rng.compareEndPoints("StartToEnd",rng):!sel||rng.collapsed},collapse:function(to_start){var node,self=this,rng=self.getRng();rng.item&&(node=rng.item(0),rng=self.win.document.body.createTextRange(),rng.moveToElementText(node)),rng.collapse(!!to_start),self.setRng(rng)},getSel:function(){var win=this.win;return win.getSelection?win.getSelection():win.document.selection},getRng:function(w3c){function tryCompareBounderyPoints(how,sourceRange,destinationRange){try{return sourceRange.compareBoundaryPoints(how,destinationRange)}catch(ex){return-1}}var selection,rng,elm,ieRng,self=this,doc=self.win.document;if(!w3c&&self.lastFocusBookmark){var bookmark=self.lastFocusBookmark;return bookmark.startContainer?(rng=doc.createRange(),rng.setStart(bookmark.startContainer,bookmark.startOffset),rng.setEnd(bookmark.endContainer,bookmark.endOffset)):rng=bookmark,rng}if(w3c&&self.tridentSel)return self.tridentSel.getRangeAt(0);try{(selection=self.getSel())&&(rng=selection.rangeCount>0?selection.getRangeAt(0):selection.createRange?selection.createRange():doc.createRange())}catch(ex){}if(isIE&&rng&&rng.setStart&&doc.selection){try{ieRng=doc.selection.createRange()}catch(ex){}ieRng&&ieRng.item&&(elm=ieRng.item(0),rng=doc.createRange(),rng.setStartBefore(elm),rng.setEndAfter(elm))}return rng||(rng=doc.createRange?doc.createRange():doc.body.createTextRange()),rng.setStart&&9===rng.startContainer.nodeType&&rng.collapsed&&(elm=self.dom.getRoot(),rng.setStart(elm,0),rng.setEnd(elm,0)),self.selectedRange&&self.explicitRange&&(0===tryCompareBounderyPoints(rng.START_TO_START,rng,self.selectedRange)&&0===tryCompareBounderyPoints(rng.END_TO_END,rng,self.selectedRange)?rng=self.explicitRange:(self.selectedRange=null,self.explicitRange=null)),rng},setRng:function(rng,forward){var sel,self=this;if(rng.select)try{rng.select()}catch(ex){}else if(self.tridentSel){if(rng.cloneRange)try{return self.tridentSel.addRange(rng),void 0}catch(ex){}}else if(sel=self.getSel()){self.explicitRange=rng;try{sel.removeAllRanges(),sel.addRange(rng)}catch(ex){}forward===!1&&sel.extend&&(sel.collapse(rng.endContainer,rng.endOffset),sel.extend(rng.startContainer,rng.startOffset)),self.selectedRange=sel.rangeCount>0?sel.getRangeAt(0):null}},setNode:function(elm){var self=this;return self.setContent(self.dom.getOuterHTML(elm)),elm},getNode:function(){function skipEmptyTextNodes(node,forwards){for(var orig=node;node&&3===node.nodeType&&0===node.length;)node=forwards?node.nextSibling:node.previousSibling;return node||orig}var elm,self=this,rng=self.getRng(),startContainer=rng.startContainer,endContainer=rng.endContainer,startOffset=rng.startOffset,endOffset=rng.endOffset,root=self.dom.getRoot();return rng?rng.setStart?(elm=rng.commonAncestorContainer,!rng.collapsed&&(startContainer==endContainer&&2>endOffset-startOffset&&startContainer.hasChildNodes()&&(elm=startContainer.childNodes[startOffset]),3===startContainer.nodeType&&3===endContainer.nodeType&&(startContainer=startContainer.length===startOffset?skipEmptyTextNodes(startContainer.nextSibling,!0):startContainer.parentNode,endContainer=0===endOffset?skipEmptyTextNodes(endContainer.previousSibling,!1):endContainer.parentNode,startContainer&&startContainer===endContainer))?startContainer:elm&&3==elm.nodeType?elm.parentNode:elm):(elm=rng.item?rng.item(0):rng.parentElement(),elm.ownerDocument!==self.win.document&&(elm=root),elm):root},getSelectedBlocks:function(startElm,endElm){var node,root,self=this,dom=self.dom,selectedBlocks=[];if(root=dom.getRoot(),startElm=dom.getParent(startElm||self.getStart(),dom.isBlock),endElm=dom.getParent(endElm||self.getEnd(),dom.isBlock),startElm&&startElm!=root&&selectedBlocks.push(startElm),startElm&&endElm&&startElm!=endElm){node=startElm;for(var walker=new TreeWalker(startElm,root);(node=walker.next())&&node!=endElm;)dom.isBlock(node)&&selectedBlocks.push(node)}return endElm&&startElm!=endElm&&endElm!=root&&selectedBlocks.push(endElm),selectedBlocks},isForward:function(){var anchorRange,focusRange,dom=this.dom,sel=this.getSel();return sel&&sel.anchorNode&&sel.focusNode?(anchorRange=dom.createRng(),anchorRange.setStart(sel.anchorNode,sel.anchorOffset),anchorRange.collapse(!0),focusRange=dom.createRng(),focusRange.setStart(sel.focusNode,sel.focusOffset),focusRange.collapse(!0),anchorRange.compareBoundaryPoints(anchorRange.START_TO_START,focusRange)<=0):!0},normalize:function(){var self=this,rng=self.getRng();return!isIE&&new RangeUtils(self.dom).normalize(rng)&&self.setRng(rng,self.isForward()),rng},selectorChanged:function(selector,callback){var currentSelectors,self=this;return self.selectorChangedData||(self.selectorChangedData={},currentSelectors={},self.editor.on("NodeChange",function(e){var node=e.element,dom=self.dom,parents=dom.getParents(node,null,dom.getRoot()),matchedSelectors={};each(self.selectorChangedData,function(callbacks,selector){each(parents,function(node){return dom.is(node,selector)?(currentSelectors[selector]||(each(callbacks,function(callback){callback(!0,{node:node,selector:selector,parents:parents})}),currentSelectors[selector]=callbacks),matchedSelectors[selector]=callbacks,!1):void 0})}),each(currentSelectors,function(callbacks,selector){matchedSelectors[selector]||(delete currentSelectors[selector],each(callbacks,function(callback){callback(!1,{node:node,selector:selector,parents:parents})}))})})),self.selectorChangedData[selector]||(self.selectorChangedData[selector]=[]),self.selectorChangedData[selector].push(callback),self},getScrollContainer:function(){for(var scrollContainer,node=this.dom.getRoot();node&&"BODY"!=node.nodeName;){if(node.scrollHeight>node.clientHeight){scrollContainer=node;break}node=node.parentNode}return scrollContainer},scrollIntoView:function(elm){function getPos(elm){for(var x=0,y=0,offsetParent=elm;offsetParent&&offsetParent.nodeType;)x+=offsetParent.offsetLeft||0,y+=offsetParent.offsetTop||0,offsetParent=offsetParent.offsetParent;return{x:x,y:y}}var y,viewPort,viewPortY,viewPortH,self=this,dom=self.dom,root=dom.getRoot();if("BODY"!=root.nodeName){var scrollContainer=self.getScrollContainer();if(scrollContainer)return y=getPos(elm).y-getPos(scrollContainer).y,viewPortH=scrollContainer.clientHeight,viewPortY=scrollContainer.scrollTop,(viewPortY>y||y+25>viewPortY+viewPortH)&&(scrollContainer.scrollTop=viewPortY>y?y:y-viewPortH+25),void 0}viewPort=dom.getViewPort(self.editor.getWin()),y=dom.getPos(elm).y,viewPortY=viewPort.y,viewPortH=viewPort.h,(y<viewPort.y||y+25>viewPortY+viewPortH)&&self.editor.getWin().scrollTo(0,viewPortY>y?y:y-viewPortH+25)},_moveEndPoint:function(rng,node,start){var root=node,walker=new TreeWalker(node,root),nonEmptyElementsMap=this.dom.schema.getNonEmptyElements();do{if(3==node.nodeType&&0!==trim(node.nodeValue).length)return start?rng.setStart(node,0):rng.setEnd(node,node.nodeValue.length),void 0;if(nonEmptyElementsMap[node.nodeName])return start?rng.setStartBefore(node):"BR"==node.nodeName?rng.setEndBefore(node):rng.setEndAfter(node),void 0;if(Env.ie&&Env.ie<11&&this.dom.isBlock(node)&&this.dom.isEmpty(node))return start?rng.setStart(node,0):rng.setEnd(node,0),void 0}while(node=start?walker.next():walker.prev());"BODY"==root.nodeName&&(start?rng.setStart(root,0):rng.setEnd(root,root.childNodes.length))},destroy:function(){this.win=null,this.controlSelection.destroy()}},Selection}),/**
 * Formatter.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/Formatter",["tinymce/dom/TreeWalker","tinymce/dom/RangeUtils","tinymce/util/Tools"],function(TreeWalker,RangeUtils,Tools){return function(ed){function isTextBlock(name){return name.nodeType&&(name=name.nodeName),!!ed.schema.getTextBlockElements()[name.toLowerCase()]}function getParents(node,selector){return dom.getParents(node,selector,dom.getRoot())}function isCaretNode(node){return 1===node.nodeType&&"_mce_caret"===node.id}function defaultFormats(){register({alignleft:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},defaultBlock:"div"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"right"}}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},defaultBlock:"div"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:!1},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},wrap_links:!1},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(){return!0},onformat:function(elm,fmt,vars){each(vars,function(value,key){dom.setAttrib(elm,key,value)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]}),each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(name){register(name,{block:name,remove:"all"})}),register(ed.settings.formats)}function addKeyboardShortcuts(){ed.addShortcut("ctrl+b","bold_desc","Bold"),ed.addShortcut("ctrl+i","italic_desc","Italic"),ed.addShortcut("ctrl+u","underline_desc","Underline");for(var i=1;6>=i;i++)ed.addShortcut("ctrl+"+i,"",["FormatBlock",!1,"h"+i]);ed.addShortcut("ctrl+7","",["FormatBlock",!1,"p"]),ed.addShortcut("ctrl+8","",["FormatBlock",!1,"div"]),ed.addShortcut("ctrl+9","",["FormatBlock",!1,"address"])}function get(name){return name?formats[name]:formats}function register(name,format){name&&("string"!=typeof name?each(name,function(format,name){register(name,format)}):(format=format.length?format:[format],each(format,function(format){format.deep===undef&&(format.deep=!format.selector),format.split===undef&&(format.split=!format.selector||format.inline),format.remove===undef&&format.selector&&!format.inline&&(format.remove="none"),format.selector&&format.inline&&(format.mixed=!0,format.block_expand=!0),"string"==typeof format.classes&&(format.classes=format.classes.split(/\s+/))}),formats[name]=format))}function getTextDecoration(node){var decoration;return ed.dom.getParent(node,function(n){return decoration=ed.dom.getStyle(n,"text-decoration"),decoration&&"none"!==decoration}),decoration}function processUnderlineAndColor(node){var textDecoration;1===node.nodeType&&node.parentNode&&1===node.parentNode.nodeType&&(textDecoration=getTextDecoration(node.parentNode),ed.dom.getStyle(node,"color")&&textDecoration?ed.dom.setStyle(node,"text-decoration",textDecoration):ed.dom.getStyle(node,"textdecoration")===textDecoration&&ed.dom.setStyle(node,"text-decoration",null))}function apply(name,vars,node){function setElementFormat(elm,fmt){fmt=fmt||format,elm&&(fmt.onformat&&fmt.onformat(elm,fmt,vars,node),each(fmt.styles,function(value,name){dom.setStyle(elm,name,replaceVars(value,vars))}),each(fmt.attributes,function(value,name){dom.setAttrib(elm,name,replaceVars(value,vars))}),each(fmt.classes,function(value){value=replaceVars(value,vars),dom.hasClass(elm,value)||dom.addClass(elm,value)}))}function adjustSelectionToVisibleSelection(){function findSelectionEnd(start,end){var walker=new TreeWalker(end);for(node=walker.current();node;node=walker.prev())if(node.childNodes.length>1||node==start||"BR"==node.tagName)return node}var rng=ed.selection.getRng(),start=rng.startContainer,end=rng.endContainer;if(start!=end&&0===rng.endOffset){var newEnd=findSelectionEnd(start,end),endOffset=3==newEnd.nodeType?newEnd.length:newEnd.childNodes.length;rng.setEnd(newEnd,endOffset)}return rng}function applyStyleToList(node,bookmark,wrapElm,newWrappers,process){var list,currentWrapElm,nodes=[],listIndex=-1,startIndex=-1,endIndex=-1;return each(node.childNodes,function(n,index){return"UL"===n.nodeName||"OL"===n.nodeName?(listIndex=index,list=n,!1):void 0}),each(node.childNodes,function(n,index){"SPAN"===n.nodeName&&"bookmark"==dom.getAttrib(n,"data-mce-type")&&(n.id==bookmark.id+"_start"?startIndex=index:n.id==bookmark.id+"_end"&&(endIndex=index))}),0>=listIndex||listIndex>startIndex&&endIndex>listIndex?(each(grep(node.childNodes),process),0):(currentWrapElm=dom.clone(wrapElm,FALSE),each(grep(node.childNodes),function(n,index){(listIndex>startIndex&&listIndex>index||startIndex>listIndex&&index>listIndex)&&(nodes.push(n),n.parentNode.removeChild(n))}),listIndex>startIndex?node.insertBefore(currentWrapElm,list):startIndex>listIndex&&node.insertBefore(currentWrapElm,list.nextSibling),newWrappers.push(currentWrapElm),each(nodes,function(node){currentWrapElm.appendChild(node)}),currentWrapElm)}function applyRngStyle(rng,bookmark,node_specific){var wrapName,wrapElm,newWrappers=[],contentEditable=!0;wrapName=format.inline||format.block,wrapElm=dom.create(wrapName),setElementFormat(wrapElm),rangeUtils.walk(rng,function(nodes){function process(node){var nodeName,parentName,found,hasContentEditableState,lastContentEditable;return lastContentEditable=contentEditable,nodeName=node.nodeName.toLowerCase(),parentName=node.parentNode.nodeName.toLowerCase(),1===node.nodeType&&getContentEditable(node)&&(lastContentEditable=contentEditable,contentEditable="true"===getContentEditable(node),hasContentEditableState=!0),isEq(nodeName,"br")?(currentWrapElm=0,format.block&&dom.remove(node),void 0):format.wrapper&&matchNode(node,name,vars)?(currentWrapElm=0,void 0):contentEditable&&!hasContentEditableState&&format.block&&!format.wrapper&&isTextBlock(nodeName)&&isValid(parentName,wrapName)?(node=dom.rename(node,wrapName),setElementFormat(node),newWrappers.push(node),currentWrapElm=0,void 0):format.selector&&(each(formatList,function(format){"collapsed"in format&&format.collapsed!==isCollapsed||dom.is(node,format.selector)&&!isCaretNode(node)&&(setElementFormat(node,format),found=!0)}),!format.inline||found)?(currentWrapElm=0,void 0):(!contentEditable||hasContentEditableState||!isValid(wrapName,nodeName)||!isValid(parentName,wrapName)||!node_specific&&3===node.nodeType&&1===node.nodeValue.length&&65279===node.nodeValue.charCodeAt(0)||isCaretNode(node)||format.inline&&isBlock(node)?"li"==nodeName&&bookmark?currentWrapElm=applyStyleToList(node,bookmark,wrapElm,newWrappers,process):(currentWrapElm=0,each(grep(node.childNodes),process),hasContentEditableState&&(contentEditable=lastContentEditable),currentWrapElm=0):(currentWrapElm||(currentWrapElm=dom.clone(wrapElm,FALSE),node.parentNode.insertBefore(currentWrapElm,node),newWrappers.push(currentWrapElm)),currentWrapElm.appendChild(node)),void 0)}var currentWrapElm;each(nodes,process)}),format.wrap_links===!1&&each(newWrappers,function(node){function process(node){var i,currentWrapElm,children;if("A"===node.nodeName){for(currentWrapElm=dom.clone(wrapElm,FALSE),newWrappers.push(currentWrapElm),children=grep(node.childNodes),i=0;i<children.length;i++)currentWrapElm.appendChild(children[i]);node.appendChild(currentWrapElm)}each(grep(node.childNodes),process)}process(node)}),each(newWrappers,function(node){function getChildCount(node){var count=0;return each(node.childNodes,function(node){isWhiteSpaceNode(node)||isBookmarkNode(node)||count++}),count}function mergeStyles(node){var child,clone;return each(node.childNodes,function(node){return 1!=node.nodeType||isBookmarkNode(node)||isCaretNode(node)?void 0:(child=node,FALSE)}),child&&!isBookmarkNode(child)&&matchName(child,format)&&(clone=dom.clone(child,FALSE),setElementFormat(clone),dom.replace(clone,node,TRUE),dom.remove(child,1)),clone||node}var childCount;if(childCount=getChildCount(node),(newWrappers.length>1||!isBlock(node))&&0===childCount)return dom.remove(node,1),void 0;if(format.inline||format.wrapper){if(format.exact||1!==childCount||(node=mergeStyles(node)),each(formatList,function(format){each(dom.select(format.inline,node),function(child){var parent;if(!isBookmarkNode(child)){if(format.wrap_links===!1){parent=child.parentNode;do if("A"===parent.nodeName)return;while(parent=parent.parentNode)}removeFormat(format,vars,child,format.exact?child:null)}})}),matchNode(node.parentNode,name,vars))return dom.remove(node,1),node=0,TRUE;format.merge_with_parents&&dom.getParent(node.parentNode,function(parent){return matchNode(parent,name,vars)?(dom.remove(node,1),node=0,TRUE):void 0}),node&&format.merge_siblings!==!1&&(node=mergeSiblings(getNonWhiteSpaceSibling(node),node),node=mergeSiblings(node,getNonWhiteSpaceSibling(node,TRUE)))}})}var bookmark,rng,formatList=get(name),format=formatList[0],isCollapsed=!node&&selection.isCollapsed();if(format)if(node)node.nodeType?(rng=dom.createRng(),rng.setStartBefore(node),rng.setEndAfter(node),applyRngStyle(expandRng(rng,formatList),null,!0)):applyRngStyle(node,null,!0);else if(isCollapsed&&format.inline&&!dom.select("td.mce-item-selected,th.mce-item-selected").length)performCaretAction("apply",name,vars);else{var curSelNode=ed.selection.getNode();forcedRootBlock||!formatList[0].defaultBlock||dom.getParent(curSelNode,dom.isBlock)||apply(formatList[0].defaultBlock),ed.selection.setRng(adjustSelectionToVisibleSelection()),bookmark=selection.getBookmark(),applyRngStyle(expandRng(selection.getRng(TRUE),formatList),bookmark),format.styles&&(format.styles.color||format.styles.textDecoration)&&(walk(curSelNode,processUnderlineAndColor,"childNodes"),processUnderlineAndColor(curSelNode)),selection.moveToBookmark(bookmark),moveStart(selection.getRng(TRUE)),ed.nodeChanged()}}function remove(name,vars,node){function process(node){var children,i,l,lastContentEditable,hasContentEditableState;if(1===node.nodeType&&getContentEditable(node)&&(lastContentEditable=contentEditable,contentEditable="true"===getContentEditable(node),hasContentEditableState=!0),children=grep(node.childNodes),contentEditable&&!hasContentEditableState)for(i=0,l=formatList.length;l>i&&!removeFormat(formatList[i],vars,node,node);i++);if(format.deep&&children.length){for(i=0,l=children.length;l>i;i++)process(children[i]);hasContentEditableState&&(contentEditable=lastContentEditable)}}function findFormatRoot(container){var formatRoot;return each(getParents(container.parentNode).reverse(),function(parent){var format;formatRoot||"_start"==parent.id||"_end"==parent.id||(format=matchNode(parent,name,vars),format&&format.split!==!1&&(formatRoot=parent))}),formatRoot}function wrapAndSplit(format_root,container,target,split){var parent,clone,lastClone,firstClone,i,formatRootParent;if(format_root){for(formatRootParent=format_root.parentNode,parent=container.parentNode;parent&&parent!=formatRootParent;parent=parent.parentNode){for(clone=dom.clone(parent,FALSE),i=0;i<formatList.length;i++)if(removeFormat(formatList[i],vars,clone,clone)){clone=0;break}clone&&(lastClone&&clone.appendChild(lastClone),firstClone||(firstClone=clone),lastClone=clone)}!split||format.mixed&&isBlock(format_root)||(container=dom.split(format_root,container)),lastClone&&(target.parentNode.insertBefore(lastClone,target),firstClone.appendChild(target))}return container}function splitToFormatRoot(container){return wrapAndSplit(findFormatRoot(container),container,container,!0)}function unwrap(start){var node=dom.get(start?"_start":"_end"),out=node[start?"firstChild":"lastChild"];return isBookmarkNode(out)&&(out=out[start?"firstChild":"lastChild"]),dom.remove(node,!0),out}function removeRngStyle(rng){var startContainer,endContainer,commonAncestorContainer=rng.commonAncestorContainer;rng=expandRng(rng,formatList,TRUE),format.split&&(startContainer=getContainer(rng,TRUE),endContainer=getContainer(rng),startContainer!=endContainer?(/^(TR|TH|TD)$/.test(startContainer.nodeName)&&startContainer.firstChild&&(startContainer="TR"==startContainer.nodeName?startContainer.firstChild.firstChild||startContainer:startContainer.firstChild||startContainer),commonAncestorContainer&&/^T(HEAD|BODY|FOOT|R)$/.test(commonAncestorContainer.nodeName)&&/^(TH|TD)$/.test(endContainer.nodeName)&&endContainer.firstChild&&(endContainer=endContainer.firstChild||endContainer),startContainer=wrap(startContainer,"span",{id:"_start","data-mce-type":"bookmark"}),endContainer=wrap(endContainer,"span",{id:"_end","data-mce-type":"bookmark"}),splitToFormatRoot(startContainer),splitToFormatRoot(endContainer),startContainer=unwrap(TRUE),endContainer=unwrap()):startContainer=endContainer=splitToFormatRoot(startContainer),rng.startContainer=startContainer.parentNode,rng.startOffset=nodeIndex(startContainer),rng.endContainer=endContainer.parentNode,rng.endOffset=nodeIndex(endContainer)+1),rangeUtils.walk(rng,function(nodes){each(nodes,function(node){process(node),1===node.nodeType&&"underline"===ed.dom.getStyle(node,"text-decoration")&&node.parentNode&&"underline"===getTextDecoration(node.parentNode)&&removeFormat({deep:!1,exact:!0,inline:"span",styles:{textDecoration:"underline"}},null,node)})})}var bookmark,rng,formatList=get(name),format=formatList[0],contentEditable=!0;return node?(node.nodeType?(rng=dom.createRng(),rng.setStartBefore(node),rng.setEndAfter(node),removeRngStyle(rng)):removeRngStyle(node),void 0):(selection.isCollapsed()&&format.inline&&!dom.select("td.mce-item-selected,th.mce-item-selected").length?performCaretAction("remove",name,vars):(bookmark=selection.getBookmark(),removeRngStyle(selection.getRng(TRUE)),selection.moveToBookmark(bookmark),format.inline&&match(name,vars,selection.getStart())&&moveStart(selection.getRng(!0)),ed.nodeChanged()),void 0)}function toggle(name,vars,node){var fmt=get(name);!match(name,vars,node)||"toggle"in fmt[0]&&!fmt[0].toggle?apply(name,vars,node):remove(name,vars,node)}function matchNode(node,name,vars,similar){function matchItems(node,format,item_name){var key,value,i,items=format[item_name];if(format.onmatch)return format.onmatch(node,format,item_name);if(items)if(items.length===undef){for(key in items)if(items.hasOwnProperty(key)){if(value="attributes"===item_name?dom.getAttrib(node,key):getStyle(node,key),similar&&!value&&!format.exact)return;if((!similar||format.exact)&&!isEq(value,normalizeStyleValue(replaceVars(items[key],vars),key)))return}}else for(i=0;i<items.length;i++)if("attributes"===item_name?dom.getAttrib(node,items[i]):getStyle(node,items[i]))return format;return format}var format,i,classes,formatList=get(name);if(formatList&&node)for(i=0;i<formatList.length;i++)if(format=formatList[i],matchName(node,format)&&matchItems(node,format,"attributes")&&matchItems(node,format,"styles")){if(classes=format.classes)for(i=0;i<classes.length;i++)if(!dom.hasClass(node,classes[i]))return;return format}}function match(name,vars,node){function matchParents(node){var root=dom.getRoot();return node===root?!1:(node=dom.getParent(node,function(node){return node.parentNode===root||!!matchNode(node,name,vars,!0)}),matchNode(node,name,vars))}var startNode;return node?matchParents(node):(node=selection.getNode(),matchParents(node)?TRUE:(startNode=selection.getStart(),startNode!=node&&matchParents(startNode)?TRUE:FALSE))}function matchAll(names,vars){var startElement,matchedFormatNames=[],checkedMap={};return startElement=selection.getStart(),dom.getParent(startElement,function(node){var i,name;for(i=0;i<names.length;i++)name=names[i],!checkedMap[name]&&matchNode(node,name,vars)&&(checkedMap[name]=!0,matchedFormatNames.push(name))},dom.getRoot()),matchedFormatNames}function canApply(name){var startNode,parents,i,x,selector,formatList=get(name);if(formatList)for(startNode=selection.getStart(),parents=getParents(startNode),x=formatList.length-1;x>=0;x--){if(selector=formatList[x].selector,!selector||formatList[x].defaultBlock)return TRUE;for(i=parents.length-1;i>=0;i--)if(dom.is(parents[i],selector))return TRUE}return FALSE}function formatChanged(formats,callback,similar){var currentFormats;return formatChangeData||(formatChangeData={},currentFormats={},ed.on("NodeChange",function(e){var parents=getParents(e.element),matchedFormats={};each(formatChangeData,function(callbacks,format){each(parents,function(node){return matchNode(node,format,{},callbacks.similar)?(currentFormats[format]||(each(callbacks,function(callback){callback(!0,{node:node,format:format,parents:parents})}),currentFormats[format]=callbacks),matchedFormats[format]=callbacks,!1):void 0})}),each(currentFormats,function(callbacks,format){matchedFormats[format]||(delete currentFormats[format],each(callbacks,function(callback){callback(!1,{node:e.element,format:format,parents:parents})}))})})),each(formats.split(","),function(format){formatChangeData[format]||(formatChangeData[format]=[],formatChangeData[format].similar=similar),formatChangeData[format].push(callback)}),this}function matchName(node,format){return isEq(node,format.inline)?TRUE:isEq(node,format.block)?TRUE:format.selector?1==node.nodeType&&dom.is(node,format.selector):void 0}function isEq(str1,str2){return str1=str1||"",str2=str2||"",str1=""+(str1.nodeName||str1),str2=""+(str2.nodeName||str2),str1.toLowerCase()==str2.toLowerCase()}function getStyle(node,name){return normalizeStyleValue(dom.getStyle(node,name),name)}function normalizeStyleValue(value,name){return("color"==name||"backgroundColor"==name)&&(value=dom.toHex(value)),"fontWeight"==name&&700==value&&(value="bold"),"fontFamily"==name&&(value=value.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+value}function replaceVars(value,vars){return"string"!=typeof value?value=value(vars):vars&&(value=value.replace(/%(\w+)/g,function(str,name){return vars[name]||str})),value}function isWhiteSpaceNode(node){return node&&3===node.nodeType&&/^([\t \r\n]+|)$/.test(node.nodeValue)}function wrap(node,name,attrs){var wrapper=dom.create(name,attrs);return node.parentNode.insertBefore(wrapper,node),wrapper.appendChild(node),wrapper}function expandRng(rng,format,remove){function findParentContainer(start){function isBogusBr(node){return"BR"==node.nodeName&&node.getAttribute("data-mce-bogus")&&!node.nextSibling}var container,parent,sibling,siblingName,root;if(container=parent=start?startContainer:endContainer,siblingName=start?"previousSibling":"nextSibling",root=dom.getRoot(),3==container.nodeType&&!isWhiteSpaceNode(container)&&(start?startOffset>0:endOffset<container.nodeValue.length))return container;for(;;){if(!format[0].block_expand&&isBlock(parent))return parent;for(sibling=parent[siblingName];sibling;sibling=sibling[siblingName])if(!isBookmarkNode(sibling)&&!isWhiteSpaceNode(sibling)&&!isBogusBr(sibling))return parent;if(parent.parentNode==root){container=parent;break}parent=parent.parentNode}return container}function findLeaf(node,offset){for(offset===undef&&(offset=3===node.nodeType?node.length:node.childNodes.length);node&&node.hasChildNodes();)node=node.childNodes[offset],node&&(offset=3===node.nodeType?node.length:node.childNodes.length);return{node:node,offset:offset}}function findParentContentEditable(node){for(var parent=node;parent;){if(1===parent.nodeType&&getContentEditable(parent))return"false"===getContentEditable(parent)?parent:node;parent=parent.parentNode}return node}function findWordEndPoint(container,offset,start){function findSpace(node,offset){var pos,pos2,str=node.nodeValue;return"undefined"==typeof offset&&(offset=start?str.length:0),start?(pos=str.lastIndexOf(" ",offset),pos2=str.lastIndexOf(" ",offset),pos=pos>pos2?pos:pos2,-1===pos||remove||pos++):(pos=str.indexOf(" ",offset),pos2=str.indexOf(" ",offset),pos=-1!==pos&&(-1===pos2||pos2>pos)?pos:pos2),pos}var walker,node,pos,lastTextNode;if(3===container.nodeType){if(pos=findSpace(container,offset),-1!==pos)return{container:container,offset:pos};lastTextNode=container}for(walker=new TreeWalker(container,dom.getParent(container,isBlock)||ed.getBody());node=walker[start?"prev":"next"]();)if(3===node.nodeType){if(lastTextNode=node,pos=findSpace(node),-1!==pos)return{container:node,offset:pos}}else if(isBlock(node))break;return lastTextNode?(offset=start?0:lastTextNode.length,{container:lastTextNode,offset:offset}):void 0}function findSelectorEndPoint(container,sibling_name){var parents,i,y,curFormat;for(3==container.nodeType&&0===container.nodeValue.length&&container[sibling_name]&&(container=container[sibling_name]),parents=getParents(container),i=0;i<parents.length;i++)for(y=0;y<format.length;y++)if(curFormat=format[y],!("collapsed"in curFormat&&curFormat.collapsed!==rng.collapsed)&&dom.is(parents[i],curFormat.selector))return parents[i];return container}function findBlockEndPoint(container,sibling_name){var node,root=dom.getRoot();if(format[0].wrapper||(node=dom.getParent(container,format[0].block,root)),node||(node=dom.getParent(3==container.nodeType?container.parentNode:container,function(node){return node!=root&&isTextBlock(node)})),node&&format[0].wrapper&&(node=getParents(node,"ul,ol").reverse()[0]||node),!node)for(node=container;node[sibling_name]&&!isBlock(node[sibling_name])&&(node=node[sibling_name],!isEq(node,"br")););return node||container}var lastIdx,leaf,endPoint,startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;if(1==startContainer.nodeType&&startContainer.hasChildNodes()&&(lastIdx=startContainer.childNodes.length-1,startContainer=startContainer.childNodes[startOffset>lastIdx?lastIdx:startOffset],3==startContainer.nodeType&&(startOffset=0)),1==endContainer.nodeType&&endContainer.hasChildNodes()&&(lastIdx=endContainer.childNodes.length-1,endContainer=endContainer.childNodes[endOffset>lastIdx?lastIdx:endOffset-1],3==endContainer.nodeType&&(endOffset=endContainer.nodeValue.length)),startContainer=findParentContentEditable(startContainer),endContainer=findParentContentEditable(endContainer),(isBookmarkNode(startContainer.parentNode)||isBookmarkNode(startContainer))&&(startContainer=isBookmarkNode(startContainer)?startContainer:startContainer.parentNode,startContainer=startContainer.nextSibling||startContainer,3==startContainer.nodeType&&(startOffset=0)),(isBookmarkNode(endContainer.parentNode)||isBookmarkNode(endContainer))&&(endContainer=isBookmarkNode(endContainer)?endContainer:endContainer.parentNode,endContainer=endContainer.previousSibling||endContainer,3==endContainer.nodeType&&(endOffset=endContainer.length)),format[0].inline&&(rng.collapsed&&(endPoint=findWordEndPoint(startContainer,startOffset,!0),endPoint&&(startContainer=endPoint.container,startOffset=endPoint.offset),endPoint=findWordEndPoint(endContainer,endOffset),endPoint&&(endContainer=endPoint.container,endOffset=endPoint.offset)),leaf=findLeaf(endContainer,endOffset),leaf.node)){for(;leaf.node&&0===leaf.offset&&leaf.node.previousSibling;)leaf=findLeaf(leaf.node.previousSibling);leaf.node&&leaf.offset>0&&3===leaf.node.nodeType&&" "===leaf.node.nodeValue.charAt(leaf.offset-1)&&leaf.offset>1&&(endContainer=leaf.node,endContainer.splitText(leaf.offset-1))}return(format[0].inline||format[0].block_expand)&&(format[0].inline&&3==startContainer.nodeType&&0!==startOffset||(startContainer=findParentContainer(!0)),format[0].inline&&3==endContainer.nodeType&&endOffset!==endContainer.nodeValue.length||(endContainer=findParentContainer())),format[0].selector&&format[0].expand!==FALSE&&!format[0].inline&&(startContainer=findSelectorEndPoint(startContainer,"previousSibling"),endContainer=findSelectorEndPoint(endContainer,"nextSibling")),(format[0].block||format[0].selector)&&(startContainer=findBlockEndPoint(startContainer,"previousSibling"),endContainer=findBlockEndPoint(endContainer,"nextSibling"),format[0].block&&(isBlock(startContainer)||(startContainer=findParentContainer(!0)),isBlock(endContainer)||(endContainer=findParentContainer()))),1==startContainer.nodeType&&(startOffset=nodeIndex(startContainer),startContainer=startContainer.parentNode),1==endContainer.nodeType&&(endOffset=nodeIndex(endContainer)+1,endContainer=endContainer.parentNode),{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}}function removeFormat(format,vars,node,compare_node){var i,attrs,stylesModified;if(!matchName(node,format))return FALSE;if("all"!=format.remove)for(each(format.styles,function(value,name){value=normalizeStyleValue(replaceVars(value,vars),name),"number"==typeof name&&(name=value,compare_node=0),(!compare_node||isEq(getStyle(compare_node,name),value))&&dom.setStyle(node,name,""),stylesModified=1}),stylesModified&&""===dom.getAttrib(node,"style")&&(node.removeAttribute("style"),node.removeAttribute("data-mce-style")),each(format.attributes,function(value,name){var valueOut;if(value=replaceVars(value,vars),"number"==typeof name&&(name=value,compare_node=0),!compare_node||isEq(dom.getAttrib(compare_node,name),value)){if("class"==name&&(value=dom.getAttrib(node,name),value&&(valueOut="",each(value.split(/\s+/),function(cls){/mce\w+/.test(cls)&&(valueOut+=(valueOut?" ":"")+cls)}),valueOut)))return dom.setAttrib(node,name,valueOut),void 0;"class"==name&&node.removeAttribute("className"),MCE_ATTR_RE.test(name)&&node.removeAttribute("data-mce-"+name),node.removeAttribute(name)}}),each(format.classes,function(value){value=replaceVars(value,vars),(!compare_node||dom.hasClass(compare_node,value))&&dom.removeClass(node,value)}),attrs=dom.getAttribs(node),i=0;i<attrs.length;i++)if(0!==attrs[i].nodeName.indexOf("_"))return FALSE;return"none"!=format.remove?(removeNode(node,format),TRUE):void 0}function removeNode(node,format){function find(node,next,inc){return node=getNonWhiteSpaceSibling(node,next,inc),!node||"BR"==node.nodeName||isBlock(node)}var rootBlockElm,parentNode=node.parentNode;format.block&&(forcedRootBlock?parentNode==dom.getRoot()&&(format.list_block&&isEq(node,format.list_block)||each(grep(node.childNodes),function(node){isValid(forcedRootBlock,node.nodeName.toLowerCase())?rootBlockElm?rootBlockElm.appendChild(node):(rootBlockElm=wrap(node,forcedRootBlock),dom.setAttribs(rootBlockElm,ed.settings.forced_root_block_attrs)):rootBlockElm=0})):isBlock(node)&&!isBlock(parentNode)&&(find(node,FALSE)||find(node.firstChild,TRUE,1)||node.insertBefore(dom.create("br"),node.firstChild),find(node,TRUE)||find(node.lastChild,FALSE,1)||node.appendChild(dom.create("br")))),format.selector&&format.inline&&!isEq(format.inline,node)||dom.remove(node,1)}function getNonWhiteSpaceSibling(node,next,inc){if(node)for(next=next?"nextSibling":"previousSibling",node=inc?node:node[next];node;node=node[next])if(1==node.nodeType||!isWhiteSpaceNode(node))return node}function isBookmarkNode(node){return node&&1==node.nodeType&&"bookmark"==node.getAttribute("data-mce-type")}function mergeSiblings(prev,next){function compareElements(node1,node2){function getAttribs(node){var attribs={};return each(dom.getAttribs(node),function(attr){var name=attr.nodeName.toLowerCase();0!==name.indexOf("_")&&"style"!==name&&"data-mce-style"!==name&&(attribs[name]=dom.getAttrib(node,name))}),attribs}function compareObjects(obj1,obj2){var value,name;for(name in obj1)if(obj1.hasOwnProperty(name)){if(value=obj2[name],value===undef)return FALSE;if(obj1[name]!=value)return FALSE;delete obj2[name]}for(name in obj2)if(obj2.hasOwnProperty(name))return FALSE;return TRUE}return node1.nodeName!=node2.nodeName?FALSE:compareObjects(getAttribs(node1),getAttribs(node2))?compareObjects(dom.parseStyle(dom.getAttrib(node1,"style")),dom.parseStyle(dom.getAttrib(node2,"style")))?!isBookmarkNode(node1)&&!isBookmarkNode(node2):FALSE:FALSE}function findElementSibling(node,sibling_name){for(sibling=node;sibling;sibling=sibling[sibling_name]){if(3==sibling.nodeType&&0!==sibling.nodeValue.length)return node;if(1==sibling.nodeType&&!isBookmarkNode(sibling))return sibling}return node}var sibling,tmpSibling;if(prev&&next&&(prev=findElementSibling(prev,"previousSibling"),next=findElementSibling(next,"nextSibling"),compareElements(prev,next))){for(sibling=prev.nextSibling;sibling&&sibling!=next;)tmpSibling=sibling,sibling=sibling.nextSibling,prev.appendChild(tmpSibling);return dom.remove(next),each(grep(next.childNodes),function(node){prev.appendChild(node)}),prev}return next}function getContainer(rng,start){var container,offset,lastIdx;return container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],1==container.nodeType&&(lastIdx=container.childNodes.length-1,!start&&offset&&offset--,container=container.childNodes[offset>lastIdx?lastIdx:offset]),3===container.nodeType&&start&&offset>=container.nodeValue.length&&(container=new TreeWalker(container,ed.getBody()).next()||container),3!==container.nodeType||start||0!==offset||(container=new TreeWalker(container,ed.getBody()).prev()||container),container}function performCaretAction(type,name,vars){function createCaretContainer(fill){var caretContainer=dom.create("span",{id:caretContainerId,"data-mce-bogus":!0,style:debug?"color:red":""});return fill&&caretContainer.appendChild(ed.getDoc().createTextNode(INVISIBLE_CHAR)),caretContainer}function isCaretContainerEmpty(node,nodes){for(;node;){if(3===node.nodeType&&node.nodeValue!==INVISIBLE_CHAR||node.childNodes.length>1)return!1;nodes&&1===node.nodeType&&nodes.push(node),node=node.firstChild}return!0}function getParentCaretContainer(node){for(;node;){if(node.id===caretContainerId)return node;node=node.parentNode}}function findFirstTextNode(node){var walker;if(node)for(walker=new TreeWalker(node,node),node=walker.current();node;node=walker.next())if(3===node.nodeType)return node}function removeCaretContainer(node,move_caret){var child,rng;if(node)rng=selection.getRng(!0),isCaretContainerEmpty(node)?(move_caret!==!1&&(rng.setStartBefore(node),rng.setEndBefore(node)),dom.remove(node)):(child=findFirstTextNode(node),child.nodeValue.charAt(0)===INVISIBLE_CHAR&&(child=child.deleteData(0,1)),dom.remove(node,1)),selection.setRng(rng);else if(node=getParentCaretContainer(selection.getStart()),!node)for(;node=dom.get(caretContainerId);)removeCaretContainer(node,!1)}function applyCaretFormat(){var rng,caretContainer,textNode,offset,bookmark,container,text;rng=selection.getRng(!0),offset=rng.startOffset,container=rng.startContainer,text=container.nodeValue,caretContainer=getParentCaretContainer(selection.getStart()),caretContainer&&(textNode=findFirstTextNode(caretContainer)),text&&offset>0&&offset<text.length&&/\w/.test(text.charAt(offset))&&/\w/.test(text.charAt(offset-1))?(bookmark=selection.getBookmark(),rng.collapse(!0),rng=expandRng(rng,get(name)),rng=rangeUtils.split(rng),apply(name,vars,rng),selection.moveToBookmark(bookmark)):(caretContainer&&textNode.nodeValue===INVISIBLE_CHAR?apply(name,vars,caretContainer):(caretContainer=createCaretContainer(!0),textNode=caretContainer.firstChild,rng.insertNode(caretContainer),offset=1,apply(name,vars,caretContainer)),selection.setCursorLocation(textNode,offset))}function removeCaretFormat(){var container,offset,bookmark,hasContentAfter,node,formatNode,i,caretContainer,rng=selection.getRng(!0),parents=[];for(container=rng.startContainer,offset=rng.startOffset,node=container,3==container.nodeType&&((offset!=container.nodeValue.length||container.nodeValue===INVISIBLE_CHAR)&&(hasContentAfter=!0),node=node.parentNode);node;){if(matchNode(node,name,vars)){formatNode=node;break}node.nextSibling&&(hasContentAfter=!0),parents.push(node),node=node.parentNode}if(formatNode)if(hasContentAfter)bookmark=selection.getBookmark(),rng.collapse(!0),rng=expandRng(rng,get(name),!0),rng=rangeUtils.split(rng),remove(name,vars,rng),selection.moveToBookmark(bookmark);
else{for(caretContainer=createCaretContainer(),node=caretContainer,i=parents.length-1;i>=0;i--)node.appendChild(dom.clone(parents[i],!1)),node=node.firstChild;node.appendChild(dom.doc.createTextNode(INVISIBLE_CHAR)),node=node.firstChild;var block=dom.getParent(formatNode,isTextBlock);block&&dom.isEmpty(block)?formatNode.parentNode.replaceChild(caretContainer,formatNode):dom.insertAfter(caretContainer,formatNode),selection.setCursorLocation(node,1),dom.isEmpty(formatNode)&&dom.remove(formatNode)}}function unmarkBogusCaretParents(){var caretContainer;caretContainer=getParentCaretContainer(selection.getStart()),caretContainer&&!dom.isEmpty(caretContainer)&&walk(caretContainer,function(node){1!=node.nodeType||node.id===caretContainerId||dom.isEmpty(node)||dom.setAttrib(node,"data-mce-bogus",null)},"childNodes")}var caretContainerId="_mce_caret",debug=ed.settings.caret_debug;ed._hasCaretEvents||(markCaretContainersBogus=function(){var i,nodes=[];if(isCaretContainerEmpty(getParentCaretContainer(selection.getStart()),nodes))for(i=nodes.length;i--;)dom.setAttrib(nodes[i],"data-mce-bogus","1")},disableCaretContainer=function(e){var keyCode=e.keyCode;removeCaretContainer(),(8==keyCode||37==keyCode||39==keyCode)&&removeCaretContainer(getParentCaretContainer(selection.getStart())),unmarkBogusCaretParents()},ed.on("SetContent",function(e){e.selection&&unmarkBogusCaretParents()}),ed._hasCaretEvents=!0),"apply"==type?applyCaretFormat():removeCaretFormat()}function moveStart(rng){var isAtEndOfText,walker,node,nodes,tmpNode,container=rng.startContainer,offset=rng.startOffset;if(3==container.nodeType&&offset>=container.nodeValue.length&&(offset=nodeIndex(container),container=container.parentNode,isAtEndOfText=!0),1==container.nodeType)for(nodes=container.childNodes,container=nodes[Math.min(offset,nodes.length-1)],walker=new TreeWalker(container,dom.getParent(container,dom.isBlock)),(offset>nodes.length-1||isAtEndOfText)&&walker.next(),node=walker.current();node;node=walker.next())if(3==node.nodeType&&!isWhiteSpaceNode(node))return tmpNode=dom.create("a",null,INVISIBLE_CHAR),node.parentNode.insertBefore(tmpNode,node),rng.setStart(node,0),selection.setRng(rng),dom.remove(tmpNode),void 0}var formatChangeData,undef,disableCaretContainer,markCaretContainersBogus,formats={},dom=ed.dom,selection=ed.selection,rangeUtils=new RangeUtils(dom),isValid=ed.schema.isValidChild,isBlock=dom.isBlock,forcedRootBlock=ed.settings.forced_root_block,nodeIndex=dom.nodeIndex,INVISIBLE_CHAR="﻿",MCE_ATTR_RE=/^(src|href|style)$/,FALSE=!1,TRUE=!0,getContentEditable=dom.getContentEditable,each=Tools.each,grep=Tools.grep,walk=Tools.walk,extend=Tools.extend;extend(this,{get:get,register:register,apply:apply,remove:remove,toggle:toggle,match:match,matchAll:matchAll,matchNode:matchNode,canApply:canApply,formatChanged:formatChanged}),defaultFormats(),addKeyboardShortcuts(),ed.on("BeforeGetContent",function(){markCaretContainersBogus&&markCaretContainersBogus()}),ed.on("mouseup keydown",function(e){disableCaretContainer&&disableCaretContainer(e)})}}),/**
 * UndoManager.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/UndoManager",["tinymce/Env","tinymce/util/Tools"],function(Env,Tools){var trimContentRegExp,trim=Tools.trim;return trimContentRegExp=new RegExp(["<span[^>]+data-mce-bogus[^>]+>[​﻿]+<\\/span>","<div[^>]+data-mce-bogus[^>]+><\\/div>",'\\s?data-mce-selected="[^"]+"'].join("|"),"gi"),function(editor){function getContent(){return trim(editor.getContent({format:"raw",no_events:1}).replace(trimContentRegExp,""))}function addNonTypingUndoLevel(e){self.typing=!1,self.add({},e)}var self,beforeBookmark,isFirstTypedCharacter,lock,index=0,data=[];return editor.on("init",function(){self.add()}),editor.on("BeforeExecCommand",function(e){var cmd=e.command;"Undo"!=cmd&&"Redo"!=cmd&&"mceRepaint"!=cmd&&self.beforeChange()}),editor.on("ExecCommand",function(e){var cmd=e.command;"Undo"!=cmd&&"Redo"!=cmd&&"mceRepaint"!=cmd&&addNonTypingUndoLevel(e)}),editor.on("ObjectResizeStart",function(){self.beforeChange()}),editor.on("SaveContent ObjectResized blur",addNonTypingUndoLevel),editor.dom.bind(editor.dom.getRoot(),"dragend",addNonTypingUndoLevel),editor.on("KeyUp",function(e){var keyCode=e.keyCode;(keyCode>=33&&36>=keyCode||keyCode>=37&&40>=keyCode||45==keyCode||13==keyCode||e.ctrlKey)&&(addNonTypingUndoLevel(),editor.nodeChanged()),(46==keyCode||8==keyCode||Env.mac&&(91==keyCode||93==keyCode))&&editor.nodeChanged(),isFirstTypedCharacter&&self.typing&&(editor.isDirty()||(editor.isNotDirty=!data[0]||getContent()==data[0].content,editor.isNotDirty||editor.fire("change",{level:data[0],lastLevel:null})),editor.fire("TypingUndo"),isFirstTypedCharacter=!1,editor.nodeChanged())}),editor.on("KeyDown",function(e){var keyCode=e.keyCode;return keyCode>=33&&36>=keyCode||keyCode>=37&&40>=keyCode||45==keyCode?(self.typing&&addNonTypingUndoLevel(e),void 0):((16>keyCode||keyCode>20)&&224!=keyCode&&91!=keyCode&&!self.typing&&(self.beforeChange(),self.typing=!0,self.add({},e),isFirstTypedCharacter=!0),void 0)}),editor.on("MouseDown",function(e){self.typing&&addNonTypingUndoLevel(e)}),editor.addShortcut("ctrl+z","","Undo"),editor.addShortcut("ctrl+y,ctrl+shift+z","","Redo"),editor.on("AddUndo Undo Redo ClearUndos MouseUp",function(e){e.isDefaultPrevented()||editor.nodeChanged()}),self={data:data,typing:!1,beforeChange:function(){lock||(beforeBookmark=editor.selection.getBookmark(2,!0))},add:function(level,event){var i,lastLevel,settings=editor.settings;if(level=level||{},level.content=getContent(),lock||editor.removed)return null;if(editor.fire("BeforeAddUndo",{level:level,originalEvent:event}).isDefaultPrevented())return null;if(lastLevel=data[index],lastLevel&&lastLevel.content==level.content)return null;if(data[index]&&(data[index].beforeBookmark=beforeBookmark),settings.custom_undo_redo_levels&&data.length>settings.custom_undo_redo_levels){for(i=0;i<data.length-1;i++)data[i]=data[i+1];data.length--,index=data.length}level.bookmark=editor.selection.getBookmark(2,!0),index<data.length-1&&(data.length=index+1),data.push(level),index=data.length-1;var args={level:level,lastLevel:lastLevel,originalEvent:event};return editor.fire("AddUndo",args),index>0&&(editor.isNotDirty=!1,editor.fire("change",args)),level},undo:function(){var level;return self.typing&&(self.add(),self.typing=!1),index>0&&(level=data[--index],0===index&&(editor.isNotDirty=!0),editor.setContent(level.content,{format:"raw"}),editor.selection.moveToBookmark(level.beforeBookmark),editor.fire("undo",{level:level})),level},redo:function(){var level;return index<data.length-1&&(level=data[++index],editor.setContent(level.content,{format:"raw"}),editor.selection.moveToBookmark(level.bookmark),editor.fire("redo",{level:level})),level},clear:function(){data=[],index=0,self.typing=!1,editor.fire("ClearUndos")},hasUndo:function(){return index>0||self.typing&&data[0]&&getContent()!=data[0].content},hasRedo:function(){return index<data.length-1&&!this.typing},transact:function(callback){self.beforeChange(),lock=!0,callback(),lock=!1,self.add()}}}}),/**
 * EnterKey.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/EnterKey",["tinymce/dom/TreeWalker","tinymce/dom/RangeUtils","tinymce/Env"],function(TreeWalker,RangeUtils,Env){var isIE=Env.ie&&Env.ie<11;return function(editor){function handleEnterKey(evt){function canSplitBlock(node){return node&&dom.isBlock(node)&&!/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName)&&!/^(fixed|absolute)/i.test(node.style.position)&&"true"!==dom.getContentEditable(node)}function renderBlockOnIE(block){var oldRng;dom.isBlock(block)&&(oldRng=selection.getRng(),block.appendChild(dom.create("span",null," ")),selection.select(block),block.lastChild.outerHTML="",selection.setRng(oldRng))}function trimInlineElementsOnLeftSideOfBlock(block){for(var i,node=block,firstChilds=[];node=node.firstChild;){if(dom.isBlock(node))return;1!=node.nodeType||nonEmptyElementsMap[node.nodeName.toLowerCase()]||firstChilds.push(node)}for(i=firstChilds.length;i--;)node=firstChilds[i],!node.hasChildNodes()||node.firstChild==node.lastChild&&""===node.firstChild.nodeValue?dom.remove(node):"A"==node.nodeName&&" "===(node.innerText||node.textContent)&&dom.remove(node)}function moveToCaretPosition(root){function firstNonWhiteSpaceNodeSibling(node){for(;node;){if(1==node.nodeType||3==node.nodeType&&node.data&&/[\r\n\s]/.test(node.data))return node;node=node.nextSibling}}var walker,node,rng,tempElm,lastNode=root;if(Env.ie&&Env.ie<9&&parentBlock&&parentBlock.firstChild&&parentBlock.firstChild==parentBlock.lastChild&&"BR"==parentBlock.firstChild.tagName&&dom.remove(parentBlock.firstChild),"LI"==root.nodeName){var firstChild=firstNonWhiteSpaceNodeSibling(root.firstChild);firstChild&&/^(UL|OL)$/.test(firstChild.nodeName)&&root.insertBefore(dom.doc.createTextNode(" "),root.firstChild)}if(rng=dom.createRng(),root.hasChildNodes()){for(walker=new TreeWalker(root,root);node=walker.current();){if(3==node.nodeType){rng.setStart(node,0),rng.setEnd(node,0);break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]){rng.setStartBefore(node),rng.setEndBefore(node);break}lastNode=node,node=walker.next()}node||(rng.setStart(lastNode,0),rng.setEnd(lastNode,0))}else"BR"==root.nodeName?root.nextSibling&&dom.isBlock(root.nextSibling)?((!documentMode||9>documentMode)&&(tempElm=dom.create("br"),root.parentNode.insertBefore(tempElm,root)),rng.setStartBefore(root),rng.setEndBefore(root)):(rng.setStartAfter(root),rng.setEndAfter(root)):(rng.setStart(root,0),rng.setEnd(root,0));selection.setRng(rng),dom.remove(tempElm),selection.scrollIntoView(root)}function setForcedBlockAttrs(node){var forcedRootBlockName=settings.forced_root_block;forcedRootBlockName&&forcedRootBlockName.toLowerCase()===node.tagName.toLowerCase()&&dom.setAttribs(node,settings.forced_root_block_attrs)}function createNewBlock(name){var block,clonedNode,caretNode,node=container;if(name||"TABLE"==parentBlockName?(block=dom.create(name||newBlockName),setForcedBlockAttrs(block)):block=parentBlock.cloneNode(!1),caretNode=block,settings.keep_styles!==!1)do if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U|VAR|CITE|DFN|CODE|MARK|Q|SUP|SUB|SAMP)$/.test(node.nodeName)){if("_mce_caret"==node.id)continue;clonedNode=node.cloneNode(!1),dom.setAttrib(clonedNode,"id",""),block.hasChildNodes()?(clonedNode.appendChild(block.firstChild),block.appendChild(clonedNode)):(caretNode=clonedNode,block.appendChild(clonedNode))}while(node=node.parentNode);return isIE||(caretNode.innerHTML='<br data-mce-bogus="1">'),block}function isCaretAtStartOrEndOfBlock(start){var walker,node,name;if(3==container.nodeType&&(start?offset>0:offset<container.nodeValue.length))return!1;if(container.parentNode==parentBlock&&isAfterLastNodeInContainer&&!start)return!0;if(start&&1==container.nodeType&&container==parentBlock.firstChild)return!0;if("TABLE"===container.nodeName||container.previousSibling&&"TABLE"==container.previousSibling.nodeName)return isAfterLastNodeInContainer&&!start||!isAfterLastNodeInContainer&&start;for(walker=new TreeWalker(container,parentBlock),3==container.nodeType&&(start&&0===offset?walker.prev():start||offset!=container.nodeValue.length||walker.next());node=walker.current();){if(1===node.nodeType){if(!node.getAttribute("data-mce-bogus")&&(name=node.nodeName.toLowerCase(),nonEmptyElementsMap[name]&&"br"!==name))return!1}else if(3===node.nodeType&&!/^[ \t\r\n]*$/.test(node.nodeValue))return!1;start?walker.prev():walker.next()}return!0}function wrapSelfAndSiblingsInDefaultBlock(container,offset){var newBlock,parentBlock,startNode,node,next,rootBlockName,blockName=newBlockName||"P";if(parentBlock=dom.getParent(container,dom.isBlock),rootBlockName=editor.getBody().nodeName.toLowerCase(),!parentBlock||!canSplitBlock(parentBlock)){if(parentBlock=parentBlock||editableRoot,!parentBlock.hasChildNodes())return newBlock=dom.create(blockName),setForcedBlockAttrs(newBlock),parentBlock.appendChild(newBlock),rng.setStart(newBlock,0),rng.setEnd(newBlock,0),newBlock;for(node=container;node.parentNode!=parentBlock;)node=node.parentNode;for(;node&&!dom.isBlock(node);)startNode=node,node=node.previousSibling;if(startNode&&schema.isValidChild(rootBlockName,blockName.toLowerCase())){for(newBlock=dom.create(blockName),setForcedBlockAttrs(newBlock),startNode.parentNode.insertBefore(newBlock,startNode),node=startNode;node&&!dom.isBlock(node);)next=node.nextSibling,newBlock.appendChild(node),node=next;rng.setStart(container,offset),rng.setEnd(container,offset)}}return container}function handleEmptyListItem(){function isFirstOrLastLi(first){for(var node=containerBlock[first?"firstChild":"lastChild"];node&&1!=node.nodeType;)node=node[first?"nextSibling":"previousSibling"];return node===parentBlock}function getContainerBlock(){var containerBlockParent=containerBlock.parentNode;return"LI"==containerBlockParent.nodeName?containerBlockParent:containerBlock}var containerBlockParentName=containerBlock.parentNode.nodeName;/^(OL|UL|LI)$/.test(containerBlockParentName)&&(newBlockName="LI"),newBlock=newBlockName?createNewBlock(newBlockName):dom.create("BR"),isFirstOrLastLi(!0)&&isFirstOrLastLi()?"LI"==containerBlockParentName?dom.insertAfter(newBlock,getContainerBlock()):dom.replace(newBlock,containerBlock):isFirstOrLastLi(!0)?"LI"==containerBlockParentName?(dom.insertAfter(newBlock,getContainerBlock()),newBlock.appendChild(dom.doc.createTextNode(" ")),newBlock.appendChild(containerBlock)):containerBlock.parentNode.insertBefore(newBlock,containerBlock):isFirstOrLastLi()?(dom.insertAfter(newBlock,getContainerBlock()),renderBlockOnIE(newBlock)):(containerBlock=getContainerBlock(),tmpRng=rng.cloneRange(),tmpRng.setStartAfter(parentBlock),tmpRng.setEndAfter(containerBlock),fragment=tmpRng.extractContents(),"LI"==newBlockName&&"LI"==fragment.firstChild.nodeName?(newBlock=fragment.firstChild,dom.insertAfter(fragment,containerBlock)):(dom.insertAfter(fragment,containerBlock),dom.insertAfter(newBlock,containerBlock))),dom.remove(parentBlock),moveToCaretPosition(newBlock),undoManager.add()}function hasRightSideContent(){for(var node,walker=new TreeWalker(container,parentBlock);node=walker.next();)if(nonEmptyElementsMap[node.nodeName.toLowerCase()]||node.length>0)return!0}function insertBr(){var brElm,extraBr,marker;container&&3==container.nodeType&&offset>=container.nodeValue.length&&(isIE||hasRightSideContent()||(brElm=dom.create("br"),rng.insertNode(brElm),rng.setStartAfter(brElm),rng.setEndAfter(brElm),extraBr=!0)),brElm=dom.create("br"),rng.insertNode(brElm),isIE&&"PRE"==parentBlockName&&(!documentMode||8>documentMode)&&brElm.parentNode.insertBefore(dom.doc.createTextNode("\r"),brElm),marker=dom.create("span",{},"&nbsp;"),brElm.parentNode.insertBefore(marker,brElm),selection.scrollIntoView(marker),dom.remove(marker),extraBr?(rng.setStartBefore(brElm),rng.setEndBefore(brElm)):(rng.setStartAfter(brElm),rng.setEndAfter(brElm)),selection.setRng(rng),undoManager.add()}function trimLeadingLineBreaks(node){do 3===node.nodeType&&(node.nodeValue=node.nodeValue.replace(/^[\r\n]+/,"")),node=node.firstChild;while(node)}function getEditableRoot(node){var parent,editableRoot,root=dom.getRoot();for(parent=node;parent!==root&&"false"!==dom.getContentEditable(parent);)"true"===dom.getContentEditable(parent)&&(editableRoot=parent),parent=parent.parentNode;return parent!==root?editableRoot:root}function addBrToBlockIfNeeded(block){var lastChild;isIE||(block.normalize(),lastChild=block.lastChild,(!lastChild||/^(left|right)$/gi.test(dom.getStyle(lastChild,"float",!0)))&&dom.add(block,"br"))}var rng,tmpRng,editableRoot,container,offset,parentBlock,documentMode,shiftKey,newBlock,fragment,containerBlock,parentBlockName,containerBlockName,newBlockName,isAfterLastNodeInContainer;if(rng=selection.getRng(!0),!evt.isDefaultPrevented()){if(!rng.collapsed)return editor.execCommand("Delete"),void 0;if(new RangeUtils(dom).normalize(rng),container=rng.startContainer,offset=rng.startOffset,newBlockName=(settings.force_p_newlines?"p":"")||settings.forced_root_block,newBlockName=newBlockName?newBlockName.toUpperCase():"",documentMode=dom.doc.documentMode,shiftKey=evt.shiftKey,1==container.nodeType&&container.hasChildNodes()&&(isAfterLastNodeInContainer=offset>container.childNodes.length-1,container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container,offset=isAfterLastNodeInContainer&&3==container.nodeType?container.nodeValue.length:0),editableRoot=getEditableRoot(container)){if(undoManager.beforeChange(),!dom.isBlock(editableRoot)&&editableRoot!=dom.getRoot())return(!newBlockName||shiftKey)&&insertBr(),void 0;if((newBlockName&&!shiftKey||!newBlockName&&shiftKey)&&(container=wrapSelfAndSiblingsInDefaultBlock(container,offset)),parentBlock=dom.getParent(container,dom.isBlock),containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null,parentBlockName=parentBlock?parentBlock.nodeName.toUpperCase():"",containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"","LI"!=containerBlockName||evt.ctrlKey||(parentBlock=containerBlock,parentBlockName=containerBlockName),"LI"==parentBlockName){if(!newBlockName&&shiftKey)return insertBr(),void 0;if(dom.isEmpty(parentBlock))return handleEmptyListItem(),void 0}if("PRE"==parentBlockName&&settings.br_in_pre!==!1){if(!shiftKey)return insertBr(),void 0}else if(!newBlockName&&!shiftKey&&"LI"!=parentBlockName||newBlockName&&shiftKey)return insertBr(),void 0;newBlockName&&parentBlock===editor.getBody()||(newBlockName=newBlockName||"P",isCaretAtStartOrEndOfBlock()?(newBlock=/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName)&&"HGROUP"!=containerBlockName?createNewBlock(newBlockName):createNewBlock(),settings.end_container_on_empty_block&&canSplitBlock(containerBlock)&&dom.isEmpty(parentBlock)?newBlock=dom.split(containerBlock,parentBlock):dom.insertAfter(newBlock,parentBlock),moveToCaretPosition(newBlock)):isCaretAtStartOrEndOfBlock(!0)?(newBlock=parentBlock.parentNode.insertBefore(createNewBlock(),parentBlock),renderBlockOnIE(newBlock),moveToCaretPosition(parentBlock)):(tmpRng=rng.cloneRange(),tmpRng.setEndAfter(parentBlock),fragment=tmpRng.extractContents(),trimLeadingLineBreaks(fragment),newBlock=fragment.firstChild,dom.insertAfter(fragment,parentBlock),trimInlineElementsOnLeftSideOfBlock(newBlock),addBrToBlockIfNeeded(parentBlock),moveToCaretPosition(newBlock)),dom.setAttrib(newBlock,"id",""),editor.fire("NewBlock",{newBlock:newBlock}),undoManager.add())}}}var dom=editor.dom,selection=editor.selection,settings=editor.settings,undoManager=editor.undoManager,schema=editor.schema,nonEmptyElementsMap=schema.getNonEmptyElements();editor.on("keydown",function(evt){13==evt.keyCode&&handleEnterKey(evt)!==!1&&evt.preventDefault()})}}),/**
 * ForceBlocks.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ForceBlocks",[],function(){return function(editor){function addRootBlocks(){var rng,startContainer,startOffset,endContainer,endOffset,rootBlockNode,tempNode,wrapped,restoreSelection,tmpRng,rootNodeName,forcedRootBlock,node=selection.getStart(),rootNode=editor.getBody(),offset=-16777215;if(forcedRootBlock=settings.forced_root_block,node&&1===node.nodeType&&forcedRootBlock){for(;node&&node!=rootNode;){if(blockElements[node.nodeName])return;node=node.parentNode}if(rng=selection.getRng(),rng.setStart){startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;try{restoreSelection=editor.getDoc().activeElement===rootNode}catch(ex){}}else rng.item&&(node=rng.item(0),rng=editor.getDoc().body.createTextRange(),rng.moveToElementText(node)),restoreSelection=rng.parentElement().ownerDocument===editor.getDoc(),tmpRng=rng.duplicate(),tmpRng.collapse(!0),startOffset=-1*tmpRng.move("character",offset),tmpRng.collapsed||(tmpRng=rng.duplicate(),tmpRng.collapse(!1),endOffset=-1*tmpRng.move("character",offset)-startOffset);for(node=rootNode.firstChild,rootNodeName=rootNode.nodeName.toLowerCase();node;)if((3===node.nodeType||1==node.nodeType&&!blockElements[node.nodeName])&&schema.isValidChild(rootNodeName,forcedRootBlock.toLowerCase())){if(3===node.nodeType&&0===node.nodeValue.length){tempNode=node,node=node.nextSibling,dom.remove(tempNode);continue}rootBlockNode||(rootBlockNode=dom.create(forcedRootBlock,editor.settings.forced_root_block_attrs),node.parentNode.insertBefore(rootBlockNode,node),wrapped=!0),tempNode=node,node=node.nextSibling,rootBlockNode.appendChild(tempNode)}else rootBlockNode=null,node=node.nextSibling;if(wrapped&&restoreSelection){if(rng.setStart)rng.setStart(startContainer,startOffset),rng.setEnd(endContainer,endOffset),selection.setRng(rng);else try{rng=editor.getDoc().body.createTextRange(),rng.moveToElementText(rootNode),rng.collapse(!0),rng.moveStart("character",startOffset),endOffset>0&&rng.moveEnd("character",endOffset),rng.select()}catch(ex){}editor.nodeChanged()}}}var settings=editor.settings,dom=editor.dom,selection=editor.selection,schema=editor.schema,blockElements=schema.getBlockElements();settings.forced_root_block&&editor.on("NodeChange",addRootBlocks)}}),/**
 * EditorCommands.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/EditorCommands",["tinymce/html/Serializer","tinymce/Env","tinymce/util/Tools"],function(Serializer,Env,Tools){var each=Tools.each,extend=Tools.extend,map=Tools.map,inArray=Tools.inArray,explode=Tools.explode,isGecko=Env.gecko,isIE=Env.ie,TRUE=!0,FALSE=!1;return function(editor){function execCommand(command,ui,value){var func;return command=command.toLowerCase(),(func=commands.exec[command])?(func(command,ui,value),TRUE):FALSE}function queryCommandState(command){var func;return command=command.toLowerCase(),(func=commands.state[command])?func(command):-1}function queryCommandValue(command){var func;return command=command.toLowerCase(),(func=commands.value[command])?func(command):FALSE}function addCommands(command_list,type){type=type||"exec",each(command_list,function(callback,command){each(command.toLowerCase().split(","),function(command){commands[type][command]=callback})})}function execNativeCommand(command,ui,value){return ui===undefined&&(ui=FALSE),value===undefined&&(value=null),editor.getDoc().execCommand(command,ui,value)}function isFormatMatch(name){return formatter.match(name)}function toggleFormat(name,value){formatter.toggle(name,value?{value:value}:undefined),editor.nodeChanged()}function storeSelection(type){bookmark=selection.getBookmark(type)}function restoreSelection(){selection.moveToBookmark(bookmark)}var bookmark,dom=editor.dom,selection=editor.selection,commands={state:{},exec:{},value:{}},settings=editor.settings,formatter=editor.formatter;extend(this,{execCommand:execCommand,queryCommandState:queryCommandState,queryCommandValue:queryCommandValue,addCommands:addCommands}),addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){editor.undoManager.add()},"Cut,Copy,Paste":function(command){var failed,doc=editor.getDoc();try{execNativeCommand(command)}catch(ex){failed=TRUE}if(failed||!doc.queryCommandSupported(command)){var msg=editor.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");Env.mac&&(msg=msg.replace(/Ctrl\+/g,"⌘+")),editor.windowManager.alert(msg)}},unlink:function(){if(selection.isCollapsed()){var elm=selection.getNode();return"A"==elm.tagName&&editor.dom.remove(elm,!0),void 0}formatter.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(command){var align=command.substring(7);"full"==align&&(align="justify"),each("left,center,right,justify".split(","),function(name){align!=name&&formatter.remove("align"+name)}),toggleFormat("align"+align),execCommand("mceRepaint")},"InsertUnorderedList,InsertOrderedList":function(command){var listElm,listParent;execNativeCommand(command),listElm=dom.getParent(selection.getNode(),"ol,ul"),listElm&&(listParent=listElm.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)&&(storeSelection(),dom.split(listParent,listElm),restoreSelection()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){toggleFormat(command)},"ForeColor,HiliteColor,FontName":function(command,ui,value){toggleFormat(command,value)},FontSize:function(command,ui,value){var fontClasses,fontSizes;value>=1&&7>=value&&(fontSizes=explode(settings.font_size_style_values),fontClasses=explode(settings.font_size_classes),value=fontClasses?fontClasses[value-1]||value:fontSizes[value-1]||value),toggleFormat(command,value)},RemoveFormat:function(command){formatter.remove(command)},mceBlockQuote:function(){toggleFormat("blockquote")},FormatBlock:function(command,ui,value){return toggleFormat(value||"p")},mceCleanup:function(){var bookmark=selection.getBookmark();editor.setContent(editor.getContent({cleanup:TRUE}),{cleanup:TRUE}),selection.moveToBookmark(bookmark)},mceRemoveNode:function(command,ui,value){var node=value||selection.getNode();node!=editor.getBody()&&(storeSelection(),editor.dom.remove(node,TRUE),restoreSelection())},mceSelectNodeDepth:function(command,ui,value){var counter=0;dom.getParent(selection.getNode(),function(node){return 1==node.nodeType&&counter++==value?(selection.select(node),FALSE):void 0},editor.getBody())},mceSelectNode:function(command,ui,value){selection.select(value)},mceInsertContent:function(command,ui,value){function trimOrPaddLeftRight(html){function hasSiblingText(siblingName){return container[siblingName]&&3==container[siblingName].nodeType}var rng,container,offset;return rng=selection.getRng(!0),container=rng.startContainer,offset=rng.startOffset,3==container.nodeType&&(offset>0?html=html.replace(/^&nbsp;/," "):hasSiblingText("previousSibling")||(html=html.replace(/^ /,"&nbsp;")),offset<container.length?html=html.replace(/&nbsp;(<br>|)$/," "):hasSiblingText("nextSibling")||(html=html.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;"))),html}var parser,serializer,parentNode,rootNode,fragment,args,marker,rng,node,node2,bookmarkHtml;/^ | $/.test(value)&&(value=trimOrPaddLeftRight(value)),parser=editor.parser,serializer=new Serializer({},editor.schema),bookmarkHtml='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#200B;</span>',args={content:value,format:"html",selection:!0},editor.fire("BeforeSetContent",args),value=args.content,-1==value.indexOf("{$caret}")&&(value+="{$caret}"),value=value.replace(/\{\$caret\}/,bookmarkHtml),rng=selection.getRng();var caretElement=rng.startContainer||(rng.parentElement?rng.parentElement():null),body=editor.getBody();caretElement===body&&selection.isCollapsed()&&dom.isBlock(body.firstChild)&&dom.isEmpty(body.firstChild)&&(rng=dom.createRng(),rng.setStart(body.firstChild,0),rng.setEnd(body.firstChild,0),selection.setRng(rng)),selection.isCollapsed()||editor.getDoc().execCommand("Delete",!1,null),parentNode=selection.getNode();var parserArgs={context:parentNode.nodeName.toLowerCase()};if(fragment=parser.parse(value,parserArgs),node=fragment.lastChild,"mce_marker"==node.attr("id"))for(marker=node,node=node.prev;node;node=node.walk(!0))if(3==node.type||!dom.isBlock(node.name)){node.parent.insert(marker,node,"br"===node.name);break}if(parserArgs.invalid){for(selection.setContent(bookmarkHtml),parentNode=selection.getNode(),rootNode=editor.getBody(),9==parentNode.nodeType?parentNode=node=rootNode:node=parentNode;node!==rootNode;)parentNode=node,node=node.parentNode;value=parentNode==rootNode?rootNode.innerHTML:dom.getOuterHTML(parentNode),value=serializer.serialize(parser.parse(value.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return serializer.serialize(fragment)}))),parentNode==rootNode?dom.setHTML(rootNode,value):dom.setOuterHTML(parentNode,value)}else value=serializer.serialize(fragment),node=parentNode.firstChild,node2=parentNode.lastChild,!node||node===node2&&"BR"===node.nodeName?dom.setHTML(parentNode,value):selection.setContent(value);marker=dom.get("mce_marker"),selection.scrollIntoView(marker),rng=dom.createRng(),node=marker.previousSibling,node&&3==node.nodeType?(rng.setStart(node,node.nodeValue.length),isIE||(node2=marker.nextSibling,node2&&3==node2.nodeType&&(node.appendData(node2.data),node2.parentNode.removeChild(node2)))):(rng.setStartBefore(marker),rng.setEndBefore(marker)),dom.remove(marker),selection.setRng(rng),editor.fire("SetContent",args),editor.addVisual()},mceInsertRawHTML:function(command,ui,value){selection.setContent("tiny_mce_marker"),editor.setContent(editor.getContent().replace(/tiny_mce_marker/g,function(){return value}))},mceToggleFormat:function(command,ui,value){toggleFormat(value)},mceSetContent:function(command,ui,value){editor.setContent(value)},"Indent,Outdent":function(command){var intentValue,indentUnit,value;intentValue=settings.indentation,indentUnit=/[a-z%]+$/i.exec(intentValue),intentValue=parseInt(intentValue,10),queryCommandState("InsertUnorderedList")||queryCommandState("InsertOrderedList")?execNativeCommand(command):(settings.forced_root_block||dom.getParent(selection.getNode(),dom.isBlock)||formatter.apply("div"),each(selection.getSelectedBlocks(),function(element){if("LI"!=element.nodeName){var indentStyleName=editor.getParam("indent_use_margin",!1)?"margin":"padding";indentStyleName+="rtl"==dom.getStyle(element,"direction",!0)?"Right":"Left","outdent"==command?(value=Math.max(0,parseInt(element.style[indentStyleName]||0,10)-intentValue),dom.setStyle(element,indentStyleName,value?value+indentUnit:"")):(value=parseInt(element.style[indentStyleName]||0,10)+intentValue+indentUnit,dom.setStyle(element,indentStyleName,value))}}))},mceRepaint:function(){if(isGecko)try{storeSelection(TRUE),selection.getSel()&&selection.getSel().selectAllChildren(editor.getBody()),selection.collapse(TRUE),restoreSelection()}catch(ex){}},InsertHorizontalRule:function(){editor.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){editor.hasVisual=!editor.hasVisual,editor.addVisual()},mceReplaceContent:function(command,ui,value){editor.execCommand("mceInsertContent",!1,value.replace(/\{\$selection\}/g,selection.getContent({format:"text"})))},mceInsertLink:function(command,ui,value){var anchor;"string"==typeof value&&(value={href:value}),anchor=dom.getParent(selection.getNode(),"a"),value.href=value.href.replace(" ","%20"),anchor&&value.href||formatter.remove("link"),value.href&&formatter.apply("link",value,anchor)},selectAll:function(){var rng,root=dom.getRoot();selection.getRng().setStart?(rng=dom.createRng(),rng.setStart(root,0),rng.setEnd(root,root.childNodes.length),selection.setRng(rng)):(rng=selection.getRng(),rng.item||(rng.moveToElementText(root),rng.select()))},"delete":function(){execNativeCommand("Delete");var body=editor.getBody();dom.isEmpty(body)&&(editor.setContent(""),body.firstChild&&dom.isBlock(body.firstChild)?editor.selection.setCursorLocation(body.firstChild,0):editor.selection.setCursorLocation(body,0))},mceNewDocument:function(){editor.setContent("")}}),addCommands({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(command){var name="align"+command.substring(7),nodes=selection.isCollapsed()?[dom.getParent(selection.getNode(),dom.isBlock)]:selection.getSelectedBlocks(),matches=map(nodes,function(node){return!!formatter.matchNode(node,name)});return-1!==inArray(matches,TRUE)},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){return isFormatMatch(command)},mceBlockQuote:function(){return isFormatMatch("blockquote")},Outdent:function(){var node;if(settings.inline_styles){if((node=dom.getParent(selection.getStart(),dom.isBlock))&&parseInt(node.style.paddingLeft,10)>0)return TRUE;if((node=dom.getParent(selection.getEnd(),dom.isBlock))&&parseInt(node.style.paddingLeft,10)>0)return TRUE}return queryCommandState("InsertUnorderedList")||queryCommandState("InsertOrderedList")||!settings.inline_styles&&!!dom.getParent(selection.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(command){var list=dom.getParent(selection.getNode(),"ul,ol");return list&&("insertunorderedlist"===command&&"UL"===list.tagName||"insertorderedlist"===command&&"OL"===list.tagName)}},"state"),addCommands({"FontSize,FontName":function(command){var parent,value=0;return(parent=dom.getParent(selection.getNode(),"span"))&&(value="fontsize"==command?parent.style.fontSize:parent.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase()),value}},"value"),addCommands({Undo:function(){editor.undoManager.undo()},Redo:function(){editor.undoManager.redo()}})}}),/**
 * URI.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/util/URI",["tinymce/util/Tools"],function(Tools){function URI(url,settings){var baseUri,base_url,self=this;if(url=trim(url),settings=self.settings=settings||{},/^([\w\-]+):([^\/]{2})/i.test(url)||/^\s*#/.test(url))return self.source=url,void 0;var isProtocolRelative=0===url.indexOf("//");0!==url.indexOf("/")||isProtocolRelative||(url=(settings.base_uri?settings.base_uri.protocol||"http":"http")+"://mce_host"+url),/^[\w\-]*:?\/\//.test(url)||(base_url=settings.base_uri?settings.base_uri.path:new URI(location.href).directory,url=""===settings.base_uri.protocol?"//mce_host"+self.toAbsPath(base_url,url):(settings.base_uri&&settings.base_uri.protocol||"http")+"://mce_host"+self.toAbsPath(base_url,url)),url=url.replace(/@@/g,"(mce_at)"),url=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(url),each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(v,i){var part=url[i];part&&(part=part.replace(/\(mce_at\)/g,"@@")),self[v]=part}),baseUri=settings.base_uri,baseUri&&(self.protocol||(self.protocol=baseUri.protocol),self.userInfo||(self.userInfo=baseUri.userInfo),self.port||"mce_host"!==self.host||(self.port=baseUri.port),self.host&&"mce_host"!==self.host||(self.host=baseUri.host),self.source=""),isProtocolRelative&&(self.protocol="")}var each=Tools.each,trim=Tools.trim;return URI.prototype={setPath:function(path){var self=this;path=/^(.*?)\/?(\w+)?$/.exec(path),self.path=path[0],self.directory=path[1],self.file=path[2],self.source="",self.getURI()},toRelative:function(uri){var output,self=this;if("./"===uri)return uri;if(uri=new URI(uri,{base_uri:self}),"mce_host"!=uri.host&&self.host!=uri.host&&uri.host||self.port!=uri.port||self.protocol!=uri.protocol&&""!==uri.protocol)return uri.getURI();var tu=self.getURI(),uu=uri.getURI();return tu==uu||"/"==tu.charAt(tu.length-1)&&tu.substr(0,tu.length-1)==uu?tu:(output=self.toRelPath(self.path,uri.path),uri.query&&(output+="?"+uri.query),uri.anchor&&(output+="#"+uri.anchor),output)},toAbsolute:function(uri,noHost){return uri=new URI(uri,{base_uri:this}),uri.getURI(this.host==uri.host&&this.protocol==uri.protocol?noHost:0)},toRelPath:function(base,path){var items,i,l,breakPoint=0,out="";if(base=base.substring(0,base.lastIndexOf("/")),base=base.split("/"),items=path.split("/"),base.length>=items.length)for(i=0,l=base.length;l>i;i++)if(i>=items.length||base[i]!=items[i]){breakPoint=i+1;break}if(base.length<items.length)for(i=0,l=items.length;l>i;i++)if(i>=base.length||base[i]!=items[i]){breakPoint=i+1;break}if(1===breakPoint)return path;for(i=0,l=base.length-(breakPoint-1);l>i;i++)out+="../";for(i=breakPoint-1,l=items.length;l>i;i++)out+=i!=breakPoint-1?"/"+items[i]:items[i];return out},toAbsPath:function(base,path){var i,tr,outPath,nb=0,o=[];for(tr=/\/$/.test(path)?"/":"",base=base.split("/"),path=path.split("/"),each(base,function(k){k&&o.push(k)}),base=o,i=path.length-1,o=[];i>=0;i--)0!==path[i].length&&"."!==path[i]&&(".."!==path[i]?nb>0?nb--:o.push(path[i]):nb++);return i=base.length-nb,outPath=0>=i?o.reverse().join("/"):base.slice(0,i).join("/")+"/"+o.reverse().join("/"),0!==outPath.indexOf("/")&&(outPath="/"+outPath),tr&&outPath.lastIndexOf("/")!==outPath.length-1&&(outPath+=tr),outPath},getURI:function(noProtoHost){var s,self=this;return(!self.source||noProtoHost)&&(s="",noProtoHost||(s+=self.protocol?self.protocol+"://":"//",self.userInfo&&(s+=self.userInfo+"@"),self.host&&(s+=self.host),self.port&&(s+=":"+self.port)),self.path&&(s+=self.path),self.query&&(s+="?"+self.query),self.anchor&&(s+="#"+self.anchor),self.source=s),self.source}},URI}),/**
 * Class.js
 *
 * Copyright 2003-2012, Moxiecode Systems AB, All rights reserved.
 */
define("tinymce/util/Class",["tinymce/util/Tools"],function(Tools){function Class(){}var extendClass,initializing,each=Tools.each,extend=Tools.extend;return Class.extend=extendClass=function(prop){function Class(){var i,mixins,mixin,self;if(!initializing&&(self=this,self.init&&self.init.apply(self,arguments),mixins=self.Mixins))for(i=mixins.length;i--;)mixin=mixins[i],mixin.init&&mixin.init.apply(self,arguments)}function dummy(){return this}function createMethod(name,fn){return function(){var ret,self=this,tmp=self._super;return self._super=_super[name],ret=fn.apply(self,arguments),self._super=tmp,ret}}var prototype,name,member,Self=this,_super=Self.prototype;initializing=!0,prototype=new Self,initializing=!1,prop.Mixins&&(each(prop.Mixins,function(mixin){mixin=mixin;for(var name in mixin)"init"!==name&&(prop[name]=mixin[name])}),_super.Mixins&&(prop.Mixins=_super.Mixins.concat(prop.Mixins))),prop.Methods&&each(prop.Methods.split(","),function(name){prop[name]=dummy}),prop.Properties&&each(prop.Properties.split(","),function(name){var fieldName="_"+name;prop[name]=function(value){var undef,self=this;return value!==undef?(self[fieldName]=value,self):self[fieldName]}}),prop.Statics&&each(prop.Statics,function(func,name){Class[name]=func}),prop.Defaults&&_super.Defaults&&(prop.Defaults=extend({},_super.Defaults,prop.Defaults));for(name in prop)member=prop[name],prototype[name]="function"==typeof member&&_super[name]?createMethod(name,member):member;return Class.prototype=prototype,Class.constructor=Class,Class.extend=extendClass,Class},Class}),/**
 * Selector.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Selector",["tinymce/util/Class"],function(Class){function unique(array){for(var item,uniqueItems=[],i=array.length;i--;)item=array[i],item.__checked||(uniqueItems.push(item),item.__checked=1);for(i=uniqueItems.length;i--;)delete uniqueItems[i].__checked;return uniqueItems}var Collection,expression=/^([\w\\*]+)?(?:#([\w\\]+))?(?:\.([\w\\\.]+))?(?:\[\@?([\w\\]+)([\^\$\*!~]?=)([\w\\]+)\])?(?:\:(.+))?/i,chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,whiteSpace=/^\s*|\s*$/g,Selector=Class.extend({init:function(selector){function compileNameFilter(name){return name?(name=name.toLowerCase(),function(item){return"*"===name||item.type===name}):void 0}function compileIdFilter(id){return id?function(item){return item._name===id}:void 0}function compileClassesFilter(classes){return classes?(classes=classes.split("."),function(item){for(var i=classes.length;i--;)if(!item.hasClass(classes[i]))return!1;return!0}):void 0}function compileAttrFilter(name,cmp,check){return name?function(item){var value=item[name]?item[name]():"";return cmp?"="===cmp?value===check:"*="===cmp?value.indexOf(check)>=0:"~="===cmp?(" "+value+" ").indexOf(" "+check+" ")>=0:"!="===cmp?value!=check:"^="===cmp?0===value.indexOf(check):"$="===cmp?value.substr(value.length-check.length)===check:!1:!!check}:void 0}function compilePsuedoFilter(name){var notSelectors;return name?(name=/(?:not\((.+)\))|(.+)/i.exec(name),name[1]?(notSelectors=parseChunks(name[1],[]),function(item){return!match(item,notSelectors)}):(name=name[2],function(item,index,length){return"first"===name?0===index:"last"===name?index===length-1:"even"===name?0===index%2:"odd"===name?1===index%2:item[name]?item[name]():!1})):void 0}function compile(selector,filters,direct){function add(filter){filter&&filters.push(filter)}var parts;return parts=expression.exec(selector.replace(whiteSpace,"")),add(compileNameFilter(parts[1])),add(compileIdFilter(parts[2])),add(compileClassesFilter(parts[3])),add(compileAttrFilter(parts[4],parts[5],parts[6])),add(compilePsuedoFilter(parts[7])),filters.psuedo=!!parts[7],filters.direct=direct,filters}function parseChunks(selector,selectors){var extra,matches,i,parts=[];do if(chunker.exec(""),matches=chunker.exec(selector),matches&&(selector=matches[3],parts.push(matches[1]),matches[2])){extra=matches[3];break}while(matches);for(extra&&parseChunks(extra,selectors),selector=[],i=0;i<parts.length;i++)">"!=parts[i]&&selector.push(compile(parts[i],[],">"===parts[i-1]));return selectors.push(selector),selectors}var match=this.match;this._selectors=parseChunks(selector,[])},match:function(control,selectors){var i,l,si,sl,selector,fi,fl,filters,index,length,siblings,count,item;for(selectors=selectors||this._selectors,i=0,l=selectors.length;l>i;i++){for(selector=selectors[i],sl=selector.length,item=control,count=0,si=sl-1;si>=0;si--)for(filters=selector[si];item;){if(filters.psuedo)for(siblings=item.parent().items(),index=length=siblings.length;index--&&siblings[index]!==item;);for(fi=0,fl=filters.length;fl>fi;fi++)if(!filters[fi](item,index,length)){fi=fl+1;break}if(fi===fl){count++;break}if(si===sl-1)break;item=item.parent()}if(count===sl)return!0}return!1},find:function(container){function collect(items,selector,index){var i,l,fi,fl,item,filters=selector[index];for(i=0,l=items.length;l>i;i++){for(item=items[i],fi=0,fl=filters.length;fl>fi;fi++)if(!filters[fi](item,i,l)){fi=fl+1;break}if(fi===fl)index==selector.length-1?matches.push(item):item.items&&collect(item.items(),selector,index+1);else if(filters.direct)return;item.items&&collect(item.items(),selector,index)}}var i,l,matches=[],selectors=this._selectors;if(container.items){for(i=0,l=selectors.length;l>i;i++)collect(container.items(),selectors[i],0);l>1&&(matches=unique(matches))}return Collection||(Collection=Selector.Collection),new Collection(matches)}});return Selector}),/**
 * Collection.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Collection",["tinymce/util/Tools","tinymce/ui/Selector","tinymce/util/Class"],function(Tools,Selector,Class){var Collection,proto,push=Array.prototype.push,slice=Array.prototype.slice;return proto={length:0,init:function(items){items&&this.add(items)},add:function(items){var self=this;return Tools.isArray(items)?push.apply(self,items):items instanceof Collection?self.add(items.toArray()):push.call(self,items),self},set:function(items){var i,self=this,len=self.length;for(self.length=0,self.add(items),i=self.length;len>i;i++)delete self[i];return self},filter:function(selector){var i,l,item,match,self=this,matches=[];for("string"==typeof selector?(selector=new Selector(selector),match=function(item){return selector.match(item)}):match=selector,i=0,l=self.length;l>i;i++)item=self[i],match(item)&&matches.push(item);return new Collection(matches)},slice:function(){return new Collection(slice.apply(this,arguments))},eq:function(index){return-1===index?this.slice(index):this.slice(index,+index+1)},each:function(callback){return Tools.each(this,callback),this},toArray:function(){return Tools.toArray(this)},indexOf:function(ctrl){for(var self=this,i=self.length;i--&&self[i]!==ctrl;);return i},reverse:function(){return new Collection(Tools.toArray(this).reverse())},hasClass:function(cls){return this[0]?this[0].hasClass(cls):!1},prop:function(name,value){var undef,item,self=this;return value!==undef?(self.each(function(item){item[name]&&item[name](value)}),self):(item=self[0],item&&item[name]?item[name]():void 0)},exec:function(name){var self=this,args=Tools.toArray(arguments).slice(1);return self.each(function(item){item[name]&&item[name].apply(item,args)}),self},remove:function(){for(var i=this.length;i--;)this[i].remove();return this}},Tools.each("fire on off show hide addClass removeClass append prepend before after reflow".split(" "),function(name){proto[name]=function(){var args=Tools.toArray(arguments);return this.each(function(ctrl){name in ctrl&&ctrl[name].apply(ctrl,args)}),this}}),Tools.each("text name disabled active selected checked visible parent value data".split(" "),function(name){proto[name]=function(value){return this.prop(name,value)}}),Collection=Class.extend(proto),Selector.Collection=Collection,Collection}),/**
 * DOMUtils.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/DomUtils",["tinymce/util/Tools","tinymce/dom/DOMUtils"],function(Tools,DOMUtils){return{id:function(){return DOMUtils.DOM.uniqueId()},createFragment:function(html){return DOMUtils.DOM.createFragment(html)},getWindowSize:function(){return DOMUtils.DOM.getViewPort()},getSize:function(elm){var width,height;if(elm.getBoundingClientRect){var rect=elm.getBoundingClientRect();width=Math.max(rect.width||rect.right-rect.left,elm.offsetWidth),height=Math.max(rect.height||rect.bottom-rect.bottom,elm.offsetHeight)}else width=elm.offsetWidth,height=elm.offsetHeight;return{width:width,height:height}},getPos:function(elm,root){return DOMUtils.DOM.getPos(elm,root)},getViewPort:function(win){return DOMUtils.DOM.getViewPort(win)},get:function(id){return document.getElementById(id)},addClass:function(elm,cls){return DOMUtils.DOM.addClass(elm,cls)},removeClass:function(elm,cls){return DOMUtils.DOM.removeClass(elm,cls)},hasClass:function(elm,cls){return DOMUtils.DOM.hasClass(elm,cls)},toggleClass:function(elm,cls,state){return DOMUtils.DOM.toggleClass(elm,cls,state)},css:function(elm,name,value){return DOMUtils.DOM.setStyle(elm,name,value)},on:function(target,name,callback,scope){return DOMUtils.DOM.bind(target,name,callback,scope)},off:function(target,name,callback){return DOMUtils.DOM.unbind(target,name,callback)},fire:function(target,name,args){return DOMUtils.DOM.fire(target,name,args)},innerHtml:function(elm,html){DOMUtils.DOM.setHTML(elm,html)}}}),/**
 * Control.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Control",["tinymce/util/Class","tinymce/util/Tools","tinymce/ui/Collection","tinymce/ui/DomUtils"],function(Class,Tools,Collection,DomUtils){var nativeEvents=Tools.makeMap("focusin focusout scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave wheel keydown keypress keyup contextmenu"," "),elementIdCache={},hasMouseWheelEventSupport="onmousewheel"in document,hasWheelEventSupport=!1,Control=Class.extend({Statics:{elementIdCache:elementIdCache},isRtl:function(){return Control.rtl},classPrefix:"mce-",init:function(settings){var classes,i,self=this;if(self.settings=settings=Tools.extend({},self.Defaults,settings),self._id=settings.id||DomUtils.id(),self._text=self._name="",self._width=self._height=0,self._aria={role:settings.role},classes=settings.classes)for(classes=classes.split(" "),classes.map={},i=classes.length;i--;)classes.map[classes[i]]=!0;self._classes=classes||[],self.visible(!0),Tools.each("title text width height name classes visible disabled active value".split(" "),function(name){var undef,value=settings[name];value!==undef?self[name](value):self["_"+name]===undef&&(self["_"+name]=!1)}),self.on("click",function(){return self.disabled()?!1:void 0}),settings.classes&&Tools.each(settings.classes.split(" "),function(cls){self.addClass(cls)}),self.settings=settings,self._borderBox=self.parseBox(settings.border),self._paddingBox=self.parseBox(settings.padding),self._marginBox=self.parseBox(settings.margin),settings.hidden&&self.hide()},Properties:"parent,title,text,width,height,disabled,active,name,value",Methods:"renderHtml",getContainerElm:function(){return document.body},getParentCtrl:function(elm){for(var ctrl,lookup=this.getRoot().controlIdLookup;elm&&lookup&&!(ctrl=lookup[elm.id]);)elm=elm.parentNode;return ctrl},parseBox:function(value){var len,radix=10;if(value)return"number"==typeof value?(value=value||0,{top:value,left:value,bottom:value,right:value}):(value=value.split(" "),len=value.length,1===len?value[1]=value[2]=value[3]=value[0]:2===len?(value[2]=value[0],value[3]=value[1]):3===len&&(value[3]=value[1]),{top:parseInt(value[0],radix)||0,right:parseInt(value[1],radix)||0,bottom:parseInt(value[2],radix)||0,left:parseInt(value[3],radix)||0})},borderBox:function(){return this._borderBox},paddingBox:function(){return this._paddingBox},marginBox:function(){return this._marginBox},measureBox:function(elm,prefix){function getStyle(name){var defaultView=document.defaultView;return defaultView?(name=name.replace(/[A-Z]/g,function(a){return"-"+a}),defaultView.getComputedStyle(elm,null).getPropertyValue(name)):elm.currentStyle[name]}function getSide(name){var val=parseFloat(getStyle(name),10);return isNaN(val)?0:val}return{top:getSide(prefix+"TopWidth"),right:getSide(prefix+"RightWidth"),bottom:getSide(prefix+"BottomWidth"),left:getSide(prefix+"LeftWidth")}},initLayoutRect:function(){var borderBox,layoutRect,width,height,minWidth,minHeight,autoResize,startMinWidth,startMinHeight,initialSize,self=this,settings=self.settings,elm=self.getEl();borderBox=self._borderBox=self._borderBox||self.measureBox(elm,"border"),self._paddingBox=self._paddingBox||self.measureBox(elm,"padding"),self._marginBox=self._marginBox||self.measureBox(elm,"margin"),initialSize=DomUtils.getSize(elm),startMinWidth=settings.minWidth,startMinHeight=settings.minHeight,minWidth=startMinWidth||initialSize.width,minHeight=startMinHeight||initialSize.height,width=settings.width,height=settings.height,autoResize=settings.autoResize,autoResize="undefined"!=typeof autoResize?autoResize:!width&&!height,width=width||minWidth,height=height||minHeight;var deltaW=borderBox.left+borderBox.right,deltaH=borderBox.top+borderBox.bottom,maxW=settings.maxWidth||65535,maxH=settings.maxHeight||65535;return self._layoutRect=layoutRect={x:settings.x||0,y:settings.y||0,w:width,h:height,deltaW:deltaW,deltaH:deltaH,contentW:width-deltaW,contentH:height-deltaH,innerW:width-deltaW,innerH:height-deltaH,startMinWidth:startMinWidth||0,startMinHeight:startMinHeight||0,minW:Math.min(minWidth,maxW),minH:Math.min(minHeight,maxH),maxW:maxW,maxH:maxH,autoResize:autoResize,scrollW:0},self._lastLayoutRect={},layoutRect},layoutRect:function(newRect){var lastLayoutRect,size,deltaWidth,deltaHeight,undef,repaintControls,self=this,curRect=self._layoutRect;return curRect||(curRect=self.initLayoutRect()),newRect?(deltaWidth=curRect.deltaW,deltaHeight=curRect.deltaH,newRect.x!==undef&&(curRect.x=newRect.x),newRect.y!==undef&&(curRect.y=newRect.y),newRect.minW!==undef&&(curRect.minW=newRect.minW),newRect.minH!==undef&&(curRect.minH=newRect.minH),size=newRect.w,size!==undef&&(size=size<curRect.minW?curRect.minW:size,size=size>curRect.maxW?curRect.maxW:size,curRect.w=size,curRect.innerW=size-deltaWidth),size=newRect.h,size!==undef&&(size=size<curRect.minH?curRect.minH:size,size=size>curRect.maxH?curRect.maxH:size,curRect.h=size,curRect.innerH=size-deltaHeight),size=newRect.innerW,size!==undef&&(size=size<curRect.minW-deltaWidth?curRect.minW-deltaWidth:size,size=size>curRect.maxW-deltaWidth?curRect.maxW-deltaWidth:size,curRect.innerW=size,curRect.w=size+deltaWidth),size=newRect.innerH,size!==undef&&(size=size<curRect.minH-deltaHeight?curRect.minH-deltaHeight:size,size=size>curRect.maxH-deltaHeight?curRect.maxH-deltaHeight:size,curRect.innerH=size,curRect.h=size+deltaHeight),newRect.contentW!==undef&&(curRect.contentW=newRect.contentW),newRect.contentH!==undef&&(curRect.contentH=newRect.contentH),lastLayoutRect=self._lastLayoutRect,(lastLayoutRect.x!==curRect.x||lastLayoutRect.y!==curRect.y||lastLayoutRect.w!==curRect.w||lastLayoutRect.h!==curRect.h)&&(repaintControls=Control.repaintControls,repaintControls&&repaintControls.map&&!repaintControls.map[self._id]&&(repaintControls.push(self),repaintControls.map[self._id]=!0),lastLayoutRect.x=curRect.x,lastLayoutRect.y=curRect.y,lastLayoutRect.w=curRect.w,lastLayoutRect.h=curRect.h),self):curRect},repaint:function(){var style,bodyStyle,rect,borderBox,lastRepaintRect,round,self=this,borderW=0,borderH=0;round=document.createRange?function(value){return value}:Math.round,style=self.getEl().style,rect=self._layoutRect,lastRepaintRect=self._lastRepaintRect||{},borderBox=self._borderBox,borderW=borderBox.left+borderBox.right,borderH=borderBox.top+borderBox.bottom,rect.x!==lastRepaintRect.x&&(style.left=round(rect.x)+"px",lastRepaintRect.x=rect.x),rect.y!==lastRepaintRect.y&&(style.top=round(rect.y)+"px",lastRepaintRect.y=rect.y),rect.w!==lastRepaintRect.w&&(style.width=round(rect.w-borderW)+"px",lastRepaintRect.w=rect.w),rect.h!==lastRepaintRect.h&&(style.height=round(rect.h-borderH)+"px",lastRepaintRect.h=rect.h),self._hasBody&&rect.innerW!==lastRepaintRect.innerW&&(bodyStyle=self.getEl("body").style,bodyStyle.width=round(rect.innerW)+"px",lastRepaintRect.innerW=rect.innerW),self._hasBody&&rect.innerH!==lastRepaintRect.innerH&&(bodyStyle=bodyStyle||self.getEl("body").style,bodyStyle.height=round(rect.innerH)+"px",lastRepaintRect.innerH=rect.innerH),self._lastRepaintRect=lastRepaintRect,self.fire("repaint",{},!1)},on:function(name,callback){function resolveCallbackName(name){var callback,scope;return function(e){return callback||self.parents().each(function(ctrl){var callbacks=ctrl.settings.callbacks;return callbacks&&(callback=callbacks[name])?(scope=ctrl,!1):void 0}),callback.call(scope,e)}}var bindings,handlers,names,i,self=this;if(callback)for("string"==typeof callback&&(callback=resolveCallbackName(callback)),names=name.toLowerCase().split(" "),i=names.length;i--;)name=names[i],bindings=self._bindings,bindings||(bindings=self._bindings={}),handlers=bindings[name],handlers||(handlers=bindings[name]=[]),handlers.push(callback),nativeEvents[name]&&(self._nativeEvents?self._nativeEvents[name]=!0:self._nativeEvents={name:!0},self._rendered&&self.bindPendingEvents());return self},off:function(name,callback){var i,handlers,bindingName,names,hi,self=this,bindings=self._bindings;if(bindings)if(name)for(names=name.toLowerCase().split(" "),i=names.length;i--;){if(name=names[i],handlers=bindings[name],!name){for(bindingName in bindings)bindings[bindingName].length=0;return self}if(handlers)if(callback)for(hi=handlers.length;hi--;)handlers[hi]===callback&&handlers.splice(hi,1);else handlers.length=0}else self._bindings=[];return self},fire:function(name,args,bubble){function returnFalse(){return!1}function returnTrue(){return!0}var i,l,handlers,parentCtrl,self=this;if(name=name.toLowerCase(),args=args||{},args.type||(args.type=name),args.control||(args.control=self),args.preventDefault||(args.preventDefault=function(){args.isDefaultPrevented=returnTrue},args.stopPropagation=function(){args.isPropagationStopped=returnTrue},args.stopImmediatePropagation=function(){args.isImmediatePropagationStopped=returnTrue},args.isDefaultPrevented=returnFalse,args.isPropagationStopped=returnFalse,args.isImmediatePropagationStopped=returnFalse),self._bindings&&(handlers=self._bindings[name]))for(i=0,l=handlers.length;l>i&&(args.isImmediatePropagationStopped()||handlers[i].call(self,args)!==!1);i++);if(bubble!==!1)for(parentCtrl=self.parent();parentCtrl&&!args.isPropagationStopped();)parentCtrl.fire(name,args,!1),parentCtrl=parentCtrl.parent();return args},hasEventListeners:function(name){return name in this._bindings},parents:function(selector){var ctrl=this,parents=new Collection;for(ctrl=ctrl.parent();ctrl;ctrl=ctrl.parent())parents.add(ctrl);return selector&&(parents=parents.filter(selector)),parents},next:function(){var parentControls=this.parent().items();return parentControls[parentControls.indexOf(this)+1]},prev:function(){var parentControls=this.parent().items();return parentControls[parentControls.indexOf(this)-1]},findCommonAncestor:function(ctrl1,ctrl2){for(var parentCtrl;ctrl1;){for(parentCtrl=ctrl2;parentCtrl&&ctrl1!=parentCtrl;)parentCtrl=parentCtrl.parent();if(ctrl1==parentCtrl)break;ctrl1=ctrl1.parent()}return ctrl1},hasClass:function(cls,group){var classes=this._classes[group||"control"];return cls=this.classPrefix+cls,classes&&!!classes.map[cls]},addClass:function(cls,group){var classes,elm,self=this;return cls=this.classPrefix+cls,classes=self._classes[group||"control"],classes||(classes=[],classes.map={},self._classes[group||"control"]=classes),classes.map[cls]||(classes.map[cls]=cls,classes.push(cls),self._rendered&&(elm=self.getEl(group),elm&&(elm.className=classes.join(" ")))),self},removeClass:function(cls,group){var classes,i,elm,self=this;if(cls=this.classPrefix+cls,classes=self._classes[group||"control"],classes&&classes.map[cls])for(delete classes.map[cls],i=classes.length;i--;)classes[i]===cls&&classes.splice(i,1);return self._rendered&&(elm=self.getEl(group),elm&&(elm.className=classes.join(" "))),self},toggleClass:function(cls,state,group){var self=this;return state?self.addClass(cls,group):self.removeClass(cls,group),self},classes:function(group){var classes=this._classes[group||"control"];return classes?classes.join(" "):""},innerHtml:function(html){return DomUtils.innerHtml(this.getEl(),html),this},getEl:function(suffix,dropCache){var elm,id=suffix?this._id+"-"+suffix:this._id;return elm=elementIdCache[id]=(dropCache===!0?null:elementIdCache[id])||DomUtils.get(id)},visible:function(state){var parentCtrl,self=this;return"undefined"!=typeof state?(self._visible!==state&&(self._rendered&&(self.getEl().style.display=state?"":"none"),self._visible=state,parentCtrl=self.parent(),parentCtrl&&(parentCtrl._lastRect=null),self.fire(state?"show":"hide")),self):self._visible},show:function(){return this.visible(!0)},hide:function(){return this.visible(!1)},focus:function(){try{this.getEl().focus()}catch(ex){}return this},blur:function(){return this.getEl().blur(),this},aria:function(name,value){var self=this,elm=self.getEl(self.ariaTarget);return"undefined"==typeof value?self._aria[name]:(self._aria[name]=value,self._rendered&&elm.setAttribute("role"==name?name:"aria-"+name,value),self)},encode:function(text,translate){return translate!==!1&&Control.translate&&(text=Control.translate(text)),(text||"").replace(/[&<>"]/g,function(match){return"&#"+match.charCodeAt(0)+";"})},before:function(items){var self=this,parent=self.parent();return parent&&parent.insert(items,parent.items().indexOf(self),!0),self},after:function(items){var self=this,parent=self.parent();return parent&&parent.insert(items,parent.items().indexOf(self)),self},remove:function(){var newItems,i,self=this,elm=self.getEl(),parent=self.parent();if(self.items){var controls=self.items().toArray();for(i=controls.length;i--;)controls[i].remove()}parent&&parent.items&&(newItems=[],parent.items().each(function(item){item!==self&&newItems.push(item)}),parent.items().set(newItems),parent._lastRect=null),self._eventsRoot&&self._eventsRoot==self&&DomUtils.off(elm);var lookup=self.getRoot().controlIdLookup;if(lookup&&delete lookup[self._id],delete elementIdCache[self._id],elm&&elm.parentNode){var nodes=elm.getElementsByTagName("*");for(i=nodes.length;i--;)delete elementIdCache[nodes[i].id];elm.parentNode.removeChild(elm)}return self._rendered=!1,self},renderBefore:function(elm){var self=this;return elm.parentNode.insertBefore(DomUtils.createFragment(self.renderHtml()),elm),self.postRender(),self},renderTo:function(elm){var self=this;return elm=elm||self.getContainerElm(),elm.appendChild(DomUtils.createFragment(self.renderHtml())),self.postRender(),self},postRender:function(){var elm,box,parent,name,parentEventsRoot,self=this,settings=self.settings;for(name in settings)0===name.indexOf("on")&&self.on(name.substr(2),settings[name]);if(self._eventsRoot){for(parent=self.parent();!parentEventsRoot&&parent;parent=parent.parent())parentEventsRoot=parent._eventsRoot;if(parentEventsRoot)for(name in parentEventsRoot._nativeEvents)self._nativeEvents[name]=!0}self.bindPendingEvents(),settings.style&&(elm=self.getEl(),elm&&(elm.setAttribute("style",settings.style),elm.style.cssText=settings.style)),self._visible||DomUtils.css(self.getEl(),"display","none"),self.settings.border&&(box=self.borderBox(),DomUtils.css(self.getEl(),{"border-top-width":box.top,"border-right-width":box.right,"border-bottom-width":box.bottom,"border-left-width":box.left}));var root=self.getRoot();root.controlIdLookup||(root.controlIdLookup={}),root.controlIdLookup[self._id]=self;for(var key in self._aria)self.aria(key,self._aria[key]);self.fire("postrender",{},!1)},scrollIntoView:function(align){function getOffset(elm,rootElm){var x,y,parent=elm;for(x=y=0;parent&&parent!=rootElm&&parent.nodeType;)x+=parent.offsetLeft||0,y+=parent.offsetTop||0,parent=parent.offsetParent;return{x:x,y:y}}var x,y,width,height,parentWidth,parentHeight,elm=this.getEl(),parentElm=elm.parentNode,pos=getOffset(elm,parentElm);return x=pos.x,y=pos.y,width=elm.offsetWidth,height=elm.offsetHeight,parentWidth=parentElm.clientWidth,parentHeight=parentElm.clientHeight,"end"==align?(x-=parentWidth-width,y-=parentHeight-height):"center"==align&&(x-=parentWidth/2-width/2,y-=parentHeight/2-height/2),parentElm.scrollLeft=x,parentElm.scrollTop=y,this},bindPendingEvents:function(){function delegate(e){var control=self.getParentCtrl(e.target);control&&control.fire(e.type,e)}function mouseLeaveHandler(){var ctrl=eventRootCtrl._lastHoverCtrl;ctrl&&(ctrl.fire("mouseleave",{target:ctrl.getEl()}),ctrl.parents().each(function(ctrl){ctrl.fire("mouseleave",{target:ctrl.getEl()})}),eventRootCtrl._lastHoverCtrl=null)}function mouseEnterHandler(e){var i,parents,lastParents,ctrl=self.getParentCtrl(e.target),lastCtrl=eventRootCtrl._lastHoverCtrl,idx=0;if(ctrl!==lastCtrl){if(eventRootCtrl._lastHoverCtrl=ctrl,parents=ctrl.parents().toArray().reverse(),parents.push(ctrl),lastCtrl){for(lastParents=lastCtrl.parents().toArray().reverse(),lastParents.push(lastCtrl),idx=0;idx<lastParents.length&&parents[idx]===lastParents[idx];idx++);for(i=lastParents.length-1;i>=idx;i--)lastCtrl=lastParents[i],lastCtrl.fire("mouseleave",{target:lastCtrl.getEl()})}for(i=idx;i<parents.length;i++)ctrl=parents[i],ctrl.fire("mouseenter",{target:ctrl.getEl()})}}function fixWheelEvent(e){e.preventDefault(),"mousewheel"==e.type?(e.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(e.deltaX=-1/40*e.wheelDeltaX)):(e.deltaX=0,e.deltaY=e.detail),e=self.fire("wheel",e)}var i,l,parents,eventRootCtrl,nativeEvents,name,self=this;if(self._rendered=!0,nativeEvents=self._nativeEvents){for(parents=self.parents().toArray(),parents.unshift(self),i=0,l=parents.length;!eventRootCtrl&&l>i;i++)eventRootCtrl=parents[i]._eventsRoot;for(eventRootCtrl||(eventRootCtrl=parents[parents.length-1]||self),self._eventsRoot=eventRootCtrl,l=i,i=0;l>i;i++)parents[i]._eventsRoot=eventRootCtrl;for(name in nativeEvents){if(!nativeEvents)return!1;"wheel"!==name||hasWheelEventSupport?("mouseenter"===name||"mouseleave"===name?eventRootCtrl._hasMouseEnter||(DomUtils.on(eventRootCtrl.getEl(),"mouseleave",mouseLeaveHandler),DomUtils.on(eventRootCtrl.getEl(),"mouseover",mouseEnterHandler),eventRootCtrl._hasMouseEnter=1):eventRootCtrl[name]||(DomUtils.on(eventRootCtrl.getEl(),name,delegate),eventRootCtrl[name]=!0),nativeEvents[name]=!1):hasMouseWheelEventSupport?DomUtils.on(self.getEl(),"mousewheel",fixWheelEvent):DomUtils.on(self.getEl(),"DOMMouseScroll",fixWheelEvent)}}},getRoot:function(){for(var rootControl,ctrl=this,parents=[];ctrl;){if(ctrl.rootControl){rootControl=ctrl.rootControl;break}parents.push(ctrl),rootControl=ctrl,ctrl=ctrl.parent()}rootControl||(rootControl=this);for(var i=parents.length;i--;)parents[i].rootControl=rootControl;return rootControl},reflow:function(){return this.repaint(),this}});return Control}),/**
 * Factory.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Factory",[],function(){var namespaceInit,types={};return{add:function(type,typeClass){types[type.toLowerCase()]=typeClass},has:function(type){return!!types[type.toLowerCase()]},create:function(type,settings){var ControlType,name,namespace;if(!namespaceInit){namespace=tinymce.ui;for(name in namespace)types[name.toLowerCase()]=namespace[name];namespaceInit=!0}if("string"==typeof type?(settings=settings||{},settings.type=type):(settings=type,type=settings.type),type=type.toLowerCase(),ControlType=types[type],!ControlType)throw new Error("Could not find control by type: "+type);return ControlType=new ControlType(settings),ControlType.type=type,ControlType}}}),/**
 * KeyboardNavigation.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/KeyboardNavigation",[],function(){return function(settings){function getRole(elm){return elm=elm||focusedElement,elm&&elm.getAttribute("role")}function getParentRole(elm){for(var role,parent=elm||focusedElement;parent=parent.parentNode;)if(role=getRole(parent))return role}function getAriaProp(name){var elm=focusedElement;return elm?elm.getAttribute("aria-"+name):void 0}function isTextInputElement(elm){return"INPUT"==elm.tagName||"TEXTAREA"==elm.tagName}function canFocus(elm){return isTextInputElement(elm)&&!elm.hidden?!0:/^(button|menuitem|checkbox|tab|menuitemcheckbox|option|gridcell)$/.test(getRole(elm))?!0:!1}function getFocusElements(elm){function collect(elm){if(1==elm.nodeType&&"none"!=elm.style.display){canFocus(elm)&&elements.push(elm);for(var i=0;i<elm.childNodes.length;i++)collect(elm.childNodes[i])}}var elements=[];return collect(elm||root.getEl()),elements}function getNavigationRoot(targetControl){var navigationRoot,controls;targetControl=targetControl||focusedControl,controls=targetControl.parents().toArray(),controls.unshift(targetControl);for(var i=0;i<controls.length&&(navigationRoot=controls[i],!navigationRoot.settings.ariaRoot);i++);return navigationRoot}function focusFirst(targetControl){var navigationRoot=getNavigationRoot(targetControl),focusElements=getFocusElements(navigationRoot.getEl());navigationRoot.settings.ariaRemember&&"lastAriaIndex"in navigationRoot?moveFocusToIndex(navigationRoot.lastAriaIndex,focusElements):moveFocusToIndex(0,focusElements)}function moveFocusToIndex(idx,elements){return 0>idx?idx=elements.length-1:idx>=elements.length&&(idx=0),elements[idx]&&elements[idx].focus(),idx}function moveFocus(dir,elements){var idx=-1,navigationRoot=getNavigationRoot();elements=elements||getFocusElements(navigationRoot.getEl());for(var i=0;i<elements.length;i++)elements[i]===focusedElement&&(idx=i);idx+=dir,navigationRoot.lastAriaIndex=moveFocusToIndex(idx,elements)}function left(){var parentRole=getParentRole();"tablist"==parentRole?moveFocus(-1,getFocusElements(focusedElement.parentNode)):focusedControl.parent().submenu?cancel():moveFocus(-1)}function right(){var role=getRole(),parentRole=getParentRole();"tablist"==parentRole?moveFocus(1,getFocusElements(focusedElement.parentNode)):"menuitem"==role&&"menu"==parentRole&&getAriaProp("haspopup")?enter():moveFocus(1)}function up(){moveFocus(-1)}function down(){var role=getRole(),parentRole=getParentRole();"menuitem"==role&&"menubar"==parentRole?enter():"button"==role&&getAriaProp("haspopup")?enter({key:"down"}):moveFocus(1)}function tab(e){var parentRole=getParentRole();if("tablist"==parentRole){var elm=getFocusElements(focusedControl.getEl("body"))[0];elm&&elm.focus()}else moveFocus(e.shiftKey?-1:1)}function cancel(){focusedControl.fire("cancel")}function enter(aria){aria=aria||{},focusedControl.fire("click",{target:focusedElement,aria:aria})}var focusedElement,focusedControl,root=settings.root;return focusedElement=document.activeElement,focusedControl=root.getParentCtrl(focusedElement),root.on("keydown",function(e){function handleNonTabEvent(e,handler){isTextInputElement(focusedElement)||handler(e)!==!1&&e.preventDefault()}if(!e.isDefaultPrevented())switch(e.keyCode){case 37:handleNonTabEvent(e,left);break;case 39:handleNonTabEvent(e,right);break;case 38:handleNonTabEvent(e,up);break;case 40:handleNonTabEvent(e,down);break;case 27:handleNonTabEvent(e,cancel);break;case 14:case 13:case 32:handleNonTabEvent(e,enter);break;case 9:tab(e)!==!1&&e.preventDefault()}}),root.on("focusin",function(e){focusedElement=e.target,focusedControl=e.control}),{focusFirst:focusFirst}}}),/**
 * Container.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Container",["tinymce/ui/Control","tinymce/ui/Collection","tinymce/ui/Selector","tinymce/ui/Factory","tinymce/ui/KeyboardNavigation","tinymce/util/Tools","tinymce/ui/DomUtils"],function(Control,Collection,Selector,Factory,KeyboardNavigation,Tools,DomUtils){var selectorCache={};return Control.extend({layout:"",innerClass:"container-inner",init:function(settings){var self=this;self._super(settings),settings=self.settings,self._fixed=settings.fixed,self._items=new Collection,self.isRtl()&&self.addClass("rtl"),self.addClass("container"),self.addClass("container-body","body"),settings.containerCls&&self.addClass(settings.containerCls),self._layout=Factory.create((settings.layout||self.layout)+"layout"),self.settings.items&&self.add(self.settings.items),self._hasBody=!0},items:function(){return this._items},find:function(selector){return selector=selectorCache[selector]=selectorCache[selector]||new Selector(selector),selector.find(this)},add:function(items){var self=this;return self.items().add(self.create(items)).parent(self),self},focus:function(keyboard){var focusCtrl,keyboardNav,items,self=this;return keyboard&&(keyboardNav=self.keyboardNav||self.parents().eq(-1)[0].keyboardNav)?(keyboardNav.focusFirst(self),void 0):(items=self.find("*"),self.statusbar&&items.add(self.statusbar.items()),items.each(function(ctrl){return ctrl.settings.autofocus?(focusCtrl=null,!1):(ctrl.canFocus&&(focusCtrl=focusCtrl||ctrl),void 0)}),focusCtrl&&focusCtrl.focus(),self)},replace:function(oldItem,newItem){for(var ctrlElm,items=this.items(),i=items.length;i--;)if(items[i]===oldItem){items[i]=newItem;break}i>=0&&(ctrlElm=newItem.getEl(),ctrlElm&&ctrlElm.parentNode.removeChild(ctrlElm),ctrlElm=oldItem.getEl(),ctrlElm&&ctrlElm.parentNode.removeChild(ctrlElm)),newItem.parent(this)},create:function(items){var settings,self=this,ctrlItems=[];return Tools.isArray(items)||(items=[items]),Tools.each(items,function(item){item&&(item instanceof Control||("string"==typeof item&&(item={type:item}),settings=Tools.extend({},self.settings.defaults,item),item.type=settings.type=settings.type||item.type||self.settings.defaultType||(settings.defaults?settings.defaults.type:null),item=Factory.create(settings)),ctrlItems.push(item))}),ctrlItems},renderNew:function(){var self=this;return self.items().each(function(ctrl,index){var containerElm,fragment;ctrl.parent(self),ctrl._rendered||(containerElm=self.getEl("body"),fragment=DomUtils.createFragment(ctrl.renderHtml()),containerElm.hasChildNodes()&&index<=containerElm.childNodes.length-1?containerElm.insertBefore(fragment,containerElm.childNodes[index]):containerElm.appendChild(fragment),ctrl.postRender())}),self._layout.applyClasses(self),self._lastRect=null,self},append:function(items){return this.add(items).renderNew()},prepend:function(items){var self=this;return self.items().set(self.create(items).concat(self.items().toArray())),self.renderNew()},insert:function(items,index,before){var curItems,beforeItems,afterItems,self=this;return items=self.create(items),curItems=self.items(),!before&&index<curItems.length-1&&(index+=1),index>=0&&index<curItems.length&&(beforeItems=curItems.slice(0,index).toArray(),afterItems=curItems.slice(index).toArray(),curItems.set(beforeItems.concat(items,afterItems))),self.renderNew()},fromJSON:function(data){var self=this;for(var name in data)self.find("#"+name).value(data[name]);return self},toJSON:function(){var self=this,data={};return self.find("*").each(function(ctrl){var name=ctrl.name(),value=ctrl.value();name&&"undefined"!=typeof value&&(data[name]=value)}),data},preRender:function(){},renderHtml:function(){var self=this,layout=self._layout,role=this.settings.role;return self.preRender(),layout.preRender(self),'<div id="'+self._id+'" class="'+self.classes()+'"'+(role?' role="'+this.settings.role+'"':"")+">"+'<div id="'+self._id+'-body" class="'+self.classes("body")+'">'+(self.settings.html||"")+layout.renderHtml(self)+"</div>"+"</div>"},postRender:function(){var box,self=this;return self.items().exec("postRender"),self._super(),self._layout.postRender(self),self._rendered=!0,self.settings.style&&DomUtils.css(self.getEl(),self.settings.style),self.settings.border&&(box=self.borderBox(),DomUtils.css(self.getEl(),{"border-top-width":box.top,"border-right-width":box.right,"border-bottom-width":box.bottom,"border-left-width":box.left})),self.parent()||(self.keyboardNav=new KeyboardNavigation({root:self})),self},initLayoutRect:function(){var self=this,layoutRect=self._super();return self._layout.recalc(self),layoutRect},recalc:function(){var self=this,rect=self._layoutRect,lastRect=self._lastRect;return lastRect&&lastRect.w==rect.w&&lastRect.h==rect.h?void 0:(self._layout.recalc(self),rect=self.layoutRect(),self._lastRect={x:rect.x,y:rect.y,w:rect.w,h:rect.h},!0)},reflow:function(){var i,items;if(this.visible()){for(Control.repaintControls=[],Control.repaintControls.map={},items=this.recalc(),i=Control.repaintControls.length;i--;)Control.repaintControls[i].repaint();"flow"!==this.settings.layout&&"stack"!==this.settings.layout&&this.repaint(),Control.repaintControls=[]}return this}})}),/**
 * DragHelper.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/DragHelper",["tinymce/ui/DomUtils"],function(DomUtils){function getDocumentSize(){var documentElement,body,scrollWidth,clientWidth,offsetWidth,scrollHeight,clientHeight,offsetHeight,doc=document,max=Math.max;return documentElement=doc.documentElement,body=doc.body,scrollWidth=max(documentElement.scrollWidth,body.scrollWidth),clientWidth=max(documentElement.clientWidth,body.clientWidth),offsetWidth=max(documentElement.offsetWidth,body.offsetWidth),scrollHeight=max(documentElement.scrollHeight,body.scrollHeight),clientHeight=max(documentElement.clientHeight,body.clientHeight),offsetHeight=max(documentElement.offsetHeight,body.offsetHeight),{width:offsetWidth>scrollWidth?clientWidth:scrollWidth,height:offsetHeight>scrollHeight?clientHeight:scrollHeight}}return function(id,settings){function getHandleElm(){return doc.getElementById(settings.handle||id)}var eventOverlayElm,downButton,start,stop,drag,startX,startY,doc=document;settings=settings||{},start=function(e){var handleElm,cursor,docSize=getDocumentSize();e.preventDefault(),downButton=e.button,handleElm=getHandleElm(),startX=e.screenX,startY=e.screenY,cursor=window.getComputedStyle?window.getComputedStyle(handleElm,null).getPropertyValue("cursor"):handleElm.runtimeStyle.cursor,eventOverlayElm=doc.createElement("div"),DomUtils.css(eventOverlayElm,{position:"absolute",top:0,left:0,width:docSize.width,height:docSize.height,zIndex:2147483647,opacity:1e-4,background:"red",cursor:cursor}),doc.body.appendChild(eventOverlayElm),DomUtils.on(doc,"mousemove",drag),DomUtils.on(doc,"mouseup",stop),settings.start(e)},drag=function(e){return e.button!==downButton?stop(e):(e.deltaX=e.screenX-startX,e.deltaY=e.screenY-startY,e.preventDefault(),settings.drag(e),void 0)},stop=function(e){DomUtils.off(doc,"mousemove",drag),DomUtils.off(doc,"mouseup",stop),eventOverlayElm.parentNode.removeChild(eventOverlayElm),settings.stop&&settings.stop(e)},this.destroy=function(){DomUtils.off(getHandleElm())},DomUtils.on(getHandleElm(),"mousedown",start)}}),/**
 * Scrollable.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Scrollable",["tinymce/ui/DomUtils","tinymce/ui/DragHelper"],function(DomUtils,DragHelper){return{init:function(){var self=this;self.on("repaint",self.renderScroll)},renderScroll:function(){function repaintScroll(){function repaintAxis(axisName,posName,sizeName,contentSizeName,hasScroll,ax){var containerElm,scrollBarElm,scrollThumbElm,containerSize,scrollSize,ratio,rect,posNameLower,sizeNameLower;if(scrollBarElm=self.getEl("scroll"+axisName)){if(posNameLower=posName.toLowerCase(),sizeNameLower=sizeName.toLowerCase(),self.getEl("absend")&&DomUtils.css(self.getEl("absend"),posNameLower,self.layoutRect()[contentSizeName]-1),!hasScroll)return DomUtils.css(scrollBarElm,"display","none"),void 0;DomUtils.css(scrollBarElm,"display","block"),containerElm=self.getEl("body"),scrollThumbElm=self.getEl("scroll"+axisName+"t"),containerSize=containerElm["client"+sizeName]-2*margin,containerSize-=hasScrollH&&hasScrollV?scrollBarElm["client"+ax]:0,scrollSize=containerElm["scroll"+sizeName],ratio=containerSize/scrollSize,rect={},rect[posNameLower]=containerElm["offset"+posName]+margin,rect[sizeNameLower]=containerSize,DomUtils.css(scrollBarElm,rect),rect={},rect[posNameLower]=containerElm["scroll"+posName]*ratio,rect[sizeNameLower]=containerSize*ratio,DomUtils.css(scrollThumbElm,rect)}}var hasScrollH,hasScrollV,bodyElm;bodyElm=self.getEl("body"),hasScrollH=bodyElm.scrollWidth>bodyElm.clientWidth,hasScrollV=bodyElm.scrollHeight>bodyElm.clientHeight,repaintAxis("h","Left","Width","contentW",hasScrollH,"Height"),repaintAxis("v","Top","Height","contentH",hasScrollV,"Width")}function addScroll(){function addScrollAxis(axisName,posName,sizeName,deltaPosName,ax){var scrollStart,axisId=self._id+"-scroll"+axisName,prefix=self.classPrefix;self.getEl().appendChild(DomUtils.createFragment('<div id="'+axisId+'" class="'+prefix+"scrollbar "+prefix+"scrollbar-"+axisName+'">'+'<div id="'+axisId+'t" class="'+prefix+'scrollbar-thumb"></div>'+"</div>")),self.draghelper=new DragHelper(axisId+"t",{start:function(){scrollStart=self.getEl("body")["scroll"+posName],DomUtils.addClass(DomUtils.get(axisId),prefix+"active")},drag:function(e){var ratio,hasScrollH,hasScrollV,containerSize,layoutRect=self.layoutRect();hasScrollH=layoutRect.contentW>layoutRect.innerW,hasScrollV=layoutRect.contentH>layoutRect.innerH,containerSize=self.getEl("body")["client"+sizeName]-2*margin,containerSize-=hasScrollH&&hasScrollV?self.getEl("scroll"+axisName)["client"+ax]:0,ratio=containerSize/self.getEl("body")["scroll"+sizeName],self.getEl("body")["scroll"+posName]=scrollStart+e["delta"+deltaPosName]/ratio},stop:function(){DomUtils.removeClass(DomUtils.get(axisId),prefix+"active")}})}self.addClass("scroll"),addScrollAxis("v","Top","Height","Y","Width"),addScrollAxis("h","Left","Width","X","Height")}var self=this,margin=2;self.settings.autoScroll&&(self._hasScroll||(self._hasScroll=!0,addScroll(),self.on("wheel",function(e){var bodyEl=self.getEl("body");bodyEl.scrollLeft+=10*(e.deltaX||0),bodyEl.scrollTop+=10*e.deltaY,repaintScroll()}),DomUtils.on(self.getEl("body"),"scroll",repaintScroll)),repaintScroll())}}}),/**
 * Panel.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Panel",["tinymce/ui/Container","tinymce/ui/Scrollable"],function(Container,Scrollable){return Container.extend({Defaults:{layout:"fit",containerCls:"panel"},Mixins:[Scrollable],renderHtml:function(){var self=this,layout=self._layout,innerHtml=self.settings.html;return self.preRender(),layout.preRender(self),"undefined"==typeof innerHtml?innerHtml='<div id="'+self._id+'-body" class="'+self.classes("body")+'">'+layout.renderHtml(self)+"</div>":("function"==typeof innerHtml&&(innerHtml=innerHtml.call(self)),self._hasBody=!1),'<div id="'+self._id+'" class="'+self.classes()+'" hideFocus="1" tabIndex="-1" role="group">'+(self._preBodyHtml||"")+innerHtml+"</div>"}})}),/**
 * Movable.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Movable",["tinymce/ui/DomUtils"],function(DomUtils){function calculateRelativePosition(ctrl,targetElm,rel){var ctrlElm,pos,x,y,selfW,selfH,targetW,targetH,viewport,size;return viewport=DomUtils.getViewPort(),pos=DomUtils.getPos(targetElm),x=pos.x,y=pos.y,ctrl._fixed&&(x-=viewport.x,y-=viewport.y),ctrlElm=ctrl.getEl(),size=DomUtils.getSize(ctrlElm),selfW=size.width,selfH=size.height,size=DomUtils.getSize(targetElm),targetW=size.width,targetH=size.height,rel=(rel||"").split(""),"b"===rel[0]&&(y+=targetH),"r"===rel[1]&&(x+=targetW),"c"===rel[0]&&(y+=Math.round(targetH/2)),"c"===rel[1]&&(x+=Math.round(targetW/2)),"b"===rel[3]&&(y-=selfH),"r"===rel[4]&&(x-=selfW),"c"===rel[3]&&(y-=Math.round(selfH/2)),"c"===rel[4]&&(x-=Math.round(selfW/2)),{x:x,y:y,w:selfW,h:selfH}}return{testMoveRel:function(elm,rels){for(var viewPortRect=DomUtils.getViewPort(),i=0;i<rels.length;i++){var pos=calculateRelativePosition(this,elm,rels[i]);if(this._fixed){if(pos.x>0&&pos.x+pos.w<viewPortRect.w&&pos.y>0&&pos.y+pos.h<viewPortRect.h)return rels[i]}else if(pos.x>viewPortRect.x&&pos.x+pos.w<viewPortRect.w+viewPortRect.x&&pos.y>viewPortRect.y&&pos.y+pos.h<viewPortRect.h+viewPortRect.y)return rels[i]}return rels[0]},moveRel:function(elm,rel){"string"!=typeof rel&&(rel=this.testMoveRel(elm,rel));var pos=calculateRelativePosition(this,elm,rel);return this.moveTo(pos.x,pos.y)},moveBy:function(dx,dy){var self=this,rect=self.layoutRect();return self.moveTo(rect.x+dx,rect.y+dy),self},moveTo:function(x,y){function contrain(value,max,size){return 0>value?0:value+size>max?(value=max-size,0>value?0:value):value}var self=this;if(self.settings.constrainToViewport){var viewPortRect=DomUtils.getViewPort(window),layoutRect=self.layoutRect();x=contrain(x,viewPortRect.w+viewPortRect.x,layoutRect.w),y=contrain(y,viewPortRect.h+viewPortRect.y,layoutRect.h)}return self._rendered?self.layoutRect({x:x,y:y}).repaint():(self.settings.x=x,self.settings.y=y),self.fire("move",{x:x,y:y}),self}}}),/**
 * Resizable.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Resizable",["tinymce/ui/DomUtils"],function(DomUtils){return{resizeToContent:function(){this._layoutRect.autoResize=!0,this._lastRect=null,this.reflow()},resizeTo:function(w,h){if(1>=w||1>=h){var rect=DomUtils.getWindowSize();w=1>=w?w*rect.w:w,h=1>=h?h*rect.h:h}return this._layoutRect.autoResize=!1,this.layoutRect({minW:w,minH:h,w:w,h:h}).reflow()},resizeBy:function(dw,dh){var self=this,rect=self.layoutRect();return self.resizeTo(rect.w+dw,rect.h+dh)}}}),/**
 * FloatPanel.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/FloatPanel",["tinymce/ui/Panel","tinymce/ui/Movable","tinymce/ui/Resizable","tinymce/ui/DomUtils"],function(Panel,Movable,Resizable,DomUtils){function removeVisiblePanel(panel){var i;for(i=visiblePanels.length;i--;)visiblePanels[i]===panel&&visiblePanels.splice(i,1);for(i=zOrder.length;i--;)zOrder[i]===panel&&zOrder.splice(i,1)}var documentClickHandler,documentScrollHandler,hasModal,visiblePanels=[],zOrder=[],FloatPanel=Panel.extend({Mixins:[Movable,Resizable],init:function(settings){function reorder(){var i,topModal,zIndex=FloatPanel.zIndex||65535;if(zOrder.length)for(i=0;i<zOrder.length;i++)zOrder[i].modal&&(zIndex++,topModal=zOrder[i]),zOrder[i].getEl().style.zIndex=zIndex,zOrder[i].zIndex=zIndex,zIndex++;var modalBlockEl=document.getElementById(self.classPrefix+"modal-block");topModal?DomUtils.css(modalBlockEl,"z-index",topModal.zIndex-1):modalBlockEl&&(modalBlockEl.parentNode.removeChild(modalBlockEl),hasModal=!1),FloatPanel.currentZIndex=zIndex}function isChildOf(ctrl,parent){for(;ctrl;){if(ctrl==parent)return!0;ctrl=ctrl.parent()}}function repositionPanel(panel){function toggleFixedChildPanels(fixed,deltaY){for(var parent,i=0;i<visiblePanels.length;i++)if(visiblePanels[i]!=panel)for(parent=visiblePanels[i].parent();parent&&(parent=parent.parent());)parent==panel&&visiblePanels[i].fixed(fixed).moveBy(0,deltaY).repaint()}var scrollY=DomUtils.getViewPort().y;panel.settings.autofix&&(panel._fixed?panel._autoFixY>scrollY&&(panel.fixed(!1).layoutRect({y:panel._autoFixY}).repaint(),toggleFixedChildPanels(!1,panel._autoFixY-scrollY)):(panel._autoFixY=panel.layoutRect().y,panel._autoFixY<scrollY&&(panel.fixed(!0).layoutRect({y:0}).repaint(),toggleFixedChildPanels(!0,scrollY-panel._autoFixY))))}var self=this;self._super(settings),self._eventsRoot=self,self.addClass("floatpanel"),settings.autohide&&(documentClickHandler||(documentClickHandler=function(e){for(var i=visiblePanels.length;i--;){var panel=visiblePanels[i],clickCtrl=panel.getParentCtrl(e.target);if(panel.settings.autohide){if(clickCtrl&&(isChildOf(clickCtrl,panel)||panel.parent()===clickCtrl))continue;e=panel.fire("autohide",{target:e.target}),e.isDefaultPrevented()||panel.hide()}}},DomUtils.on(document,"click",documentClickHandler)),visiblePanels.push(self)),settings.autofix&&(documentScrollHandler||(documentScrollHandler=function(){var i;for(i=visiblePanels.length;i--;)repositionPanel(visiblePanels[i])},DomUtils.on(window,"scroll",documentScrollHandler)),self.on("move",function(){repositionPanel(this)})),self.on("postrender show",function(e){if(e.control==self){var modalBlockEl,prefix=self.classPrefix;self.modal&&!hasModal&&(modalBlockEl=DomUtils.createFragment('<div id="'+prefix+'modal-block" class="'+prefix+"reset "+prefix+'fade"></div>'),modalBlockEl=modalBlockEl.firstChild,self.getContainerElm().appendChild(modalBlockEl),setTimeout(function(){DomUtils.addClass(modalBlockEl,prefix+"in"),DomUtils.addClass(self.getEl(),prefix+"in")},0),hasModal=!0),zOrder.push(self),reorder()}}),self.on("close hide",function(e){if(e.control==self){for(var i=zOrder.length;i--;)zOrder[i]===self&&zOrder.splice(i,1);reorder()}}),self.on("show",function(){self.parents().each(function(ctrl){return ctrl._fixed?(self.fixed(!0),!1):void 0})}),settings.popover&&(self._preBodyHtml='<div class="'+self.classPrefix+'arrow"></div>',self.addClass("popover").addClass("bottom").addClass(self.isRtl()?"end":"start"))},fixed:function(state){var self=this;if(self._fixed!=state){if(self._rendered){var viewport=DomUtils.getViewPort();state?self.layoutRect().y-=viewport.y:self.layoutRect().y+=viewport.y}self.toggleClass("fixed",state),self._fixed=state}return self},show:function(){var i,self=this,state=self._super();for(i=visiblePanels.length;i--&&visiblePanels[i]!==self;);return-1===i&&visiblePanels.push(self),state},hide:function(){return removeVisiblePanel(this),this._super()},hideAll:function(){FloatPanel.hideAll()},close:function(){var self=this;return self.fire("close"),self.remove()},remove:function(){removeVisiblePanel(this),this._super()},postRender:function(){var self=this;return self.settings.bodyRole&&this.getEl("body").setAttribute("role",self.settings.bodyRole),self._super()}});return FloatPanel.hideAll=function(){for(var i=visiblePanels.length;i--;){var panel=visiblePanels[i];panel&&panel.settings.autohide&&(panel.hide(),visiblePanels.splice(i,1))}},FloatPanel}),/**
 * Window.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Window",["tinymce/ui/FloatPanel","tinymce/ui/Panel","tinymce/ui/DomUtils","tinymce/ui/DragHelper"],function(FloatPanel,Panel,DomUtils,DragHelper){var Window=FloatPanel.extend({modal:!0,Defaults:{border:1,layout:"flex",containerCls:"panel",role:"dialog",callbacks:{submit:function(){this.fire("submit",{data:this.toJSON()})},close:function(){this.close()}}},init:function(settings){var self=this;self._super(settings),self.isRtl()&&self.addClass("rtl"),self.addClass("window"),self._fixed=!0,settings.buttons&&(self.statusbar=new Panel({layout:"flex",border:"1 0 0 0",spacing:3,padding:10,align:"center",pack:self.isRtl()?"start":"end",defaults:{type:"button"},items:settings.buttons}),self.statusbar.addClass("foot"),self.statusbar.parent(self)),self.on("click",function(e){-1!=e.target.className.indexOf(self.classPrefix+"close")&&self.close()}),self.on("cancel",function(){self.close()}),self.aria("describedby",self.describedBy||self._id+"-none"),self.aria("label",settings.title),self._fullscreen=!1},recalc:function(){var layoutRect,width,x,needsRecalc,self=this,statusbar=self.statusbar;self._fullscreen&&(self.layoutRect(DomUtils.getWindowSize()),self.layoutRect().contentH=self.layoutRect().innerH),self._super(),layoutRect=self.layoutRect(),self.settings.title&&!self._fullscreen&&(width=layoutRect.headerW,width>layoutRect.w&&(x=layoutRect.x-Math.max(0,width/2),self.layoutRect({w:width,x:x}),needsRecalc=!0)),statusbar&&(statusbar.layoutRect({w:self.layoutRect().innerW}).recalc(),width=statusbar.layoutRect().minW+layoutRect.deltaW,width>layoutRect.w&&(x=layoutRect.x-Math.max(0,width-layoutRect.w),self.layoutRect({w:width,x:x}),needsRecalc=!0)),needsRecalc&&self.recalc()},initLayoutRect:function(){var headEl,self=this,layoutRect=self._super(),deltaH=0;if(self.settings.title&&!self._fullscreen){headEl=self.getEl("head");var size=DomUtils.getSize(headEl);layoutRect.headerW=size.width,layoutRect.headerH=size.height,deltaH+=layoutRect.headerH}self.statusbar&&(deltaH+=self.statusbar.layoutRect().h),layoutRect.deltaH+=deltaH,layoutRect.minH+=deltaH,layoutRect.h+=deltaH;var rect=DomUtils.getWindowSize();return layoutRect.x=Math.max(0,rect.w/2-layoutRect.w/2),layoutRect.y=Math.max(0,rect.h/2-layoutRect.h/2),layoutRect},renderHtml:function(){var self=this,layout=self._layout,id=self._id,prefix=self.classPrefix,settings=self.settings,headerHtml="",footerHtml="",html=settings.html;return self.preRender(),layout.preRender(self),settings.title&&(headerHtml='<div id="'+id+'-head" class="'+prefix+'window-head">'+'<div id="'+id+'-title" class="'+prefix+'title">'+self.encode(settings.title)+"</div>"+'<button type="button" class="'+prefix+'close" aria-hidden="true">&times;</button>'+'<div id="'+id+'-dragh" class="'+prefix+'dragh"></div>'+"</div>"),settings.url&&(html='<iframe src="'+settings.url+'" tabindex="-1"></iframe>'),"undefined"==typeof html&&(html=layout.renderHtml(self)),self.statusbar&&(footerHtml=self.statusbar.renderHtml()),'<div id="'+id+'" class="'+self.classes()+'" hideFocus="1">'+'<div class="'+self.classPrefix+'reset" role="application">'+headerHtml+'<div id="'+id+'-body" class="'+self.classes("body")+'">'+html+"</div>"+footerHtml+"</div>"+"</div>"},fullscreen:function(state){var slowRendering,layoutRect,self=this,documentElement=document.documentElement,prefix=self.classPrefix;if(state!=self._fullscreen)if(DomUtils.on(window,"resize",function(){var time;if(self._fullscreen)if(slowRendering)self._timer||(self._timer=setTimeout(function(){var rect=DomUtils.getWindowSize();self.moveTo(0,0).resizeTo(rect.w,rect.h),self._timer=0},50));else{time=(new Date).getTime();var rect=DomUtils.getWindowSize();self.moveTo(0,0).resizeTo(rect.w,rect.h),(new Date).getTime()-time>50&&(slowRendering=!0)}}),layoutRect=self.layoutRect(),self._fullscreen=state,state){self._initial={x:layoutRect.x,y:layoutRect.y,w:layoutRect.w,h:layoutRect.h},self._borderBox=self.parseBox("0"),self.getEl("head").style.display="none",layoutRect.deltaH-=layoutRect.headerH+2,DomUtils.addClass(documentElement,prefix+"fullscreen"),DomUtils.addClass(document.body,prefix+"fullscreen"),self.addClass("fullscreen");var rect=DomUtils.getWindowSize();self.moveTo(0,0).resizeTo(rect.w,rect.h)}else self._borderBox=self.parseBox(self.settings.border),self.getEl("head").style.display="",layoutRect.deltaH+=layoutRect.headerH,DomUtils.removeClass(documentElement,prefix+"fullscreen"),DomUtils.removeClass(document.body,prefix+"fullscreen"),self.removeClass("fullscreen"),self.moveTo(self._initial.x,self._initial.y).resizeTo(self._initial.w,self._initial.h);return self.reflow()},postRender:function(){var startPos,self=this;setTimeout(function(){self.addClass("in")},0),self._super(),self.statusbar&&self.statusbar.postRender(),self.focus(),this.dragHelper=new DragHelper(self._id+"-dragh",{start:function(){startPos={x:self.layoutRect().x,y:self.layoutRect().y}},drag:function(e){self.moveTo(startPos.x+e.deltaX,startPos.y+e.deltaY)}}),self.on("submit",function(e){e.isDefaultPrevented()||self.close()})},submit:function(){return this.fire("submit",{data:this.toJSON()})},remove:function(){var self=this,prefix=self.classPrefix;self.dragHelper.destroy(),self._super(),self.statusbar&&this.statusbar.remove(),self._fullscreen&&(DomUtils.removeClass(document.documentElement,prefix+"fullscreen"),DomUtils.removeClass(document.body,prefix+"fullscreen"))}});return Window}),/**
 * MessageBox.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/MessageBox",["tinymce/ui/Window"],function(Window){var MessageBox=Window.extend({init:function(settings){settings={border:1,padding:20,layout:"flex",pack:"center",align:"center",containerCls:"panel",autoScroll:!0,buttons:{type:"button",text:"Ok",action:"ok"},items:{type:"label",multiline:!0,maxWidth:500,maxHeight:200}},this._super(settings)},Statics:{OK:1,OK_CANCEL:2,YES_NO:3,YES_NO_CANCEL:4,msgBox:function(settings){var buttons,callback=settings.callback||function(){};switch(settings.buttons){case MessageBox.OK_CANCEL:buttons=[{type:"button",text:"Ok",subtype:"primary",onClick:function(e){e.control.parents()[1].close(),callback(!0)}},{type:"button",text:"Cancel",onClick:function(e){e.control.parents()[1].close(),callback(!1)}}];break;case MessageBox.YES_NO:buttons=[{type:"button",text:"Ok",subtype:"primary",onClick:function(e){e.control.parents()[1].close(),callback(!0)}}];break;case MessageBox.YES_NO_CANCEL:buttons=[{type:"button",text:"Ok",subtype:"primary",onClick:function(e){e.control.parents()[1].close()}}];break;default:buttons=[{type:"button",text:"Ok",subtype:"primary",onClick:function(e){e.control.parents()[1].close(),callback(!0)}}]}return new Window({padding:20,x:settings.x,y:settings.y,minWidth:300,minHeight:100,layout:"flex",pack:"center",align:"center",buttons:buttons,title:settings.title,role:"alertdialog",items:{type:"label",multiline:!0,maxWidth:500,maxHeight:200,text:settings.text},onPostRender:function(){this.aria("describedby",this.items()[0]._id)},onClose:settings.onClose,onCancel:function(){callback(!1)}}).renderTo(document.body).reflow()},alert:function(settings,callback){return"string"==typeof settings&&(settings={text:settings}),settings.callback=callback,MessageBox.msgBox(settings)},confirm:function(settings,callback){return"string"==typeof settings&&(settings={text:settings}),settings.callback=callback,settings.buttons=MessageBox.OK_CANCEL,MessageBox.msgBox(settings)}}});return MessageBox}),/**
 * WindowManager.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/WindowManager",["tinymce/ui/Window","tinymce/ui/MessageBox"],function(Window,MessageBox){return function(editor){function getTopMostWindow(){return windows.length?windows[windows.length-1]:void 0}var self=this,windows=[];self.windows=windows,self.open=function(args,params){var win;return editor.editorManager.activeEditor=editor,args.title=args.title||" ",args.url=args.url||args.file,args.url&&(args.width=parseInt(args.width||320,10),args.height=parseInt(args.height||240,10)),args.body&&(args.items={defaults:args.defaults,type:args.bodyType||"form",items:args.body}),args.url||args.buttons||(args.buttons=[{text:"Ok",subtype:"primary",onclick:function(){win.find("form")[0].submit(),win.close()}},{text:"Cancel",onclick:function(){win.close()}}]),win=new Window(args),windows.push(win),win.on("close",function(){for(var i=windows.length;i--;)windows[i]===win&&windows.splice(i,1);editor.focus()}),args.data&&win.on("postRender",function(){this.find("*").each(function(ctrl){var name=ctrl.name();name in args.data&&ctrl.value(args.data[name])})}),win.features=args||{},win.params=params||{},editor.nodeChanged(),win.renderTo(document.body).reflow()},self.alert=function(message,callback,scope){MessageBox.alert(message,function(){callback?callback.call(scope||this):editor.focus()})},self.confirm=function(message,callback,scope){MessageBox.confirm(message,function(state){callback.call(scope||this,state)})},self.close=function(){getTopMostWindow()&&getTopMostWindow().close()},self.getParams=function(){return getTopMostWindow()?getTopMostWindow().params:null},self.setParams=function(params){getTopMostWindow()&&(getTopMostWindow().params=params)}}}),/**
 * Quirks.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 *
 * @ignore-file
 */
define("tinymce/util/Quirks",["tinymce/util/VK","tinymce/dom/RangeUtils","tinymce/html/Node","tinymce/html/Entities","tinymce/Env","tinymce/util/Tools"],function(VK,RangeUtils,Node,Entities,Env,Tools){return function(editor){function setEditorCommandState(cmd,state){try{editor.getDoc().execCommand(cmd,!1,state)}catch(ex){}}function getDocumentMode(){var documentMode=editor.getDoc().documentMode;return documentMode?documentMode:6}function isDefaultPrevented(e){return e.isDefaultPrevented()}function cleanupStylesWhenDeleting(){function customDelete(isForward){var mutationObserver=new MutationObserver(function(){});Tools.each(editor.getBody().getElementsByTagName("*"),function(elm){"SPAN"==elm.tagName&&elm.setAttribute("mce-data-marked",1),!elm.hasAttribute("data-mce-style")&&elm.hasAttribute("style")&&editor.dom.setAttrib(elm,"style",elm.getAttribute("style"))}),mutationObserver.observe(editor.getDoc(),{childList:!0,attributes:!0,subtree:!0,attributeFilter:["style"]}),editor.getDoc().execCommand(isForward?"ForwardDelete":"Delete",!1,null);var rng=editor.selection.getRng(),caretElement=rng.startContainer.parentNode;Tools.each(mutationObserver.takeRecords(),function(record){if("style"==record.attributeName){var oldValue=record.target.getAttribute("data-mce-style");oldValue?record.target.setAttribute("style",oldValue):record.target.removeAttribute("style")}Tools.each(record.addedNodes,function(node){if("SPAN"==node.nodeName&&!node.getAttribute("mce-data-marked")){var offset,container;node==caretElement&&(offset=rng.startOffset,container=node.firstChild),dom.remove(node,!0),container&&(rng.setStart(container,offset),rng.setEnd(container,offset),editor.selection.setRng(rng))}})}),mutationObserver.disconnect(),Tools.each(editor.dom.select("span[mce-data-marked]"),function(span){span.removeAttribute("mce-data-marked")})}var doc=editor.getDoc();window.MutationObserver&&(editor.on("keydown",function(e){var isForward=e.keyCode==DELETE,isMeta=VK.metaKeyPressed(e);if(!isDefaultPrevented(e)&&(isForward||e.keyCode==BACKSPACE)){var rng=editor.selection.getRng(),container=rng.startContainer,offset=rng.startOffset;if(!isMeta&&rng.collapsed&&3==container.nodeType&&(isForward?offset<container.data.length:offset>0))return;e.preventDefault(),isMeta&&editor.selection.getSel().modify("extend",isForward?"forward":"backward","word"),customDelete(isForward)}}),editor.on("keypress",function(e){isDefaultPrevented(e)||selection.isCollapsed()||!e.charCode||VK.metaKeyPressed(e)||(e.preventDefault(),customDelete(!0),editor.selection.setContent(String.fromCharCode(e.charCode)))}),editor.addCommand("Delete",function(){customDelete()}),editor.addCommand("ForwardDelete",function(){customDelete(!0)}),editor.on("dragstart",function(e){e.dataTransfer.setData("mce-internal",editor.selection.getContent())}),editor.on("drop",function(e){if(!isDefaultPrevented(e)){var internalContent=e.dataTransfer.getData("mce-internal");internalContent&&doc.caretRangeFromPoint&&(e.preventDefault(),customDelete(),editor.selection.setRng(doc.caretRangeFromPoint(e.x,e.y)),editor.insertContent(internalContent))}}),editor.on("cut",function(e){!isDefaultPrevented(e)&&e.clipboardData&&(e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/html",editor.selection.getContent()),e.clipboardData.setData("text/plain",editor.selection.getContent({format:"text"})),customDelete(!0))}))}function emptyEditorWhenDeleting(){function serializeRng(rng){var body=dom.create("body"),contents=rng.cloneContents();return body.appendChild(contents),selection.serializer.serialize(body,{format:"html"})}function allContentsSelected(rng){if(!rng.setStart){if(rng.item)return!1;var bodyRng=rng.duplicate();return bodyRng.moveToElementText(editor.getBody()),RangeUtils.compareRanges(rng,bodyRng)}var selection=serializeRng(rng),allRng=dom.createRng();allRng.selectNode(editor.getBody());var allSelection=serializeRng(allRng);return selection===allSelection}editor.on("keydown",function(e){var isCollapsed,body,keyCode=e.keyCode;if(!isDefaultPrevented(e)&&(keyCode==DELETE||keyCode==BACKSPACE)){if(isCollapsed=editor.selection.isCollapsed(),body=editor.getBody(),isCollapsed&&!dom.isEmpty(body))return;if(!isCollapsed&&!allContentsSelected(editor.selection.getRng()))return;e.preventDefault(),editor.setContent(""),body.firstChild&&dom.isBlock(body.firstChild)?editor.selection.setCursorLocation(body.firstChild,0):editor.selection.setCursorLocation(body,0),editor.nodeChanged()}})}function selectAll(){editor.on("keydown",function(e){!isDefaultPrevented(e)&&65==e.keyCode&&VK.metaKeyPressed(e)&&(e.preventDefault(),editor.execCommand("SelectAll"))})}function inputMethodFocus(){editor.settings.content_editable||(dom.bind(editor.getDoc(),"focusin",function(){selection.setRng(selection.getRng())}),dom.bind(editor.getDoc(),"mousedown",function(e){e.target==editor.getDoc().documentElement&&(editor.getBody().focus(),selection.setRng(selection.getRng()))}))}function removeHrOnBackspace(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE&&selection.isCollapsed()&&0===selection.getRng(!0).startOffset){var node=selection.getNode(),previousSibling=node.previousSibling;if("HR"==node.nodeName)return dom.remove(node),e.preventDefault(),void 0;previousSibling&&previousSibling.nodeName&&"hr"===previousSibling.nodeName.toLowerCase()&&(dom.remove(previousSibling),e.preventDefault())}})}function focusBody(){window.Range.prototype.getClientRects||editor.on("mousedown",function(e){if(!isDefaultPrevented(e)&&"HTML"===e.target.nodeName){var body=editor.getBody();body.blur(),setTimeout(function(){body.focus()},0)}})}function selectControlElements(){editor.on("click",function(e){e=e.target,/^(IMG|HR)$/.test(e.nodeName)&&selection.getSel().setBaseAndExtent(e,0,e,1),"A"==e.nodeName&&dom.hasClass(e,"mce-item-anchor")&&selection.select(e),editor.nodeChanged()})}function removeStylesWhenDeletingAcrossBlockElements(){function getAttributeApplyFunction(){var template=dom.getAttribs(selection.getStart().cloneNode(!1));return function(){var target=selection.getStart();target!==editor.getBody()&&(dom.setAttrib(target,"style",null),each(template,function(attr){target.setAttributeNode(attr.cloneNode(!0))}))}}function isSelectionAcrossElements(){return!selection.isCollapsed()&&dom.getParent(selection.getStart(),dom.isBlock)!=dom.getParent(selection.getEnd(),dom.isBlock)}editor.on("keypress",function(e){var applyAttributes;return isDefaultPrevented(e)||8!=e.keyCode&&46!=e.keyCode||!isSelectionAcrossElements()?void 0:(applyAttributes=getAttributeApplyFunction(),editor.getDoc().execCommand("delete",!1,null),applyAttributes(),e.preventDefault(),!1)}),dom.bind(editor.getDoc(),"cut",function(e){var applyAttributes;!isDefaultPrevented(e)&&isSelectionAcrossElements()&&(applyAttributes=getAttributeApplyFunction(),setTimeout(function(){applyAttributes()},0))})}function selectionChangeNodeChanged(){var lastRng,selectionTimer;editor.on("selectionchange",function(){selectionTimer&&(clearTimeout(selectionTimer),selectionTimer=0),selectionTimer=window.setTimeout(function(){var rng=selection.getRng();lastRng&&RangeUtils.compareRanges(rng,lastRng)||(editor.nodeChanged(),lastRng=rng)},50)})}function ensureBodyHasRoleApplication(){document.body.setAttribute("role","application")}function disableBackspaceIntoATable(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE&&selection.isCollapsed()&&0===selection.getRng(!0).startOffset){var previousSibling=selection.getNode().previousSibling;if(previousSibling&&previousSibling.nodeName&&"table"===previousSibling.nodeName.toLowerCase())return e.preventDefault(),!1}})}function addNewLinesBeforeBrInPre(){getDocumentMode()>7||(setEditorCommandState("RespectVisibilityInDesign",!0),editor.contentStyles.push(".mceHideBrInPre pre br {display: none}"),dom.addClass(editor.getBody(),"mceHideBrInPre"),parser.addNodeFilter("pre",function(nodes){for(var brNodes,j,brElm,sibling,i=nodes.length;i--;)for(brNodes=nodes[i].getAll("br"),j=brNodes.length;j--;)brElm=brNodes[j],sibling=brElm.prev,sibling&&3===sibling.type&&"\n"!=sibling.value.charAt(sibling.value-1)?sibling.value+="\n":brElm.parent.insert(new Node("#text",3),brElm,!0).value="\n"}),serializer.addNodeFilter("pre",function(nodes){for(var brNodes,j,brElm,sibling,i=nodes.length;i--;)for(brNodes=nodes[i].getAll("br"),j=brNodes.length;j--;)brElm=brNodes[j],sibling=brElm.prev,sibling&&3==sibling.type&&(sibling.value=sibling.value.replace(/\r?\n$/,""))}))}function removePreSerializedStylesWhenSelectingControls(){dom.bind(editor.getBody(),"mouseup",function(){var value,node=selection.getNode();"IMG"==node.nodeName&&((value=dom.getStyle(node,"width"))&&(dom.setAttrib(node,"width",value.replace(/[^0-9%]+/g,"")),dom.setStyle(node,"width","")),(value=dom.getStyle(node,"height"))&&(dom.setAttrib(node,"height",value.replace(/[^0-9%]+/g,"")),dom.setStyle(node,"height","")))})}function removeBlockQuoteOnBackSpace(){editor.on("keydown",function(e){var rng,container,offset,root,parent;if(!isDefaultPrevented(e)&&e.keyCode==VK.BACKSPACE&&(rng=selection.getRng(),container=rng.startContainer,offset=rng.startOffset,root=dom.getRoot(),parent=container,rng.collapsed&&0===offset)){for(;parent&&parent.parentNode&&parent.parentNode.firstChild==parent&&parent.parentNode!=root;)parent=parent.parentNode;"BLOCKQUOTE"===parent.tagName&&(editor.formatter.toggle("blockquote",null,parent),rng=dom.createRng(),rng.setStart(container,0),rng.setEnd(container,0),selection.setRng(rng))}})}function setGeckoEditingOptions(){function setOpts(){editor._refreshContentEditable(),setEditorCommandState("StyleWithCSS",!1),setEditorCommandState("enableInlineTableEditing",!1),settings.object_resizing||setEditorCommandState("enableObjectResizing",!1)}settings.readonly||editor.on("BeforeExecCommand MouseDown",setOpts)}function addBrAfterLastLinks(){function fixLinks(){each(dom.select("a"),function(node){var parentNode=node.parentNode,root=dom.getRoot();if(parentNode.lastChild===node){for(;parentNode&&!dom.isBlock(parentNode);){if(parentNode.parentNode.lastChild!==parentNode||parentNode===root)return;parentNode=parentNode.parentNode}dom.add(parentNode,"br",{"data-mce-bogus":1})}})}editor.on("SetContent ExecCommand",function(e){("setcontent"==e.type||"mceInsertLink"===e.command)&&fixLinks()})}function setDefaultBlockType(){settings.forced_root_block&&editor.on("init",function(){setEditorCommandState("DefaultParagraphSeparator",settings.forced_root_block)})}function removeGhostSelection(){editor.on("Undo Redo SetContent",function(e){e.initial||editor.execCommand("mceRepaint")})}function deleteControlItemOnBackSpace(){editor.on("keydown",function(e){var rng;isDefaultPrevented(e)||e.keyCode!=BACKSPACE||(rng=editor.getDoc().selection.createRange(),rng&&rng.item&&(e.preventDefault(),editor.undoManager.beforeChange(),dom.remove(rng.item(0)),editor.undoManager.add()))})}function renderEmptyBlocksFix(){var emptyBlocksCSS;getDocumentMode()>=10&&(emptyBlocksCSS="",each("p div h1 h2 h3 h4 h5 h6".split(" "),function(name,i){emptyBlocksCSS+=(i>0?",":"")+name+":empty"}),editor.contentStyles.push(emptyBlocksCSS+"{padding-right: 1px !important}"))}function keepNoScriptContents(){getDocumentMode()<9&&(parser.addNodeFilter("noscript",function(nodes){for(var node,textNode,i=nodes.length;i--;)node=nodes[i],textNode=node.firstChild,textNode&&node.attr("data-mce-innertext",textNode.value)}),serializer.addNodeFilter("noscript",function(nodes){for(var node,textNode,value,i=nodes.length;i--;)node=nodes[i],textNode=nodes[i].firstChild,textNode?textNode.value=Entities.decode(textNode.value):(value=node.attributes.map["data-mce-innertext"],value&&(node.attr("data-mce-innertext",null),textNode=new Node("#text",3),textNode.value=value,textNode.raw=!0,node.append(textNode)))}))}function fixCaretSelectionOfDocumentElementOnIe(){function rngFromPoint(x,y){var rng=body.createTextRange();try{rng.moveToPoint(x,y)}catch(ex){rng=null}return rng}function selectionChange(e){var pointRng;e.button?(pointRng=rngFromPoint(e.x,e.y),pointRng&&(pointRng.compareEndPoints("StartToStart",startRng)>0?pointRng.setEndPoint("StartToStart",startRng):pointRng.setEndPoint("EndToEnd",startRng),pointRng.select())):endSelection()}function endSelection(){var rng=doc.selection.createRange();startRng&&!rng.item&&0===rng.compareEndPoints("StartToEnd",rng)&&startRng.select(),dom.unbind(doc,"mouseup",endSelection),dom.unbind(doc,"mousemove",selectionChange),startRng=started=0}var started,startRng,htmlElm,doc=dom.doc,body=doc.body;doc.documentElement.unselectable=!0,dom.bind(doc,"mousedown contextmenu",function(e){if("HTML"===e.target.nodeName){if(started&&endSelection(),htmlElm=doc.documentElement,htmlElm.scrollHeight>htmlElm.clientHeight)return;started=1,startRng=rngFromPoint(e.x,e.y),startRng&&(dom.bind(doc,"mouseup",endSelection),dom.bind(doc,"mousemove",selectionChange),dom.getRoot().focus(),startRng.select())}})}function normalizeSelection(){editor.on("keyup focusin",function(e){65==e.keyCode&&VK.metaKeyPressed(e)||selection.normalize()})}function showBrokenImageIcon(){editor.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")}function restoreFocusOnKeyDown(){editor.inline||editor.on("keydown",function(){document.activeElement==document.body&&editor.getWin().focus()})}function bodyHeight(){editor.inline||(editor.contentStyles.push("body {min-height: 150px}"),editor.on("click",function(e){"HTML"==e.target.nodeName&&(editor.getBody().focus(),editor.selection.normalize(),editor.nodeChanged())}))}function blockCmdArrowNavigation(){Env.mac&&editor.on("keydown",function(e){!VK.metaKeyPressed(e)||37!=e.keyCode&&39!=e.keyCode||(e.preventDefault(),editor.selection.getSel().modify("move",37==e.keyCode?"backward":"forward","word"))})}function disableAutoUrlDetect(){setEditorCommandState("AutoUrlDetect",!1)}function doubleTrailingBrElements(){editor.inline||editor.on("init",function(){editor.getDoc().designMode="on"})}var each=Tools.each,BACKSPACE=VK.BACKSPACE,DELETE=VK.DELETE,dom=editor.dom,selection=editor.selection,settings=editor.settings,parser=editor.parser,serializer=editor.serializer,isGecko=Env.gecko,isIE=Env.ie,isWebKit=Env.webkit;disableBackspaceIntoATable(),removeBlockQuoteOnBackSpace(),emptyEditorWhenDeleting(),normalizeSelection(),isWebKit&&(cleanupStylesWhenDeleting(),inputMethodFocus(),selectControlElements(),setDefaultBlockType(),Env.iOS?(selectionChangeNodeChanged(),restoreFocusOnKeyDown(),bodyHeight()):selectAll()),isIE&&Env.ie<11&&(removeHrOnBackspace(),ensureBodyHasRoleApplication(),addNewLinesBeforeBrInPre(),removePreSerializedStylesWhenSelectingControls(),deleteControlItemOnBackSpace(),renderEmptyBlocksFix(),keepNoScriptContents(),fixCaretSelectionOfDocumentElementOnIe()),Env.ie>=11&&(bodyHeight(),doubleTrailingBrElements()),Env.ie&&(selectAll(),disableAutoUrlDetect()),isGecko&&(removeHrOnBackspace(),focusBody(),removeStylesWhenDeletingAcrossBlockElements(),setGeckoEditingOptions(),addBrAfterLastLinks(),removeGhostSelection(),showBrokenImageIcon(),blockCmdArrowNavigation())}}),/**
 * Observable.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/util/Observable",["tinymce/util/Tools"],function(Tools){function returnFalse(){return!1}function returnTrue(){return!0}var bindingsName="__bindings",nativeEvents=Tools.makeMap("focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave keydown keypress keyup contextmenu dragstart dragend dragover draggesture dragdrop drop drag"," ");return{fire:function(name,args,bubble){var handlers,i,l,callback,parent,self=this;if(name=name.toLowerCase(),args=args||{},args.type=name,args.target||(args.target=self),args.preventDefault||(args.preventDefault=function(){args.isDefaultPrevented=returnTrue},args.stopPropagation=function(){args.isPropagationStopped=returnTrue},args.stopImmediatePropagation=function(){args.isImmediatePropagationStopped=returnTrue},args.isDefaultPrevented=returnFalse,args.isPropagationStopped=returnFalse,args.isImmediatePropagationStopped=returnFalse),self[bindingsName]&&(handlers=self[bindingsName][name]))for(i=0,l=handlers.length;l>i&&(handlers[i]=callback=handlers[i],!args.isImmediatePropagationStopped());i++)if(callback.call(self,args)===!1)return args.preventDefault(),args;if(bubble!==!1&&self.parent)for(parent=self.parent();parent&&!args.isPropagationStopped();)parent.fire(name,args,!1),parent=parent.parent();return args},on:function(name,callback){var bindings,handlers,names,i,self=this;if(callback===!1&&(callback=function(){return!1}),callback)for(names=name.toLowerCase().split(" "),i=names.length;i--;)name=names[i],bindings=self[bindingsName],bindings||(bindings=self[bindingsName]={}),handlers=bindings[name],handlers||(handlers=bindings[name]=[],self.bindNative&&nativeEvents[name]&&self.bindNative(name)),handlers.push(callback);return self},off:function(name,callback){var i,handlers,bindingName,names,hi,self=this,bindings=self[bindingsName];if(bindings)if(name)for(names=name.toLowerCase().split(" "),i=names.length;i--;){if(name=names[i],handlers=bindings[name],!name){for(bindingName in bindings)bindings[name].length=0;return self}if(handlers){if(callback)for(hi=handlers.length;hi--;)handlers[hi]===callback&&handlers.splice(hi,1);else handlers.length=0;!handlers.length&&self.unbindNative&&nativeEvents[name]&&(self.unbindNative(name),delete bindings[name])}}else{if(self.unbindNative)for(name in bindings)self.unbindNative(name);self[bindingsName]=[]}return self},hasEventListeners:function(name){var bindings=this[bindingsName];return name=name.toLowerCase(),!(!bindings||!bindings[name]||0===bindings[name].length)}}}),/**
 * Shortcuts.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/Shortcuts",["tinymce/util/Tools","tinymce/Env"],function(Tools,Env){var each=Tools.each,explode=Tools.explode,keyCodeLookup={f9:120,f10:121,f11:122};return function(editor){var self=this,shortcuts={};editor.on("keyup keypress keydown",function(e){(e.altKey||e.ctrlKey||e.metaKey)&&each(shortcuts,function(shortcut){var ctrlKey=Env.mac?e.metaKey:e.ctrlKey;if(shortcut.ctrl==ctrlKey&&shortcut.alt==e.altKey&&shortcut.shift==e.shiftKey)return e.keyCode==shortcut.keyCode||e.charCode&&e.charCode==shortcut.charCode?(e.preventDefault(),"keydown"==e.type&&shortcut.func.call(shortcut.scope),!0):void 0})}),self.add=function(pattern,desc,cmdFunc,scope){var cmd;return cmd=cmdFunc,"string"==typeof cmdFunc?cmdFunc=function(){editor.execCommand(cmd,!1,null)}:Tools.isArray(cmd)&&(cmdFunc=function(){editor.execCommand(cmd[0],cmd[1],cmd[2])}),each(explode(pattern.toLowerCase()),function(pattern){var shortcut={func:cmdFunc,scope:scope||editor,desc:editor.translate(desc),alt:!1,ctrl:!1,shift:!1};each(explode(pattern,"+"),function(value){switch(value){case"alt":case"ctrl":case"shift":shortcut[value]=!0;break;default:shortcut.charCode=value.charCodeAt(0),shortcut.keyCode=keyCodeLookup[value]||value.toUpperCase().charCodeAt(0)}}),shortcuts[(shortcut.ctrl?"ctrl":"")+","+(shortcut.alt?"alt":"")+","+(shortcut.shift?"shift":"")+","+shortcut.keyCode]=shortcut}),!0}}}),/**
 * Editor.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/Editor",["tinymce/dom/DOMUtils","tinymce/AddOnManager","tinymce/html/Node","tinymce/dom/Serializer","tinymce/html/Serializer","tinymce/dom/Selection","tinymce/Formatter","tinymce/UndoManager","tinymce/EnterKey","tinymce/ForceBlocks","tinymce/EditorCommands","tinymce/util/URI","tinymce/dom/ScriptLoader","tinymce/dom/EventUtils","tinymce/WindowManager","tinymce/html/Schema","tinymce/html/DomParser","tinymce/util/Quirks","tinymce/Env","tinymce/util/Tools","tinymce/util/Observable","tinymce/Shortcuts"],function(DOMUtils,AddOnManager,Node,DomSerializer,Serializer,Selection,Formatter,UndoManager,EnterKey,ForceBlocks,EditorCommands,URI,ScriptLoader,EventUtils,WindowManager,Schema,DomParser,Quirks,Env,Tools,Observable,Shortcuts){function getEventTarget(editor,eventName){return"selectionchange"==eventName?editor.getDoc():!editor.inline&&/^mouse|click|contextmenu|drop/.test(eventName)?editor.getDoc():editor.getBody()}function Editor(id,settings,editorManager){var documentBaseUrl,baseUri,self=this;documentBaseUrl=self.documentBaseUrl=editorManager.documentBaseURL,baseUri=editorManager.baseURI,self.settings=settings=extend({id:id,theme:"modern",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:documentBaseUrl,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,padd_empty_editor:!0,render_ui:!0,indentation:"30px",inline_styles:!0,convert_fonts_to_spans:!0,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",validate:!0,entity_encoding:"named",url_converter:self.convertURL,url_converter_scope:self,ie7_compat:!0},settings),AddOnManager.language=settings.language||"en",AddOnManager.languageLoad=settings.language_load,AddOnManager.baseURL=editorManager.baseURL,self.id=settings.id=id,self.isNotDirty=!0,self.plugins={},self.documentBaseURI=new URI(settings.document_base_url||documentBaseUrl,{base_uri:baseUri}),self.baseURI=baseUri,self.contentCSS=[],self.contentStyles=[],self.shortcuts=new Shortcuts(self),self.execCommands={},self.queryStateCommands={},self.queryValueCommands={},self.loadedCSS={},self.suffix=editorManager.suffix,self.editorManager=editorManager,self.inline=settings.inline,editorManager.fire("SetupEditor",self),self.execCallback("setup",self)}var DOM=DOMUtils.DOM,ThemeManager=AddOnManager.ThemeManager,PluginManager=AddOnManager.PluginManager,extend=Tools.extend,each=Tools.each,explode=Tools.explode,inArray=Tools.inArray,trim=Tools.trim,resolve=Tools.resolve,Event=EventUtils.Event,isGecko=Env.gecko,ie=Env.ie;return Editor.prototype={render:function(){function readyHandler(){DOM.unbind(window,"ready",readyHandler),self.render()}function loadScripts(){var scriptLoader=ScriptLoader.ScriptLoader;if(settings.language&&"en"!=settings.language&&!settings.language_url&&(settings.language_url=self.editorManager.baseURL+"/langs/"+settings.language+".js"),settings.language_url&&scriptLoader.add(settings.language_url),settings.theme&&"function"!=typeof settings.theme&&"-"!=settings.theme.charAt(0)&&!ThemeManager.urls[settings.theme]){var themeUrl=settings.theme_url;themeUrl=themeUrl?self.documentBaseURI.toAbsolute(themeUrl):"themes/"+settings.theme+"/theme"+suffix+".js",ThemeManager.load(settings.theme,themeUrl)}Tools.isArray(settings.plugins)&&(settings.plugins=settings.plugins.join(" ")),each(settings.external_plugins,function(url,name){PluginManager.load(name,url),settings.plugins+=" "+name}),each(settings.plugins.split(/[ ,]/),function(plugin){if(plugin=trim(plugin),plugin&&!PluginManager.urls[plugin])if("-"==plugin.charAt(0)){plugin=plugin.substr(1,plugin.length);var dependencies=PluginManager.dependencies(plugin);each(dependencies,function(dep){var defaultSettings={prefix:"plugins/",resource:dep,suffix:"/plugin"+suffix+".js"};dep=PluginManager.createUrl(defaultSettings,dep),PluginManager.load(dep.resource,dep)})}else PluginManager.load(plugin,{prefix:"plugins/",resource:plugin,suffix:"/plugin"+suffix+".js"})}),scriptLoader.loadQueue(function(){self.removed||self.init()})}var self=this,settings=self.settings,id=self.id,suffix=self.suffix;if(!Event.domLoaded)return DOM.bind(window,"ready",readyHandler),void 0;if(self.getElement()&&Env.contentEditable){settings.inline?self.inline=!0:(self.orgVisibility=self.getElement().style.visibility,self.getElement().style.visibility="hidden");var form=self.getElement().form||DOM.getParent(id,"form");form&&(self.formElement=form,settings.hidden_input&&!/TEXTAREA|INPUT/i.test(self.getElement().nodeName)&&(DOM.insertAfter(DOM.create("input",{type:"hidden",name:id}),id),self.hasHiddenInput=!0),self.formEventDelegate=function(e){self.fire(e.type,e)},DOM.bind(form,"submit reset",self.formEventDelegate),self.on("reset",function(){self.setContent(self.startContent,{format:"raw"})}),!settings.submit_patch||form.submit.nodeType||form.submit.length||form._mceOldSubmit||(form._mceOldSubmit=form.submit,form.submit=function(){return self.editorManager.triggerSave(),self.isNotDirty=!0,form._mceOldSubmit(form)})),self.windowManager=new WindowManager(self),"xml"==settings.encoding&&self.on("GetContent",function(e){e.save&&(e.content=DOM.encode(e.content))}),settings.add_form_submit_trigger&&self.on("submit",function(){self.initialized&&self.save()}),settings.add_unload_trigger&&(self._beforeUnload=function(){!self.initialized||self.destroyed||self.isHidden()||self.save({format:"raw",no_events:!0,set_dirty:!1})},self.editorManager.on("BeforeUnload",self._beforeUnload)),loadScripts()}},init:function(){function initPlugin(plugin){var url,pluginInstance,constr=PluginManager.get(plugin);url=PluginManager.urls[plugin]||self.documentBaseUrl.replace(/\/$/,""),plugin=trim(plugin),constr&&-1===inArray(initializedPlugins,plugin)&&(each(PluginManager.dependencies(plugin),function(dep){initPlugin(dep)}),pluginInstance=new constr(self,url),self.plugins[plugin]=pluginInstance,pluginInstance.init&&(pluginInstance.init(self,url),initializedPlugins.push(plugin)))}var w,h,minHeight,n,o,url,bodyId,bodyClass,re,i,self=this,settings=self.settings,elm=self.getElement(),initializedPlugins=[];if(self.rtl=this.editorManager.i18n.rtl,self.editorManager.add(self),settings.aria_label=settings.aria_label||DOM.getAttrib(elm,"aria-label",self.getLang("aria.rich_text_area")),settings.theme&&("function"!=typeof settings.theme?(settings.theme=settings.theme.replace(/-/,""),o=ThemeManager.get(settings.theme),self.theme=new o(self,ThemeManager.urls[settings.theme]),self.theme.init&&self.theme.init(self,ThemeManager.urls[settings.theme]||self.documentBaseUrl.replace(/\/$/,""))):self.theme=settings.theme),each(settings.plugins.replace(/\-/g,"").split(/[ ,]/),initPlugin),settings.render_ui&&self.theme&&(self.orgDisplay=elm.style.display,"function"!=typeof settings.theme?(w=settings.width||elm.style.width||elm.offsetWidth,h=settings.height||elm.style.height||elm.offsetHeight,minHeight=settings.min_height||100,re=/^[0-9\.]+(|px)$/i,re.test(""+w)&&(w=Math.max(parseInt(w,10)+(o.deltaWidth||0),100)),re.test(""+h)&&(h=Math.max(parseInt(h,10)+(o.deltaHeight||0),minHeight)),o=self.theme.renderUI({targetNode:elm,width:w,height:h,deltaWidth:settings.delta_width,deltaHeight:settings.delta_height}),settings.content_editable||(DOM.setStyles(o.sizeContainer||o.editorContainer,{wi2dth:w,h2eight:h}),h=(o.iframeHeight||h)+("number"==typeof h?o.deltaHeight||0:""),minHeight>h&&(h=minHeight))):(o=settings.theme(self,elm),o.editorContainer.nodeType&&(o.editorContainer=o.editorContainer.id=o.editorContainer.id||self.id+"_parent"),o.iframeContainer.nodeType&&(o.iframeContainer=o.iframeContainer.id=o.iframeContainer.id||self.id+"_iframecontainer"),h=o.iframeHeight||elm.offsetHeight),self.editorContainer=o.editorContainer),settings.content_css&&each(explode(settings.content_css),function(u){self.contentCSS.push(self.documentBaseURI.toAbsolute(u))}),settings.content_style&&self.contentStyles.push(settings.content_style),settings.content_editable)return elm=n=o=null,self.initContentBody();for(self.iframeHTML=settings.doctype+"<html><head>",settings.document_base_url!=self.documentBaseUrl&&(self.iframeHTML+='<base href="'+self.documentBaseURI.getURI()+'" />'),!Env.caretAfter&&settings.ie7_compat&&(self.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=7" />'),self.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',i=0;i<self.contentCSS.length;i++){var cssUrl=self.contentCSS[i];self.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+cssUrl+'" />',self.loadedCSS[cssUrl]=!0}bodyId=settings.body_id||"tinymce",-1!=bodyId.indexOf("=")&&(bodyId=self.getParam("body_id","","hash"),bodyId=bodyId[self.id]||bodyId),bodyClass=settings.body_class||"",-1!=bodyClass.indexOf("=")&&(bodyClass=self.getParam("body_class","","hash"),bodyClass=bodyClass[self.id]||""),self.iframeHTML+='</head><body id="'+bodyId+'" class="mce-content-body '+bodyClass+'" '+"onload=\"window.parent.tinymce.get('"+self.id+"').fire('load');\"><br></body></html>";var domainRelaxUrl='javascript:(function(){document.open();document.domain="'+document.domain+'";'+'var ed = window.parent.tinymce.get("'+self.id+'");document.write(ed.iframeHTML);'+"document.close();ed.initContentBody(true);})()";if(document.domain!=location.hostname&&(url=domainRelaxUrl),n=DOM.add(o.iframeContainer,"iframe",{id:self.id+"_ifr",src:url||'javascript:""',frameBorder:"0",allowTransparency:"true",title:self.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"),style:{width:"100%",height:h,display:"block"}}),ie)try{self.getDoc()}catch(e){n.src=url=domainRelaxUrl}self.contentAreaContainer=o.iframeContainer,o.editorContainer&&(DOM.get(o.editorContainer).style.display=self.orgDisplay),DOM.get(self.id).style.display="none",DOM.setAttrib(self.id,"aria-hidden",!0),url||self.initContentBody(),elm=n=o=null},initContentBody:function(skipWrite){var body,contentCssText,self=this,settings=self.settings,targetElm=DOM.get(self.id),doc=self.getDoc();settings.inline||(self.getElement().style.visibility=self.orgVisibility),skipWrite||settings.content_editable||(doc.open(),doc.write(self.iframeHTML),doc.close()),settings.content_editable&&(self.on("remove",function(){var body=this.getBody();DOM.removeClass(body,"mce-content-body"),DOM.removeClass(body,"mce-edit-focus"),DOM.setAttrib(body,"tabIndex",null),DOM.setAttrib(body,"contentEditable",null)}),DOM.addClass(targetElm,"mce-content-body"),targetElm.tabIndex=-1,self.contentDocument=doc=settings.content_document||document,self.contentWindow=settings.content_window||window,self.bodyElement=targetElm,settings.content_document=settings.content_window=null,settings.root_name=targetElm.nodeName.toLowerCase()),body=self.getBody(),body.disabled=!0,settings.readonly||(self.inline&&"static"==DOM.getStyle(body,"position",!0)&&(body.style.position="relative"),body.contentEditable=self.getParam("content_editable_state",!0)),body.disabled=!1,self.schema=new Schema(settings),self.dom=new DOMUtils(doc,{keep_values:!0,url_converter:self.convertURL,url_converter_scope:self,hex_colors:settings.force_hex_style_colors,class_filter:settings.class_filter,update_styles:!0,root_element:settings.content_editable?self.id:null,collect:settings.content_editable,schema:self.schema,onSetAttrib:function(e){self.fire("SetAttrib",e)}}),self.parser=new DomParser(settings,self.schema),self.parser.addAttributeFilter("src,href,style",function(nodes,name){for(var node,value,internalName,i=nodes.length,dom=self.dom;i--;)node=nodes[i],value=node.attr(name),internalName="data-mce-"+name,node.attributes.map[internalName]||("style"===name?node.attr(internalName,dom.serializeStyle(dom.parseStyle(value),node.name)):node.attr(internalName,self.convertURL(value,name,node.name)))}),self.parser.addNodeFilter("script",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],node.attr("type","mce-"+(node.attr("type")||"text/javascript"))}),self.parser.addNodeFilter("#cdata",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],node.type=8,node.name="#comment",node.value="[CDATA["+node.value+"]]"}),self.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(nodes){for(var node,i=nodes.length,nonEmptyElements=self.schema.getNonEmptyElements();i--;)node=nodes[i],node.isEmpty(nonEmptyElements)&&(node.empty().append(new Node("br",1)).shortEnded=!0)}),self.serializer=new DomSerializer(settings,self),self.selection=new Selection(self.dom,self.getWin(),self.serializer,self),self.formatter=new Formatter(self),self.undoManager=new UndoManager(self),self.forceBlocks=new ForceBlocks(self),self.enterKey=new EnterKey(self),self.editorCommands=new EditorCommands(self),self.fire("PreInit"),settings.browser_spellcheck||settings.gecko_spellcheck||(doc.body.spellcheck=!1,DOM.setAttrib(body,"spellcheck","false")),self.fire("PostRender"),self.quirks=Quirks(self),settings.directionality&&(body.dir=settings.directionality),settings.nowrap&&(body.style.whiteSpace="nowrap"),settings.protect&&self.on("BeforeSetContent",function(e){each(settings.protect,function(pattern){e.content=e.content.replace(pattern,function(str){return"<!--mce:protected "+escape(str)+"-->"})})}),self.on("SetContent",function(){self.addVisual(self.getBody())}),settings.padd_empty_editor&&self.on("PostProcess",function(e){e.content=e.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")}),self.load({initial:!0,format:"html"}),self.startContent=self.getContent({format:"raw"}),self.initialized=!0,each(self._pendingNativeEvents,function(name){self.dom.bind(getEventTarget(self,name),name,function(e){self.fire(e.type,e)})}),self.fire("init"),self.focus(!0),self.nodeChanged({initial:!0}),self.execCallback("init_instance_callback",self),self.contentStyles.length>0&&(contentCssText="",each(self.contentStyles,function(style){contentCssText+=style+"\r\n"}),self.dom.addStyle(contentCssText)),each(self.contentCSS,function(cssUrl){self.loadedCSS[cssUrl]||(self.dom.loadCSS(cssUrl),self.loadedCSS[cssUrl]=!0)}),settings.auto_focus&&setTimeout(function(){var ed=self.editorManager.get(settings.auto_focus);ed.selection.select(ed.getBody(),1),ed.selection.collapse(1),ed.getBody().focus(),ed.getWin().focus()},100),targetElm=doc=body=null},focus:function(skip_focus){var oed,rng,controlElm,body,self=this,selection=self.selection,contentEditable=self.settings.content_editable,doc=self.getDoc();skip_focus||(rng=selection.getRng(),rng.item&&(controlElm=rng.item(0)),self._refreshContentEditable(),contentEditable||(Env.opera||self.getBody().focus(),self.getWin().focus()),(isGecko||contentEditable)&&(body=self.getBody(),body.setActive&&Env.ie<11?body.setActive():body.focus(),contentEditable&&selection.normalize()),controlElm&&controlElm.ownerDocument==doc&&(rng=doc.body.createControlRange(),rng.addElement(controlElm),rng.select())),self.editorManager.activeEditor!=self&&((oed=self.editorManager.activeEditor)&&oed.fire("deactivate",{relatedTarget:self}),self.fire("activate",{relatedTarget:oed})),self.editorManager.activeEditor=self},execCallback:function(name){var scope,self=this,callback=self.settings[name];if(callback)return self.callbackLookup&&(scope=self.callbackLookup[name])&&(callback=scope.func,scope=scope.scope),"string"==typeof callback&&(scope=callback.replace(/\.\w+$/,""),scope=scope?resolve(scope):0,callback=resolve(callback),self.callbackLookup=self.callbackLookup||{},self.callbackLookup[name]={func:callback,scope:scope}),callback.apply(scope||self,Array.prototype.slice.call(arguments,1))},translate:function(text){var lang=this.settings.language||"en",i18n=this.editorManager.i18n;return text?i18n.data[lang+"."+text]||text.replace(/\{\#([^\}]+)\}/g,function(a,b){return i18n.data[lang+"."+b]||"{#"+b+"}"}):""},getLang:function(name,defaultVal){return this.editorManager.i18n.data[(this.settings.language||"en")+"."+name]||(defaultVal!==undefined?defaultVal:"{#"+name+"}")},getParam:function(name,defaultVal,type){var output,value=name in this.settings?this.settings[name]:defaultVal;return"hash"===type?(output={},"string"==typeof value?each(value.indexOf("=")>0?value.split(/[;,](?![^=;,]*(?:[;,]|$))/):value.split(","),function(value){value=value.split("="),output[trim(value[0])]=value.length>1?trim(value[1]):trim(value)}):output=value,output):value},nodeChanged:function(){var node,parents,root,self=this,selection=self.selection;self.initialized&&!self.settings.disable_nodechange&&(root=self.getBody(),node=selection.getStart()||root,node=ie&&node.ownerDocument!=self.getDoc()?self.getBody():node,"IMG"==node.nodeName&&selection.isCollapsed()&&(node=node.parentNode),parents=[],self.dom.getParent(node,function(node){return node===root?!0:(parents.push(node),void 0)}),self.fire("NodeChange",{element:node,parents:parents}))},addButton:function(name,settings){var self=this;settings.cmd&&(settings.onclick=function(){self.execCommand(settings.cmd)}),settings.text||settings.icon||(settings.icon=name),self.buttons=self.buttons||{},settings.tooltip=settings.tooltip||settings.title,self.buttons[name]=settings},addMenuItem:function(name,settings){var self=this;settings.cmd&&(settings.onclick=function(){self.execCommand(settings.cmd)}),self.menuItems=self.menuItems||{},self.menuItems[name]=settings},addCommand:function(name,callback,scope){this.execCommands[name]={func:callback,scope:scope||this}},addQueryStateHandler:function(name,callback,scope){this.queryStateCommands[name]={func:callback,scope:scope||this}},addQueryValueHandler:function(name,callback,scope){this.queryValueCommands[name]={func:callback,scope:scope||this}},addShortcut:function(pattern,desc,cmdFunc,scope){this.shortcuts.add(pattern,desc,cmdFunc,scope)},execCommand:function(cmd,ui,value,args){var cmdItem,self=this,state=0;return/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(cmd)||args&&args.skip_focus||self.focus(),args=extend({},args),args=self.fire("BeforeExecCommand",{command:cmd,ui:ui,value:value}),args.isDefaultPrevented()?!1:(cmdItem=self.execCommands[cmd])&&cmdItem.func.call(cmdItem.scope,ui,value)!==!0?(self.fire("ExecCommand",{command:cmd,ui:ui,value:value}),!0):(each(self.plugins,function(p){return p.execCommand&&p.execCommand(cmd,ui,value)?(self.fire("ExecCommand",{command:cmd,ui:ui,value:value}),state=!0,!1):void 0}),state?state:self.theme&&self.theme.execCommand&&self.theme.execCommand(cmd,ui,value)?(self.fire("ExecCommand",{command:cmd,ui:ui,value:value}),!0):self.editorCommands.execCommand(cmd,ui,value)?(self.fire("ExecCommand",{command:cmd,ui:ui,value:value}),!0):(self.getDoc().execCommand(cmd,ui,value),self.fire("ExecCommand",{command:cmd,ui:ui,value:value}),void 0))},queryCommandState:function(cmd){var queryItem,returnVal,self=this;if(!self._isHidden()){if((queryItem=self.queryStateCommands[cmd])&&(returnVal=queryItem.func.call(queryItem.scope),returnVal!==!0))return returnVal;if(returnVal=self.editorCommands.queryCommandState(cmd),-1!==returnVal)return returnVal;try{return self.getDoc().queryCommandState(cmd)}catch(ex){}}},queryCommandValue:function(cmd){var queryItem,returnVal,self=this;if(!self._isHidden()){if((queryItem=self.queryValueCommands[cmd])&&(returnVal=queryItem.func.call(queryItem.scope),returnVal!==!0))return returnVal;if(returnVal=self.editorCommands.queryCommandValue(cmd),returnVal!==undefined)return returnVal;try{return self.getDoc().queryCommandValue(cmd)}catch(ex){}}},show:function(){var self=this;DOM.show(self.getContainer()),DOM.hide(self.id),self.load(),self.fire("show")},hide:function(){var self=this,doc=self.getDoc();ie&&doc&&!self.inline&&doc.execCommand("SelectAll"),self.save(),DOM.hide(self.getContainer()),DOM.setStyle(self.id,"display",self.orgDisplay),self.fire("hide")},isHidden:function(){return!DOM.isHidden(this.id)},setProgressState:function(state,time){this.fire("ProgressState",{state:state,time:time})},load:function(args){var html,self=this,elm=self.getElement();return elm?(args=args||{},args.load=!0,html=self.setContent(elm.value!==undefined?elm.value:elm.innerHTML,args),args.element=elm,args.no_events||self.fire("LoadContent",args),args.element=elm=null,html):void 0},save:function(args){var html,form,self=this,elm=self.getElement();if(elm&&self.initialized)return args=args||{},args.save=!0,args.element=elm,html=args.content=self.getContent(args),args.no_events||self.fire("SaveContent",args),html=args.content,/TEXTAREA|INPUT/i.test(elm.nodeName)?elm.value=html:(self.inline||(elm.innerHTML=html),(form=DOM.getParent(self.id,"form"))&&each(form.elements,function(elm){return elm.name==self.id?(elm.value=html,!1):void 0})),args.element=elm=null,args.set_dirty!==!1&&(self.isNotDirty=!0),html},setContent:function(content,args){var forcedRootBlockName,self=this,body=self.getBody();return args=args||{},args.format=args.format||"html",args.set=!0,args.content=content,args.no_events||self.fire("BeforeSetContent",args),content=args.content,0===content.length||/^\s+$/.test(content)?(forcedRootBlockName=self.settings.forced_root_block,forcedRootBlockName&&self.schema.isValidChild(body.nodeName.toLowerCase(),forcedRootBlockName.toLowerCase())?(content=ie&&11>ie?"":'<br data-mce-bogus="1">',content=self.dom.createHTML(forcedRootBlockName,self.settings.forced_root_block_attrs,content)):(!ie||11>ie)&&(content='<br data-mce-bogus="1">'),body.innerHTML=content,self.fire("SetContent",args)):("raw"!==args.format&&(content=new Serializer({},self.schema).serialize(self.parser.parse(content,{isRootContent:!0}))),args.content=trim(content),self.dom.setHTML(body,args.content),args.no_events||self.fire("SetContent",args)),args.content},getContent:function(args){var content,self=this,body=self.getBody();return args=args||{},args.format=args.format||"html",args.get=!0,args.getInner=!0,args.no_events||self.fire("BeforeGetContent",args),content="raw"==args.format?body.innerHTML:"text"==args.format?body.innerText||body.textContent:self.serializer.serialize(body,args),args.content="text"!=args.format?trim(content):content,args.no_events||self.fire("GetContent",args),args.content},insertContent:function(content){this.execCommand("mceInsertContent",!1,content)},isDirty:function(){return!this.isNotDirty},getContainer:function(){var self=this;return self.container||(self.container=DOM.get(self.editorContainer||self.id+"_parent")),self.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return DOM.get(this.settings.content_element||this.id)},getWin:function(){var elm,self=this;return self.contentWindow||(elm=DOM.get(self.id+"_ifr"),elm&&(self.contentWindow=elm.contentWindow)),self.contentWindow},getDoc:function(){var win,self=this;return self.contentDocument||(win=self.getWin(),win&&(self.contentDocument=win.document)),self.contentDocument},getBody:function(){return this.bodyElement||this.getDoc().body},convertURL:function(url,name,elm){var self=this,settings=self.settings;return settings.urlconverter_callback?self.execCallback("urlconverter_callback",url,elm,!0,name):!settings.convert_urls||elm&&"LINK"==elm.nodeName||0===url.indexOf("file:")||0===url.length?url:settings.relative_urls?self.documentBaseURI.toRelative(url):url=self.documentBaseURI.toAbsolute(url,settings.remove_script_host)},addVisual:function(elm){var cls,self=this,settings=self.settings,dom=self.dom;elm=elm||self.getBody(),self.hasVisual===undefined&&(self.hasVisual=settings.visual),each(dom.select("table,a",elm),function(elm){var value;switch(elm.nodeName){case"TABLE":return cls=settings.visual_table_class||"mce-item-table",value=dom.getAttrib(elm,"border"),value&&"0"!=value||(self.hasVisual?dom.addClass(elm,cls):dom.removeClass(elm,cls)),void 0;case"A":return dom.getAttrib(elm,"href",!1)||(value=dom.getAttrib(elm,"name")||elm.id,cls=settings.visual_anchor_class||"mce-item-anchor",value&&(self.hasVisual?dom.addClass(elm,cls):dom.removeClass(elm,cls))),void 0}}),self.fire("VisualAid",{element:elm,hasVisual:self.hasVisual})},remove:function(){var self=this;if(!self.removed){self.removed=1,self.hasHiddenInput&&DOM.remove(self.getElement().nextSibling);var doc=self.getDoc();ie&&doc&&!self.inline&&doc.execCommand("SelectAll"),self.save(),DOM.setStyle(self.id,"display",self.orgDisplay),self.settings.content_editable||(Event.unbind(self.getWin()),Event.unbind(self.getDoc()));var elm=self.getContainer();Event.unbind(self.getBody()),Event.unbind(elm),self.fire("remove"),self.editorManager.remove(self),DOM.remove(elm),self.destroy()}},bindNative:function(name){var self=this;self.settings.readonly||(self.initialized?self.dom.bind(getEventTarget(self,name),name,function(e){self.fire(name,e)}):self._pendingNativeEvents?self._pendingNativeEvents.push(name):self._pendingNativeEvents=[name])},unbindNative:function(name){var self=this;self.initialized&&self.dom.unbind(name)},destroy:function(automatic){var form,self=this;if(!self.destroyed){if(!automatic&&!self.removed)return self.remove(),void 0;automatic&&isGecko&&(Event.unbind(self.getDoc()),Event.unbind(self.getWin()),Event.unbind(self.getBody())),automatic||(self.editorManager.off("beforeunload",self._beforeUnload),self.theme&&self.theme.destroy&&self.theme.destroy(),self.selection.destroy(),self.dom.destroy()),form=self.formElement,form&&(form._mceOldSubmit&&(form.submit=form._mceOldSubmit,form._mceOldSubmit=null),DOM.unbind(form,"submit reset",self.formEventDelegate)),self.contentAreaContainer=self.formElement=self.container=null,self.settings.content_element=self.bodyElement=self.contentDocument=self.contentWindow=null,self.selection&&(self.selection=self.selection.win=self.selection.dom=self.selection.dom.doc=null),self.destroyed=1}},_refreshContentEditable:function(){var body,parent,self=this;self._isHidden()&&(body=self.getBody(),parent=body.parentNode,parent.removeChild(body),parent.appendChild(body),body.focus())},_isHidden:function(){var sel;return isGecko?(sel=this.selection.getSel(),!sel||!sel.rangeCount||0===sel.rangeCount):0}},extend(Editor.prototype,Observable),Editor}),/**
 * I18n.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/util/I18n",[],function(){var data={};return{rtl:!1,add:function(code,items){for(var name in items)data[name]=items[name];this.rtl=this.rtl||"rtl"===data._dir},translate:function(text){if("undefined"==typeof text)return text;if("string"!=typeof text&&text.raw)return text.raw;if(text.push){var values=text.slice(1);text=(data[text[0]]||text[0]).replace(/\{([^\}]+)\}/g,function(match1,match2){return values[match2]})}return data[text]||text},data:data}}),/**
 * FocusManager.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/FocusManager",["tinymce/dom/DOMUtils","tinymce/Env"],function(DOMUtils,Env){function FocusManager(editorManager){function getActiveElement(){try{return document.activeElement}catch(ex){return document.body}}function createBookmark(rng){return rng&&rng.startContainer?{startContainer:rng.startContainer,startOffset:rng.startOffset,endContainer:rng.endContainer,endOffset:rng.endOffset}:rng}function bookmarkToRng(editor,bookmark){var rng;return bookmark.startContainer?(rng=editor.getDoc().createRange(),rng.setStart(bookmark.startContainer,bookmark.startOffset),rng.setEnd(bookmark.endContainer,bookmark.endOffset)):rng=bookmark,rng}function isUIElement(elm){return!!DOMUtils.DOM.getParent(elm,FocusManager.isEditorUIElement)}function isNodeInBodyOfEditor(node,editor){for(var body=editor.getBody();node;){if(node==body)return!0;node=node.parentNode}}function registerEvents(e){var selectionChangeHandler,editor=e.editor;editor.on("init",function(){"onbeforedeactivate"in document&&Env.ie<11?(editor.dom.bind(editor.getBody(),"beforedeactivate",function(){try{editor.pendingRng=editor.selection.getRng()}catch(ex){}}),editor.dom.bind(editor.getBody(),"blur",function(){editor.pendingRng&&(editor.lastRng=editor.pendingRng,editor.selection.lastFocusBookmark=createBookmark(editor.lastRng),editor.pendingRng=null)})):(editor.inline||Env.ie>10)&&(editor.on("nodechange keyup",function(){var node=document.activeElement;node&&node.id==editor.id+"_ifr"&&(node=editor.getBody()),isNodeInBodyOfEditor(node,editor)&&(editor.lastRng=editor.selection.getRng())}),Env.webkit&&(selectionChangeHandler=function(){var rng=editor.selection.getRng();rng.collapsed||(editor.lastRng=rng)},DOMUtils.DOM.bind(document,"selectionchange",selectionChangeHandler),editor.on("remove",function(){DOMUtils.DOM.unbind(document,"selectionchange",selectionChangeHandler)})))}),editor.on("setcontent",function(){editor.lastRng=null}),editor.on("mousedown",function(){editor.selection.lastFocusBookmark=null}),editor.on("focusin",function(){var focusedEditor=editorManager.focusedEditor;editor.selection.lastFocusBookmark&&(editor.selection.setRng(bookmarkToRng(editor,editor.selection.lastFocusBookmark)),editor.selection.lastFocusBookmark=null),focusedEditor!=editor&&(focusedEditor&&focusedEditor.fire("blur",{focusedEditor:editor}),editorManager.activeEditor=editor,editorManager.focusedEditor=editor,editor.fire("focus",{blurredEditor:focusedEditor}),editor.focus(!0)),editor.lastRng=null}),editor.on("focusout",function(){window.setTimeout(function(){var focusedEditor=editorManager.focusedEditor;isUIElement(getActiveElement())||focusedEditor!=editor||(editor.fire("blur",{focusedEditor:null}),editorManager.focusedEditor=null,editor.selection&&(editor.selection.lastFocusBookmark=null))},0)})}DOMUtils.DOM.bind(document,"focusin",function(e){var activeEditor=editorManager.activeEditor;activeEditor&&e.target.ownerDocument==document&&(activeEditor.selection&&(activeEditor.selection.lastFocusBookmark=createBookmark(activeEditor.lastRng)),isUIElement(e.target)||editorManager.focusedEditor!=activeEditor||(activeEditor.fire("blur",{focusedEditor:null}),editorManager.focusedEditor=null))}),editorManager.on("AddEditor",registerEvents)}return FocusManager.isEditorUIElement=function(elm){return-1!==elm.className.indexOf("mce-")},FocusManager}),/**
 * EditorManager.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/EditorManager",["tinymce/Editor","tinymce/dom/DOMUtils","tinymce/util/URI","tinymce/Env","tinymce/util/Tools","tinymce/util/Observable","tinymce/util/I18n","tinymce/FocusManager"],function(Editor,DOMUtils,URI,Env,Tools,Observable,I18n,FocusManager){var beforeUnloadDelegate,DOM=DOMUtils.DOM,explode=Tools.explode,each=Tools.each,extend=Tools.extend,instanceCounter=0,EditorManager={majorVersion:"4",minorVersion:"0.18",releaseDate:"2014-02-27",editors:[],i18n:I18n,activeEditor:null,setup:function(){var baseURL,documentBaseURL,preInit,self=this,suffix="";if(documentBaseURL=document.location.href.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(documentBaseURL)||(documentBaseURL+="/"),preInit=window.tinymce||window.tinyMCEPreInit)baseURL=preInit.base||preInit.baseURL,suffix=preInit.suffix;else for(var scripts=document.getElementsByTagName("script"),i=0;i<scripts.length;i++){var src=scripts[i].src;if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(src)){-1!=src.indexOf(".min")&&(suffix=".min"),baseURL=src.substring(0,src.lastIndexOf("/"));break}}self.baseURL=new URI(documentBaseURL).toAbsolute(baseURL),self.documentBaseURL=documentBaseURL,self.baseURI=new URI(self.baseURL),self.suffix=suffix,self.focusManager=new FocusManager(self)},init:function(settings){function createId(elm){var id=elm.id;return id||(id=elm.name,id=id&&!DOM.get(id)?elm.name:DOM.uniqueId(),elm.setAttribute("id",id)),id}function execCallback(se,n,s){var f=se[n];if(f)return f.apply(s||this,Array.prototype.slice.call(arguments,2))}function hasClass(n,c){return c.constructor===RegExp?c.test(n.className):DOM.hasClass(n,c)}function readyHandler(){var l,co;if(DOM.unbind(window,"ready",readyHandler),execCallback(settings,"onpageload"),settings.types)return each(settings.types,function(type){each(DOM.select(type.selector),function(elm){var editor=new Editor(createId(elm),extend({},settings,type),self);editors.push(editor),editor.render(1)})}),void 0;if(settings.selector)return each(DOM.select(settings.selector),function(elm){var editor=new Editor(createId(elm),settings,self);editors.push(editor),editor.render(1)}),void 0;switch(settings.mode){case"exact":l=settings.elements||"",l.length>0&&each(explode(l),function(v){DOM.get(v)?(editor=new Editor(v,settings,self),editors.push(editor),editor.render(!0)):each(document.forms,function(f){each(f.elements,function(e){e.name===v&&(v="mce_editor_"+instanceCounter++,DOM.setAttrib(e,"id",v),editor=new Editor(v,settings,self),editors.push(editor),editor.render(1))})})});break;case"textareas":case"specific_textareas":each(DOM.select("textarea"),function(elm){settings.editor_deselector&&hasClass(elm,settings.editor_deselector)||(!settings.editor_selector||hasClass(elm,settings.editor_selector))&&(editor=new Editor(createId(elm),settings,self),editors.push(editor),editor.render(!0))})}settings.oninit&&(l=co=0,each(editors,function(ed){co++,ed.initialized?l++:ed.on("init",function(){l++,l==co&&execCallback(settings,"oninit")}),l==co&&execCallback(settings,"oninit")}))}var editor,self=this,editors=[];self.settings=settings,DOM.bind(window,"ready",readyHandler)},get:function(id){return id===undefined?this.editors:this.editors[id]},add:function(editor){var self=this,editors=self.editors;return editors[editor.id]=editor,editors.push(editor),self.activeEditor=editor,self.fire("AddEditor",{editor:editor}),beforeUnloadDelegate||(beforeUnloadDelegate=function(){self.fire("BeforeUnload")},DOM.bind(window,"beforeunload",beforeUnloadDelegate)),editor},createEditor:function(id,settings){return this.add(new Editor(id,settings,this))},remove:function(selector){var i,editor,removedFromList,self=this,editors=self.editors;{if(selector){if("string"==typeof selector)return selector=selector.selector||selector,each(DOM.select(selector),function(elm){self.remove(editors[elm.id])}),void 0;if(editor=selector,!editors[editor.id])return null;for(delete editors[editor.id],i=0;i<editors.length;i++)if(editors[i]==editor){editors.splice(i,1),removedFromList=!0;break}return self.activeEditor==editor&&(self.activeEditor=editors[0]),removedFromList&&self.fire("RemoveEditor",{editor:editor}),editors.length||DOM.unbind(window,"beforeunload",beforeUnloadDelegate),editor.remove(),editor}for(i=editors.length-1;i>=0;i--)self.remove(editors[i])}},execCommand:function(cmd,ui,value){var self=this,editor=self.get(value);switch(cmd){case"mceAddEditor":return self.get(value)||new Editor(value,self.settings,self).render(),!0;case"mceRemoveEditor":return editor&&editor.remove(),!0;case"mceToggleEditor":return editor?(editor.isHidden()?editor.show():editor.hide(),!0):(self.execCommand("mceAddEditor",0,value),!0)}return self.activeEditor?self.activeEditor.execCommand(cmd,ui,value):!1},triggerSave:function(){each(this.editors,function(editor){editor.save()})},addI18n:function(code,items){I18n.add(code,items)},translate:function(text){return I18n.translate(text)}};return extend(EditorManager,Observable),EditorManager.setup(),window.tinymce=window.tinyMCE=EditorManager,EditorManager}),/**
 * LegacyInput.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/LegacyInput",["tinymce/EditorManager","tinymce/util/Tools"],function(EditorManager,Tools){var each=Tools.each,explode=Tools.explode;EditorManager.on("AddEditor",function(e){var editor=e.editor;editor.on("preInit",function(){function replaceWithSpan(node,styles){each(styles,function(value,name){value&&dom.setStyle(node,name,value)}),dom.rename(node,"span")}function convert(e){dom=editor.dom,settings.convert_fonts_to_spans&&each(dom.select("font,u,strike",e.node),function(node){filters[node.nodeName.toLowerCase()](dom,node)})}var filters,fontSizes,dom,settings=editor.settings;settings.inline_styles&&(fontSizes=explode(settings.font_size_legacy_values),filters={font:function(dom,node){replaceWithSpan(node,{backgroundColor:node.style.backgroundColor,color:node.color,fontFamily:node.face,fontSize:fontSizes[parseInt(node.size,10)-1]})},u:function(dom,node){replaceWithSpan(node,{textDecoration:"underline"})},strike:function(dom,node){replaceWithSpan(node,{textDecoration:"line-through"})}},editor.on("PreProcess SetContent",convert))})})}),/**
 * XHR.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/util/XHR",[],function(){return{send:function(settings){function ready(){!settings.async||4==xhr.readyState||count++>1e4?(settings.success&&1e4>count&&200==xhr.status?settings.success.call(settings.success_scope,""+xhr.responseText,xhr,settings):settings.error&&settings.error.call(settings.error_scope,count>1e4?"TIMED_OUT":"GENERAL",xhr,settings),xhr=null):setTimeout(ready,10)}var xhr,count=0;if(settings.scope=settings.scope||this,settings.success_scope=settings.success_scope||settings.scope,settings.error_scope=settings.error_scope||settings.scope,settings.async=settings.async===!1?!1:!0,settings.data=settings.data||"",xhr=new XMLHttpRequest){if(xhr.overrideMimeType&&xhr.overrideMimeType(settings.content_type),xhr.open(settings.type||(settings.data?"POST":"GET"),settings.url,settings.async),settings.content_type&&xhr.setRequestHeader("Content-Type",settings.content_type),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.send(settings.data),!settings.async)return ready();setTimeout(ready,10)}}}}),/**
 * JSON.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/util/JSON",[],function(){function serialize(o,quote){var i,v,t,name;if(quote=quote||'"',null===o)return"null";if(t=typeof o,"string"==t)return v="\bb	t\nn\ff\rr\"\"''\\\\",quote+o.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,b){return'"'===quote&&"'"===a?a:(i=v.indexOf(b),i+1?"\\"+v.charAt(i+1):(a=b.charCodeAt().toString(16),"\\u"+"0000".substring(a.length)+a))})+quote;if("object"==t){if(o.hasOwnProperty&&"[object Array]"===Object.prototype.toString.call(o)){for(i=0,v="[";i<o.length;i++)v+=(i>0?",":"")+serialize(o[i],quote);return v+"]"}v="{";for(name in o)o.hasOwnProperty(name)&&(v+="function"!=typeof o[name]?(v.length>1?","+quote:quote)+name+quote+":"+serialize(o[name],quote):"");return v+"}"}return""+o}return{serialize:serialize,parse:function(text){try{return window[String.fromCharCode(101)+"val"]("("+text+")")}catch(ex){}}}}),/**
 * JSONRequest.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/util/JSONRequest",["tinymce/util/JSON","tinymce/util/XHR","tinymce/util/Tools"],function(JSON,XHR,Tools){function JSONRequest(settings){this.settings=extend({},settings),this.count=0}var extend=Tools.extend;return JSONRequest.sendRPC=function(o){return(new JSONRequest).send(o)},JSONRequest.prototype={send:function(args){var ecb=args.error,scb=args.success;args=extend(this.settings,args),args.success=function(c,x){c=JSON.parse(c),"undefined"==typeof c&&(c={error:"JSON Parse error."}),c.error?ecb.call(args.error_scope||args.scope,c.error,x):scb.call(args.success_scope||args.scope,c.result)},args.error=function(ty,x){ecb&&ecb.call(args.error_scope||args.scope,ty,x)},args.data=JSON.serialize({id:args.id||"c"+this.count++,method:args.method,params:args.params}),args.content_type="application/json",XHR.send(args)}},JSONRequest}),/**
 * JSONP.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/util/JSONP",["tinymce/dom/DOMUtils"],function(DOMUtils){return{callbacks:{},count:0,send:function(settings){var self=this,dom=DOMUtils.DOM,count=settings.count!==undefined?settings.count:self.count,id="tinymce_jsonp_"+count;self.callbacks[count]=function(json){dom.remove(id),delete self.callbacks[count],settings.callback(json)},dom.add(dom.doc.body,"script",{id:id,src:settings.url,type:"text/javascript"}),self.count++}}}),/**
 * LocalStorage.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/util/LocalStorage",[],function(){function updateKeys(){keys=[];for(var key in items)keys.push(key);LocalStorage.length=keys.length}function load(){function next(end){var value,nextPos;return nextPos=end!==undefined?pos+end:data.indexOf(",",pos),-1===nextPos||nextPos>data.length?null:(value=data.substring(pos,nextPos),pos=nextPos+1,value)}var key,data,value,pos=0;if(items={},hasOldIEDataSupport){storageElm.load(userDataKey),data=storageElm.getAttribute(userDataKey)||"";do{var offset=next();if(null===offset)break;if(key=next(parseInt(offset,32)||0),null!==key){if(offset=next(),null===offset)break;value=next(parseInt(offset,32)||0),key&&(items[key]=value)}}while(null!==key);updateKeys()}}function save(){var value,data="";if(hasOldIEDataSupport){for(var key in items)value=items[key],data+=(data?",":"")+key.length.toString(32)+","+key+","+value.length.toString(32)+","+value;storageElm.setAttribute(userDataKey,data);try{storageElm.save(userDataKey)}catch(ex){}updateKeys()}}var LocalStorage,storageElm,items,keys,userDataKey,hasOldIEDataSupport;try{if(window.localStorage)return localStorage}catch(ex){}return userDataKey="tinymce",storageElm=document.documentElement,hasOldIEDataSupport=!!storageElm.addBehavior,hasOldIEDataSupport&&storageElm.addBehavior("#default#userData"),LocalStorage={key:function(index){return keys[index]},getItem:function(key){return key in items?items[key]:null},setItem:function(key,value){items[key]=""+value,save()},removeItem:function(key){delete items[key],save()},clear:function(){items={},save()}},load(),LocalStorage}),/**
 * Compat.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/Compat",["tinymce/dom/DOMUtils","tinymce/dom/EventUtils","tinymce/dom/ScriptLoader","tinymce/AddOnManager","tinymce/util/Tools","tinymce/Env"],function(DOMUtils,EventUtils,ScriptLoader,AddOnManager,Tools,Env){var tinymce=window.tinymce;return tinymce.DOM=DOMUtils.DOM,tinymce.ScriptLoader=ScriptLoader.ScriptLoader,tinymce.PluginManager=AddOnManager.PluginManager,tinymce.ThemeManager=AddOnManager.ThemeManager,tinymce.dom=tinymce.dom||{},tinymce.dom.Event=EventUtils.Event,Tools.each(Tools,function(func,key){tinymce[key]=func}),Tools.each("isOpera isWebKit isIE isGecko isMac".split(" "),function(name){tinymce[name]=Env[name.substr(2).toLowerCase()]}),{}}),/**
 * Layout.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Layout",["tinymce/util/Class","tinymce/util/Tools"],function(Class,Tools){return Class.extend({Defaults:{firstControlClass:"first",lastControlClass:"last"},init:function(settings){this.settings=Tools.extend({},this.Defaults,settings)},preRender:function(container){container.addClass(this.settings.containerClass,"body")},applyClasses:function(container){var items,firstClass,lastClass,self=this,settings=self.settings;items=container.items().filter(":visible"),firstClass=settings.firstControlClass,lastClass=settings.lastControlClass,items.each(function(item){item.removeClass(firstClass).removeClass(lastClass),settings.controlClass&&item.addClass(settings.controlClass)}),items.eq(0).addClass(firstClass),items.eq(-1).addClass(lastClass)},renderHtml:function(container){var items,self=this,settings=self.settings,html="";return items=container.items(),items.eq(0).addClass(settings.firstControlClass),items.eq(-1).addClass(settings.lastControlClass),items.each(function(item){settings.controlClass&&item.addClass(settings.controlClass),html+=item.renderHtml()}),html},recalc:function(){},postRender:function(){}})}),/**
 * AbsoluteLayout.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/AbsoluteLayout",["tinymce/ui/Layout"],function(Layout){return Layout.extend({Defaults:{containerClass:"abs-layout",controlClass:"abs-layout-item"},recalc:function(container){container.items().filter(":visible").each(function(ctrl){var settings=ctrl.settings;ctrl.layoutRect({x:settings.x,y:settings.y,w:settings.w,h:settings.h}),ctrl.recalc&&ctrl.recalc()})},renderHtml:function(container){return'<div id="'+container._id+'-absend" class="'+container.classPrefix+'abs-end"></div>'+this._super(container)}})}),/**
 * Tooltip.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Tooltip",["tinymce/ui/Control","tinymce/ui/Movable"],function(Control,Movable){return Control.extend({Mixins:[Movable],Defaults:{classes:"widget tooltip tooltip-n"},text:function(value){var self=this;return"undefined"!=typeof value?(self._value=value,self._rendered&&(self.getEl().lastChild.innerHTML=self.encode(value)),self):self._value},renderHtml:function(){var self=this,prefix=self.classPrefix;return'<div id="'+self._id+'" class="'+self.classes()+'" role="presentation">'+'<div class="'+prefix+'tooltip-arrow"></div>'+'<div class="'+prefix+'tooltip-inner">'+self.encode(self._text)+"</div>"+"</div>"},repaint:function(){var style,rect,self=this;style=self.getEl().style,rect=self._layoutRect,style.left=rect.x+"px",style.top=rect.y+"px",style.zIndex=131070}})}),/**
 * Widget.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Widget",["tinymce/ui/Control","tinymce/ui/Tooltip"],function(Control,Tooltip){var tooltip,Widget=Control.extend({init:function(settings){var self=this;self._super(settings),self.canFocus=!0,settings.tooltip&&Widget.tooltips!==!1&&(self.on("mouseenter",function(e){var tooltip=self.tooltip().moveTo(-65535);if(e.control==self){var rel=tooltip.text(settings.tooltip).show().testMoveRel(self.getEl(),["bc-tc","bc-tl","bc-tr"]);tooltip.toggleClass("tooltip-n","bc-tc"==rel),tooltip.toggleClass("tooltip-nw","bc-tl"==rel),tooltip.toggleClass("tooltip-ne","bc-tr"==rel),tooltip.moveRel(self.getEl(),rel)}else tooltip.hide()}),self.on("mouseleave mousedown click",function(){self.tooltip().hide()})),self.aria("label",settings.ariaLabel||settings.tooltip)},tooltip:function(){return tooltip||(tooltip=new Tooltip({type:"tooltip"}),tooltip.renderTo()),tooltip},active:function(state){var undef,self=this;return state!==undef&&(self.aria("pressed",state),self.toggleClass("active",state)),self._super(state)},disabled:function(state){var undef,self=this;return state!==undef&&(self.aria("disabled",state),self.toggleClass("disabled",state)),self._super(state)},postRender:function(){var self=this,settings=self.settings;self._rendered=!0,self._super(),self.parent()||!settings.width&&!settings.height||(self.initLayoutRect(),self.repaint()),settings.autofocus&&self.focus()},remove:function(){this._super(),tooltip&&(tooltip.remove(),tooltip=null)}});return Widget}),/**
 * Button.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Button",["tinymce/ui/Widget"],function(Widget){return Widget.extend({Defaults:{classes:"widget btn",role:"button"},init:function(settings){var size,self=this;self.on("click mousedown",function(e){e.preventDefault()}),self._super(settings),size=settings.size,settings.subtype&&self.addClass(settings.subtype),size&&self.addClass("btn-"+size)},icon:function(icon){var self=this,prefix=self.classPrefix;if("undefined"==typeof icon)return self.settings.icon;if(self.settings.icon=icon,icon=icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"",self._rendered){var btnElm=self.getEl().firstChild,iconElm=btnElm.getElementsByTagName("i")[0];icon?(iconElm&&iconElm==btnElm.firstChild||(iconElm=document.createElement("i"),btnElm.insertBefore(iconElm,btnElm.firstChild)),iconElm.className=icon):iconElm&&btnElm.removeChild(iconElm),self.text(self._text)}return self},repaint:function(){var btnStyle=this.getEl().firstChild.style;btnStyle.width=btnStyle.height="100%",this._super()},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix,icon=self.settings.icon,image="";return self.settings.image&&(icon="none",image=" style=\"background-image: url('"+self.settings.image+"')\""),icon=self.settings.icon?prefix+"ico "+prefix+"i-"+icon:"",'<div id="'+id+'" class="'+self.classes()+'" tabindex="-1" aria-labelledby="'+id+'">'+'<button role="presentation" type="button" tabindex="-1">'+(icon?'<i class="'+icon+'"'+image+"></i>":"")+(self._text?(icon?" ":"")+self.encode(self._text):"")+"</button>"+"</div>"}})}),/**
 * ButtonGroup.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/ButtonGroup",["tinymce/ui/Container"],function(Container){return Container.extend({Defaults:{defaultType:"button",role:"group"},renderHtml:function(){var self=this,layout=self._layout;return self.addClass("btn-group"),self.preRender(),layout.preRender(self),'<div id="'+self._id+'" class="'+self.classes()+'">'+'<div id="'+self._id+'-body">'+(self.settings.html||"")+layout.renderHtml(self)+"</div>"+"</div>"}})}),/**
 * Checkbox.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Checkbox",["tinymce/ui/Widget"],function(Widget){return Widget.extend({Defaults:{classes:"checkbox",role:"checkbox",checked:!1},init:function(settings){var self=this;self._super(settings),self.on("click mousedown",function(e){e.preventDefault()}),self.on("click",function(e){e.preventDefault(),self.disabled()||self.checked(!self.checked())}),self.checked(self.settings.checked)},checked:function(state){var self=this;return"undefined"!=typeof state?(state?self.addClass("checked"):self.removeClass("checked"),self._checked=state,self.aria("checked",state),self):self._checked},value:function(state){return this.checked(state)},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix;return'<div id="'+id+'" class="'+self.classes()+'" unselectable="on" aria-labelledby="'+id+'-al" tabindex="-1">'+'<i class="'+prefix+"ico "+prefix+'i-checkbox"></i>'+'<span id="'+id+'-al" class="'+prefix+'label">'+self.encode(self._text)+"</span>"+"</div>"}})}),/**
 * PanelButton.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/PanelButton",["tinymce/ui/Button","tinymce/ui/FloatPanel"],function(Button,FloatPanel){return Button.extend({showPanel:function(){var self=this,settings=self.settings;if(self.active(!0),self.panel)self.panel.show();else{var panelSettings=settings.panel;panelSettings.type&&(panelSettings={layout:"grid",items:panelSettings}),panelSettings.role=panelSettings.role||"dialog",panelSettings.popover=!0,panelSettings.autohide=!0,panelSettings.ariaRoot=!0,self.panel=new FloatPanel(panelSettings).on("hide",function(){self.active(!1)}).on("cancel",function(e){e.stopPropagation(),self.focus(),self.hidePanel()}).parent(self).renderTo(self.getContainerElm()),self.panel.fire("show"),self.panel.reflow()}self.panel.moveRel(self.getEl(),settings.popoverAlign||(self.isRtl()?["bc-tr","bc-tc"]:["bc-tl","bc-tc"]))},hidePanel:function(){var self=this;self.panel&&self.panel.hide()},postRender:function(){var self=this;return self.aria("haspopup",!0),self.on("click",function(e){e.control===self&&(self.panel&&self.panel.visible()?self.hidePanel():(self.showPanel(),self.panel.focus(!!e.aria)))}),self._super()}})}),/**
 * ColorButton.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/ColorButton",["tinymce/ui/PanelButton","tinymce/dom/DOMUtils"],function(PanelButton,DomUtils){var DOM=DomUtils.DOM;return PanelButton.extend({init:function(settings){this._super(settings),this.addClass("colorbutton")},color:function(color){return color?(this._color=color,this.getEl("preview").style.backgroundColor=color,this):this._color},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix,icon=self.settings.icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"",image=self.settings.image?" style=\"background-image: url('"+self.settings.image+"')\"":"";return'<div id="'+id+'" class="'+self.classes()+'" role="button" tabindex="-1" aria-haspopup="true">'+'<button role="presentation" hidefocus type="button" tabindex="-1">'+(icon?'<i class="'+icon+'"'+image+"></i>":"")+'<span id="'+id+'-preview" class="'+prefix+'preview"></span>'+(self._text?(icon?" ":"")+self._text:"")+"</button>"+'<button type="button" class="'+prefix+'open" hidefocus tabindex="-1">'+' <i class="'+prefix+'caret"></i>'+"</button>"+"</div>"},postRender:function(){var self=this,onClickHandler=self.settings.onclick;return self.on("click",function(e){e.aria&&"down"==e.aria.key||e.control!=self||DOM.getParent(e.target,"."+self.classPrefix+"open")||(e.stopImmediatePropagation(),onClickHandler.call(self,e))}),delete self.settings.onclick,self._super()}})}),/**
 * ComboBox.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/ComboBox",["tinymce/ui/Widget","tinymce/ui/Factory","tinymce/ui/DomUtils"],function(Widget,Factory,DomUtils){return Widget.extend({init:function(settings){var self=this;self._super(settings),self.addClass("combobox"),self.subinput=!0,self.ariaTarget="inp",settings=self.settings,settings.menu=settings.menu||settings.values,settings.menu&&(settings.icon="caret"),self.on("click",function(e){for(var elm=e.target,root=self.getEl();elm&&elm!=root;)elm.id&&-1!=elm.id.indexOf("-open")&&(self.fire("action"),settings.menu&&(self.showMenu(),e.aria&&self.menu.items()[0].focus())),elm=elm.parentNode}),self.on("keydown",function(e){"INPUT"==e.target.nodeName&&13==e.keyCode&&self.parents().reverse().each(function(ctrl){return e.preventDefault(),self.fire("change"),ctrl.hasEventListeners("submit")&&ctrl.toJSON?(ctrl.fire("submit",{data:ctrl.toJSON()}),!1):void 0})}),settings.placeholder&&(self.addClass("placeholder"),self.on("focusin",function(){self._hasOnChange||(DomUtils.on(self.getEl("inp"),"change",function(){self.fire("change")}),self._hasOnChange=!0),self.hasClass("placeholder")&&(self.getEl("inp").value="",self.removeClass("placeholder"))}),self.on("focusout",function(){0===self.value().length&&(self.getEl("inp").value=settings.placeholder,self.addClass("placeholder"))}))},showMenu:function(){var menu,self=this,settings=self.settings;self.menu||(menu=settings.menu||[],menu.length?menu={type:"menu",items:menu}:menu.type=menu.type||"menu",self.menu=Factory.create(menu).parent(self).renderTo(self.getContainerElm()),self.fire("createmenu"),self.menu.reflow(),self.menu.on("cancel",function(e){e.control===self.menu&&self.focus()}),self.menu.on("show hide",function(e){e.control.items().each(function(ctrl){ctrl.active(ctrl.value()==self.value())})}).fire("show"),self.menu.on("select",function(e){self.value(e.control.value())}),self.on("focusin",function(e){"INPUT"==e.target.tagName&&self.menu.hide()}),self.aria("expanded",!0)),self.menu.show(),self.menu.layoutRect({w:self.layoutRect().w}),self.menu.moveRel(self.getEl(),self.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])},value:function(value){var self=this;return"undefined"!=typeof value?(self._value=value,self.removeClass("placeholder"),self._rendered&&(self.getEl("inp").value=value),self):self._rendered?(value=self.getEl("inp").value,value!=self.settings.placeholder?value:""):self._value},disabled:function(state){var self=this;return self._rendered&&"undefined"!=typeof state&&(self.getEl("inp").disabled=state),self._super(state)},focus:function(){this.getEl("inp").focus()},repaint:function(){var width,lineHeight,self=this,elm=self.getEl(),openElm=self.getEl("open"),rect=self.layoutRect();width=openElm?rect.w-DomUtils.getSize(openElm).width-10:rect.w-10;var doc=document;return doc.all&&(!doc.documentMode||doc.documentMode<=8)&&(lineHeight=self.layoutRect().h-2+"px"),DomUtils.css(elm.firstChild,{width:width,lineHeight:lineHeight}),self._super(),self},postRender:function(){var self=this;return DomUtils.on(this.getEl("inp"),"change",function(){self.fire("change")}),self._super()},remove:function(){DomUtils.off(this.getEl("inp")),this._super()},renderHtml:function(){var icon,text,self=this,id=self._id,settings=self.settings,prefix=self.classPrefix,value=settings.value||settings.placeholder||"",openBtnHtml="",extraAttrs="";return"spellcheck"in settings&&(extraAttrs+=' spellcheck="'+settings.spellcheck+'"'),settings.maxLength&&(extraAttrs+=' maxlength="'+settings.maxLength+'"'),settings.size&&(extraAttrs+=' size="'+settings.size+'"'),settings.subtype&&(extraAttrs+=' type="'+settings.subtype+'"'),self.disabled()&&(extraAttrs+=' disabled="disabled"'),icon=settings.icon,icon&&"caret"!=icon&&(icon=prefix+"ico "+prefix+"i-"+settings.icon),text=self._text,(icon||text)&&(openBtnHtml='<div id="'+id+'-open" class="'+prefix+"btn "+prefix+'open" tabIndex="-1" role="button">'+'<button id="'+id+'-action" type="button" hidefocus tabindex="-1">'+("caret"!=icon?'<i class="'+icon+'"></i>':'<i class="'+prefix+'caret"></i>')+(text?(icon?" ":"")+text:"")+"</button>"+"</div>",self.addClass("has-open")),'<div id="'+id+'" class="'+self.classes()+'">'+'<input id="'+id+'-inp" class="'+prefix+"textbox "+prefix+'placeholder" value="'+value+'" hidefocus="true"'+extraAttrs+">"+openBtnHtml+"</div>"}})}),/**
 * Path.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Path",["tinymce/ui/Widget"],function(Widget){return Widget.extend({init:function(settings){var self=this;settings.delimiter||(settings.delimiter="»"),self._super(settings),self.addClass("path"),self.canFocus=!0,self.on("click",function(e){var index,target=e.target;(index=target.getAttribute("data-index"))&&self.fire("select",{value:self.data()[index],index:index})})},focus:function(){var self=this;return self.getEl().firstChild.focus(),self},data:function(data){var self=this;return"undefined"!=typeof data?(self._data=data,self.update(),self):self._data},update:function(){this.innerHtml(this._getPathHtml())},postRender:function(){var self=this;self._super(),self.data(self.settings.data)},renderHtml:function(){var self=this;return'<div id="'+self._id+'" class="'+self.classes()+'">'+self._getPathHtml()+"</div>"},_getPathHtml:function(){var i,l,self=this,parts=self._data||[],html="",prefix=self.classPrefix;for(i=0,l=parts.length;l>i;i++)html+=(i>0?'<div class="'+prefix+'divider" aria-hidden="true"> '+self.settings.delimiter+" </div>":"")+'<div role="button" class="'+prefix+"path-item"+(i==l-1?" "+prefix+"last":"")+'" data-index="'+i+'" tabindex="-1" id="'+self._id+"-"+i+'" aria-level="'+i+'">'+parts[i].name+"</div>";return html||(html='<div class="'+prefix+'path-item">&nbsp;</div>'),html}})}),/**
 * ElementPath.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/ElementPath",["tinymce/ui/Path","tinymce/EditorManager"],function(Path,EditorManager){return Path.extend({postRender:function(){function isHidden(elm){if(1===elm.nodeType){if("BR"==elm.nodeName||elm.getAttribute("data-mce-bogus"))return!0;if("bookmark"===elm.getAttribute("data-mce-type"))return!0}return!1}var self=this,editor=EditorManager.activeEditor;return self.on("select",function(e){var node,parents=[],body=editor.getBody();for(editor.focus(),node=editor.selection.getStart();node&&node!=body;)isHidden(node)||parents.push(node),node=node.parentNode;editor.selection.select(parents[parents.length-1-e.index]),editor.nodeChanged()}),editor.on("nodeChange",function(e){for(var parents=[],selectionParents=e.parents,i=selectionParents.length;i--;)if(1==selectionParents[i].nodeType&&!isHidden(selectionParents[i])){var args=editor.fire("ResolveName",{name:selectionParents[i].nodeName.toLowerCase(),target:selectionParents[i]});parents.push({name:args.name})}self.data(parents)}),self._super()}})}),/**
 * FormItem.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/FormItem",["tinymce/ui/Container"],function(Container){return Container.extend({Defaults:{layout:"flex",align:"center",defaults:{flex:1}},renderHtml:function(){var self=this,layout=self._layout,prefix=self.classPrefix;return self.addClass("formitem"),layout.preRender(self),'<div id="'+self._id+'" class="'+self.classes()+'" hideFocus="1" tabIndex="-1">'+(self.settings.title?'<div id="'+self._id+'-title" class="'+prefix+'title">'+self.settings.title+"</div>":"")+'<div id="'+self._id+'-body" class="'+self.classes("body")+'">'+(self.settings.html||"")+layout.renderHtml(self)+"</div>"+"</div>"}})}),/**
 * Form.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Form",["tinymce/ui/Container","tinymce/ui/FormItem"],function(Container,FormItem){return Container.extend({Defaults:{containerCls:"form",layout:"flex",direction:"column",align:"stretch",flex:1,padding:20,labelGap:30,spacing:10,callbacks:{submit:function(){this.submit()}}},preRender:function(){var self=this,items=self.items();items.each(function(ctrl){var formItem,label=ctrl.settings.label;label&&(formItem=new FormItem({layout:"flex",autoResize:"overflow",defaults:{flex:1},items:[{type:"label",id:ctrl._id+"-l",text:label,flex:0,forId:ctrl._id,disabled:ctrl.disabled()}]}),formItem.type="formitem",ctrl.aria("labelledby",ctrl._id+"-l"),"undefined"==typeof ctrl.settings.flex&&(ctrl.settings.flex=1),self.replace(ctrl,formItem),formItem.add(ctrl))})},recalcLabels:function(){var i,labelGap,self=this,maxLabelWidth=0,labels=[];if(self.settings.labelGapCalc!==!1)for(self.items().filter("formitem").each(function(item){var labelCtrl=item.items()[0],labelWidth=labelCtrl.getEl().clientWidth;maxLabelWidth=labelWidth>maxLabelWidth?labelWidth:maxLabelWidth,labels.push(labelCtrl)}),labelGap=self.settings.labelGap||0,i=labels.length;i--;)labels[i].settings.minWidth=maxLabelWidth+labelGap},visible:function(state){var val=this._super(state);return state===!0&&this._rendered&&this.recalcLabels(),val},submit:function(){return this.fire("submit",{data:this.toJSON()})},postRender:function(){var self=this;self._super(),self.recalcLabels(),self.fromJSON(self.settings.data)}})}),/**
 * FieldSet.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/FieldSet",["tinymce/ui/Form"],function(Form){return Form.extend({Defaults:{containerCls:"fieldset",layout:"flex",direction:"column",align:"stretch",flex:1,padding:"25 15 5 15",labelGap:30,spacing:10,border:1},renderHtml:function(){var self=this,layout=self._layout,prefix=self.classPrefix;return self.preRender(),layout.preRender(self),'<fieldset id="'+self._id+'" class="'+self.classes()+'" hideFocus="1" tabIndex="-1">'+(self.settings.title?'<legend id="'+self._id+'-title" class="'+prefix+'fieldset-title">'+self.settings.title+"</legend>":"")+'<div id="'+self._id+'-body" class="'+self.classes("body")+'">'+(self.settings.html||"")+layout.renderHtml(self)+"</div>"+"</fieldset>"}})}),/**
 * FilePicker.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/FilePicker",["tinymce/ui/ComboBox"],function(ComboBox){return ComboBox.extend({init:function(settings){var fileBrowserCallback,self=this,editor=tinymce.activeEditor;settings.spellcheck=!1,fileBrowserCallback=editor.settings.file_browser_callback,fileBrowserCallback&&(settings.icon="browse",settings.onaction=function(){fileBrowserCallback(self.getEl("inp").id,self.getEl("inp").value,settings.filetype,window)}),self._super(settings)}})}),/**
 * FitLayout.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/FitLayout",["tinymce/ui/AbsoluteLayout"],function(AbsoluteLayout){return AbsoluteLayout.extend({recalc:function(container){var contLayoutRect=container.layoutRect(),paddingBox=container.paddingBox();container.items().filter(":visible").each(function(ctrl){ctrl.layoutRect({x:paddingBox.left,y:paddingBox.top,w:contLayoutRect.innerW-paddingBox.right-paddingBox.left,h:contLayoutRect.innerH-paddingBox.top-paddingBox.bottom}),ctrl.recalc&&ctrl.recalc()})}})}),/**
 * FlexLayout.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/FlexLayout",["tinymce/ui/AbsoluteLayout"],function(AbsoluteLayout){return AbsoluteLayout.extend({recalc:function(container){var i,l,items,contLayoutRect,contPaddingBox,contSettings,align,pack,spacing,totalFlex,availableSpace,direction,ctrl,ctrlLayoutRect,ctrlSettings,flex,size,maxSize,ratio,rect,pos,maxAlignEndPos,sizeName,minSizeName,posName,maxSizeName,beforeName,innerSizeName,afterName,deltaSizeName,contentSizeName,alignAxisName,alignInnerSizeName,alignSizeName,alignMinSizeName,alignMaxSizeName,alignBeforeName,alignAfterName,alignDeltaSizeName,alignContentSizeName,maxSizeItems=[],max=Math.max,min=Math.min;for(items=container.items().filter(":visible"),contLayoutRect=container.layoutRect(),contPaddingBox=container._paddingBox,contSettings=container.settings,direction=container.isRtl()?contSettings.direction||"row-reversed":contSettings.direction,align=contSettings.align,pack=container.isRtl()?contSettings.pack||"end":contSettings.pack,spacing=contSettings.spacing||0,("row-reversed"==direction||"column-reverse"==direction)&&(items=items.set(items.toArray().reverse()),direction=direction.split("-")[0]),"column"==direction?(posName="y",sizeName="h",minSizeName="minH",maxSizeName="maxH",innerSizeName="innerH",beforeName="top",afterName="bottom",deltaSizeName="deltaH",contentSizeName="contentH",alignBeforeName="left",alignSizeName="w",alignAxisName="x",alignInnerSizeName="innerW",alignMinSizeName="minW",alignMaxSizeName="maxW",alignAfterName="right",alignDeltaSizeName="deltaW",alignContentSizeName="contentW"):(posName="x",sizeName="w",minSizeName="minW",maxSizeName="maxW",innerSizeName="innerW",beforeName="left",afterName="right",deltaSizeName="deltaW",contentSizeName="contentW",alignBeforeName="top",alignSizeName="h",alignAxisName="y",alignInnerSizeName="innerH",alignMinSizeName="minH",alignMaxSizeName="maxH",alignAfterName="bottom",alignDeltaSizeName="deltaH",alignContentSizeName="contentH"),availableSpace=contLayoutRect[innerSizeName]-contPaddingBox[beforeName]-contPaddingBox[beforeName],maxAlignEndPos=totalFlex=0,i=0,l=items.length;l>i;i++)ctrl=items[i],ctrlLayoutRect=ctrl.layoutRect(),ctrlSettings=ctrl.settings,flex=ctrlSettings.flex,availableSpace-=l-1>i?spacing:0,flex>0&&(totalFlex+=flex,ctrlLayoutRect[maxSizeName]&&maxSizeItems.push(ctrl),ctrlLayoutRect.flex=flex),availableSpace-=ctrlLayoutRect[minSizeName],size=contPaddingBox[alignBeforeName]+ctrlLayoutRect[alignMinSizeName]+contPaddingBox[alignAfterName],size>maxAlignEndPos&&(maxAlignEndPos=size);if(rect={},rect[minSizeName]=0>availableSpace?contLayoutRect[minSizeName]-availableSpace+contLayoutRect[deltaSizeName]:contLayoutRect[innerSizeName]-availableSpace+contLayoutRect[deltaSizeName],rect[alignMinSizeName]=maxAlignEndPos+contLayoutRect[alignDeltaSizeName],rect[contentSizeName]=contLayoutRect[innerSizeName]-availableSpace,rect[alignContentSizeName]=maxAlignEndPos,rect.minW=min(rect.minW,contLayoutRect.maxW),rect.minH=min(rect.minH,contLayoutRect.maxH),rect.minW=max(rect.minW,contLayoutRect.startMinWidth),rect.minH=max(rect.minH,contLayoutRect.startMinHeight),!contLayoutRect.autoResize||rect.minW==contLayoutRect.minW&&rect.minH==contLayoutRect.minH){for(ratio=availableSpace/totalFlex,i=0,l=maxSizeItems.length;l>i;i++)ctrl=maxSizeItems[i],ctrlLayoutRect=ctrl.layoutRect(),maxSize=ctrlLayoutRect[maxSizeName],size=ctrlLayoutRect[minSizeName]+ctrlLayoutRect.flex*ratio,size>maxSize?(availableSpace-=ctrlLayoutRect[maxSizeName]-ctrlLayoutRect[minSizeName],totalFlex-=ctrlLayoutRect.flex,ctrlLayoutRect.flex=0,ctrlLayoutRect.maxFlexSize=maxSize):ctrlLayoutRect.maxFlexSize=0;for(ratio=availableSpace/totalFlex,pos=contPaddingBox[beforeName],rect={},0===totalFlex&&("end"==pack?pos=availableSpace+contPaddingBox[beforeName]:"center"==pack?(pos=Math.round(contLayoutRect[innerSizeName]/2-(contLayoutRect[innerSizeName]-availableSpace)/2)+contPaddingBox[beforeName],0>pos&&(pos=contPaddingBox[beforeName])):"justify"==pack&&(pos=contPaddingBox[beforeName],spacing=Math.floor(availableSpace/(items.length-1)))),rect[alignAxisName]=contPaddingBox[alignBeforeName],i=0,l=items.length;l>i;i++)ctrl=items[i],ctrlLayoutRect=ctrl.layoutRect(),size=ctrlLayoutRect.maxFlexSize||ctrlLayoutRect[minSizeName],"center"===align?rect[alignAxisName]=Math.round(contLayoutRect[alignInnerSizeName]/2-ctrlLayoutRect[alignSizeName]/2):"stretch"===align?(rect[alignSizeName]=max(ctrlLayoutRect[alignMinSizeName]||0,contLayoutRect[alignInnerSizeName]-contPaddingBox[alignBeforeName]-contPaddingBox[alignAfterName]),rect[alignAxisName]=contPaddingBox[alignBeforeName]):"end"===align&&(rect[alignAxisName]=contLayoutRect[alignInnerSizeName]-ctrlLayoutRect[alignSizeName]-contPaddingBox.top),ctrlLayoutRect.flex>0&&(size+=ctrlLayoutRect.flex*ratio),rect[sizeName]=size,rect[posName]=pos,ctrl.layoutRect(rect),ctrl.recalc&&ctrl.recalc(),pos+=size+spacing}else if(rect.w=rect.minW,rect.h=rect.minH,container.layoutRect(rect),this.recalc(container),null===container._lastRect){var parentCtrl=container.parent();parentCtrl&&(parentCtrl._lastRect=null,parentCtrl.recalc())}}})}),/**
 * FlowLayout.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/FlowLayout",["tinymce/ui/Layout"],function(Layout){return Layout.extend({Defaults:{containerClass:"flow-layout",controlClass:"flow-layout-item",endClass:"break"},recalc:function(container){container.items().filter(":visible").each(function(ctrl){ctrl.recalc&&ctrl.recalc()})}})}),/**
 * FormatControls.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/FormatControls",["tinymce/ui/Control","tinymce/ui/Widget","tinymce/ui/FloatPanel","tinymce/util/Tools","tinymce/EditorManager","tinymce/Env"],function(Control,Widget,FloatPanel,Tools,EditorManager,Env){function registerControls(editor){function getPreviewCss(format){function removeVars(val){return val.replace(/%(\w+)/g,"")}var name,previewElm,parentFontSize,previewStyles,dom=editor.dom,previewCss="";return previewStyles=editor.settings.preview_styles,previewStyles===!1?"":(previewStyles||(previewStyles="font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"),(format=editor.formatter.get(format))?(format=format[0],name=format.block||format.inline||"span",previewElm=dom.create(name),each(format.styles,function(value,name){value=removeVars(value),value&&dom.setStyle(previewElm,name,value)}),each(format.attributes,function(value,name){value=removeVars(value),value&&dom.setAttrib(previewElm,name,value)}),each(format.classes,function(value){value=removeVars(value),dom.hasClass(previewElm,value)||dom.addClass(previewElm,value)}),editor.fire("PreviewFormats"),dom.setStyles(previewElm,{position:"absolute",left:-65535}),editor.getBody().appendChild(previewElm),parentFontSize=dom.getStyle(editor.getBody(),"fontSize",!0),parentFontSize=/px$/.test(parentFontSize)?parseInt(parentFontSize,10):0,each(previewStyles.split(" "),function(name){var value=dom.getStyle(previewElm,name,!0);if(!("background-color"==name&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(value)&&(value=dom.getStyle(editor.getBody(),name,!0),"#ffffff"==dom.toHex(value).toLowerCase())||"color"==name&&"#000000"==dom.toHex(value).toLowerCase())){if("font-size"==name&&/em|%$/.test(value)){if(0===parentFontSize)return;value=parseFloat(value,10)/(/%$/.test(value)?100:1),value=value*parentFontSize+"px"}"border"==name&&value&&(previewCss+="padding:0 2px;"),previewCss+=name+":"+value+";"}}),editor.fire("AfterPreviewFormats"),dom.remove(previewElm),previewCss):void 0)}function createListBoxChangeHandler(items,formatName){return function(){var self=this;editor.on("nodeChange",function(e){var formatter=editor.formatter,value=null;each(e.parents,function(node){return each(items,function(item){return formatName?formatter.matchNode(node,formatName,{value:item.value})&&(value=item.value):formatter.matchNode(node,item.value)&&(value=item.value),value?!1:void 0}),value?!1:void 0}),self.value(value)})}}function createFormats(formats){formats=formats.split(";");for(var i=formats.length;i--;)formats[i]=formats[i].split("=");return formats}function createFormatMenu(){function createMenu(formats){var menu=[];if(formats)return each(formats,function(format){var menuItem={text:format.title,icon:format.icon};if(format.items)menuItem.menu=createMenu(format.items);else{var formatName=format.format||"custom"+count++;format.format||(format.name=formatName,newFormats.push(format)),menuItem.format=formatName}menu.push(menuItem)}),menu}function createStylesMenu(){var menu;return menu=editor.settings.style_formats_merge?editor.settings.style_formats?createMenu(defaultStyleFormats.concat(editor.settings.style_formats)):createMenu(defaultStyleFormats):createMenu(editor.settings.style_formats||defaultStyleFormats)}var count=0,newFormats=[],defaultStyleFormats=[{title:"Headers",items:[{title:"Header 1",format:"h1"},{title:"Header 2",format:"h2"},{title:"Header 3",format:"h3"},{title:"Header 4",format:"h4"},{title:"Header 5",format:"h5"},{title:"Header 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}];return editor.on("init",function(){each(newFormats,function(format){editor.formatter.register(format.name,format)})}),{type:"menu",items:createStylesMenu(),onPostRender:function(e){editor.fire("renderFormatsMenu",{control:e.control})},itemDefaults:{preview:!0,textStyle:function(){return this.settings.format?getPreviewCss(this.settings.format):void 0},onPostRender:function(){var self=this,formatName=this.settings.format;formatName&&self.parent().on("show",function(){self.disabled(!editor.formatter.canApply(formatName)),self.active(editor.formatter.match(formatName))})},onclick:function(){this.settings.format&&toggleFormat(this.settings.format)}}}}function hasUndo(){return editor.undoManager?editor.undoManager.hasUndo():!1}function hasRedo(){return editor.undoManager?editor.undoManager.hasRedo():!1}function toggleUndoState(){var self=this;self.disabled(!hasUndo()),editor.on("Undo Redo AddUndo TypingUndo",function(){self.disabled(!hasUndo())})}function toggleRedoState(){var self=this;self.disabled(!hasRedo()),editor.on("Undo Redo AddUndo TypingUndo",function(){self.disabled(!hasRedo())})}function toggleVisualAidState(){var self=this;editor.on("VisualAid",function(e){self.active(e.hasVisual)}),self.active(editor.hasVisual)}function toggleFormat(fmt){fmt.control&&(fmt=fmt.control.value()),fmt&&editor.execCommand("mceToggleFormat",!1,fmt)}var formatMenu;formatMenu=createFormatMenu(),each({bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript"},function(text,name){editor.addButton(name,{tooltip:text,onPostRender:function(){var self=this;editor.formatter?editor.formatter.formatChanged(name,function(state){self.active(state)}):editor.on("init",function(){editor.formatter.formatChanged(name,function(state){self.active(state)})})},onclick:function(){toggleFormat(name)}})}),each({outdent:["Decrease indent","Outdent"],indent:["Increase indent","Indent"],cut:["Cut","Cut"],copy:["Copy","Copy"],paste:["Paste","Paste"],help:["Help","mceHelp"],selectall:["Select all","SelectAll"],hr:["Insert horizontal rule","InsertHorizontalRule"],removeformat:["Clear formatting","RemoveFormat"],visualaid:["Visual aids","mceToggleVisualAid"],newdocument:["New document","mceNewDocument"]},function(item,name){editor.addButton(name,{tooltip:item[0],cmd:item[1]})}),each({blockquote:["Blockquote","mceBlockQuote"],numlist:["Numbered list","InsertOrderedList"],bullist:["Bullet list","InsertUnorderedList"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],alignleft:["Align left","JustifyLeft"],aligncenter:["Align center","JustifyCenter"],alignright:["Align right","JustifyRight"],alignjustify:["Justify","JustifyFull"]},function(item,name){editor.addButton(name,{tooltip:item[0],cmd:item[1],onPostRender:function(){var self=this;editor.formatter?editor.formatter.formatChanged(name,function(state){self.active(state)}):editor.on("init",function(){editor.formatter.formatChanged(name,function(state){self.active(state)})})}})}),editor.addButton("undo",{tooltip:"Undo",onPostRender:toggleUndoState,cmd:"undo"}),editor.addButton("redo",{tooltip:"Redo",onPostRender:toggleRedoState,cmd:"redo"}),editor.addMenuItem("newdocument",{text:"New document",shortcut:"Ctrl+N",icon:"newdocument",cmd:"mceNewDocument"}),editor.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Ctrl+Z",onPostRender:toggleUndoState,cmd:"undo"}),editor.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Ctrl+Y",onPostRender:toggleRedoState,cmd:"redo"}),editor.addMenuItem("visualaid",{text:"Visual aids",selectable:!0,onPostRender:toggleVisualAidState,cmd:"mceToggleVisualAid"}),each({cut:["Cut","Cut","Ctrl+X"],copy:["Copy","Copy","Ctrl+C"],paste:["Paste","Paste","Ctrl+V"],selectall:["Select all","SelectAll","Ctrl+A"],bold:["Bold","Bold","Ctrl+B"],italic:["Italic","Italic","Ctrl+I"],underline:["Underline","Underline"],strikethrough:["Strikethrough","Strikethrough"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],removeformat:["Clear formatting","RemoveFormat"]},function(item,name){editor.addMenuItem(name,{text:item[0],icon:name,shortcut:item[2],cmd:item[1]})}),editor.on("mousedown",function(){FloatPanel.hideAll()}),editor.addButton("styleselect",{type:"menubutton",text:"Formats",menu:formatMenu}),editor.addButton("formatselect",function(){var items=[],blocks=createFormats(editor.settings.block_formats||"Paragraph=p;Address=address;Pre=pre;Header 1=h1;Header 2=h2;Header 3=h3;Header 4=h4;Header 5=h5;Header 6=h6");return each(blocks,function(block){items.push({text:block[0],value:block[1],textStyle:function(){return getPreviewCss(block[1])}})}),{type:"listbox",text:blocks[0][0],values:items,fixedWidth:!0,onselect:toggleFormat,onPostRender:createListBoxChangeHandler(items)}}),editor.addButton("fontselect",function(){var defaultFontsFormats="Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats",items=[],fonts=createFormats(editor.settings.font_formats||defaultFontsFormats);return each(fonts,function(font){items.push({text:{raw:font[0]},value:font[1],textStyle:-1==font[1].indexOf("dings")?"font-family:"+font[1]:""})}),{type:"listbox",text:"Font Family",tooltip:"Font Family",values:items,fixedWidth:!0,onPostRender:createListBoxChangeHandler(items,"fontname"),onselect:function(e){e.control.settings.value&&editor.execCommand("FontName",!1,e.control.settings.value)}}}),editor.addButton("fontsizeselect",function(){var items=[],defaultFontsizeFormats="8pt 10pt 12pt 14pt 18pt 24pt 36pt",fontsize_formats=editor.settings.fontsize_formats||defaultFontsizeFormats;return each(fontsize_formats.split(" "),function(item){items.push({text:item,value:item})}),{type:"listbox",text:"Font Sizes",tooltip:"Font Sizes",values:items,fixedWidth:!0,onPostRender:createListBoxChangeHandler(items,"fontsize"),onclick:function(e){e.control.settings.value&&editor.execCommand("FontSize",!1,e.control.settings.value)}}}),editor.addMenuItem("formats",{text:"Formats",menu:formatMenu})}var each=Tools.each;EditorManager.on("AddEditor",function(e){e.editor.rtl&&(Control.rtl=!0),registerControls(e.editor)}),Control.translate=function(text){return EditorManager.translate(text)},Widget.tooltips=!Env.iOS}),/**
 * GridLayout.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/GridLayout",["tinymce/ui/AbsoluteLayout"],function(AbsoluteLayout){return AbsoluteLayout.extend({recalc:function(container){var rows,cols,items,contLayoutRect,width,height,rect,ctrlLayoutRect,ctrl,x,y,posX,posY,ctrlSettings,contPaddingBox,align,spacingH,spacingV,alignH,alignV,maxX,maxY,ctrlMinWidth,ctrlMinHeight,alignX,alignY,availableWidth,availableHeight,settings=container.settings,colWidths=[],rowHeights=[];for(settings=container.settings,items=container.items().filter(":visible"),contLayoutRect=container.layoutRect(),cols=settings.columns||Math.ceil(Math.sqrt(items.length)),rows=Math.ceil(items.length/cols),spacingH=settings.spacingH||settings.spacing||0,spacingV=settings.spacingV||settings.spacing||0,alignH=settings.alignH||settings.align,alignV=settings.alignV||settings.align,contPaddingBox=container._paddingBox,alignH&&"string"==typeof alignH&&(alignH=[alignH]),alignV&&"string"==typeof alignV&&(alignV=[alignV]),x=0;cols>x;x++)colWidths.push(0);for(y=0;rows>y;y++)rowHeights.push(0);for(y=0;rows>y;y++)for(x=0;cols>x&&(ctrl=items[y*cols+x],ctrl);x++)ctrlLayoutRect=ctrl.layoutRect(),ctrlMinWidth=ctrlLayoutRect.minW,ctrlMinHeight=ctrlLayoutRect.minH,colWidths[x]=ctrlMinWidth>colWidths[x]?ctrlMinWidth:colWidths[x],rowHeights[y]=ctrlMinHeight>rowHeights[y]?ctrlMinHeight:rowHeights[y];for(availableWidth=contLayoutRect.innerW-contPaddingBox.left-contPaddingBox.right,maxX=0,x=0;cols>x;x++)maxX+=colWidths[x]+(x>0?spacingH:0),availableWidth-=(x>0?spacingH:0)+colWidths[x];for(availableHeight=contLayoutRect.innerH-contPaddingBox.top-contPaddingBox.bottom,maxY=0,y=0;rows>y;y++)maxY+=rowHeights[y]+(y>0?spacingV:0),availableHeight-=(y>0?spacingV:0)+rowHeights[y];if(maxX+=contPaddingBox.left+contPaddingBox.right,maxY+=contPaddingBox.top+contPaddingBox.bottom,rect={},rect.minW=maxX+(contLayoutRect.w-contLayoutRect.innerW),rect.minH=maxY+(contLayoutRect.h-contLayoutRect.innerH),rect.contentW=rect.minW-contLayoutRect.deltaW,rect.contentH=rect.minH-contLayoutRect.deltaH,rect.minW=Math.min(rect.minW,contLayoutRect.maxW),rect.minH=Math.min(rect.minH,contLayoutRect.maxH),rect.minW=Math.max(rect.minW,contLayoutRect.startMinWidth),rect.minH=Math.max(rect.minH,contLayoutRect.startMinHeight),!contLayoutRect.autoResize||rect.minW==contLayoutRect.minW&&rect.minH==contLayoutRect.minH){contLayoutRect.autoResize&&(rect=container.layoutRect(rect),rect.contentW=rect.minW-contLayoutRect.deltaW,rect.contentH=rect.minH-contLayoutRect.deltaH);var flexV;flexV="start"==settings.packV?0:availableHeight>0?Math.floor(availableHeight/rows):0;var totalFlex=0,flexWidths=settings.flexWidths;if(flexWidths)for(x=0;x<flexWidths.length;x++)totalFlex+=flexWidths[x];else totalFlex=cols;var ratio=availableWidth/totalFlex;for(x=0;cols>x;x++)colWidths[x]+=flexWidths?flexWidths[x]*ratio:ratio;for(posY=contPaddingBox.top,y=0;rows>y;y++){for(posX=contPaddingBox.left,height=rowHeights[y]+flexV,x=0;cols>x&&(ctrl=items[y*cols+x],ctrl);x++)ctrlSettings=ctrl.settings,ctrlLayoutRect=ctrl.layoutRect(),width=Math.max(colWidths[x],ctrlLayoutRect.startMinWidth),alignX=alignY=0,ctrlLayoutRect.x=posX,ctrlLayoutRect.y=posY,align=ctrlSettings.alignH||(alignH?alignH[x]||alignH[0]:null),"center"==align?ctrlLayoutRect.x=posX+width/2-ctrlLayoutRect.w/2:"right"==align?ctrlLayoutRect.x=posX+width-ctrlLayoutRect.w:"stretch"==align&&(ctrlLayoutRect.w=width),align=ctrlSettings.alignV||(alignV?alignV[x]||alignV[0]:null),"center"==align?ctrlLayoutRect.y=posY+height/2-ctrlLayoutRect.h/2:"bottom"==align?ctrlLayoutRect.y=posY+height-ctrlLayoutRect.h:"stretch"==align&&(ctrlLayoutRect.h=height),ctrl.layoutRect(ctrlLayoutRect),posX+=width+spacingH,ctrl.recalc&&ctrl.recalc();posY+=height+spacingV}}else if(rect.w=rect.minW,rect.h=rect.minH,container.layoutRect(rect),this.recalc(container),null===container._lastRect){var parentCtrl=container.parent();parentCtrl&&(parentCtrl._lastRect=null,parentCtrl.recalc())}}})}),/**
 * Iframe.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Iframe",["tinymce/ui/Widget"],function(Widget){return Widget.extend({renderHtml:function(){var self=this;return self.addClass("iframe"),self.canFocus=!1,'<iframe id="'+self._id+'" class="'+self.classes()+'" tabindex="-1" src="'+(self.settings.url||"javascript:''")+'" frameborder="0"></iframe>'},src:function(src){this.getEl().src=src},html:function(html,callback){var self=this,body=this.getEl().contentWindow.document.body;return body?(body.innerHTML=html,callback&&callback()):setTimeout(function(){self.html(html)},0),this}})}),/**
 * Label.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Label",["tinymce/ui/Widget","tinymce/ui/DomUtils"],function(Widget,DomUtils){return Widget.extend({init:function(settings){var self=this;self._super(settings),self.addClass("widget"),self.addClass("label"),self.canFocus=!1,settings.multiline&&self.addClass("autoscroll"),settings.strong&&self.addClass("strong")},initLayoutRect:function(){var self=this,layoutRect=self._super();if(self.settings.multiline){var size=DomUtils.getSize(self.getEl());size.width>layoutRect.maxW&&(layoutRect.minW=layoutRect.maxW,self.addClass("multiline")),self.getEl().style.width=layoutRect.minW+"px",layoutRect.startMinH=layoutRect.h=layoutRect.minH=Math.min(layoutRect.maxH,DomUtils.getSize(self.getEl()).height)}return layoutRect},repaint:function(){var self=this;return self.settings.multiline||(self.getEl().style.lineHeight=self.layoutRect().h+"px"),self._super()},text:function(text){var self=this;return self._rendered&&text&&this.innerHtml(self.encode(text)),self._super(text)},renderHtml:function(){var self=this,forId=self.settings.forId;return'<label id="'+self._id+'" class="'+self.classes()+'"'+(forId?' for="'+forId+'"':"")+">"+self.encode(self._text)+"</label>"}})}),/**
 * Toolbar.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Toolbar",["tinymce/ui/Container"],function(Container){return Container.extend({Defaults:{role:"toolbar",layout:"flow"},init:function(settings){var self=this;self._super(settings),self.addClass("toolbar")},postRender:function(){var self=this;return self.items().addClass("toolbar-item"),self._super()}})}),/**
 * MenuBar.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/MenuBar",["tinymce/ui/Toolbar"],function(Toolbar){return Toolbar.extend({Defaults:{role:"menubar",containerCls:"menubar",ariaRoot:!0,defaults:{type:"menubutton"}}})}),/**
 * MenuButton.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/MenuButton",["tinymce/ui/Button","tinymce/ui/Factory","tinymce/ui/MenuBar"],function(Button,Factory,MenuBar){function isChildOf(node,parent){for(;node;){if(parent===node)return!0;node=node.parentNode}return!1}var MenuButton=Button.extend({init:function(settings){var self=this;self._renderOpen=!0,self._super(settings),self.addClass("menubtn"),settings.fixedWidth&&self.addClass("fixed-width"),self.aria("haspopup",!0),self.hasPopup=!0},showMenu:function(){var menu,self=this,settings=self.settings;return self.menu&&self.menu.visible()?self.hideMenu():(self.menu||(menu=settings.menu||[],menu.length?menu={type:"menu",items:menu}:menu.type=menu.type||"menu",self.menu=Factory.create(menu).parent(self).renderTo(),self.fire("createmenu"),self.menu.reflow(),self.menu.on("cancel",function(e){e.control.parent()===self.menu&&(e.stopPropagation(),self.focus(),self.hideMenu())}),self.menu.on("select",function(){self.focus()}),self.menu.on("show hide",function(e){e.control==self.menu&&self.activeMenu("show"==e.type),self.aria("expanded","show"==e.type)}).fire("show")),self.menu.show(),self.menu.layoutRect({w:self.layoutRect().w}),self.menu.moveRel(self.getEl(),self.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"]),void 0)},hideMenu:function(){var self=this;self.menu&&(self.menu.items().each(function(item){item.hideMenu&&item.hideMenu()}),self.menu.hide())},activeMenu:function(state){this.toggleClass("active",state)},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix,icon=self.settings.icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"";return self.aria("role",self.parent()instanceof MenuBar?"menuitem":"button"),'<div id="'+id+'" class="'+self.classes()+'" tabindex="-1" aria-labelledby="'+id+'">'+'<button id="'+id+'-open" role="presentation" type="button" tabindex="-1">'+(icon?'<i class="'+icon+'"></i>':"")+"<span>"+(self._text?(icon?" ":"")+self.encode(self._text):"")+"</span>"+' <i class="'+prefix+'caret"></i>'+"</button>"+"</div>"},postRender:function(){var self=this;return self.on("click",function(e){e.control===self&&isChildOf(e.target,self.getEl())&&(self.showMenu(),e.aria&&self.menu.items()[0].focus())}),self.on("mouseenter",function(e){var hasVisibleSiblingMenu,overCtrl=e.control,parent=self.parent();overCtrl&&parent&&overCtrl instanceof MenuButton&&overCtrl.parent()==parent&&(parent.items().filter("MenuButton").each(function(ctrl){ctrl.hideMenu&&ctrl!=overCtrl&&(ctrl.menu&&ctrl.menu.visible()&&(hasVisibleSiblingMenu=!0),ctrl.hideMenu())}),hasVisibleSiblingMenu&&(overCtrl.focus(),overCtrl.showMenu()))}),self._super()},text:function(text){var i,children,self=this;if(self._rendered)for(children=self.getEl("open").getElementsByTagName("span"),i=0;i<children.length;i++)children[i].innerHTML=(self.settings.icon&&text?" ":"")+self.encode(text);return this._super(text)},remove:function(){this._super(),this.menu&&this.menu.remove()}});return MenuButton}),/**
 * ListBox.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/ListBox",["tinymce/ui/MenuButton"],function(MenuButton){return MenuButton.extend({init:function(settings){var values,i,selected,selectedText,lastItemCtrl,self=this;if(self._values=values=settings.values,values){for(i=0;i<values.length;i++)if(selected=values[i].selected||settings.value===values[i].value){selectedText=selectedText||values[i].text,self._value=values[i].value;break}!selected&&values.length>0&&(selectedText=values[0].text,self._value=values[0].value),settings.menu=values}settings.text=settings.text||selectedText||values[0].text,self._super(settings),self.addClass("listbox"),self.on("select",function(e){var ctrl=e.control;lastItemCtrl&&(e.lastControl=lastItemCtrl),settings.multiple?ctrl.active(!ctrl.active()):self.value(e.control.settings.value),lastItemCtrl=ctrl})},value:function(value){function activateByValue(menu,value){menu.items().each(function(ctrl){active=ctrl.value()===value,active&&(selectedText=selectedText||ctrl.text()),ctrl.active(active),ctrl.menu&&activateByValue(ctrl.menu,value)})}var active,selectedText,menu,i,self=this;if("undefined"!=typeof value){if(self.menu)activateByValue(self.menu,value);else for(menu=self.settings.menu,i=0;i<menu.length;i++)active=menu[i].value==value,active&&(selectedText=selectedText||menu[i].text),menu[i].active=active;self.text(selectedText||this.settings.text)}return self._super(value)}})}),/**
 * MenuItem.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/MenuItem",["tinymce/ui/Widget","tinymce/ui/Factory","tinymce/Env"],function(Widget,Factory,Env){return Widget.extend({Defaults:{border:0,role:"menuitem"},init:function(settings){var self=this;self.hasPopup=!0,self._super(settings),settings=self.settings,self.addClass("menu-item"),settings.menu&&self.addClass("menu-item-expand"),settings.preview&&self.addClass("menu-item-preview"),("-"===self._text||"|"===self._text)&&(self.addClass("menu-item-sep"),self.aria("role","separator"),self._text="-"),settings.selectable&&(self.aria("role","menuitemcheckbox"),self.addClass("menu-item-checkbox"),settings.icon="selected"),settings.preview||settings.selectable||self.addClass("menu-item-normal"),self.on("mousedown",function(e){e.preventDefault()}),settings.menu&&self.aria("haspopup",!0)},hasMenus:function(){return!!this.settings.menu},showMenu:function(){var menu,self=this,settings=self.settings,parent=self.parent();if(parent.items().each(function(ctrl){ctrl!==self&&ctrl.hideMenu()}),settings.menu){menu=self.menu,menu?menu.show():(menu=settings.menu,menu.length?menu={type:"menu",items:menu}:menu.type=menu.type||"menu",parent.settings.itemDefaults&&(menu.itemDefaults=parent.settings.itemDefaults),menu=self.menu=Factory.create(menu).parent(self).renderTo(),menu.reflow(),menu.fire("show"),menu.on("cancel",function(e){e.stopPropagation(),self.focus(),menu.hide()}),menu.on("hide",function(e){e.control===menu&&self.removeClass("selected")}),menu.submenu=!0),menu._parentMenu=parent,menu.addClass("menu-sub");var rel=menu.testMoveRel(self.getEl(),self.isRtl()?["tl-tr","bl-br","tr-tl","br-bl"]:["tr-tl","br-bl","tl-tr","bl-br"]);menu.moveRel(self.getEl(),rel),menu.rel=rel,rel="menu-sub-"+rel,menu.removeClass(menu._lastRel),menu.addClass(rel),menu._lastRel=rel,self.addClass("selected"),self.aria("expanded",!0)}},hideMenu:function(){var self=this;return self.menu&&(self.menu.items().each(function(item){item.hideMenu&&item.hideMenu()}),self.menu.hide(),self.aria("expanded",!1)),self},renderHtml:function(){var self=this,id=self._id,settings=self.settings,prefix=self.classPrefix,text=self.encode(self._text),icon=self.settings.icon,image="",shortcut=settings.shortcut;return icon&&self.parent().addClass("menu-has-icons"),settings.image&&(icon="none",image=" style=\"background-image: url('"+settings.image+"')\""),shortcut&&Env.mac&&(shortcut=shortcut.replace(/ctrl\+alt\+/i,"&#x2325;&#x2318;"),shortcut=shortcut.replace(/ctrl\+/i,"&#x2318;"),shortcut=shortcut.replace(/alt\+/i,"&#x2325;"),shortcut=shortcut.replace(/shift\+/i,"&#x21E7;")),icon=prefix+"ico "+prefix+"i-"+(self.settings.icon||"none"),'<div id="'+id+'" class="'+self.classes()+'" tabindex="-1">'+("-"!==text?'<i class="'+icon+'"'+image+"></i>&nbsp;":"")+("-"!==text?'<span id="'+id+'-text" class="'+prefix+'text">'+text+"</span>":"")+(shortcut?'<div id="'+id+'-shortcut" class="'+prefix+'menu-shortcut">'+shortcut+"</div>":"")+(settings.menu?'<div class="'+prefix+'caret"></div>':"")+"</div>"},postRender:function(){var self=this,settings=self.settings,textStyle=settings.textStyle;if("function"==typeof textStyle&&(textStyle=textStyle.call(this)),textStyle){var textElm=self.getEl("text");textElm&&textElm.setAttribute("style",textStyle)}return self.on("mouseenter click",function(e){e.control===self&&(settings.menu||"click"!==e.type?(self.showMenu(),e.aria&&self.menu.focus(!0)):(self.fire("select"),self.parent().hideAll()))}),self._super(),self},active:function(state){return"undefined"!=typeof state&&this.aria("checked",state),this._super(state)},remove:function(){this._super(),this.menu&&this.menu.remove()}})}),/**
 * Menu.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Menu",["tinymce/ui/FloatPanel","tinymce/ui/MenuItem","tinymce/util/Tools"],function(FloatPanel,MenuItem,Tools){var Menu=FloatPanel.extend({Defaults:{defaultType:"menuitem",border:1,layout:"stack",role:"application",bodyRole:"menu",ariaRoot:!0},init:function(settings){var self=this;if(settings.autohide=!0,settings.constrainToViewport=!0,settings.itemDefaults)for(var items=settings.items,i=items.length;i--;)items[i]=Tools.extend({},settings.itemDefaults,items[i]);self._super(settings),self.addClass("menu")},repaint:function(){return this.toggleClass("menu-align",!0),this._super(),this.getEl().style.height="",this.getEl("body").style.height="",this},cancel:function(){var self=this;self.hideAll(),self.fire("select")},hideAll:function(){var self=this;return this.find("menuitem").exec("hideMenu"),self._super()},preRender:function(){var self=this;return self.items().each(function(ctrl){var settings=ctrl.settings;return settings.icon||settings.selectable?(self._hasIcons=!0,!1):void 0}),self._super()}});return Menu}),/**
 * Radio.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Radio",["tinymce/ui/Checkbox"],function(Checkbox){return Checkbox.extend({Defaults:{classes:"radio",role:"radio"}})}),/**
 * ResizeHandle.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/ResizeHandle",["tinymce/ui/Widget","tinymce/ui/DragHelper"],function(Widget,DragHelper){return Widget.extend({renderHtml:function(){var self=this,prefix=self.classPrefix;return self.addClass("resizehandle"),"both"==self.settings.direction&&self.addClass("resizehandle-both"),self.canFocus=!1,'<div id="'+self._id+'" class="'+self.classes()+'">'+'<i class="'+prefix+"ico "+prefix+'i-resize"></i>'+"</div>"},postRender:function(){var self=this;self._super(),self.resizeDragHelper=new DragHelper(this._id,{start:function(){self.fire("ResizeStart")},drag:function(e){"both"!=self.settings.direction&&(e.deltaX=0),self.fire("Resize",e)},stop:function(){self.fire("ResizeEnd")}})},remove:function(){return this.resizeDragHelper&&this.resizeDragHelper.destroy(),this._super()}})}),/**
 * Spacer.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Spacer",["tinymce/ui/Widget"],function(Widget){return Widget.extend({renderHtml:function(){var self=this;return self.addClass("spacer"),self.canFocus=!1,'<div id="'+self._id+'" class="'+self.classes()+'"></div>'}})}),/**
 * SplitButton.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/SplitButton",["tinymce/ui/MenuButton","tinymce/ui/DomUtils"],function(MenuButton,DomUtils){return MenuButton.extend({Defaults:{classes:"widget btn splitbtn",role:"button"},repaint:function(){var mainButtonElm,menuButtonElm,self=this,elm=self.getEl(),rect=self.layoutRect();return self._super(),mainButtonElm=elm.firstChild,menuButtonElm=elm.lastChild,DomUtils.css(mainButtonElm,{width:rect.w-DomUtils.getSize(menuButtonElm).width,height:rect.h-2}),DomUtils.css(menuButtonElm,{height:rect.h-2}),self},activeMenu:function(state){var self=this;DomUtils.toggleClass(self.getEl().lastChild,self.classPrefix+"active",state)},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix,icon=self.settings.icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"";return'<div id="'+id+'" class="'+self.classes()+'" role="button" tabindex="-1">'+'<button type="button" hidefocus tabindex="-1">'+(icon?'<i class="'+icon+'"></i>':"")+(self._text?(icon?" ":"")+self._text:"")+"</button>"+'<button type="button" class="'+prefix+'open" hidefocus tabindex="-1">'+(self._menuBtnText?(icon?" ":"")+self._menuBtnText:"")+' <i class="'+prefix+'caret"></i>'+"</button>"+"</div>"},postRender:function(){var self=this,onClickHandler=self.settings.onclick;return self.on("click",function(e){var node=e.target;if(e.control==this)for(;node;){if(e.aria&&"down"!=e.aria.key||"BUTTON"==node.nodeName&&-1==node.className.indexOf("open"))return e.stopImmediatePropagation(),onClickHandler.call(this,e),void 0;node=node.parentNode}}),delete self.settings.onclick,self._super()}})}),/**
 * StackLayout.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/StackLayout",["tinymce/ui/FlowLayout"],function(FlowLayout){return FlowLayout.extend({Defaults:{containerClass:"stack-layout",controlClass:"stack-layout-item",endClass:"break"}})}),/**
 * TabPanel.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/TabPanel",["tinymce/ui/Panel","tinymce/ui/DomUtils"],function(Panel,DomUtils){return Panel.extend({lastIdx:0,Defaults:{layout:"absolute",defaults:{type:"panel"}},activateTab:function(idx){var activeTabElm;this.activeTabId&&(activeTabElm=this.getEl(this.activeTabId),DomUtils.removeClass(activeTabElm,this.classPrefix+"active"),activeTabElm.setAttribute("aria-selected","false")),this.activeTabId="t"+idx,activeTabElm=this.getEl("t"+idx),activeTabElm.setAttribute("aria-selected","true"),DomUtils.addClass(activeTabElm,this.classPrefix+"active"),idx!=this.lastIdx&&(this.items()[this.lastIdx].hide(),this.lastIdx=idx),this.items()[idx].show().fire("showtab"),this.reflow()},renderHtml:function(){var self=this,layout=self._layout,tabsHtml="",prefix=self.classPrefix;return self.preRender(),layout.preRender(self),self.items().each(function(ctrl,i){var id=self._id+"-t"+i;ctrl.aria("role","tabpanel"),ctrl.aria("labelledby",id),tabsHtml+='<div id="'+id+'" class="'+prefix+'tab" '+'unselectable="on" role="tab" aria-controls="'+ctrl._id+'" aria-selected="false" tabIndex="-1">'+self.encode(ctrl.settings.title)+"</div>"}),'<div id="'+self._id+'" class="'+self.classes()+'" hideFocus="1" tabIndex="-1">'+'<div id="'+self._id+'-head" class="'+prefix+'tabs" role="tablist">'+tabsHtml+"</div>"+'<div id="'+self._id+'-body" class="'+self.classes("body")+'">'+layout.renderHtml(self)+"</div>"+"</div>"},postRender:function(){var self=this;self._super(),self.settings.activeTab=self.settings.activeTab||0,self.activateTab(self.settings.activeTab),this.on("click",function(e){var targetParent=e.target.parentNode;if(e.target.parentNode.id==self._id+"-head")for(var i=targetParent.childNodes.length;i--;)targetParent.childNodes[i]==e.target&&self.activateTab(i)})},initLayoutRect:function(){var rect,minW,minH,self=this;minW=DomUtils.getSize(self.getEl("head")).width,minW=0>minW?0:minW,minH=0,self.items().each(function(item,i){minW=Math.max(minW,item.layoutRect().minW),minH=Math.max(minH,item.layoutRect().minH),self.settings.activeTab!=i&&item.hide()}),self.items().each(function(ctrl){ctrl.settings.x=0,ctrl.settings.y=0,ctrl.settings.w=minW,ctrl.settings.h=minH,ctrl.layoutRect({x:0,y:0,w:minW,h:minH})});var headH=DomUtils.getSize(self.getEl("head")).height;return self.settings.minWidth=minW,self.settings.minHeight=minH+headH,rect=self._super(),rect.deltaH+=headH,rect.innerH=rect.h-rect.deltaH,rect}})}),/**
 * TextBox.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/TextBox",["tinymce/ui/Widget","tinymce/ui/DomUtils"],function(Widget,DomUtils){return Widget.extend({init:function(settings){var self=this;self._super(settings),self._value=settings.value||"",self.addClass("textbox"),settings.multiline?self.addClass("multiline"):self.on("keydown",function(e){13==e.keyCode&&self.parents().reverse().each(function(ctrl){return e.preventDefault(),ctrl.hasEventListeners("submit")&&ctrl.toJSON?(ctrl.fire("submit",{data:ctrl.toJSON()}),!1):void 0})})},disabled:function(state){var self=this;return self._rendered&&"undefined"!=typeof state&&(self.getEl().disabled=state),self._super(state)},value:function(value){var self=this;return"undefined"!=typeof value?(self._value=value,self._rendered&&(self.getEl().value=value),self):self._rendered?self.getEl().value:self._value},repaint:function(){var style,rect,borderBox,lastRepaintRect,self=this,borderW=0,borderH=0;style=self.getEl().style,rect=self._layoutRect,lastRepaintRect=self._lastRepaintRect||{};var doc=document;return!self.settings.multiline&&doc.all&&(!doc.documentMode||doc.documentMode<=8)&&(style.lineHeight=rect.h-borderH+"px"),borderBox=self._borderBox,borderW=borderBox.left+borderBox.right+8,borderH=borderBox.top+borderBox.bottom+(self.settings.multiline?8:0),rect.x!==lastRepaintRect.x&&(style.left=rect.x+"px",lastRepaintRect.x=rect.x),rect.y!==lastRepaintRect.y&&(style.top=rect.y+"px",lastRepaintRect.y=rect.y),rect.w!==lastRepaintRect.w&&(style.width=rect.w-borderW+"px",lastRepaintRect.w=rect.w),rect.h!==lastRepaintRect.h&&(style.height=rect.h-borderH+"px",lastRepaintRect.h=rect.h),self._lastRepaintRect=lastRepaintRect,self.fire("repaint",{},!1),self},renderHtml:function(){var self=this,id=self._id,settings=self.settings,value=self.encode(self._value,!1),extraAttrs="";return"spellcheck"in settings&&(extraAttrs+=' spellcheck="'+settings.spellcheck+'"'),settings.maxLength&&(extraAttrs+=' maxlength="'+settings.maxLength+'"'),settings.size&&(extraAttrs+=' size="'+settings.size+'"'),settings.subtype&&(extraAttrs+=' type="'+settings.subtype+'"'),self.disabled()&&(extraAttrs+=' disabled="disabled"'),settings.multiline?'<textarea id="'+id+'" class="'+self.classes()+'" '+(settings.rows?' rows="'+settings.rows+'"':"")+' hidefocus="true"'+extraAttrs+">"+value+"</textarea>":'<input id="'+id+'" class="'+self.classes()+'" value="'+value+'" hidefocus="true"'+extraAttrs+">"},postRender:function(){var self=this;return DomUtils.on(self.getEl(),"change",function(e){self.fire("change",e)}),self._super()},remove:function(){DomUtils.off(this.getEl()),this._super()}})}),/**
 * Throbber.js
 *
 * Copyright, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */
define("tinymce/ui/Throbber",["tinymce/ui/DomUtils"],function(DomUtils){return function(elm){var state,self=this;self.show=function(time){return self.hide(),state=!0,window.setTimeout(function(){state&&elm.appendChild(DomUtils.createFragment('<div class="mce-throbber"></div>'))},time||0),self},self.hide=function(){var child=elm.lastChild;return child&&-1!=child.className.indexOf("throbber")&&child.parentNode.removeChild(child),state=!1,self}}}),expose(["tinymce/dom/EventUtils","tinymce/dom/Sizzle","tinymce/dom/DomQuery","tinymce/html/Styles","tinymce/dom/TreeWalker","tinymce/util/Tools","tinymce/dom/Range","tinymce/html/Entities","tinymce/Env","tinymce/dom/StyleSheetLoader","tinymce/dom/DOMUtils","tinymce/dom/ScriptLoader","tinymce/AddOnManager","tinymce/html/Node","tinymce/html/Schema","tinymce/html/SaxParser","tinymce/html/DomParser","tinymce/html/Writer","tinymce/html/Serializer","tinymce/dom/Serializer","tinymce/dom/TridentSelection","tinymce/util/VK","tinymce/dom/ControlSelection","tinymce/dom/RangeUtils","tinymce/dom/Selection","tinymce/Formatter","tinymce/UndoManager","tinymce/EnterKey","tinymce/ForceBlocks","tinymce/EditorCommands","tinymce/util/URI","tinymce/util/Class","tinymce/ui/Selector","tinymce/ui/Collection","tinymce/ui/DomUtils","tinymce/ui/Control","tinymce/ui/Factory","tinymce/ui/KeyboardNavigation","tinymce/ui/Container","tinymce/ui/DragHelper","tinymce/ui/Scrollable","tinymce/ui/Panel","tinymce/ui/Movable","tinymce/ui/Resizable","tinymce/ui/FloatPanel","tinymce/ui/Window","tinymce/ui/MessageBox","tinymce/WindowManager","tinymce/util/Quirks","tinymce/util/Observable","tinymce/Shortcuts","tinymce/Editor","tinymce/util/I18n","tinymce/FocusManager","tinymce/EditorManager","tinymce/LegacyInput","tinymce/util/XHR","tinymce/util/JSON","tinymce/util/JSONRequest","tinymce/util/JSONP","tinymce/util/LocalStorage","tinymce/Compat","tinymce/ui/Layout","tinymce/ui/AbsoluteLayout","tinymce/ui/Tooltip","tinymce/ui/Widget","tinymce/ui/Button","tinymce/ui/ButtonGroup","tinymce/ui/Checkbox","tinymce/ui/PanelButton","tinymce/ui/ColorButton","tinymce/ui/ComboBox","tinymce/ui/Path","tinymce/ui/ElementPath","tinymce/ui/FormItem","tinymce/ui/Form","tinymce/ui/FieldSet","tinymce/ui/FilePicker","tinymce/ui/FitLayout","tinymce/ui/FlexLayout","tinymce/ui/FlowLayout","tinymce/ui/FormatControls","tinymce/ui/GridLayout","tinymce/ui/Iframe","tinymce/ui/Label","tinymce/ui/Toolbar","tinymce/ui/MenuBar","tinymce/ui/MenuButton","tinymce/ui/ListBox","tinymce/ui/MenuItem","tinymce/ui/Menu","tinymce/ui/Radio","tinymce/ui/ResizeHandle","tinymce/ui/Spacer","tinymce/ui/SplitButton","tinymce/ui/StackLayout","tinymce/ui/TabPanel","tinymce/ui/TextBox","tinymce/ui/Throbber"])}(this);